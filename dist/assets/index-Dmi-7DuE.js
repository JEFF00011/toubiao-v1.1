(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))a(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&a(l)}).observe(document,{childList:!0,subtree:!0});function r(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(s){if(s.ep)return;s.ep=!0;const i=r(s);fetch(s.href,i)}})();function Pv(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var ah={exports:{}},Fo={},sh={exports:{}},it={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Hl=Symbol.for("react.element"),Dv=Symbol.for("react.portal"),Iv=Symbol.for("react.fragment"),Mv=Symbol.for("react.strict_mode"),Rv=Symbol.for("react.profiler"),Ov=Symbol.for("react.provider"),Lv=Symbol.for("react.context"),Bv=Symbol.for("react.forward_ref"),Uv=Symbol.for("react.suspense"),zv=Symbol.for("react.memo"),Wv=Symbol.for("react.lazy"),Mf=Symbol.iterator;function Hv(e){return e===null||typeof e!="object"?null:(e=Mf&&e[Mf]||e["@@iterator"],typeof e=="function"?e:null)}var ih={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},lh=Object.assign,ch={};function ji(e,t,r){this.props=e,this.context=t,this.refs=ch,this.updater=r||ih}ji.prototype.isReactComponent={};ji.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};ji.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function oh(){}oh.prototype=ji.prototype;function Yd(e,t,r){this.props=e,this.context=t,this.refs=ch,this.updater=r||ih}var qd=Yd.prototype=new oh;qd.constructor=Yd;lh(qd,ji.prototype);qd.isPureReactComponent=!0;var Rf=Array.isArray,dh=Object.prototype.hasOwnProperty,Jd={current:null},uh={key:!0,ref:!0,__self:!0,__source:!0};function fh(e,t,r){var a,s={},i=null,l=null;if(t!=null)for(a in t.ref!==void 0&&(l=t.ref),t.key!==void 0&&(i=""+t.key),t)dh.call(t,a)&&!uh.hasOwnProperty(a)&&(s[a]=t[a]);var c=arguments.length-2;if(c===1)s.children=r;else if(1<c){for(var o=Array(c),u=0;u<c;u++)o[u]=arguments[u+2];s.children=o}if(e&&e.defaultProps)for(a in c=e.defaultProps,c)s[a]===void 0&&(s[a]=c[a]);return{$$typeof:Hl,type:e,key:i,ref:l,props:s,_owner:Jd.current}}function $v(e,t){return{$$typeof:Hl,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Qd(e){return typeof e=="object"&&e!==null&&e.$$typeof===Hl}function Vv(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var Of=/\/+/g;function t0(e,t){return typeof e=="object"&&e!==null&&e.key!=null?Vv(""+e.key):t.toString(36)}function Dc(e,t,r,a,s){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var l=!1;if(e===null)l=!0;else switch(i){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case Hl:case Dv:l=!0}}if(l)return l=e,s=s(l),e=a===""?"."+t0(l,0):a,Rf(s)?(r="",e!=null&&(r=e.replace(Of,"$&/")+"/"),Dc(s,t,r,"",function(u){return u})):s!=null&&(Qd(s)&&(s=$v(s,r+(!s.key||l&&l.key===s.key?"":(""+s.key).replace(Of,"$&/")+"/")+e)),t.push(s)),1;if(l=0,a=a===""?".":a+":",Rf(e))for(var c=0;c<e.length;c++){i=e[c];var o=a+t0(i,c);l+=Dc(i,t,r,o,s)}else if(o=Hv(e),typeof o=="function")for(e=o.call(e),c=0;!(i=e.next()).done;)i=i.value,o=a+t0(i,c++),l+=Dc(i,t,r,o,s);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function rc(e,t,r){if(e==null)return e;var a=[],s=0;return Dc(e,a,"","",function(i){return t.call(r,i,s++)}),a}function Gv(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Br={current:null},Ic={transition:null},Xv={ReactCurrentDispatcher:Br,ReactCurrentBatchConfig:Ic,ReactCurrentOwner:Jd};function xh(){throw Error("act(...) is not supported in production builds of React.")}it.Children={map:rc,forEach:function(e,t,r){rc(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return rc(e,function(){t++}),t},toArray:function(e){return rc(e,function(t){return t})||[]},only:function(e){if(!Qd(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};it.Component=ji;it.Fragment=Iv;it.Profiler=Rv;it.PureComponent=Yd;it.StrictMode=Mv;it.Suspense=Uv;it.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Xv;it.act=xh;it.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var a=lh({},e.props),s=e.key,i=e.ref,l=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,l=Jd.current),t.key!==void 0&&(s=""+t.key),e.type&&e.type.defaultProps)var c=e.type.defaultProps;for(o in t)dh.call(t,o)&&!uh.hasOwnProperty(o)&&(a[o]=t[o]===void 0&&c!==void 0?c[o]:t[o])}var o=arguments.length-2;if(o===1)a.children=r;else if(1<o){c=Array(o);for(var u=0;u<o;u++)c[u]=arguments[u+2];a.children=c}return{$$typeof:Hl,type:e.type,key:s,ref:i,props:a,_owner:l}};it.createContext=function(e){return e={$$typeof:Lv,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:Ov,_context:e},e.Consumer=e};it.createElement=fh;it.createFactory=function(e){var t=fh.bind(null,e);return t.type=e,t};it.createRef=function(){return{current:null}};it.forwardRef=function(e){return{$$typeof:Bv,render:e}};it.isValidElement=Qd;it.lazy=function(e){return{$$typeof:Wv,_payload:{_status:-1,_result:e},_init:Gv}};it.memo=function(e,t){return{$$typeof:zv,type:e,compare:t===void 0?null:t}};it.startTransition=function(e){var t=Ic.transition;Ic.transition={};try{e()}finally{Ic.transition=t}};it.unstable_act=xh;it.useCallback=function(e,t){return Br.current.useCallback(e,t)};it.useContext=function(e){return Br.current.useContext(e)};it.useDebugValue=function(){};it.useDeferredValue=function(e){return Br.current.useDeferredValue(e)};it.useEffect=function(e,t){return Br.current.useEffect(e,t)};it.useId=function(){return Br.current.useId()};it.useImperativeHandle=function(e,t,r){return Br.current.useImperativeHandle(e,t,r)};it.useInsertionEffect=function(e,t){return Br.current.useInsertionEffect(e,t)};it.useLayoutEffect=function(e,t){return Br.current.useLayoutEffect(e,t)};it.useMemo=function(e,t){return Br.current.useMemo(e,t)};it.useReducer=function(e,t,r){return Br.current.useReducer(e,t,r)};it.useRef=function(e){return Br.current.useRef(e)};it.useState=function(e){return Br.current.useState(e)};it.useSyncExternalStore=function(e,t,r){return Br.current.useSyncExternalStore(e,t,r)};it.useTransition=function(){return Br.current.useTransition()};it.version="18.3.1";sh.exports=it;var M=sh.exports;const mr=Pv(M);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Kv=M,Yv=Symbol.for("react.element"),qv=Symbol.for("react.fragment"),Jv=Object.prototype.hasOwnProperty,Qv=Kv.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Zv={key:!0,ref:!0,__self:!0,__source:!0};function mh(e,t,r){var a,s={},i=null,l=null;r!==void 0&&(i=""+r),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(l=t.ref);for(a in t)Jv.call(t,a)&&!Zv.hasOwnProperty(a)&&(s[a]=t[a]);if(e&&e.defaultProps)for(a in t=e.defaultProps,t)s[a]===void 0&&(s[a]=t[a]);return{$$typeof:Yv,type:e,key:i,ref:l,props:s,_owner:Qv.current}}Fo.Fragment=qv;Fo.jsx=mh;Fo.jsxs=mh;ah.exports=Fo;var n=ah.exports,hh={exports:{}},on={},ph={exports:{}},gh={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(te,H){var ae=te.length;te.push(H);e:for(;0<ae;){var he=ae-1>>>1,O=te[he];if(0<s(O,H))te[he]=H,te[ae]=O,ae=he;else break e}}function r(te){return te.length===0?null:te[0]}function a(te){if(te.length===0)return null;var H=te[0],ae=te.pop();if(ae!==H){te[0]=ae;e:for(var he=0,O=te.length,I=O>>>1;he<I;){var g=2*(he+1)-1,_=te[g],A=g+1,ne=te[A];if(0>s(_,ae))A<O&&0>s(ne,_)?(te[he]=ne,te[A]=ae,he=A):(te[he]=_,te[g]=ae,he=g);else if(A<O&&0>s(ne,ae))te[he]=ne,te[A]=ae,he=A;else break e}}return H}function s(te,H){var ae=te.sortIndex-H.sortIndex;return ae!==0?ae:te.id-H.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var l=Date,c=l.now();e.unstable_now=function(){return l.now()-c}}var o=[],u=[],d=1,f=null,x=3,h=!1,p=!1,m=!1,w=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function y(te){for(var H=r(u);H!==null;){if(H.callback===null)a(u);else if(H.startTime<=te)a(u),H.sortIndex=H.expirationTime,t(o,H);else break;H=r(u)}}function N(te){if(m=!1,y(te),!p)if(r(o)!==null)p=!0,re(F);else{var H=r(u);H!==null&&Q(N,H.startTime-te)}}function F(te,H){p=!1,m&&(m=!1,v(S),S=-1),h=!0;var ae=x;try{for(y(H),f=r(o);f!==null&&(!(f.expirationTime>H)||te&&!K());){var he=f.callback;if(typeof he=="function"){f.callback=null,x=f.priorityLevel;var O=he(f.expirationTime<=H);H=e.unstable_now(),typeof O=="function"?f.callback=O:f===r(o)&&a(o),y(H)}else a(o);f=r(o)}if(f!==null)var I=!0;else{var g=r(u);g!==null&&Q(N,g.startTime-H),I=!1}return I}finally{f=null,x=ae,h=!1}}var j=!1,k=null,S=-1,P=5,D=-1;function K(){return!(e.unstable_now()-D<P)}function C(){if(k!==null){var te=e.unstable_now();D=te;var H=!0;try{H=k(!0,te)}finally{H?Y():(j=!1,k=null)}}else j=!1}var Y;if(typeof b=="function")Y=function(){b(C)};else if(typeof MessageChannel<"u"){var B=new MessageChannel,ee=B.port2;B.port1.onmessage=C,Y=function(){ee.postMessage(null)}}else Y=function(){w(C,0)};function re(te){k=te,j||(j=!0,Y())}function Q(te,H){S=w(function(){te(e.unstable_now())},H)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(te){te.callback=null},e.unstable_continueExecution=function(){p||h||(p=!0,re(F))},e.unstable_forceFrameRate=function(te){0>te||125<te?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):P=0<te?Math.floor(1e3/te):5},e.unstable_getCurrentPriorityLevel=function(){return x},e.unstable_getFirstCallbackNode=function(){return r(o)},e.unstable_next=function(te){switch(x){case 1:case 2:case 3:var H=3;break;default:H=x}var ae=x;x=H;try{return te()}finally{x=ae}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(te,H){switch(te){case 1:case 2:case 3:case 4:case 5:break;default:te=3}var ae=x;x=te;try{return H()}finally{x=ae}},e.unstable_scheduleCallback=function(te,H,ae){var he=e.unstable_now();switch(typeof ae=="object"&&ae!==null?(ae=ae.delay,ae=typeof ae=="number"&&0<ae?he+ae:he):ae=he,te){case 1:var O=-1;break;case 2:O=250;break;case 5:O=1073741823;break;case 4:O=1e4;break;default:O=5e3}return O=ae+O,te={id:d++,callback:H,priorityLevel:te,startTime:ae,expirationTime:O,sortIndex:-1},ae>he?(te.sortIndex=ae,t(u,te),r(o)===null&&te===r(u)&&(m?(v(S),S=-1):m=!0,Q(N,ae-he))):(te.sortIndex=O,t(o,te),p||h||(p=!0,re(F))),te},e.unstable_shouldYield=K,e.unstable_wrapCallback=function(te){var H=x;return function(){var ae=x;x=H;try{return te.apply(this,arguments)}finally{x=ae}}}})(gh);ph.exports=gh;var e2=ph.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var t2=M,ln=e2;function Te(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var vh=new Set,dl={};function Fs(e,t){fi(e,t),fi(e+"Capture",t)}function fi(e,t){for(dl[e]=t,e=0;e<t.length;e++)vh.add(t[e])}var ma=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),H0=Object.prototype.hasOwnProperty,r2=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Lf={},Bf={};function n2(e){return H0.call(Bf,e)?!0:H0.call(Lf,e)?!1:r2.test(e)?Bf[e]=!0:(Lf[e]=!0,!1)}function a2(e,t,r,a){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return a?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function s2(e,t,r,a){if(t===null||typeof t>"u"||a2(e,t,r,a))return!0;if(a)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Ur(e,t,r,a,s,i,l){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=a,this.attributeNamespace=s,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=l}var vr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){vr[e]=new Ur(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];vr[t]=new Ur(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){vr[e]=new Ur(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){vr[e]=new Ur(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){vr[e]=new Ur(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){vr[e]=new Ur(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){vr[e]=new Ur(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){vr[e]=new Ur(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){vr[e]=new Ur(e,5,!1,e.toLowerCase(),null,!1,!1)});var Zd=/[\-:]([a-z])/g;function eu(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Zd,eu);vr[t]=new Ur(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Zd,eu);vr[t]=new Ur(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Zd,eu);vr[t]=new Ur(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){vr[e]=new Ur(e,1,!1,e.toLowerCase(),null,!1,!1)});vr.xlinkHref=new Ur("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){vr[e]=new Ur(e,1,!1,e.toLowerCase(),null,!0,!0)});function tu(e,t,r,a){var s=vr.hasOwnProperty(t)?vr[t]:null;(s!==null?s.type!==0:a||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(s2(t,r,s,a)&&(r=null),a||s===null?n2(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):s.mustUseProperty?e[s.propertyName]=r===null?s.type===3?!1:"":r:(t=s.attributeName,a=s.attributeNamespace,r===null?e.removeAttribute(t):(s=s.type,r=s===3||s===4&&r===!0?"":""+r,a?e.setAttributeNS(a,t,r):e.setAttribute(t,r))))}var ya=t2.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,nc=Symbol.for("react.element"),Hs=Symbol.for("react.portal"),$s=Symbol.for("react.fragment"),ru=Symbol.for("react.strict_mode"),$0=Symbol.for("react.profiler"),yh=Symbol.for("react.provider"),bh=Symbol.for("react.context"),nu=Symbol.for("react.forward_ref"),V0=Symbol.for("react.suspense"),G0=Symbol.for("react.suspense_list"),au=Symbol.for("react.memo"),Fa=Symbol.for("react.lazy"),wh=Symbol.for("react.offscreen"),Uf=Symbol.iterator;function Ai(e){return e===null||typeof e!="object"?null:(e=Uf&&e[Uf]||e["@@iterator"],typeof e=="function"?e:null)}var Lt=Object.assign,r0;function Ui(e){if(r0===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);r0=t&&t[1]||""}return`
`+r0+e}var n0=!1;function a0(e,t){if(!e||n0)return"";n0=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var a=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){a=u}e.call(t.prototype)}else{try{throw Error()}catch(u){a=u}e()}}catch(u){if(u&&a&&typeof u.stack=="string"){for(var s=u.stack.split(`
`),i=a.stack.split(`
`),l=s.length-1,c=i.length-1;1<=l&&0<=c&&s[l]!==i[c];)c--;for(;1<=l&&0<=c;l--,c--)if(s[l]!==i[c]){if(l!==1||c!==1)do if(l--,c--,0>c||s[l]!==i[c]){var o=`
`+s[l].replace(" at new "," at ");return e.displayName&&o.includes("<anonymous>")&&(o=o.replace("<anonymous>",e.displayName)),o}while(1<=l&&0<=c);break}}}finally{n0=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?Ui(e):""}function i2(e){switch(e.tag){case 5:return Ui(e.type);case 16:return Ui("Lazy");case 13:return Ui("Suspense");case 19:return Ui("SuspenseList");case 0:case 2:case 15:return e=a0(e.type,!1),e;case 11:return e=a0(e.type.render,!1),e;case 1:return e=a0(e.type,!0),e;default:return""}}function X0(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case $s:return"Fragment";case Hs:return"Portal";case $0:return"Profiler";case ru:return"StrictMode";case V0:return"Suspense";case G0:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case bh:return(e.displayName||"Context")+".Consumer";case yh:return(e._context.displayName||"Context")+".Provider";case nu:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case au:return t=e.displayName||null,t!==null?t:X0(e.type)||"Memo";case Fa:t=e._payload,e=e._init;try{return X0(e(t))}catch{}}return null}function l2(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return X0(t);case 8:return t===ru?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Xa(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Nh(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function c2(e){var t=Nh(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),a=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var s=r.get,i=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(l){a=""+l,i.call(this,l)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return a},setValue:function(l){a=""+l},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function ac(e){e._valueTracker||(e._valueTracker=c2(e))}function jh(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),a="";return e&&(a=Nh(e)?e.checked?"true":"false":e.value),e=a,e!==r?(t.setValue(e),!0):!1}function Vc(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function K0(e,t){var r=t.checked;return Lt({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function zf(e,t){var r=t.defaultValue==null?"":t.defaultValue,a=t.checked!=null?t.checked:t.defaultChecked;r=Xa(t.value!=null?t.value:r),e._wrapperState={initialChecked:a,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function kh(e,t){t=t.checked,t!=null&&tu(e,"checked",t,!1)}function Y0(e,t){kh(e,t);var r=Xa(t.value),a=t.type;if(r!=null)a==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(a==="submit"||a==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?q0(e,t.type,r):t.hasOwnProperty("defaultValue")&&q0(e,t.type,Xa(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Wf(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var a=t.type;if(!(a!=="submit"&&a!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function q0(e,t,r){(t!=="number"||Vc(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var zi=Array.isArray;function ri(e,t,r,a){if(e=e.options,t){t={};for(var s=0;s<r.length;s++)t["$"+r[s]]=!0;for(r=0;r<e.length;r++)s=t.hasOwnProperty("$"+e[r].value),e[r].selected!==s&&(e[r].selected=s),s&&a&&(e[r].defaultSelected=!0)}else{for(r=""+Xa(r),t=null,s=0;s<e.length;s++){if(e[s].value===r){e[s].selected=!0,a&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function J0(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Te(91));return Lt({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Hf(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(Te(92));if(zi(r)){if(1<r.length)throw Error(Te(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:Xa(r)}}function _h(e,t){var r=Xa(t.value),a=Xa(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),a!=null&&(e.defaultValue=""+a)}function $f(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function Sh(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Q0(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Sh(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var sc,Ch=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,a,s){MSApp.execUnsafeLocalFunction(function(){return e(t,r,a,s)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(sc=sc||document.createElement("div"),sc.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=sc.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function ul(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var Xi={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},o2=["Webkit","ms","Moz","O"];Object.keys(Xi).forEach(function(e){o2.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Xi[t]=Xi[e]})});function Eh(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||Xi.hasOwnProperty(e)&&Xi[e]?(""+t).trim():t+"px"}function Th(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var a=r.indexOf("--")===0,s=Eh(r,t[r],a);r==="float"&&(r="cssFloat"),a?e.setProperty(r,s):e[r]=s}}var d2=Lt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Z0(e,t){if(t){if(d2[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Te(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Te(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(Te(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Te(62))}}function ed(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var td=null;function su(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var rd=null,ni=null,ai=null;function Vf(e){if(e=Gl(e)){if(typeof rd!="function")throw Error(Te(280));var t=e.stateNode;t&&(t=Mo(t),rd(e.stateNode,e.type,t))}}function Fh(e){ni?ai?ai.push(e):ai=[e]:ni=e}function Ah(){if(ni){var e=ni,t=ai;if(ai=ni=null,Vf(e),t)for(e=0;e<t.length;e++)Vf(t[e])}}function Ph(e,t){return e(t)}function Dh(){}var s0=!1;function Ih(e,t,r){if(s0)return e(t,r);s0=!0;try{return Ph(e,t,r)}finally{s0=!1,(ni!==null||ai!==null)&&(Dh(),Ah())}}function fl(e,t){var r=e.stateNode;if(r===null)return null;var a=Mo(r);if(a===null)return null;r=a[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(a=!a.disabled)||(e=e.type,a=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!a;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(Te(231,t,typeof r));return r}var nd=!1;if(ma)try{var Pi={};Object.defineProperty(Pi,"passive",{get:function(){nd=!0}}),window.addEventListener("test",Pi,Pi),window.removeEventListener("test",Pi,Pi)}catch{nd=!1}function u2(e,t,r,a,s,i,l,c,o){var u=Array.prototype.slice.call(arguments,3);try{t.apply(r,u)}catch(d){this.onError(d)}}var Ki=!1,Gc=null,Xc=!1,ad=null,f2={onError:function(e){Ki=!0,Gc=e}};function x2(e,t,r,a,s,i,l,c,o){Ki=!1,Gc=null,u2.apply(f2,arguments)}function m2(e,t,r,a,s,i,l,c,o){if(x2.apply(this,arguments),Ki){if(Ki){var u=Gc;Ki=!1,Gc=null}else throw Error(Te(198));Xc||(Xc=!0,ad=u)}}function As(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function Mh(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Gf(e){if(As(e)!==e)throw Error(Te(188))}function h2(e){var t=e.alternate;if(!t){if(t=As(e),t===null)throw Error(Te(188));return t!==e?null:e}for(var r=e,a=t;;){var s=r.return;if(s===null)break;var i=s.alternate;if(i===null){if(a=s.return,a!==null){r=a;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===r)return Gf(s),e;if(i===a)return Gf(s),t;i=i.sibling}throw Error(Te(188))}if(r.return!==a.return)r=s,a=i;else{for(var l=!1,c=s.child;c;){if(c===r){l=!0,r=s,a=i;break}if(c===a){l=!0,a=s,r=i;break}c=c.sibling}if(!l){for(c=i.child;c;){if(c===r){l=!0,r=i,a=s;break}if(c===a){l=!0,a=i,r=s;break}c=c.sibling}if(!l)throw Error(Te(189))}}if(r.alternate!==a)throw Error(Te(190))}if(r.tag!==3)throw Error(Te(188));return r.stateNode.current===r?e:t}function Rh(e){return e=h2(e),e!==null?Oh(e):null}function Oh(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=Oh(e);if(t!==null)return t;e=e.sibling}return null}var Lh=ln.unstable_scheduleCallback,Xf=ln.unstable_cancelCallback,p2=ln.unstable_shouldYield,g2=ln.unstable_requestPaint,Vt=ln.unstable_now,v2=ln.unstable_getCurrentPriorityLevel,iu=ln.unstable_ImmediatePriority,Bh=ln.unstable_UserBlockingPriority,Kc=ln.unstable_NormalPriority,y2=ln.unstable_LowPriority,Uh=ln.unstable_IdlePriority,Ao=null,Jn=null;function b2(e){if(Jn&&typeof Jn.onCommitFiberRoot=="function")try{Jn.onCommitFiberRoot(Ao,e,void 0,(e.current.flags&128)===128)}catch{}}var Ln=Math.clz32?Math.clz32:j2,w2=Math.log,N2=Math.LN2;function j2(e){return e>>>=0,e===0?32:31-(w2(e)/N2|0)|0}var ic=64,lc=4194304;function Wi(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Yc(e,t){var r=e.pendingLanes;if(r===0)return 0;var a=0,s=e.suspendedLanes,i=e.pingedLanes,l=r&268435455;if(l!==0){var c=l&~s;c!==0?a=Wi(c):(i&=l,i!==0&&(a=Wi(i)))}else l=r&~s,l!==0?a=Wi(l):i!==0&&(a=Wi(i));if(a===0)return 0;if(t!==0&&t!==a&&!(t&s)&&(s=a&-a,i=t&-t,s>=i||s===16&&(i&4194240)!==0))return t;if(a&4&&(a|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=a;0<t;)r=31-Ln(t),s=1<<r,a|=e[r],t&=~s;return a}function k2(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function _2(e,t){for(var r=e.suspendedLanes,a=e.pingedLanes,s=e.expirationTimes,i=e.pendingLanes;0<i;){var l=31-Ln(i),c=1<<l,o=s[l];o===-1?(!(c&r)||c&a)&&(s[l]=k2(c,t)):o<=t&&(e.expiredLanes|=c),i&=~c}}function sd(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function zh(){var e=ic;return ic<<=1,!(ic&4194240)&&(ic=64),e}function i0(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function $l(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Ln(t),e[t]=r}function S2(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var a=e.eventTimes;for(e=e.expirationTimes;0<r;){var s=31-Ln(r),i=1<<s;t[s]=0,a[s]=-1,e[s]=-1,r&=~i}}function lu(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var a=31-Ln(r),s=1<<a;s&t|e[a]&t&&(e[a]|=t),r&=~s}}var gt=0;function Wh(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Hh,cu,$h,Vh,Gh,id=!1,cc=[],Ba=null,Ua=null,za=null,xl=new Map,ml=new Map,Pa=[],C2="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Kf(e,t){switch(e){case"focusin":case"focusout":Ba=null;break;case"dragenter":case"dragleave":Ua=null;break;case"mouseover":case"mouseout":za=null;break;case"pointerover":case"pointerout":xl.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":ml.delete(t.pointerId)}}function Di(e,t,r,a,s,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:r,eventSystemFlags:a,nativeEvent:i,targetContainers:[s]},t!==null&&(t=Gl(t),t!==null&&cu(t)),e):(e.eventSystemFlags|=a,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function E2(e,t,r,a,s){switch(t){case"focusin":return Ba=Di(Ba,e,t,r,a,s),!0;case"dragenter":return Ua=Di(Ua,e,t,r,a,s),!0;case"mouseover":return za=Di(za,e,t,r,a,s),!0;case"pointerover":var i=s.pointerId;return xl.set(i,Di(xl.get(i)||null,e,t,r,a,s)),!0;case"gotpointercapture":return i=s.pointerId,ml.set(i,Di(ml.get(i)||null,e,t,r,a,s)),!0}return!1}function Xh(e){var t=cs(e.target);if(t!==null){var r=As(t);if(r!==null){if(t=r.tag,t===13){if(t=Mh(r),t!==null){e.blockedOn=t,Gh(e.priority,function(){$h(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Mc(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=ld(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var a=new r.constructor(r.type,r);td=a,r.target.dispatchEvent(a),td=null}else return t=Gl(r),t!==null&&cu(t),e.blockedOn=r,!1;t.shift()}return!0}function Yf(e,t,r){Mc(e)&&r.delete(t)}function T2(){id=!1,Ba!==null&&Mc(Ba)&&(Ba=null),Ua!==null&&Mc(Ua)&&(Ua=null),za!==null&&Mc(za)&&(za=null),xl.forEach(Yf),ml.forEach(Yf)}function Ii(e,t){e.blockedOn===t&&(e.blockedOn=null,id||(id=!0,ln.unstable_scheduleCallback(ln.unstable_NormalPriority,T2)))}function hl(e){function t(s){return Ii(s,e)}if(0<cc.length){Ii(cc[0],e);for(var r=1;r<cc.length;r++){var a=cc[r];a.blockedOn===e&&(a.blockedOn=null)}}for(Ba!==null&&Ii(Ba,e),Ua!==null&&Ii(Ua,e),za!==null&&Ii(za,e),xl.forEach(t),ml.forEach(t),r=0;r<Pa.length;r++)a=Pa[r],a.blockedOn===e&&(a.blockedOn=null);for(;0<Pa.length&&(r=Pa[0],r.blockedOn===null);)Xh(r),r.blockedOn===null&&Pa.shift()}var si=ya.ReactCurrentBatchConfig,qc=!0;function F2(e,t,r,a){var s=gt,i=si.transition;si.transition=null;try{gt=1,ou(e,t,r,a)}finally{gt=s,si.transition=i}}function A2(e,t,r,a){var s=gt,i=si.transition;si.transition=null;try{gt=4,ou(e,t,r,a)}finally{gt=s,si.transition=i}}function ou(e,t,r,a){if(qc){var s=ld(e,t,r,a);if(s===null)p0(e,t,a,Jc,r),Kf(e,a);else if(E2(s,e,t,r,a))a.stopPropagation();else if(Kf(e,a),t&4&&-1<C2.indexOf(e)){for(;s!==null;){var i=Gl(s);if(i!==null&&Hh(i),i=ld(e,t,r,a),i===null&&p0(e,t,a,Jc,r),i===s)break;s=i}s!==null&&a.stopPropagation()}else p0(e,t,a,null,r)}}var Jc=null;function ld(e,t,r,a){if(Jc=null,e=su(a),e=cs(e),e!==null)if(t=As(e),t===null)e=null;else if(r=t.tag,r===13){if(e=Mh(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Jc=e,null}function Kh(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(v2()){case iu:return 1;case Bh:return 4;case Kc:case y2:return 16;case Uh:return 536870912;default:return 16}default:return 16}}var Ma=null,du=null,Rc=null;function Yh(){if(Rc)return Rc;var e,t=du,r=t.length,a,s="value"in Ma?Ma.value:Ma.textContent,i=s.length;for(e=0;e<r&&t[e]===s[e];e++);var l=r-e;for(a=1;a<=l&&t[r-a]===s[i-a];a++);return Rc=s.slice(e,1<a?1-a:void 0)}function Oc(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function oc(){return!0}function qf(){return!1}function dn(e){function t(r,a,s,i,l){this._reactName=r,this._targetInst=s,this.type=a,this.nativeEvent=i,this.target=l,this.currentTarget=null;for(var c in e)e.hasOwnProperty(c)&&(r=e[c],this[c]=r?r(i):i[c]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?oc:qf,this.isPropagationStopped=qf,this}return Lt(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=oc)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=oc)},persist:function(){},isPersistent:oc}),t}var ki={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},uu=dn(ki),Vl=Lt({},ki,{view:0,detail:0}),P2=dn(Vl),l0,c0,Mi,Po=Lt({},Vl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:fu,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Mi&&(Mi&&e.type==="mousemove"?(l0=e.screenX-Mi.screenX,c0=e.screenY-Mi.screenY):c0=l0=0,Mi=e),l0)},movementY:function(e){return"movementY"in e?e.movementY:c0}}),Jf=dn(Po),D2=Lt({},Po,{dataTransfer:0}),I2=dn(D2),M2=Lt({},Vl,{relatedTarget:0}),o0=dn(M2),R2=Lt({},ki,{animationName:0,elapsedTime:0,pseudoElement:0}),O2=dn(R2),L2=Lt({},ki,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),B2=dn(L2),U2=Lt({},ki,{data:0}),Qf=dn(U2),z2={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},W2={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},H2={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function $2(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=H2[e])?!!t[e]:!1}function fu(){return $2}var V2=Lt({},Vl,{key:function(e){if(e.key){var t=z2[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Oc(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?W2[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:fu,charCode:function(e){return e.type==="keypress"?Oc(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Oc(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),G2=dn(V2),X2=Lt({},Po,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Zf=dn(X2),K2=Lt({},Vl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:fu}),Y2=dn(K2),q2=Lt({},ki,{propertyName:0,elapsedTime:0,pseudoElement:0}),J2=dn(q2),Q2=Lt({},Po,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Z2=dn(Q2),ey=[9,13,27,32],xu=ma&&"CompositionEvent"in window,Yi=null;ma&&"documentMode"in document&&(Yi=document.documentMode);var ty=ma&&"TextEvent"in window&&!Yi,qh=ma&&(!xu||Yi&&8<Yi&&11>=Yi),ex=" ",tx=!1;function Jh(e,t){switch(e){case"keyup":return ey.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Qh(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Vs=!1;function ry(e,t){switch(e){case"compositionend":return Qh(t);case"keypress":return t.which!==32?null:(tx=!0,ex);case"textInput":return e=t.data,e===ex&&tx?null:e;default:return null}}function ny(e,t){if(Vs)return e==="compositionend"||!xu&&Jh(e,t)?(e=Yh(),Rc=du=Ma=null,Vs=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return qh&&t.locale!=="ko"?null:t.data;default:return null}}var ay={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function rx(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!ay[e.type]:t==="textarea"}function Zh(e,t,r,a){Fh(a),t=Qc(t,"onChange"),0<t.length&&(r=new uu("onChange","change",null,r,a),e.push({event:r,listeners:t}))}var qi=null,pl=null;function sy(e){dp(e,0)}function Do(e){var t=Ks(e);if(jh(t))return e}function iy(e,t){if(e==="change")return t}var ep=!1;if(ma){var d0;if(ma){var u0="oninput"in document;if(!u0){var nx=document.createElement("div");nx.setAttribute("oninput","return;"),u0=typeof nx.oninput=="function"}d0=u0}else d0=!1;ep=d0&&(!document.documentMode||9<document.documentMode)}function ax(){qi&&(qi.detachEvent("onpropertychange",tp),pl=qi=null)}function tp(e){if(e.propertyName==="value"&&Do(pl)){var t=[];Zh(t,pl,e,su(e)),Ih(sy,t)}}function ly(e,t,r){e==="focusin"?(ax(),qi=t,pl=r,qi.attachEvent("onpropertychange",tp)):e==="focusout"&&ax()}function cy(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Do(pl)}function oy(e,t){if(e==="click")return Do(t)}function dy(e,t){if(e==="input"||e==="change")return Do(t)}function uy(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Wn=typeof Object.is=="function"?Object.is:uy;function gl(e,t){if(Wn(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),a=Object.keys(t);if(r.length!==a.length)return!1;for(a=0;a<r.length;a++){var s=r[a];if(!H0.call(t,s)||!Wn(e[s],t[s]))return!1}return!0}function sx(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ix(e,t){var r=sx(e);e=0;for(var a;r;){if(r.nodeType===3){if(a=e+r.textContent.length,e<=t&&a>=t)return{node:r,offset:t-e};e=a}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=sx(r)}}function rp(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?rp(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function np(){for(var e=window,t=Vc();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=Vc(e.document)}return t}function mu(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function fy(e){var t=np(),r=e.focusedElem,a=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&rp(r.ownerDocument.documentElement,r)){if(a!==null&&mu(r)){if(t=a.start,e=a.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var s=r.textContent.length,i=Math.min(a.start,s);a=a.end===void 0?i:Math.min(a.end,s),!e.extend&&i>a&&(s=a,a=i,i=s),s=ix(r,i);var l=ix(r,a);s&&l&&(e.rangeCount!==1||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==l.node||e.focusOffset!==l.offset)&&(t=t.createRange(),t.setStart(s.node,s.offset),e.removeAllRanges(),i>a?(e.addRange(t),e.extend(l.node,l.offset)):(t.setEnd(l.node,l.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var xy=ma&&"documentMode"in document&&11>=document.documentMode,Gs=null,cd=null,Ji=null,od=!1;function lx(e,t,r){var a=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;od||Gs==null||Gs!==Vc(a)||(a=Gs,"selectionStart"in a&&mu(a)?a={start:a.selectionStart,end:a.selectionEnd}:(a=(a.ownerDocument&&a.ownerDocument.defaultView||window).getSelection(),a={anchorNode:a.anchorNode,anchorOffset:a.anchorOffset,focusNode:a.focusNode,focusOffset:a.focusOffset}),Ji&&gl(Ji,a)||(Ji=a,a=Qc(cd,"onSelect"),0<a.length&&(t=new uu("onSelect","select",null,t,r),e.push({event:t,listeners:a}),t.target=Gs)))}function dc(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Xs={animationend:dc("Animation","AnimationEnd"),animationiteration:dc("Animation","AnimationIteration"),animationstart:dc("Animation","AnimationStart"),transitionend:dc("Transition","TransitionEnd")},f0={},ap={};ma&&(ap=document.createElement("div").style,"AnimationEvent"in window||(delete Xs.animationend.animation,delete Xs.animationiteration.animation,delete Xs.animationstart.animation),"TransitionEvent"in window||delete Xs.transitionend.transition);function Io(e){if(f0[e])return f0[e];if(!Xs[e])return e;var t=Xs[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in ap)return f0[e]=t[r];return e}var sp=Io("animationend"),ip=Io("animationiteration"),lp=Io("animationstart"),cp=Io("transitionend"),op=new Map,cx="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Za(e,t){op.set(e,t),Fs(t,[e])}for(var x0=0;x0<cx.length;x0++){var m0=cx[x0],my=m0.toLowerCase(),hy=m0[0].toUpperCase()+m0.slice(1);Za(my,"on"+hy)}Za(sp,"onAnimationEnd");Za(ip,"onAnimationIteration");Za(lp,"onAnimationStart");Za("dblclick","onDoubleClick");Za("focusin","onFocus");Za("focusout","onBlur");Za(cp,"onTransitionEnd");fi("onMouseEnter",["mouseout","mouseover"]);fi("onMouseLeave",["mouseout","mouseover"]);fi("onPointerEnter",["pointerout","pointerover"]);fi("onPointerLeave",["pointerout","pointerover"]);Fs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Fs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Fs("onBeforeInput",["compositionend","keypress","textInput","paste"]);Fs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Fs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Fs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Hi="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),py=new Set("cancel close invalid load scroll toggle".split(" ").concat(Hi));function ox(e,t,r){var a=e.type||"unknown-event";e.currentTarget=r,m2(a,t,void 0,e),e.currentTarget=null}function dp(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var a=e[r],s=a.event;a=a.listeners;e:{var i=void 0;if(t)for(var l=a.length-1;0<=l;l--){var c=a[l],o=c.instance,u=c.currentTarget;if(c=c.listener,o!==i&&s.isPropagationStopped())break e;ox(s,c,u),i=o}else for(l=0;l<a.length;l++){if(c=a[l],o=c.instance,u=c.currentTarget,c=c.listener,o!==i&&s.isPropagationStopped())break e;ox(s,c,u),i=o}}}if(Xc)throw e=ad,Xc=!1,ad=null,e}function kt(e,t){var r=t[md];r===void 0&&(r=t[md]=new Set);var a=e+"__bubble";r.has(a)||(up(t,e,2,!1),r.add(a))}function h0(e,t,r){var a=0;t&&(a|=4),up(r,e,a,t)}var uc="_reactListening"+Math.random().toString(36).slice(2);function vl(e){if(!e[uc]){e[uc]=!0,vh.forEach(function(r){r!=="selectionchange"&&(py.has(r)||h0(r,!1,e),h0(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[uc]||(t[uc]=!0,h0("selectionchange",!1,t))}}function up(e,t,r,a){switch(Kh(t)){case 1:var s=F2;break;case 4:s=A2;break;default:s=ou}r=s.bind(null,t,r,e),s=void 0,!nd||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),a?s!==void 0?e.addEventListener(t,r,{capture:!0,passive:s}):e.addEventListener(t,r,!0):s!==void 0?e.addEventListener(t,r,{passive:s}):e.addEventListener(t,r,!1)}function p0(e,t,r,a,s){var i=a;if(!(t&1)&&!(t&2)&&a!==null)e:for(;;){if(a===null)return;var l=a.tag;if(l===3||l===4){var c=a.stateNode.containerInfo;if(c===s||c.nodeType===8&&c.parentNode===s)break;if(l===4)for(l=a.return;l!==null;){var o=l.tag;if((o===3||o===4)&&(o=l.stateNode.containerInfo,o===s||o.nodeType===8&&o.parentNode===s))return;l=l.return}for(;c!==null;){if(l=cs(c),l===null)return;if(o=l.tag,o===5||o===6){a=i=l;continue e}c=c.parentNode}}a=a.return}Ih(function(){var u=i,d=su(r),f=[];e:{var x=op.get(e);if(x!==void 0){var h=uu,p=e;switch(e){case"keypress":if(Oc(r)===0)break e;case"keydown":case"keyup":h=G2;break;case"focusin":p="focus",h=o0;break;case"focusout":p="blur",h=o0;break;case"beforeblur":case"afterblur":h=o0;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=Jf;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=I2;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=Y2;break;case sp:case ip:case lp:h=O2;break;case cp:h=J2;break;case"scroll":h=P2;break;case"wheel":h=Z2;break;case"copy":case"cut":case"paste":h=B2;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=Zf}var m=(t&4)!==0,w=!m&&e==="scroll",v=m?x!==null?x+"Capture":null:x;m=[];for(var b=u,y;b!==null;){y=b;var N=y.stateNode;if(y.tag===5&&N!==null&&(y=N,v!==null&&(N=fl(b,v),N!=null&&m.push(yl(b,N,y)))),w)break;b=b.return}0<m.length&&(x=new h(x,p,null,r,d),f.push({event:x,listeners:m}))}}if(!(t&7)){e:{if(x=e==="mouseover"||e==="pointerover",h=e==="mouseout"||e==="pointerout",x&&r!==td&&(p=r.relatedTarget||r.fromElement)&&(cs(p)||p[ha]))break e;if((h||x)&&(x=d.window===d?d:(x=d.ownerDocument)?x.defaultView||x.parentWindow:window,h?(p=r.relatedTarget||r.toElement,h=u,p=p?cs(p):null,p!==null&&(w=As(p),p!==w||p.tag!==5&&p.tag!==6)&&(p=null)):(h=null,p=u),h!==p)){if(m=Jf,N="onMouseLeave",v="onMouseEnter",b="mouse",(e==="pointerout"||e==="pointerover")&&(m=Zf,N="onPointerLeave",v="onPointerEnter",b="pointer"),w=h==null?x:Ks(h),y=p==null?x:Ks(p),x=new m(N,b+"leave",h,r,d),x.target=w,x.relatedTarget=y,N=null,cs(d)===u&&(m=new m(v,b+"enter",p,r,d),m.target=y,m.relatedTarget=w,N=m),w=N,h&&p)t:{for(m=h,v=p,b=0,y=m;y;y=Ls(y))b++;for(y=0,N=v;N;N=Ls(N))y++;for(;0<b-y;)m=Ls(m),b--;for(;0<y-b;)v=Ls(v),y--;for(;b--;){if(m===v||v!==null&&m===v.alternate)break t;m=Ls(m),v=Ls(v)}m=null}else m=null;h!==null&&dx(f,x,h,m,!1),p!==null&&w!==null&&dx(f,w,p,m,!0)}}e:{if(x=u?Ks(u):window,h=x.nodeName&&x.nodeName.toLowerCase(),h==="select"||h==="input"&&x.type==="file")var F=iy;else if(rx(x))if(ep)F=dy;else{F=cy;var j=ly}else(h=x.nodeName)&&h.toLowerCase()==="input"&&(x.type==="checkbox"||x.type==="radio")&&(F=oy);if(F&&(F=F(e,u))){Zh(f,F,r,d);break e}j&&j(e,x,u),e==="focusout"&&(j=x._wrapperState)&&j.controlled&&x.type==="number"&&q0(x,"number",x.value)}switch(j=u?Ks(u):window,e){case"focusin":(rx(j)||j.contentEditable==="true")&&(Gs=j,cd=u,Ji=null);break;case"focusout":Ji=cd=Gs=null;break;case"mousedown":od=!0;break;case"contextmenu":case"mouseup":case"dragend":od=!1,lx(f,r,d);break;case"selectionchange":if(xy)break;case"keydown":case"keyup":lx(f,r,d)}var k;if(xu)e:{switch(e){case"compositionstart":var S="onCompositionStart";break e;case"compositionend":S="onCompositionEnd";break e;case"compositionupdate":S="onCompositionUpdate";break e}S=void 0}else Vs?Jh(e,r)&&(S="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(S="onCompositionStart");S&&(qh&&r.locale!=="ko"&&(Vs||S!=="onCompositionStart"?S==="onCompositionEnd"&&Vs&&(k=Yh()):(Ma=d,du="value"in Ma?Ma.value:Ma.textContent,Vs=!0)),j=Qc(u,S),0<j.length&&(S=new Qf(S,e,null,r,d),f.push({event:S,listeners:j}),k?S.data=k:(k=Qh(r),k!==null&&(S.data=k)))),(k=ty?ry(e,r):ny(e,r))&&(u=Qc(u,"onBeforeInput"),0<u.length&&(d=new Qf("onBeforeInput","beforeinput",null,r,d),f.push({event:d,listeners:u}),d.data=k))}dp(f,t)})}function yl(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Qc(e,t){for(var r=t+"Capture",a=[];e!==null;){var s=e,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=fl(e,r),i!=null&&a.unshift(yl(e,i,s)),i=fl(e,t),i!=null&&a.push(yl(e,i,s))),e=e.return}return a}function Ls(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function dx(e,t,r,a,s){for(var i=t._reactName,l=[];r!==null&&r!==a;){var c=r,o=c.alternate,u=c.stateNode;if(o!==null&&o===a)break;c.tag===5&&u!==null&&(c=u,s?(o=fl(r,i),o!=null&&l.unshift(yl(r,o,c))):s||(o=fl(r,i),o!=null&&l.push(yl(r,o,c)))),r=r.return}l.length!==0&&e.push({event:t,listeners:l})}var gy=/\r\n?/g,vy=/\u0000|\uFFFD/g;function ux(e){return(typeof e=="string"?e:""+e).replace(gy,`
`).replace(vy,"")}function fc(e,t,r){if(t=ux(t),ux(e)!==t&&r)throw Error(Te(425))}function Zc(){}var dd=null,ud=null;function fd(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var xd=typeof setTimeout=="function"?setTimeout:void 0,yy=typeof clearTimeout=="function"?clearTimeout:void 0,fx=typeof Promise=="function"?Promise:void 0,by=typeof queueMicrotask=="function"?queueMicrotask:typeof fx<"u"?function(e){return fx.resolve(null).then(e).catch(wy)}:xd;function wy(e){setTimeout(function(){throw e})}function g0(e,t){var r=t,a=0;do{var s=r.nextSibling;if(e.removeChild(r),s&&s.nodeType===8)if(r=s.data,r==="/$"){if(a===0){e.removeChild(s),hl(t);return}a--}else r!=="$"&&r!=="$?"&&r!=="$!"||a++;r=s}while(r);hl(t)}function Wa(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function xx(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var _i=Math.random().toString(36).slice(2),Yn="__reactFiber$"+_i,bl="__reactProps$"+_i,ha="__reactContainer$"+_i,md="__reactEvents$"+_i,Ny="__reactListeners$"+_i,jy="__reactHandles$"+_i;function cs(e){var t=e[Yn];if(t)return t;for(var r=e.parentNode;r;){if(t=r[ha]||r[Yn]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=xx(e);e!==null;){if(r=e[Yn])return r;e=xx(e)}return t}e=r,r=e.parentNode}return null}function Gl(e){return e=e[Yn]||e[ha],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Ks(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Te(33))}function Mo(e){return e[bl]||null}var hd=[],Ys=-1;function es(e){return{current:e}}function St(e){0>Ys||(e.current=hd[Ys],hd[Ys]=null,Ys--)}function Nt(e,t){Ys++,hd[Ys]=e.current,e.current=t}var Ka={},Tr=es(Ka),Xr=es(!1),vs=Ka;function xi(e,t){var r=e.type.contextTypes;if(!r)return Ka;var a=e.stateNode;if(a&&a.__reactInternalMemoizedUnmaskedChildContext===t)return a.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in r)s[i]=t[i];return a&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function Kr(e){return e=e.childContextTypes,e!=null}function eo(){St(Xr),St(Tr)}function mx(e,t,r){if(Tr.current!==Ka)throw Error(Te(168));Nt(Tr,t),Nt(Xr,r)}function fp(e,t,r){var a=e.stateNode;if(t=t.childContextTypes,typeof a.getChildContext!="function")return r;a=a.getChildContext();for(var s in a)if(!(s in t))throw Error(Te(108,l2(e)||"Unknown",s));return Lt({},r,a)}function to(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ka,vs=Tr.current,Nt(Tr,e),Nt(Xr,Xr.current),!0}function hx(e,t,r){var a=e.stateNode;if(!a)throw Error(Te(169));r?(e=fp(e,t,vs),a.__reactInternalMemoizedMergedChildContext=e,St(Xr),St(Tr),Nt(Tr,e)):St(Xr),Nt(Xr,r)}var ia=null,Ro=!1,v0=!1;function xp(e){ia===null?ia=[e]:ia.push(e)}function ky(e){Ro=!0,xp(e)}function ts(){if(!v0&&ia!==null){v0=!0;var e=0,t=gt;try{var r=ia;for(gt=1;e<r.length;e++){var a=r[e];do a=a(!0);while(a!==null)}ia=null,Ro=!1}catch(s){throw ia!==null&&(ia=ia.slice(e+1)),Lh(iu,ts),s}finally{gt=t,v0=!1}}return null}var qs=[],Js=0,ro=null,no=0,vn=[],yn=0,ys=null,la=1,ca="";function ss(e,t){qs[Js++]=no,qs[Js++]=ro,ro=e,no=t}function mp(e,t,r){vn[yn++]=la,vn[yn++]=ca,vn[yn++]=ys,ys=e;var a=la;e=ca;var s=32-Ln(a)-1;a&=~(1<<s),r+=1;var i=32-Ln(t)+s;if(30<i){var l=s-s%5;i=(a&(1<<l)-1).toString(32),a>>=l,s-=l,la=1<<32-Ln(t)+s|r<<s|a,ca=i+e}else la=1<<i|r<<s|a,ca=e}function hu(e){e.return!==null&&(ss(e,1),mp(e,1,0))}function pu(e){for(;e===ro;)ro=qs[--Js],qs[Js]=null,no=qs[--Js],qs[Js]=null;for(;e===ys;)ys=vn[--yn],vn[yn]=null,ca=vn[--yn],vn[yn]=null,la=vn[--yn],vn[yn]=null}var sn=null,an=null,At=!1,Mn=null;function hp(e,t){var r=bn(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function px(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,sn=e,an=Wa(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,sn=e,an=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=ys!==null?{id:la,overflow:ca}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=bn(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,sn=e,an=null,!0):!1;default:return!1}}function pd(e){return(e.mode&1)!==0&&(e.flags&128)===0}function gd(e){if(At){var t=an;if(t){var r=t;if(!px(e,t)){if(pd(e))throw Error(Te(418));t=Wa(r.nextSibling);var a=sn;t&&px(e,t)?hp(a,r):(e.flags=e.flags&-4097|2,At=!1,sn=e)}}else{if(pd(e))throw Error(Te(418));e.flags=e.flags&-4097|2,At=!1,sn=e}}}function gx(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;sn=e}function xc(e){if(e!==sn)return!1;if(!At)return gx(e),At=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!fd(e.type,e.memoizedProps)),t&&(t=an)){if(pd(e))throw pp(),Error(Te(418));for(;t;)hp(e,t),t=Wa(t.nextSibling)}if(gx(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Te(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){an=Wa(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}an=null}}else an=sn?Wa(e.stateNode.nextSibling):null;return!0}function pp(){for(var e=an;e;)e=Wa(e.nextSibling)}function mi(){an=sn=null,At=!1}function gu(e){Mn===null?Mn=[e]:Mn.push(e)}var _y=ya.ReactCurrentBatchConfig;function Ri(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Te(309));var a=r.stateNode}if(!a)throw Error(Te(147,e));var s=a,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(l){var c=s.refs;l===null?delete c[i]:c[i]=l},t._stringRef=i,t)}if(typeof e!="string")throw Error(Te(284));if(!r._owner)throw Error(Te(290,e))}return e}function mc(e,t){throw e=Object.prototype.toString.call(t),Error(Te(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function vx(e){var t=e._init;return t(e._payload)}function gp(e){function t(v,b){if(e){var y=v.deletions;y===null?(v.deletions=[b],v.flags|=16):y.push(b)}}function r(v,b){if(!e)return null;for(;b!==null;)t(v,b),b=b.sibling;return null}function a(v,b){for(v=new Map;b!==null;)b.key!==null?v.set(b.key,b):v.set(b.index,b),b=b.sibling;return v}function s(v,b){return v=Ga(v,b),v.index=0,v.sibling=null,v}function i(v,b,y){return v.index=y,e?(y=v.alternate,y!==null?(y=y.index,y<b?(v.flags|=2,b):y):(v.flags|=2,b)):(v.flags|=1048576,b)}function l(v){return e&&v.alternate===null&&(v.flags|=2),v}function c(v,b,y,N){return b===null||b.tag!==6?(b=_0(y,v.mode,N),b.return=v,b):(b=s(b,y),b.return=v,b)}function o(v,b,y,N){var F=y.type;return F===$s?d(v,b,y.props.children,N,y.key):b!==null&&(b.elementType===F||typeof F=="object"&&F!==null&&F.$$typeof===Fa&&vx(F)===b.type)?(N=s(b,y.props),N.ref=Ri(v,b,y),N.return=v,N):(N=$c(y.type,y.key,y.props,null,v.mode,N),N.ref=Ri(v,b,y),N.return=v,N)}function u(v,b,y,N){return b===null||b.tag!==4||b.stateNode.containerInfo!==y.containerInfo||b.stateNode.implementation!==y.implementation?(b=S0(y,v.mode,N),b.return=v,b):(b=s(b,y.children||[]),b.return=v,b)}function d(v,b,y,N,F){return b===null||b.tag!==7?(b=xs(y,v.mode,N,F),b.return=v,b):(b=s(b,y),b.return=v,b)}function f(v,b,y){if(typeof b=="string"&&b!==""||typeof b=="number")return b=_0(""+b,v.mode,y),b.return=v,b;if(typeof b=="object"&&b!==null){switch(b.$$typeof){case nc:return y=$c(b.type,b.key,b.props,null,v.mode,y),y.ref=Ri(v,null,b),y.return=v,y;case Hs:return b=S0(b,v.mode,y),b.return=v,b;case Fa:var N=b._init;return f(v,N(b._payload),y)}if(zi(b)||Ai(b))return b=xs(b,v.mode,y,null),b.return=v,b;mc(v,b)}return null}function x(v,b,y,N){var F=b!==null?b.key:null;if(typeof y=="string"&&y!==""||typeof y=="number")return F!==null?null:c(v,b,""+y,N);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case nc:return y.key===F?o(v,b,y,N):null;case Hs:return y.key===F?u(v,b,y,N):null;case Fa:return F=y._init,x(v,b,F(y._payload),N)}if(zi(y)||Ai(y))return F!==null?null:d(v,b,y,N,null);mc(v,y)}return null}function h(v,b,y,N,F){if(typeof N=="string"&&N!==""||typeof N=="number")return v=v.get(y)||null,c(b,v,""+N,F);if(typeof N=="object"&&N!==null){switch(N.$$typeof){case nc:return v=v.get(N.key===null?y:N.key)||null,o(b,v,N,F);case Hs:return v=v.get(N.key===null?y:N.key)||null,u(b,v,N,F);case Fa:var j=N._init;return h(v,b,y,j(N._payload),F)}if(zi(N)||Ai(N))return v=v.get(y)||null,d(b,v,N,F,null);mc(b,N)}return null}function p(v,b,y,N){for(var F=null,j=null,k=b,S=b=0,P=null;k!==null&&S<y.length;S++){k.index>S?(P=k,k=null):P=k.sibling;var D=x(v,k,y[S],N);if(D===null){k===null&&(k=P);break}e&&k&&D.alternate===null&&t(v,k),b=i(D,b,S),j===null?F=D:j.sibling=D,j=D,k=P}if(S===y.length)return r(v,k),At&&ss(v,S),F;if(k===null){for(;S<y.length;S++)k=f(v,y[S],N),k!==null&&(b=i(k,b,S),j===null?F=k:j.sibling=k,j=k);return At&&ss(v,S),F}for(k=a(v,k);S<y.length;S++)P=h(k,v,S,y[S],N),P!==null&&(e&&P.alternate!==null&&k.delete(P.key===null?S:P.key),b=i(P,b,S),j===null?F=P:j.sibling=P,j=P);return e&&k.forEach(function(K){return t(v,K)}),At&&ss(v,S),F}function m(v,b,y,N){var F=Ai(y);if(typeof F!="function")throw Error(Te(150));if(y=F.call(y),y==null)throw Error(Te(151));for(var j=F=null,k=b,S=b=0,P=null,D=y.next();k!==null&&!D.done;S++,D=y.next()){k.index>S?(P=k,k=null):P=k.sibling;var K=x(v,k,D.value,N);if(K===null){k===null&&(k=P);break}e&&k&&K.alternate===null&&t(v,k),b=i(K,b,S),j===null?F=K:j.sibling=K,j=K,k=P}if(D.done)return r(v,k),At&&ss(v,S),F;if(k===null){for(;!D.done;S++,D=y.next())D=f(v,D.value,N),D!==null&&(b=i(D,b,S),j===null?F=D:j.sibling=D,j=D);return At&&ss(v,S),F}for(k=a(v,k);!D.done;S++,D=y.next())D=h(k,v,S,D.value,N),D!==null&&(e&&D.alternate!==null&&k.delete(D.key===null?S:D.key),b=i(D,b,S),j===null?F=D:j.sibling=D,j=D);return e&&k.forEach(function(C){return t(v,C)}),At&&ss(v,S),F}function w(v,b,y,N){if(typeof y=="object"&&y!==null&&y.type===$s&&y.key===null&&(y=y.props.children),typeof y=="object"&&y!==null){switch(y.$$typeof){case nc:e:{for(var F=y.key,j=b;j!==null;){if(j.key===F){if(F=y.type,F===$s){if(j.tag===7){r(v,j.sibling),b=s(j,y.props.children),b.return=v,v=b;break e}}else if(j.elementType===F||typeof F=="object"&&F!==null&&F.$$typeof===Fa&&vx(F)===j.type){r(v,j.sibling),b=s(j,y.props),b.ref=Ri(v,j,y),b.return=v,v=b;break e}r(v,j);break}else t(v,j);j=j.sibling}y.type===$s?(b=xs(y.props.children,v.mode,N,y.key),b.return=v,v=b):(N=$c(y.type,y.key,y.props,null,v.mode,N),N.ref=Ri(v,b,y),N.return=v,v=N)}return l(v);case Hs:e:{for(j=y.key;b!==null;){if(b.key===j)if(b.tag===4&&b.stateNode.containerInfo===y.containerInfo&&b.stateNode.implementation===y.implementation){r(v,b.sibling),b=s(b,y.children||[]),b.return=v,v=b;break e}else{r(v,b);break}else t(v,b);b=b.sibling}b=S0(y,v.mode,N),b.return=v,v=b}return l(v);case Fa:return j=y._init,w(v,b,j(y._payload),N)}if(zi(y))return p(v,b,y,N);if(Ai(y))return m(v,b,y,N);mc(v,y)}return typeof y=="string"&&y!==""||typeof y=="number"?(y=""+y,b!==null&&b.tag===6?(r(v,b.sibling),b=s(b,y),b.return=v,v=b):(r(v,b),b=_0(y,v.mode,N),b.return=v,v=b),l(v)):r(v,b)}return w}var hi=gp(!0),vp=gp(!1),ao=es(null),so=null,Qs=null,vu=null;function yu(){vu=Qs=so=null}function bu(e){var t=ao.current;St(ao),e._currentValue=t}function vd(e,t,r){for(;e!==null;){var a=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,a!==null&&(a.childLanes|=t)):a!==null&&(a.childLanes&t)!==t&&(a.childLanes|=t),e===r)break;e=e.return}}function ii(e,t){so=e,vu=Qs=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Gr=!0),e.firstContext=null)}function jn(e){var t=e._currentValue;if(vu!==e)if(e={context:e,memoizedValue:t,next:null},Qs===null){if(so===null)throw Error(Te(308));Qs=e,so.dependencies={lanes:0,firstContext:e}}else Qs=Qs.next=e;return t}var os=null;function wu(e){os===null?os=[e]:os.push(e)}function yp(e,t,r,a){var s=t.interleaved;return s===null?(r.next=r,wu(t)):(r.next=s.next,s.next=r),t.interleaved=r,pa(e,a)}function pa(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Aa=!1;function Nu(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function bp(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function da(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Ha(e,t,r){var a=e.updateQueue;if(a===null)return null;if(a=a.shared,ot&2){var s=a.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),a.pending=t,pa(e,r)}return s=a.interleaved,s===null?(t.next=t,wu(a)):(t.next=s.next,s.next=t),a.interleaved=t,pa(e,r)}function Lc(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var a=t.lanes;a&=e.pendingLanes,r|=a,t.lanes=r,lu(e,r)}}function yx(e,t){var r=e.updateQueue,a=e.alternate;if(a!==null&&(a=a.updateQueue,r===a)){var s=null,i=null;if(r=r.firstBaseUpdate,r!==null){do{var l={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};i===null?s=i=l:i=i.next=l,r=r.next}while(r!==null);i===null?s=i=t:i=i.next=t}else s=i=t;r={baseState:a.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:a.shared,effects:a.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function io(e,t,r,a){var s=e.updateQueue;Aa=!1;var i=s.firstBaseUpdate,l=s.lastBaseUpdate,c=s.shared.pending;if(c!==null){s.shared.pending=null;var o=c,u=o.next;o.next=null,l===null?i=u:l.next=u,l=o;var d=e.alternate;d!==null&&(d=d.updateQueue,c=d.lastBaseUpdate,c!==l&&(c===null?d.firstBaseUpdate=u:c.next=u,d.lastBaseUpdate=o))}if(i!==null){var f=s.baseState;l=0,d=u=o=null,c=i;do{var x=c.lane,h=c.eventTime;if((a&x)===x){d!==null&&(d=d.next={eventTime:h,lane:0,tag:c.tag,payload:c.payload,callback:c.callback,next:null});e:{var p=e,m=c;switch(x=t,h=r,m.tag){case 1:if(p=m.payload,typeof p=="function"){f=p.call(h,f,x);break e}f=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=m.payload,x=typeof p=="function"?p.call(h,f,x):p,x==null)break e;f=Lt({},f,x);break e;case 2:Aa=!0}}c.callback!==null&&c.lane!==0&&(e.flags|=64,x=s.effects,x===null?s.effects=[c]:x.push(c))}else h={eventTime:h,lane:x,tag:c.tag,payload:c.payload,callback:c.callback,next:null},d===null?(u=d=h,o=f):d=d.next=h,l|=x;if(c=c.next,c===null){if(c=s.shared.pending,c===null)break;x=c,c=x.next,x.next=null,s.lastBaseUpdate=x,s.shared.pending=null}}while(!0);if(d===null&&(o=f),s.baseState=o,s.firstBaseUpdate=u,s.lastBaseUpdate=d,t=s.shared.interleaved,t!==null){s=t;do l|=s.lane,s=s.next;while(s!==t)}else i===null&&(s.shared.lanes=0);ws|=l,e.lanes=l,e.memoizedState=f}}function bx(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var a=e[t],s=a.callback;if(s!==null){if(a.callback=null,a=r,typeof s!="function")throw Error(Te(191,s));s.call(a)}}}var Xl={},Qn=es(Xl),wl=es(Xl),Nl=es(Xl);function ds(e){if(e===Xl)throw Error(Te(174));return e}function ju(e,t){switch(Nt(Nl,t),Nt(wl,e),Nt(Qn,Xl),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Q0(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Q0(t,e)}St(Qn),Nt(Qn,t)}function pi(){St(Qn),St(wl),St(Nl)}function wp(e){ds(Nl.current);var t=ds(Qn.current),r=Q0(t,e.type);t!==r&&(Nt(wl,e),Nt(Qn,r))}function ku(e){wl.current===e&&(St(Qn),St(wl))}var It=es(0);function lo(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var y0=[];function _u(){for(var e=0;e<y0.length;e++)y0[e]._workInProgressVersionPrimary=null;y0.length=0}var Bc=ya.ReactCurrentDispatcher,b0=ya.ReactCurrentBatchConfig,bs=0,Ot=null,Qt=null,ir=null,co=!1,Qi=!1,jl=0,Sy=0;function br(){throw Error(Te(321))}function Su(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Wn(e[r],t[r]))return!1;return!0}function Cu(e,t,r,a,s,i){if(bs=i,Ot=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Bc.current=e===null||e.memoizedState===null?Fy:Ay,e=r(a,s),Qi){i=0;do{if(Qi=!1,jl=0,25<=i)throw Error(Te(301));i+=1,ir=Qt=null,t.updateQueue=null,Bc.current=Py,e=r(a,s)}while(Qi)}if(Bc.current=oo,t=Qt!==null&&Qt.next!==null,bs=0,ir=Qt=Ot=null,co=!1,t)throw Error(Te(300));return e}function Eu(){var e=jl!==0;return jl=0,e}function Kn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ir===null?Ot.memoizedState=ir=e:ir=ir.next=e,ir}function kn(){if(Qt===null){var e=Ot.alternate;e=e!==null?e.memoizedState:null}else e=Qt.next;var t=ir===null?Ot.memoizedState:ir.next;if(t!==null)ir=t,Qt=e;else{if(e===null)throw Error(Te(310));Qt=e,e={memoizedState:Qt.memoizedState,baseState:Qt.baseState,baseQueue:Qt.baseQueue,queue:Qt.queue,next:null},ir===null?Ot.memoizedState=ir=e:ir=ir.next=e}return ir}function kl(e,t){return typeof t=="function"?t(e):t}function w0(e){var t=kn(),r=t.queue;if(r===null)throw Error(Te(311));r.lastRenderedReducer=e;var a=Qt,s=a.baseQueue,i=r.pending;if(i!==null){if(s!==null){var l=s.next;s.next=i.next,i.next=l}a.baseQueue=s=i,r.pending=null}if(s!==null){i=s.next,a=a.baseState;var c=l=null,o=null,u=i;do{var d=u.lane;if((bs&d)===d)o!==null&&(o=o.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),a=u.hasEagerState?u.eagerState:e(a,u.action);else{var f={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};o===null?(c=o=f,l=a):o=o.next=f,Ot.lanes|=d,ws|=d}u=u.next}while(u!==null&&u!==i);o===null?l=a:o.next=c,Wn(a,t.memoizedState)||(Gr=!0),t.memoizedState=a,t.baseState=l,t.baseQueue=o,r.lastRenderedState=a}if(e=r.interleaved,e!==null){s=e;do i=s.lane,Ot.lanes|=i,ws|=i,s=s.next;while(s!==e)}else s===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function N0(e){var t=kn(),r=t.queue;if(r===null)throw Error(Te(311));r.lastRenderedReducer=e;var a=r.dispatch,s=r.pending,i=t.memoizedState;if(s!==null){r.pending=null;var l=s=s.next;do i=e(i,l.action),l=l.next;while(l!==s);Wn(i,t.memoizedState)||(Gr=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),r.lastRenderedState=i}return[i,a]}function Np(){}function jp(e,t){var r=Ot,a=kn(),s=t(),i=!Wn(a.memoizedState,s);if(i&&(a.memoizedState=s,Gr=!0),a=a.queue,Tu(Sp.bind(null,r,a,e),[e]),a.getSnapshot!==t||i||ir!==null&&ir.memoizedState.tag&1){if(r.flags|=2048,_l(9,_p.bind(null,r,a,s,t),void 0,null),or===null)throw Error(Te(349));bs&30||kp(r,t,s)}return s}function kp(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=Ot.updateQueue,t===null?(t={lastEffect:null,stores:null},Ot.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function _p(e,t,r,a){t.value=r,t.getSnapshot=a,Cp(t)&&Ep(e)}function Sp(e,t,r){return r(function(){Cp(t)&&Ep(e)})}function Cp(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Wn(e,r)}catch{return!0}}function Ep(e){var t=pa(e,1);t!==null&&Bn(t,e,1,-1)}function wx(e){var t=Kn();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:kl,lastRenderedState:e},t.queue=e,e=e.dispatch=Ty.bind(null,Ot,e),[t.memoizedState,e]}function _l(e,t,r,a){return e={tag:e,create:t,destroy:r,deps:a,next:null},t=Ot.updateQueue,t===null?(t={lastEffect:null,stores:null},Ot.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(a=r.next,r.next=e,e.next=a,t.lastEffect=e)),e}function Tp(){return kn().memoizedState}function Uc(e,t,r,a){var s=Kn();Ot.flags|=e,s.memoizedState=_l(1|t,r,void 0,a===void 0?null:a)}function Oo(e,t,r,a){var s=kn();a=a===void 0?null:a;var i=void 0;if(Qt!==null){var l=Qt.memoizedState;if(i=l.destroy,a!==null&&Su(a,l.deps)){s.memoizedState=_l(t,r,i,a);return}}Ot.flags|=e,s.memoizedState=_l(1|t,r,i,a)}function Nx(e,t){return Uc(8390656,8,e,t)}function Tu(e,t){return Oo(2048,8,e,t)}function Fp(e,t){return Oo(4,2,e,t)}function Ap(e,t){return Oo(4,4,e,t)}function Pp(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Dp(e,t,r){return r=r!=null?r.concat([e]):null,Oo(4,4,Pp.bind(null,t,e),r)}function Fu(){}function Ip(e,t){var r=kn();t=t===void 0?null:t;var a=r.memoizedState;return a!==null&&t!==null&&Su(t,a[1])?a[0]:(r.memoizedState=[e,t],e)}function Mp(e,t){var r=kn();t=t===void 0?null:t;var a=r.memoizedState;return a!==null&&t!==null&&Su(t,a[1])?a[0]:(e=e(),r.memoizedState=[e,t],e)}function Rp(e,t,r){return bs&21?(Wn(r,t)||(r=zh(),Ot.lanes|=r,ws|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Gr=!0),e.memoizedState=r)}function Cy(e,t){var r=gt;gt=r!==0&&4>r?r:4,e(!0);var a=b0.transition;b0.transition={};try{e(!1),t()}finally{gt=r,b0.transition=a}}function Op(){return kn().memoizedState}function Ey(e,t,r){var a=Va(e);if(r={lane:a,action:r,hasEagerState:!1,eagerState:null,next:null},Lp(e))Bp(t,r);else if(r=yp(e,t,r,a),r!==null){var s=Or();Bn(r,e,a,s),Up(r,t,a)}}function Ty(e,t,r){var a=Va(e),s={lane:a,action:r,hasEagerState:!1,eagerState:null,next:null};if(Lp(e))Bp(t,s);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var l=t.lastRenderedState,c=i(l,r);if(s.hasEagerState=!0,s.eagerState=c,Wn(c,l)){var o=t.interleaved;o===null?(s.next=s,wu(t)):(s.next=o.next,o.next=s),t.interleaved=s;return}}catch{}finally{}r=yp(e,t,s,a),r!==null&&(s=Or(),Bn(r,e,a,s),Up(r,t,a))}}function Lp(e){var t=e.alternate;return e===Ot||t!==null&&t===Ot}function Bp(e,t){Qi=co=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function Up(e,t,r){if(r&4194240){var a=t.lanes;a&=e.pendingLanes,r|=a,t.lanes=r,lu(e,r)}}var oo={readContext:jn,useCallback:br,useContext:br,useEffect:br,useImperativeHandle:br,useInsertionEffect:br,useLayoutEffect:br,useMemo:br,useReducer:br,useRef:br,useState:br,useDebugValue:br,useDeferredValue:br,useTransition:br,useMutableSource:br,useSyncExternalStore:br,useId:br,unstable_isNewReconciler:!1},Fy={readContext:jn,useCallback:function(e,t){return Kn().memoizedState=[e,t===void 0?null:t],e},useContext:jn,useEffect:Nx,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,Uc(4194308,4,Pp.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Uc(4194308,4,e,t)},useInsertionEffect:function(e,t){return Uc(4,2,e,t)},useMemo:function(e,t){var r=Kn();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var a=Kn();return t=r!==void 0?r(t):t,a.memoizedState=a.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},a.queue=e,e=e.dispatch=Ey.bind(null,Ot,e),[a.memoizedState,e]},useRef:function(e){var t=Kn();return e={current:e},t.memoizedState=e},useState:wx,useDebugValue:Fu,useDeferredValue:function(e){return Kn().memoizedState=e},useTransition:function(){var e=wx(!1),t=e[0];return e=Cy.bind(null,e[1]),Kn().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var a=Ot,s=Kn();if(At){if(r===void 0)throw Error(Te(407));r=r()}else{if(r=t(),or===null)throw Error(Te(349));bs&30||kp(a,t,r)}s.memoizedState=r;var i={value:r,getSnapshot:t};return s.queue=i,Nx(Sp.bind(null,a,i,e),[e]),a.flags|=2048,_l(9,_p.bind(null,a,i,r,t),void 0,null),r},useId:function(){var e=Kn(),t=or.identifierPrefix;if(At){var r=ca,a=la;r=(a&~(1<<32-Ln(a)-1)).toString(32)+r,t=":"+t+"R"+r,r=jl++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=Sy++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Ay={readContext:jn,useCallback:Ip,useContext:jn,useEffect:Tu,useImperativeHandle:Dp,useInsertionEffect:Fp,useLayoutEffect:Ap,useMemo:Mp,useReducer:w0,useRef:Tp,useState:function(){return w0(kl)},useDebugValue:Fu,useDeferredValue:function(e){var t=kn();return Rp(t,Qt.memoizedState,e)},useTransition:function(){var e=w0(kl)[0],t=kn().memoizedState;return[e,t]},useMutableSource:Np,useSyncExternalStore:jp,useId:Op,unstable_isNewReconciler:!1},Py={readContext:jn,useCallback:Ip,useContext:jn,useEffect:Tu,useImperativeHandle:Dp,useInsertionEffect:Fp,useLayoutEffect:Ap,useMemo:Mp,useReducer:N0,useRef:Tp,useState:function(){return N0(kl)},useDebugValue:Fu,useDeferredValue:function(e){var t=kn();return Qt===null?t.memoizedState=e:Rp(t,Qt.memoizedState,e)},useTransition:function(){var e=N0(kl)[0],t=kn().memoizedState;return[e,t]},useMutableSource:Np,useSyncExternalStore:jp,useId:Op,unstable_isNewReconciler:!1};function Dn(e,t){if(e&&e.defaultProps){t=Lt({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function yd(e,t,r,a){t=e.memoizedState,r=r(a,t),r=r==null?t:Lt({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var Lo={isMounted:function(e){return(e=e._reactInternals)?As(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var a=Or(),s=Va(e),i=da(a,s);i.payload=t,r!=null&&(i.callback=r),t=Ha(e,i,s),t!==null&&(Bn(t,e,s,a),Lc(t,e,s))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var a=Or(),s=Va(e),i=da(a,s);i.tag=1,i.payload=t,r!=null&&(i.callback=r),t=Ha(e,i,s),t!==null&&(Bn(t,e,s,a),Lc(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Or(),a=Va(e),s=da(r,a);s.tag=2,t!=null&&(s.callback=t),t=Ha(e,s,a),t!==null&&(Bn(t,e,a,r),Lc(t,e,a))}};function jx(e,t,r,a,s,i,l){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(a,i,l):t.prototype&&t.prototype.isPureReactComponent?!gl(r,a)||!gl(s,i):!0}function zp(e,t,r){var a=!1,s=Ka,i=t.contextType;return typeof i=="object"&&i!==null?i=jn(i):(s=Kr(t)?vs:Tr.current,a=t.contextTypes,i=(a=a!=null)?xi(e,s):Ka),t=new t(r,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Lo,e.stateNode=t,t._reactInternals=e,a&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=i),t}function kx(e,t,r,a){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,a),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,a),t.state!==e&&Lo.enqueueReplaceState(t,t.state,null)}function bd(e,t,r,a){var s=e.stateNode;s.props=r,s.state=e.memoizedState,s.refs={},Nu(e);var i=t.contextType;typeof i=="object"&&i!==null?s.context=jn(i):(i=Kr(t)?vs:Tr.current,s.context=xi(e,i)),s.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(yd(e,t,i,r),s.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(t=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),t!==s.state&&Lo.enqueueReplaceState(s,s.state,null),io(e,r,s,a),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308)}function gi(e,t){try{var r="",a=t;do r+=i2(a),a=a.return;while(a);var s=r}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:s,digest:null}}function j0(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function wd(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var Dy=typeof WeakMap=="function"?WeakMap:Map;function Wp(e,t,r){r=da(-1,r),r.tag=3,r.payload={element:null};var a=t.value;return r.callback=function(){fo||(fo=!0,Ad=a),wd(e,t)},r}function Hp(e,t,r){r=da(-1,r),r.tag=3;var a=e.type.getDerivedStateFromError;if(typeof a=="function"){var s=t.value;r.payload=function(){return a(s)},r.callback=function(){wd(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(r.callback=function(){wd(e,t),typeof a!="function"&&($a===null?$a=new Set([this]):$a.add(this));var l=t.stack;this.componentDidCatch(t.value,{componentStack:l!==null?l:""})}),r}function _x(e,t,r){var a=e.pingCache;if(a===null){a=e.pingCache=new Dy;var s=new Set;a.set(t,s)}else s=a.get(t),s===void 0&&(s=new Set,a.set(t,s));s.has(r)||(s.add(r),e=Xy.bind(null,e,t,r),t.then(e,e))}function Sx(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Cx(e,t,r,a,s){return e.mode&1?(e.flags|=65536,e.lanes=s,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=da(-1,1),t.tag=2,Ha(r,t,1))),r.lanes|=1),e)}var Iy=ya.ReactCurrentOwner,Gr=!1;function Ir(e,t,r,a){t.child=e===null?vp(t,null,r,a):hi(t,e.child,r,a)}function Ex(e,t,r,a,s){r=r.render;var i=t.ref;return ii(t,s),a=Cu(e,t,r,a,i,s),r=Eu(),e!==null&&!Gr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,ga(e,t,s)):(At&&r&&hu(t),t.flags|=1,Ir(e,t,a,s),t.child)}function Tx(e,t,r,a,s){if(e===null){var i=r.type;return typeof i=="function"&&!Lu(i)&&i.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=i,$p(e,t,i,a,s)):(e=$c(r.type,null,a,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&s)){var l=i.memoizedProps;if(r=r.compare,r=r!==null?r:gl,r(l,a)&&e.ref===t.ref)return ga(e,t,s)}return t.flags|=1,e=Ga(i,a),e.ref=t.ref,e.return=t,t.child=e}function $p(e,t,r,a,s){if(e!==null){var i=e.memoizedProps;if(gl(i,a)&&e.ref===t.ref)if(Gr=!1,t.pendingProps=a=i,(e.lanes&s)!==0)e.flags&131072&&(Gr=!0);else return t.lanes=e.lanes,ga(e,t,s)}return Nd(e,t,r,a,s)}function Vp(e,t,r){var a=t.pendingProps,s=a.children,i=e!==null?e.memoizedState:null;if(a.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Nt(ei,Zr),Zr|=r;else{if(!(r&1073741824))return e=i!==null?i.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Nt(ei,Zr),Zr|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},a=i!==null?i.baseLanes:r,Nt(ei,Zr),Zr|=a}else i!==null?(a=i.baseLanes|r,t.memoizedState=null):a=r,Nt(ei,Zr),Zr|=a;return Ir(e,t,s,r),t.child}function Gp(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function Nd(e,t,r,a,s){var i=Kr(r)?vs:Tr.current;return i=xi(t,i),ii(t,s),r=Cu(e,t,r,a,i,s),a=Eu(),e!==null&&!Gr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,ga(e,t,s)):(At&&a&&hu(t),t.flags|=1,Ir(e,t,r,s),t.child)}function Fx(e,t,r,a,s){if(Kr(r)){var i=!0;to(t)}else i=!1;if(ii(t,s),t.stateNode===null)zc(e,t),zp(t,r,a),bd(t,r,a,s),a=!0;else if(e===null){var l=t.stateNode,c=t.memoizedProps;l.props=c;var o=l.context,u=r.contextType;typeof u=="object"&&u!==null?u=jn(u):(u=Kr(r)?vs:Tr.current,u=xi(t,u));var d=r.getDerivedStateFromProps,f=typeof d=="function"||typeof l.getSnapshotBeforeUpdate=="function";f||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(c!==a||o!==u)&&kx(t,l,a,u),Aa=!1;var x=t.memoizedState;l.state=x,io(t,a,l,s),o=t.memoizedState,c!==a||x!==o||Xr.current||Aa?(typeof d=="function"&&(yd(t,r,d,a),o=t.memoizedState),(c=Aa||jx(t,r,c,a,x,o,u))?(f||typeof l.UNSAFE_componentWillMount!="function"&&typeof l.componentWillMount!="function"||(typeof l.componentWillMount=="function"&&l.componentWillMount(),typeof l.UNSAFE_componentWillMount=="function"&&l.UNSAFE_componentWillMount()),typeof l.componentDidMount=="function"&&(t.flags|=4194308)):(typeof l.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=a,t.memoizedState=o),l.props=a,l.state=o,l.context=u,a=c):(typeof l.componentDidMount=="function"&&(t.flags|=4194308),a=!1)}else{l=t.stateNode,bp(e,t),c=t.memoizedProps,u=t.type===t.elementType?c:Dn(t.type,c),l.props=u,f=t.pendingProps,x=l.context,o=r.contextType,typeof o=="object"&&o!==null?o=jn(o):(o=Kr(r)?vs:Tr.current,o=xi(t,o));var h=r.getDerivedStateFromProps;(d=typeof h=="function"||typeof l.getSnapshotBeforeUpdate=="function")||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(c!==f||x!==o)&&kx(t,l,a,o),Aa=!1,x=t.memoizedState,l.state=x,io(t,a,l,s);var p=t.memoizedState;c!==f||x!==p||Xr.current||Aa?(typeof h=="function"&&(yd(t,r,h,a),p=t.memoizedState),(u=Aa||jx(t,r,u,a,x,p,o)||!1)?(d||typeof l.UNSAFE_componentWillUpdate!="function"&&typeof l.componentWillUpdate!="function"||(typeof l.componentWillUpdate=="function"&&l.componentWillUpdate(a,p,o),typeof l.UNSAFE_componentWillUpdate=="function"&&l.UNSAFE_componentWillUpdate(a,p,o)),typeof l.componentDidUpdate=="function"&&(t.flags|=4),typeof l.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof l.componentDidUpdate!="function"||c===e.memoizedProps&&x===e.memoizedState||(t.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||c===e.memoizedProps&&x===e.memoizedState||(t.flags|=1024),t.memoizedProps=a,t.memoizedState=p),l.props=a,l.state=p,l.context=o,a=u):(typeof l.componentDidUpdate!="function"||c===e.memoizedProps&&x===e.memoizedState||(t.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||c===e.memoizedProps&&x===e.memoizedState||(t.flags|=1024),a=!1)}return jd(e,t,r,a,i,s)}function jd(e,t,r,a,s,i){Gp(e,t);var l=(t.flags&128)!==0;if(!a&&!l)return s&&hx(t,r,!1),ga(e,t,i);a=t.stateNode,Iy.current=t;var c=l&&typeof r.getDerivedStateFromError!="function"?null:a.render();return t.flags|=1,e!==null&&l?(t.child=hi(t,e.child,null,i),t.child=hi(t,null,c,i)):Ir(e,t,c,i),t.memoizedState=a.state,s&&hx(t,r,!0),t.child}function Xp(e){var t=e.stateNode;t.pendingContext?mx(e,t.pendingContext,t.pendingContext!==t.context):t.context&&mx(e,t.context,!1),ju(e,t.containerInfo)}function Ax(e,t,r,a,s){return mi(),gu(s),t.flags|=256,Ir(e,t,r,a),t.child}var kd={dehydrated:null,treeContext:null,retryLane:0};function _d(e){return{baseLanes:e,cachePool:null,transitions:null}}function Kp(e,t,r){var a=t.pendingProps,s=It.current,i=!1,l=(t.flags&128)!==0,c;if((c=l)||(c=e!==null&&e.memoizedState===null?!1:(s&2)!==0),c?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(s|=1),Nt(It,s&1),e===null)return gd(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(l=a.children,e=a.fallback,i?(a=t.mode,i=t.child,l={mode:"hidden",children:l},!(a&1)&&i!==null?(i.childLanes=0,i.pendingProps=l):i=zo(l,a,0,null),e=xs(e,a,r,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=_d(r),t.memoizedState=kd,e):Au(t,l));if(s=e.memoizedState,s!==null&&(c=s.dehydrated,c!==null))return My(e,t,l,a,c,s,r);if(i){i=a.fallback,l=t.mode,s=e.child,c=s.sibling;var o={mode:"hidden",children:a.children};return!(l&1)&&t.child!==s?(a=t.child,a.childLanes=0,a.pendingProps=o,t.deletions=null):(a=Ga(s,o),a.subtreeFlags=s.subtreeFlags&14680064),c!==null?i=Ga(c,i):(i=xs(i,l,r,null),i.flags|=2),i.return=t,a.return=t,a.sibling=i,t.child=a,a=i,i=t.child,l=e.child.memoizedState,l=l===null?_d(r):{baseLanes:l.baseLanes|r,cachePool:null,transitions:l.transitions},i.memoizedState=l,i.childLanes=e.childLanes&~r,t.memoizedState=kd,a}return i=e.child,e=i.sibling,a=Ga(i,{mode:"visible",children:a.children}),!(t.mode&1)&&(a.lanes=r),a.return=t,a.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=a,t.memoizedState=null,a}function Au(e,t){return t=zo({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function hc(e,t,r,a){return a!==null&&gu(a),hi(t,e.child,null,r),e=Au(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function My(e,t,r,a,s,i,l){if(r)return t.flags&256?(t.flags&=-257,a=j0(Error(Te(422))),hc(e,t,l,a)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=a.fallback,s=t.mode,a=zo({mode:"visible",children:a.children},s,0,null),i=xs(i,s,l,null),i.flags|=2,a.return=t,i.return=t,a.sibling=i,t.child=a,t.mode&1&&hi(t,e.child,null,l),t.child.memoizedState=_d(l),t.memoizedState=kd,i);if(!(t.mode&1))return hc(e,t,l,null);if(s.data==="$!"){if(a=s.nextSibling&&s.nextSibling.dataset,a)var c=a.dgst;return a=c,i=Error(Te(419)),a=j0(i,a,void 0),hc(e,t,l,a)}if(c=(l&e.childLanes)!==0,Gr||c){if(a=or,a!==null){switch(l&-l){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(a.suspendedLanes|l)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,pa(e,s),Bn(a,e,s,-1))}return Ou(),a=j0(Error(Te(421))),hc(e,t,l,a)}return s.data==="$?"?(t.flags|=128,t.child=e.child,t=Ky.bind(null,e),s._reactRetry=t,null):(e=i.treeContext,an=Wa(s.nextSibling),sn=t,At=!0,Mn=null,e!==null&&(vn[yn++]=la,vn[yn++]=ca,vn[yn++]=ys,la=e.id,ca=e.overflow,ys=t),t=Au(t,a.children),t.flags|=4096,t)}function Px(e,t,r){e.lanes|=t;var a=e.alternate;a!==null&&(a.lanes|=t),vd(e.return,t,r)}function k0(e,t,r,a,s){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:a,tail:r,tailMode:s}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=a,i.tail=r,i.tailMode=s)}function Yp(e,t,r){var a=t.pendingProps,s=a.revealOrder,i=a.tail;if(Ir(e,t,a.children,r),a=It.current,a&2)a=a&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Px(e,r,t);else if(e.tag===19)Px(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}a&=1}if(Nt(It,a),!(t.mode&1))t.memoizedState=null;else switch(s){case"forwards":for(r=t.child,s=null;r!==null;)e=r.alternate,e!==null&&lo(e)===null&&(s=r),r=r.sibling;r=s,r===null?(s=t.child,t.child=null):(s=r.sibling,r.sibling=null),k0(t,!1,s,r,i);break;case"backwards":for(r=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&lo(e)===null){t.child=s;break}e=s.sibling,s.sibling=r,r=s,s=e}k0(t,!0,r,null,i);break;case"together":k0(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function zc(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function ga(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),ws|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(Te(153));if(t.child!==null){for(e=t.child,r=Ga(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=Ga(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function Ry(e,t,r){switch(t.tag){case 3:Xp(t),mi();break;case 5:wp(t);break;case 1:Kr(t.type)&&to(t);break;case 4:ju(t,t.stateNode.containerInfo);break;case 10:var a=t.type._context,s=t.memoizedProps.value;Nt(ao,a._currentValue),a._currentValue=s;break;case 13:if(a=t.memoizedState,a!==null)return a.dehydrated!==null?(Nt(It,It.current&1),t.flags|=128,null):r&t.child.childLanes?Kp(e,t,r):(Nt(It,It.current&1),e=ga(e,t,r),e!==null?e.sibling:null);Nt(It,It.current&1);break;case 19:if(a=(r&t.childLanes)!==0,e.flags&128){if(a)return Yp(e,t,r);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Nt(It,It.current),a)break;return null;case 22:case 23:return t.lanes=0,Vp(e,t,r)}return ga(e,t,r)}var qp,Sd,Jp,Qp;qp=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Sd=function(){};Jp=function(e,t,r,a){var s=e.memoizedProps;if(s!==a){e=t.stateNode,ds(Qn.current);var i=null;switch(r){case"input":s=K0(e,s),a=K0(e,a),i=[];break;case"select":s=Lt({},s,{value:void 0}),a=Lt({},a,{value:void 0}),i=[];break;case"textarea":s=J0(e,s),a=J0(e,a),i=[];break;default:typeof s.onClick!="function"&&typeof a.onClick=="function"&&(e.onclick=Zc)}Z0(r,a);var l;r=null;for(u in s)if(!a.hasOwnProperty(u)&&s.hasOwnProperty(u)&&s[u]!=null)if(u==="style"){var c=s[u];for(l in c)c.hasOwnProperty(l)&&(r||(r={}),r[l]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(dl.hasOwnProperty(u)?i||(i=[]):(i=i||[]).push(u,null));for(u in a){var o=a[u];if(c=s!=null?s[u]:void 0,a.hasOwnProperty(u)&&o!==c&&(o!=null||c!=null))if(u==="style")if(c){for(l in c)!c.hasOwnProperty(l)||o&&o.hasOwnProperty(l)||(r||(r={}),r[l]="");for(l in o)o.hasOwnProperty(l)&&c[l]!==o[l]&&(r||(r={}),r[l]=o[l])}else r||(i||(i=[]),i.push(u,r)),r=o;else u==="dangerouslySetInnerHTML"?(o=o?o.__html:void 0,c=c?c.__html:void 0,o!=null&&c!==o&&(i=i||[]).push(u,o)):u==="children"?typeof o!="string"&&typeof o!="number"||(i=i||[]).push(u,""+o):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(dl.hasOwnProperty(u)?(o!=null&&u==="onScroll"&&kt("scroll",e),i||c===o||(i=[])):(i=i||[]).push(u,o))}r&&(i=i||[]).push("style",r);var u=i;(t.updateQueue=u)&&(t.flags|=4)}};Qp=function(e,t,r,a){r!==a&&(t.flags|=4)};function Oi(e,t){if(!At)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var a=null;r!==null;)r.alternate!==null&&(a=r),r=r.sibling;a===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:a.sibling=null}}function wr(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,a=0;if(t)for(var s=e.child;s!==null;)r|=s.lanes|s.childLanes,a|=s.subtreeFlags&14680064,a|=s.flags&14680064,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)r|=s.lanes|s.childLanes,a|=s.subtreeFlags,a|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=a,e.childLanes=r,t}function Oy(e,t,r){var a=t.pendingProps;switch(pu(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return wr(t),null;case 1:return Kr(t.type)&&eo(),wr(t),null;case 3:return a=t.stateNode,pi(),St(Xr),St(Tr),_u(),a.pendingContext&&(a.context=a.pendingContext,a.pendingContext=null),(e===null||e.child===null)&&(xc(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Mn!==null&&(Id(Mn),Mn=null))),Sd(e,t),wr(t),null;case 5:ku(t);var s=ds(Nl.current);if(r=t.type,e!==null&&t.stateNode!=null)Jp(e,t,r,a,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!a){if(t.stateNode===null)throw Error(Te(166));return wr(t),null}if(e=ds(Qn.current),xc(t)){a=t.stateNode,r=t.type;var i=t.memoizedProps;switch(a[Yn]=t,a[bl]=i,e=(t.mode&1)!==0,r){case"dialog":kt("cancel",a),kt("close",a);break;case"iframe":case"object":case"embed":kt("load",a);break;case"video":case"audio":for(s=0;s<Hi.length;s++)kt(Hi[s],a);break;case"source":kt("error",a);break;case"img":case"image":case"link":kt("error",a),kt("load",a);break;case"details":kt("toggle",a);break;case"input":zf(a,i),kt("invalid",a);break;case"select":a._wrapperState={wasMultiple:!!i.multiple},kt("invalid",a);break;case"textarea":Hf(a,i),kt("invalid",a)}Z0(r,i),s=null;for(var l in i)if(i.hasOwnProperty(l)){var c=i[l];l==="children"?typeof c=="string"?a.textContent!==c&&(i.suppressHydrationWarning!==!0&&fc(a.textContent,c,e),s=["children",c]):typeof c=="number"&&a.textContent!==""+c&&(i.suppressHydrationWarning!==!0&&fc(a.textContent,c,e),s=["children",""+c]):dl.hasOwnProperty(l)&&c!=null&&l==="onScroll"&&kt("scroll",a)}switch(r){case"input":ac(a),Wf(a,i,!0);break;case"textarea":ac(a),$f(a);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(a.onclick=Zc)}a=s,t.updateQueue=a,a!==null&&(t.flags|=4)}else{l=s.nodeType===9?s:s.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Sh(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=l.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof a.is=="string"?e=l.createElement(r,{is:a.is}):(e=l.createElement(r),r==="select"&&(l=e,a.multiple?l.multiple=!0:a.size&&(l.size=a.size))):e=l.createElementNS(e,r),e[Yn]=t,e[bl]=a,qp(e,t,!1,!1),t.stateNode=e;e:{switch(l=ed(r,a),r){case"dialog":kt("cancel",e),kt("close",e),s=a;break;case"iframe":case"object":case"embed":kt("load",e),s=a;break;case"video":case"audio":for(s=0;s<Hi.length;s++)kt(Hi[s],e);s=a;break;case"source":kt("error",e),s=a;break;case"img":case"image":case"link":kt("error",e),kt("load",e),s=a;break;case"details":kt("toggle",e),s=a;break;case"input":zf(e,a),s=K0(e,a),kt("invalid",e);break;case"option":s=a;break;case"select":e._wrapperState={wasMultiple:!!a.multiple},s=Lt({},a,{value:void 0}),kt("invalid",e);break;case"textarea":Hf(e,a),s=J0(e,a),kt("invalid",e);break;default:s=a}Z0(r,s),c=s;for(i in c)if(c.hasOwnProperty(i)){var o=c[i];i==="style"?Th(e,o):i==="dangerouslySetInnerHTML"?(o=o?o.__html:void 0,o!=null&&Ch(e,o)):i==="children"?typeof o=="string"?(r!=="textarea"||o!=="")&&ul(e,o):typeof o=="number"&&ul(e,""+o):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(dl.hasOwnProperty(i)?o!=null&&i==="onScroll"&&kt("scroll",e):o!=null&&tu(e,i,o,l))}switch(r){case"input":ac(e),Wf(e,a,!1);break;case"textarea":ac(e),$f(e);break;case"option":a.value!=null&&e.setAttribute("value",""+Xa(a.value));break;case"select":e.multiple=!!a.multiple,i=a.value,i!=null?ri(e,!!a.multiple,i,!1):a.defaultValue!=null&&ri(e,!!a.multiple,a.defaultValue,!0);break;default:typeof s.onClick=="function"&&(e.onclick=Zc)}switch(r){case"button":case"input":case"select":case"textarea":a=!!a.autoFocus;break e;case"img":a=!0;break e;default:a=!1}}a&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return wr(t),null;case 6:if(e&&t.stateNode!=null)Qp(e,t,e.memoizedProps,a);else{if(typeof a!="string"&&t.stateNode===null)throw Error(Te(166));if(r=ds(Nl.current),ds(Qn.current),xc(t)){if(a=t.stateNode,r=t.memoizedProps,a[Yn]=t,(i=a.nodeValue!==r)&&(e=sn,e!==null))switch(e.tag){case 3:fc(a.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&fc(a.nodeValue,r,(e.mode&1)!==0)}i&&(t.flags|=4)}else a=(r.nodeType===9?r:r.ownerDocument).createTextNode(a),a[Yn]=t,t.stateNode=a}return wr(t),null;case 13:if(St(It),a=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(At&&an!==null&&t.mode&1&&!(t.flags&128))pp(),mi(),t.flags|=98560,i=!1;else if(i=xc(t),a!==null&&a.dehydrated!==null){if(e===null){if(!i)throw Error(Te(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(Te(317));i[Yn]=t}else mi(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;wr(t),i=!1}else Mn!==null&&(Id(Mn),Mn=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(a=a!==null,a!==(e!==null&&e.memoizedState!==null)&&a&&(t.child.flags|=8192,t.mode&1&&(e===null||It.current&1?er===0&&(er=3):Ou())),t.updateQueue!==null&&(t.flags|=4),wr(t),null);case 4:return pi(),Sd(e,t),e===null&&vl(t.stateNode.containerInfo),wr(t),null;case 10:return bu(t.type._context),wr(t),null;case 17:return Kr(t.type)&&eo(),wr(t),null;case 19:if(St(It),i=t.memoizedState,i===null)return wr(t),null;if(a=(t.flags&128)!==0,l=i.rendering,l===null)if(a)Oi(i,!1);else{if(er!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(l=lo(e),l!==null){for(t.flags|=128,Oi(i,!1),a=l.updateQueue,a!==null&&(t.updateQueue=a,t.flags|=4),t.subtreeFlags=0,a=r,r=t.child;r!==null;)i=r,e=a,i.flags&=14680066,l=i.alternate,l===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=l.childLanes,i.lanes=l.lanes,i.child=l.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=l.memoizedProps,i.memoizedState=l.memoizedState,i.updateQueue=l.updateQueue,i.type=l.type,e=l.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return Nt(It,It.current&1|2),t.child}e=e.sibling}i.tail!==null&&Vt()>vi&&(t.flags|=128,a=!0,Oi(i,!1),t.lanes=4194304)}else{if(!a)if(e=lo(l),e!==null){if(t.flags|=128,a=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Oi(i,!0),i.tail===null&&i.tailMode==="hidden"&&!l.alternate&&!At)return wr(t),null}else 2*Vt()-i.renderingStartTime>vi&&r!==1073741824&&(t.flags|=128,a=!0,Oi(i,!1),t.lanes=4194304);i.isBackwards?(l.sibling=t.child,t.child=l):(r=i.last,r!==null?r.sibling=l:t.child=l,i.last=l)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=Vt(),t.sibling=null,r=It.current,Nt(It,a?r&1|2:r&1),t):(wr(t),null);case 22:case 23:return Ru(),a=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==a&&(t.flags|=8192),a&&t.mode&1?Zr&1073741824&&(wr(t),t.subtreeFlags&6&&(t.flags|=8192)):wr(t),null;case 24:return null;case 25:return null}throw Error(Te(156,t.tag))}function Ly(e,t){switch(pu(t),t.tag){case 1:return Kr(t.type)&&eo(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return pi(),St(Xr),St(Tr),_u(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return ku(t),null;case 13:if(St(It),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Te(340));mi()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return St(It),null;case 4:return pi(),null;case 10:return bu(t.type._context),null;case 22:case 23:return Ru(),null;case 24:return null;default:return null}}var pc=!1,_r=!1,By=typeof WeakSet=="function"?WeakSet:Set,We=null;function Zs(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(a){Ut(e,t,a)}else r.current=null}function Cd(e,t,r){try{r()}catch(a){Ut(e,t,a)}}var Dx=!1;function Uy(e,t){if(dd=qc,e=np(),mu(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var a=r.getSelection&&r.getSelection();if(a&&a.rangeCount!==0){r=a.anchorNode;var s=a.anchorOffset,i=a.focusNode;a=a.focusOffset;try{r.nodeType,i.nodeType}catch{r=null;break e}var l=0,c=-1,o=-1,u=0,d=0,f=e,x=null;t:for(;;){for(var h;f!==r||s!==0&&f.nodeType!==3||(c=l+s),f!==i||a!==0&&f.nodeType!==3||(o=l+a),f.nodeType===3&&(l+=f.nodeValue.length),(h=f.firstChild)!==null;)x=f,f=h;for(;;){if(f===e)break t;if(x===r&&++u===s&&(c=l),x===i&&++d===a&&(o=l),(h=f.nextSibling)!==null)break;f=x,x=f.parentNode}f=h}r=c===-1||o===-1?null:{start:c,end:o}}else r=null}r=r||{start:0,end:0}}else r=null;for(ud={focusedElem:e,selectionRange:r},qc=!1,We=t;We!==null;)if(t=We,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,We=e;else for(;We!==null;){t=We;try{var p=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var m=p.memoizedProps,w=p.memoizedState,v=t.stateNode,b=v.getSnapshotBeforeUpdate(t.elementType===t.type?m:Dn(t.type,m),w);v.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var y=t.stateNode.containerInfo;y.nodeType===1?y.textContent="":y.nodeType===9&&y.documentElement&&y.removeChild(y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Te(163))}}catch(N){Ut(t,t.return,N)}if(e=t.sibling,e!==null){e.return=t.return,We=e;break}We=t.return}return p=Dx,Dx=!1,p}function Zi(e,t,r){var a=t.updateQueue;if(a=a!==null?a.lastEffect:null,a!==null){var s=a=a.next;do{if((s.tag&e)===e){var i=s.destroy;s.destroy=void 0,i!==void 0&&Cd(t,r,i)}s=s.next}while(s!==a)}}function Bo(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var a=r.create;r.destroy=a()}r=r.next}while(r!==t)}}function Ed(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function Zp(e){var t=e.alternate;t!==null&&(e.alternate=null,Zp(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Yn],delete t[bl],delete t[md],delete t[Ny],delete t[jy])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function e1(e){return e.tag===5||e.tag===3||e.tag===4}function Ix(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||e1(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Td(e,t,r){var a=e.tag;if(a===5||a===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=Zc));else if(a!==4&&(e=e.child,e!==null))for(Td(e,t,r),e=e.sibling;e!==null;)Td(e,t,r),e=e.sibling}function Fd(e,t,r){var a=e.tag;if(a===5||a===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(a!==4&&(e=e.child,e!==null))for(Fd(e,t,r),e=e.sibling;e!==null;)Fd(e,t,r),e=e.sibling}var xr=null,In=!1;function Ea(e,t,r){for(r=r.child;r!==null;)t1(e,t,r),r=r.sibling}function t1(e,t,r){if(Jn&&typeof Jn.onCommitFiberUnmount=="function")try{Jn.onCommitFiberUnmount(Ao,r)}catch{}switch(r.tag){case 5:_r||Zs(r,t);case 6:var a=xr,s=In;xr=null,Ea(e,t,r),xr=a,In=s,xr!==null&&(In?(e=xr,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):xr.removeChild(r.stateNode));break;case 18:xr!==null&&(In?(e=xr,r=r.stateNode,e.nodeType===8?g0(e.parentNode,r):e.nodeType===1&&g0(e,r),hl(e)):g0(xr,r.stateNode));break;case 4:a=xr,s=In,xr=r.stateNode.containerInfo,In=!0,Ea(e,t,r),xr=a,In=s;break;case 0:case 11:case 14:case 15:if(!_r&&(a=r.updateQueue,a!==null&&(a=a.lastEffect,a!==null))){s=a=a.next;do{var i=s,l=i.destroy;i=i.tag,l!==void 0&&(i&2||i&4)&&Cd(r,t,l),s=s.next}while(s!==a)}Ea(e,t,r);break;case 1:if(!_r&&(Zs(r,t),a=r.stateNode,typeof a.componentWillUnmount=="function"))try{a.props=r.memoizedProps,a.state=r.memoizedState,a.componentWillUnmount()}catch(c){Ut(r,t,c)}Ea(e,t,r);break;case 21:Ea(e,t,r);break;case 22:r.mode&1?(_r=(a=_r)||r.memoizedState!==null,Ea(e,t,r),_r=a):Ea(e,t,r);break;default:Ea(e,t,r)}}function Mx(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new By),t.forEach(function(a){var s=Yy.bind(null,e,a);r.has(a)||(r.add(a),a.then(s,s))})}}function An(e,t){var r=t.deletions;if(r!==null)for(var a=0;a<r.length;a++){var s=r[a];try{var i=e,l=t,c=l;e:for(;c!==null;){switch(c.tag){case 5:xr=c.stateNode,In=!1;break e;case 3:xr=c.stateNode.containerInfo,In=!0;break e;case 4:xr=c.stateNode.containerInfo,In=!0;break e}c=c.return}if(xr===null)throw Error(Te(160));t1(i,l,s),xr=null,In=!1;var o=s.alternate;o!==null&&(o.return=null),s.return=null}catch(u){Ut(s,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)r1(t,e),t=t.sibling}function r1(e,t){var r=e.alternate,a=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(An(t,e),$n(e),a&4){try{Zi(3,e,e.return),Bo(3,e)}catch(m){Ut(e,e.return,m)}try{Zi(5,e,e.return)}catch(m){Ut(e,e.return,m)}}break;case 1:An(t,e),$n(e),a&512&&r!==null&&Zs(r,r.return);break;case 5:if(An(t,e),$n(e),a&512&&r!==null&&Zs(r,r.return),e.flags&32){var s=e.stateNode;try{ul(s,"")}catch(m){Ut(e,e.return,m)}}if(a&4&&(s=e.stateNode,s!=null)){var i=e.memoizedProps,l=r!==null?r.memoizedProps:i,c=e.type,o=e.updateQueue;if(e.updateQueue=null,o!==null)try{c==="input"&&i.type==="radio"&&i.name!=null&&kh(s,i),ed(c,l);var u=ed(c,i);for(l=0;l<o.length;l+=2){var d=o[l],f=o[l+1];d==="style"?Th(s,f):d==="dangerouslySetInnerHTML"?Ch(s,f):d==="children"?ul(s,f):tu(s,d,f,u)}switch(c){case"input":Y0(s,i);break;case"textarea":_h(s,i);break;case"select":var x=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var h=i.value;h!=null?ri(s,!!i.multiple,h,!1):x!==!!i.multiple&&(i.defaultValue!=null?ri(s,!!i.multiple,i.defaultValue,!0):ri(s,!!i.multiple,i.multiple?[]:"",!1))}s[bl]=i}catch(m){Ut(e,e.return,m)}}break;case 6:if(An(t,e),$n(e),a&4){if(e.stateNode===null)throw Error(Te(162));s=e.stateNode,i=e.memoizedProps;try{s.nodeValue=i}catch(m){Ut(e,e.return,m)}}break;case 3:if(An(t,e),$n(e),a&4&&r!==null&&r.memoizedState.isDehydrated)try{hl(t.containerInfo)}catch(m){Ut(e,e.return,m)}break;case 4:An(t,e),$n(e);break;case 13:An(t,e),$n(e),s=e.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(Iu=Vt())),a&4&&Mx(e);break;case 22:if(d=r!==null&&r.memoizedState!==null,e.mode&1?(_r=(u=_r)||d,An(t,e),_r=u):An(t,e),$n(e),a&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!d&&e.mode&1)for(We=e,d=e.child;d!==null;){for(f=We=d;We!==null;){switch(x=We,h=x.child,x.tag){case 0:case 11:case 14:case 15:Zi(4,x,x.return);break;case 1:Zs(x,x.return);var p=x.stateNode;if(typeof p.componentWillUnmount=="function"){a=x,r=x.return;try{t=a,p.props=t.memoizedProps,p.state=t.memoizedState,p.componentWillUnmount()}catch(m){Ut(a,r,m)}}break;case 5:Zs(x,x.return);break;case 22:if(x.memoizedState!==null){Ox(f);continue}}h!==null?(h.return=x,We=h):Ox(f)}d=d.sibling}e:for(d=null,f=e;;){if(f.tag===5){if(d===null){d=f;try{s=f.stateNode,u?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(c=f.stateNode,o=f.memoizedProps.style,l=o!=null&&o.hasOwnProperty("display")?o.display:null,c.style.display=Eh("display",l))}catch(m){Ut(e,e.return,m)}}}else if(f.tag===6){if(d===null)try{f.stateNode.nodeValue=u?"":f.memoizedProps}catch(m){Ut(e,e.return,m)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===e)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;f.sibling===null;){if(f.return===null||f.return===e)break e;d===f&&(d=null),f=f.return}d===f&&(d=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:An(t,e),$n(e),a&4&&Mx(e);break;case 21:break;default:An(t,e),$n(e)}}function $n(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(e1(r)){var a=r;break e}r=r.return}throw Error(Te(160))}switch(a.tag){case 5:var s=a.stateNode;a.flags&32&&(ul(s,""),a.flags&=-33);var i=Ix(e);Fd(e,i,s);break;case 3:case 4:var l=a.stateNode.containerInfo,c=Ix(e);Td(e,c,l);break;default:throw Error(Te(161))}}catch(o){Ut(e,e.return,o)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function zy(e,t,r){We=e,n1(e)}function n1(e,t,r){for(var a=(e.mode&1)!==0;We!==null;){var s=We,i=s.child;if(s.tag===22&&a){var l=s.memoizedState!==null||pc;if(!l){var c=s.alternate,o=c!==null&&c.memoizedState!==null||_r;c=pc;var u=_r;if(pc=l,(_r=o)&&!u)for(We=s;We!==null;)l=We,o=l.child,l.tag===22&&l.memoizedState!==null?Lx(s):o!==null?(o.return=l,We=o):Lx(s);for(;i!==null;)We=i,n1(i),i=i.sibling;We=s,pc=c,_r=u}Rx(e)}else s.subtreeFlags&8772&&i!==null?(i.return=s,We=i):Rx(e)}}function Rx(e){for(;We!==null;){var t=We;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:_r||Bo(5,t);break;case 1:var a=t.stateNode;if(t.flags&4&&!_r)if(r===null)a.componentDidMount();else{var s=t.elementType===t.type?r.memoizedProps:Dn(t.type,r.memoizedProps);a.componentDidUpdate(s,r.memoizedState,a.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&bx(t,i,a);break;case 3:var l=t.updateQueue;if(l!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}bx(t,l,r)}break;case 5:var c=t.stateNode;if(r===null&&t.flags&4){r=c;var o=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":o.autoFocus&&r.focus();break;case"img":o.src&&(r.src=o.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var f=d.dehydrated;f!==null&&hl(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Te(163))}_r||t.flags&512&&Ed(t)}catch(x){Ut(t,t.return,x)}}if(t===e){We=null;break}if(r=t.sibling,r!==null){r.return=t.return,We=r;break}We=t.return}}function Ox(e){for(;We!==null;){var t=We;if(t===e){We=null;break}var r=t.sibling;if(r!==null){r.return=t.return,We=r;break}We=t.return}}function Lx(e){for(;We!==null;){var t=We;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{Bo(4,t)}catch(o){Ut(t,r,o)}break;case 1:var a=t.stateNode;if(typeof a.componentDidMount=="function"){var s=t.return;try{a.componentDidMount()}catch(o){Ut(t,s,o)}}var i=t.return;try{Ed(t)}catch(o){Ut(t,i,o)}break;case 5:var l=t.return;try{Ed(t)}catch(o){Ut(t,l,o)}}}catch(o){Ut(t,t.return,o)}if(t===e){We=null;break}var c=t.sibling;if(c!==null){c.return=t.return,We=c;break}We=t.return}}var Wy=Math.ceil,uo=ya.ReactCurrentDispatcher,Pu=ya.ReactCurrentOwner,wn=ya.ReactCurrentBatchConfig,ot=0,or=null,Jt=null,gr=0,Zr=0,ei=es(0),er=0,Sl=null,ws=0,Uo=0,Du=0,el=null,Vr=null,Iu=0,vi=1/0,sa=null,fo=!1,Ad=null,$a=null,gc=!1,Ra=null,xo=0,tl=0,Pd=null,Wc=-1,Hc=0;function Or(){return ot&6?Vt():Wc!==-1?Wc:Wc=Vt()}function Va(e){return e.mode&1?ot&2&&gr!==0?gr&-gr:_y.transition!==null?(Hc===0&&(Hc=zh()),Hc):(e=gt,e!==0||(e=window.event,e=e===void 0?16:Kh(e.type)),e):1}function Bn(e,t,r,a){if(50<tl)throw tl=0,Pd=null,Error(Te(185));$l(e,r,a),(!(ot&2)||e!==or)&&(e===or&&(!(ot&2)&&(Uo|=r),er===4&&Da(e,gr)),Yr(e,a),r===1&&ot===0&&!(t.mode&1)&&(vi=Vt()+500,Ro&&ts()))}function Yr(e,t){var r=e.callbackNode;_2(e,t);var a=Yc(e,e===or?gr:0);if(a===0)r!==null&&Xf(r),e.callbackNode=null,e.callbackPriority=0;else if(t=a&-a,e.callbackPriority!==t){if(r!=null&&Xf(r),t===1)e.tag===0?ky(Bx.bind(null,e)):xp(Bx.bind(null,e)),by(function(){!(ot&6)&&ts()}),r=null;else{switch(Wh(a)){case 1:r=iu;break;case 4:r=Bh;break;case 16:r=Kc;break;case 536870912:r=Uh;break;default:r=Kc}r=u1(r,a1.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function a1(e,t){if(Wc=-1,Hc=0,ot&6)throw Error(Te(327));var r=e.callbackNode;if(li()&&e.callbackNode!==r)return null;var a=Yc(e,e===or?gr:0);if(a===0)return null;if(a&30||a&e.expiredLanes||t)t=mo(e,a);else{t=a;var s=ot;ot|=2;var i=i1();(or!==e||gr!==t)&&(sa=null,vi=Vt()+500,fs(e,t));do try{Vy();break}catch(c){s1(e,c)}while(!0);yu(),uo.current=i,ot=s,Jt!==null?t=0:(or=null,gr=0,t=er)}if(t!==0){if(t===2&&(s=sd(e),s!==0&&(a=s,t=Dd(e,s))),t===1)throw r=Sl,fs(e,0),Da(e,a),Yr(e,Vt()),r;if(t===6)Da(e,a);else{if(s=e.current.alternate,!(a&30)&&!Hy(s)&&(t=mo(e,a),t===2&&(i=sd(e),i!==0&&(a=i,t=Dd(e,i))),t===1))throw r=Sl,fs(e,0),Da(e,a),Yr(e,Vt()),r;switch(e.finishedWork=s,e.finishedLanes=a,t){case 0:case 1:throw Error(Te(345));case 2:is(e,Vr,sa);break;case 3:if(Da(e,a),(a&130023424)===a&&(t=Iu+500-Vt(),10<t)){if(Yc(e,0)!==0)break;if(s=e.suspendedLanes,(s&a)!==a){Or(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=xd(is.bind(null,e,Vr,sa),t);break}is(e,Vr,sa);break;case 4:if(Da(e,a),(a&4194240)===a)break;for(t=e.eventTimes,s=-1;0<a;){var l=31-Ln(a);i=1<<l,l=t[l],l>s&&(s=l),a&=~i}if(a=s,a=Vt()-a,a=(120>a?120:480>a?480:1080>a?1080:1920>a?1920:3e3>a?3e3:4320>a?4320:1960*Wy(a/1960))-a,10<a){e.timeoutHandle=xd(is.bind(null,e,Vr,sa),a);break}is(e,Vr,sa);break;case 5:is(e,Vr,sa);break;default:throw Error(Te(329))}}}return Yr(e,Vt()),e.callbackNode===r?a1.bind(null,e):null}function Dd(e,t){var r=el;return e.current.memoizedState.isDehydrated&&(fs(e,t).flags|=256),e=mo(e,t),e!==2&&(t=Vr,Vr=r,t!==null&&Id(t)),e}function Id(e){Vr===null?Vr=e:Vr.push.apply(Vr,e)}function Hy(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var a=0;a<r.length;a++){var s=r[a],i=s.getSnapshot;s=s.value;try{if(!Wn(i(),s))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Da(e,t){for(t&=~Du,t&=~Uo,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Ln(t),a=1<<r;e[r]=-1,t&=~a}}function Bx(e){if(ot&6)throw Error(Te(327));li();var t=Yc(e,0);if(!(t&1))return Yr(e,Vt()),null;var r=mo(e,t);if(e.tag!==0&&r===2){var a=sd(e);a!==0&&(t=a,r=Dd(e,a))}if(r===1)throw r=Sl,fs(e,0),Da(e,t),Yr(e,Vt()),r;if(r===6)throw Error(Te(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,is(e,Vr,sa),Yr(e,Vt()),null}function Mu(e,t){var r=ot;ot|=1;try{return e(t)}finally{ot=r,ot===0&&(vi=Vt()+500,Ro&&ts())}}function Ns(e){Ra!==null&&Ra.tag===0&&!(ot&6)&&li();var t=ot;ot|=1;var r=wn.transition,a=gt;try{if(wn.transition=null,gt=1,e)return e()}finally{gt=a,wn.transition=r,ot=t,!(ot&6)&&ts()}}function Ru(){Zr=ei.current,St(ei)}function fs(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,yy(r)),Jt!==null)for(r=Jt.return;r!==null;){var a=r;switch(pu(a),a.tag){case 1:a=a.type.childContextTypes,a!=null&&eo();break;case 3:pi(),St(Xr),St(Tr),_u();break;case 5:ku(a);break;case 4:pi();break;case 13:St(It);break;case 19:St(It);break;case 10:bu(a.type._context);break;case 22:case 23:Ru()}r=r.return}if(or=e,Jt=e=Ga(e.current,null),gr=Zr=t,er=0,Sl=null,Du=Uo=ws=0,Vr=el=null,os!==null){for(t=0;t<os.length;t++)if(r=os[t],a=r.interleaved,a!==null){r.interleaved=null;var s=a.next,i=r.pending;if(i!==null){var l=i.next;i.next=s,a.next=l}r.pending=a}os=null}return e}function s1(e,t){do{var r=Jt;try{if(yu(),Bc.current=oo,co){for(var a=Ot.memoizedState;a!==null;){var s=a.queue;s!==null&&(s.pending=null),a=a.next}co=!1}if(bs=0,ir=Qt=Ot=null,Qi=!1,jl=0,Pu.current=null,r===null||r.return===null){er=1,Sl=t,Jt=null;break}e:{var i=e,l=r.return,c=r,o=t;if(t=gr,c.flags|=32768,o!==null&&typeof o=="object"&&typeof o.then=="function"){var u=o,d=c,f=d.tag;if(!(d.mode&1)&&(f===0||f===11||f===15)){var x=d.alternate;x?(d.updateQueue=x.updateQueue,d.memoizedState=x.memoizedState,d.lanes=x.lanes):(d.updateQueue=null,d.memoizedState=null)}var h=Sx(l);if(h!==null){h.flags&=-257,Cx(h,l,c,i,t),h.mode&1&&_x(i,u,t),t=h,o=u;var p=t.updateQueue;if(p===null){var m=new Set;m.add(o),t.updateQueue=m}else p.add(o);break e}else{if(!(t&1)){_x(i,u,t),Ou();break e}o=Error(Te(426))}}else if(At&&c.mode&1){var w=Sx(l);if(w!==null){!(w.flags&65536)&&(w.flags|=256),Cx(w,l,c,i,t),gu(gi(o,c));break e}}i=o=gi(o,c),er!==4&&(er=2),el===null?el=[i]:el.push(i),i=l;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var v=Wp(i,o,t);yx(i,v);break e;case 1:c=o;var b=i.type,y=i.stateNode;if(!(i.flags&128)&&(typeof b.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&($a===null||!$a.has(y)))){i.flags|=65536,t&=-t,i.lanes|=t;var N=Hp(i,c,t);yx(i,N);break e}}i=i.return}while(i!==null)}c1(r)}catch(F){t=F,Jt===r&&r!==null&&(Jt=r=r.return);continue}break}while(!0)}function i1(){var e=uo.current;return uo.current=oo,e===null?oo:e}function Ou(){(er===0||er===3||er===2)&&(er=4),or===null||!(ws&268435455)&&!(Uo&268435455)||Da(or,gr)}function mo(e,t){var r=ot;ot|=2;var a=i1();(or!==e||gr!==t)&&(sa=null,fs(e,t));do try{$y();break}catch(s){s1(e,s)}while(!0);if(yu(),ot=r,uo.current=a,Jt!==null)throw Error(Te(261));return or=null,gr=0,er}function $y(){for(;Jt!==null;)l1(Jt)}function Vy(){for(;Jt!==null&&!p2();)l1(Jt)}function l1(e){var t=d1(e.alternate,e,Zr);e.memoizedProps=e.pendingProps,t===null?c1(e):Jt=t,Pu.current=null}function c1(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=Ly(r,t),r!==null){r.flags&=32767,Jt=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{er=6,Jt=null;return}}else if(r=Oy(r,t,Zr),r!==null){Jt=r;return}if(t=t.sibling,t!==null){Jt=t;return}Jt=t=e}while(t!==null);er===0&&(er=5)}function is(e,t,r){var a=gt,s=wn.transition;try{wn.transition=null,gt=1,Gy(e,t,r,a)}finally{wn.transition=s,gt=a}return null}function Gy(e,t,r,a){do li();while(Ra!==null);if(ot&6)throw Error(Te(327));r=e.finishedWork;var s=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(Te(177));e.callbackNode=null,e.callbackPriority=0;var i=r.lanes|r.childLanes;if(S2(e,i),e===or&&(Jt=or=null,gr=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||gc||(gc=!0,u1(Kc,function(){return li(),null})),i=(r.flags&15990)!==0,r.subtreeFlags&15990||i){i=wn.transition,wn.transition=null;var l=gt;gt=1;var c=ot;ot|=4,Pu.current=null,Uy(e,r),r1(r,e),fy(ud),qc=!!dd,ud=dd=null,e.current=r,zy(r),g2(),ot=c,gt=l,wn.transition=i}else e.current=r;if(gc&&(gc=!1,Ra=e,xo=s),i=e.pendingLanes,i===0&&($a=null),b2(r.stateNode),Yr(e,Vt()),t!==null)for(a=e.onRecoverableError,r=0;r<t.length;r++)s=t[r],a(s.value,{componentStack:s.stack,digest:s.digest});if(fo)throw fo=!1,e=Ad,Ad=null,e;return xo&1&&e.tag!==0&&li(),i=e.pendingLanes,i&1?e===Pd?tl++:(tl=0,Pd=e):tl=0,ts(),null}function li(){if(Ra!==null){var e=Wh(xo),t=wn.transition,r=gt;try{if(wn.transition=null,gt=16>e?16:e,Ra===null)var a=!1;else{if(e=Ra,Ra=null,xo=0,ot&6)throw Error(Te(331));var s=ot;for(ot|=4,We=e.current;We!==null;){var i=We,l=i.child;if(We.flags&16){var c=i.deletions;if(c!==null){for(var o=0;o<c.length;o++){var u=c[o];for(We=u;We!==null;){var d=We;switch(d.tag){case 0:case 11:case 15:Zi(8,d,i)}var f=d.child;if(f!==null)f.return=d,We=f;else for(;We!==null;){d=We;var x=d.sibling,h=d.return;if(Zp(d),d===u){We=null;break}if(x!==null){x.return=h,We=x;break}We=h}}}var p=i.alternate;if(p!==null){var m=p.child;if(m!==null){p.child=null;do{var w=m.sibling;m.sibling=null,m=w}while(m!==null)}}We=i}}if(i.subtreeFlags&2064&&l!==null)l.return=i,We=l;else e:for(;We!==null;){if(i=We,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Zi(9,i,i.return)}var v=i.sibling;if(v!==null){v.return=i.return,We=v;break e}We=i.return}}var b=e.current;for(We=b;We!==null;){l=We;var y=l.child;if(l.subtreeFlags&2064&&y!==null)y.return=l,We=y;else e:for(l=b;We!==null;){if(c=We,c.flags&2048)try{switch(c.tag){case 0:case 11:case 15:Bo(9,c)}}catch(F){Ut(c,c.return,F)}if(c===l){We=null;break e}var N=c.sibling;if(N!==null){N.return=c.return,We=N;break e}We=c.return}}if(ot=s,ts(),Jn&&typeof Jn.onPostCommitFiberRoot=="function")try{Jn.onPostCommitFiberRoot(Ao,e)}catch{}a=!0}return a}finally{gt=r,wn.transition=t}}return!1}function Ux(e,t,r){t=gi(r,t),t=Wp(e,t,1),e=Ha(e,t,1),t=Or(),e!==null&&($l(e,1,t),Yr(e,t))}function Ut(e,t,r){if(e.tag===3)Ux(e,e,r);else for(;t!==null;){if(t.tag===3){Ux(t,e,r);break}else if(t.tag===1){var a=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof a.componentDidCatch=="function"&&($a===null||!$a.has(a))){e=gi(r,e),e=Hp(t,e,1),t=Ha(t,e,1),e=Or(),t!==null&&($l(t,1,e),Yr(t,e));break}}t=t.return}}function Xy(e,t,r){var a=e.pingCache;a!==null&&a.delete(t),t=Or(),e.pingedLanes|=e.suspendedLanes&r,or===e&&(gr&r)===r&&(er===4||er===3&&(gr&130023424)===gr&&500>Vt()-Iu?fs(e,0):Du|=r),Yr(e,t)}function o1(e,t){t===0&&(e.mode&1?(t=lc,lc<<=1,!(lc&130023424)&&(lc=4194304)):t=1);var r=Or();e=pa(e,t),e!==null&&($l(e,t,r),Yr(e,r))}function Ky(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),o1(e,r)}function Yy(e,t){var r=0;switch(e.tag){case 13:var a=e.stateNode,s=e.memoizedState;s!==null&&(r=s.retryLane);break;case 19:a=e.stateNode;break;default:throw Error(Te(314))}a!==null&&a.delete(t),o1(e,r)}var d1;d1=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||Xr.current)Gr=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return Gr=!1,Ry(e,t,r);Gr=!!(e.flags&131072)}else Gr=!1,At&&t.flags&1048576&&mp(t,no,t.index);switch(t.lanes=0,t.tag){case 2:var a=t.type;zc(e,t),e=t.pendingProps;var s=xi(t,Tr.current);ii(t,r),s=Cu(null,t,a,e,s,r);var i=Eu();return t.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Kr(a)?(i=!0,to(t)):i=!1,t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Nu(t),s.updater=Lo,t.stateNode=s,s._reactInternals=t,bd(t,a,e,r),t=jd(null,t,a,!0,i,r)):(t.tag=0,At&&i&&hu(t),Ir(null,t,s,r),t=t.child),t;case 16:a=t.elementType;e:{switch(zc(e,t),e=t.pendingProps,s=a._init,a=s(a._payload),t.type=a,s=t.tag=Jy(a),e=Dn(a,e),s){case 0:t=Nd(null,t,a,e,r);break e;case 1:t=Fx(null,t,a,e,r);break e;case 11:t=Ex(null,t,a,e,r);break e;case 14:t=Tx(null,t,a,Dn(a.type,e),r);break e}throw Error(Te(306,a,""))}return t;case 0:return a=t.type,s=t.pendingProps,s=t.elementType===a?s:Dn(a,s),Nd(e,t,a,s,r);case 1:return a=t.type,s=t.pendingProps,s=t.elementType===a?s:Dn(a,s),Fx(e,t,a,s,r);case 3:e:{if(Xp(t),e===null)throw Error(Te(387));a=t.pendingProps,i=t.memoizedState,s=i.element,bp(e,t),io(t,a,null,r);var l=t.memoizedState;if(a=l.element,i.isDehydrated)if(i={element:a,isDehydrated:!1,cache:l.cache,pendingSuspenseBoundaries:l.pendingSuspenseBoundaries,transitions:l.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){s=gi(Error(Te(423)),t),t=Ax(e,t,a,r,s);break e}else if(a!==s){s=gi(Error(Te(424)),t),t=Ax(e,t,a,r,s);break e}else for(an=Wa(t.stateNode.containerInfo.firstChild),sn=t,At=!0,Mn=null,r=vp(t,null,a,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(mi(),a===s){t=ga(e,t,r);break e}Ir(e,t,a,r)}t=t.child}return t;case 5:return wp(t),e===null&&gd(t),a=t.type,s=t.pendingProps,i=e!==null?e.memoizedProps:null,l=s.children,fd(a,s)?l=null:i!==null&&fd(a,i)&&(t.flags|=32),Gp(e,t),Ir(e,t,l,r),t.child;case 6:return e===null&&gd(t),null;case 13:return Kp(e,t,r);case 4:return ju(t,t.stateNode.containerInfo),a=t.pendingProps,e===null?t.child=hi(t,null,a,r):Ir(e,t,a,r),t.child;case 11:return a=t.type,s=t.pendingProps,s=t.elementType===a?s:Dn(a,s),Ex(e,t,a,s,r);case 7:return Ir(e,t,t.pendingProps,r),t.child;case 8:return Ir(e,t,t.pendingProps.children,r),t.child;case 12:return Ir(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(a=t.type._context,s=t.pendingProps,i=t.memoizedProps,l=s.value,Nt(ao,a._currentValue),a._currentValue=l,i!==null)if(Wn(i.value,l)){if(i.children===s.children&&!Xr.current){t=ga(e,t,r);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var c=i.dependencies;if(c!==null){l=i.child;for(var o=c.firstContext;o!==null;){if(o.context===a){if(i.tag===1){o=da(-1,r&-r),o.tag=2;var u=i.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?o.next=o:(o.next=d.next,d.next=o),u.pending=o}}i.lanes|=r,o=i.alternate,o!==null&&(o.lanes|=r),vd(i.return,r,t),c.lanes|=r;break}o=o.next}}else if(i.tag===10)l=i.type===t.type?null:i.child;else if(i.tag===18){if(l=i.return,l===null)throw Error(Te(341));l.lanes|=r,c=l.alternate,c!==null&&(c.lanes|=r),vd(l,r,t),l=i.sibling}else l=i.child;if(l!==null)l.return=i;else for(l=i;l!==null;){if(l===t){l=null;break}if(i=l.sibling,i!==null){i.return=l.return,l=i;break}l=l.return}i=l}Ir(e,t,s.children,r),t=t.child}return t;case 9:return s=t.type,a=t.pendingProps.children,ii(t,r),s=jn(s),a=a(s),t.flags|=1,Ir(e,t,a,r),t.child;case 14:return a=t.type,s=Dn(a,t.pendingProps),s=Dn(a.type,s),Tx(e,t,a,s,r);case 15:return $p(e,t,t.type,t.pendingProps,r);case 17:return a=t.type,s=t.pendingProps,s=t.elementType===a?s:Dn(a,s),zc(e,t),t.tag=1,Kr(a)?(e=!0,to(t)):e=!1,ii(t,r),zp(t,a,s),bd(t,a,s,r),jd(null,t,a,!0,e,r);case 19:return Yp(e,t,r);case 22:return Vp(e,t,r)}throw Error(Te(156,t.tag))};function u1(e,t){return Lh(e,t)}function qy(e,t,r,a){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=a,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function bn(e,t,r,a){return new qy(e,t,r,a)}function Lu(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Jy(e){if(typeof e=="function")return Lu(e)?1:0;if(e!=null){if(e=e.$$typeof,e===nu)return 11;if(e===au)return 14}return 2}function Ga(e,t){var r=e.alternate;return r===null?(r=bn(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function $c(e,t,r,a,s,i){var l=2;if(a=e,typeof e=="function")Lu(e)&&(l=1);else if(typeof e=="string")l=5;else e:switch(e){case $s:return xs(r.children,s,i,t);case ru:l=8,s|=8;break;case $0:return e=bn(12,r,t,s|2),e.elementType=$0,e.lanes=i,e;case V0:return e=bn(13,r,t,s),e.elementType=V0,e.lanes=i,e;case G0:return e=bn(19,r,t,s),e.elementType=G0,e.lanes=i,e;case wh:return zo(r,s,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case yh:l=10;break e;case bh:l=9;break e;case nu:l=11;break e;case au:l=14;break e;case Fa:l=16,a=null;break e}throw Error(Te(130,e==null?e:typeof e,""))}return t=bn(l,r,t,s),t.elementType=e,t.type=a,t.lanes=i,t}function xs(e,t,r,a){return e=bn(7,e,a,t),e.lanes=r,e}function zo(e,t,r,a){return e=bn(22,e,a,t),e.elementType=wh,e.lanes=r,e.stateNode={isHidden:!1},e}function _0(e,t,r){return e=bn(6,e,null,t),e.lanes=r,e}function S0(e,t,r){return t=bn(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Qy(e,t,r,a,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=i0(0),this.expirationTimes=i0(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=i0(0),this.identifierPrefix=a,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Bu(e,t,r,a,s,i,l,c,o){return e=new Qy(e,t,r,c,o),t===1?(t=1,i===!0&&(t|=8)):t=0,i=bn(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:a,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Nu(i),e}function Zy(e,t,r){var a=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Hs,key:a==null?null:""+a,children:e,containerInfo:t,implementation:r}}function f1(e){if(!e)return Ka;e=e._reactInternals;e:{if(As(e)!==e||e.tag!==1)throw Error(Te(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Kr(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Te(171))}if(e.tag===1){var r=e.type;if(Kr(r))return fp(e,r,t)}return t}function x1(e,t,r,a,s,i,l,c,o){return e=Bu(r,a,!0,e,s,i,l,c,o),e.context=f1(null),r=e.current,a=Or(),s=Va(r),i=da(a,s),i.callback=t??null,Ha(r,i,s),e.current.lanes=s,$l(e,s,a),Yr(e,a),e}function Wo(e,t,r,a){var s=t.current,i=Or(),l=Va(s);return r=f1(r),t.context===null?t.context=r:t.pendingContext=r,t=da(i,l),t.payload={element:e},a=a===void 0?null:a,a!==null&&(t.callback=a),e=Ha(s,t,l),e!==null&&(Bn(e,s,l,i),Lc(e,s,l)),l}function ho(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function zx(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function Uu(e,t){zx(e,t),(e=e.alternate)&&zx(e,t)}function eb(){return null}var m1=typeof reportError=="function"?reportError:function(e){console.error(e)};function zu(e){this._internalRoot=e}Ho.prototype.render=zu.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Te(409));Wo(e,t,null,null)};Ho.prototype.unmount=zu.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Ns(function(){Wo(null,e,null,null)}),t[ha]=null}};function Ho(e){this._internalRoot=e}Ho.prototype.unstable_scheduleHydration=function(e){if(e){var t=Vh();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Pa.length&&t!==0&&t<Pa[r].priority;r++);Pa.splice(r,0,e),r===0&&Xh(e)}};function Wu(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function $o(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Wx(){}function tb(e,t,r,a,s){if(s){if(typeof a=="function"){var i=a;a=function(){var u=ho(l);i.call(u)}}var l=x1(t,a,e,0,null,!1,!1,"",Wx);return e._reactRootContainer=l,e[ha]=l.current,vl(e.nodeType===8?e.parentNode:e),Ns(),l}for(;s=e.lastChild;)e.removeChild(s);if(typeof a=="function"){var c=a;a=function(){var u=ho(o);c.call(u)}}var o=Bu(e,0,!1,null,null,!1,!1,"",Wx);return e._reactRootContainer=o,e[ha]=o.current,vl(e.nodeType===8?e.parentNode:e),Ns(function(){Wo(t,o,r,a)}),o}function Vo(e,t,r,a,s){var i=r._reactRootContainer;if(i){var l=i;if(typeof s=="function"){var c=s;s=function(){var o=ho(l);c.call(o)}}Wo(t,l,e,s)}else l=tb(r,t,e,s,a);return ho(l)}Hh=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=Wi(t.pendingLanes);r!==0&&(lu(t,r|1),Yr(t,Vt()),!(ot&6)&&(vi=Vt()+500,ts()))}break;case 13:Ns(function(){var a=pa(e,1);if(a!==null){var s=Or();Bn(a,e,1,s)}}),Uu(e,1)}};cu=function(e){if(e.tag===13){var t=pa(e,134217728);if(t!==null){var r=Or();Bn(t,e,134217728,r)}Uu(e,134217728)}};$h=function(e){if(e.tag===13){var t=Va(e),r=pa(e,t);if(r!==null){var a=Or();Bn(r,e,t,a)}Uu(e,t)}};Vh=function(){return gt};Gh=function(e,t){var r=gt;try{return gt=e,t()}finally{gt=r}};rd=function(e,t,r){switch(t){case"input":if(Y0(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var a=r[t];if(a!==e&&a.form===e.form){var s=Mo(a);if(!s)throw Error(Te(90));jh(a),Y0(a,s)}}}break;case"textarea":_h(e,r);break;case"select":t=r.value,t!=null&&ri(e,!!r.multiple,t,!1)}};Ph=Mu;Dh=Ns;var rb={usingClientEntryPoint:!1,Events:[Gl,Ks,Mo,Fh,Ah,Mu]},Li={findFiberByHostInstance:cs,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},nb={bundleType:Li.bundleType,version:Li.version,rendererPackageName:Li.rendererPackageName,rendererConfig:Li.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ya.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Rh(e),e===null?null:e.stateNode},findFiberByHostInstance:Li.findFiberByHostInstance||eb,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var vc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!vc.isDisabled&&vc.supportsFiber)try{Ao=vc.inject(nb),Jn=vc}catch{}}on.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=rb;on.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Wu(t))throw Error(Te(200));return Zy(e,t,null,r)};on.createRoot=function(e,t){if(!Wu(e))throw Error(Te(299));var r=!1,a="",s=m1;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(a=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),t=Bu(e,1,!1,null,null,r,!1,a,s),e[ha]=t.current,vl(e.nodeType===8?e.parentNode:e),new zu(t)};on.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Te(188)):(e=Object.keys(e).join(","),Error(Te(268,e)));return e=Rh(t),e=e===null?null:e.stateNode,e};on.flushSync=function(e){return Ns(e)};on.hydrate=function(e,t,r){if(!$o(t))throw Error(Te(200));return Vo(null,e,t,!0,r)};on.hydrateRoot=function(e,t,r){if(!Wu(e))throw Error(Te(405));var a=r!=null&&r.hydratedSources||null,s=!1,i="",l=m1;if(r!=null&&(r.unstable_strictMode===!0&&(s=!0),r.identifierPrefix!==void 0&&(i=r.identifierPrefix),r.onRecoverableError!==void 0&&(l=r.onRecoverableError)),t=x1(t,null,e,1,r??null,s,!1,i,l),e[ha]=t.current,vl(e),a)for(e=0;e<a.length;e++)r=a[e],s=r._getVersion,s=s(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,s]:t.mutableSourceEagerHydrationData.push(r,s);return new Ho(t)};on.render=function(e,t,r){if(!$o(t))throw Error(Te(200));return Vo(null,e,t,!1,r)};on.unmountComponentAtNode=function(e){if(!$o(e))throw Error(Te(40));return e._reactRootContainer?(Ns(function(){Vo(null,null,e,!1,function(){e._reactRootContainer=null,e[ha]=null})}),!0):!1};on.unstable_batchedUpdates=Mu;on.unstable_renderSubtreeIntoContainer=function(e,t,r,a){if(!$o(r))throw Error(Te(200));if(e==null||e._reactInternals===void 0)throw Error(Te(38));return Vo(e,t,r,!1,a)};on.version="18.3.1-next-f1338f8080-20240426";function h1(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(h1)}catch(e){console.error(e)}}h1(),hh.exports=on;var ab=hh.exports,p1,Hx=ab;p1=Hx.createRoot,Hx.hydrateRoot;/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var sb={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ib=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),Ve=(e,t)=>{const r=M.forwardRef(({color:a="currentColor",size:s=24,strokeWidth:i=2,absoluteStrokeWidth:l,className:c="",children:o,...u},d)=>M.createElement("svg",{ref:d,...sb,width:s,height:s,stroke:a,strokeWidth:l?Number(i)*24/Number(s):i,className:["lucide",`lucide-${ib(e)}`,c].join(" "),...u},[...t.map(([f,x])=>M.createElement(f,x)),...Array.isArray(o)?o:[o]]));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cl=Ve("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hn=Ve("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lb=Ve("AlignCenter",[["line",{x1:"21",x2:"3",y1:"6",y2:"6",key:"1fp77t"}],["line",{x1:"17",x2:"7",y1:"12",y2:"12",key:"rsh8ii"}],["line",{x1:"19",x2:"5",y1:"18",y2:"18",key:"1t0tuv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cb=Ve("AlignLeft",[["line",{x1:"21",x2:"3",y1:"6",y2:"6",key:"1fp77t"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}],["line",{x1:"17",x2:"3",y1:"18",y2:"18",key:"1awlsn"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ob=Ve("AlignRight",[["line",{x1:"21",x2:"3",y1:"6",y2:"6",key:"1fp77t"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}],["line",{x1:"21",x2:"7",y1:"18",y2:"18",key:"1g9eri"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yi=Ve("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const db=Ve("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g1=Ve("Award",[["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}],["path",{d:"M15.477 12.89 17 22l-5-3-5 3 1.523-9.11",key:"em7aur"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C0=Ve("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ub=Ve("Bold",[["path",{d:"M14 12a4 4 0 0 0 0-8H6v8",key:"v2sylx"}],["path",{d:"M15 20a4 4 0 0 0 0-8H6v8Z",key:"1ef5ya"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fb=Ve("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xb=Ve("Brain",[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z",key:"ep3f8r"}],["path",{d:"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4",key:"1p4c4q"}],["path",{d:"M17.599 6.5a3 3 0 0 0 .399-1.375",key:"tmeiqw"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M19.938 10.5a4 4 0 0 1 .585.396",key:"1qfode"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M19.967 17.484A4 4 0 0 1 18 18",key:"159ez6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const El=Ve("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zn=Ve("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $x=Ve("CheckSquare",[["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}],["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11",key:"1jnkn4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mb=Ve("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hb=Ve("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pb=Ve("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hu=Ve("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Md=Ve("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gb=Ve("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vb=Ve("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const js=Ve("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v1=Ve("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yb=Ve("FileCheck",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vx=Ve("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pt=Ve("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const po=Ve("FolderOpen",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rd=Ve("FolderTree",[["path",{d:"M20 10a1 1 0 0 0 1-1V6a1 1 0 0 0-1-1h-2.5a1 1 0 0 1-.8-.4l-.9-1.2A1 1 0 0 0 15 3h-2a1 1 0 0 0-1 1v5a1 1 0 0 0 1 1Z",key:"hod4my"}],["path",{d:"M20 21a1 1 0 0 0 1-1v-3a1 1 0 0 0-1-1h-2.9a1 1 0 0 1-.88-.55l-.42-.85a1 1 0 0 0-.92-.6H13a1 1 0 0 0-1 1v5a1 1 0 0 0 1 1Z",key:"w4yl2u"}],["path",{d:"M3 5a2 2 0 0 0 2 2h3",key:"f2jnh7"}],["path",{d:"M3 3v13a2 2 0 0 0 2 2h3",key:"k8epm1"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bb=Ve("Italic",[["line",{x1:"19",x2:"10",y1:"4",y2:"4",key:"15jd3p"}],["line",{x1:"14",x2:"5",y1:"20",y2:"20",key:"bu0au3"}],["line",{x1:"15",x2:"9",y1:"4",y2:"20",key:"uljnxc"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wb=Ve("Key",[["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["path",{d:"m15.5 7.5 3 3L22 7l-3-3",key:"1rn1fs"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nb=Ve("ListOrdered",[["line",{x1:"10",x2:"21",y1:"6",y2:"6",key:"76qw6h"}],["line",{x1:"10",x2:"21",y1:"12",y2:"12",key:"16nom4"}],["line",{x1:"10",x2:"21",y1:"18",y2:"18",key:"u3jurt"}],["path",{d:"M4 6h1v4",key:"cnovpq"}],["path",{d:"M4 10h2",key:"16xx2s"}],["path",{d:"M6 18H4c0-1 2-2 2-3s-1-1.5-2-1",key:"m9a95d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jb=Ve("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $u=Ve("Loader",[["line",{x1:"12",x2:"12",y1:"2",y2:"6",key:"gza1u7"}],["line",{x1:"12",x2:"12",y1:"18",y2:"22",key:"1qhbu9"}],["line",{x1:"4.93",x2:"7.76",y1:"4.93",y2:"7.76",key:"xae44r"}],["line",{x1:"16.24",x2:"19.07",y1:"16.24",y2:"19.07",key:"bxnmvf"}],["line",{x1:"2",x2:"6",y1:"12",y2:"12",key:"89khin"}],["line",{x1:"18",x2:"22",y1:"12",y2:"12",key:"pb8tfm"}],["line",{x1:"4.93",x2:"7.76",y1:"19.07",y2:"16.24",key:"1uxjnu"}],["line",{x1:"16.24",x2:"19.07",y1:"7.76",y2:"4.93",key:"6duxfx"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kb=Ve("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _b=Ve("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sb=Ve("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ct=Ve("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tl=Ve("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cb=Ve("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Eb=Ve("Ruler",[["path",{d:"M21.3 15.3a2.4 2.4 0 0 1 0 3.4l-2.6 2.6a2.4 2.4 0 0 1-3.4 0L2.7 8.7a2.41 2.41 0 0 1 0-3.4l2.6-2.6a2.41 2.41 0 0 1 3.4 0Z",key:"icamh8"}],["path",{d:"m14.5 12.5 2-2",key:"inckbg"}],["path",{d:"m11.5 9.5 2-2",key:"fmmyf7"}],["path",{d:"m8.5 6.5 2-2",key:"vc6u1g"}],["path",{d:"m17.5 15.5 2-2",key:"wo5hmg"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gx=Ve("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tb=Ve("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vu=Ve("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Et=Ve("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a2.121 2.121 0 1 1 3 3L12 15l-4 1 1-4Z",key:"1lpok0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qe=Ve("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fb=Ve("Type",[["polyline",{points:"4 7 4 4 20 4 20 7",key:"1nosan"}],["line",{x1:"9",x2:"15",y1:"20",y2:"20",key:"swin9y"}],["line",{x1:"12",x2:"12",y1:"4",y2:"20",key:"1tx1rr"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ab=Ve("Underline",[["path",{d:"M6 4v6a6 6 0 0 0 12 0V4",key:"9kb039"}],["line",{x1:"4",x2:"20",y1:"20",y2:"20",key:"nun2al"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wt=Ve("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pb=Ve("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y1=Ve("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b1=Ve("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ze=Ve("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),Db=({onLogin:e})=>{const[t,r]=M.useState(""),[a,s]=M.useState(""),[i,l]=M.useState(""),[c,o]=M.useState(!1),u=[{username:"admin",password:"admin123",role:"超级管理员",displayName:"超级管理员"},{username:"project_admin",password:"project123",role:"项目管理员",displayName:"项目管理员"},{username:"user",password:"user123",role:"普通用户",displayName:"普通用户"}],d=x=>{x.preventDefault(),l(""),o(!0),setTimeout(()=>{const h=u.find(p=>p.username===t&&p.password===a);h?e(h.username,h.role):l("用户名或密码错误"),o(!1)},500)},f=x=>{r(x.username),s(x.password),l("")};return n.jsx("div",{className:"min-h-screen bg-gradient-to-br from-primary-50 via-blue-50 to-neutral-50 flex items-center justify-center p-4",children:n.jsxs("div",{className:"w-full max-w-6xl grid grid-cols-1 lg:grid-cols-2 gap-8",children:[n.jsxs("div",{className:"hidden lg:flex flex-col justify-center space-y-6 text-white",children:[n.jsxs("div",{className:"space-y-4",children:[n.jsx("h1",{className:"text-4xl font-bold text-neutral-800",children:"AI投标助手V1.0"}),n.jsx("p",{className:"text-lg text-neutral-600 leading-relaxed",children:"通过智能化手段提升投标文件编制效率和质量， 实现从招标信息获取到投标文件提交的全流程数字化管理。"})]}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsx("div",{className:"w-10 h-10 bg-primary-600 rounded-lg flex items-center justify-center flex-shrink-0",children:n.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-semibold text-neutral-800",children:"提高投标效率"}),n.jsx("p",{className:"text-sm text-neutral-600",children:"自动化文件生成，节省大量人工编制时间"})]})]}),n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsx("div",{className:"w-10 h-10 bg-primary-600 rounded-lg flex items-center justify-center flex-shrink-0",children:n.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-semibold text-neutral-800",children:"降低废标风险"}),n.jsx("p",{className:"text-sm text-neutral-600",children:"智能检查功能，确保投标文件完整合规"})]})]}),n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsx("div",{className:"w-10 h-10 bg-primary-600 rounded-lg flex items-center justify-center flex-shrink-0",children:n.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-semibold text-neutral-800",children:"统一知识管理"}),n.jsx("p",{className:"text-sm text-neutral-600",children:"集中管理企业资质、业绩、人员等核心资料"})]})]})]})]}),n.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8 space-y-6",children:[n.jsxs("div",{className:"text-center",children:[n.jsx("h2",{className:"text-2xl font-bold text-neutral-900",children:"欢迎登录"}),n.jsx("p",{className:"text-sm text-neutral-600 mt-1",children:"请使用测试账号登录系统"})]}),n.jsxs("form",{onSubmit:d,className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:"用户名"}),n.jsxs("div",{className:"relative",children:[n.jsx(y1,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-neutral-400"}),n.jsx("input",{type:"text",value:t,onChange:x=>r(x.target.value),placeholder:"请输入用户名",className:"w-full pl-10 pr-4 py-2.5 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-colors",required:!0})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:"密码"}),n.jsxs("div",{className:"relative",children:[n.jsx(kb,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-neutral-400"}),n.jsx("input",{type:"password",value:a,onChange:x=>s(x.target.value),placeholder:"请输入密码",className:"w-full pl-10 pr-4 py-2.5 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-colors",required:!0})]})]}),i&&n.jsxs("div",{className:"flex items-center space-x-2 text-red-600 bg-red-50 px-3 py-2 rounded-lg",children:[n.jsx(Cl,{className:"w-4 h-4 flex-shrink-0"}),n.jsx("span",{className:"text-sm",children:i})]}),n.jsx("button",{type:"submit",disabled:c,className:"w-full bg-primary-600 text-white py-2.5 rounded-lg font-medium hover:bg-primary-700 focus:ring-4 focus:ring-primary-200 transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:c?"登录中...":"登录"})]}),n.jsxs("div",{className:"relative",children:[n.jsx("div",{className:"absolute inset-0 flex items-center",children:n.jsx("div",{className:"w-full border-t border-neutral-200"})}),n.jsx("div",{className:"relative flex justify-center text-sm",children:n.jsx("span",{className:"px-2 bg-white text-neutral-500",children:"快速登录"})})]}),n.jsx("div",{className:"space-y-2",children:u.map((x,h)=>n.jsxs("button",{type:"button",onClick:()=>f(x),className:"w-full flex items-center justify-between px-4 py-3 border border-neutral-200 rounded-lg hover:border-primary-300 hover:bg-primary-50 transition-colors group",children:[n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsx("div",{className:`w-2 h-2 rounded-full ${h===0?"bg-red-500":h===1?"bg-blue-500":"bg-green-500"}`}),n.jsxs("div",{className:"text-left",children:[n.jsx("div",{className:"font-medium text-neutral-900 text-sm",children:x.displayName}),n.jsxs("div",{className:"text-xs text-neutral-500",children:[x.username," / ",x.password]})]})]}),n.jsx("div",{className:"text-xs text-neutral-400 group-hover:text-primary-600 transition-colors",children:"点击登录"})]},h))}),n.jsx("div",{className:"pt-4 border-t border-neutral-200",children:n.jsx("p",{className:"text-xs text-neutral-500 text-center",children:"测试账号仅供演示使用，实际使用时请创建正式账号"})})]})]})})},Ib=({username:e="管理员",role:t="未知角色",onLogout:r})=>{const[a,s]=M.useState(!1),[i,l]=M.useState(!1),[c,o]=M.useState(!1),[u,d]=M.useState(!1),[f,x]=M.useState(!1),[h,p]=M.useState(null),[m,w]=M.useState(1),[v,b]=M.useState(10),[y,N]=M.useState(""),[F,j]=M.useState(""),[k,S]=M.useState(""),[P,D]=M.useState(""),K=[{id:1,type:"warning",title:"证书即将过期",message:"企业资质证书将于7天后过期，请及时更新",time:"2小时前",detail:"您的企业资质证书（编号：ZZ202301001）将于2024年10月31日到期。为避免影响投标活动，请尽快准备相关材料进行续期。续期所需材料包括：营业执照副本、组织机构代码证、税务登记证等。"},{id:2,type:"warning",title:"投标保证金到期提醒",message:"某医院项目保证金将于3天后到期",time:"5小时前",detail:`项目名称：某市人民医院医疗设备采购项目
项目编号：BID2024001
保证金金额：50,000元
到期时间：2024年10月27日

请及时办理保证金退还手续，如需延期请联系项目负责人。`}],C=()=>{confirm("确定要退出登录吗？")?(s(!1),r&&r()):s(!1)},Y=()=>{if(!F||!k||!P){alert("请填写完整信息");return}if(k!==P){alert("两次输入的新密码不一致");return}if(k.length<6){alert("新密码长度不能少于6位");return}alert("密码修改成功"),o(!1),j(""),S(""),D("")},B=()=>{l(!1),x(!0)},ee=I=>{p(I),l(!1),d(!0)},re=Math.ceil(K.length/v),Q=(m-1)*v,te=Q+v,H=K.slice(Q,te),ae=I=>{b(I),w(1)},he=()=>{const I=parseInt(y);I>=1&&I<=re&&(w(I),N(""))},O=I=>{switch(I){case"warning":return"bg-orange-500";case"success":return"bg-green-500";case"info":return"bg-blue-500";default:return"bg-neutral-500"}};return n.jsxs("nav",{className:"h-16 flex-shrink-0 bg-white border-b border-neutral-200 z-50",children:[n.jsx("div",{className:"h-full px-6 flex items-center",children:n.jsxs("div",{className:"flex items-center justify-between w-full",children:[n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsx("div",{className:"bg-primary-600 p-1.5 rounded-lg",children:n.jsx(Pt,{className:"w-5 h-5 text-white"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-lg font-semibold text-neutral-900",children:"AI投标助手 v1.0"}),n.jsx("p",{className:"text-xs text-neutral-500",children:"智能标书生成系统"})]})]}),n.jsxs("div",{className:"flex items-center space-x-4",children:[n.jsxs("div",{className:"relative",children:[n.jsxs("button",{onClick:()=>{l(!i),s(!1)},className:"relative p-2 rounded-lg hover:bg-neutral-100 transition-colors",children:[n.jsx(C0,{className:"w-5 h-5 text-neutral-600"}),K.length>0&&n.jsx("span",{className:"absolute top-1 right-1 w-2 h-2 bg-red-500 rounded-full"})]}),i&&n.jsxs("div",{className:"absolute right-0 mt-2 w-80 bg-white rounded-xl shadow-xl border border-neutral-200 z-50",children:[n.jsx("div",{className:"px-4 py-3 border-b border-neutral-200",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("h3",{className:"text-sm font-semibold text-neutral-900",children:"通知中心"}),n.jsx("span",{className:"text-xs px-2 py-0.5 bg-red-100 text-red-600 rounded-full font-medium",children:K.length})]})}),n.jsx("div",{className:"max-h-80 overflow-y-auto",children:K.length===0?n.jsxs("div",{className:"py-12 px-4 text-center",children:[n.jsx(C0,{className:"w-10 h-10 mx-auto mb-2 text-neutral-300"}),n.jsx("p",{className:"text-sm text-neutral-500",children:"暂无通知"})]}):K.map(I=>n.jsx("div",{onClick:()=>ee(I),className:"px-4 py-3 border-b border-neutral-100 hover:bg-neutral-50 transition-all duration-150 last:border-b-0 cursor-pointer",children:n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx("div",{className:`flex-shrink-0 w-2 h-2 rounded-full mt-1.5 ${O(I.type)}`}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("p",{className:"font-medium text-neutral-900 text-sm leading-snug",children:I.title}),n.jsx("p",{className:"text-xs text-neutral-600 mt-1 leading-relaxed",children:I.message}),n.jsx("p",{className:"text-xs text-neutral-400 mt-1.5",children:I.time})]})]})},I.id))}),n.jsx("div",{className:"px-4 py-2.5 border-t border-neutral-200 bg-neutral-50 rounded-b-xl",children:n.jsx("button",{onClick:B,className:"w-full text-xs text-primary-600 hover:text-primary-700 font-medium transition-colors",children:"查看全部通知"})})]})]}),n.jsxs("div",{className:"relative",children:[n.jsxs("button",{onClick:()=>{s(!a),l(!1)},className:"flex items-center space-x-3 hover:bg-neutral-50 rounded-lg p-2 transition-colors",children:[n.jsxs("div",{className:"text-right",children:[n.jsx("p",{className:"text-sm font-medium text-neutral-700",children:e}),n.jsx("p",{className:"text-xs text-neutral-500",children:t})]}),n.jsx("div",{className:"bg-neutral-100 p-2 rounded-full",children:n.jsx(y1,{className:"w-4.5 h-4.5 text-neutral-600"})})]}),a&&n.jsxs("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border border-neutral-200 z-50",children:[n.jsxs("button",{onClick:()=>{o(!0),s(!1)},className:"w-full flex items-center px-4 py-3 text-sm text-neutral-700 hover:bg-neutral-50 transition-colors",children:[n.jsx(wb,{className:"w-4 h-4 mr-3 text-neutral-600"}),"修改密码"]}),n.jsxs("button",{onClick:C,className:"w-full flex items-center px-4 py-3 text-sm text-red-600 hover:bg-red-50 transition-colors border-t border-neutral-100",children:[n.jsx(_b,{className:"w-4 h-4 mr-3"}),"退出登录"]})]})]})]})]})}),u&&h&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-lg mx-4",children:[n.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-neutral-200",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:`w-3 h-3 rounded-full ${O(h.type)}`}),n.jsx("h3",{className:"text-lg font-semibold text-neutral-900",children:h.title})]}),n.jsx("button",{onClick:()=>{d(!1),p(null)},className:"text-neutral-400 hover:text-neutral-600 transition-colors",children:n.jsx(Ze,{className:"w-5 h-5"})})]}),n.jsxs("div",{className:"px-6 py-5",children:[n.jsx("p",{className:"text-sm text-neutral-600 leading-relaxed whitespace-pre-line",children:h.detail}),n.jsx("div",{className:"mt-4 pt-4 border-t border-neutral-200",children:n.jsx("p",{className:"text-xs text-neutral-400",children:h.time})})]}),n.jsx("div",{className:"flex justify-end gap-3 px-6 py-4 border-t border-neutral-200 bg-neutral-50 rounded-b-xl",children:n.jsx("button",{onClick:()=>{d(!1),p(null)},className:"px-4 py-2 text-sm bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors",children:"关闭"})})]})}),f&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-4xl mx-4 max-h-[90vh] flex flex-col",children:[n.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-neutral-200",children:[n.jsx("h3",{className:"text-lg font-semibold text-neutral-900",children:"全部通知"}),n.jsx("button",{onClick:()=>{x(!1),w(1)},className:"text-neutral-400 hover:text-neutral-600 transition-colors",children:n.jsx(Ze,{className:"w-5 h-5"})})]}),n.jsx("div",{className:"px-6 py-3 border-b border-neutral-200 bg-neutral-50",children:n.jsxs("div",{className:"grid grid-cols-12 gap-4 text-sm font-medium text-neutral-600",children:[n.jsx("div",{className:"col-span-1 text-center",children:"序号"}),n.jsx("div",{className:"col-span-4",children:"标题"}),n.jsx("div",{className:"col-span-5",children:"消息内容"}),n.jsx("div",{className:"col-span-2 text-center",children:"时间"})]})}),n.jsx("div",{className:"flex-1 overflow-y-auto",children:H.length===0?n.jsxs("div",{className:"py-12 text-center text-neutral-500",children:[n.jsx(C0,{className:"w-10 h-10 mx-auto mb-2 text-neutral-300"}),n.jsx("p",{className:"text-sm",children:"暂无通知"})]}):n.jsx("div",{children:H.map((I,g)=>n.jsx("div",{onClick:()=>{x(!1),ee(I)},className:`px-6 py-4 hover:bg-primary-50 transition-all duration-150 cursor-pointer ${g!==H.length-1?"border-b border-neutral-100":""}`,children:n.jsxs("div",{className:"grid grid-cols-12 gap-4 text-sm items-center",children:[n.jsx("div",{className:"col-span-1 flex justify-center",children:n.jsx("span",{className:"text-neutral-900",children:Q+g+1})}),n.jsx("div",{className:"col-span-4",children:n.jsx("p",{className:"font-medium text-neutral-900 truncate",children:I.title})}),n.jsx("div",{className:"col-span-5",children:n.jsx("p",{className:"text-neutral-600 truncate",children:I.message})}),n.jsx("div",{className:"col-span-2 text-center",children:n.jsx("span",{className:"text-xs text-neutral-400",children:I.time})})]})},I.id))})}),n.jsxs("div",{className:"bg-white border-t border-neutral-200 px-6 py-3 flex items-center justify-center gap-6 rounded-b-xl",children:[n.jsxs("div",{className:"text-sm text-neutral-700",children:["共 ",K.length," 条"]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("button",{onClick:()=>w(Math.max(1,m-1)),disabled:m===1,className:`px-2 py-1 text-sm rounded transition-colors ${m===1?"bg-neutral-100 text-neutral-400 cursor-not-allowed":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:"<"}),n.jsx("div",{className:"flex items-center space-x-1",children:Array.from({length:Math.min(10,re)},(I,g)=>{let _;return re<=10||m<=5?_=g+1:m>=re-4?_=re-9+g:_=m-4+g,n.jsx("button",{onClick:()=>w(_),className:`px-2.5 py-1 text-sm rounded transition-colors ${m===_?"bg-primary-600 text-white":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:_},_)})}),re>10&&n.jsxs(n.Fragment,{children:[n.jsx("span",{className:"text-neutral-500",children:"..."}),n.jsx("button",{onClick:()=>w(re),className:`px-2.5 py-1 text-sm rounded transition-colors ${m===re?"bg-primary-600 text-white":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:re})]}),n.jsx("button",{onClick:()=>w(Math.min(re,m+1)),disabled:m===re,className:`px-2 py-1 text-sm rounded transition-colors ${m===re?"bg-neutral-100 text-neutral-400 cursor-not-allowed":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:">"})]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsxs("select",{value:v,onChange:I=>ae(Number(I.target.value)),className:"px-2 py-1 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500",children:[n.jsx("option",{value:10,children:"10条/页"}),n.jsx("option",{value:20,children:"20条/页"}),n.jsx("option",{value:50,children:"50条/页"})]}),n.jsx("span",{className:"text-sm text-neutral-700",children:"前往"}),n.jsx("input",{type:"number",value:y,onChange:I=>N(I.target.value),placeholder:"页",className:"w-12 px-2 py-1 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500",min:1,max:re}),n.jsx("button",{onClick:he,className:"px-3 py-1 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-50 transition-colors",children:"页"})]})]})]})}),c&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md",children:[n.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-neutral-200",children:[n.jsx("h3",{className:"text-lg font-semibold text-neutral-900",children:"修改密码"}),n.jsx("button",{onClick:()=>{o(!1),j(""),S(""),D("")},className:"text-neutral-400 hover:text-neutral-600 transition-colors",children:n.jsx(Ze,{className:"w-5 h-5"})})]}),n.jsxs("div",{className:"p-6 space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:"旧密码"}),n.jsx("input",{type:"password",value:F,onChange:I=>j(I.target.value),placeholder:"请输入旧密码",className:"w-full px-4 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:"新密码"}),n.jsx("input",{type:"password",value:k,onChange:I=>S(I.target.value),placeholder:"请输入新密码（不少于6位）",className:"w-full px-4 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:"确认新密码"}),n.jsx("input",{type:"password",value:P,onChange:I=>D(I.target.value),placeholder:"请再次输入新密码",className:"w-full px-4 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]})]}),n.jsxs("div",{className:"flex justify-end space-x-3 p-6 border-t border-neutral-200",children:[n.jsx("button",{onClick:()=>{o(!1),j(""),S(""),D("")},className:"px-4 py-2 text-sm text-neutral-700 hover:bg-neutral-100 rounded-lg transition-colors",children:"取消"}),n.jsx("button",{onClick:Y,className:"px-4 py-2 text-sm bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors",children:"确认修改"})]})]})})]})},Xx=({companyId:e,readOnly:t=!1})=>{const[r,a]=M.useState(()=>{const C=localStorage.getItem(`company_license_${e}`);return C?JSON.parse(C):{companyName:"北京某某科技有限公司",creditCode:"91110000XXXXXXXXXX",legalPerson:"张三",registeredCapital:"1000万元",establishDate:"2020-01-15",registeredAddress:"北京市海淀区中关村大街1号",validUntil:"2025-01-15",validFrom:"2020-01-15",businessScope:"技术开发、技术推广、技术转让、技术咨询、技术服务；软件开发；计算机系统服务；数据处理",isPermanent:!1,attachments:[]}}),[s,i]=M.useState(()=>{const C=localStorage.getItem(`company_bank_${e}`);return C?JSON.parse(C):null}),[l,c]=M.useState(()=>{const C=localStorage.getItem(`company_intro_${e}`);return C?JSON.parse(C):null}),[o,u]=M.useState(!1),[d,f]=M.useState(!1),[x,h]=M.useState(!1),[p,m]=M.useState(null),[w,v]=M.useState(null),[b,y]=M.useState(null);M.useEffect(()=>{r&&localStorage.setItem(`company_license_${e}`,JSON.stringify(r))},[r,e]),M.useEffect(()=>{s&&localStorage.setItem(`company_bank_${e}`,JSON.stringify(s))},[s,e]),M.useEffect(()=>{l&&localStorage.setItem(`company_intro_${e}`,JSON.stringify(l))},[l,e]);const N=C=>{const Y=new Date;return new Date(C)<Y},F=C=>new Promise((Y,B)=>{const ee=new FileReader;ee.onload=re=>{var Q;return Y((Q=re.target)==null?void 0:Q.result)},ee.onerror=B,ee.readAsDataURL(C)}),j=()=>{m(r||{companyName:"",creditCode:"",legalPerson:"",registeredCapital:"",establishDate:"",registeredAddress:"",validUntil:"",validFrom:"",businessScope:"",isPermanent:!1,attachments:[]}),u(!0)},k=()=>{p&&(a(p),u(!1))},S=()=>{v(s||{companyName:"",bankName:"",accountNumber:"",attachments:[]}),f(!0)},P=()=>{w&&(i(w),f(!1))},D=()=>{y(l||{introduction:"",orgChartAttachments:[]}),h(!0)},K=()=>{b&&(c(b),h(!1))};return n.jsxs("div",{className:"flex flex-col h-full",children:[t&&n.jsx("div",{className:"px-6 py-3 bg-yellow-50 border-b border-yellow-200 rounded-lg mb-4",children:n.jsxs("p",{className:"text-sm text-yellow-800",children:[n.jsx(Hn,{className:"w-4 h-4 inline mr-2"}),"只读模式 - 无法编辑此信息"]})}),n.jsx("div",{className:"flex-1 overflow-auto",children:n.jsxs("div",{className:"bg-white rounded-lg border border-neutral-200",children:[n.jsx("div",{className:"px-6 py-4 border-b border-neutral-200",children:n.jsx("h2",{className:"text-lg font-medium text-neutral-900",children:"公司基础信息"})}),n.jsx("div",{className:"px-6 pt-4",children:n.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:n.jsx("p",{className:"text-sm text-blue-700",children:"该模块用于管理企业的基础信息，包括营业执照、银行账户和公司简介。这些信息将用于生成投标文件中的公司介绍、资质证明等内容。请确保信息准确完整，并及时更新。"})})}),n.jsxs("div",{className:"p-6 space-y-6",children:[n.jsxs("div",{className:"bg-neutral-50 rounded-lg border border-neutral-200",children:[n.jsxs("div",{className:"px-6 py-4 border-b border-neutral-200 flex items-center justify-between bg-white rounded-t-lg",children:[n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx(Pt,{className:"w-5 h-5 text-primary-600"}),n.jsx("h3",{className:"text-base font-medium text-neutral-900",children:"营业执照"})]}),!t&&n.jsxs("button",{onClick:j,className:"flex items-center space-x-1 text-primary-600 hover:text-primary-800 text-sm transition-colors",children:[n.jsx(Et,{className:"w-4 h-4"}),n.jsx("span",{children:r?"编辑":"添加"})]})]}),r?n.jsxs("div",{className:"p-6 space-y-4 bg-white rounded-b-lg",children:[!r.isPermanent&&N(r.validUntil)&&n.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 flex items-start space-x-3",children:[n.jsx(Hn,{className:"w-5 h-5 text-red-600 flex-shrink-0 mt-0.5"}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm font-medium text-red-800",children:"营业执照已过期"}),n.jsx("p",{className:"text-sm text-red-600 mt-1",children:"请及时更新营业执照信息"})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-x-8 gap-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-neutral-600 mb-1.5",children:"企业名称"}),n.jsx("p",{className:"text-sm text-neutral-900",children:r.companyName})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-neutral-600 mb-1.5",children:"统一社会信用代码"}),n.jsx("p",{className:"text-sm text-neutral-900",children:r.creditCode})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-neutral-600 mb-1.5",children:"法定代表人"}),n.jsx("p",{className:"text-sm text-neutral-900",children:r.legalPerson})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-neutral-600 mb-1.5",children:"注册资本"}),n.jsx("p",{className:"text-sm text-neutral-900",children:r.registeredCapital})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-neutral-600 mb-1.5",children:"成立日期"}),n.jsx("p",{className:"text-sm text-neutral-900",children:r.establishDate})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-600 mb-1.5",children:["有效期",!r.isPermanent&&N(r.validUntil)&&n.jsx("span",{className:"ml-2 text-red-600",children:"(已过期)"})]}),n.jsx("p",{className:`text-sm ${!r.isPermanent&&N(r.validUntil)?"text-red-600 font-medium":"text-neutral-900"}`,children:r.isPermanent?"长期":`${r.validFrom?r.validFrom+" 至 ":""}${r.validUntil}`})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsx("label",{className:"block text-sm font-medium text-neutral-600 mb-1.5",children:"注册地址"}),n.jsx("p",{className:"text-sm text-neutral-900",children:r.registeredAddress})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsx("label",{className:"block text-sm font-medium text-neutral-600 mb-1.5",children:"经营范围"}),n.jsx("p",{className:"text-sm text-neutral-900 leading-relaxed",children:r.businessScope})]}),r.attachments&&r.attachments.length>0&&n.jsxs("div",{className:"col-span-2",children:[n.jsx("label",{className:"block text-sm font-medium text-neutral-600 mb-2",children:"附件"}),n.jsx("div",{className:"flex flex-wrap gap-4",children:r.attachments.map(C=>n.jsxs("div",{className:"relative group",children:[n.jsx("div",{className:"w-40 rounded-lg border border-neutral-200 shadow-sm bg-white overflow-hidden hover:shadow-md transition-shadow",children:n.jsx("img",{src:C.url,alt:C.name,className:"w-full h-32 object-contain p-2"})}),n.jsx("p",{className:"text-xs text-neutral-500 mt-1.5 truncate max-w-[10rem]",children:C.name})]},C.id))})]})]})]}):n.jsxs("div",{className:"p-8 text-center text-neutral-500 bg-white rounded-b-lg",children:[n.jsx(Pt,{className:"w-12 h-12 mx-auto text-neutral-300 mb-2"}),n.jsx("p",{className:"text-sm",children:"暂无营业执照信息"}),!t&&n.jsx("p",{className:"text-xs text-neutral-400 mt-1",children:"点击右上角添加按钮开始填写"})]})]}),n.jsxs("div",{className:"bg-neutral-50 rounded-lg border border-neutral-200",children:[n.jsxs("div",{className:"px-6 py-4 border-b border-neutral-200 flex items-center justify-between bg-white rounded-t-lg",children:[n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx(Pt,{className:"w-5 h-5 text-primary-600"}),n.jsx("h3",{className:"text-base font-medium text-neutral-900",children:"企业开户行"})]}),!t&&n.jsxs("button",{onClick:S,className:"flex items-center space-x-1 text-primary-600 hover:text-primary-800 text-sm transition-colors",children:[n.jsx(Et,{className:"w-4 h-4"}),n.jsx("span",{children:s?"编辑":"添加"})]})]}),s?n.jsx("div",{className:"p-6 space-y-4 bg-white rounded-b-lg",children:n.jsxs("div",{className:"grid grid-cols-2 gap-x-8 gap-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-neutral-600 mb-1.5",children:"企业名称"}),n.jsx("p",{className:"text-sm text-neutral-900",children:s.companyName})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-neutral-600 mb-1.5",children:"开户银行"}),n.jsx("p",{className:"text-sm text-neutral-900",children:s.bankName})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsx("label",{className:"block text-sm font-medium text-neutral-600 mb-1.5",children:"开户账号"}),n.jsx("p",{className:"text-sm text-neutral-900 font-mono",children:s.accountNumber})]}),s.attachments&&s.attachments.length>0&&n.jsxs("div",{className:"col-span-2",children:[n.jsx("label",{className:"block text-sm font-medium text-neutral-600 mb-2",children:"附件"}),n.jsx("div",{className:"flex flex-wrap gap-4",children:s.attachments.map(C=>n.jsxs("div",{className:"relative group",children:[n.jsx("div",{className:"w-40 rounded-lg border border-neutral-200 shadow-sm bg-white overflow-hidden hover:shadow-md transition-shadow",children:n.jsx("img",{src:C.url,alt:C.name,className:"w-full h-32 object-contain p-2"})}),n.jsx("p",{className:"text-xs text-neutral-500 mt-1.5 truncate max-w-[10rem]",children:C.name})]},C.id))})]})]})}):n.jsxs("div",{className:"p-8 text-center text-neutral-500 bg-white rounded-b-lg",children:[n.jsx(Pt,{className:"w-12 h-12 mx-auto text-neutral-300 mb-2"}),n.jsx("p",{className:"text-sm",children:"暂无开户行信息"}),!t&&n.jsx("p",{className:"text-xs text-neutral-400 mt-1",children:"点击右上角添加按钮开始填写"})]})]}),n.jsxs("div",{className:"bg-neutral-50 rounded-lg border border-neutral-200",children:[n.jsxs("div",{className:"px-6 py-4 border-b border-neutral-200 flex items-center justify-between bg-white rounded-t-lg",children:[n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx(Pt,{className:"w-5 h-5 text-primary-600"}),n.jsx("h3",{className:"text-base font-medium text-neutral-900",children:"企业介绍"})]}),!t&&n.jsxs("button",{onClick:D,className:"flex items-center space-x-1 text-primary-600 hover:text-primary-800 text-sm transition-colors",children:[n.jsx(Et,{className:"w-4 h-4"}),n.jsx("span",{children:l?"编辑":"添加"})]})]}),l?n.jsxs("div",{className:"p-6 space-y-4 bg-white rounded-b-lg",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-neutral-600 mb-2",children:"公司简介"}),n.jsx("p",{className:"text-sm text-neutral-900 whitespace-pre-wrap leading-relaxed",children:l.introduction})]}),l.orgChartAttachments&&l.orgChartAttachments.length>0&&n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-neutral-600 mb-2",children:"组织架构图"}),n.jsx("div",{className:"flex flex-wrap gap-4",children:l.orgChartAttachments.map(C=>n.jsxs("div",{className:"relative group",children:[n.jsx("div",{className:"w-40 rounded-lg border border-neutral-200 shadow-sm bg-white overflow-hidden hover:shadow-md transition-shadow",children:n.jsx("img",{src:C.url,alt:C.name,className:"w-full h-32 object-contain p-2"})}),n.jsx("p",{className:"text-xs text-neutral-500 mt-1.5 truncate max-w-[10rem]",children:C.name})]},C.id))})]})]}):n.jsxs("div",{className:"p-8 text-center text-neutral-500 bg-white rounded-b-lg",children:[n.jsx(Pt,{className:"w-12 h-12 mx-auto text-neutral-300 mb-2"}),n.jsx("p",{className:"text-sm",children:"暂无企业介绍"}),!t&&n.jsx("p",{className:"text-xs text-neutral-400 mt-1",children:"点击右上角添加按钮开始填写"})]})]})]})]})}),o&&p&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[n.jsxs("div",{className:"px-6 py-4 border-b border-neutral-200 flex items-center justify-between sticky top-0 bg-white z-10",children:[n.jsx("h3",{className:"text-lg font-medium text-neutral-900",children:r?"编辑营业执照":"添加营业执照"}),n.jsx("button",{onClick:()=>u(!1),className:"text-neutral-400 hover:text-neutral-600 transition-colors",children:n.jsx(Ze,{className:"w-5 h-5"})})]}),n.jsx("div",{className:"p-6 space-y-4",children:n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:["企业名称 ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:p.companyName,onChange:C=>m({...p,companyName:C.target.value}),className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:["统一社会信用代码 ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:p.creditCode,onChange:C=>m({...p,creditCode:C.target.value}),className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:["法定代表人 ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:p.legalPerson,onChange:C=>m({...p,legalPerson:C.target.value}),className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:["注册资本 ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:p.registeredCapital,onChange:C=>m({...p,registeredCapital:C.target.value}),className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:["成立日期 ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"date",value:p.establishDate,onChange:C=>m({...p,establishDate:C.target.value}),className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:["有效期 ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsxs("div",{className:"flex items-center space-x-4 mb-2",children:[n.jsxs("label",{className:"flex items-center",children:[n.jsx("input",{type:"radio",checked:!p.isPermanent,onChange:()=>m({...p,isPermanent:!1}),className:"mr-2"}),n.jsx("span",{className:"text-sm text-neutral-700",children:"非长期"})]}),n.jsxs("label",{className:"flex items-center",children:[n.jsx("input",{type:"radio",checked:p.isPermanent,onChange:()=>m({...p,isPermanent:!0,validUntil:"",validFrom:""}),className:"mr-2"}),n.jsx("span",{className:"text-sm text-neutral-700",children:"长期"})]})]}),p.isPermanent?n.jsx("div",{className:"w-full px-3 py-2 border border-neutral-300 rounded-lg bg-neutral-50 text-neutral-500",children:"长期有效"}):n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-neutral-600 mb-1",children:"生效日期"}),n.jsx("input",{type:"date",value:p.validFrom||"",onChange:C=>m({...p,validFrom:C.target.value}),className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-xs text-neutral-600 mb-1",children:["失效日期 ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"date",value:p.validUntil,onChange:C=>m({...p,validUntil:C.target.value}),className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]})]})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:["注册地址 ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:p.registeredAddress,onChange:C=>m({...p,registeredAddress:C.target.value}),className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:["经营范围 ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("textarea",{value:p.businessScope,onChange:C=>m({...p,businessScope:C.target.value}),rows:3,className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:["营业执照 ",n.jsx("span",{className:"text-red-500",children:"*"})]}),p.attachments&&p.attachments.length>0&&n.jsx("div",{className:"mb-3",children:n.jsx("div",{className:"grid grid-cols-3 gap-3 relative",children:p.attachments.map((C,Y)=>n.jsxs("div",{className:"relative group",children:[n.jsx("img",{src:C.url,alt:C.name,className:"w-full h-32 object-cover rounded-lg border border-neutral-200"}),n.jsx("button",{onClick:()=>{m({...p,attachments:p.attachments.filter(B=>B.id!==C.id)})},className:"absolute top-1 right-1 bg-red-500 text-white rounded-full p-1 opacity-0 group-hover:opacity-100 transition-opacity hover:bg-red-600",children:n.jsx(qe,{className:"w-3 h-3"})}),n.jsx("p",{className:"text-xs text-neutral-600 mt-1 truncate",children:C.name})]},C.id))})}),n.jsxs("div",{className:"border-2 border-dashed border-neutral-300 rounded-lg p-4 text-center hover:border-primary-500 transition-colors cursor-pointer",onClick:()=>{var C;return(C=document.getElementById("license-upload"))==null?void 0:C.click()},children:[n.jsx(wt,{className:"w-6 h-6 mx-auto text-neutral-400 mb-1"}),n.jsx("p",{className:"text-xs text-neutral-600",children:"点击上传"}),n.jsx("p",{className:"text-xs text-neutral-500 mt-0.5",children:"支持JPG、PNG、JPEG格式"})]}),n.jsx("input",{id:"license-upload",type:"file",className:"hidden",accept:".jpg,.jpeg,.png",multiple:!0,onChange:async C=>{const Y=Array.from(C.target.files||[]);if(Y.length===0)return;const B=!p.attachments||p.attachments.length===0;for(const ee of Y){if(ee.size>50*1024*1024){alert(`文件 ${ee.name} 大小超过50MB`);continue}try{const re=await F(ee),Q={id:`${Date.now()}-${Math.random()}`,url:re,name:ee.name};m(te=>({...te,attachments:[...te.attachments||[],Q]}))}catch(re){console.error("文件读取失败:",re),alert(`文件 ${ee.name} 读取失败`)}}B&&Y.length>0&&m(ee=>({...ee,companyName:"北京智慧科技有限公司",creditCode:"91110108MA01ABCD12",legalPerson:"李四",registeredCapital:"5000万元",establishDate:"2021-03-20",registeredAddress:"北京市海淀区科技园区中关村东路88号",validUntil:"2031-03-20",isPermanent:!1,businessScope:"技术开发、技术推广、技术转让、技术咨询、技术服务；软件开发；计算机系统服务；数据处理；基础软件服务；应用软件服务"})),C.target.value=""}})]})]})}),n.jsxs("div",{className:"px-6 py-4 bg-neutral-50 flex justify-end gap-2 rounded-b-lg sticky bottom-0",children:[n.jsx("button",{onClick:()=>u(!1),className:"px-4 py-2 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-100 transition-colors",children:"取消"}),n.jsx("button",{onClick:k,className:"px-4 py-2 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors",children:"保存"})]})]})}),d&&w&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-lg w-full",children:[n.jsxs("div",{className:"px-6 py-4 border-b border-neutral-200 flex items-center justify-between",children:[n.jsx("h3",{className:"text-lg font-medium text-neutral-900",children:s?"编辑开户行信息":"添加开户行信息"}),n.jsx("button",{onClick:()=>f(!1),className:"text-neutral-400 hover:text-neutral-600 transition-colors",children:n.jsx(Ze,{className:"w-5 h-5"})})]}),n.jsxs("div",{className:"p-6 space-y-4",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:["企业名称 ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:w.companyName,onChange:C=>v({...w,companyName:C.target.value}),className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:["开户银行 ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:w.bankName,onChange:C=>v({...w,bankName:C.target.value}),className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:["开户账号 ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:w.accountNumber,onChange:C=>v({...w,accountNumber:C.target.value}),className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:["开户行证明 ",n.jsx("span",{className:"text-red-500",children:"*"})]}),w.attachments&&w.attachments.length>0&&n.jsx("div",{className:"mb-3",children:n.jsx("div",{className:"grid grid-cols-3 gap-3 relative",children:w.attachments.map((C,Y)=>n.jsxs("div",{className:"relative group",children:[n.jsx("img",{src:C.url,alt:C.name,className:"w-full h-32 object-cover rounded-lg border border-neutral-200"}),n.jsx("button",{onClick:()=>{v({...w,attachments:w.attachments.filter(B=>B.id!==C.id)})},className:"absolute top-1 right-1 bg-red-500 text-white rounded-full p-1 opacity-0 group-hover:opacity-100 transition-opacity hover:bg-red-600",children:n.jsx(qe,{className:"w-3 h-3"})}),n.jsx("p",{className:"text-xs text-neutral-600 mt-1 truncate",children:C.name})]},C.id))})}),n.jsxs("div",{className:"border-2 border-dashed border-neutral-300 rounded-lg p-4 text-center hover:border-primary-500 transition-colors cursor-pointer",onClick:()=>{var C;return(C=document.getElementById("bank-upload"))==null?void 0:C.click()},children:[n.jsx(wt,{className:"w-6 h-6 mx-auto text-neutral-400 mb-1"}),n.jsx("p",{className:"text-xs text-neutral-600",children:"点击上传"}),n.jsx("p",{className:"text-xs text-neutral-500 mt-0.5",children:"支持JPG、PNG、JPEG格式"})]}),n.jsx("input",{id:"bank-upload",type:"file",className:"hidden",accept:".jpg,.jpeg,.png",multiple:!0,onChange:async C=>{const Y=Array.from(C.target.files||[]);if(Y.length===0)return;const B=!w.attachments||w.attachments.length===0;for(const ee of Y){if(ee.size>50*1024*1024){alert(`文件 ${ee.name} 大小超过50MB`);continue}try{const re=await F(ee),Q={id:`${Date.now()}-${Math.random()}`,url:re,name:ee.name};v(te=>({...te,attachments:[...te.attachments||[],Q]}))}catch(re){console.error("文件读取失败:",re),alert(`文件 ${ee.name} 读取失败`)}}B&&Y.length>0&&v(ee=>({...ee,companyName:"北京智慧科技有限公司",bankName:"中国工商银行北京海淀支行",accountNumber:"0200 1234 5678 9012 345"})),C.target.value=""}})]})]}),n.jsxs("div",{className:"px-6 py-4 bg-neutral-50 flex justify-end gap-2 rounded-b-lg",children:[n.jsx("button",{onClick:()=>f(!1),className:"px-4 py-2 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-100 transition-colors",children:"取消"}),n.jsx("button",{onClick:P,className:"px-4 py-2 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors",children:"保存"})]})]})}),x&&b&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-lg w-full",children:[n.jsxs("div",{className:"px-6 py-4 border-b border-neutral-200 flex items-center justify-between",children:[n.jsx("h3",{className:"text-lg font-medium text-neutral-900",children:l?"编辑企业介绍":"添加企业介绍"}),n.jsx("button",{onClick:()=>h(!1),className:"text-neutral-400 hover:text-neutral-600 transition-colors",children:n.jsx(Ze,{className:"w-5 h-5"})})]}),n.jsxs("div",{className:"p-6 space-y-4",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:["公司简介 ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("textarea",{value:b.introduction,onChange:C=>y({...b,introduction:C.target.value}),rows:6,placeholder:"请输入公司简介...",className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:"组织架构图"}),b.orgChartAttachments&&b.orgChartAttachments.length>0&&n.jsx("div",{className:"grid grid-cols-3 gap-3 mb-3",children:b.orgChartAttachments.map(C=>n.jsxs("div",{className:"relative group",children:[n.jsx("img",{src:C.url,alt:C.name,className:"w-full h-32 object-cover rounded-lg border border-neutral-200"}),n.jsx("button",{onClick:()=>{y({...b,orgChartAttachments:b.orgChartAttachments.filter(Y=>Y.id!==C.id)})},className:"absolute top-1 right-1 bg-red-500 text-white rounded-full p-1 opacity-0 group-hover:opacity-100 transition-opacity hover:bg-red-600",children:n.jsx(qe,{className:"w-3 h-3"})}),n.jsx("p",{className:"text-xs text-neutral-600 mt-1 truncate",children:C.name})]},C.id))}),n.jsxs("div",{className:"border-2 border-dashed border-neutral-300 rounded-lg p-4 text-center hover:border-primary-500 transition-colors cursor-pointer",onClick:()=>{var C;return(C=document.getElementById("org-chart-upload"))==null?void 0:C.click()},children:[n.jsx(wt,{className:"w-6 h-6 mx-auto text-neutral-400 mb-1"}),n.jsx("p",{className:"text-xs text-neutral-600",children:"点击上传"}),n.jsx("p",{className:"text-xs text-neutral-500 mt-0.5",children:"支持JPG、PNG、JPEG格式"})]}),n.jsx("input",{id:"org-chart-upload",type:"file",className:"hidden",accept:".jpg,.jpeg,.png",multiple:!0,onChange:async C=>{const Y=Array.from(C.target.files||[]);if(Y.length!==0){for(const B of Y){if(B.size>50*1024*1024){alert(`文件 ${B.name} 大小超过50MB`);continue}try{const ee=await F(B),re={id:`${Date.now()}-${Math.random()}`,url:ee,name:B.name};y(Q=>({...Q,orgChartAttachments:[...Q.orgChartAttachments||[],re]}))}catch(ee){console.error("文件读取失败:",ee),alert(`文件 ${B.name} 读取失败`)}}C.target.value=""}}})]})]}),n.jsxs("div",{className:"px-6 py-4 bg-neutral-50 flex justify-end gap-2 rounded-b-lg",children:[n.jsx("button",{onClick:()=>h(!1),className:"px-4 py-2 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-100 transition-colors",children:"取消"}),n.jsx("button",{onClick:K,className:"px-4 py-2 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors",children:"保存"})]})]})})]})},Mb=({companyId:e,readOnly:t=!1})=>{const[r,a]=M.useState(()=>{const A=localStorage.getItem(`qualifications_${e}`);return A?JSON.parse(A):[{id:"1",name:"ISO9001质量管理体系认证",certNumber:"ISO9001-2024-001",certScope:"软件开发、系统集成",certOrganization:"中国质量认证中心",rating:"无",validFrom:"2024-01-01",validUntil:"2025-12-31",isPermanent:!1,attachments:[{id:"1",url:"https://via.placeholder.com/400x300/4F46E5/FFFFFF?text=ISO9001",name:"ISO9001证书.pdf"}],createdAt:new Date().toISOString()}]});M.useEffect(()=>{localStorage.setItem(`qualifications_${e}`,JSON.stringify(r))},[r,e]);const[s,i]=M.useState(""),[l,c]=M.useState(""),[o,u]=M.useState("all"),[d,f]=M.useState("all"),[x,h]=M.useState(1),[p,m]=M.useState(10),[w,v]=M.useState(""),[b,y]=M.useState(!1),[N,F]=M.useState(!1),[j,k]=M.useState(!1),[S,P]=M.useState(null),[D,K]=M.useState(null),C=A=>{const ne=new Date;return new Date(A)<ne},Y=()=>{i(""),c(""),u("all"),f("all"),h(1)},B=()=>{console.log("Searching:",s,l,o,d)},ee=()=>{K({id:"",name:"",certNumber:"",certScope:"",certOrganization:"",rating:"无",validFrom:"",validUntil:"",isPermanent:!1,attachments:[]}),y(!0)},re=A=>{K({...A,isPermanent:A.isPermanent||!1}),F(!0)},Q=A=>{P(A),k(!0)},te=()=>{if(D){const A={...D,id:String(Date.now()),createdAt:new Date().toISOString()};a([...r,A]),y(!1)}},H=()=>{D&&(a(r.map(A=>A.id===D.id?D:A)),F(!1))},ae=()=>{S&&(a(r.filter(A=>A.id!==S.id)),k(!1))},he=r.filter(A=>{const ne=!s||A.name.toLowerCase().includes(s.toLowerCase()),ue=!l||A.certNumber.toLowerCase().includes(l.toLowerCase()),ve=o==="all"||A.rating===o,xe=d==="all"||d==="valid"&&!C(A.validUntil)||d==="expired"&&C(A.validUntil);return ne&&ue&&ve&&xe}).sort((A,ne)=>{const ue=A.createdAt?new Date(A.createdAt).getTime():0;return(ne.createdAt?new Date(ne.createdAt).getTime():0)-ue}),O=()=>{const A=(x-1)*p,ne=A+p;return he.slice(A,ne)},I=Math.ceil(he.length/p),g=A=>{m(A),h(1)},_=()=>{const A=parseInt(w);A>=1&&A<=I&&(h(A),v(""))};return n.jsxs("div",{className:"flex flex-col h-full",children:[t&&n.jsx("div",{className:"px-6 py-3 bg-yellow-50 border-b border-yellow-200",children:n.jsxs("p",{className:"text-sm text-yellow-800",children:[n.jsx(Hn,{className:"w-4 h-4 inline mr-2"}),"只读模式 - 无法编辑资质信息"]})}),n.jsx("div",{className:"flex-1 overflow-auto",children:n.jsxs("div",{className:"bg-white rounded-lg border border-neutral-200",children:[n.jsxs("div",{className:"px-6 py-4 border-b border-neutral-200",children:[n.jsx("div",{className:"flex items-center justify-between mb-4",children:n.jsx("h2",{className:"text-lg font-medium text-neutral-900",children:"资质信息"})}),n.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4",children:n.jsx("p",{className:"text-sm text-blue-700",children:"该模块用于管理企业的各类资质证书，包括但不限于建筑业企业资质、ISO认证、各类许可证等。这些资质信息将用于证明企业的业务能力和技术水平，并在生成投标文件时自动匹配招标要求。请及时更新过期资质，并保持信息完整。"})}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex items-center gap-3 flex-wrap",children:["资质名称",n.jsx("input",{type:"text",placeholder:"请输入资质名称",value:s,onChange:A=>i(A.target.value),className:"w-40 px-3 py-1.5 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500"}),"资质编号",n.jsx("input",{type:"text",placeholder:"请输入资质编号",value:l,onChange:A=>c(A.target.value),className:"w-40 px-3 py-1.5 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500"}),"评级",n.jsxs("select",{value:o,onChange:A=>u(A.target.value),className:"px-3 py-1.5 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500",children:[n.jsx("option",{value:"all",children:"全部"}),n.jsx("option",{value:"无",children:"无"}),n.jsx("option",{value:"特级",children:"特级"}),n.jsx("option",{value:"一级",children:"一级"}),n.jsx("option",{value:"二级",children:"二级"}),n.jsx("option",{value:"三级",children:"三级"}),n.jsx("option",{value:"四级",children:"四级"}),n.jsx("option",{value:"五级",children:"五级"}),n.jsx("option",{value:"甲级",children:"甲级"}),n.jsx("option",{value:"乙级",children:"乙级"}),n.jsx("option",{value:"丙级",children:"丙级"}),n.jsx("option",{value:"AAA",children:"AAA"}),n.jsx("option",{value:"AAAA",children:"AAAA"}),n.jsx("option",{value:"AAAAA",children:"AAAAA"}),n.jsx("option",{value:"CS1",children:"CS1"}),n.jsx("option",{value:"CS2",children:"CS2"}),n.jsx("option",{value:"CS3",children:"CS3"}),n.jsx("option",{value:"CS4",children:"CS4"}),n.jsx("option",{value:"CS5",children:"CS5"}),n.jsx("option",{value:"一星级",children:"一星级"}),n.jsx("option",{value:"二星级",children:"二星级"}),n.jsx("option",{value:"三星级",children:"三星级"}),n.jsx("option",{value:"四星级",children:"四星级"}),n.jsx("option",{value:"五星级",children:"五星级"}),n.jsx("option",{value:"六星级",children:"六星级"}),n.jsx("option",{value:"七星级",children:"七星级"}),n.jsx("option",{value:"八星级",children:"八星级"}),n.jsx("option",{value:"九星级",children:"九星级"}),n.jsx("option",{value:"十星级",children:"十星级"}),n.jsx("option",{value:"十一星级",children:"十一星级"}),n.jsx("option",{value:"十二星级",children:"十二星级"})]}),"资质状态",n.jsxs("select",{value:d,onChange:A=>f(A.target.value),className:"px-3 py-1.5 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500",children:[n.jsx("option",{value:"all",children:"全部"}),n.jsx("option",{value:"valid",children:"有效"}),n.jsx("option",{value:"expired",children:"已过期"})]})]}),n.jsxs("div",{className:"flex justify-end gap-2",children:[n.jsx("button",{onClick:Y,className:"px-4 py-1.5 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-50 transition-colors",children:"重置"}),n.jsx("button",{onClick:B,className:"px-4 py-1.5 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors",children:"查询"})]})]})]}),!t&&n.jsx("div",{className:"px-6 py-3 border-b border-neutral-200",children:n.jsxs("button",{onClick:ee,className:"px-4 py-1.5 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors flex items-center",children:[n.jsx(Ct,{className:"w-4 h-4 mr-1"}),"新增资质"]})}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"w-full",children:[n.jsx("thead",{className:"bg-neutral-50 border-b border-neutral-200",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"序号"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"资质名称"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"资质编号"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"评级"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"认证事项范围"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"认证机构"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"认证有效期"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"状态"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"操作"})]})}),n.jsx("tbody",{className:"divide-y divide-neutral-200",children:O().length===0?n.jsx("tr",{children:n.jsx("td",{colSpan:9,className:"px-4 py-8 text-center text-neutral-500",children:"暂无数据"})}):O().map((A,ne)=>n.jsxs("tr",{className:"hover:bg-neutral-50 transition-colors",children:[n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm text-neutral-900",children:(x-1)*p+ne+1}),n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm text-neutral-900",children:n.jsx("div",{className:"max-w-xs truncate",title:A.name,children:A.name})}),n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm text-neutral-900",children:A.certNumber}),n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm text-neutral-900",children:A.rating||"无"}),n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm text-neutral-900",children:n.jsx("div",{className:"max-w-xs truncate",title:A.certScope,children:A.certScope})}),n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm text-neutral-900",children:n.jsx("div",{className:"max-w-xs truncate",title:A.certOrganization,children:A.certOrganization})}),n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm text-neutral-900",children:n.jsx("span",{className:C(A.validUntil)?"text-red-600 font-medium":"",children:A.validUntil})}),n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap",children:C(A.validUntil)?n.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-red-100 text-red-800",children:"已过期"}):n.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-green-100 text-green-800",children:"有效"})}),n.jsxs("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm",children:[!t&&n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsxs("button",{onClick:()=>re(A),className:"px-2 py-1 text-xs text-primary-600 hover:text-primary-800 hover:bg-primary-50 rounded transition-colors flex items-center gap-1",children:[n.jsx(Md,{className:"w-3.5 h-3.5"}),"编辑"]}),n.jsxs("button",{onClick:()=>Q(A),className:"px-2 py-1 text-xs text-red-600 hover:text-red-800 hover:bg-red-50 rounded transition-colors flex items-center gap-1",children:[n.jsx(qe,{className:"w-3.5 h-3.5"}),"删除"]})]}),t&&n.jsx("span",{className:"text-xs text-neutral-400",children:"只读"})]})]},A.id))})]})}),n.jsxs("div",{className:"bg-white border-t border-neutral-200 px-6 py-3 flex items-center justify-center gap-6",children:[n.jsxs("div",{className:"text-sm text-neutral-700",children:["共 ",he.length," 条"]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("button",{onClick:()=>h(Math.max(1,x-1)),disabled:x===1,className:`px-2 py-1 text-sm rounded transition-colors ${x===1?"bg-neutral-100 text-neutral-400 cursor-not-allowed":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:"<"}),n.jsx("div",{className:"flex items-center space-x-1",children:Array.from({length:Math.min(10,I)},(A,ne)=>{let ue;return I<=10||x<=5?ue=ne+1:x>=I-4?ue=I-9+ne:ue=x-4+ne,n.jsx("button",{onClick:()=>h(ue),className:`px-2.5 py-1 text-sm rounded transition-colors ${x===ue?"bg-primary-600 text-white":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:ue},ue)})}),I>10&&n.jsxs(n.Fragment,{children:[n.jsx("span",{className:"text-neutral-500",children:"..."}),n.jsx("button",{onClick:()=>h(I),className:`px-2.5 py-1 text-sm rounded transition-colors ${x===I?"bg-primary-600 text-white":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:I})]}),n.jsx("button",{onClick:()=>h(Math.min(I,x+1)),disabled:x===I,className:`px-2 py-1 text-sm rounded transition-colors ${x===I?"bg-neutral-100 text-neutral-400 cursor-not-allowed":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:">"})]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsxs("select",{value:p,onChange:A=>g(Number(A.target.value)),className:"px-2 py-1 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500",children:[n.jsx("option",{value:10,children:"10条/页"}),n.jsx("option",{value:20,children:"20条/页"}),n.jsx("option",{value:50,children:"50条/页"})]}),n.jsx("span",{className:"text-sm text-neutral-700",children:"前往"}),n.jsx("input",{type:"number",value:w,onChange:A=>v(A.target.value),placeholder:"页",className:"w-12 px-2 py-1 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500",min:1,max:I}),n.jsx("button",{onClick:_,className:"px-3 py-1 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-50 transition-colors",children:"页"})]})]})]})}),b&&D&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[n.jsxs("div",{className:"px-6 py-4 border-b border-neutral-200 flex items-center justify-between sticky top-0 bg-white",children:[n.jsx("h3",{className:"text-lg font-medium text-neutral-900",children:"新增资质"}),n.jsx("button",{onClick:()=>y(!1),className:"text-neutral-400 hover:text-neutral-600 transition-colors",children:n.jsx(Ze,{className:"w-5 h-5"})})]}),n.jsx("div",{className:"p-6 space-y-4",children:n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:["资质名称 ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:D.name,onChange:A=>K({...D,name:A.target.value}),placeholder:"请输入资质名称",className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:["资质编号 ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:D.certNumber,onChange:A=>K({...D,certNumber:A.target.value}),placeholder:"请输入资质编号",className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:["认证事项范围 ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("textarea",{value:D.certScope,onChange:A=>K({...D,certScope:A.target.value}),placeholder:"请输入认证事项范围",rows:2,className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:["认证机构 ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:D.certOrganization,onChange:A=>K({...D,certOrganization:A.target.value}),placeholder:"请输入认证机构",className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:"评级等级"}),n.jsxs("select",{value:D.rating,onChange:A=>K({...D,rating:A.target.value}),className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[n.jsx("option",{value:"无",children:"无"}),n.jsx("option",{value:"特级",children:"特级"}),n.jsx("option",{value:"一级",children:"一级"}),n.jsx("option",{value:"二级",children:"二级"}),n.jsx("option",{value:"三级",children:"三级"}),n.jsx("option",{value:"四级",children:"四级"}),n.jsx("option",{value:"五级",children:"五级"}),n.jsx("option",{value:"甲级",children:"甲级"}),n.jsx("option",{value:"乙级",children:"乙级"}),n.jsx("option",{value:"丙级",children:"丙级"}),n.jsx("option",{value:"AAA",children:"AAA"}),n.jsx("option",{value:"AAAA",children:"AAAA"}),n.jsx("option",{value:"AAAAA",children:"AAAAA"}),n.jsx("option",{value:"CS1",children:"CS1"}),n.jsx("option",{value:"CS2",children:"CS2"}),n.jsx("option",{value:"CS3",children:"CS3"}),n.jsx("option",{value:"CS4",children:"CS4"}),n.jsx("option",{value:"CS5",children:"CS5"}),n.jsx("option",{value:"一星级",children:"一星级"}),n.jsx("option",{value:"二星级",children:"二星级"}),n.jsx("option",{value:"三星级",children:"三星级"}),n.jsx("option",{value:"四星级",children:"四星级"}),n.jsx("option",{value:"五星级",children:"五星级"}),n.jsx("option",{value:"六星级",children:"六星级"}),n.jsx("option",{value:"七星级",children:"七星级"}),n.jsx("option",{value:"八星级",children:"八星级"}),n.jsx("option",{value:"九星级",children:"九星级"}),n.jsx("option",{value:"十星级",children:"十星级"}),n.jsx("option",{value:"十一星级",children:"十一星级"}),n.jsx("option",{value:"十二星级",children:"十二星级"})]})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:["认证有效期 ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsxs("div",{className:"flex items-center space-x-4 mb-2",children:[n.jsxs("label",{className:"flex items-center",children:[n.jsx("input",{type:"radio",checked:!D.isPermanent,onChange:()=>K({...D,isPermanent:!1}),className:"mr-2"}),n.jsx("span",{className:"text-sm text-neutral-700",children:"非长期"})]}),n.jsxs("label",{className:"flex items-center",children:[n.jsx("input",{type:"radio",checked:D.isPermanent,onChange:()=>K({...D,isPermanent:!0,validUntil:"",validFrom:""}),className:"mr-2"}),n.jsx("span",{className:"text-sm text-neutral-700",children:"长期"})]})]}),D.isPermanent?n.jsx("div",{className:"w-full px-3 py-2 border border-neutral-300 rounded-lg bg-neutral-50 text-neutral-500",children:"长期有效"}):n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-neutral-600 mb-1",children:"生效日期"}),n.jsx("input",{type:"date",value:D.validFrom||"",onChange:A=>K({...D,validFrom:A.target.value}),className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-xs text-neutral-600 mb-1",children:["失效日期 ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"date",value:D.validUntil,onChange:A=>K({...D,validUntil:A.target.value}),className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]})]})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:["资质证书 ",n.jsx("span",{className:"text-red-500",children:"*"})]}),D.attachments&&D.attachments.length>0&&n.jsx("div",{className:"mb-3",children:n.jsx("div",{className:"grid grid-cols-3 gap-3 relative",children:D.attachments.map((A,ne)=>n.jsxs("div",{className:"relative group",children:[n.jsx("img",{src:A.url,alt:A.name,className:"w-full h-32 object-cover rounded-lg border border-neutral-200"}),n.jsx("button",{onClick:()=>{K({...D,attachments:D.attachments.filter(ue=>ue.id!==A.id)})},className:"absolute top-1 right-1 bg-red-500 text-white rounded-full p-1 opacity-0 group-hover:opacity-100 transition-opacity hover:bg-red-600",children:n.jsx(qe,{className:"w-3 h-3"})}),n.jsx("p",{className:"text-xs text-neutral-600 mt-1 truncate",children:A.name})]},A.id))})}),n.jsxs("div",{className:"border-2 border-dashed border-neutral-300 rounded-lg p-4 text-center hover:border-primary-500 transition-colors cursor-pointer",onClick:()=>{var A;return(A=document.getElementById("qualification-upload-add"))==null?void 0:A.click()},children:[n.jsx(wt,{className:"w-6 h-6 mx-auto text-neutral-400 mb-1"}),n.jsx("p",{className:"text-xs text-neutral-600",children:"点击上传"}),n.jsx("p",{className:"text-xs text-neutral-500 mt-0.5",children:"支持JPG、PNG、JPEG格式"}),n.jsx("input",{id:"qualification-upload-add",type:"file",className:"hidden",accept:".jpg,.jpeg,.png",multiple:!0,onChange:A=>{const ne=Array.from(A.target.files||[]),ue=D.attachments.length===0,ve=ne.map(xe=>({id:String(Date.now()+Math.random()),name:xe.name,url:URL.createObjectURL(xe)}));K(xe=>({...xe,attachments:[...xe.attachments,...ve]})),ue&&ne.length>0&&K(xe=>({...xe,name:"ISO9001质量管理体系认证",certNumber:"ISO9001-2024-001",certScope:"软件开发、系统集成",certOrganization:"中国质量认证中心",rating:"无",validFrom:"2024-01-01",validUntil:"2025-12-31",isPermanent:!1}))}})]})]})]})}),n.jsxs("div",{className:"px-6 py-4 bg-neutral-50 flex justify-end gap-2 rounded-b-lg sticky bottom-0",children:[n.jsx("button",{onClick:()=>y(!1),className:"px-4 py-2 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-100 transition-colors",children:"取消"}),n.jsx("button",{onClick:te,className:"px-4 py-2 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors",children:"确定"})]})]})}),N&&D&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[n.jsxs("div",{className:"px-6 py-4 border-b border-neutral-200 flex items-center justify-between sticky top-0 bg-white",children:[n.jsx("h3",{className:"text-lg font-medium text-neutral-900",children:"编辑资质"}),n.jsx("button",{onClick:()=>F(!1),className:"text-neutral-400 hover:text-neutral-600 transition-colors",children:n.jsx(Ze,{className:"w-5 h-5"})})]}),n.jsx("div",{className:"p-6 space-y-4",children:n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:["资质名称 ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:D.name,onChange:A=>K({...D,name:A.target.value}),placeholder:"请输入资质名称",className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:["资质编号 ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:D.certNumber,onChange:A=>K({...D,certNumber:A.target.value}),placeholder:"请输入资质编号",className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:["认证事项范围 ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("textarea",{value:D.certScope,onChange:A=>K({...D,certScope:A.target.value}),placeholder:"请输入认证事项范围",rows:2,className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:["认证机构 ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:D.certOrganization,onChange:A=>K({...D,certOrganization:A.target.value}),placeholder:"请输入认证机构",className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:"评级等级"}),n.jsxs("select",{value:D.rating,onChange:A=>K({...D,rating:A.target.value}),className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[n.jsx("option",{value:"无",children:"无"}),n.jsx("option",{value:"特级",children:"特级"}),n.jsx("option",{value:"一级",children:"一级"}),n.jsx("option",{value:"二级",children:"二级"}),n.jsx("option",{value:"三级",children:"三级"}),n.jsx("option",{value:"四级",children:"四级"}),n.jsx("option",{value:"五级",children:"五级"}),n.jsx("option",{value:"甲级",children:"甲级"}),n.jsx("option",{value:"乙级",children:"乙级"}),n.jsx("option",{value:"丙级",children:"丙级"}),n.jsx("option",{value:"AAA",children:"AAA"}),n.jsx("option",{value:"AAAA",children:"AAAA"}),n.jsx("option",{value:"AAAAA",children:"AAAAA"}),n.jsx("option",{value:"CS1",children:"CS1"}),n.jsx("option",{value:"CS2",children:"CS2"}),n.jsx("option",{value:"CS3",children:"CS3"}),n.jsx("option",{value:"CS4",children:"CS4"}),n.jsx("option",{value:"CS5",children:"CS5"}),n.jsx("option",{value:"一星级",children:"一星级"}),n.jsx("option",{value:"二星级",children:"二星级"}),n.jsx("option",{value:"三星级",children:"三星级"}),n.jsx("option",{value:"四星级",children:"四星级"}),n.jsx("option",{value:"五星级",children:"五星级"}),n.jsx("option",{value:"六星级",children:"六星级"}),n.jsx("option",{value:"七星级",children:"七星级"}),n.jsx("option",{value:"八星级",children:"八星级"}),n.jsx("option",{value:"九星级",children:"九星级"}),n.jsx("option",{value:"十星级",children:"十星级"}),n.jsx("option",{value:"十一星级",children:"十一星级"}),n.jsx("option",{value:"十二星级",children:"十二星级"})]})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:["认证有效期 ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsxs("div",{className:"flex items-center space-x-4 mb-2",children:[n.jsxs("label",{className:"flex items-center",children:[n.jsx("input",{type:"radio",checked:!D.isPermanent,onChange:()=>K({...D,isPermanent:!1}),className:"mr-2"}),n.jsx("span",{className:"text-sm text-neutral-700",children:"非长期"})]}),n.jsxs("label",{className:"flex items-center",children:[n.jsx("input",{type:"radio",checked:D.isPermanent,onChange:()=>K({...D,isPermanent:!0,validUntil:"",validFrom:""}),className:"mr-2"}),n.jsx("span",{className:"text-sm text-neutral-700",children:"长期"})]})]}),D.isPermanent?n.jsx("div",{className:"w-full px-3 py-2 border border-neutral-300 rounded-lg bg-neutral-50 text-neutral-500",children:"长期有效"}):n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-neutral-600 mb-1",children:"生效日期"}),n.jsx("input",{type:"date",value:D.validFrom||"",onChange:A=>K({...D,validFrom:A.target.value}),className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-xs text-neutral-600 mb-1",children:["失效日期 ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"date",value:D.validUntil,onChange:A=>K({...D,validUntil:A.target.value}),className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]})]})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:["资质证书 ",n.jsx("span",{className:"text-red-500",children:"*"})]}),D.attachments&&D.attachments.length>0&&n.jsx("div",{className:"mb-3",children:n.jsx("div",{className:"grid grid-cols-3 gap-3 relative",children:D.attachments.map((A,ne)=>n.jsxs("div",{className:"relative group",children:[A.url?n.jsx("img",{src:A.url,alt:A.name,className:"w-full h-32 object-cover rounded-lg border border-neutral-200"}):n.jsx("div",{className:"w-full h-32 flex items-center justify-center bg-neutral-100 rounded-lg border border-neutral-200",children:n.jsx("span",{className:"text-xs text-neutral-500",children:A.name})}),n.jsx("button",{onClick:()=>{K({...D,attachments:D.attachments.filter((ue,ve)=>ve!==ne)})},className:"absolute top-1 right-1 bg-red-500 text-white rounded-full p-1 opacity-0 group-hover:opacity-100 transition-opacity hover:bg-red-600",children:n.jsx(qe,{className:"w-3 h-3"})}),n.jsx("p",{className:"text-xs text-neutral-600 mt-1 truncate",children:A.name})]},A.id||ne))})}),n.jsxs("div",{className:"border-2 border-dashed border-neutral-300 rounded-lg p-4 text-center hover:border-primary-500 transition-colors cursor-pointer",onClick:()=>{var A;return(A=document.getElementById("qualification-upload-edit"))==null?void 0:A.click()},children:[n.jsx(wt,{className:"w-6 h-6 mx-auto text-neutral-400 mb-1"}),n.jsx("p",{className:"text-xs text-neutral-600",children:"点击上传"}),n.jsx("p",{className:"text-xs text-neutral-500 mt-0.5",children:"支持JPG、PNG格式"}),n.jsx("input",{id:"qualification-upload-edit",type:"file",className:"hidden",accept:".jpg,.jpeg,.png",multiple:!0,onChange:A=>{const ne=Array.from(A.target.files||[]),ue=D.attachments.length===0,ve=ne.map(xe=>({id:String(Date.now()+Math.random()),name:xe.name,url:URL.createObjectURL(xe)}));K(xe=>({...xe,attachments:[...xe.attachments,...ve]})),ue&&ne.length>0&&K(xe=>({...xe,name:"ISO9001质量管理体系认证",certNumber:"ISO9001-2024-001",certScope:"软件开发、系统集成",certOrganization:"中国质量认证中心",rating:"无",validFrom:"2024-01-01",validUntil:"2025-12-31",isPermanent:!1}))}})]})]})]})}),n.jsxs("div",{className:"px-6 py-4 bg-neutral-50 flex justify-end gap-2 rounded-b-lg sticky bottom-0",children:[n.jsx("button",{onClick:()=>F(!1),className:"px-4 py-2 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-100 transition-colors",children:"取消"}),n.jsx("button",{onClick:H,className:"px-4 py-2 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors",children:"保存"})]})]})}),j&&S&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4",children:[n.jsx("div",{className:"px-6 py-4 border-b border-neutral-200",children:n.jsx("h3",{className:"text-lg font-medium text-neutral-900",children:"确认删除"})}),n.jsx("div",{className:"p-6",children:n.jsxs("p",{className:"text-neutral-600",children:["确定要删除资质 ",n.jsxs("span",{className:"font-medium",children:['"',S.name,'"']})," 吗？此操作不可恢复。"]})}),n.jsxs("div",{className:"px-6 py-4 bg-neutral-50 flex justify-end gap-2 rounded-b-lg",children:[n.jsx("button",{onClick:()=>k(!1),className:"px-4 py-2 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-100 transition-colors",children:"取消"}),n.jsx("button",{onClick:ae,className:"px-4 py-2 text-sm bg-red-600 text-white rounded hover:bg-red-700 transition-colors",children:"删除"})]})]})})]})},Rb=({companyId:e,readOnly:t=!1})=>{const[r,a]=M.useState(()=>{const g=localStorage.getItem(`financial_${e}`);return g?JSON.parse(g):[{id:"1",reportName:"2024年度财务报告",year:"2024",attachments:[{url:"",name:"2024财务报告.pdf",size:2048576}],createdAt:new Date().toISOString()}]});M.useEffect(()=>{localStorage.setItem(`financial_${e}`,JSON.stringify(r))},[r,e]);const[s,i]=M.useState(""),[l,c]=M.useState(1),[o,u]=M.useState(10),[d,f]=M.useState(""),[x,h]=M.useState(!1),[p,m]=M.useState(!1),[w,v]=M.useState(!1),[b,y]=M.useState(null),[N,F]=M.useState(null),j=50*1024*1024,k=g=>{if(g===0)return"0 B";const _=1024,A=["B","KB","MB","GB"],ne=Math.floor(Math.log(g)/Math.log(_));return Math.round(g/Math.pow(_,ne)*100)/100+" "+A[ne]},S=()=>{i(""),c(1)},P=()=>{console.log("Searching:",s)},D=()=>{F({id:"",reportName:"",year:new Date().getFullYear().toString(),attachments:[]}),h(!0)},K=g=>{F({...g}),m(!0)},C=g=>{y(g),v(!0)},Y=()=>{if(N){const g={...N,id:String(Date.now()),createdAt:new Date().toISOString()};a([...r,g]),h(!1)}},B=()=>{N&&(a(r.map(g=>g.id===N.id?N:g)),m(!1))},ee=()=>{b&&(a(r.filter(g=>g.id!==b.id)),v(!1))},re=g=>{if(N){if(g.size>j){alert(`文件 "${g.name}" 超过50MB限制，无法上传`);return}const _={url:"",name:g.name,size:g.size};F({...N,attachments:[...N.attachments,_]})}},Q=g=>{if(N){const _=N.attachments.filter((A,ne)=>ne!==g);F({...N,attachments:_})}},te=r.filter(g=>!s||g.year===s).sort((g,_)=>{const A=g.year?parseInt(g.year):0;return(_.year?parseInt(_.year):0)-A}),H=()=>{const g=(l-1)*o,_=g+o;return te.slice(g,_)},ae=Math.ceil(te.length/o),he=g=>{u(g),c(1)},O=()=>{const g=parseInt(d);g>=1&&g<=ae&&(c(g),f(""))},I=()=>{const g=new Date().getFullYear(),_=[];for(let A=g;A>=g-20;A--)_.push(A);return _};return n.jsxs("div",{className:"flex flex-col h-full",children:[t&&n.jsx("div",{className:"px-6 py-3 bg-yellow-50 border-b border-yellow-200",children:n.jsxs("p",{className:"text-sm text-yellow-800",children:[n.jsx(Hn,{className:"w-4 h-4 inline mr-2"}),"只读模式 - 无法编辑此信息"]})}),n.jsx("div",{className:"flex-1 overflow-auto",children:n.jsxs("div",{className:"bg-white rounded-lg border border-neutral-200",children:[n.jsxs("div",{className:"px-6 py-4 border-b border-neutral-200",children:[n.jsx("div",{className:"flex items-center justify-between mb-4",children:n.jsx("h2",{className:"text-lg font-medium text-neutral-900",children:"财务信息"})}),n.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4",children:n.jsx("p",{className:"text-sm text-blue-700",children:"该模块用于管理企业的财务报告，包括年度财务报表、审计报告等。财务数据将用于证明企业的财务状况和经营能力，在投标时作为评审的重要依据。请按年度录入完整的财务信息。"})}),n.jsxs("div",{className:"flex items-center justify-between gap-3",children:[n.jsxs("div",{className:"flex items-center gap-3",children:["时间",n.jsxs("select",{value:s,onChange:g=>i(g.target.value),className:"w-40 px-3 py-1.5 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500",children:[n.jsx("option",{value:"",children:"全部"}),I().map(g=>n.jsxs("option",{value:g,children:[g,"年"]},g))]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{onClick:S,className:"px-4 py-1.5 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-50 transition-colors",children:"重置"}),n.jsx("button",{onClick:P,className:"px-4 py-1.5 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors",children:"查询"})]})]})]}),!t&&n.jsx("div",{className:"px-6 py-3 border-b border-neutral-200",children:n.jsxs("button",{onClick:D,className:"px-4 py-1.5 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors flex items-center",children:[n.jsx(Ct,{className:"w-4 h-4 mr-1"}),"新增报告"]})}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"w-full",children:[n.jsx("thead",{className:"bg-neutral-50 border-b border-neutral-200",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"序号"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"报告名称"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"时间"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"附件"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"操作"})]})}),n.jsx("tbody",{className:"divide-y divide-neutral-200",children:H().length===0?n.jsx("tr",{children:n.jsx("td",{colSpan:5,className:"px-4 py-8 text-center text-neutral-500",children:"暂无数据"})}):H().map((g,_)=>n.jsxs("tr",{className:"hover:bg-neutral-50 transition-colors",children:[n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm text-neutral-900",children:(l-1)*o+_+1}),n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm text-neutral-900",children:n.jsx("div",{className:"max-w-xs truncate",title:g.reportName,children:g.reportName})}),n.jsxs("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm text-neutral-900",children:[g.year,"年"]}),n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm text-neutral-900",children:n.jsx("div",{className:"max-w-xs truncate",children:g.attachments.map((A,ne)=>n.jsxs("div",{className:"text-primary-600 hover:text-primary-800 cursor-pointer truncate",title:`${A.name} (${k(A.size)})`,children:[A.name," (",k(A.size),")"]},ne))})}),n.jsxs("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm",children:[!t&&n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsxs("button",{onClick:()=>K(g),className:"px-2 py-1 text-xs text-primary-600 hover:text-primary-800 hover:bg-primary-50 rounded transition-colors flex items-center gap-1",children:[n.jsx(Et,{className:"w-3.5 h-3.5"}),"编辑"]}),n.jsxs("button",{onClick:()=>C(g),className:"px-2 py-1 text-xs text-red-600 hover:text-red-800 hover:bg-red-50 rounded transition-colors flex items-center gap-1",children:[n.jsx(qe,{className:"w-3.5 h-3.5"}),"删除"]})]}),t&&n.jsx("span",{className:"text-xs text-neutral-400",children:"只读"})]})]},g.id))})]})}),n.jsxs("div",{className:"bg-white border-t border-neutral-200 px-6 py-3 flex items-center justify-center gap-6",children:[n.jsxs("div",{className:"text-sm text-neutral-700",children:["共 ",te.length," 条"]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("button",{onClick:()=>c(Math.max(1,l-1)),disabled:l===1,className:`px-2 py-1 text-sm rounded transition-colors ${l===1?"bg-neutral-100 text-neutral-400 cursor-not-allowed":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:"<"}),n.jsx("div",{className:"flex items-center space-x-1",children:Array.from({length:Math.min(10,ae)},(g,_)=>{let A;return ae<=10||l<=5?A=_+1:l>=ae-4?A=ae-9+_:A=l-4+_,n.jsx("button",{onClick:()=>c(A),className:`px-2.5 py-1 text-sm rounded transition-colors ${l===A?"bg-primary-600 text-white":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:A},A)})}),ae>10&&n.jsxs(n.Fragment,{children:[n.jsx("span",{className:"text-neutral-500",children:"..."}),n.jsx("button",{onClick:()=>c(ae),className:`px-2.5 py-1 text-sm rounded transition-colors ${l===ae?"bg-primary-600 text-white":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:ae})]}),n.jsx("button",{onClick:()=>c(Math.min(ae,l+1)),disabled:l===ae,className:`px-2 py-1 text-sm rounded transition-colors ${l===ae?"bg-neutral-100 text-neutral-400 cursor-not-allowed":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:">"})]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsxs("select",{value:o,onChange:g=>he(Number(g.target.value)),className:"px-2 py-1 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500",children:[n.jsx("option",{value:10,children:"10条/页"}),n.jsx("option",{value:20,children:"20条/页"}),n.jsx("option",{value:50,children:"50条/页"})]}),n.jsx("span",{className:"text-sm text-neutral-700",children:"前往"}),n.jsx("input",{type:"number",value:d,onChange:g=>f(g.target.value),placeholder:"页",className:"w-12 px-2 py-1 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500",min:1,max:ae}),n.jsx("button",{onClick:O,className:"px-3 py-1 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-50 transition-colors",children:"页"})]})]})]})}),x&&N&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[n.jsxs("div",{className:"px-6 py-4 border-b border-neutral-200 flex items-center justify-between sticky top-0 bg-white",children:[n.jsx("h3",{className:"text-lg font-medium text-neutral-900",children:"新增财务报告"}),n.jsx("button",{onClick:()=>h(!1),className:"text-neutral-400 hover:text-neutral-600 transition-colors",children:n.jsx(Ze,{className:"w-5 h-5"})})]}),n.jsxs("div",{className:"p-6 space-y-4",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:["报告名称 ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:N.reportName,onChange:g=>F({...N,reportName:g.target.value}),placeholder:"请输入报告名称",className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:["时间 ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("select",{value:N.year,onChange:g=>F({...N,year:g.target.value}),className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:I().map(g=>n.jsxs("option",{value:g,children:[g,"年"]},g))})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:["附件 ",n.jsx("span",{className:"text-red-500",children:"*"})," ",n.jsx("span",{className:"text-neutral-500 text-xs",children:"(支持多文件上传)"})]}),n.jsxs("div",{className:"border-2 border-dashed border-neutral-300 rounded-lg p-6 text-center hover:border-primary-500 transition-colors cursor-pointer",onClick:()=>{var g;return(g=document.getElementById("financial-upload-add"))==null?void 0:g.click()},children:[n.jsx(wt,{className:"w-8 h-8 mx-auto text-neutral-400 mb-2"}),n.jsx("p",{className:"text-sm text-neutral-600",children:"点击或拖拽文件到此处上传（支持多选）"}),n.jsx("p",{className:"text-xs text-neutral-500 mt-1",children:"仅支持PDF 格式"}),n.jsx("input",{id:"financial-upload-add",type:"file",className:"hidden",accept:".jpg,.jpeg,.png,.pdf",multiple:!0,onChange:g=>{Array.from(g.target.files||[]).forEach(A=>{re({name:A.name,size:A.size})})}})]}),N.attachments.length>0&&n.jsxs("div",{className:"mt-3 space-y-2",children:[n.jsx("p",{className:"text-sm font-medium text-neutral-700",children:"已上传文件："}),N.attachments.map((g,_)=>n.jsxs("div",{className:"flex items-center justify-between bg-neutral-50 px-3 py-2 rounded",children:[n.jsxs("div",{className:"flex items-center space-x-2 flex-1 min-w-0",children:[n.jsx(Pt,{className:"w-4 h-4 text-neutral-400 flex-shrink-0"}),n.jsx("span",{className:"text-sm text-neutral-900 truncate",children:g.name}),n.jsxs("span",{className:"text-xs text-neutral-500 flex-shrink-0",children:["(",k(g.size),")"]})]}),n.jsx("button",{onClick:()=>Q(_),className:"text-red-600 hover:text-red-800 text-sm ml-2 flex-shrink-0",children:n.jsx(qe,{className:"w-4 h-4"})})]},_))]})]})]}),n.jsxs("div",{className:"px-6 py-4 bg-neutral-50 flex justify-end gap-2 rounded-b-lg sticky bottom-0",children:[n.jsx("button",{onClick:()=>h(!1),className:"px-4 py-2 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-100 transition-colors",children:"取消"}),n.jsx("button",{onClick:Y,className:"px-4 py-2 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors",children:"确定"})]})]})}),p&&N&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[n.jsxs("div",{className:"px-6 py-4 border-b border-neutral-200 flex items-center justify-between sticky top-0 bg-white",children:[n.jsx("h3",{className:"text-lg font-medium text-neutral-900",children:"编辑财务报告"}),n.jsx("button",{onClick:()=>m(!1),className:"text-neutral-400 hover:text-neutral-600 transition-colors",children:n.jsx(Ze,{className:"w-5 h-5"})})]}),n.jsxs("div",{className:"p-6 space-y-4",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:["报告名称 ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:N.reportName,onChange:g=>F({...N,reportName:g.target.value}),placeholder:"请输入报告名称",className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:["时间 ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("select",{value:N.year,onChange:g=>F({...N,year:g.target.value}),className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:I().map(g=>n.jsxs("option",{value:g,children:[g,"年"]},g))})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:["附件 ",n.jsx("span",{className:"text-neutral-500 text-xs",children:"(支持多文件上传)"})]}),n.jsxs("div",{className:"border-2 border-dashed border-neutral-300 rounded-lg p-6 text-center hover:border-primary-500 transition-colors cursor-pointer",onClick:()=>{var g;return(g=document.getElementById("financial-upload-edit"))==null?void 0:g.click()},children:[n.jsx(wt,{className:"w-8 h-8 mx-auto text-neutral-400 mb-2"}),n.jsx("p",{className:"text-sm text-neutral-600",children:"点击或拖拽文件到此处上传（支持多选）"}),n.jsx("p",{className:"text-xs text-neutral-500 mt-1",children:"仅支持 JPG、PNG、JPEG、PDF 格式"}),n.jsx("input",{id:"financial-upload-edit",type:"file",className:"hidden",accept:".jpg,.jpeg,.png,.pdf",multiple:!0,onChange:g=>{Array.from(g.target.files||[]).forEach(A=>{re({name:A.name,size:A.size})})}})]}),N.attachments.length>0&&n.jsxs("div",{className:"mt-3 space-y-2",children:[n.jsx("p",{className:"text-sm font-medium text-neutral-700",children:"已上传文件："}),N.attachments.map((g,_)=>n.jsxs("div",{className:"flex items-center justify-between bg-neutral-50 px-3 py-2 rounded",children:[n.jsxs("div",{className:"flex items-center space-x-2 flex-1 min-w-0",children:[n.jsx(Pt,{className:"w-4 h-4 text-neutral-400 flex-shrink-0"}),n.jsx("span",{className:"text-sm text-neutral-900 truncate",children:g.name}),n.jsxs("span",{className:"text-xs text-neutral-500 flex-shrink-0",children:["(",k(g.size),")"]})]}),n.jsx("button",{onClick:()=>Q(_),className:"text-red-600 hover:text-red-800 text-sm ml-2 flex-shrink-0",children:n.jsx(qe,{className:"w-4 h-4"})})]},_))]})]})]}),n.jsxs("div",{className:"px-6 py-4 bg-neutral-50 flex justify-end gap-2 rounded-b-lg sticky bottom-0",children:[n.jsx("button",{onClick:()=>m(!1),className:"px-4 py-2 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-100 transition-colors",children:"取消"}),n.jsx("button",{onClick:B,className:"px-4 py-2 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors",children:"保存"})]})]})}),w&&b&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4",children:[n.jsx("div",{className:"px-6 py-4 border-b border-neutral-200",children:n.jsx("h3",{className:"text-lg font-medium text-neutral-900",children:"确认删除"})}),n.jsx("div",{className:"p-6",children:n.jsxs("p",{className:"text-neutral-600",children:["确定要删除财务报告 ",n.jsxs("span",{className:"font-medium",children:['"',b.reportName,'"']})," 吗？此操作不可恢复。"]})}),n.jsxs("div",{className:"px-6 py-4 bg-neutral-50 flex justify-end gap-2 rounded-b-lg",children:[n.jsx("button",{onClick:()=>v(!1),className:"px-4 py-2 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-100 transition-colors",children:"取消"}),n.jsx("button",{onClick:ee,className:"px-4 py-2 text-sm bg-red-600 text-white rounded hover:bg-red-700 transition-colors",children:"删除"})]})]})})]})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var go={};go.version="0.18.5";var w1=1252,Ob=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Gu={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Xu=function(e){Ob.indexOf(e)!=-1&&(w1=Gu[0]=e)};function Lb(){Xu(1252)}var Rn=function(e){Xu(e)};function Ku(){Rn(1200),Lb()}function Kx(e){for(var t=[],r=0,a=e.length;r<a;++r)t[r]=e.charCodeAt(r);return t}function Bb(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function N1(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var $i=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?Bb(e.slice(2)):t==254&&r==255?N1(e.slice(2)):t==65279?e.slice(1):e},yc=function(t){return String.fromCharCode(t)},Yx=function(t){return String.fromCharCode(t)},Ia,Oa="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Fl(e){for(var t="",r=0,a=0,s=0,i=0,l=0,c=0,o=0,u=0;u<e.length;)r=e.charCodeAt(u++),i=r>>2,a=e.charCodeAt(u++),l=(r&3)<<4|a>>4,s=e.charCodeAt(u++),c=(a&15)<<2|s>>6,o=s&63,isNaN(a)?c=o=64:isNaN(s)&&(o=64),t+=Oa.charAt(i)+Oa.charAt(l)+Oa.charAt(c)+Oa.charAt(o);return t}function cn(e){var t="",r=0,a=0,s=0,i=0,l=0,c=0,o=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<e.length;)i=Oa.indexOf(e.charAt(u++)),l=Oa.indexOf(e.charAt(u++)),r=i<<2|l>>4,t+=String.fromCharCode(r),c=Oa.indexOf(e.charAt(u++)),a=(l&15)<<4|c>>2,c!==64&&(t+=String.fromCharCode(a)),o=Oa.indexOf(e.charAt(u++)),s=(c&3)<<6|o,o!==64&&(t+=String.fromCharCode(s));return t}var rt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),ba=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function Ya(e){return rt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function qx(e){return rt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var rn=function(t){return rt?ba(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Go(e){if(typeof ArrayBuffer>"u")return rn(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),a=0;a!=e.length;++a)r[a]=e.charCodeAt(a)&255;return t}function rs(e){if(Array.isArray(e))return e.map(function(a){return String.fromCharCode(a)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function Ub(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function Yu(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return Yu(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var lr=rt?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:ba(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var a=new Uint8Array(r),s=0;for(t=0,r=0;t<e.length;r+=s,++t)if(s=e[t].length,e[t]instanceof Uint8Array)a.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";a.set(new Uint8Array(e[t]),r)}return a}return[].concat.apply([],e.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function zb(e){for(var t=[],r=0,a=e.length+250,s=Ya(e.length+255),i=0;i<e.length;++i){var l=e.charCodeAt(i);if(l<128)s[r++]=l;else if(l<2048)s[r++]=192|l>>6&31,s[r++]=128|l&63;else if(l>=55296&&l<57344){l=(l&1023)+64;var c=e.charCodeAt(++i)&1023;s[r++]=240|l>>8&7,s[r++]=128|l>>2&63,s[r++]=128|c>>6&15|(l&3)<<4,s[r++]=128|c&63}else s[r++]=224|l>>12&15,s[r++]=128|l>>6&63,s[r++]=128|l&63;r>a&&(t.push(s.slice(0,r)),r=0,s=Ya(65535),a=65530)}return t.push(s.slice(0,r)),lr(t)}var Lr=/\u0000/g,Vi=/[\u0001-\u0006]/g;function ci(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function On(e,t){var r=""+e;return r.length>=t?r:zt("0",t-r.length)+r}function qu(e,t){var r=""+e;return r.length>=t?r:zt(" ",t-r.length)+r}function vo(e,t){var r=""+e;return r.length>=t?r:r+zt(" ",t-r.length)}function Wb(e,t){var r=""+Math.round(e);return r.length>=t?r:zt("0",t-r.length)+r}function Hb(e,t){var r=""+e;return r.length>=t?r:zt("0",t-r.length)+r}var Jx=Math.pow(2,32);function Bs(e,t){if(e>Jx||e<-Jx)return Wb(e,t);var r=Math.round(e);return Hb(r,t)}function yo(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var Qx=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],E0=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function $b(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',e}var Ge={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},Zx={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Vb={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function bo(e,t,r){for(var a=e<0?-1:1,s=e*a,i=0,l=1,c=0,o=1,u=0,d=0,f=Math.floor(s);u<t&&(f=Math.floor(s),c=f*l+i,d=f*u+o,!(s-f<5e-8));)s=1/(s-f),i=l,l=c,o=u,u=d;if(d>t&&(u>t?(d=o,c=i):(d=u,c=l)),!r)return[0,a*c,d];var x=Math.floor(a*c/d);return[x,a*c-x*d,d]}function us(e,t,r){if(e>2958465||e<0)return null;var a=e|0,s=Math.floor(86400*(e-a)),i=0,l=[],c={D:a,T:s,u:86400*(e-a)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(c.u)<1e-6&&(c.u=0),t&&t.date1904&&(a+=1462),c.u>.9999&&(c.u=0,++s==86400&&(c.T=s=0,++a,++c.D)),a===60)l=r?[1317,10,29]:[1900,2,29],i=3;else if(a===0)l=r?[1317,8,29]:[1900,1,0],i=6;else{a>60&&--a;var o=new Date(1900,0,1);o.setDate(o.getDate()+a-1),l=[o.getFullYear(),o.getMonth()+1,o.getDate()],i=o.getDay(),a<60&&(i=(i+6)%7),r&&(i=Jb(o,l))}return c.y=l[0],c.m=l[1],c.d=l[2],c.S=s%60,s=Math.floor(s/60),c.M=s%60,s=Math.floor(s/60),c.H=s,c.q=i,c}var j1=new Date(1899,11,31,0,0,0),Gb=j1.getTime(),Xb=new Date(1900,2,1,0,0,0);function k1(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=Xb&&(r+=24*60*60*1e3),(r-(Gb+(e.getTimezoneOffset()-j1.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Ju(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Kb(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Yb(e){var t=e<0?12:11,r=Ju(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function qb(e){var t=Ju(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function Al(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=Yb(e):t===10?r=e.toFixed(10).substr(0,12):r=qb(e),Ju(Kb(r.toUpperCase()))}function ks(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Al(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return _n(14,k1(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function Jb(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function Qb(e,t,r,a){var s="",i=0,l=0,c=r.y,o,u=0;switch(e){case 98:c=r.y+543;case 121:switch(t.length){case 1:case 2:o=c%100,u=2;break;default:o=c%1e4,u=4;break}break;case 109:switch(t.length){case 1:case 2:o=r.m,u=t.length;break;case 3:return E0[r.m-1][1];case 5:return E0[r.m-1][0];default:return E0[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:o=r.d,u=t.length;break;case 3:return Qx[r.q][0];default:return Qx[r.q][1]}break;case 104:switch(t.length){case 1:case 2:o=1+(r.H+11)%12,u=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:o=r.H,u=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:o=r.M,u=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?On(r.S,t.length):(a>=2?l=a===3?1e3:100:l=a===1?10:1,i=Math.round(l*(r.S+r.u)),i>=60*l&&(i=0),t==="s"?i===0?"0":""+i/l:(s=On(i,2+a),t==="ss"?s.substr(0,2):"."+s.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":o=r.D*24+r.H;break;case"[m]":case"[mm]":o=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":o=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}u=t.length===3?1:2;break;case 101:o=c,u=1;break}var d=u>0?On(o,u):"";return d}function La(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,a=e.substr(0,r);r!=e.length;r+=t)a+=(a.length>0?",":"")+e.substr(r,t);return a}var _1=/%/g;function Zb(e,t,r){var a=t.replace(_1,""),s=t.length-a.length;return ua(e,a,r*Math.pow(10,2*s))+zt("%",s)}function ew(e,t,r){for(var a=t.length-1;t.charCodeAt(a-1)===44;)--a;return ua(e,t.substr(0,a),r/Math.pow(10,3*(t.length-a)))}function S1(e,t){var r,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+S1(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%s;if(i<0&&(i+=s),r=(t/Math.pow(10,i)).toPrecision(a+1+(s+i)%s),r.indexOf("e")===-1){var l=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(l-r.length+i):r+="E+"+(l-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,s)+"."+r.substr(2+s),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,o,u,d){return o+u+d.substr(0,(s+i)%s)+"."+d.substr(i)+"E"})}else r=t.toExponential(a);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var C1=/# (\?+)( ?)\/( ?)(\d+)/;function tw(e,t,r){var a=parseInt(e[4],10),s=Math.round(t*a),i=Math.floor(s/a),l=s-i*a,c=a;return r+(i===0?"":""+i)+" "+(l===0?zt(" ",e[1].length+1+e[4].length):qu(l,e[1].length)+e[2]+"/"+e[3]+On(c,e[4].length))}function rw(e,t,r){return r+(t===0?"":""+t)+zt(" ",e[1].length+2+e[4].length)}var E1=/^#*0*\.([0#]+)/,T1=/\).*[0#]/,F1=/\(###\) ###\\?-####/;function Mr(e){for(var t="",r,a=0;a!=e.length;++a)switch(r=e.charCodeAt(a)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function em(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function tm(e,t){var r=e-Math.floor(e),a=Math.pow(10,t);return t<(""+Math.round(r*a)).length?0:Math.round(r*a)}function nw(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function aw(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function xn(e,t,r){if(e.charCodeAt(0)===40&&!t.match(T1)){var a=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?xn("n",a,r):"("+xn("n",a,-r)+")"}if(t.charCodeAt(t.length-1)===44)return ew(e,t,r);if(t.indexOf("%")!==-1)return Zb(e,t,r);if(t.indexOf("E")!==-1)return S1(t,r);if(t.charCodeAt(0)===36)return"$"+xn(e,t.substr(t.charAt(1)==" "?2:1),r);var s,i,l,c,o=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+Bs(o,t.length);if(t.match(/^[#?]+$/))return s=Bs(r,0),s==="0"&&(s=""),s.length>t.length?s:Mr(t.substr(0,t.length-s.length))+s;if(i=t.match(C1))return tw(i,o,u);if(t.match(/^#+0+$/))return u+Bs(o,t.length-t.indexOf("0"));if(i=t.match(E1))return s=em(r,i[1].length).replace(/^([^\.]+)$/,"$1."+Mr(i[1])).replace(/\.$/,"."+Mr(i[1])).replace(/\.(\d*)$/,function(p,m){return"."+m+zt("0",Mr(i[1]).length-m.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return u+em(o,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return u+La(Bs(o,0));if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+xn(e,t,-r):La(""+(Math.floor(r)+nw(r,i[1].length)))+"."+On(tm(r,i[1].length),i[1].length);if(i=t.match(/^#,#*,#0/))return xn(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=ci(xn(e,t.replace(/[\\-]/g,""),r)),l=0,ci(ci(t.replace(/\\/g,"")).replace(/[0#]/g,function(p){return l<s.length?s.charAt(l++):p==="0"?"0":""}));if(t.match(F1))return s=xn(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var d="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(i[4].length,7),c=bo(o,Math.pow(10,l)-1,!1),s=""+u,d=ua("n",i[1],c[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),s+=d+i[2]+"/"+i[3],d=vo(c[2],l),d.length<i[4].length&&(d=Mr(i[4].substr(i[4].length-d.length))+d),s+=d,s;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(i[1].length,i[4].length),7),c=bo(o,Math.pow(10,l)-1,!0),u+(c[0]||(c[1]?"":"0"))+" "+(c[1]?qu(c[1],l)+i[2]+"/"+i[3]+vo(c[2],l):zt(" ",2*l+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return s=Bs(r,0),t.length<=s.length?s:Mr(t.substr(0,t.length-s.length))+s;if(i=t.match(/^([#0?]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),l=s.indexOf(".");var f=t.indexOf(".")-l,x=t.length-s.length-f;return Mr(t.substr(0,f)+s+t.substr(t.length-x))}if(i=t.match(/^00,000\.([#0]*0)$/))return l=tm(r,i[1].length),r<0?"-"+xn(e,t,-r):La(aw(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(p){return"00,"+(p.length<3?On(0,3-p.length):"")+p})+"."+On(l,i[1].length);switch(t){case"###,##0.00":return xn(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var h=La(Bs(o,0));return h!=="0"?u+h:"";case"###,###.00":return xn(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return xn(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function sw(e,t,r){for(var a=t.length-1;t.charCodeAt(a-1)===44;)--a;return ua(e,t.substr(0,a),r/Math.pow(10,3*(t.length-a)))}function iw(e,t,r){var a=t.replace(_1,""),s=t.length-a.length;return ua(e,a,r*Math.pow(10,2*s))+zt("%",s)}function A1(e,t){var r,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+A1(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%s;if(i<0&&(i+=s),r=(t/Math.pow(10,i)).toPrecision(a+1+(s+i)%s),!r.match(/[Ee]/)){var l=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(l-r.length+i):r+="E+"+(l-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,o,u,d){return o+u+d.substr(0,(s+i)%s)+"."+d.substr(i)+"E"})}else r=t.toExponential(a);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Gn(e,t,r){if(e.charCodeAt(0)===40&&!t.match(T1)){var a=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Gn("n",a,r):"("+Gn("n",a,-r)+")"}if(t.charCodeAt(t.length-1)===44)return sw(e,t,r);if(t.indexOf("%")!==-1)return iw(e,t,r);if(t.indexOf("E")!==-1)return A1(t,r);if(t.charCodeAt(0)===36)return"$"+Gn(e,t.substr(t.charAt(1)==" "?2:1),r);var s,i,l,c,o=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+On(o,t.length);if(t.match(/^[#?]+$/))return s=""+r,r===0&&(s=""),s.length>t.length?s:Mr(t.substr(0,t.length-s.length))+s;if(i=t.match(C1))return rw(i,o,u);if(t.match(/^#+0+$/))return u+On(o,t.length-t.indexOf("0"));if(i=t.match(E1))return s=(""+r).replace(/^([^\.]+)$/,"$1."+Mr(i[1])).replace(/\.$/,"."+Mr(i[1])),s=s.replace(/\.(\d*)$/,function(p,m){return"."+m+zt("0",Mr(i[1]).length-m.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return u+(""+o).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return u+La(""+o);if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Gn(e,t,-r):La(""+r)+"."+zt("0",i[1].length);if(i=t.match(/^#,#*,#0/))return Gn(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=ci(Gn(e,t.replace(/[\\-]/g,""),r)),l=0,ci(ci(t.replace(/\\/g,"")).replace(/[0#]/g,function(p){return l<s.length?s.charAt(l++):p==="0"?"0":""}));if(t.match(F1))return s=Gn(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var d="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(i[4].length,7),c=bo(o,Math.pow(10,l)-1,!1),s=""+u,d=ua("n",i[1],c[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),s+=d+i[2]+"/"+i[3],d=vo(c[2],l),d.length<i[4].length&&(d=Mr(i[4].substr(i[4].length-d.length))+d),s+=d,s;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(i[1].length,i[4].length),7),c=bo(o,Math.pow(10,l)-1,!0),u+(c[0]||(c[1]?"":"0"))+" "+(c[1]?qu(c[1],l)+i[2]+"/"+i[3]+vo(c[2],l):zt(" ",2*l+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return s=""+r,t.length<=s.length?s:Mr(t.substr(0,t.length-s.length))+s;if(i=t.match(/^([#0]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),l=s.indexOf(".");var f=t.indexOf(".")-l,x=t.length-s.length-f;return Mr(t.substr(0,f)+s+t.substr(t.length-x))}if(i=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Gn(e,t,-r):La(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(p){return"00,"+(p.length<3?On(0,3-p.length):"")+p})+"."+On(0,i[1].length);switch(t){case"###,###":case"##,###":case"#,###":var h=La(""+o);return h!=="0"?u+h:"";default:if(t.match(/\.[0#?]*$/))return Gn(e,t.slice(0,t.lastIndexOf(".")),r)+Mr(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function ua(e,t,r){return(r|0)===r?Gn(e,t,r):xn(e,t,r)}function lw(e){for(var t=[],r=!1,a=0,s=0;a<e.length;++a)switch(e.charCodeAt(a)){case 34:r=!r;break;case 95:case 42:case 92:++a;break;case 59:t[t.length]=e.substr(s,a-s),s=a+1}if(t[t.length]=e.substr(s),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var P1=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Si(e){for(var t=0,r="",a="";t<e.length;)switch(r=e.charAt(t)){case"G":yo(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="上午/下午")return!0;++t;break;case"[":for(a=r;e.charAt(t++)!=="]"&&t<e.length;)a+=e.charAt(t);if(a.match(P1))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function cw(e,t,r,a){for(var s=[],i="",l=0,c="",o="t",u,d,f,x="H";l<e.length;)switch(c=e.charAt(l)){case"G":if(!yo(e,l))throw new Error("unrecognized character "+c+" in "+e);s[s.length]={t:"G",v:"General"},l+=7;break;case'"':for(i="";(f=e.charCodeAt(++l))!==34&&l<e.length;)i+=String.fromCharCode(f);s[s.length]={t:"t",v:i},++l;break;case"\\":var h=e.charAt(++l),p=h==="("||h===")"?h:"t";s[s.length]={t:p,v:h},++l;break;case"_":s[s.length]={t:"t",v:" "},l+=2;break;case"@":s[s.length]={t:"T",v:t},++l;break;case"B":case"b":if(e.charAt(l+1)==="1"||e.charAt(l+1)==="2"){if(u==null&&(u=us(t,r,e.charAt(l+1)==="2"),u==null))return"";s[s.length]={t:"X",v:e.substr(l,2)},o=c,l+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":c=c.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||u==null&&(u=us(t,r),u==null))return"";for(i=c;++l<e.length&&e.charAt(l).toLowerCase()===c;)i+=c;c==="m"&&o.toLowerCase()==="h"&&(c="M"),c==="h"&&(c=x),s[s.length]={t:c,v:i},o=c;break;case"A":case"a":case"上":var m={t:c,v:c};if(u==null&&(u=us(t,r)),e.substr(l,3).toUpperCase()==="A/P"?(u!=null&&(m.v=u.H>=12?"P":"A"),m.t="T",x="h",l+=3):e.substr(l,5).toUpperCase()==="AM/PM"?(u!=null&&(m.v=u.H>=12?"PM":"AM"),m.t="T",l+=5,x="h"):e.substr(l,5).toUpperCase()==="上午/下午"?(u!=null&&(m.v=u.H>=12?"下午":"上午"),m.t="T",l+=5,x="h"):(m.t="t",++l),u==null&&m.t==="T")return"";s[s.length]=m,o=c;break;case"[":for(i=c;e.charAt(l++)!=="]"&&l<e.length;)i+=e.charAt(l);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(P1)){if(u==null&&(u=us(t,r),u==null))return"";s[s.length]={t:"Z",v:i.toLowerCase()},o=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",Si(e)||(s[s.length]={t:"t",v:i}));break;case".":if(u!=null){for(i=c;++l<e.length&&(c=e.charAt(l))==="0";)i+=c;s[s.length]={t:"s",v:i};break}case"0":case"#":for(i=c;++l<e.length&&"0#?.,E+-%".indexOf(c=e.charAt(l))>-1;)i+=c;s[s.length]={t:"n",v:i};break;case"?":for(i=c;e.charAt(++l)===c;)i+=c;s[s.length]={t:c,v:i},o=c;break;case"*":++l,(e.charAt(l)==" "||e.charAt(l)=="*")&&++l;break;case"(":case")":s[s.length]={t:a===1?"t":c,v:c},++l;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=c;l<e.length&&"0123456789".indexOf(e.charAt(++l))>-1;)i+=e.charAt(l);s[s.length]={t:"D",v:i};break;case" ":s[s.length]={t:c,v:c},++l;break;case"$":s[s.length]={t:"t",v:"$"},++l;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(c)===-1)throw new Error("unrecognized character "+c+" in "+e);s[s.length]={t:"t",v:c},++l;break}var w=0,v=0,b;for(l=s.length-1,o="t";l>=0;--l)switch(s[l].t){case"h":case"H":s[l].t=x,o="h",w<1&&(w=1);break;case"s":(b=s[l].v.match(/\.0+$/))&&(v=Math.max(v,b[0].length-1)),w<3&&(w=3);case"d":case"y":case"M":case"e":o=s[l].t;break;case"m":o==="s"&&(s[l].t="M",w<2&&(w=2));break;case"X":break;case"Z":w<1&&s[l].v.match(/[Hh]/)&&(w=1),w<2&&s[l].v.match(/[Mm]/)&&(w=2),w<3&&s[l].v.match(/[Ss]/)&&(w=3)}switch(w){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var y="",N;for(l=0;l<s.length;++l)switch(s[l].t){case"t":case"T":case" ":case"D":break;case"X":s[l].v="",s[l].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[l].v=Qb(s[l].t.charCodeAt(0),s[l].v,u,v),s[l].t="t";break;case"n":case"?":for(N=l+1;s[N]!=null&&((c=s[N].t)==="?"||c==="D"||(c===" "||c==="t")&&s[N+1]!=null&&(s[N+1].t==="?"||s[N+1].t==="t"&&s[N+1].v==="/")||s[l].t==="("&&(c===" "||c==="n"||c===")")||c==="t"&&(s[N].v==="/"||s[N].v===" "&&s[N+1]!=null&&s[N+1].t=="?"));)s[l].v+=s[N].v,s[N]={v:"",t:";"},++N;y+=s[l].v,l=N-1;break;case"G":s[l].t="t",s[l].v=ks(t,r);break}var F="",j,k;if(y.length>0){y.charCodeAt(0)==40?(j=t<0&&y.charCodeAt(0)===45?-t:t,k=ua("n",y,j)):(j=t<0&&a>1?-t:t,k=ua("n",y,j),j<0&&s[0]&&s[0].t=="t"&&(k=k.substr(1),s[0].v="-"+s[0].v)),N=k.length-1;var S=s.length;for(l=0;l<s.length;++l)if(s[l]!=null&&s[l].t!="t"&&s[l].v.indexOf(".")>-1){S=l;break}var P=s.length;if(S===s.length&&k.indexOf("E")===-1){for(l=s.length-1;l>=0;--l)s[l]==null||"n?".indexOf(s[l].t)===-1||(N>=s[l].v.length-1?(N-=s[l].v.length,s[l].v=k.substr(N+1,s[l].v.length)):N<0?s[l].v="":(s[l].v=k.substr(0,N+1),N=-1),s[l].t="t",P=l);N>=0&&P<s.length&&(s[P].v=k.substr(0,N+1)+s[P].v)}else if(S!==s.length&&k.indexOf("E")===-1){for(N=k.indexOf(".")-1,l=S;l>=0;--l)if(!(s[l]==null||"n?".indexOf(s[l].t)===-1)){for(d=s[l].v.indexOf(".")>-1&&l===S?s[l].v.indexOf(".")-1:s[l].v.length-1,F=s[l].v.substr(d+1);d>=0;--d)N>=0&&(s[l].v.charAt(d)==="0"||s[l].v.charAt(d)==="#")&&(F=k.charAt(N--)+F);s[l].v=F,s[l].t="t",P=l}for(N>=0&&P<s.length&&(s[P].v=k.substr(0,N+1)+s[P].v),N=k.indexOf(".")+1,l=S;l<s.length;++l)if(!(s[l]==null||"n?(".indexOf(s[l].t)===-1&&l!==S)){for(d=s[l].v.indexOf(".")>-1&&l===S?s[l].v.indexOf(".")+1:0,F=s[l].v.substr(0,d);d<s[l].v.length;++d)N<k.length&&(F+=k.charAt(N++));s[l].v=F,s[l].t="t",P=l}}}for(l=0;l<s.length;++l)s[l]!=null&&"n?".indexOf(s[l].t)>-1&&(j=a>1&&t<0&&l>0&&s[l-1].v==="-"?-t:t,s[l].v=ua(s[l].t,s[l].v,j),s[l].t="t");var D="";for(l=0;l!==s.length;++l)s[l]!=null&&(D+=s[l].v);return D}var rm=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function nm(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function ow(e,t){var r=lw(e),a=r.length,s=r[a-1].indexOf("@");if(a<4&&s>-1&&--a,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||s>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=s>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=s>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=s>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[a,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var l=r[0].match(rm),c=r[1].match(rm);return nm(t,l)?[a,r[0]]:nm(t,c)?[a,r[1]]:[a,r[l!=null&&c!=null?2:1]]}return[a,i]}function _n(e,t,r){r==null&&(r={});var a="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?a=r.dateNF:a=e;break;case"number":e==14&&r.dateNF?a=r.dateNF:a=(r.table!=null?r.table:Ge)[e],a==null&&(a=r.table&&r.table[Zx[e]]||Ge[Zx[e]]),a==null&&(a=Vb[e]||"General");break}if(yo(a,0))return ks(t,r);t instanceof Date&&(t=k1(t,r.date1904));var s=ow(a,t);if(yo(s[1]))return ks(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return cw(s[1],t,r,s[0])}function fa(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(Ge[r]==null){t<0&&(t=r);continue}if(Ge[r]==e){t=r;break}}t<0&&(t=391)}return Ge[t]=e,t}function Xo(e){for(var t=0;t!=392;++t)e[t]!==void 0&&fa(e[t],t)}function Ci(){Ge=$b()}var dw={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},D1=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function uw(e){var t=typeof e=="number"?Ge[e]:e;return t=t.replace(D1,"(\\d+)"),new RegExp("^"+t+"$")}function fw(e,t,r){var a=-1,s=-1,i=-1,l=-1,c=-1,o=-1;(t.match(D1)||[]).forEach(function(f,x){var h=parseInt(r[x+1],10);switch(f.toLowerCase().charAt(0)){case"y":a=h;break;case"d":i=h;break;case"h":l=h;break;case"s":o=h;break;case"m":l>=0?c=h:s=h;break}}),o>=0&&c==-1&&s>=0&&(c=s,s=-1);var u=(""+(a>=0?a:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var d=("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2);return l==-1&&c==-1&&o==-1?u:a==-1&&s==-1&&i==-1?d:u+"T"+d}var xw=function(){var e={};e.version="1.2.0";function t(){for(var k=0,S=new Array(256),P=0;P!=256;++P)k=P,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,S[P]=k;return typeof Int32Array<"u"?new Int32Array(S):S}var r=t();function a(k){var S=0,P=0,D=0,K=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(D=0;D!=256;++D)K[D]=k[D];for(D=0;D!=256;++D)for(P=k[D],S=256+D;S<4096;S+=256)P=K[S]=P>>>8^k[P&255];var C=[];for(D=1;D!=16;++D)C[D-1]=typeof Int32Array<"u"?K.subarray(D*256,D*256+256):K.slice(D*256,D*256+256);return C}var s=a(r),i=s[0],l=s[1],c=s[2],o=s[3],u=s[4],d=s[5],f=s[6],x=s[7],h=s[8],p=s[9],m=s[10],w=s[11],v=s[12],b=s[13],y=s[14];function N(k,S){for(var P=S^-1,D=0,K=k.length;D<K;)P=P>>>8^r[(P^k.charCodeAt(D++))&255];return~P}function F(k,S){for(var P=S^-1,D=k.length-15,K=0;K<D;)P=y[k[K++]^P&255]^b[k[K++]^P>>8&255]^v[k[K++]^P>>16&255]^w[k[K++]^P>>>24]^m[k[K++]]^p[k[K++]]^h[k[K++]]^x[k[K++]]^f[k[K++]]^d[k[K++]]^u[k[K++]]^o[k[K++]]^c[k[K++]]^l[k[K++]]^i[k[K++]]^r[k[K++]];for(D+=15;K<D;)P=P>>>8^r[(P^k[K++])&255];return~P}function j(k,S){for(var P=S^-1,D=0,K=k.length,C=0,Y=0;D<K;)C=k.charCodeAt(D++),C<128?P=P>>>8^r[(P^C)&255]:C<2048?(P=P>>>8^r[(P^(192|C>>6&31))&255],P=P>>>8^r[(P^(128|C&63))&255]):C>=55296&&C<57344?(C=(C&1023)+64,Y=k.charCodeAt(D++)&1023,P=P>>>8^r[(P^(240|C>>8&7))&255],P=P>>>8^r[(P^(128|C>>2&63))&255],P=P>>>8^r[(P^(128|Y>>6&15|(C&3)<<4))&255],P=P>>>8^r[(P^(128|Y&63))&255]):(P=P>>>8^r[(P^(224|C>>12&15))&255],P=P>>>8^r[(P^(128|C>>6&63))&255],P=P>>>8^r[(P^(128|C&63))&255]);return~P}return e.table=r,e.bstr=N,e.buf=F,e.str=j,e}(),$e=function(){var t={};t.version="1.2.1";function r(T,z){for(var R=T.split("/"),L=z.split("/"),V=0,X=0,le=Math.min(R.length,L.length);V<le;++V){if(X=R[V].length-L[V].length)return X;if(R[V]!=L[V])return R[V]<L[V]?-1:1}return R.length-L.length}function a(T){if(T.charAt(T.length-1)=="/")return T.slice(0,-1).indexOf("/")===-1?T:a(T.slice(0,-1));var z=T.lastIndexOf("/");return z===-1?T:T.slice(0,z+1)}function s(T){if(T.charAt(T.length-1)=="/")return s(T.slice(0,-1));var z=T.lastIndexOf("/");return z===-1?T:T.slice(z+1)}function i(T,z){typeof z=="string"&&(z=new Date(z));var R=z.getHours();R=R<<6|z.getMinutes(),R=R<<5|z.getSeconds()>>>1,T.write_shift(2,R);var L=z.getFullYear()-1980;L=L<<4|z.getMonth()+1,L=L<<5|z.getDate(),T.write_shift(2,L)}function l(T){var z=T.read_shift(2)&65535,R=T.read_shift(2)&65535,L=new Date,V=R&31;R>>>=5;var X=R&15;R>>>=4,L.setMilliseconds(0),L.setFullYear(R+1980),L.setMonth(X-1),L.setDate(V);var le=z&31;z>>>=5;var ge=z&63;return z>>>=6,L.setHours(z),L.setMinutes(ge),L.setSeconds(le<<1),L}function c(T){hr(T,0);for(var z={},R=0;T.l<=T.length-4;){var L=T.read_shift(2),V=T.read_shift(2),X=T.l+V,le={};switch(L){case 21589:R=T.read_shift(1),R&1&&(le.mtime=T.read_shift(4)),V>5&&(R&2&&(le.atime=T.read_shift(4)),R&4&&(le.ctime=T.read_shift(4))),le.mtime&&(le.mt=new Date(le.mtime*1e3));break}T.l=X,z[L]=le}return z}var o;function u(){return o||(o={})}function d(T,z){if(T[0]==80&&T[1]==75)return zr(T,z);if((T[0]|32)==109&&(T[1]|32)==105)return En(T,z);if(T.length<512)throw new Error("CFB file size "+T.length+" < 512");var R=3,L=512,V=0,X=0,le=0,ge=0,ie=0,ce=[],de=T.slice(0,512);hr(de,0);var Se=f(de);switch(R=Se[0],R){case 3:L=512;break;case 4:L=4096;break;case 0:if(Se[1]==0)return zr(T,z);default:throw new Error("Major Version: Expected 3 or 4 saw "+R)}L!==512&&(de=T.slice(0,L),hr(de,28));var Ee=T.slice(0,L);x(de,R);var U=de.read_shift(4,"i");if(R===3&&U!==0)throw new Error("# Directory Sectors: Expected 0 saw "+U);de.l+=4,le=de.read_shift(4,"i"),de.l+=4,de.chk("00100000","Mini Stream Cutoff Size: "),ge=de.read_shift(4,"i"),V=de.read_shift(4,"i"),ie=de.read_shift(4,"i"),X=de.read_shift(4,"i");for(var q=-1,J=0;J<109&&(q=de.read_shift(4,"i"),!(q<0));++J)ce[J]=q;var fe=h(T,L);w(ie,X,fe,L,ce);var be=b(fe,le,ce,L);be[le].name="!Directory",V>0&&ge!==Y&&(be[ge].name="!MiniFAT"),be[ce[0]].name="!FAT",be.fat_addrs=ce,be.ssz=L;var Le={},G=[],je=[],Fe=[];y(le,be,fe,G,V,Le,je,ge),p(je,Fe,G),G.shift();var we={FileIndex:je,FullPaths:Fe};return z&&z.raw&&(we.raw={header:Ee,sectors:fe}),we}function f(T){if(T[T.l]==80&&T[T.l+1]==75)return[0,0];T.chk(B,"Header Signature: "),T.l+=16;var z=T.read_shift(2,"u");return[T.read_shift(2,"u"),z]}function x(T,z){var R=9;switch(T.l+=2,R=T.read_shift(2)){case 9:if(z!=3)throw new Error("Sector Shift: Expected 9 saw "+R);break;case 12:if(z!=4)throw new Error("Sector Shift: Expected 12 saw "+R);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+R)}T.chk("0600","Mini Sector Shift: "),T.chk("000000000000","Reserved: ")}function h(T,z){for(var R=Math.ceil(T.length/z)-1,L=[],V=1;V<R;++V)L[V-1]=T.slice(V*z,(V+1)*z);return L[R-1]=T.slice(R*z),L}function p(T,z,R){for(var L=0,V=0,X=0,le=0,ge=0,ie=R.length,ce=[],de=[];L<ie;++L)ce[L]=de[L]=L,z[L]=R[L];for(;ge<de.length;++ge)L=de[ge],V=T[L].L,X=T[L].R,le=T[L].C,ce[L]===L&&(V!==-1&&ce[V]!==V&&(ce[L]=ce[V]),X!==-1&&ce[X]!==X&&(ce[L]=ce[X])),le!==-1&&(ce[le]=L),V!==-1&&L!=ce[L]&&(ce[V]=ce[L],de.lastIndexOf(V)<ge&&de.push(V)),X!==-1&&L!=ce[L]&&(ce[X]=ce[L],de.lastIndexOf(X)<ge&&de.push(X));for(L=1;L<ie;++L)ce[L]===L&&(X!==-1&&ce[X]!==X?ce[L]=ce[X]:V!==-1&&ce[V]!==V&&(ce[L]=ce[V]));for(L=1;L<ie;++L)if(T[L].type!==0){if(ge=L,ge!=ce[ge])do ge=ce[ge],z[L]=z[ge]+"/"+z[L];while(ge!==0&&ce[ge]!==-1&&ge!=ce[ge]);ce[L]=-1}for(z[0]+="/",L=1;L<ie;++L)T[L].type!==2&&(z[L]+="/")}function m(T,z,R){for(var L=T.start,V=T.size,X=[],le=L;R&&V>0&&le>=0;)X.push(z.slice(le*C,le*C+C)),V-=C,le=ls(R,le*4);return X.length===0?ye(0):lr(X).slice(0,T.size)}function w(T,z,R,L,V){var X=Y;if(T===Y){if(z!==0)throw new Error("DIFAT chain shorter than expected")}else if(T!==-1){var le=R[T],ge=(L>>>2)-1;if(!le)return;for(var ie=0;ie<ge&&(X=ls(le,ie*4))!==Y;++ie)V.push(X);w(ls(le,L-4),z-1,R,L,V)}}function v(T,z,R,L,V){var X=[],le=[];V||(V=[]);var ge=L-1,ie=0,ce=0;for(ie=z;ie>=0;){V[ie]=!0,X[X.length]=ie,le.push(T[ie]);var de=R[Math.floor(ie*4/L)];if(ce=ie*4&ge,L<4+ce)throw new Error("FAT boundary crossed: "+ie+" 4 "+L);if(!T[de])break;ie=ls(T[de],ce)}return{nodes:X,data:hm([le])}}function b(T,z,R,L){var V=T.length,X=[],le=[],ge=[],ie=[],ce=L-1,de=0,Se=0,Ee=0,U=0;for(de=0;de<V;++de)if(ge=[],Ee=de+z,Ee>=V&&(Ee-=V),!le[Ee]){ie=[];var q=[];for(Se=Ee;Se>=0;){q[Se]=!0,le[Se]=!0,ge[ge.length]=Se,ie.push(T[Se]);var J=R[Math.floor(Se*4/L)];if(U=Se*4&ce,L<4+U)throw new Error("FAT boundary crossed: "+Se+" 4 "+L);if(!T[J]||(Se=ls(T[J],U),q[Se]))break}X[Ee]={nodes:ge,data:hm([ie])}}return X}function y(T,z,R,L,V,X,le,ge){for(var ie=0,ce=L.length?2:0,de=z[T].data,Se=0,Ee=0,U;Se<de.length;Se+=128){var q=de.slice(Se,Se+128);hr(q,64),Ee=q.read_shift(2),U=af(q,0,Ee-ce),L.push(U);var J={name:U,type:q.read_shift(1),color:q.read_shift(1),L:q.read_shift(4,"i"),R:q.read_shift(4,"i"),C:q.read_shift(4,"i"),clsid:q.read_shift(16),state:q.read_shift(4,"i"),start:0,size:0},fe=q.read_shift(2)+q.read_shift(2)+q.read_shift(2)+q.read_shift(2);fe!==0&&(J.ct=N(q,q.l-8));var be=q.read_shift(2)+q.read_shift(2)+q.read_shift(2)+q.read_shift(2);be!==0&&(J.mt=N(q,q.l-8)),J.start=q.read_shift(4,"i"),J.size=q.read_shift(4,"i"),J.size<0&&J.start<0&&(J.size=J.type=0,J.start=Y,J.name=""),J.type===5?(ie=J.start,V>0&&ie!==Y&&(z[ie].name="!StreamData")):J.size>=4096?(J.storage="fat",z[J.start]===void 0&&(z[J.start]=v(R,J.start,z.fat_addrs,z.ssz)),z[J.start].name=J.name,J.content=z[J.start].data.slice(0,J.size)):(J.storage="minifat",J.size<0?J.size=0:ie!==Y&&J.start!==Y&&z[ie]&&(J.content=m(J,z[ie].data,(z[ge]||{}).data))),J.content&&hr(J.content,0),X[U]=J,le.push(J)}}function N(T,z){return new Date((tn(T,z+4)/1e7*Math.pow(2,32)+tn(T,z)/1e7-11644473600)*1e3)}function F(T,z){return u(),d(o.readFileSync(T),z)}function j(T,z){var R=z&&z.type;switch(R||rt&&Buffer.isBuffer(T)&&(R="buffer"),R||"base64"){case"file":return F(T,z);case"base64":return d(rn(cn(T)),z);case"binary":return d(rn(T),z)}return d(T,z)}function k(T,z){var R=z||{},L=R.root||"Root Entry";if(T.FullPaths||(T.FullPaths=[]),T.FileIndex||(T.FileIndex=[]),T.FullPaths.length!==T.FileIndex.length)throw new Error("inconsistent CFB structure");T.FullPaths.length===0&&(T.FullPaths[0]=L+"/",T.FileIndex[0]={name:L,type:5}),R.CLSID&&(T.FileIndex[0].clsid=R.CLSID),S(T)}function S(T){var z="Sh33tJ5";if(!$e.find(T,"/"+z)){var R=ye(4);R[0]=55,R[1]=R[3]=50,R[2]=54,T.FileIndex.push({name:z,type:2,content:R,size:4,L:69,R:69,C:69}),T.FullPaths.push(T.FullPaths[0]+z),P(T)}}function P(T,z){k(T);for(var R=!1,L=!1,V=T.FullPaths.length-1;V>=0;--V){var X=T.FileIndex[V];switch(X.type){case 0:L?R=!0:(T.FileIndex.pop(),T.FullPaths.pop());break;case 1:case 2:case 5:L=!0,isNaN(X.R*X.L*X.C)&&(R=!0),X.R>-1&&X.L>-1&&X.R==X.L&&(R=!0);break;default:R=!0;break}}if(!(!R&&!z)){var le=new Date(1987,1,19),ge=0,ie=Object.create?Object.create(null):{},ce=[];for(V=0;V<T.FullPaths.length;++V)ie[T.FullPaths[V]]=!0,T.FileIndex[V].type!==0&&ce.push([T.FullPaths[V],T.FileIndex[V]]);for(V=0;V<ce.length;++V){var de=a(ce[V][0]);L=ie[de],L||(ce.push([de,{name:s(de).replace("/",""),type:1,clsid:re,ct:le,mt:le,content:null}]),ie[de]=!0)}for(ce.sort(function(U,q){return r(U[0],q[0])}),T.FullPaths=[],T.FileIndex=[],V=0;V<ce.length;++V)T.FullPaths[V]=ce[V][0],T.FileIndex[V]=ce[V][1];for(V=0;V<ce.length;++V){var Se=T.FileIndex[V],Ee=T.FullPaths[V];if(Se.name=s(Ee).replace("/",""),Se.L=Se.R=Se.C=-(Se.color=1),Se.size=Se.content?Se.content.length:0,Se.start=0,Se.clsid=Se.clsid||re,V===0)Se.C=ce.length>1?1:-1,Se.size=0,Se.type=5;else if(Ee.slice(-1)=="/"){for(ge=V+1;ge<ce.length&&a(T.FullPaths[ge])!=Ee;++ge);for(Se.C=ge>=ce.length?-1:ge,ge=V+1;ge<ce.length&&a(T.FullPaths[ge])!=a(Ee);++ge);Se.R=ge>=ce.length?-1:ge,Se.type=1}else a(T.FullPaths[V+1]||"")==a(Ee)&&(Se.R=V+1),Se.type=2}}}function D(T,z){var R=z||{};if(R.fileType=="mad")return Tn(T,R);switch(P(T),R.fileType){case"zip":return Pr(T,R)}var L=function(U){for(var q=0,J=0,fe=0;fe<U.FileIndex.length;++fe){var be=U.FileIndex[fe];if(be.content){var Le=be.content.length;Le>0&&(Le<4096?q+=Le+63>>6:J+=Le+511>>9)}}for(var G=U.FullPaths.length+3>>2,je=q+7>>3,Fe=q+127>>7,we=je+J+G+Fe,ct=we+127>>7,xt=ct<=109?0:Math.ceil((ct-109)/127);we+ct+xt+127>>7>ct;)xt=++ct<=109?0:Math.ceil((ct-109)/127);var yt=[1,xt,ct,Fe,G,J,q,0];return U.FileIndex[0].size=q<<6,yt[7]=(U.FileIndex[0].start=yt[0]+yt[1]+yt[2]+yt[3]+yt[4]+yt[5])+(yt[6]+7>>3),yt}(T),V=ye(L[7]<<9),X=0,le=0;{for(X=0;X<8;++X)V.write_shift(1,ee[X]);for(X=0;X<8;++X)V.write_shift(2,0);for(V.write_shift(2,62),V.write_shift(2,3),V.write_shift(2,65534),V.write_shift(2,9),V.write_shift(2,6),X=0;X<3;++X)V.write_shift(2,0);for(V.write_shift(4,0),V.write_shift(4,L[2]),V.write_shift(4,L[0]+L[1]+L[2]+L[3]-1),V.write_shift(4,0),V.write_shift(4,4096),V.write_shift(4,L[3]?L[0]+L[1]+L[2]-1:Y),V.write_shift(4,L[3]),V.write_shift(-4,L[1]?L[0]-1:Y),V.write_shift(4,L[1]),X=0;X<109;++X)V.write_shift(-4,X<L[2]?L[1]+X:-1)}if(L[1])for(le=0;le<L[1];++le){for(;X<236+le*127;++X)V.write_shift(-4,X<L[2]?L[1]+X:-1);V.write_shift(-4,le===L[1]-1?Y:le+1)}var ge=function(U){for(le+=U;X<le-1;++X)V.write_shift(-4,X+1);U&&(++X,V.write_shift(-4,Y))};for(le=X=0,le+=L[1];X<le;++X)V.write_shift(-4,Q.DIFSECT);for(le+=L[2];X<le;++X)V.write_shift(-4,Q.FATSECT);ge(L[3]),ge(L[4]);for(var ie=0,ce=0,de=T.FileIndex[0];ie<T.FileIndex.length;++ie)de=T.FileIndex[ie],de.content&&(ce=de.content.length,!(ce<4096)&&(de.start=le,ge(ce+511>>9)));for(ge(L[6]+7>>3);V.l&511;)V.write_shift(-4,Q.ENDOFCHAIN);for(le=X=0,ie=0;ie<T.FileIndex.length;++ie)de=T.FileIndex[ie],de.content&&(ce=de.content.length,!(!ce||ce>=4096)&&(de.start=le,ge(ce+63>>6)));for(;V.l&511;)V.write_shift(-4,Q.ENDOFCHAIN);for(X=0;X<L[4]<<2;++X){var Se=T.FullPaths[X];if(!Se||Se.length===0){for(ie=0;ie<17;++ie)V.write_shift(4,0);for(ie=0;ie<3;++ie)V.write_shift(4,-1);for(ie=0;ie<12;++ie)V.write_shift(4,0);continue}de=T.FileIndex[X],X===0&&(de.start=de.size?de.start-1:Y);var Ee=X===0&&R.root||de.name;if(ce=2*(Ee.length+1),V.write_shift(64,Ee,"utf16le"),V.write_shift(2,ce),V.write_shift(1,de.type),V.write_shift(1,de.color),V.write_shift(-4,de.L),V.write_shift(-4,de.R),V.write_shift(-4,de.C),de.clsid)V.write_shift(16,de.clsid,"hex");else for(ie=0;ie<4;++ie)V.write_shift(4,0);V.write_shift(4,de.state||0),V.write_shift(4,0),V.write_shift(4,0),V.write_shift(4,0),V.write_shift(4,0),V.write_shift(4,de.start),V.write_shift(4,de.size),V.write_shift(4,0)}for(X=1;X<T.FileIndex.length;++X)if(de=T.FileIndex[X],de.size>=4096)if(V.l=de.start+1<<9,rt&&Buffer.isBuffer(de.content))de.content.copy(V,V.l,0,de.size),V.l+=de.size+511&-512;else{for(ie=0;ie<de.size;++ie)V.write_shift(1,de.content[ie]);for(;ie&511;++ie)V.write_shift(1,0)}for(X=1;X<T.FileIndex.length;++X)if(de=T.FileIndex[X],de.size>0&&de.size<4096)if(rt&&Buffer.isBuffer(de.content))de.content.copy(V,V.l,0,de.size),V.l+=de.size+63&-64;else{for(ie=0;ie<de.size;++ie)V.write_shift(1,de.content[ie]);for(;ie&63;++ie)V.write_shift(1,0)}if(rt)V.l=V.length;else for(;V.l<V.length;)V.write_shift(1,0);return V}function K(T,z){var R=T.FullPaths.map(function(ie){return ie.toUpperCase()}),L=R.map(function(ie){var ce=ie.split("/");return ce[ce.length-(ie.slice(-1)=="/"?2:1)]}),V=!1;z.charCodeAt(0)===47?(V=!0,z=R[0].slice(0,-1)+z):V=z.indexOf("/")!==-1;var X=z.toUpperCase(),le=V===!0?R.indexOf(X):L.indexOf(X);if(le!==-1)return T.FileIndex[le];var ge=!X.match(Vi);for(X=X.replace(Lr,""),ge&&(X=X.replace(Vi,"!")),le=0;le<R.length;++le)if((ge?R[le].replace(Vi,"!"):R[le]).replace(Lr,"")==X||(ge?L[le].replace(Vi,"!"):L[le]).replace(Lr,"")==X)return T.FileIndex[le];return null}var C=64,Y=-2,B="d0cf11e0a1b11ae1",ee=[208,207,17,224,161,177,26,225],re="00000000000000000000000000000000",Q={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:Y,FREESECT:-1,HEADER_SIGNATURE:B,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:re,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function te(T,z,R){u();var L=D(T,R);o.writeFileSync(z,L)}function H(T){for(var z=new Array(T.length),R=0;R<T.length;++R)z[R]=String.fromCharCode(T[R]);return z.join("")}function ae(T,z){var R=D(T,z);switch(z&&z.type||"buffer"){case"file":return u(),o.writeFileSync(z.filename,R),R;case"binary":return typeof R=="string"?R:H(R);case"base64":return Fl(typeof R=="string"?R:H(R));case"buffer":if(rt)return Buffer.isBuffer(R)?R:ba(R);case"array":return typeof R=="string"?rn(R):R}return R}var he;function O(T){try{var z=T.InflateRaw,R=new z;if(R._processChunk(new Uint8Array([3,0]),R._finishFlushFlag),R.bytesRead)he=T;else throw new Error("zlib does not expose bytesRead")}catch(L){console.error("cannot use native zlib: "+(L.message||L))}}function I(T,z){if(!he)return yr(T,z);var R=he.InflateRaw,L=new R,V=L._processChunk(T.slice(T.l),L._finishFlushFlag);return T.l+=L.bytesRead,V}function g(T){return he?he.deflateRawSync(T):Xe(T)}var _=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],A=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ne=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ue(T){var z=(T<<1|T<<11)&139536|(T<<5|T<<15)&558144;return(z>>16|z>>8|z)&255}for(var ve=typeof Uint8Array<"u",xe=ve?new Uint8Array(256):[],W=0;W<256;++W)xe[W]=ue(W);function E(T,z){var R=xe[T&255];return z<=8?R>>>8-z:(R=R<<8|xe[T>>8&255],z<=16?R>>>16-z:(R=R<<8|xe[T>>16&255],R>>>24-z))}function ke(T,z){var R=z&7,L=z>>>3;return(T[L]|(R<=6?0:T[L+1]<<8))>>>R&3}function pe(T,z){var R=z&7,L=z>>>3;return(T[L]|(R<=5?0:T[L+1]<<8))>>>R&7}function Ue(T,z){var R=z&7,L=z>>>3;return(T[L]|(R<=4?0:T[L+1]<<8))>>>R&15}function Ne(T,z){var R=z&7,L=z>>>3;return(T[L]|(R<=3?0:T[L+1]<<8))>>>R&31}function me(T,z){var R=z&7,L=z>>>3;return(T[L]|(R<=1?0:T[L+1]<<8))>>>R&127}function oe(T,z,R){var L=z&7,V=z>>>3,X=(1<<R)-1,le=T[V]>>>L;return R<8-L||(le|=T[V+1]<<8-L,R<16-L)||(le|=T[V+2]<<16-L,R<24-L)||(le|=T[V+3]<<24-L),le&X}function Ie(T,z,R){var L=z&7,V=z>>>3;return L<=5?T[V]|=(R&7)<<L:(T[V]|=R<<L&255,T[V+1]=(R&7)>>8-L),z+3}function Re(T,z,R){var L=z&7,V=z>>>3;return R=(R&1)<<L,T[V]|=R,z+1}function Me(T,z,R){var L=z&7,V=z>>>3;return R<<=L,T[V]|=R&255,R>>>=8,T[V+1]=R,z+8}function Oe(T,z,R){var L=z&7,V=z>>>3;return R<<=L,T[V]|=R&255,R>>>=8,T[V+1]=R&255,T[V+2]=R>>>8,z+16}function He(T,z){var R=T.length,L=2*R>z?2*R:z+5,V=0;if(R>=z)return T;if(rt){var X=qx(L);if(T.copy)T.copy(X);else for(;V<T.length;++V)X[V]=T[V];return X}else if(ve){var le=new Uint8Array(L);if(le.set)le.set(T);else for(;V<R;++V)le[V]=T[V];return le}return T.length=L,T}function Z(T){for(var z=new Array(T),R=0;R<T;++R)z[R]=0;return z}function Be(T,z,R){var L=1,V=0,X=0,le=0,ge=0,ie=T.length,ce=ve?new Uint16Array(32):Z(32);for(X=0;X<32;++X)ce[X]=0;for(X=ie;X<R;++X)T[X]=0;ie=T.length;var de=ve?new Uint16Array(ie):Z(ie);for(X=0;X<ie;++X)ce[V=T[X]]++,L<V&&(L=V),de[X]=0;for(ce[0]=0,X=1;X<=L;++X)ce[X+16]=ge=ge+ce[X-1]<<1;for(X=0;X<ie;++X)ge=T[X],ge!=0&&(de[X]=ce[ge+16]++);var Se=0;for(X=0;X<ie;++X)if(Se=T[X],Se!=0)for(ge=E(de[X],L)>>L-Se,le=(1<<L+4-Se)-1;le>=0;--le)z[ge|le<<Se]=Se&15|X<<4;return L}var ze=ve?new Uint16Array(512):Z(512),nt=ve?new Uint16Array(32):Z(32);if(!ve){for(var Qe=0;Qe<512;++Qe)ze[Qe]=0;for(Qe=0;Qe<32;++Qe)nt[Qe]=0}(function(){for(var T=[],z=0;z<32;z++)T.push(5);Be(T,nt,32);var R=[];for(z=0;z<=143;z++)R.push(8);for(;z<=255;z++)R.push(9);for(;z<=279;z++)R.push(7);for(;z<=287;z++)R.push(8);Be(R,ze,288)})();var Dt=function(){for(var z=ve?new Uint8Array(32768):[],R=0,L=0;R<ne.length-1;++R)for(;L<ne[R+1];++L)z[L]=R;for(;L<32768;++L)z[L]=29;var V=ve?new Uint8Array(259):[];for(R=0,L=0;R<A.length-1;++R)for(;L<A[R+1];++L)V[L]=R;function X(ge,ie){for(var ce=0;ce<ge.length;){var de=Math.min(65535,ge.length-ce),Se=ce+de==ge.length;for(ie.write_shift(1,+Se),ie.write_shift(2,de),ie.write_shift(2,~de&65535);de-- >0;)ie[ie.l++]=ge[ce++]}return ie.l}function le(ge,ie){for(var ce=0,de=0,Se=ve?new Uint16Array(32768):[];de<ge.length;){var Ee=Math.min(65535,ge.length-de);if(Ee<10){for(ce=Ie(ie,ce,+(de+Ee==ge.length)),ce&7&&(ce+=8-(ce&7)),ie.l=ce/8|0,ie.write_shift(2,Ee),ie.write_shift(2,~Ee&65535);Ee-- >0;)ie[ie.l++]=ge[de++];ce=ie.l*8;continue}ce=Ie(ie,ce,+(de+Ee==ge.length)+2);for(var U=0;Ee-- >0;){var q=ge[de];U=(U<<5^q)&32767;var J=-1,fe=0;if((J=Se[U])&&(J|=de&-32768,J>de&&(J-=32768),J<de))for(;ge[J+fe]==ge[de+fe]&&fe<250;)++fe;if(fe>2){q=V[fe],q<=22?ce=Me(ie,ce,xe[q+1]>>1)-1:(Me(ie,ce,3),ce+=5,Me(ie,ce,xe[q-23]>>5),ce+=3);var be=q<8?0:q-4>>2;be>0&&(Oe(ie,ce,fe-A[q]),ce+=be),q=z[de-J],ce=Me(ie,ce,xe[q]>>3),ce-=3;var Le=q<4?0:q-2>>1;Le>0&&(Oe(ie,ce,de-J-ne[q]),ce+=Le);for(var G=0;G<fe;++G)Se[U]=de&32767,U=(U<<5^ge[de])&32767,++de;Ee-=fe-1}else q<=143?q=q+48:ce=Re(ie,ce,1),ce=Me(ie,ce,xe[q]),Se[U]=de&32767,++de}ce=Me(ie,ce,0)-1}return ie.l=(ce+7)/8|0,ie.l}return function(ie,ce){return ie.length<8?X(ie,ce):le(ie,ce)}}();function Xe(T){var z=ye(50+Math.floor(T.length*1.1)),R=Dt(T,z);return z.slice(0,R)}var at=ve?new Uint16Array(32768):Z(32768),se=ve?new Uint16Array(32768):Z(32768),Ce=ve?new Uint16Array(128):Z(128),Je=1,Bt=1;function rr(T,z){var R=Ne(T,z)+257;z+=5;var L=Ne(T,z)+1;z+=5;var V=Ue(T,z)+4;z+=4;for(var X=0,le=ve?new Uint8Array(19):Z(19),ge=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ie=1,ce=ve?new Uint8Array(8):Z(8),de=ve?new Uint8Array(8):Z(8),Se=le.length,Ee=0;Ee<V;++Ee)le[_[Ee]]=X=pe(T,z),ie<X&&(ie=X),ce[X]++,z+=3;var U=0;for(ce[0]=0,Ee=1;Ee<=ie;++Ee)de[Ee]=U=U+ce[Ee-1]<<1;for(Ee=0;Ee<Se;++Ee)(U=le[Ee])!=0&&(ge[Ee]=de[U]++);var q=0;for(Ee=0;Ee<Se;++Ee)if(q=le[Ee],q!=0){U=xe[ge[Ee]]>>8-q;for(var J=(1<<7-q)-1;J>=0;--J)Ce[U|J<<q]=q&7|Ee<<3}var fe=[];for(ie=1;fe.length<R+L;)switch(U=Ce[me(T,z)],z+=U&7,U>>>=3){case 16:for(X=3+ke(T,z),z+=2,U=fe[fe.length-1];X-- >0;)fe.push(U);break;case 17:for(X=3+pe(T,z),z+=3;X-- >0;)fe.push(0);break;case 18:for(X=11+me(T,z),z+=7;X-- >0;)fe.push(0);break;default:fe.push(U),ie<U&&(ie=U);break}var be=fe.slice(0,R),Le=fe.slice(R);for(Ee=R;Ee<286;++Ee)be[Ee]=0;for(Ee=L;Ee<30;++Ee)Le[Ee]=0;return Je=Be(be,at,286),Bt=Be(Le,se,30),z}function dr(T,z){if(T[0]==3&&!(T[1]&3))return[Ya(z),2];for(var R=0,L=0,V=qx(z||1<<18),X=0,le=V.length>>>0,ge=0,ie=0;!(L&1);){if(L=pe(T,R),R+=3,L>>>1)L>>1==1?(ge=9,ie=5):(R=rr(T,R),ge=Je,ie=Bt);else{R&7&&(R+=8-(R&7));var ce=T[R>>>3]|T[(R>>>3)+1]<<8;if(R+=32,ce>0)for(!z&&le<X+ce&&(V=He(V,X+ce),le=V.length);ce-- >0;)V[X++]=T[R>>>3],R+=8;continue}for(;;){!z&&le<X+32767&&(V=He(V,X+32767),le=V.length);var de=oe(T,R,ge),Se=L>>>1==1?ze[de]:at[de];if(R+=Se&15,Se>>>=4,!(Se>>>8&255))V[X++]=Se;else{if(Se==256)break;Se-=257;var Ee=Se<8?0:Se-4>>2;Ee>5&&(Ee=0);var U=X+A[Se];Ee>0&&(U+=oe(T,R,Ee),R+=Ee),de=oe(T,R,ie),Se=L>>>1==1?nt[de]:se[de],R+=Se&15,Se>>>=4;var q=Se<4?0:Se-2>>1,J=ne[Se];for(q>0&&(J+=oe(T,R,q),R+=q),!z&&le<U&&(V=He(V,U+100),le=V.length);X<U;)V[X]=V[X-J],++X}}}return z?[V,R+7>>>3]:[V.slice(0,X),R+7>>>3]}function yr(T,z){var R=T.slice(T.l||0),L=dr(R,z);return T.l+=L[1],L[0]}function jt(T,z){if(T)typeof console<"u"&&console.error(z);else throw new Error(z)}function zr(T,z){var R=T;hr(R,0);var L=[],V=[],X={FileIndex:L,FullPaths:V};k(X,{root:z.root});for(var le=R.length-4;(R[le]!=80||R[le+1]!=75||R[le+2]!=5||R[le+3]!=6)&&le>=0;)--le;R.l=le+4,R.l+=4;var ge=R.read_shift(2);R.l+=6;var ie=R.read_shift(4);for(R.l=ie,le=0;le<ge;++le){R.l+=20;var ce=R.read_shift(4),de=R.read_shift(4),Se=R.read_shift(2),Ee=R.read_shift(2),U=R.read_shift(2);R.l+=8;var q=R.read_shift(4),J=c(R.slice(R.l+Se,R.l+Se+Ee));R.l+=Se+Ee+U;var fe=R.l;R.l=q+4,nr(R,ce,de,X,J),R.l=fe}return X}function nr(T,z,R,L,V){T.l+=2;var X=T.read_shift(2),le=T.read_shift(2),ge=l(T);if(X&8257)throw new Error("Unsupported ZIP encryption");for(var ie=T.read_shift(4),ce=T.read_shift(4),de=T.read_shift(4),Se=T.read_shift(2),Ee=T.read_shift(2),U="",q=0;q<Se;++q)U+=String.fromCharCode(T[T.l++]);if(Ee){var J=c(T.slice(T.l,T.l+Ee));(J[21589]||{}).mt&&(ge=J[21589].mt),((V||{})[21589]||{}).mt&&(ge=V[21589].mt)}T.l+=Ee;var fe=T.slice(T.l,T.l+ce);switch(le){case 8:fe=I(T,de);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+le)}var be=!1;X&8&&(ie=T.read_shift(4),ie==134695760&&(ie=T.read_shift(4),be=!0),ce=T.read_shift(4),de=T.read_shift(4)),ce!=z&&jt(be,"Bad compressed size: "+z+" != "+ce),de!=R&&jt(be,"Bad uncompressed size: "+R+" != "+de),ar(L,U,fe,{unsafe:!0,mt:ge})}function Pr(T,z){var R=z||{},L=[],V=[],X=ye(1),le=R.compression?8:0,ge=0,ie=0,ce=0,de=0,Se=0,Ee=T.FullPaths[0],U=Ee,q=T.FileIndex[0],J=[],fe=0;for(ie=1;ie<T.FullPaths.length;++ie)if(U=T.FullPaths[ie].slice(Ee.length),q=T.FileIndex[ie],!(!q.size||!q.content||U=="Sh33tJ5")){var be=de,Le=ye(U.length);for(ce=0;ce<U.length;++ce)Le.write_shift(1,U.charCodeAt(ce)&127);Le=Le.slice(0,Le.l),J[Se]=xw.buf(q.content,0);var G=q.content;le==8&&(G=g(G)),X=ye(30),X.write_shift(4,67324752),X.write_shift(2,20),X.write_shift(2,ge),X.write_shift(2,le),q.mt?i(X,q.mt):X.write_shift(4,0),X.write_shift(-4,J[Se]),X.write_shift(4,G.length),X.write_shift(4,q.content.length),X.write_shift(2,Le.length),X.write_shift(2,0),de+=X.length,L.push(X),de+=Le.length,L.push(Le),de+=G.length,L.push(G),X=ye(46),X.write_shift(4,33639248),X.write_shift(2,0),X.write_shift(2,20),X.write_shift(2,ge),X.write_shift(2,le),X.write_shift(4,0),X.write_shift(-4,J[Se]),X.write_shift(4,G.length),X.write_shift(4,q.content.length),X.write_shift(2,Le.length),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(4,0),X.write_shift(4,be),fe+=X.l,V.push(X),fe+=Le.length,V.push(Le),++Se}return X=ye(22),X.write_shift(4,101010256),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(2,Se),X.write_shift(2,Se),X.write_shift(4,fe),X.write_shift(4,de),X.write_shift(2,0),lr([lr(L),lr(V),X])}var ur={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function ja(T,z){if(T.ctype)return T.ctype;var R=T.name||"",L=R.match(/\.([^\.]+)$/);return L&&ur[L[1]]||z&&(L=(R=z).match(/[\.\\]([^\.\\])+$/),L&&ur[L[1]])?ur[L[1]]:"application/octet-stream"}function ka(T){for(var z=Fl(T),R=[],L=0;L<z.length;L+=76)R.push(z.slice(L,L+76));return R.join(`\r
`)+`\r
`}function Cn(T){var z=T.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ce){var de=ce.charCodeAt(0).toString(16).toUpperCase();return"="+(de.length==1?"0"+de:de)});z=z.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),z.charAt(0)==`
`&&(z="=0D"+z.slice(1)),z=z.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var R=[],L=z.split(`\r
`),V=0;V<L.length;++V){var X=L[V];if(X.length==0){R.push("");continue}for(var le=0;le<X.length;){var ge=76,ie=X.slice(le,le+ge);ie.charAt(ge-1)=="="?ge--:ie.charAt(ge-2)=="="?ge-=2:ie.charAt(ge-3)=="="&&(ge-=3),ie=X.slice(le,le+ge),le+=ge,le<X.length&&(ie+="="),R.push(ie)}}return R.join(`\r
`)}function un(T){for(var z=[],R=0;R<T.length;++R){for(var L=T[R];R<=T.length&&L.charAt(L.length-1)=="=";)L=L.slice(0,L.length-1)+T[++R];z.push(L)}for(var V=0;V<z.length;++V)z[V]=z[V].replace(/[=][0-9A-Fa-f]{2}/g,function(X){return String.fromCharCode(parseInt(X.slice(1),16))});return rn(z.join(`\r
`))}function ra(T,z,R){for(var L="",V="",X="",le,ge=0;ge<10;++ge){var ie=z[ge];if(!ie||ie.match(/^\s*$/))break;var ce=ie.match(/^(.*?):\s*([^\s].*)$/);if(ce)switch(ce[1].toLowerCase()){case"content-location":L=ce[2].trim();break;case"content-type":X=ce[2].trim();break;case"content-transfer-encoding":V=ce[2].trim();break}}switch(++ge,V.toLowerCase()){case"base64":le=rn(cn(z.slice(ge).join("")));break;case"quoted-printable":le=un(z.slice(ge));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+V)}var de=ar(T,L.slice(R.length),le,{unsafe:!0});X&&(de.ctype=X)}function En(T,z){if(H(T.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var R=z&&z.root||"",L=(rt&&Buffer.isBuffer(T)?T.toString("binary"):H(T)).split(`\r
`),V=0,X="";for(V=0;V<L.length;++V)if(X=L[V],!!/^Content-Location:/i.test(X)&&(X=X.slice(X.indexOf("file")),R||(R=X.slice(0,X.lastIndexOf("/")+1)),X.slice(0,R.length)!=R))for(;R.length>0&&(R=R.slice(0,R.length-1),R=R.slice(0,R.lastIndexOf("/")+1),X.slice(0,R.length)!=R););var le=(L[1]||"").match(/boundary="(.*?)"/);if(!le)throw new Error("MAD cannot find boundary");var ge="--"+(le[1]||""),ie=[],ce=[],de={FileIndex:ie,FullPaths:ce};k(de);var Se,Ee=0;for(V=0;V<L.length;++V){var U=L[V];U!==ge&&U!==ge+"--"||(Ee++&&ra(de,L.slice(Se,V),R),Se=V)}return de}function Tn(T,z){var R=z||{},L=R.boundary||"SheetJS";L="------="+L;for(var V=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+L.slice(2)+'"',"","",""],X=T.FullPaths[0],le=X,ge=T.FileIndex[0],ie=1;ie<T.FullPaths.length;++ie)if(le=T.FullPaths[ie].slice(X.length),ge=T.FileIndex[ie],!(!ge.size||!ge.content||le=="Sh33tJ5")){le=le.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(fe){return"_x"+fe.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(fe){return"_u"+fe.charCodeAt(0).toString(16)+"_"});for(var ce=ge.content,de=rt&&Buffer.isBuffer(ce)?ce.toString("binary"):H(ce),Se=0,Ee=Math.min(1024,de.length),U=0,q=0;q<=Ee;++q)(U=de.charCodeAt(q))>=32&&U<128&&++Se;var J=Se>=Ee*4/5;V.push(L),V.push("Content-Location: "+(R.root||"file:///C:/SheetJS/")+le),V.push("Content-Transfer-Encoding: "+(J?"quoted-printable":"base64")),V.push("Content-Type: "+ja(ge,le)),V.push(""),V.push(J?Cn(de):ka(de))}return V.push(L+`--\r
`),V.join(`\r
`)}function na(T){var z={};return k(z,T),z}function ar(T,z,R,L){var V=L&&L.unsafe;V||k(T);var X=!V&&$e.find(T,z);if(!X){var le=T.FullPaths[0];z.slice(0,le.length)==le?le=z:(le.slice(-1)!="/"&&(le+="/"),le=(le+z).replace("//","/")),X={name:s(z),type:2},T.FileIndex.push(X),T.FullPaths.push(le),V||$e.utils.cfb_gc(T)}return X.content=R,X.size=R?R.length:0,L&&(L.CLSID&&(X.clsid=L.CLSID),L.mt&&(X.mt=L.mt),L.ct&&(X.ct=L.ct)),X}function _a(T,z){k(T);var R=$e.find(T,z);if(R){for(var L=0;L<T.FileIndex.length;++L)if(T.FileIndex[L]==R)return T.FileIndex.splice(L,1),T.FullPaths.splice(L,1),!0}return!1}function Qr(T,z,R){k(T);var L=$e.find(T,z);if(L){for(var V=0;V<T.FileIndex.length;++V)if(T.FileIndex[V]==L)return T.FileIndex[V].name=s(R),T.FullPaths[V]=R,!0}return!1}function bt(T){P(T,!0)}return t.find=K,t.read=j,t.parse=d,t.write=ae,t.writeFile=te,t.utils={cfb_new:na,cfb_add:ar,cfb_del:_a,cfb_mov:Qr,cfb_gc:bt,ReadShift:rl,CheckField:tg,prep_blob:hr,bconcat:lr,use_zlib:O,_deflateRaw:Xe,_inflateRaw:yr,consts:Q},t}();function mw(e){return typeof e=="string"?Go(e):Array.isArray(e)?Ub(e):e}function Kl(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=Go(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var a=r=="utf8"?qn(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(a,e);if(typeof Blob<"u"){var s=new Blob([mw(a)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(s,e);if(typeof saveAs<"u")return saveAs(s,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(s);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:e,saveAs:!0});var l=document.createElement("a");if(l.download!=null)return l.download=e,l.href=i,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var c=File(e);return c.open("w"),c.encoding="binary",Array.isArray(t)&&(t=rs(t)),c.write(t),c.close(),t}catch(o){if(!o.message||!o.message.match(/onstruct/))throw o}throw new Error("cannot save file "+e)}function hw(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(a){if(!a.message||!a.message.match(/onstruct/))throw a}throw new Error("Cannot access file "+e)}function Ht(e){for(var t=Object.keys(e),r=[],a=0;a<t.length;++a)Object.prototype.hasOwnProperty.call(e,t[a])&&r.push(t[a]);return r}function am(e,t){for(var r=[],a=Ht(e),s=0;s!==a.length;++s)r[e[a[s]][t]]==null&&(r[e[a[s]][t]]=a[s]);return r}function Ko(e){for(var t=[],r=Ht(e),a=0;a!==r.length;++a)t[e[r[a]]]=r[a];return t}function Yo(e){for(var t=[],r=Ht(e),a=0;a!==r.length;++a)t[e[r[a]]]=parseInt(r[a],10);return t}function pw(e){for(var t=[],r=Ht(e),a=0;a!==r.length;++a)t[e[r[a]]]==null&&(t[e[r[a]]]=[]),t[e[r[a]]].push(r[a]);return t}var wo=new Date(1899,11,30,0,0,0);function tr(e,t){var r=e.getTime(),a=wo.getTime()+(e.getTimezoneOffset()-wo.getTimezoneOffset())*6e4;return(r-a)/(24*60*60*1e3)}var I1=new Date,gw=wo.getTime()+(I1.getTimezoneOffset()-wo.getTimezoneOffset())*6e4,sm=I1.getTimezoneOffset();function qo(e){var t=new Date;return t.setTime(e*24*60*60*1e3+gw),t.getTimezoneOffset()!==sm&&t.setTime(t.getTime()+(t.getTimezoneOffset()-sm)*6e4),t}function vw(e){var t=0,r=0,a=!1,s=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var i=1;i!=s.length;++i)if(s[i]){switch(r=1,i>3&&(a=!0),s[i].slice(s[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[i].slice(s[i].length-1));case"D":r*=24;case"H":r*=60;case"M":if(a)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(s[i],10)}return t}var im=new Date("2017-02-19T19:06:09.000Z"),M1=isNaN(im.getFullYear())?new Date("2/19/17"):im,yw=M1.getFullYear()==2017;function Tt(e,t){var r=new Date(e);if(yw)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(M1.getFullYear()==1917&&!isNaN(r.getFullYear())){var a=r.getFullYear();return e.indexOf(""+a)>-1||r.setFullYear(r.getFullYear()+100),r}var s=e.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return e.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function _s(e,t){if(rt&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return qn(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return qn(N1(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return qn(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return qn(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(i){return r[i]||i})}catch{}for(var a=[],s=0;s!=e.length;++s)a.push(String.fromCharCode(e[s]));return a.join("")}function Ft(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Ft(e[r]));return t}function zt(e,t){for(var r="";r.length<t;)r+=e;return r}function Un(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,a=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(a))||(a=a.replace(/[(](.*)[)]/,function(s,i){return r=-r,i}),!isNaN(t=Number(a)))?t/r:t}var bw=["january","february","march","april","may","june","july","august","september","october","november","december"];function bi(e){var t=new Date(e),r=new Date(NaN),a=t.getYear(),s=t.getMonth(),i=t.getDate();if(isNaN(i))return r;var l=e.toLowerCase();if(l.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(l=l.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),l.length>3&&bw.indexOf(l)==-1)return r}else if(l.match(/[a-z]/))return r;return a<0||a>8099?r:(s>0||i>1)&&a!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var ww=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,a,s){if(e||typeof a=="string")return r.split(a);for(var i=r.split(a),l=[i[0]],c=1;c<i.length;++c)l.push(s),l.push(i[c]);return l}}();function R1(e){return e?e.content&&e.type?_s(e.content,!0):e.data?$i(e.data):e.asNodeBuffer&&rt?$i(e.asNodeBuffer().toString("binary")):e.asBinary?$i(e.asBinary()):e._data&&e._data.getContent?$i(_s(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function O1(e){if(!e)return null;if(e.data)return Kx(e.data);if(e.asNodeBuffer&&rt)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?Kx(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function Nw(e){return e&&e.name.slice(-4)===".bin"?O1(e):R1(e)}function pn(e,t){for(var r=e.FullPaths||Ht(e.files),a=t.toLowerCase().replace(/[\/]/g,"\\"),s=a.replace(/\\/g,"/"),i=0;i<r.length;++i){var l=r[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(a==l||s==l)return e.files?e.files[r[i]]:e.FileIndex[i]}return null}function Qu(e,t){var r=pn(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function Yt(e,t,r){if(!r)return Nw(Qu(e,t));if(!t)return null;try{return Yt(e,t)}catch{return null}}function nn(e,t,r){if(!r)return R1(Qu(e,t));if(!t)return null;try{return nn(e,t)}catch{return null}}function jw(e,t,r){return O1(Qu(e,t))}function lm(e){for(var t=e.FullPaths||Ht(e.files),r=[],a=0;a<t.length;++a)t[a].slice(-1)!="/"&&r.push(t[a].replace(/^Root Entry[\/]/,""));return r.sort()}function tt(e,t,r){if(e.FullPaths){if(typeof r=="string"){var a;return rt?a=ba(r):a=zb(r),$e.utils.cfb_add(e,t,a)}$e.utils.cfb_add(e,t,r)}else e.file(t,r)}function Zu(){return $e.utils.cfb_new()}function L1(e,t){switch(t.type){case"base64":return $e.read(e,{type:"base64"});case"binary":return $e.read(e,{type:"binary"});case"buffer":case"array":return $e.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function Gi(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var a=e.split("/");a.length!==0;){var s=a.shift();s===".."?r.pop():s!=="."&&r.push(s)}return r.join("/")}var Xt=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,kw=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,cm=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,_w=/<[^>]*>/g,Ar=Xt.match(cm)?cm:_w,Sw=/<\w*:/,Cw=/<(\/?)\w+:/;function Ye(e,t,r){for(var a={},s=0,i=0;s!==e.length&&!((i=e.charCodeAt(s))===32||i===10||i===13);++s);if(t||(a[0]=e.slice(0,s)),s===e.length)return a;var l=e.match(kw),c=0,o="",u=0,d="",f="",x=1;if(l)for(u=0;u!=l.length;++u){for(f=l[u],i=0;i!=f.length&&f.charCodeAt(i)!==61;++i);for(d=f.slice(0,i).trim();f.charCodeAt(i+1)==32;)++i;for(x=(s=f.charCodeAt(i+1))==34||s==39?1:0,o=f.slice(i+1+x,f.length-x),c=0;c!=d.length&&d.charCodeAt(c)!==58;++c);if(c===d.length)d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),a[d]=o,a[d.toLowerCase()]=o;else{var h=(c===5&&d.slice(0,5)==="xmlns"?"xmlns":"")+d.slice(c+1);if(a[h]&&d.slice(c-3,c)=="ext")continue;a[h]=o,a[h.toLowerCase()]=o}}return a}function ea(e){return e.replace(Cw,"<$1")}var B1={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},ef=Ko(B1),dt=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(a){var s=a+"",i=s.indexOf("<![CDATA[");if(i==-1)return s.replace(e,function(c,o){return B1[c]||String.fromCharCode(parseInt(o,c.indexOf("x")>-1?16:10))||c}).replace(t,function(c,o){return String.fromCharCode(parseInt(o,16))});var l=s.indexOf("]]>");return r(s.slice(0,i))+s.slice(i+9,l)+r(s.slice(l+3))}}(),tf=/[&<>'"]/g,Ew=/[\u0000-\u0008\u000b-\u001f]/g;function pt(e){var t=e+"";return t.replace(tf,function(r){return ef[r]}).replace(Ew,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function om(e){return pt(e).replace(/ /g,"_x0020_")}var U1=/[\u0000-\u001f]/g;function rf(e){var t=e+"";return t.replace(tf,function(r){return ef[r]}).replace(/\n/g,"<br/>").replace(U1,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function Tw(e){var t=e+"";return t.replace(tf,function(r){return ef[r]}).replace(U1,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var dm=function(){var e=/&#(\d+);/g;function t(r,a){return String.fromCharCode(parseInt(a,10))}return function(a){return a.replace(e,t)}}();function Fw(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function _t(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function T0(e){for(var t="",r=0,a=0,s=0,i=0,l=0,c=0;r<e.length;){if(a=e.charCodeAt(r++),a<128){t+=String.fromCharCode(a);continue}if(s=e.charCodeAt(r++),a>191&&a<224){l=(a&31)<<6,l|=s&63,t+=String.fromCharCode(l);continue}if(i=e.charCodeAt(r++),a<240){t+=String.fromCharCode((a&15)<<12|(s&63)<<6|i&63);continue}l=e.charCodeAt(r++),c=((a&7)<<18|(s&63)<<12|(i&63)<<6|l&63)-65536,t+=String.fromCharCode(55296+(c>>>10&1023)),t+=String.fromCharCode(56320+(c&1023))}return t}function um(e){var t=Ya(2*e.length),r,a,s=1,i=0,l=0,c;for(a=0;a<e.length;a+=s)s=1,(c=e.charCodeAt(a))<128?r=c:c<224?(r=(c&31)*64+(e.charCodeAt(a+1)&63),s=2):c<240?(r=(c&15)*4096+(e.charCodeAt(a+1)&63)*64+(e.charCodeAt(a+2)&63),s=3):(s=4,r=(c&7)*262144+(e.charCodeAt(a+1)&63)*4096+(e.charCodeAt(a+2)&63)*64+(e.charCodeAt(a+3)&63),r-=65536,l=55296+(r>>>10&1023),r=56320+(r&1023)),l!==0&&(t[i++]=l&255,t[i++]=l>>>8,l=0),t[i++]=r%256,t[i++]=r>>>8;return t.slice(0,i).toString("ucs2")}function fm(e){return ba(e,"binary").toString("utf8")}var bc="foo bar bazâð£",vt=rt&&(fm(bc)==T0(bc)&&fm||um(bc)==T0(bc)&&um)||T0,qn=rt?function(e){return ba(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,a=0,s=0;r<e.length;)switch(a=e.charCodeAt(r++),!0){case a<128:t.push(String.fromCharCode(a));break;case a<2048:t.push(String.fromCharCode(192+(a>>6))),t.push(String.fromCharCode(128+(a&63)));break;case(a>=55296&&a<57344):a-=55296,s=e.charCodeAt(r++)-56320+(a<<10),t.push(String.fromCharCode(240+(s>>18&7))),t.push(String.fromCharCode(144+(s>>12&63))),t.push(String.fromCharCode(128+(s>>6&63))),t.push(String.fromCharCode(128+(s&63)));break;default:t.push(String.fromCharCode(224+(a>>12))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)))}return t.join("")},Pl=function(){var e={};return function(r,a){var s=r+"|"+(a||"");return e[s]?e[s]:e[s]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",a||"")}}(),z1=function(){var e=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var a=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<e.length;++s)a=a.replace(e[s][0],e[s][1]);return a}}(),Aw=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),Pw=/<\/?(?:vt:)?variant>/g,Dw=/<(?:vt:)([^>]*)>([\s\S]*)</;function xm(e,t){var r=Ye(e),a=e.match(Aw(r.baseType))||[],s=[];if(a.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+a.length+" != "+r.size);return s}return a.forEach(function(i){var l=i.replace(Pw,"").match(Dw);l&&s.push({v:vt(l[2]),t:l[1]})}),s}var W1=/(^\s|\s$|\n)/;function pr(e,t){return"<"+e+(t.match(W1)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function Dl(e){return Ht(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Ae(e,t,r){return"<"+e+(r!=null?Dl(r):"")+(t!=null?(t.match(W1)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Od(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function Iw(e,t){switch(typeof e){case"string":var r=Ae("vt:lpwstr",pt(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Ae((e|0)==e?"vt:i4":"vt:r8",pt(String(e)));case"boolean":return Ae("vt:bool",e?"true":"false")}if(e instanceof Date)return Ae("vt:filetime",Od(e));throw new Error("Unable to serialize "+e)}function nf(e){if(rt&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return vt(rs(Yu(e)));throw new Error("Bad input format: expected Buffer or string")}var Il=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Zt={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Ps=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],en={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function Mw(e,t){for(var r=1-2*(e[t+7]>>>7),a=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),s=e[t+6]&15,i=5;i>=0;--i)s=s*256+e[t+i];return a==2047?s==0?r*(1/0):NaN:(a==0?a=-1022:(a-=1023,s+=Math.pow(2,52)),r*Math.pow(2,a-52)*s)}function Rw(e,t,r){var a=(t<0||1/t==-1/0?1:0)<<7,s=0,i=0,l=a?-t:t;isFinite(l)?l==0?s=i=0:(s=Math.floor(Math.log(l)/Math.LN2),i=l*Math.pow(2,52-s),s<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?s=-1022:(i-=Math.pow(2,52),s+=1023)):(s=2047,i=isNaN(t)?26985:0);for(var c=0;c<=5;++c,i/=256)e[r+c]=i&255;e[r+6]=(s&15)<<4|i&15,e[r+7]=s>>4|a}var mm=function(e){for(var t=[],r=10240,a=0;a<e[0].length;++a)if(e[0][a])for(var s=0,i=e[0][a].length;s<i;s+=r)t.push.apply(t,e[0][a].slice(s,s+r));return t},hm=rt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:ba(t)})):mm(e)}:mm,pm=function(e,t,r){for(var a=[],s=t;s<r;s+=2)a.push(String.fromCharCode(oa(e,s)));return a.join("").replace(Lr,"")},af=rt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Lr,""):pm(e,t,r)}:pm,gm=function(e,t,r){for(var a=[],s=t;s<t+r;++s)a.push(("0"+e[s].toString(16)).slice(-2));return a.join("")},H1=rt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):gm(e,t,r)}:gm,vm=function(e,t,r){for(var a=[],s=t;s<r;s++)a.push(String.fromCharCode(Ws(e,s)));return a.join("")},Yl=rt?function(t,r,a){return Buffer.isBuffer(t)?t.toString("utf8",r,a):vm(t,r,a)}:vm,$1=function(e,t){var r=tn(e,t);return r>0?Yl(e,t+4,t+4+r-1):""},V1=$1,G1=function(e,t){var r=tn(e,t);return r>0?Yl(e,t+4,t+4+r-1):""},X1=G1,K1=function(e,t){var r=2*tn(e,t);return r>0?Yl(e,t+4,t+4+r-1):""},Y1=K1,q1=function(t,r){var a=tn(t,r);return a>0?af(t,r+4,r+4+a):""},J1=q1,Q1=function(e,t){var r=tn(e,t);return r>0?Yl(e,t+4,t+4+r):""},Z1=Q1,eg=function(e,t){return Mw(e,t)},No=eg,sf=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};rt&&(V1=function(t,r){if(!Buffer.isBuffer(t))return $1(t,r);var a=t.readUInt32LE(r);return a>0?t.toString("utf8",r+4,r+4+a-1):""},X1=function(t,r){if(!Buffer.isBuffer(t))return G1(t,r);var a=t.readUInt32LE(r);return a>0?t.toString("utf8",r+4,r+4+a-1):""},Y1=function(t,r){if(!Buffer.isBuffer(t))return K1(t,r);var a=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+a-1)},J1=function(t,r){if(!Buffer.isBuffer(t))return q1(t,r);var a=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+a)},Z1=function(t,r){if(!Buffer.isBuffer(t))return Q1(t,r);var a=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+a)},No=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):eg(t,r)},sf=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Ws=function(e,t){return e[t]},oa=function(e,t){return e[t+1]*256+e[t]},Ow=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},tn=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},ls=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},Lw=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function rl(e,t){var r="",a,s,i=[],l,c,o,u;switch(t){case"dbcs":if(u=this.l,rt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(o=0;o<e;++o)r+=String.fromCharCode(oa(this,u)),u+=2;e*=2;break;case"utf8":r=Yl(this,this.l,this.l+e);break;case"utf16le":e*=2,r=af(this,this.l,this.l+e);break;case"wstr":return rl.call(this,e,"dbcs");case"lpstr-ansi":r=V1(this,this.l),e=4+tn(this,this.l);break;case"lpstr-cp":r=X1(this,this.l),e=4+tn(this,this.l);break;case"lpwstr":r=Y1(this,this.l),e=4+2*tn(this,this.l);break;case"lpp4":e=4+tn(this,this.l),r=J1(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+tn(this,this.l),r=Z1(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(l=Ws(this,this.l+e++))!==0;)i.push(yc(l));r=i.join("");break;case"_wstr":for(e=0,r="";(l=oa(this,this.l+e))!==0;)i.push(yc(l)),e+=2;e+=2,r=i.join("");break;case"dbcs-cont":for(r="",u=this.l,o=0;o<e;++o){if(this.lens&&this.lens.indexOf(u)!==-1)return l=Ws(this,u),this.l=u+1,c=rl.call(this,e-o,l?"dbcs-cont":"sbcs-cont"),i.join("")+c;i.push(yc(oa(this,u))),u+=2}r=i.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",u=this.l,o=0;o!=e;++o){if(this.lens&&this.lens.indexOf(u)!==-1)return l=Ws(this,u),this.l=u+1,c=rl.call(this,e-o,l?"dbcs-cont":"sbcs-cont"),i.join("")+c;i.push(yc(Ws(this,u))),u+=1}r=i.join("");break;default:switch(e){case 1:return a=Ws(this,this.l),this.l++,a;case 2:return a=(t==="i"?Ow:oa)(this,this.l),this.l+=2,a;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(a=(e>0?ls:Lw)(this,this.l),this.l+=4,a):(s=tn(this,this.l),this.l+=4,s);case 8:case-8:if(t==="f")return e==8?s=No(this,this.l):s=No([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;e=8;case 16:r=H1(this,this.l,e);break}}return this.l+=e,r}var Bw=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},Uw=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},zw=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function Ww(e,t,r){var a=0,s=0;if(r==="dbcs"){for(s=0;s!=t.length;++s)zw(this,t.charCodeAt(s),this.l+2*s);a=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=t.length;++s)this[this.l+s]=t.charCodeAt(s)&255;a=t.length}else if(r==="hex"){for(;s<e;++s)this[this.l++]=parseInt(t.slice(2*s,2*s+2),16)||0;return this}else if(r==="utf16le"){var i=Math.min(this.l+e,this.length);for(s=0;s<Math.min(t.length,e);++s){var l=t.charCodeAt(s);this[this.l++]=l&255,this[this.l++]=l>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(e){case 1:a=1,this[this.l]=t&255;break;case 2:a=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:a=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:a=4,Bw(this,t,this.l);break;case 8:if(a=8,r==="f"){Rw(this,t,this.l);break}case 16:break;case-4:a=4,Uw(this,t,this.l);break}return this.l+=a,this}function tg(e,t){var r=H1(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function hr(e,t){e.l=t,e.read_shift=rl,e.chk=tg,e.write_shift=Ww}function Fr(e,t){e.l+=t}function ye(e){var t=Ya(e);return hr(t,0),t}function wa(e,t,r){if(e){var a,s,i;hr(e,e.l||0);for(var l=e.length,c=0,o=0;e.l<l;){c=e.read_shift(1),c&128&&(c=(c&127)+((e.read_shift(1)&127)<<7));var u=Ul[c]||Ul[65535];for(a=e.read_shift(1),i=a&127,s=1;s<4&&a&128;++s)i+=((a=e.read_shift(1))&127)<<7*s;o=e.l+i;var d=u.f&&u.f(e,i,r);if(e.l=o,t(d,u,c))return}}}function qr(){var e=[],t=rt?256:2048,r=function(u){var d=ye(u);return hr(d,0),d},a=r(t),s=function(){a&&(a.length>a.l&&(a=a.slice(0,a.l),a.l=a.length),a.length>0&&e.push(a),a=null)},i=function(u){return a&&u<a.length-a.l?a:(s(),a=r(Math.max(u+1,t)))},l=function(){return s(),lr(e)},c=function(u){s(),a=u,a.l==null&&(a.l=a.length),i(t)};return{next:i,push:c,end:l,_bufs:e}}function _e(e,t,r,a){var s=+t,i;if(!isNaN(s)){a||(a=Ul[s].p||(r||[]).length||0),i=1+(s>=128?1:0)+1,a>=128&&++i,a>=16384&&++i,a>=2097152&&++i;var l=e.next(i);s<=127?l.write_shift(1,s):(l.write_shift(1,(s&127)+128),l.write_shift(1,s>>7));for(var c=0;c!=4;++c)if(a>=128)l.write_shift(1,(a&127)+128),a>>=7;else{l.write_shift(1,a);break}a>0&&sf(r)&&e.push(r)}}function nl(e,t,r){var a=Ft(e);if(t.s?(a.cRel&&(a.c+=t.s.c),a.rRel&&(a.r+=t.s.r)):(a.cRel&&(a.c+=t.c),a.rRel&&(a.r+=t.r)),!r||r.biff<12){for(;a.c>=256;)a.c-=256;for(;a.r>=65536;)a.r-=65536}return a}function ym(e,t,r){var a=Ft(e);return a.s=nl(a.s,t.s,r),a.e=nl(a.e,t.s,r),a}function al(e,t){if(e.cRel&&e.c<0)for(e=Ft(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Ft(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Ke(e);return!e.cRel&&e.cRel!=null&&(r=Vw(r)),!e.rRel&&e.rRel!=null&&(r=Hw(r)),r}function F0(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Mt(e.s.c)+":"+(e.e.cRel?"":"$")+Mt(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Gt(e.s.r)+":"+(e.e.rRel?"":"$")+Gt(e.e.r):al(e.s,t.biff)+":"+al(e.e,t.biff)}function lf(e){return parseInt($w(e),10)-1}function Gt(e){return""+(e+1)}function Hw(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function $w(e){return e.replace(/\$(\d+)$/,"$1")}function cf(e){for(var t=Gw(e),r=0,a=0;a!==t.length;++a)r=26*r+t.charCodeAt(a)-64;return r-1}function Mt(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function Vw(e){return e.replace(/^([A-Z])/,"$$$1")}function Gw(e){return e.replace(/^\$([A-Z])/,"$1")}function Xw(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Rt(e){for(var t=0,r=0,a=0;a<e.length;++a){var s=e.charCodeAt(a);s>=48&&s<=57?t=10*t+(s-48):s>=65&&s<=90&&(r=26*r+(s-64))}return{c:r-1,r:t-1}}function Ke(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Jr(e){var t=e.indexOf(":");return t==-1?{s:Rt(e),e:Rt(e)}:{s:Rt(e.slice(0,t)),e:Rt(e.slice(t+1))}}function et(e,t){return typeof t>"u"||typeof t=="number"?et(e.s,e.e):(typeof e!="string"&&(e=Ke(e)),typeof t!="string"&&(t=Ke(t)),e==t?e:e+":"+t)}function ut(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,a=0,s=0,i=e.length;for(r=0;a<i&&!((s=e.charCodeAt(a)-64)<1||s>26);++a)r=26*r+s;for(t.s.c=--r,r=0;a<i&&!((s=e.charCodeAt(a)-48)<0||s>9);++a)r=10*r+s;if(t.s.r=--r,a===i||s!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++a,r=0;a!=i&&!((s=e.charCodeAt(a)-64)<1||s>26);++a)r=26*r+s;for(t.e.c=--r,r=0;a!=i&&!((s=e.charCodeAt(a)-48)<0||s>9);++a)r=10*r+s;return t.e.r=--r,t}function bm(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=_n(e.z,r?tr(t):t)}catch{}try{return e.w=_n((e.XF||{}).numFmtId||(r?14:0),r?tr(t):t)}catch{return""+t}}function va(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?Na[e.v]||e.v:t==null?bm(e,e.v):bm(e,t))}function ns(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",a={};return a[r]=e,{SheetNames:[r],Sheets:a}}function rg(e,t,r){var a=r||{},s=e?Array.isArray(e):a.dense,i=e||(s?[]:{}),l=0,c=0;if(i&&a.origin!=null){if(typeof a.origin=="number")l=a.origin;else{var o=typeof a.origin=="string"?Rt(a.origin):a.origin;l=o.r,c=o.c}i["!ref"]||(i["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var d=ut(i["!ref"]);u.s.c=d.s.c,u.s.r=d.s.r,u.e.c=Math.max(u.e.c,d.e.c),u.e.r=Math.max(u.e.r,d.e.r),l==-1&&(u.e.r=l=d.e.r+1)}for(var f=0;f!=t.length;++f)if(t[f]){if(!Array.isArray(t[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var x=0;x!=t[f].length;++x)if(!(typeof t[f][x]>"u")){var h={v:t[f][x]},p=l+f,m=c+x;if(u.s.r>p&&(u.s.r=p),u.s.c>m&&(u.s.c=m),u.e.r<p&&(u.e.r=p),u.e.c<m&&(u.e.c=m),t[f][x]&&typeof t[f][x]=="object"&&!Array.isArray(t[f][x])&&!(t[f][x]instanceof Date))h=t[f][x];else if(Array.isArray(h.v)&&(h.f=t[f][x][1],h.v=h.v[0]),h.v===null)if(h.f)h.t="n";else if(a.nullError)h.t="e",h.v=0;else if(a.sheetStubs)h.t="z";else continue;else typeof h.v=="number"?h.t="n":typeof h.v=="boolean"?h.t="b":h.v instanceof Date?(h.z=a.dateNF||Ge[14],a.cellDates?(h.t="d",h.w=_n(h.z,tr(h.v))):(h.t="n",h.v=tr(h.v),h.w=_n(h.z,h.v))):h.t="s";if(s)i[p]||(i[p]=[]),i[p][m]&&i[p][m].z&&(h.z=i[p][m].z),i[p][m]=h;else{var w=Ke({c:m,r:p});i[w]&&i[w].z&&(h.z=i[w].z),i[w]=h}}}return u.s.c<1e7&&(i["!ref"]=et(u)),i}function Ei(e,t){return rg(null,e,t)}function Kw(e){return e.read_shift(4,"i")}function zn(e,t){return t||(t=ye(4)),t.write_shift(4,e),t}function Er(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function cr(e,t){var r=!1;return t==null&&(r=!0,t=ye(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function Yw(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function qw(e,t){return t||(t=ye(4)),t.write_shift(2,0),t.write_shift(2,0),t}function of(e,t){var r=e.l,a=e.read_shift(1),s=Er(e),i=[],l={t:s,h:s};if(a&1){for(var c=e.read_shift(4),o=0;o!=c;++o)i.push(Yw(e));l.r=i}else l.r=[{ich:0,ifnt:0}];return e.l=r+t,l}function Jw(e,t){var r=!1;return t==null&&(r=!0,t=ye(15+4*e.t.length)),t.write_shift(1,0),cr(e.t,t),r?t.slice(0,t.l):t}var Qw=of;function Zw(e,t){var r=!1;return t==null&&(r=!0,t=ye(23+4*e.t.length)),t.write_shift(1,1),cr(e.t,t),t.write_shift(4,1),qw({ich:0,ifnt:0},t),r?t.slice(0,t.l):t}function Sn(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Ds(e,t){return t==null&&(t=ye(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function Is(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function Ms(e,t){return t==null&&(t=ye(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var eN=Er,ng=cr;function df(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function jo(e,t){var r=!1;return t==null&&(r=!0,t=ye(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var tN=Er,Ld=df,uf=jo;function ff(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,a=t[0]&2;e.l+=4;var s=a===0?No([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):ls(t,0)>>2;return r?s/100:s}function ag(e,t){t==null&&(t=ye(4));var r=0,a=0,s=e*100;if(e==(e|0)&&e>=-(1<<29)&&e<1<<29?a=1:s==(s|0)&&s>=-(1<<29)&&s<1<<29&&(a=1,r=1),a)t.write_shift(-4,((r?s:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function sg(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function rN(e,t){return t||(t=ye(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var Rs=sg,Ti=rN;function Cr(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Ss(e,t){return(t||ye(8)).write_shift(8,e,"f")}function nN(e){var t={},r=e.read_shift(1),a=r>>>1,s=e.read_shift(1),i=e.read_shift(2,"i"),l=e.read_shift(1),c=e.read_shift(1),o=e.read_shift(1);switch(e.l++,a){case 0:t.auto=1;break;case 1:t.index=s;var u=ms[s];u&&(t.rgb=Rl(u));break;case 2:t.rgb=Rl([l,c,o]);break;case 3:t.theme=s;break}return i!=0&&(t.tint=i>0?i/32767:i/32768),t}function ko(e,t){if(t||(t=ye(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var a=e.rgb||"FFFFFF";typeof a=="number"&&(a=("000000"+a.toString(16)).slice(-6)),t.write_shift(1,parseInt(a.slice(0,2),16)),t.write_shift(1,parseInt(a.slice(2,4),16)),t.write_shift(1,parseInt(a.slice(4,6),16)),t.write_shift(1,255)}return t}function aN(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function sN(e,t){t||(t=ye(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function ig(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},a=e.read_shift(4);switch(a){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(a>400)throw new Error("Unsupported Clipboard: "+a.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function iN(e){return ig(e,1)}function lN(e){return ig(e,2)}var xf=2,$r=3,wc=11,wm=12,_o=19,Nc=64,cN=65,oN=71,dN=4108,uN=4126,sr=80,lg=81,fN=[sr,lg],Bd={1:{n:"CodePage",t:xf},2:{n:"Category",t:sr},3:{n:"PresentationFormat",t:sr},4:{n:"ByteCount",t:$r},5:{n:"LineCount",t:$r},6:{n:"ParagraphCount",t:$r},7:{n:"SlideCount",t:$r},8:{n:"NoteCount",t:$r},9:{n:"HiddenCount",t:$r},10:{n:"MultimediaClipCount",t:$r},11:{n:"ScaleCrop",t:wc},12:{n:"HeadingPairs",t:dN},13:{n:"TitlesOfParts",t:uN},14:{n:"Manager",t:sr},15:{n:"Company",t:sr},16:{n:"LinksUpToDate",t:wc},17:{n:"CharacterCount",t:$r},19:{n:"SharedDoc",t:wc},22:{n:"HyperlinksChanged",t:wc},23:{n:"AppVersion",t:$r,p:"version"},24:{n:"DigSig",t:cN},26:{n:"ContentType",t:sr},27:{n:"ContentStatus",t:sr},28:{n:"Language",t:sr},29:{n:"Version",t:sr},255:{},2147483648:{n:"Locale",t:_o},2147483651:{n:"Behavior",t:_o},1919054434:{}},Ud={1:{n:"CodePage",t:xf},2:{n:"Title",t:sr},3:{n:"Subject",t:sr},4:{n:"Author",t:sr},5:{n:"Keywords",t:sr},6:{n:"Comments",t:sr},7:{n:"Template",t:sr},8:{n:"LastAuthor",t:sr},9:{n:"RevNumber",t:sr},10:{n:"EditTime",t:Nc},11:{n:"LastPrinted",t:Nc},12:{n:"CreatedDate",t:Nc},13:{n:"ModifiedDate",t:Nc},14:{n:"PageCount",t:$r},15:{n:"WordCount",t:$r},16:{n:"CharCount",t:$r},17:{n:"Thumbnail",t:oN},18:{n:"Application",t:sr},19:{n:"DocSecurity",t:$r},255:{},2147483648:{n:"Locale",t:_o},2147483651:{n:"Behavior",t:_o},1919054434:{}},Nm={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},xN=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function mN(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var hN=mN([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),ms=Ft(hN),Na={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},cg={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},zd={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},jc={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function mf(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function pN(e){var t=mf();if(!e||!e.match)return t;var r={};if((e.match(Ar)||[]).forEach(function(a){var s=Ye(a);switch(s[0].replace(Sw,"<")){case"<?xml":break;case"<Types":t.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[s.Extension]=s.ContentType;break;case"<Override":t[zd[s.ContentType]]!==void 0&&t[zd[s.ContentType]].push(s.PartName);break}}),t.xmlns!==Zt.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function og(e,t){var r=pw(zd),a=[],s;a[a.length]=Xt,a[a.length]=Ae("Types",null,{xmlns:Zt.CT,"xmlns:xsd":Zt.xsd,"xmlns:xsi":Zt.xsi}),a=a.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(o){return Ae("Default",null,{Extension:o[0],ContentType:o[1]})}));var i=function(o){e[o]&&e[o].length>0&&(s=e[o][0],a[a.length]=Ae("Override",null,{PartName:(s[0]=="/"?"":"/")+s,ContentType:jc[o][t.bookType]||jc[o].xlsx}))},l=function(o){(e[o]||[]).forEach(function(u){a[a.length]=Ae("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:jc[o][t.bookType]||jc[o].xlsx})})},c=function(o){(e[o]||[]).forEach(function(u){a[a.length]=Ae("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:r[o][0]})})};return i("workbooks"),l("sheets"),l("charts"),c("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(c),c("vba"),c("comments"),c("threadedcomments"),c("drawings"),l("metadata"),c("people"),a.length>2&&(a[a.length]="</Types>",a[1]=a[1].replace("/>",">")),a.join("")}var st={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Ml(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function sl(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var a={};return(e.match(Ar)||[]).forEach(function(s){var i=Ye(s);if(i[0]==="<Relationship"){var l={};l.Type=i.Type,l.Target=i.Target,l.Id=i.Id,i.TargetMode&&(l.TargetMode=i.TargetMode);var c=i.TargetMode==="External"?i.Target:Gi(i.Target,t);r[c]=l,a[i.Id]=l}}),r["!id"]=a,r}function oi(e){var t=[Xt,Ae("Relationships",null,{xmlns:Zt.RELS})];return Ht(e["!id"]).forEach(function(r){t[t.length]=Ae("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function ht(e,t,r,a,s,i){if(s||(s={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,s.Id="rId"+t,s.Type=a,s.Target=r,[st.HLINK,st.XPATH,st.XMISS].indexOf(s.Type)>-1&&(s.TargetMode="External"),e["!id"][s.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][s.Id]=s,e[("/"+s.Target).replace("//","/")]=s,t}var gN="application/vnd.oasis.opendocument.spreadsheet";function vN(e,t){for(var r=nf(e),a,s;a=Il.exec(r);)switch(a[3]){case"manifest":break;case"file-entry":if(s=Ye(a[0],!1),s.path=="/"&&s.type!==gN)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw a}}function yN(e){var t=[Xt];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function jm(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function bN(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function wN(e){var t=[Xt];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(jm(e[r][0],e[r][1])),t.push(bN("",e[r][0]));return t.push(jm("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function dg(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+go.version+"</meta:generator></office:meta></office:document-meta>"}var Nn=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],NN=function(){for(var e=new Array(Nn.length),t=0;t<Nn.length;++t){var r=Nn[t],a="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+a+"[^>]*>([\\s\\S]*?)</"+a+">")}return e}();function ug(e){var t={};e=vt(e);for(var r=0;r<Nn.length;++r){var a=Nn[r],s=e.match(NN[r]);s!=null&&s.length>0&&(t[a[1]]=dt(s[1])),a[2]==="date"&&t[a[1]]&&(t[a[1]]=Tt(t[a[1]]))}return t}function A0(e,t,r,a,s){s[e]!=null||t==null||t===""||(s[e]=t,t=pt(t),a[a.length]=r?Ae(e,t,r):pr(e,t))}function fg(e,t){var r=t||{},a=[Xt,Ae("cp:coreProperties",null,{"xmlns:cp":Zt.CORE_PROPS,"xmlns:dc":Zt.dc,"xmlns:dcterms":Zt.dcterms,"xmlns:dcmitype":Zt.dcmitype,"xmlns:xsi":Zt.xsi})],s={};if(!e&&!r.Props)return a.join("");e&&(e.CreatedDate!=null&&A0("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:Od(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},a,s),e.ModifiedDate!=null&&A0("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:Od(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},a,s));for(var i=0;i!=Nn.length;++i){var l=Nn[i],c=r.Props&&r.Props[l[1]]!=null?r.Props[l[1]]:e?e[l[1]]:null;c===!0?c="1":c===!1?c="0":typeof c=="number"&&(c=String(c)),c!=null&&A0(l[0],c,null,a,s)}return a.length>2&&(a[a.length]="</cp:coreProperties>",a[1]=a[1].replace("/>",">")),a.join("")}var hs=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],xg=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function mg(e,t,r,a){var s=[];if(typeof e=="string")s=xm(e,a);else for(var i=0;i<e.length;++i)s=s.concat(e[i].map(function(d){return{v:d}}));var l=typeof t=="string"?xm(t,a).map(function(d){return d.v}):t,c=0,o=0;if(l.length>0)for(var u=0;u!==s.length;u+=2){switch(o=+s[u+1].v,s[u].v){case"Worksheets":case"工作表":case"Листы":case"أوراق العمل":case"ワークシート":case"גליונות עבודה":case"Arbeitsblätter":case"Çalışma Sayfaları":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de cálculo":case"Planilhas":case"Regneark":case"Hojas de cálculo":case"Werkbladen":r.Worksheets=o,r.SheetNames=l.slice(c,c+o);break;case"Named Ranges":case"Rangos con nombre":case"名前付き一覧":case"Benannte Bereiche":case"Navngivne områder":r.NamedRanges=o,r.DefinedNames=l.slice(c,c+o);break;case"Charts":case"Diagramme":r.Chartsheets=o,r.ChartNames=l.slice(c,c+o);break}c+=o}}function jN(e,t,r){var a={};return t||(t={}),e=vt(e),hs.forEach(function(s){var i=(e.match(Pl(s[0]))||[])[1];switch(s[2]){case"string":i&&(t[s[1]]=dt(i));break;case"bool":t[s[1]]=i==="true";break;case"raw":var l=e.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));l&&l.length>0&&(a[s[1]]=l[1]);break}}),a.HeadingPairs&&a.TitlesOfParts&&mg(a.HeadingPairs,a.TitlesOfParts,t,r),t}function hg(e){var t=[],r=Ae;return e||(e={}),e.Application="SheetJS",t[t.length]=Xt,t[t.length]=Ae("Properties",null,{xmlns:Zt.EXT_PROPS,"xmlns:vt":Zt.vt}),hs.forEach(function(a){if(e[a[1]]!==void 0){var s;switch(a[2]){case"string":s=pt(String(e[a[1]]));break;case"bool":s=e[a[1]]?"true":"false";break}s!==void 0&&(t[t.length]=r(a[0],s))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(a){return"<vt:lpstr>"+pt(a)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var kN=/<[^>]+>[^<]*/g;function _N(e,t){var r={},a="",s=e.match(kN);if(s)for(var i=0;i!=s.length;++i){var l=s[i],c=Ye(l);switch(c[0]){case"<?xml":break;case"<Properties":break;case"<property":a=dt(c.name);break;case"</property>":a=null;break;default:if(l.indexOf("<vt:")===0){var o=l.split(">"),u=o[0].slice(4),d=o[1];switch(u){case"lpstr":case"bstr":case"lpwstr":r[a]=dt(d);break;case"bool":r[a]=_t(d);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[a]=parseInt(d,10);break;case"r4":case"r8":case"decimal":r[a]=parseFloat(d);break;case"filetime":case"date":r[a]=Tt(d);break;case"cy":case"error":r[a]=dt(d);break;default:if(u.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",l,u,o)}}else if(l.slice(0,2)!=="</"){if(t.WTF)throw new Error(l)}}}return r}function pg(e){var t=[Xt,Ae("Properties",null,{xmlns:Zt.CUST_PROPS,"xmlns:vt":Zt.vt})];if(!e)return t.join("");var r=1;return Ht(e).forEach(function(s){++r,t[t.length]=Ae("property",Iw(e[s]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:pt(s)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Wd={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},P0;function SN(e,t,r){P0||(P0=Ko(Wd)),t=P0[t]||t,e[t]=r}function CN(e,t){var r=[];return Ht(Wd).map(function(a){for(var s=0;s<Nn.length;++s)if(Nn[s][1]==a)return Nn[s];for(s=0;s<hs.length;++s)if(hs[s][1]==a)return hs[s];throw a}).forEach(function(a){if(e[a[1]]!=null){var s=t&&t.Props&&t.Props[a[1]]!=null?t.Props[a[1]]:e[a[1]];switch(a[2]){case"date":s=new Date(s).toISOString().replace(/\.\d*Z/,"Z");break}typeof s=="number"?s=String(s):s===!0||s===!1?s=s?"1":"0":s instanceof Date&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"")),r.push(pr(Wd[a[1]]||a[1],s))}}),Ae("DocumentProperties",r.join(""),{xmlns:en.o})}function EN(e,t){var r=["Worksheets","SheetNames"],a="CustomDocumentProperties",s=[];return e&&Ht(e).forEach(function(i){if(Object.prototype.hasOwnProperty.call(e,i)){for(var l=0;l<Nn.length;++l)if(i==Nn[l][1])return;for(l=0;l<hs.length;++l)if(i==hs[l][1])return;for(l=0;l<r.length;++l)if(i==r[l])return;var c=e[i],o="string";typeof c=="number"?(o="float",c=String(c)):c===!0||c===!1?(o="boolean",c=c?"1":"0"):c=String(c),s.push(Ae(om(i),c,{"dt:dt":o}))}}),t&&Ht(t).forEach(function(i){if(Object.prototype.hasOwnProperty.call(t,i)&&!(e&&Object.prototype.hasOwnProperty.call(e,i))){var l=t[i],c="string";typeof l=="number"?(c="float",l=String(l)):l===!0||l===!1?(c="boolean",l=l?"1":"0"):l instanceof Date?(c="dateTime.tz",l=l.toISOString()):l=String(l),s.push(Ae(om(i),l,{"dt:dt":c}))}}),"<"+a+' xmlns="'+en.o+'">'+s.join("")+"</"+a+">"}function hf(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function TN(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,a=r%Math.pow(2,32),s=(r-a)/Math.pow(2,32);a*=1e7,s*=1e7;var i=a/Math.pow(2,32)|0;i>0&&(a=a%Math.pow(2,32),s+=i);var l=ye(8);return l.write_shift(4,a),l.write_shift(4,s),l}function gg(e,t,r){var a=e.l,s=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-a&3;)++e.l;return s}function vg(e,t,r){var a=e.read_shift(0,"lpwstr");return a}function yg(e,t,r){return t===31?vg(e):gg(e,t,r)}function Hd(e,t,r){return yg(e,t,r===!1?0:4)}function FN(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return yg(e,t,0)}function AN(e){for(var t=e.read_shift(4),r=[],a=0;a!=t;++a){var s=e.l;r[a]=e.read_shift(0,"lpwstr").replace(Lr,""),e.l-s&2&&(e.l+=2)}return r}function PN(e){for(var t=e.read_shift(4),r=[],a=0;a!=t;++a)r[a]=e.read_shift(0,"lpstr-cp").replace(Lr,"");return r}function DN(e){var t=e.l,r=So(e,lg);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var a=So(e,$r);return[r,a]}function IN(e){for(var t=e.read_shift(4),r=[],a=0;a<t/2;++a)r.push(DN(e));return r}function km(e,t){for(var r=e.read_shift(4),a={},s=0;s!=r;++s){var i=e.read_shift(4),l=e.read_shift(4);a[i]=e.read_shift(l,t===1200?"utf16le":"utf8").replace(Lr,"").replace(Vi,"!"),t===1200&&l%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),a}function bg(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function MN(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function So(e,t,r){var a=e.read_shift(2),s,i=r||{};if(e.l+=2,t!==wm&&a!==t&&fN.indexOf(t)===-1&&!((t&65534)==4126&&(a&65534)==4126))throw new Error("Expected type "+t+" saw "+a);switch(t===wm?a:t){case 2:return s=e.read_shift(2,"i"),i.raw||(e.l+=2),s;case 3:return s=e.read_shift(4,"i"),s;case 11:return e.read_shift(4)!==0;case 19:return s=e.read_shift(4),s;case 30:return gg(e,a,4).replace(Lr,"");case 31:return vg(e);case 64:return hf(e);case 65:return bg(e);case 71:return MN(e);case 80:return Hd(e,a,!i.raw).replace(Lr,"");case 81:return FN(e,a).replace(Lr,"");case 4108:return IN(e);case 4126:case 4127:return a==4127?AN(e):PN(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+a)}}function _m(e,t){var r=ye(4),a=ye(4);switch(r.write_shift(4,e==80?31:e),e){case 3:a.write_shift(-4,t);break;case 5:a=ye(8),a.write_shift(8,t,"f");break;case 11:a.write_shift(4,t?1:0);break;case 64:a=TN(t);break;case 31:case 80:for(a=ye(4+2*(t.length+1)+(t.length%2?0:2)),a.write_shift(4,t.length+1),a.write_shift(0,t,"dbcs");a.l!=a.length;)a.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return lr([r,a])}function Sm(e,t){var r=e.l,a=e.read_shift(4),s=e.read_shift(4),i=[],l=0,c=0,o=-1,u={};for(l=0;l!=s;++l){var d=e.read_shift(4),f=e.read_shift(4);i[l]=[d,f+r]}i.sort(function(b,y){return b[1]-y[1]});var x={};for(l=0;l!=s;++l){if(e.l!==i[l][1]){var h=!0;if(l>0&&t)switch(t[i[l-1][0]].t){case 2:e.l+2===i[l][1]&&(e.l+=2,h=!1);break;case 80:e.l<=i[l][1]&&(e.l=i[l][1],h=!1);break;case 4108:e.l<=i[l][1]&&(e.l=i[l][1],h=!1);break}if((!t||l==0)&&e.l<=i[l][1]&&(h=!1,e.l=i[l][1]),h)throw new Error("Read Error: Expected address "+i[l][1]+" at "+e.l+" :"+l)}if(t){var p=t[i[l][0]];if(x[p.n]=So(e,p.t,{raw:!0}),p.p==="version"&&(x[p.n]=String(x[p.n]>>16)+"."+("0000"+String(x[p.n]&65535)).slice(-4)),p.n=="CodePage")switch(x[p.n]){case 0:x[p.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Rn(c=x[p.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+x[p.n])}}else if(i[l][0]===1){if(c=x.CodePage=So(e,xf),Rn(c),o!==-1){var m=e.l;e.l=i[o][1],u=km(e,c),e.l=m}}else if(i[l][0]===0){if(c===0){o=l,e.l=i[l+1][1];continue}u=km(e,c)}else{var w=u[i[l][0]],v;switch(e[e.l]){case 65:e.l+=4,v=bg(e);break;case 30:e.l+=4,v=Hd(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,v=Hd(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,v=e.read_shift(4,"i");break;case 19:e.l+=4,v=e.read_shift(4);break;case 5:e.l+=4,v=e.read_shift(8,"f");break;case 11:e.l+=4,v=$t(e,4);break;case 64:e.l+=4,v=Tt(hf(e));break;default:throw new Error("unparsed value: "+e[e.l])}x[w]=v}}return e.l=r+a,x}var wg=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function RN(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function Cm(e,t,r){var a=ye(8),s=[],i=[],l=8,c=0,o=ye(8),u=ye(8);if(o.write_shift(4,2),o.write_shift(4,1200),u.write_shift(4,1),i.push(o),s.push(u),l+=8+o.length,!t){u=ye(8),u.write_shift(4,0),s.unshift(u);var d=[ye(4)];for(d[0].write_shift(4,e.length),c=0;c<e.length;++c){var f=e[c][0];for(o=ye(8+2*(f.length+1)+(f.length%2?0:2)),o.write_shift(4,c+2),o.write_shift(4,f.length+1),o.write_shift(0,f,"dbcs");o.l!=o.length;)o.write_shift(1,0);d.push(o)}o=lr(d),i.unshift(o),l+=8+o.length}for(c=0;c<e.length;++c)if(!(t&&!t[e[c][0]])&&!(wg.indexOf(e[c][0])>-1||xg.indexOf(e[c][0])>-1)&&e[c][1]!=null){var x=e[c][1],h=0;if(t){h=+t[e[c][0]];var p=r[h];if(p.p=="version"&&typeof x=="string"){var m=x.split(".");x=(+m[0]<<16)+(+m[1]||0)}o=_m(p.t,x)}else{var w=RN(x);w==-1&&(w=31,x=String(x)),o=_m(w,x)}i.push(o),u=ye(8),u.write_shift(4,t?h:2+c),s.push(u),l+=8+o.length}var v=8*(i.length+1);for(c=0;c<i.length;++c)s[c].write_shift(4,v),v+=i[c].length;return a.write_shift(4,l),a.write_shift(4,i.length),lr([a].concat(s).concat(i))}function Em(e,t,r){var a=e.content;if(!a)return{};hr(a,0);var s,i,l,c,o=0;a.chk("feff","Byte Order: "),a.read_shift(2);var u=a.read_shift(4),d=a.read_shift(16);if(d!==$e.utils.consts.HEADER_CLSID&&d!==r)throw new Error("Bad PropertySet CLSID "+d);if(s=a.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(i=a.read_shift(16),c=a.read_shift(4),s===1&&c!==a.l)throw new Error("Length mismatch: "+c+" !== "+a.l);s===2&&(l=a.read_shift(16),o=a.read_shift(4));var f=Sm(a,t),x={SystemIdentifier:u};for(var h in f)x[h]=f[h];if(x.FMTID=i,s===1)return x;if(o-a.l==2&&(a.l+=2),a.l!==o)throw new Error("Length mismatch 2: "+a.l+" !== "+o);var p;try{p=Sm(a,null)}catch{}for(h in p)x[h]=p[h];return x.FMTID=[i,l],x}function Tm(e,t,r,a,s,i){var l=ye(s?68:48),c=[l];l.write_shift(2,65534),l.write_shift(2,0),l.write_shift(4,842412599),l.write_shift(16,$e.utils.consts.HEADER_CLSID,"hex"),l.write_shift(4,s?2:1),l.write_shift(16,t,"hex"),l.write_shift(4,s?68:48);var o=Cm(e,r,a);if(c.push(o),s){var u=Cm(s,null,null);l.write_shift(16,i,"hex"),l.write_shift(4,68+o.length),c.push(u)}return lr(c)}function Ta(e,t){return e.read_shift(t),null}function ON(e,t){t||(t=ye(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function LN(e,t,r){for(var a=[],s=e.l+t;e.l<s;)a.push(r(e,s-e.l));if(s!==e.l)throw new Error("Slurp error");return a}function $t(e,t){return e.read_shift(t)===1}function Rr(e,t){return t||(t=ye(2)),t.write_shift(2,+!!e),t}function qt(e){return e.read_shift(2,"u")}function gn(e,t){return t||(t=ye(2)),t.write_shift(2,e),t}function Ng(e,t){return LN(e,t,qt)}function BN(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function jg(e,t,r){return r||(r=ye(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function ql(e,t,r){var a=e.read_shift(r&&r.biff>=12?2:1),s="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var i=e.read_shift(1);i&&(s="dbcs-cont")}else r.biff==12&&(s="wstr");r.biff>=2&&r.biff<=5&&(s="cpstr");var l=a?e.read_shift(a,s):"";return l}function UN(e){var t=e.read_shift(2),r=e.read_shift(1),a=r&4,s=r&8,i=1+(r&1),l=0,c,o={};s&&(l=e.read_shift(2)),a&&(c=e.read_shift(4));var u=i==2?"dbcs-cont":"sbcs-cont",d=t===0?"":e.read_shift(t,u);return s&&(e.l+=4*l),a&&(e.l+=c),o.t=d,s||(o.raw="<t>"+o.t+"</t>",o.r=o.t),o}function zN(e){var t=e.t||"",r=ye(3);r.write_shift(2,t.length),r.write_shift(1,1);var a=ye(2*t.length);a.write_shift(2*t.length,t,"utf16le");var s=[r,a];return lr(s)}function Cs(e,t,r){var a;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var s=e.read_shift(1);return s===0?a=e.read_shift(t,"sbcs-cont"):a=e.read_shift(t,"dbcs-cont"),a}function Jl(e,t,r){var a=e.read_shift(r&&r.biff==2?1:2);return a===0?(e.l++,""):Cs(e,a,r)}function Os(e,t,r){if(r.biff>5)return Jl(e,t,r);var a=e.read_shift(1);return a===0?(e.l++,""):e.read_shift(a,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function kg(e,t,r){return r||(r=ye(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function WN(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function HN(e){var t=e.read_shift(4),r=e.l,a=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(a=!0),e.l=r);var s=e.read_shift((a?t-24:t)>>1,"utf16le").replace(Lr,"");return a&&(e.l+=24),s}function $N(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var a=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=e.read_shift(4);if(s===0)return r+a.replace(/\\/g,"/");var i=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var l=e.read_shift(i>>1,"utf16le").replace(Lr,"");return r+l}function VN(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return HN(e);case"0303000000000000c000000000000046":return $N(e);default:throw new Error("Unsupported Moniker "+r)}}function kc(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(Lr,""):"";return r}function Fm(e,t){t||(t=ye(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function GN(e,t){var r=e.l+t,a=e.read_shift(4);if(a!==2)throw new Error("Unrecognized streamVersion: "+a);var s=e.read_shift(2);e.l+=2;var i,l,c,o,u="",d,f;s&16&&(i=kc(e,r-e.l)),s&128&&(l=kc(e,r-e.l)),(s&257)===257&&(c=kc(e,r-e.l)),(s&257)===1&&(o=VN(e,r-e.l)),s&8&&(u=kc(e,r-e.l)),s&32&&(d=e.read_shift(16)),s&64&&(f=hf(e)),e.l=r;var x=l||c||o||"";x&&u&&(x+="#"+u),x||(x="#"+u),s&2&&x.charAt(0)=="/"&&x.charAt(1)!="/"&&(x="file://"+x);var h={Target:x};return d&&(h.guid=d),f&&(h.time=f),i&&(h.Tooltip=i),h}function XN(e){var t=ye(512),r=0,a=e.Target;a.slice(0,7)=="file://"&&(a=a.slice(7));var s=a.indexOf("#"),i=s>-1?31:23;switch(a.charAt(0)){case"#":i=28;break;case".":i&=-3;break}t.write_shift(4,2),t.write_shift(4,i);var l=[8,6815827,6619237,4849780,83];for(r=0;r<l.length;++r)t.write_shift(4,l[r]);if(i==28)a=a.slice(1),Fm(a,t);else if(i&2){for(l="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<l.length;++r)t.write_shift(1,parseInt(l[r],16));var c=s>-1?a.slice(0,s):a;for(t.write_shift(4,2*(c.length+1)),r=0;r<c.length;++r)t.write_shift(2,c.charCodeAt(r));t.write_shift(2,0),i&8&&Fm(s>-1?a.slice(s+1):"",t)}else{for(l="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<l.length;++r)t.write_shift(1,parseInt(l[r],16));for(var o=0;a.slice(o*3,o*3+3)=="../"||a.slice(o*3,o*3+3)=="..\\";)++o;for(t.write_shift(2,o),t.write_shift(4,a.length-3*o+1),r=0;r<a.length-3*o;++r)t.write_shift(1,a.charCodeAt(r+3*o)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function _g(e){var t=e.read_shift(1),r=e.read_shift(1),a=e.read_shift(1),s=e.read_shift(1);return[t,r,a,s]}function Sg(e,t){var r=_g(e);return r[3]=0,r}function ta(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2);return{r:t,c:r,ixfe:a}}function Es(e,t,r,a){return a||(a=ye(6)),a.write_shift(2,e),a.write_shift(2,t),a.write_shift(2,r||0),a}function KN(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function YN(e,t,r){return t===0?"":Os(e,t,r)}function qN(e,t,r){var a=r.biff>8?4:2,s=e.read_shift(a),i=e.read_shift(a,"i"),l=e.read_shift(a,"i");return[s,i,l]}function Cg(e){var t=e.read_shift(2),r=ff(e);return[t,r]}function JN(e,t,r){e.l+=4,t-=4;var a=e.l+t,s=ql(e,t,r),i=e.read_shift(2);if(a-=e.l,i!==a)throw new Error("Malformed AddinUdf: padding = "+a+" != "+i);return e.l+=i,s}function Jo(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2);return{s:{c:a,r:t},e:{c:s,r}}}function Eg(e,t){return t||(t=ye(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function Tg(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(1),s=e.read_shift(1);return{s:{c:a,r:t},e:{c:s,r}}}var QN=Tg;function Fg(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2);return e.l+=12,[r,t,a]}function ZN(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function ej(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function Nr(e){e.l+=2,e.l+=e.read_shift(2)}var tj={0:Nr,4:Nr,5:Nr,6:Nr,7:ej,8:Nr,9:Nr,10:Nr,11:Nr,12:Nr,13:ZN,14:Nr,15:Nr,16:Nr,17:Nr,18:Nr,19:Nr,20:Nr,21:Fg};function rj(e,t){for(var r=e.l+t,a=[];e.l<r;){var s=e.read_shift(2);e.l-=2;try{a.push(tj[s](e,r-e.l))}catch{return e.l=r,a}}return e.l!=r&&(e.l=r),a}function _c(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function pf(e,t,r){var a=1536,s=16;switch(r.bookType){case"biff8":break;case"biff5":a=1280,s=8;break;case"biff4":a=4,s=6;break;case"biff3":a=3,s=6;break;case"biff2":a=2,s=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var i=ye(s);return i.write_shift(2,a),i.write_shift(2,t),s>4&&i.write_shift(2,29282),s>6&&i.write_shift(2,1997),s>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function nj(e,t){return t===0||e.read_shift(2),1200}function aj(e,t,r){if(r.enc)return e.l+=t,"";var a=e.l,s=Os(e,0,r);return e.read_shift(t+a-e.l),s}function sj(e,t){var r=!t||t.biff==8,a=ye(r?112:54);for(a.write_shift(t.biff==8?2:1,7),r&&a.write_shift(1,0),a.write_shift(4,859007059),a.write_shift(4,5458548|(r?0:536870912));a.l<a.length;)a.write_shift(1,r?0:32);return a}function ij(e,t,r){var a=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:a&16,fBelow:a&64,fRight:a&128}}function lj(e,t,r){var a=e.read_shift(4),s=e.read_shift(1)&3,i=e.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule";break}var l=ql(e,0,r);return l.length===0&&(l="Sheet1"),{pos:a,hs:s,dt:i,name:l}}function cj(e,t){var r=!t||t.biff>=8?2:1,a=ye(8+r*e.name.length);a.write_shift(4,e.pos),a.write_shift(1,e.hs||0),a.write_shift(1,e.dt),a.write_shift(1,e.name.length),t.biff>=8&&a.write_shift(1,1),a.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var s=a.slice(0,a.l);return s.l=a.l,s}function oj(e,t){for(var r=e.l+t,a=e.read_shift(4),s=e.read_shift(4),i=[],l=0;l!=s&&e.l<r;++l)i.push(UN(e));return i.Count=a,i.Unique=s,i}function dj(e,t){var r=ye(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var a=[],s=0;s<e.length;++s)a[s]=zN(e[s]);var i=lr([r].concat(a));return i.parts=[r.length].concat(a.map(function(l){return l.length})),i}function uj(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function fj(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var a=e.read_shift(1);return e.l+=3,a&7&&(t.level=a&7),a&32&&(t.hidden=!0),a&64&&(t.hpt=r/20),t}function xj(e){var t=KN(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function mj(e){return e.read_shift(2),e.read_shift(4)}function Am(e,t,r){var a=0;r&&r.biff==2||(a=e.read_shift(2));var s=e.read_shift(2);r&&r.biff==2&&(a=1-(s>>15),s&=32767);var i={Unsynced:a&1,DyZero:(a&2)>>1,ExAsc:(a&4)>>2,ExDsc:(a&8)>>3};return[i,s]}function hj(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2),o=e.read_shift(2),u=e.read_shift(2);return{Pos:[t,r],Dim:[a,s],Flags:i,CurTab:l,FirstTab:c,Selected:o,TabRatio:u}}function pj(){var e=ye(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function gj(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var a=e.read_shift(2);return{RTL:a&64}}function vj(e){var t=ye(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function yj(){}function bj(e,t,r){var a={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return a.name=ql(e,0,r),a}function wj(e,t){var r=e.name||"Arial",a=t&&t.biff==5,s=a?15+r.length:16+2*r.length,i=ye(s);return i.write_shift(2,(e.sz||12)*20),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,r.length),a||i.write_shift(1,1),i.write_shift((a?1:2)*r.length,r,a?"sbcs":"utf16le"),i}function Nj(e){var t=ta(e);return t.isst=e.read_shift(4),t}function jj(e,t,r,a){var s=ye(10);return Es(e,t,a,s),s.write_shift(4,r),s}function kj(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var a=e.l+t,s=ta(e);r.biff==2&&e.l++;var i=Jl(e,a-e.l,r);return s.val=i,s}function _j(e,t,r,a,s){var i=!s||s.biff==8,l=ye(8+ +i+(1+i)*r.length);return Es(e,t,a,l),l.write_shift(2,r.length),i&&l.write_shift(1,1),l.write_shift((1+i)*r.length,r,i?"utf16le":"sbcs"),l}function Sj(e,t,r){var a=e.read_shift(2),s=Os(e,0,r);return[a,s]}function Cj(e,t,r,a){var s=r&&r.biff==5;a||(a=ye(s?3+t.length:5+2*t.length)),a.write_shift(2,e),a.write_shift(s?1:2,t.length),s||a.write_shift(1,1),a.write_shift((s?1:2)*t.length,t,s?"sbcs":"utf16le");var i=a.length>a.l?a.slice(0,a.l):a;return i.l==null&&(i.l=i.length),i}var Ej=Os;function Pm(e,t,r){var a=e.l+t,s=r.biff==8||!r.biff?4:2,i=e.read_shift(s),l=e.read_shift(s),c=e.read_shift(2),o=e.read_shift(2);return e.l=a,{s:{r:i,c},e:{r:l,c:o}}}function Tj(e,t){var r=t.biff==8||!t.biff?4:2,a=ye(2*r+6);return a.write_shift(r,e.s.r),a.write_shift(r,e.e.r+1),a.write_shift(2,e.s.c),a.write_shift(2,e.e.c+1),a.write_shift(2,0),a}function Fj(e){var t=e.read_shift(2),r=e.read_shift(2),a=Cg(e);return{r:t,c:r,ixfe:a[0],rknum:a[1]}}function Aj(e,t){for(var r=e.l+t-2,a=e.read_shift(2),s=e.read_shift(2),i=[];e.l<r;)i.push(Cg(e));if(e.l!==r)throw new Error("MulRK read error");var l=e.read_shift(2);if(i.length!=l-s+1)throw new Error("MulRK length mismatch");return{r:a,c:s,C:l,rkrec:i}}function Pj(e,t){for(var r=e.l+t-2,a=e.read_shift(2),s=e.read_shift(2),i=[];e.l<r;)i.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var l=e.read_shift(2);if(i.length!=l-s+1)throw new Error("MulBlank length mismatch");return{r:a,c:s,C:l,ixfe:i}}function Dj(e,t,r,a){var s={},i=e.read_shift(4),l=e.read_shift(4),c=e.read_shift(4),o=e.read_shift(2);return s.patternType=xN[c>>26],a.cellStyles&&(s.alc=i&7,s.fWrap=i>>3&1,s.alcV=i>>4&7,s.fJustLast=i>>7&1,s.trot=i>>8&255,s.cIndent=i>>16&15,s.fShrinkToFit=i>>20&1,s.iReadOrder=i>>22&2,s.fAtrNum=i>>26&1,s.fAtrFnt=i>>27&1,s.fAtrAlc=i>>28&1,s.fAtrBdr=i>>29&1,s.fAtrPat=i>>30&1,s.fAtrProt=i>>31&1,s.dgLeft=l&15,s.dgRight=l>>4&15,s.dgTop=l>>8&15,s.dgBottom=l>>12&15,s.icvLeft=l>>16&127,s.icvRight=l>>23&127,s.grbitDiag=l>>30&3,s.icvTop=c&127,s.icvBottom=c>>7&127,s.icvDiag=c>>14&127,s.dgDiag=c>>21&15,s.icvFore=o&127,s.icvBack=o>>7&127,s.fsxButton=o>>14&1),s}function Ij(e,t,r){var a={};return a.ifnt=e.read_shift(2),a.numFmtId=e.read_shift(2),a.flags=e.read_shift(2),a.fStyle=a.flags>>2&1,t-=6,a.data=Dj(e,t,a.fStyle,r),a}function Dm(e,t,r,a){var s=r&&r.biff==5;a||(a=ye(s?16:20)),a.write_shift(2,0),e.style?(a.write_shift(2,e.numFmtId||0),a.write_shift(2,65524)):(a.write_shift(2,e.numFmtId||0),a.write_shift(2,t<<4));var i=0;return e.numFmtId>0&&s&&(i|=1024),a.write_shift(4,i),a.write_shift(4,0),s||a.write_shift(4,0),a.write_shift(2,0),a}function Mj(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function Rj(e){var t=ye(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function Im(e,t,r){var a=ta(e);(r.biff==2||t==9)&&++e.l;var s=BN(e);return a.val=s,a.t=s===!0||s===!1?"b":"e",a}function Oj(e,t,r,a,s,i){var l=ye(8);return Es(e,t,a,l),jg(r,i,l),l}function Lj(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var a=ta(e),s=Cr(e);return a.val=s,a}function Bj(e,t,r,a){var s=ye(14);return Es(e,t,a,s),Ss(r,s),s}var Mm=YN;function Uj(e,t,r){var a=e.l+t,s=e.read_shift(2),i=e.read_shift(2);if(r.sbcch=i,i==1025||i==14849)return[i,s];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var l=Cs(e,i),c=[];a>e.l;)c.push(Jl(e));return[i,s,l,c]}function Rm(e,t,r){var a=e.read_shift(2),s,i={fBuiltIn:a&1,fWantAdvise:a>>>1&1,fWantPict:a>>>2&1,fOle:a>>>3&1,fOleLink:a>>>4&1,cf:a>>>5&1023,fIcon:a>>>15&1};return r.sbcch===14849&&(s=JN(e,t-2,r)),i.body=s||e.read_shift(t-2),typeof s=="string"&&(i.Name=s),i}var zj=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function Om(e,t,r){var a=e.l+t,s=e.read_shift(2),i=e.read_shift(1),l=e.read_shift(1),c=e.read_shift(r&&r.biff==2?1:2),o=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),o=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var u=Cs(e,l,r);s&32&&(u=zj[u.charCodeAt(0)]);var d=a-e.l;r&&r.biff==2&&--d;var f=a==e.l||c===0||!(d>0)?[]:r_(e,d,r,c);return{chKey:i,Name:u,itab:o,rgce:f}}function Ag(e,t,r){if(r.biff<8)return Wj(e,t,r);for(var a=[],s=e.l+t,i=e.read_shift(r.biff>8?4:2);i--!==0;)a.push(qN(e,r.biff>8?12:6,r));if(e.l!=s)throw new Error("Bad ExternSheet: "+e.l+" != "+s);return a}function Wj(e,t,r){e[e.l+1]==3&&e[e.l]++;var a=ql(e,t,r);return a.charCodeAt(0)==3?a.slice(1):a}function Hj(e,t,r){if(r.biff<8){e.l+=t;return}var a=e.read_shift(2),s=e.read_shift(2),i=Cs(e,a,r),l=Cs(e,s,r);return[i,l]}function $j(e,t,r){var a=Tg(e);e.l++;var s=e.read_shift(1);return t-=8,[n_(e,t,r),s,a]}function Lm(e,t,r){var a=QN(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[a,e_(e,t,r)]}function Vj(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,a=e.read_shift(4);return[t,r,a]}function Gj(e,t,r){if(!(r.biff<8)){var a=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),l=e.read_shift(2),c=Os(e,0,r);return r.biff<8&&e.read_shift(1),[{r:a,c:s},c,l,i]}}function Xj(e,t,r){return Gj(e,t,r)}function Kj(e,t){for(var r=[],a=e.read_shift(2);a--;)r.push(Jo(e));return r}function Yj(e){var t=ye(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)Eg(e[r],t);return t}function qj(e,t,r){if(r&&r.biff<8)return Qj(e,t,r);var a=Fg(e),s=rj(e,t-22,a[1]);return{cmo:a,ft:s}}var Jj={8:function(e,t){var r=e.l+t;e.l+=10;var a=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var s=e.read_shift(1);return e.l+=s,e.l=r,{fmt:a}}};function Qj(e,t,r){e.l+=4;var a=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var l=[];return l.push((Jj[a]||Fr)(e,t,r)),{cmo:[s,a,i],ft:l}}function Zj(e,t,r){var a=e.l,s="";try{e.l+=4;var i=(r.lastobj||{cmo:[0,0]}).cmo[1],l;[0,5,7,11,12,14].indexOf(i)==-1?e.l+=6:l=WN(e,6,r);var c=e.read_shift(2);e.read_shift(2),qt(e,2);var o=e.read_shift(2);e.l+=o;for(var u=1;u<e.lens.length-1;++u){if(e.l-a!=e.lens[u])throw new Error("TxO: bad continue record");var d=e[e.l],f=Cs(e,e.lens[u+1]-e.lens[u]-1);if(s+=f,s.length>=(d?c:2*c))break}if(s.length!==c&&s.length!==c*2)throw new Error("cchText: "+c+" != "+s.length);return e.l=a+t,{t:s}}catch{return e.l=a+t,{t:s}}}function e4(e,t){var r=Jo(e);e.l+=16;var a=GN(e,t-24);return[r,a]}function t4(e){var t=ye(24),r=Rt(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var a="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<16;++s)t.write_shift(1,parseInt(a[s],16));return lr([t,XN(e[1])])}function r4(e,t){e.read_shift(2);var r=Jo(e),a=e.read_shift((t-10)/2,"dbcs-cont");return a=a.replace(Lr,""),[r,a]}function n4(e){var t=e[1].Tooltip,r=ye(10+2*(t.length+1));r.write_shift(2,2048);var a=Rt(e[0]);r.write_shift(2,a.r),r.write_shift(2,a.r),r.write_shift(2,a.c),r.write_shift(2,a.c);for(var s=0;s<t.length;++s)r.write_shift(2,t.charCodeAt(s));return r.write_shift(2,0),r}function a4(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=Nm[r]||r,r=e.read_shift(2),t[1]=Nm[r]||r,t}function s4(e){return e||(e=ye(4)),e.write_shift(2,1),e.write_shift(2,1),e}function i4(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(Sg(e));return r}function l4(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(Sg(e));return r}function c4(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function Pg(e,t,r){if(!r.cellStyles)return Fr(e,t);var a=r&&r.biff>=12?4:2,s=e.read_shift(a),i=e.read_shift(a),l=e.read_shift(a),c=e.read_shift(a),o=e.read_shift(2);a==2&&(e.l+=2);var u={s,e:i,w:l,ixfe:c,flags:o};return(r.biff>=5||!r.biff)&&(u.level=o>>8&7),u}function o4(e,t){var r=ye(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var a=0;return e.hidden&&(a|=1),r.write_shift(1,a),a=e.level||0,r.write_shift(1,a),r.write_shift(2,0),r}function d4(e,t){var r={};return t<32||(e.l+=16,r.header=Cr(e),r.footer=Cr(e),e.l+=2),r}function u4(e,t,r){var a={area:!1};if(r.biff!=5)return e.l+=t,a;var s=e.read_shift(1);return e.l+=3,s&16&&(a.area=!0),a}function f4(e){for(var t=ye(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var x4=ta,m4=Ng,h4=Jl;function p4(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(4),s={fmt:t,env:r,len:a,data:e.slice(e.l,e.l+a)};return e.l+=a,s}function g4(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var a=ta(e);++e.l;var s=Os(e,t-7,r);return a.t="str",a.val=s,a}function v4(e){var t=ta(e);++e.l;var r=Cr(e);return t.t="n",t.val=r,t}function y4(e,t,r){var a=ye(15);return tc(a,e,t),a.write_shift(8,r,"f"),a}function b4(e){var t=ta(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function w4(e,t,r){var a=ye(9);return tc(a,e,t),a.write_shift(2,r),a}function N4(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function j4(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function k4(e,t,r){var a=e.l+t,s=ta(e),i=e.read_shift(2),l=Cs(e,i,r);return e.l=a,s.t="str",s.val=l,s}var _4=[2,3,48,49,131,139,140,245],$d=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Ko({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(c,o){var u=[],d=Ya(1);switch(o.type){case"base64":d=rn(cn(c));break;case"binary":d=rn(c);break;case"buffer":case"array":d=c;break}hr(d,0);var f=d.read_shift(1),x=!!(f&136),h=!1,p=!1;switch(f){case 2:break;case 3:break;case 48:h=!0,x=!0;break;case 49:h=!0,x=!0;break;case 131:break;case 139:break;case 140:p=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var m=0,w=521;f==2&&(m=d.read_shift(2)),d.l+=3,f!=2&&(m=d.read_shift(4)),m>1048576&&(m=1e6),f!=2&&(w=d.read_shift(2));var v=d.read_shift(2),b=o.codepage||1252;f!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(b=e[d[d.l]]),d.l+=1,d.l+=2),p&&(d.l+=36);for(var y=[],N={},F=Math.min(d.length,f==2?521:w-10-(h?264:0)),j=p?32:11;d.l<F&&d[d.l]!=13;)switch(N={},N.name=Ia.utils.decode(b,d.slice(d.l,d.l+j)).replace(/[\u0000\r\n].*$/g,""),d.l+=j,N.type=String.fromCharCode(d.read_shift(1)),f!=2&&!p&&(N.offset=d.read_shift(4)),N.len=d.read_shift(1),f==2&&(N.offset=d.read_shift(2)),N.dec=d.read_shift(1),N.name.length&&y.push(N),f!=2&&(d.l+=p?13:14),N.type){case"B":(!h||N.len!=8)&&o.WTF&&console.log("Skipping "+N.name+":"+N.type);break;case"G":case"P":o.WTF&&console.log("Skipping "+N.name+":"+N.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+N.type)}if(d[d.l]!==13&&(d.l=w-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=w;var k=0,S=0;for(u[0]=[],S=0;S!=y.length;++S)u[0][S]=y[S].name;for(;m-- >0;){if(d[d.l]===42){d.l+=v;continue}for(++d.l,u[++k]=[],S=0,S=0;S!=y.length;++S){var P=d.slice(d.l,d.l+y[S].len);d.l+=y[S].len,hr(P,0);var D=Ia.utils.decode(b,P);switch(y[S].type){case"C":D.trim().length&&(u[k][S]=D.replace(/\s+$/,""));break;case"D":D.length===8?u[k][S]=new Date(+D.slice(0,4),+D.slice(4,6)-1,+D.slice(6,8)):u[k][S]=D;break;case"F":u[k][S]=parseFloat(D.trim());break;case"+":case"I":u[k][S]=p?P.read_shift(-4,"i")^2147483648:P.read_shift(4,"i");break;case"L":switch(D.trim().toUpperCase()){case"Y":case"T":u[k][S]=!0;break;case"N":case"F":u[k][S]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+D+"|")}break;case"M":if(!x)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));u[k][S]="##MEMO##"+(p?parseInt(D.trim(),10):P.read_shift(4));break;case"N":D=D.replace(/\u0000/g,"").trim(),D&&D!="."&&(u[k][S]=+D||0);break;case"@":u[k][S]=new Date(P.read_shift(-8,"f")-621356832e5);break;case"T":u[k][S]=new Date((P.read_shift(4)-2440588)*864e5+P.read_shift(4));break;case"Y":u[k][S]=P.read_shift(4,"i")/1e4+P.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[k][S]=-P.read_shift(-8,"f");break;case"B":if(h&&y[S].len==8){u[k][S]=P.read_shift(8,"f");break}case"G":case"P":P.l+=y[S].len;break;case"0":if(y[S].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+y[S].type)}}}if(f!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return o&&o.sheetRows&&(u=u.slice(0,o.sheetRows)),o.DBF=y,u}function a(c,o){var u=o||{};u.dateNF||(u.dateNF="yyyymmdd");var d=Ei(r(c,u),u);return d["!cols"]=u.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete u.DBF,d}function s(c,o){try{return ns(a(c,o),o)}catch(u){if(o&&o.WTF)throw u}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function l(c,o){var u=o||{};if(+u.codepage>=0&&Rn(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var d=qr(),f=To(c,{header:1,raw:!0,cellDates:!0}),x=f[0],h=f.slice(1),p=c["!cols"]||[],m=0,w=0,v=0,b=1;for(m=0;m<x.length;++m){if(((p[m]||{}).DBF||{}).name){x[m]=p[m].DBF.name,++v;continue}if(x[m]!=null){if(++v,typeof x[m]=="number"&&(x[m]=x[m].toString(10)),typeof x[m]!="string")throw new Error("DBF Invalid column name "+x[m]+" |"+typeof x[m]+"|");if(x.indexOf(x[m])!==m){for(w=0;w<1024;++w)if(x.indexOf(x[m]+"_"+w)==-1){x[m]+="_"+w;break}}}}var y=ut(c["!ref"]),N=[],F=[],j=[];for(m=0;m<=y.e.c-y.s.c;++m){var k="",S="",P=0,D=[];for(w=0;w<h.length;++w)h[w][m]!=null&&D.push(h[w][m]);if(D.length==0||x[m]==null){N[m]="?";continue}for(w=0;w<D.length;++w){switch(typeof D[w]){case"number":S="B";break;case"string":S="C";break;case"boolean":S="L";break;case"object":S=D[w]instanceof Date?"D":"C";break;default:S="C"}P=Math.max(P,String(D[w]).length),k=k&&k!=S?"C":S}P>250&&(P=250),S=((p[m]||{}).DBF||{}).type,S=="C"&&p[m].DBF.len>P&&(P=p[m].DBF.len),k=="B"&&S=="N"&&(k="N",j[m]=p[m].DBF.dec,P=p[m].DBF.len),F[m]=k=="C"||S=="N"?P:i[k]||0,b+=F[m],N[m]=k}var K=d.next(32);for(K.write_shift(4,318902576),K.write_shift(4,h.length),K.write_shift(2,296+32*v),K.write_shift(2,b),m=0;m<4;++m)K.write_shift(4,0);for(K.write_shift(4,0|(+t[w1]||3)<<8),m=0,w=0;m<x.length;++m)if(x[m]!=null){var C=d.next(32),Y=(x[m].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);C.write_shift(1,Y,"sbcs"),C.write_shift(1,N[m]=="?"?"C":N[m],"sbcs"),C.write_shift(4,w),C.write_shift(1,F[m]||i[N[m]]||0),C.write_shift(1,j[m]||0),C.write_shift(1,2),C.write_shift(4,0),C.write_shift(1,0),C.write_shift(4,0),C.write_shift(4,0),w+=F[m]||i[N[m]]||0}var B=d.next(264);for(B.write_shift(4,13),m=0;m<65;++m)B.write_shift(4,0);for(m=0;m<h.length;++m){var ee=d.next(b);for(ee.write_shift(1,0),w=0;w<x.length;++w)if(x[w]!=null)switch(N[w]){case"L":ee.write_shift(1,h[m][w]==null?63:h[m][w]?84:70);break;case"B":ee.write_shift(8,h[m][w]||0,"f");break;case"N":var re="0";for(typeof h[m][w]=="number"&&(re=h[m][w].toFixed(j[w]||0)),v=0;v<F[w]-re.length;++v)ee.write_shift(1,32);ee.write_shift(1,re,"sbcs");break;case"D":h[m][w]?(ee.write_shift(4,("0000"+h[m][w].getFullYear()).slice(-4),"sbcs"),ee.write_shift(2,("00"+(h[m][w].getMonth()+1)).slice(-2),"sbcs"),ee.write_shift(2,("00"+h[m][w].getDate()).slice(-2),"sbcs")):ee.write_shift(8,"00000000","sbcs");break;case"C":var Q=String(h[m][w]!=null?h[m][w]:"").slice(0,F[w]);for(ee.write_shift(1,Q,"sbcs"),v=0;v<F[w]-Q.length;++v)ee.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:s,to_sheet:a,from_sheet:l}}(),Dg=function(){var e={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Ht(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(x,h){var p=e[h];return typeof p=="number"?Yx(p):p},a=function(x,h,p){var m=h.charCodeAt(0)-32<<4|p.charCodeAt(0)-48;return m==59?x:Yx(m)};e["|"]=254;function s(x,h){switch(h.type){case"base64":return i(cn(x),h);case"binary":return i(x,h);case"buffer":return i(rt&&Buffer.isBuffer(x)?x.toString("binary"):rs(x),h);case"array":return i(_s(x),h)}throw new Error("Unrecognized type "+h.type)}function i(x,h){var p=x.split(/[\n\r]+/),m=-1,w=-1,v=0,b=0,y=[],N=[],F=null,j={},k=[],S=[],P=[],D=0,K;for(+h.codepage>=0&&Rn(+h.codepage);v!==p.length;++v){D=0;var C=p[v].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,a).replace(t,r),Y=C.replace(/;;/g,"\0").split(";").map(function(_){return _.replace(/\u0000/g,";")}),B=Y[0],ee;if(C.length>0)switch(B){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":Y[1].charAt(0)=="P"&&N.push(C.slice(3).replace(/;;/g,";"));break;case"C":var re=!1,Q=!1,te=!1,H=!1,ae=-1,he=-1;for(b=1;b<Y.length;++b)switch(Y[b].charAt(0)){case"A":break;case"X":w=parseInt(Y[b].slice(1))-1,Q=!0;break;case"Y":for(m=parseInt(Y[b].slice(1))-1,Q||(w=0),K=y.length;K<=m;++K)y[K]=[];break;case"K":ee=Y[b].slice(1),ee.charAt(0)==='"'?ee=ee.slice(1,ee.length-1):ee==="TRUE"?ee=!0:ee==="FALSE"?ee=!1:isNaN(Un(ee))?isNaN(bi(ee).getDate())||(ee=Tt(ee)):(ee=Un(ee),F!==null&&Si(F)&&(ee=qo(ee))),re=!0;break;case"E":H=!0;var O=di(Y[b].slice(1),{r:m,c:w});y[m][w]=[y[m][w],O];break;case"S":te=!0,y[m][w]=[y[m][w],"S5S"];break;case"G":break;case"R":ae=parseInt(Y[b].slice(1))-1;break;case"C":he=parseInt(Y[b].slice(1))-1;break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+C)}if(re&&(y[m][w]&&y[m][w].length==2?y[m][w][0]=ee:y[m][w]=ee,F=null),te){if(H)throw new Error("SYLK shared formula cannot have own formula");var I=ae>-1&&y[ae][he];if(!I||!I[1])throw new Error("SYLK shared formula cannot find base");y[m][w][1]=Jg(I[1],{r:m-ae,c:w-he})}break;case"F":var g=0;for(b=1;b<Y.length;++b)switch(Y[b].charAt(0)){case"X":w=parseInt(Y[b].slice(1))-1,++g;break;case"Y":for(m=parseInt(Y[b].slice(1))-1,K=y.length;K<=m;++K)y[K]=[];break;case"M":D=parseInt(Y[b].slice(1))/20;break;case"F":break;case"G":break;case"P":F=N[parseInt(Y[b].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(P=Y[b].slice(1).split(" "),K=parseInt(P[0],10);K<=parseInt(P[1],10);++K)D=parseInt(P[2],10),S[K-1]=D===0?{hidden:!0}:{wch:D},qa(S[K-1]);break;case"C":w=parseInt(Y[b].slice(1))-1,S[w]||(S[w]={});break;case"R":m=parseInt(Y[b].slice(1))-1,k[m]||(k[m]={}),D>0?(k[m].hpt=D,k[m].hpx=Ni(D)):D===0&&(k[m].hidden=!0);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+C)}g<1&&(F=null);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+C)}}return k.length>0&&(j["!rows"]=k),S.length>0&&(j["!cols"]=S),h&&h.sheetRows&&(y=y.slice(0,h.sheetRows)),[y,j]}function l(x,h){var p=s(x,h),m=p[0],w=p[1],v=Ei(m,h);return Ht(w).forEach(function(b){v[b]=w[b]}),v}function c(x,h){return ns(l(x,h),h)}function o(x,h,p,m){var w="C;Y"+(p+1)+";X"+(m+1)+";K";switch(x.t){case"n":w+=x.v||0,x.f&&!x.F&&(w+=";E"+Nf(x.f,{r:p,c:m}));break;case"b":w+=x.v?"TRUE":"FALSE";break;case"e":w+=x.w||x.v;break;case"d":w+='"'+(x.w||x.v)+'"';break;case"s":w+='"'+x.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return w}function u(x,h){h.forEach(function(p,m){var w="F;W"+(m+1)+" "+(m+1)+" ";p.hidden?w+="0":(typeof p.width=="number"&&!p.wpx&&(p.wpx=Ol(p.width)),typeof p.wpx=="number"&&!p.wch&&(p.wch=Ll(p.wpx)),typeof p.wch=="number"&&(w+=Math.round(p.wch))),w.charAt(w.length-1)!=" "&&x.push(w)})}function d(x,h){h.forEach(function(p,m){var w="F;";p.hidden?w+="M0;":p.hpt?w+="M"+20*p.hpt+";":p.hpx&&(w+="M"+20*Bl(p.hpx)+";"),w.length>2&&x.push(w+"R"+(m+1))})}function f(x,h){var p=["ID;PWXL;N;E"],m=[],w=ut(x["!ref"]),v,b=Array.isArray(x),y=`\r
`;p.push("P;PGeneral"),p.push("F;P0;DG0G8;M255"),x["!cols"]&&u(p,x["!cols"]),x["!rows"]&&d(p,x["!rows"]),p.push("B;Y"+(w.e.r-w.s.r+1)+";X"+(w.e.c-w.s.c+1)+";D"+[w.s.c,w.s.r,w.e.c,w.e.r].join(" "));for(var N=w.s.r;N<=w.e.r;++N)for(var F=w.s.c;F<=w.e.c;++F){var j=Ke({r:N,c:F});v=b?(x[N]||[])[F]:x[j],!(!v||v.v==null&&(!v.f||v.F))&&m.push(o(v,x,N,F))}return p.join(y)+y+m.join(y)+y+"E"+y}return{to_workbook:c,to_sheet:l,from_sheet:f}}(),Ig=function(){function e(i,l){switch(l.type){case"base64":return t(cn(i),l);case"binary":return t(i,l);case"buffer":return t(rt&&Buffer.isBuffer(i)?i.toString("binary"):rs(i),l);case"array":return t(_s(i),l)}throw new Error("Unrecognized type "+l.type)}function t(i,l){for(var c=i.split(`
`),o=-1,u=-1,d=0,f=[];d!==c.length;++d){if(c[d].trim()==="BOT"){f[++o]=[],u=0;continue}if(!(o<0)){var x=c[d].trim().split(","),h=x[0],p=x[1];++d;for(var m=c[d]||"";(m.match(/["]/g)||[]).length&1&&d<c.length-1;)m+=`
`+c[++d];switch(m=m.trim(),+h){case-1:if(m==="BOT"){f[++o]=[],u=0;continue}else if(m!=="EOD")throw new Error("Unrecognized DIF special command "+m);break;case 0:m==="TRUE"?f[o][u]=!0:m==="FALSE"?f[o][u]=!1:isNaN(Un(p))?isNaN(bi(p).getDate())?f[o][u]=p:f[o][u]=Tt(p):f[o][u]=Un(p),++u;break;case 1:m=m.slice(1,m.length-1),m=m.replace(/""/g,'"'),m&&m.match(/^=".*"$/)&&(m=m.slice(2,-1)),f[o][u++]=m!==""?m:null;break}if(m==="EOD")break}}return l&&l.sheetRows&&(f=f.slice(0,l.sheetRows)),f}function r(i,l){return Ei(e(i,l),l)}function a(i,l){return ns(r(i,l),l)}var s=function(){var i=function(o,u,d,f,x){o.push(u),o.push(d+","+f),o.push('"'+x.replace(/"/g,'""')+'"')},l=function(o,u,d,f){o.push(u+","+d),o.push(u==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(o){var u=[],d=ut(o["!ref"]),f,x=Array.isArray(o);i(u,"TABLE",0,1,"sheetjs"),i(u,"VECTORS",0,d.e.r-d.s.r+1,""),i(u,"TUPLES",0,d.e.c-d.s.c+1,""),i(u,"DATA",0,0,"");for(var h=d.s.r;h<=d.e.r;++h){l(u,-1,0,"BOT");for(var p=d.s.c;p<=d.e.c;++p){var m=Ke({r:h,c:p});if(f=x?(o[h]||[])[p]:o[m],!f){l(u,1,0,"");continue}switch(f.t){case"n":var w=f.w;!w&&f.v!=null&&(w=f.v),w==null?f.f&&!f.F?l(u,1,0,"="+f.f):l(u,1,0,""):l(u,0,w,"V");break;case"b":l(u,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":l(u,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=_n(f.z||Ge[14],tr(Tt(f.v)))),l(u,0,f.w,"V");break;default:l(u,1,0,"")}}}l(u,-1,0,"EOD");var v=`\r
`,b=u.join(v);return b}}();return{to_workbook:a,to_sheet:r,from_sheet:s}}(),Mg=function(){function e(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(f,x){for(var h=f.split(`
`),p=-1,m=-1,w=0,v=[];w!==h.length;++w){var b=h[w].trim().split(":");if(b[0]==="cell"){var y=Rt(b[1]);if(v.length<=y.r)for(p=v.length;p<=y.r;++p)v[p]||(v[p]=[]);switch(p=y.r,m=y.c,b[2]){case"t":v[p][m]=e(b[3]);break;case"v":v[p][m]=+b[3];break;case"vtf":var N=b[b.length-1];case"vtc":switch(b[3]){case"nl":v[p][m]=!!+b[4];break;default:v[p][m]=+b[4];break}b[2]=="vtf"&&(v[p][m]=[v[p][m],N])}}}return x&&x.sheetRows&&(v=v.slice(0,x.sheetRows)),v}function a(f,x){return Ei(r(f,x),x)}function s(f,x){return ns(a(f,x),x)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),l=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,c=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),o="--SocialCalcSpreadsheetControlSave--";function u(f){if(!f||!f["!ref"])return"";for(var x=[],h=[],p,m="",w=Jr(f["!ref"]),v=Array.isArray(f),b=w.s.r;b<=w.e.r;++b)for(var y=w.s.c;y<=w.e.c;++y)if(m=Ke({r:b,c:y}),p=v?(f[b]||[])[y]:f[m],!(!p||p.v==null||p.t==="z")){switch(h=["cell",m,"t"],p.t){case"s":case"str":h.push(t(p.v));break;case"n":p.f?(h[2]="vtf",h[3]="n",h[4]=p.v,h[5]=t(p.f)):(h[2]="v",h[3]=p.v);break;case"b":h[2]="vt"+(p.f?"f":"c"),h[3]="nl",h[4]=p.v?"1":"0",h[5]=t(p.f||(p.v?"TRUE":"FALSE"));break;case"d":var N=tr(Tt(p.v));h[2]="vtc",h[3]="nd",h[4]=""+N,h[5]=p.w||_n(p.z||Ge[14],N);break;case"e":continue}x.push(h.join(":"))}return x.push("sheet:c:"+(w.e.c-w.s.c+1)+":r:"+(w.e.r-w.s.r+1)+":tvf:1"),x.push("valueformat:1:text-wiki"),x.join(`
`)}function d(f){return[i,l,c,l,u(f),o].join(`
`)}return{to_workbook:s,to_sheet:a,from_sheet:d}}(),wi=function(){function e(d,f,x,h,p){p.raw?f[x][h]=d:d===""||(d==="TRUE"?f[x][h]=!0:d==="FALSE"?f[x][h]=!1:isNaN(Un(d))?isNaN(bi(d).getDate())?f[x][h]=d:f[x][h]=Tt(d):f[x][h]=Un(d))}function t(d,f){var x=f||{},h=[];if(!d||d.length===0)return h;for(var p=d.split(/[\r\n]/),m=p.length-1;m>=0&&p[m].length===0;)--m;for(var w=10,v=0,b=0;b<=m;++b)v=p[b].indexOf(" "),v==-1?v=p[b].length:v++,w=Math.max(w,v);for(b=0;b<=m;++b){h[b]=[];var y=0;for(e(p[b].slice(0,w).trim(),h,b,y,x),y=1;y<=(p[b].length-w)/10+1;++y)e(p[b].slice(w+(y-1)*10,w+y*10).trim(),h,b,y,x)}return x.sheetRows&&(h=h.slice(0,x.sheetRows)),h}var r={44:",",9:"	",59:";",124:"|"},a={44:3,9:2,59:1,124:0};function s(d){for(var f={},x=!1,h=0,p=0;h<d.length;++h)(p=d.charCodeAt(h))==34?x=!x:!x&&p in r&&(f[p]=(f[p]||0)+1);p=[];for(h in f)Object.prototype.hasOwnProperty.call(f,h)&&p.push([f[h],h]);if(!p.length){f=a;for(h in f)Object.prototype.hasOwnProperty.call(f,h)&&p.push([f[h],h])}return p.sort(function(m,w){return m[0]-w[0]||a[m[1]]-a[w[1]]}),r[p.pop()[1]]||44}function i(d,f){var x=f||{},h="",p=x.dense?[]:{},m={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(h=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(h=d.charAt(4),d=d.slice(6)):h=s(d.slice(0,1024)):x&&x.FS?h=x.FS:h=s(d.slice(0,1024));var w=0,v=0,b=0,y=0,N=0,F=h.charCodeAt(0),j=!1,k=0,S=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var P=x.dateNF!=null?uw(x.dateNF):null;function D(){var K=d.slice(y,N),C={};if(K.charAt(0)=='"'&&K.charAt(K.length-1)=='"'&&(K=K.slice(1,-1).replace(/""/g,'"')),K.length===0)C.t="z";else if(x.raw)C.t="s",C.v=K;else if(K.trim().length===0)C.t="s",C.v=K;else if(K.charCodeAt(0)==61)K.charCodeAt(1)==34&&K.charCodeAt(K.length-1)==34?(C.t="s",C.v=K.slice(2,-1).replace(/""/g,'"')):U5(K)?(C.t="n",C.f=K.slice(1)):(C.t="s",C.v=K);else if(K=="TRUE")C.t="b",C.v=!0;else if(K=="FALSE")C.t="b",C.v=!1;else if(!isNaN(b=Un(K)))C.t="n",x.cellText!==!1&&(C.w=K),C.v=b;else if(!isNaN(bi(K).getDate())||P&&K.match(P)){C.z=x.dateNF||Ge[14];var Y=0;P&&K.match(P)&&(K=fw(K,x.dateNF,K.match(P)||[]),Y=1),x.cellDates?(C.t="d",C.v=Tt(K,Y)):(C.t="n",C.v=tr(Tt(K,Y))),x.cellText!==!1&&(C.w=_n(C.z,C.v instanceof Date?tr(C.v):C.v)),x.cellNF||delete C.z}else C.t="s",C.v=K;if(C.t=="z"||(x.dense?(p[w]||(p[w]=[]),p[w][v]=C):p[Ke({c:v,r:w})]=C),y=N+1,S=d.charCodeAt(y),m.e.c<v&&(m.e.c=v),m.e.r<w&&(m.e.r=w),k==F)++v;else if(v=0,++w,x.sheetRows&&x.sheetRows<=w)return!0}e:for(;N<d.length;++N)switch(k=d.charCodeAt(N)){case 34:S===34&&(j=!j);break;case F:case 10:case 13:if(!j&&D())break e;break}return N-y>0&&D(),p["!ref"]=et(m),p}function l(d,f){return!(f&&f.PRN)||f.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?i(d,f):Ei(t(d,f),f)}function c(d,f){var x="",h=f.type=="string"?[0,0,0,0]:Ff(d,f);switch(f.type){case"base64":x=cn(d);break;case"binary":x=d;break;case"buffer":f.codepage==65001?x=d.toString("utf8"):f.codepage&&typeof Ia<"u"?x=Ia.utils.decode(f.codepage,d):x=rt&&Buffer.isBuffer(d)?d.toString("binary"):rs(d);break;case"array":x=_s(d);break;case"string":x=d;break;default:throw new Error("Unrecognized type "+f.type)}return h[0]==239&&h[1]==187&&h[2]==191?x=vt(x.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?x=vt(x):f.type=="binary"&&typeof Ia<"u"&&f.codepage&&(x=Ia.utils.decode(f.codepage,Ia.utils.encode(28591,x))),x.slice(0,19)=="socialcalc:version:"?Mg.to_sheet(f.type=="string"?x:vt(x),f):l(x,f)}function o(d,f){return ns(c(d,f),f)}function u(d){for(var f=[],x=ut(d["!ref"]),h,p=Array.isArray(d),m=x.s.r;m<=x.e.r;++m){for(var w=[],v=x.s.c;v<=x.e.c;++v){var b=Ke({r:m,c:v});if(h=p?(d[m]||[])[v]:d[b],!h||h.v==null){w.push("          ");continue}for(var y=(h.w||(va(h),h.w)||"").slice(0,10);y.length<10;)y+=" ";w.push(y+(v===0?" ":""))}f.push(w.join(""))}return f.join(`
`)}return{to_workbook:o,to_sheet:c,from_sheet:u}}();function S4(e,t){var r=t||{},a=!!r.WTF;r.WTF=!0;try{var s=Dg.to_workbook(e,r);return r.WTF=a,s}catch(i){if(r.WTF=a,!i.message.match(/SYLK bad record ID/)&&a)throw i;return wi.to_workbook(e,t)}}var ps=function(){function e(O,I,g){if(O){hr(O,O.l||0);for(var _=g.Enum||ae;O.l<O.length;){var A=O.read_shift(2),ne=_[A]||_[65535],ue=O.read_shift(2),ve=O.l+ue,xe=ne.f&&ne.f(O,ue,g);if(O.l=ve,I(xe,ne,A))return}}}function t(O,I){switch(I.type){case"base64":return r(rn(cn(O)),I);case"binary":return r(rn(O),I);case"buffer":case"array":return r(O,I)}throw"Unsupported type "+I.type}function r(O,I){if(!O)return O;var g=I||{},_=g.dense?[]:{},A="Sheet1",ne="",ue=0,ve={},xe=[],W=[],E={s:{r:0,c:0},e:{r:0,c:0}},ke=g.sheetRows||0;if(O[2]==0&&(O[3]==8||O[3]==9)&&O.length>=16&&O[14]==5&&O[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(O[2]==2)g.Enum=ae,e(O,function(me,oe,Ie){switch(Ie){case 0:g.vers=me,me>=4096&&(g.qpro=!0);break;case 6:E=me;break;case 204:me&&(ne=me);break;case 222:ne=me;break;case 15:case 51:g.qpro||(me[1].v=me[1].v.slice(1));case 13:case 14:case 16:Ie==14&&(me[2]&112)==112&&(me[2]&15)>1&&(me[2]&15)<15&&(me[1].z=g.dateNF||Ge[14],g.cellDates&&(me[1].t="d",me[1].v=qo(me[1].v))),g.qpro&&me[3]>ue&&(_["!ref"]=et(E),ve[A]=_,xe.push(A),_=g.dense?[]:{},E={s:{r:0,c:0},e:{r:0,c:0}},ue=me[3],A=ne||"Sheet"+(ue+1),ne="");var Re=g.dense?(_[me[0].r]||[])[me[0].c]:_[Ke(me[0])];if(Re){Re.t=me[1].t,Re.v=me[1].v,me[1].z!=null&&(Re.z=me[1].z),me[1].f!=null&&(Re.f=me[1].f);break}g.dense?(_[me[0].r]||(_[me[0].r]=[]),_[me[0].r][me[0].c]=me[1]):_[Ke(me[0])]=me[1];break}},g);else if(O[2]==26||O[2]==14)g.Enum=he,O[2]==14&&(g.qpro=!0,O.l=0),e(O,function(me,oe,Ie){switch(Ie){case 204:A=me;break;case 22:me[1].v=me[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(me[3]>ue&&(_["!ref"]=et(E),ve[A]=_,xe.push(A),_=g.dense?[]:{},E={s:{r:0,c:0},e:{r:0,c:0}},ue=me[3],A="Sheet"+(ue+1)),ke>0&&me[0].r>=ke)break;g.dense?(_[me[0].r]||(_[me[0].r]=[]),_[me[0].r][me[0].c]=me[1]):_[Ke(me[0])]=me[1],E.e.c<me[0].c&&(E.e.c=me[0].c),E.e.r<me[0].r&&(E.e.r=me[0].r);break;case 27:me[14e3]&&(W[me[14e3][0]]=me[14e3][1]);break;case 1537:W[me[0]]=me[1],me[0]==ue&&(A=me[1]);break}},g);else throw new Error("Unrecognized LOTUS BOF "+O[2]);if(_["!ref"]=et(E),ve[ne||A]=_,xe.push(ne||A),!W.length)return{SheetNames:xe,Sheets:ve};for(var pe={},Ue=[],Ne=0;Ne<W.length;++Ne)ve[xe[Ne]]?(Ue.push(W[Ne]||xe[Ne]),pe[W[Ne]]=ve[W[Ne]]||ve[xe[Ne]]):(Ue.push(W[Ne]),pe[W[Ne]]={"!ref":"A1"});return{SheetNames:Ue,Sheets:pe}}function a(O,I){var g=I||{};if(+g.codepage>=0&&Rn(+g.codepage),g.type=="string")throw new Error("Cannot write WK1 to JS string");var _=qr(),A=ut(O["!ref"]),ne=Array.isArray(O),ue=[];De(_,0,i(1030)),De(_,6,o(A));for(var ve=Math.min(A.e.r,8191),xe=A.s.r;xe<=ve;++xe)for(var W=Gt(xe),E=A.s.c;E<=A.e.c;++E){xe===A.s.r&&(ue[E]=Mt(E));var ke=ue[E]+W,pe=ne?(O[xe]||[])[E]:O[ke];if(!(!pe||pe.t=="z"))if(pe.t=="n")(pe.v|0)==pe.v&&pe.v>=-32768&&pe.v<=32767?De(_,13,h(xe,E,pe.v)):De(_,14,m(xe,E,pe.v));else{var Ue=va(pe);De(_,15,f(xe,E,Ue.slice(0,239)))}}return De(_,1),_.end()}function s(O,I){var g=I||{};if(+g.codepage>=0&&Rn(+g.codepage),g.type=="string")throw new Error("Cannot write WK3 to JS string");var _=qr();De(_,0,l(O));for(var A=0,ne=0;A<O.SheetNames.length;++A)(O.Sheets[O.SheetNames[A]]||{})["!ref"]&&De(_,27,H(O.SheetNames[A],ne++));var ue=0;for(A=0;A<O.SheetNames.length;++A){var ve=O.Sheets[O.SheetNames[A]];if(!(!ve||!ve["!ref"])){for(var xe=ut(ve["!ref"]),W=Array.isArray(ve),E=[],ke=Math.min(xe.e.r,8191),pe=xe.s.r;pe<=ke;++pe)for(var Ue=Gt(pe),Ne=xe.s.c;Ne<=xe.e.c;++Ne){pe===xe.s.r&&(E[Ne]=Mt(Ne));var me=E[Ne]+Ue,oe=W?(ve[pe]||[])[Ne]:ve[me];if(!(!oe||oe.t=="z"))if(oe.t=="n")De(_,23,D(pe,Ne,ue,oe.v));else{var Ie=va(oe);De(_,22,k(pe,Ne,ue,Ie.slice(0,239)))}}++ue}}return De(_,1),_.end()}function i(O){var I=ye(2);return I.write_shift(2,O),I}function l(O){var I=ye(26);I.write_shift(2,4096),I.write_shift(2,4),I.write_shift(4,0);for(var g=0,_=0,A=0,ne=0;ne<O.SheetNames.length;++ne){var ue=O.SheetNames[ne],ve=O.Sheets[ue];if(!(!ve||!ve["!ref"])){++A;var xe=Jr(ve["!ref"]);g<xe.e.r&&(g=xe.e.r),_<xe.e.c&&(_=xe.e.c)}}return g>8191&&(g=8191),I.write_shift(2,g),I.write_shift(1,A),I.write_shift(1,_),I.write_shift(2,0),I.write_shift(2,0),I.write_shift(1,1),I.write_shift(1,2),I.write_shift(4,0),I.write_shift(4,0),I}function c(O,I,g){var _={s:{c:0,r:0},e:{c:0,r:0}};return I==8&&g.qpro?(_.s.c=O.read_shift(1),O.l++,_.s.r=O.read_shift(2),_.e.c=O.read_shift(1),O.l++,_.e.r=O.read_shift(2),_):(_.s.c=O.read_shift(2),_.s.r=O.read_shift(2),I==12&&g.qpro&&(O.l+=2),_.e.c=O.read_shift(2),_.e.r=O.read_shift(2),I==12&&g.qpro&&(O.l+=2),_.s.c==65535&&(_.s.c=_.e.c=_.s.r=_.e.r=0),_)}function o(O){var I=ye(8);return I.write_shift(2,O.s.c),I.write_shift(2,O.s.r),I.write_shift(2,O.e.c),I.write_shift(2,O.e.r),I}function u(O,I,g){var _=[{c:0,r:0},{t:"n",v:0},0,0];return g.qpro&&g.vers!=20768?(_[0].c=O.read_shift(1),_[3]=O.read_shift(1),_[0].r=O.read_shift(2),O.l+=2):(_[2]=O.read_shift(1),_[0].c=O.read_shift(2),_[0].r=O.read_shift(2)),_}function d(O,I,g){var _=O.l+I,A=u(O,I,g);if(A[1].t="s",g.vers==20768){O.l++;var ne=O.read_shift(1);return A[1].v=O.read_shift(ne,"utf8"),A}return g.qpro&&O.l++,A[1].v=O.read_shift(_-O.l,"cstr"),A}function f(O,I,g){var _=ye(7+g.length);_.write_shift(1,255),_.write_shift(2,I),_.write_shift(2,O),_.write_shift(1,39);for(var A=0;A<_.length;++A){var ne=g.charCodeAt(A);_.write_shift(1,ne>=128?95:ne)}return _.write_shift(1,0),_}function x(O,I,g){var _=u(O,I,g);return _[1].v=O.read_shift(2,"i"),_}function h(O,I,g){var _=ye(7);return _.write_shift(1,255),_.write_shift(2,I),_.write_shift(2,O),_.write_shift(2,g,"i"),_}function p(O,I,g){var _=u(O,I,g);return _[1].v=O.read_shift(8,"f"),_}function m(O,I,g){var _=ye(13);return _.write_shift(1,255),_.write_shift(2,I),_.write_shift(2,O),_.write_shift(8,g,"f"),_}function w(O,I,g){var _=O.l+I,A=u(O,I,g);if(A[1].v=O.read_shift(8,"f"),g.qpro)O.l=_;else{var ne=O.read_shift(2);N(O.slice(O.l,O.l+ne),A),O.l+=ne}return A}function v(O,I,g){var _=I&32768;return I&=-32769,I=(_?O:0)+(I>=8192?I-16384:I),(_?"":"$")+(g?Mt(I):Gt(I))}var b={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},y=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function N(O,I){hr(O,0);for(var g=[],_=0,A="",ne="",ue="",ve="";O.l<O.length;){var xe=O[O.l++];switch(xe){case 0:g.push(O.read_shift(8,"f"));break;case 1:ne=v(I[0].c,O.read_shift(2),!0),A=v(I[0].r,O.read_shift(2),!1),g.push(ne+A);break;case 2:{var W=v(I[0].c,O.read_shift(2),!0),E=v(I[0].r,O.read_shift(2),!1);ne=v(I[0].c,O.read_shift(2),!0),A=v(I[0].r,O.read_shift(2),!1),g.push(W+E+":"+ne+A)}break;case 3:if(O.l<O.length){console.error("WK1 premature formula end");return}break;case 4:g.push("("+g.pop()+")");break;case 5:g.push(O.read_shift(2));break;case 6:{for(var ke="";xe=O[O.l++];)ke+=String.fromCharCode(xe);g.push('"'+ke.replace(/"/g,'""')+'"')}break;case 8:g.push("-"+g.pop());break;case 23:g.push("+"+g.pop());break;case 22:g.push("NOT("+g.pop()+")");break;case 20:case 21:ve=g.pop(),ue=g.pop(),g.push(["AND","OR"][xe-20]+"("+ue+","+ve+")");break;default:if(xe<32&&y[xe])ve=g.pop(),ue=g.pop(),g.push(ue+y[xe]+ve);else if(b[xe]){if(_=b[xe][1],_==69&&(_=O[O.l++]),_>g.length){console.error("WK1 bad formula parse 0x"+xe.toString(16)+":|"+g.join("|")+"|");return}var pe=g.slice(-_);g.length-=_,g.push(b[xe][0]+"("+pe.join(",")+")")}else return xe<=7?console.error("WK1 invalid opcode "+xe.toString(16)):xe<=24?console.error("WK1 unsupported op "+xe.toString(16)):xe<=30?console.error("WK1 invalid opcode "+xe.toString(16)):xe<=115?console.error("WK1 unsupported function opcode "+xe.toString(16)):console.error("WK1 unrecognized opcode "+xe.toString(16))}}g.length==1?I[1].f=""+g[0]:console.error("WK1 bad formula parse |"+g.join("|")+"|")}function F(O){var I=[{c:0,r:0},{t:"n",v:0},0];return I[0].r=O.read_shift(2),I[3]=O[O.l++],I[0].c=O[O.l++],I}function j(O,I){var g=F(O);return g[1].t="s",g[1].v=O.read_shift(I-4,"cstr"),g}function k(O,I,g,_){var A=ye(6+_.length);A.write_shift(2,O),A.write_shift(1,g),A.write_shift(1,I),A.write_shift(1,39);for(var ne=0;ne<_.length;++ne){var ue=_.charCodeAt(ne);A.write_shift(1,ue>=128?95:ue)}return A.write_shift(1,0),A}function S(O,I){var g=F(O);g[1].v=O.read_shift(2);var _=g[1].v>>1;if(g[1].v&1)switch(_&7){case 0:_=(_>>3)*5e3;break;case 1:_=(_>>3)*500;break;case 2:_=(_>>3)/20;break;case 3:_=(_>>3)/200;break;case 4:_=(_>>3)/2e3;break;case 5:_=(_>>3)/2e4;break;case 6:_=(_>>3)/16;break;case 7:_=(_>>3)/64;break}return g[1].v=_,g}function P(O,I){var g=F(O),_=O.read_shift(4),A=O.read_shift(4),ne=O.read_shift(2);if(ne==65535)return _===0&&A===3221225472?(g[1].t="e",g[1].v=15):_===0&&A===3489660928?(g[1].t="e",g[1].v=42):g[1].v=0,g;var ue=ne&32768;return ne=(ne&32767)-16446,g[1].v=(1-ue*2)*(A*Math.pow(2,ne+32)+_*Math.pow(2,ne)),g}function D(O,I,g,_){var A=ye(14);if(A.write_shift(2,O),A.write_shift(1,g),A.write_shift(1,I),_==0)return A.write_shift(4,0),A.write_shift(4,0),A.write_shift(2,65535),A;var ne=0,ue=0,ve=0,xe=0;return _<0&&(ne=1,_=-_),ue=Math.log2(_)|0,_/=Math.pow(2,ue-31),xe=_>>>0,xe&2147483648||(_/=2,++ue,xe=_>>>0),_-=xe,xe|=2147483648,xe>>>=0,_*=Math.pow(2,32),ve=_>>>0,A.write_shift(4,ve),A.write_shift(4,xe),ue+=16383+(ne?32768:0),A.write_shift(2,ue),A}function K(O,I){var g=P(O);return O.l+=I-14,g}function C(O,I){var g=F(O),_=O.read_shift(4);return g[1].v=_>>6,g}function Y(O,I){var g=F(O),_=O.read_shift(8,"f");return g[1].v=_,g}function B(O,I){var g=Y(O);return O.l+=I-10,g}function ee(O,I){return O[O.l+I-1]==0?O.read_shift(I,"cstr"):""}function re(O,I){var g=O[O.l++];g>I-1&&(g=I-1);for(var _="";_.length<g;)_+=String.fromCharCode(O[O.l++]);return _}function Q(O,I,g){if(!(!g.qpro||I<21)){var _=O.read_shift(1);O.l+=17,O.l+=1,O.l+=2;var A=O.read_shift(I-21,"cstr");return[_,A]}}function te(O,I){for(var g={},_=O.l+I;O.l<_;){var A=O.read_shift(2);if(A==14e3){for(g[A]=[0,""],g[A][0]=O.read_shift(2);O[O.l];)g[A][1]+=String.fromCharCode(O[O.l]),O.l++;O.l++}}return g}function H(O,I){var g=ye(5+O.length);g.write_shift(2,14e3),g.write_shift(2,I);for(var _=0;_<O.length;++_){var A=O.charCodeAt(_);g[g.l++]=A>127?95:A}return g[g.l++]=0,g}var ae={0:{n:"BOF",f:qt},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:c},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:x},14:{n:"NUMBER",f:p},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:w},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ee},222:{n:"SHEETNAMELP",f:re},65535:{n:""}},he={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:j},23:{n:"NUMBER17",f:P},24:{n:"NUMBER18",f:S},25:{n:"FORMULA19",f:K},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:te},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:C},38:{n:"??"},39:{n:"NUMBER27",f:Y},40:{n:"FORMULA28",f:B},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ee},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Q},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:a,book_to_wk3:s,to_workbook:t}}();function C4(e){var t={},r=e.match(Ar),a=0,s=!1;if(r)for(;a!=r.length;++a){var i=Ye(r[a]);switch(i[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(i.val=="1")break;t.cp=Gu[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=i.val;break;case"<sz":t.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(i.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(i.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":i.rgb&&(t.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(i[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+i[0])}}return t}var E4=function(){var e=Pl("t"),t=Pl("rPr");function r(i){var l=i.match(e);if(!l)return{t:"s",v:""};var c={t:"s",v:dt(l[1])},o=i.match(t);return o&&(c.s=C4(o[1])),c}var a=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(l){return l.replace(a,"").split(s).map(r).filter(function(c){return c.v})}}(),T4=function(){var t=/(\r\n|\n)/g;function r(s,i,l){var c=[];s.u&&c.push("text-decoration: underline;"),s.uval&&c.push("text-underline-style:"+s.uval+";"),s.sz&&c.push("font-size:"+s.sz+"pt;"),s.outline&&c.push("text-effect: outline;"),s.shadow&&c.push("text-shadow: auto;"),i.push('<span style="'+c.join("")+'">'),s.b&&(i.push("<b>"),l.push("</b>")),s.i&&(i.push("<i>"),l.push("</i>")),s.strike&&(i.push("<s>"),l.push("</s>"));var o=s.valign||"";return o=="superscript"||o=="super"?o="sup":o=="subscript"&&(o="sub"),o!=""&&(i.push("<"+o+">"),l.push("</"+o+">")),l.push("</span>"),s}function a(s){var i=[[],s.v,[]];return s.v?(s.s&&r(s.s,i[0],i[2]),i[0].join("")+i[1].replace(t,"<br/>")+i[2].join("")):""}return function(i){return i.map(a).join("")}}(),F4=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,A4=/<(?:\w+:)?r>/,P4=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function gf(e,t){var r=t?t.cellHTML:!0,a={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(a.t=dt(vt(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),a.r=vt(e),r&&(a.h=rf(a.t))):e.match(A4)&&(a.r=vt(e),a.t=dt(vt((e.replace(P4,"").match(F4)||[]).join("").replace(Ar,""))),r&&(a.h=T4(E4(a.r)))),a):{t:""}}var D4=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,I4=/<(?:\w+:)?(?:si|sstItem)>/g,M4=/<\/(?:\w+:)?(?:si|sstItem)>/;function R4(e,t){var r=[],a="";if(!e)return r;var s=e.match(D4);if(s){a=s[2].replace(I4,"").split(M4);for(var i=0;i!=a.length;++i){var l=gf(a[i].trim(),t);l!=null&&(r[r.length]=l)}s=Ye(s[1]),r.Count=s.count,r.Unique=s.uniqueCount}return r}var O4=/^\s|\s$|[\t\n\r]/;function Rg(e,t){if(!t.bookSST)return"";var r=[Xt];r[r.length]=Ae("sst",null,{xmlns:Ps[0],count:e.Count,uniqueCount:e.Unique});for(var a=0;a!=e.length;++a)if(e[a]!=null){var s=e[a],i="<si>";s.r?i+=s.r:(i+="<t",s.t||(s.t=""),s.t.match(O4)&&(i+=' xml:space="preserve"'),i+=">"+pt(s.t)+"</t>"),i+="</si>",r[r.length]=i}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function L4(e){return[e.read_shift(4),e.read_shift(4)]}function B4(e,t){var r=[],a=!1;return wa(e,function(i,l,c){switch(c){case 159:r.Count=i[0],r.Unique=i[1];break;case 19:r.push(i);break;case 160:return!0;case 35:a=!0;break;case 36:a=!1;break;default:if(l.T,!a||t.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}),r}function U4(e,t){return t||(t=ye(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var z4=Jw;function W4(e){var t=qr();_e(t,159,U4(e));for(var r=0;r<e.length;++r)_e(t,19,z4(e[r]));return _e(t,160),t.end()}function Og(e){for(var t=[],r=e.split(""),a=0;a<r.length;++a)t[a]=r[a].charCodeAt(0);return t}function xa(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function H4(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=xa(e,4),t.U=xa(e,4),t.W=xa(e,4),t}function $4(e){for(var t=e.read_shift(4),r=e.l+t-4,a={},s=e.read_shift(4),i=[];s-- >0;)i.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(a.name=e.read_shift(0,"lpp4"),a.comps=i,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return a}function V4(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push($4(e));return t}function G4(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function X4(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=xa(e,4),t.U=xa(e,4),t.W=xa(e,4),t}function K4(e){var t=X4(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function Lg(e,t){var r=e.l+t,a={};a.Flags=e.read_shift(4)&63,e.l+=4,a.AlgID=e.read_shift(4);var s=!1;switch(a.AlgID){case 26126:case 26127:case 26128:s=a.Flags==36;break;case 26625:s=a.Flags==4;break;case 0:s=a.Flags==16||a.Flags==4||a.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+a.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return a.AlgIDHash=e.read_shift(4),a.KeySize=e.read_shift(4),a.ProviderType=e.read_shift(4),e.l+=8,a.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,a}function Bg(e,t){var r={},a=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,a),e.l=a,r}function Y4(e){var t=xa(e);switch(t.Minor){case 2:return[t.Minor,q4(e)];case 3:return[t.Minor,J4()];case 4:return[t.Minor,Q4(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function q4(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),a=Lg(e,r),s=Bg(e,e.length-e.l);return{t:"Std",h:a,v:s}}function J4(){throw new Error("File is password-protected: ECMA-376 Extensible")}function Q4(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),a={};return r.replace(Ar,function(i){var l=Ye(i);switch(ea(l[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(c){a[c]=l[c]});break;case"<dataIntegrity":a.encryptedHmacKey=l.encryptedHmacKey,a.encryptedHmacValue=l.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":a.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":a.uri=l.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":a.encs.push(l);break;default:throw l[0]}}),a}function Z4(e,t){var r={},a=r.EncryptionVersionInfo=xa(e,4);if(t-=4,a.Minor!=2)throw new Error("unrecognized minor version code: "+a.Minor);if(a.Major>4||a.Major<2)throw new Error("unrecognized major version code: "+a.Major);r.Flags=e.read_shift(4),t-=4;var s=e.read_shift(4);return t-=4,r.EncryptionHeader=Lg(e,s),t-=s,r.EncryptionVerifier=Bg(e,t),r}function ek(e){var t={},r=t.EncryptionVersionInfo=xa(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function vf(e){var t=0,r,a=Og(e),s=a.length+1,i,l,c,o,u;for(r=Ya(s),r[0]=a.length,i=1;i!=s;++i)r[i]=a[i-1];for(i=s-1;i>=0;--i)l=r[i],c=t&16384?1:0,o=t<<1&32767,u=c|o,t=u^l;return t^52811}var Ug=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],a=function(l){return(l/2|l*128)&255},s=function(l,c){return a(l^c)},i=function(l){for(var c=t[l.length-1],o=104,u=l.length-1;u>=0;--u)for(var d=l[u],f=0;f!=7;++f)d&64&&(c^=r[o]),d*=2,--o;return c};return function(l){for(var c=Og(l),o=i(c),u=c.length,d=Ya(16),f=0;f!=16;++f)d[f]=0;var x,h,p;for((u&1)===1&&(x=o>>8,d[u]=s(e[0],x),--u,x=o&255,h=c[c.length-1],d[u]=s(h,x));u>0;)--u,x=o>>8,d[u]=s(c[u],x),--u,x=o&255,d[u]=s(c[u],x);for(u=15,p=15-c.length;p>0;)x=o>>8,d[u]=s(e[p],x),--u,--p,x=o&255,d[u]=s(c[u],x),--u,--p;return d}}(),tk=function(e,t,r,a,s){s||(s=t),a||(a=Ug(e));var i,l;for(i=0;i!=t.length;++i)l=t[i],l^=a[r],l=(l>>5|l<<3)&255,s[i]=l,++r;return[s,r,a]},rk=function(e){var t=0,r=Ug(e);return function(a){var s=tk("",a,t,r);return t=s[1],s[0]}};function nk(e,t,r,a){var s={key:qt(e),verificationBytes:qt(e)};return r.password&&(s.verifier=vf(r.password)),a.valid=s.verificationBytes===s.verifier,a.valid&&(a.insitu=rk(r.password)),s}function ak(e,t,r){var a=r||{};return a.Info=e.read_shift(2),e.l-=2,a.Info===1?a.Data=ek(e):a.Data=Z4(e,t),a}function sk(e,t,r){var a={Type:r.biff>=8?e.read_shift(2):0};return a.Type?ak(e,t-2,a):nk(e,r.biff>=8?t:t-2,r,a),a}var zg=function(){function e(s,i){switch(i.type){case"base64":return t(cn(s),i);case"binary":return t(s,i);case"buffer":return t(rt&&Buffer.isBuffer(s)?s.toString("binary"):rs(s),i);case"array":return t(_s(s),i)}throw new Error("Unrecognized type "+i.type)}function t(s,i){var l=i||{},c=l.dense?[]:{},o=s.match(/\\trowd.*?\\row\b/g);if(!o.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:o.length-1}};return o.forEach(function(d,f){Array.isArray(c)&&(c[f]=[]);for(var x=/\\\w+\b/g,h=0,p,m=-1;p=x.exec(d);){switch(p[0]){case"\\cell":var w=d.slice(h,x.lastIndex-p[0].length);if(w[0]==" "&&(w=w.slice(1)),++m,w.length){var v={v:w,t:"s"};Array.isArray(c)?c[f][m]=v:c[Ke({r:f,c:m})]=v}break}h=x.lastIndex}m>u.e.c&&(u.e.c=m)}),c["!ref"]=et(u),c}function r(s,i){return ns(e(s,i),i)}function a(s){for(var i=["{\\rtf1\\ansi"],l=ut(s["!ref"]),c,o=Array.isArray(s),u=l.s.r;u<=l.e.r;++u){i.push("\\trowd\\trautofit1");for(var d=l.s.c;d<=l.e.c;++d)i.push("\\cellx"+(d+1));for(i.push("\\pard\\intbl"),d=l.s.c;d<=l.e.c;++d){var f=Ke({r:u,c:d});c=o?(s[u]||[])[d]:s[f],!(!c||c.v==null&&(!c.f||c.F))&&(i.push(" "+(c.w||(va(c),c.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:a}}();function ik(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function Rl(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function lk(e){var t=e[0]/255,r=e[1]/255,a=e[2]/255,s=Math.max(t,r,a),i=Math.min(t,r,a),l=s-i;if(l===0)return[0,0,t];var c=0,o=0,u=s+i;switch(o=l/(u>1?2-u:u),s){case t:c=((r-a)/l+6)%6;break;case r:c=(a-t)/l+2;break;case a:c=(t-r)/l+4;break}return[c/6,o,u/2]}function ck(e){var t=e[0],r=e[1],a=e[2],s=r*2*(a<.5?a:1-a),i=a-s/2,l=[i,i,i],c=6*t,o;if(r!==0)switch(c|0){case 0:case 6:o=s*c,l[0]+=s,l[1]+=o;break;case 1:o=s*(2-c),l[0]+=o,l[1]+=s;break;case 2:o=s*(c-2),l[1]+=s,l[2]+=o;break;case 3:o=s*(4-c),l[1]+=o,l[2]+=s;break;case 4:o=s*(c-4),l[2]+=s,l[0]+=o;break;case 5:o=s*(6-c),l[2]+=o,l[0]+=s;break}for(var u=0;u!=3;++u)l[u]=Math.round(l[u]*255);return l}function Co(e,t){if(t===0)return e;var r=lk(ik(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),Rl(ck(r))}var Wg=6,ok=15,dk=1,Sr=Wg;function Ol(e){return Math.floor((e+Math.round(128/Sr)/256)*Sr)}function Ll(e){return Math.floor((e-5)/Sr*100+.5)/100}function Eo(e){return Math.round((e*Sr+5)/Sr*256)/256}function D0(e){return Eo(Ll(Ol(e)))}function yf(e){var t=Math.abs(e-D0(e)),r=Sr;if(t>.005)for(Sr=dk;Sr<ok;++Sr)Math.abs(e-D0(e))<=t&&(t=Math.abs(e-D0(e)),r=Sr);Sr=r}function qa(e){e.width?(e.wpx=Ol(e.width),e.wch=Ll(e.wpx),e.MDW=Sr):e.wpx?(e.wch=Ll(e.wpx),e.width=Eo(e.wch),e.MDW=Sr):typeof e.wch=="number"&&(e.width=Eo(e.wch),e.wpx=Ol(e.width),e.MDW=Sr),e.customWidth&&delete e.customWidth}var uk=96,Hg=uk;function Bl(e){return e*96/Hg}function Ni(e){return e*Hg/96}var fk={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function xk(e,t,r,a){t.Borders=[];var s={},i=!1;(e[0].match(Ar)||[]).forEach(function(l){var c=Ye(l);switch(ea(c[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},c.diagonalUp&&(s.diagonalUp=_t(c.diagonalUp)),c.diagonalDown&&(s.diagonalDown=_t(c.diagonalDown)),t.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(a&&a.WTF&&!i)throw new Error("unrecognized "+c[0]+" in borders")}})}function mk(e,t,r,a){t.Fills=[];var s={},i=!1;(e[0].match(Ar)||[]).forEach(function(l){var c=Ye(l);switch(ea(c[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},t.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":c.patternType&&(s.patternType=c.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),c.indexed&&(s.bgColor.indexed=parseInt(c.indexed,10)),c.theme&&(s.bgColor.theme=parseInt(c.theme,10)),c.tint&&(s.bgColor.tint=parseFloat(c.tint)),c.rgb&&(s.bgColor.rgb=c.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),c.theme&&(s.fgColor.theme=parseInt(c.theme,10)),c.tint&&(s.fgColor.tint=parseFloat(c.tint)),c.rgb!=null&&(s.fgColor.rgb=c.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(a&&a.WTF&&!i)throw new Error("unrecognized "+c[0]+" in fills")}})}function hk(e,t,r,a){t.Fonts=[];var s={},i=!1;(e[0].match(Ar)||[]).forEach(function(l){var c=Ye(l);switch(ea(c[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(s),s={};break;case"<name":c.val&&(s.name=vt(c.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=c.val?_t(c.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=c.val?_t(c.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(c.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=c.val?_t(c.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=c.val?_t(c.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=c.val?_t(c.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=c.val?_t(c.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=c.val?_t(c.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":c.val&&(s.sz=+c.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":c.val&&(s.vertAlign=c.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":c.val&&(s.family=parseInt(c.val,10));break;case"<family/>":case"</family>":break;case"<scheme":c.val&&(s.scheme=c.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(c.val=="1")break;c.codepage=Gu[parseInt(c.val,10)];break;case"<color":if(s.color||(s.color={}),c.auto&&(s.color.auto=_t(c.auto)),c.rgb)s.color.rgb=c.rgb.slice(-6);else if(c.indexed){s.color.index=parseInt(c.indexed,10);var o=ms[s.color.index];s.color.index==81&&(o=ms[1]),o||(o=ms[1]),s.color.rgb=o[0].toString(16)+o[1].toString(16)+o[2].toString(16)}else c.theme&&(s.color.theme=parseInt(c.theme,10),c.tint&&(s.color.tint=parseFloat(c.tint)),c.theme&&r.themeElements&&r.themeElements.clrScheme&&(s.color.rgb=Co(r.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(a&&a.WTF&&!i)throw new Error("unrecognized "+c[0]+" in fonts")}})}function pk(e,t,r){t.NumberFmt=[];for(var a=Ht(Ge),s=0;s<a.length;++s)t.NumberFmt[a[s]]=Ge[a[s]];var i=e[0].match(Ar);if(i)for(s=0;s<i.length;++s){var l=Ye(i[s]);switch(ea(l[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var c=dt(vt(l.formatCode)),o=parseInt(l.numFmtId,10);if(t.NumberFmt[o]=c,o>0){if(o>392){for(o=392;o>60&&t.NumberFmt[o]!=null;--o);t.NumberFmt[o]=c}fa(c,o)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+l[0]+" in numFmts")}}}function gk(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var a=r[0];a<=r[1];++a)e[a]!=null&&(t[t.length]=Ae("numFmt",null,{numFmtId:a,formatCode:pt(e[a])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Ae("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var Sc=["numFmtId","fillId","fontId","borderId","xfId"],Cc=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function vk(e,t,r){t.CellXf=[];var a,s=!1;(e[0].match(Ar)||[]).forEach(function(i){var l=Ye(i),c=0;switch(ea(l[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(a=l,delete a[0],c=0;c<Sc.length;++c)a[Sc[c]]&&(a[Sc[c]]=parseInt(a[Sc[c]],10));for(c=0;c<Cc.length;++c)a[Cc[c]]&&(a[Cc[c]]=_t(a[Cc[c]]));if(t.NumberFmt&&a.numFmtId>392){for(c=392;c>60;--c)if(t.NumberFmt[a.numFmtId]==t.NumberFmt[c]){a.numFmtId=c;break}}t.CellXf.push(a);break;case"</xf>":break;case"<alignment":case"<alignment/>":var o={};l.vertical&&(o.vertical=l.vertical),l.horizontal&&(o.horizontal=l.horizontal),l.textRotation!=null&&(o.textRotation=l.textRotation),l.indent&&(o.indent=l.indent),l.wrapText&&(o.wrapText=_t(l.wrapText)),a.alignment=o;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+l[0]+" in cellXfs")}})}function yk(e){var t=[];return t[t.length]=Ae("cellXfs",null),e.forEach(function(r){t[t.length]=Ae("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Ae("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var bk=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,a=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(c,o,u){var d={};if(!c)return d;c=c.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var f;return(f=c.match(t))&&pk(f,d,u),(f=c.match(s))&&hk(f,d,o,u),(f=c.match(a))&&mk(f,d,o,u),(f=c.match(i))&&xk(f,d,o,u),(f=c.match(r))&&vk(f,d,u),d}}();function $g(e,t){var r=[Xt,Ae("styleSheet",null,{xmlns:Ps[0],"xmlns:vt":Zt.vt})],a;return e.SSF&&(a=gk(e.SSF))!=null&&(r[r.length]=a),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(a=yk(t.cellXfs))&&(r[r.length]=a),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function wk(e,t){var r=e.read_shift(2),a=Er(e);return[r,a]}function Nk(e,t,r){r||(r=ye(6+4*t.length)),r.write_shift(2,e),cr(t,r);var a=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),a}function jk(e,t,r){var a={};a.sz=e.read_shift(2)/20;var s=aN(e);s.fItalic&&(a.italic=1),s.fCondense&&(a.condense=1),s.fExtend&&(a.extend=1),s.fShadow&&(a.shadow=1),s.fOutline&&(a.outline=1),s.fStrikeout&&(a.strike=1);var i=e.read_shift(2);switch(i===700&&(a.bold=1),e.read_shift(2)){case 1:a.vertAlign="superscript";break;case 2:a.vertAlign="subscript";break}var l=e.read_shift(1);l!=0&&(a.underline=l);var c=e.read_shift(1);c>0&&(a.family=c);var o=e.read_shift(1);switch(o>0&&(a.charset=o),e.l++,a.color=nN(e),e.read_shift(1)){case 1:a.scheme="major";break;case 2:a.scheme="minor";break}return a.name=Er(e),a}function kk(e,t){t||(t=ye(25+4*32)),t.write_shift(2,e.sz*20),sN(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),ko(e.color,t);var a=0;return e.scheme=="major"&&(a=1),e.scheme=="minor"&&(a=2),t.write_shift(1,a),cr(e.name,t),t.length>t.l?t.slice(0,t.l):t}var _k=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],I0,Sk=Fr;function Bm(e,t){t||(t=ye(4*3+8*7+16*1)),I0||(I0=Ko(_k));var r=I0[e.patternType];r==null&&(r=40),t.write_shift(4,r);var a=0;if(r!=40)for(ko({auto:1},t),ko({auto:1},t);a<12;++a)t.write_shift(4,0);else{for(;a<4;++a)t.write_shift(4,0);for(;a<12;++a)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function Ck(e,t){var r=e.l+t,a=e.read_shift(2),s=e.read_shift(2);return e.l=r,{ixfe:a,numFmtId:s}}function Vg(e,t,r){r||(r=ye(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var a=0;return r.write_shift(1,a),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Bi(e,t){return t||(t=ye(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var Ek=Fr;function Tk(e,t){return t||(t=ye(51)),t.write_shift(1,0),Bi(null,t),Bi(null,t),Bi(null,t),Bi(null,t),Bi(null,t),t.length>t.l?t.slice(0,t.l):t}function Fk(e,t){return t||(t=ye(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,+e.builtinId),t.write_shift(1,0),jo(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function Ak(e,t,r){var a=ye(2052);return a.write_shift(4,e),jo(t,a),jo(r,a),a.length>a.l?a.slice(0,a.l):a}function Pk(e,t,r){var a={};a.NumberFmt=[];for(var s in Ge)a.NumberFmt[s]=Ge[s];a.CellXf=[],a.Fonts=[];var i=[],l=!1;return wa(e,function(o,u,d){switch(d){case 44:a.NumberFmt[o[0]]=o[1],fa(o[1],o[0]);break;case 43:a.Fonts.push(o),o.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(o.color.rgb=Co(t.themeElements.clrScheme[o.color.theme].rgb,o.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:i[i.length-1]==617&&a.CellXf.push(o);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:i.push(d),l=!0;break;case 38:i.pop(),l=!1;break;default:if(u.T>0)i.push(d);else if(u.T<0)i.pop();else if(!l||r.WTF&&i[i.length-1]!=37)throw new Error("Unexpected record 0x"+d.toString(16))}}),a}function Dk(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var s=a[0];s<=a[1];++s)t[s]!=null&&++r}),r!=0&&(_e(e,615,zn(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var s=a[0];s<=a[1];++s)t[s]!=null&&_e(e,44,Nk(s,t[s]))}),_e(e,616))}}function Ik(e){var t=1;_e(e,611,zn(t)),_e(e,43,kk({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),_e(e,612)}function Mk(e){var t=2;_e(e,603,zn(t)),_e(e,45,Bm({patternType:"none"})),_e(e,45,Bm({patternType:"gray125"})),_e(e,604)}function Rk(e){var t=1;_e(e,613,zn(t)),_e(e,46,Tk()),_e(e,614)}function Ok(e){var t=1;_e(e,626,zn(t)),_e(e,47,Vg({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),_e(e,627)}function Lk(e,t){_e(e,617,zn(t.length)),t.forEach(function(r){_e(e,47,Vg(r,0))}),_e(e,618)}function Bk(e){var t=1;_e(e,619,zn(t)),_e(e,48,Fk({xfId:0,builtinId:0,name:"Normal"})),_e(e,620)}function Uk(e){var t=0;_e(e,505,zn(t)),_e(e,506)}function zk(e){var t=0;_e(e,508,Ak(t,"TableStyleMedium9","PivotStyleMedium4")),_e(e,509)}function Wk(e,t){var r=qr();return _e(r,278),Dk(r,e.SSF),Ik(r),Mk(r),Rk(r),Ok(r),Lk(r,t.cellXfs),Bk(r),Uk(r),zk(r),_e(r,279),r.end()}var Hk=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function $k(e,t,r){t.themeElements.clrScheme=[];var a={};(e[0].match(Ar)||[]).forEach(function(s){var i=Ye(s);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":a.rgb=i.val;break;case"<a:sysClr":a.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":i[0].charAt(1)==="/"?(t.themeElements.clrScheme[Hk.indexOf(i[0])]=a,a={}):a.name=i[0].slice(3,i[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function Vk(){}function Gk(){}var Xk=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,Kk=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,Yk=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function qk(e,t,r){t.themeElements={};var a;[["clrScheme",Xk,$k],["fontScheme",Kk,Vk],["fmtScheme",Yk,Gk]].forEach(function(s){if(!(a=e.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](a,t,r)})}var Jk=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function Gg(e,t){(!e||e.length===0)&&(e=bf());var r,a={};if(!(r=e.match(Jk)))throw new Error("themeElements not found in theme");return qk(r[0],a,t),a.raw=e,a}function bf(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[Xt];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function Qk(e,t,r){var a=e.l+t,s=e.read_shift(4);if(s!==124226){if(!r.cellStyles){e.l=a;return}var i=e.slice(e.l);e.l=a;var l;try{l=L1(i,{type:"array"})}catch{return}var c=nn(l,"theme/theme/theme1.xml",!0);if(c)return Gg(c,r)}}function Zk(e){return e.read_shift(4)}function e5(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=t5(e,4);break;case 2:t.xclrValue=_g(e);break;case 3:t.xclrValue=Zk(e);break;case 4:e.l+=4;break}return e.l+=8,t}function t5(e,t){return Fr(e,t)}function r5(e,t){return Fr(e,t)}function n5(e){var t=e.read_shift(2),r=e.read_shift(2)-4,a=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:a[1]=e5(e);break;case 6:a[1]=r5(e,r);break;case 14:case 15:a[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return a}function a5(e,t){var r=e.l+t;e.l+=2;var a=e.read_shift(2);e.l+=2;for(var s=e.read_shift(2),i=[];s-- >0;)i.push(n5(e,r-e.l));return{ixfe:a,ext:i}}function s5(e,t){t.forEach(function(r){switch(r[0]){}})}function i5(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Er(e)}}function l5(e){var t=ye(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),cr(e.name,t),t.slice(0,t.l)}function c5(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function o5(e){var t=ye(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function d5(e,t){var r=ye(8+2*t.length);return r.write_shift(4,e),cr(t,r),r.slice(0,r.l)}function u5(e){return e.l+=4,e.read_shift(4)!=0}function f5(e,t){var r=ye(8);return r.write_shift(4,e),r.write_shift(4,1),r}function x5(e,t,r){var a={Types:[],Cell:[],Value:[]},s=r||{},i=[],l=!1,c=2;return wa(e,function(o,u,d){switch(d){case 335:a.Types.push({name:o.name});break;case 51:o.forEach(function(f){c==1?a.Cell.push({type:a.Types[f[0]-1].name,index:f[1]}):c==0&&a.Value.push({type:a.Types[f[0]-1].name,index:f[1]})});break;case 337:c=o?1:0;break;case 338:c=2;break;case 35:i.push(d),l=!0;break;case 36:i.pop(),l=!1;break;default:if(!u.T){if(!l||s.WTF&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}}),a}function m5(){var e=qr();return _e(e,332),_e(e,334,zn(1)),_e(e,335,l5({name:"XLDAPR",version:12e4,flags:3496657072})),_e(e,336),_e(e,339,d5(1,"XLDAPR")),_e(e,52),_e(e,35,zn(514)),_e(e,4096,zn(0)),_e(e,4097,gn(1)),_e(e,36),_e(e,53),_e(e,340),_e(e,337,f5(1)),_e(e,51,o5([[1,0]])),_e(e,338),_e(e,333),e.end()}function h5(e,t,r){var a={Types:[],Cell:[],Value:[]};if(!e)return a;var s=!1,i=2,l;return e.replace(Ar,function(c){var o=Ye(c);switch(ea(o[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":a.Types.push({name:o.name});break;case"</metadataType>":break;case"<futureMetadata":for(var u=0;u<a.Types.length;++u)a.Types[u].name==o.name&&(l=a.Types[u]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":i==1?a.Cell.push({type:a.Types[o.t-1].name,index:+o.v}):i==0&&a.Value.push({type:a.Types[o.t-1].name,index:+o.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!l)break;l.offsets||(l.offsets=[]),l.offsets.push(+o.i);break;default:if(!s&&r.WTF)throw new Error("unrecognized "+o[0]+" in metadata")}return c}),a}function Xg(){var e=[Xt];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function p5(e){var t=[];if(!e)return t;var r=1;return(e.match(Ar)||[]).forEach(function(a){var s=Ye(a);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?r=s.i:s.i=r,t.push(s);break}}),t}function g5(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Ke(r);var a=e.read_shift(1);return a&2&&(t.l="1"),a&8&&(t.a="1"),t}function v5(e,t,r){var a=[];return wa(e,function(i,l,c){switch(c){case 63:a.push(i);break;default:if(!l.T)throw new Error("Unexpected record 0x"+c.toString(16))}}),a}function y5(e,t,r,a){if(!e)return e;var s=a||{},i=!1;wa(e,function(c,o,u){switch(u){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(!o.T){if(!i||s.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}},s)}function b5(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var ti=1024;function Kg(e,t){for(var r=[21600,21600],a=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),s=[Ae("xml",null,{"xmlns:v":en.v,"xmlns:o":en.o,"xmlns:x":en.x,"xmlns:mv":en.mv}).replace(/\/>/,">"),Ae("o:shapelayout",Ae("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Ae("v:shapetype",[Ae("v:stroke",null,{joinstyle:"miter"}),Ae("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:a})];ti<e*1e3;)ti+=1e3;return t.forEach(function(i){var l=Rt(i[0]),c={color2:"#BEFF82",type:"gradient"};c.type=="gradient"&&(c.angle="-180");var o=c.type=="gradient"?Ae("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=Ae("v:fill",o,c),d={on:"t",obscured:"t"};++ti,s=s.concat(["<v:shape"+Dl({id:"_x0000_s"+ti,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(i[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,Ae("v:shadow",null,d),Ae("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",pr("x:Anchor",[l.c+1,0,l.r+1,0,l.c+3,20,l.r+5,20].join(",")),pr("x:AutoFill","False"),pr("x:Row",String(l.r)),pr("x:Column",String(l.c)),i[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),s.push("</xml>"),s.join("")}function Um(e,t,r,a){var s=Array.isArray(e),i;t.forEach(function(l){var c=Rt(l.ref);if(s?(e[c.r]||(e[c.r]=[]),i=e[c.r][c.c]):i=e[l.ref],!i){i={t:"z"},s?e[c.r][c.c]=i:e[l.ref]=i;var o=ut(e["!ref"]||"BDWGO1000001:A1");o.s.r>c.r&&(o.s.r=c.r),o.e.r<c.r&&(o.e.r=c.r),o.s.c>c.c&&(o.s.c=c.c),o.e.c<c.c&&(o.e.c=c.c);var u=et(o);u!==e["!ref"]&&(e["!ref"]=u)}i.c||(i.c=[]);var d={a:l.author,t:l.t,r:l.r,T:r};l.h&&(d.h=l.h);for(var f=i.c.length-1;f>=0;--f){if(!r&&i.c[f].T)return;r&&!i.c[f].T&&i.c.splice(f,1)}if(r&&a){for(f=0;f<a.length;++f)if(d.a==a[f].id){d.a=a[f].name||d.a;break}}i.c.push(d)})}function w5(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],a=[],s=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(l){if(!(l===""||l.trim()==="")){var c=l.match(/<(?:\w+:)?author[^>]*>(.*)/);c&&r.push(c[1])}});var i=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(l){if(!(l===""||l.trim()==="")){var c=l.match(/<(?:\w+:)?comment[^>]*>/);if(c){var o=Ye(c[0]),u={author:o.authorId&&r[o.authorId]||"sheetjsghost",ref:o.ref,guid:o.guid},d=Rt(o.ref);if(!(t.sheetRows&&t.sheetRows<=d.r)){var f=l.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),x=!!f&&!!f[1]&&gf(f[1])||{r:"",t:"",h:""};u.r=x.r,x.r=="<t></t>"&&(x.t=x.h=""),u.t=(x.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(u.h=x.h),a.push(u)}}}}),a}function Yg(e){var t=[Xt,Ae("comments",null,{xmlns:Ps[0]})],r=[];return t.push("<authors>"),e.forEach(function(a){a[1].forEach(function(s){var i=pt(s.a);r.indexOf(i)==-1&&(r.push(i),t.push("<author>"+i+"</author>")),s.T&&s.ID&&r.indexOf("tc="+s.ID)==-1&&(r.push("tc="+s.ID),t.push("<author>tc="+s.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(a){var s=0,i=[];if(a[1][0]&&a[1][0].T&&a[1][0].ID?s=r.indexOf("tc="+a[1][0].ID):a[1].forEach(function(o){o.a&&(s=r.indexOf(pt(o.a))),i.push(o.t||"")}),t.push('<comment ref="'+a[0]+'" authorId="'+s+'"><text>'),i.length<=1)t.push(pr("t",pt(i[0]||"")));else{for(var l=`Comment:
    `+i[0]+`
`,c=1;c<i.length;++c)l+=`Reply:
    `+i[c]+`
`;t.push(pr("t",pt(l)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function N5(e,t){var r=[],a=!1,s={},i=0;return e.replace(Ar,function(c,o){var u=Ye(c);switch(ea(u[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:u.personId,guid:u.id,ref:u.ref,T:1};break;case"</threadedComment>":s.t!=null&&r.push(s);break;case"<text>":case"<text":i=o+c.length;break;case"</text>":s.t=e.slice(i,o).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":a=!0;break;case"</mentions>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&t.WTF)throw new Error("unrecognized "+u[0]+" in threaded comments")}return c}),r}function j5(e,t,r){var a=[Xt,Ae("ThreadedComments",null,{xmlns:Zt.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(s){var i="";(s[1]||[]).forEach(function(l,c){if(!l.T){delete l.ID;return}l.a&&t.indexOf(l.a)==-1&&t.push(l.a);var o={ref:s[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};c==0?i=o.id:o.parentId=i,l.ID=o.id,l.a&&(o.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(l.a)).slice(-12)+"}"),a.push(Ae("threadedComment",pr("text",l.t||""),o))})}),a.push("</ThreadedComments>"),a.join("")}function k5(e,t){var r=[],a=!1;return e.replace(Ar,function(i){var l=Ye(i);switch(ea(l[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:l.displayname,id:l.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&t.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return i}),r}function _5(e){var t=[Xt,Ae("personList",null,{xmlns:Zt.TCMNT,"xmlns:x":Ps[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,a){t.push(Ae("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+a).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function S5(e){var t={};t.iauthor=e.read_shift(4);var r=Rs(e);return t.rfx=r.s,t.ref=Ke(r.s),e.l+=16,t}function C5(e,t){return t==null&&(t=ye(36)),t.write_shift(4,e[1].iauthor),Ti(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var E5=Er;function T5(e){return cr(e.slice(0,54))}function F5(e,t){var r=[],a=[],s={},i=!1;return wa(e,function(c,o,u){switch(u){case 632:a.push(c);break;case 635:s=c;break;case 637:s.t=c.t,s.h=c.h,s.r=c.r;break;case 636:if(s.author=a[s.iauthor],delete s.iauthor,t.sheetRows&&s.rfx&&t.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,r.push(s);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!o.T){if(!i||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}),r}function A5(e){var t=qr(),r=[];return _e(t,628),_e(t,630),e.forEach(function(a){a[1].forEach(function(s){r.indexOf(s.a)>-1||(r.push(s.a.slice(0,54)),_e(t,632,T5(s.a)))})}),_e(t,631),_e(t,633),e.forEach(function(a){a[1].forEach(function(s){s.iauthor=r.indexOf(s.a);var i={s:Rt(a[0]),e:Rt(a[0])};_e(t,635,C5([i,s])),s.t&&s.t.length>0&&_e(t,637,Zw(s)),_e(t,636),delete s.iauthor})}),_e(t,634),_e(t,629),t.end()}var P5="application/vnd.ms-office.vbaProject";function D5(e){var t=$e.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,a){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var s=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");$e.utils.cfb_add(t,s,e.FileIndex[a].content)}}),$e.write(t)}function I5(e,t){t.FullPaths.forEach(function(r,a){if(a!=0){var s=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");s.slice(-1)!=="/"&&$e.utils.cfb_add(e,s,t.FileIndex[a].content)}})}var qg=["xlsb","xlsm","xlam","biff8","xla"];function M5(){return{"!type":"dialog"}}function R5(){return{"!type":"dialog"}}function O5(){return{"!type":"macro"}}function L5(){return{"!type":"macro"}}var di=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(a,s,i,l){var c=!1,o=!1;i.length==0?o=!0:i.charAt(0)=="["&&(o=!0,i=i.slice(1,-1)),l.length==0?c=!0:l.charAt(0)=="["&&(c=!0,l=l.slice(1,-1));var u=i.length>0?parseInt(i,10)|0:0,d=l.length>0?parseInt(l,10)|0:0;return c?d+=t.c:--d,o?u+=t.r:--u,s+(c?"":"$")+Mt(d)+(o?"":"$")+Gt(u)}return function(s,i){return t=i,s.replace(e,r)}}(),wf=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Nf=function(){return function(t,r){return t.replace(wf,function(a,s,i,l,c,o){var u=cf(l)-(i?0:r.c),d=lf(o)-(c?0:r.r),f=d==0?"":c?d+1:"["+d+"]",x=u==0?"":i?u+1:"["+u+"]";return s+"R"+f+"C"+x})}}();function Jg(e,t){return e.replace(wf,function(r,a,s,i,l,c){return a+(s=="$"?s+i:Mt(cf(i)+t.c))+(l=="$"?l+c:Gt(lf(c)+t.r))})}function B5(e,t,r){var a=Jr(t),s=a.s,i=Rt(r),l={r:i.r-s.r,c:i.c-s.c};return Jg(e,l)}function U5(e){return e.length!=1}function zm(e){return e.replace(/_xlfn\./g,"")}function Kt(e){e.l+=1}function Ja(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function Qg(e,t,r){var a=2;if(r){if(r.biff>=2&&r.biff<=5)return Zg(e);r.biff==12&&(a=4)}var s=e.read_shift(a),i=e.read_shift(a),l=Ja(e),c=Ja(e);return{s:{r:s,c:l[0],cRel:l[1],rRel:l[2]},e:{r:i,c:c[0],cRel:c[1],rRel:c[2]}}}function Zg(e){var t=Ja(e),r=Ja(e),a=e.read_shift(1),s=e.read_shift(1);return{s:{r:t[0],c:a,cRel:t[1],rRel:t[2]},e:{r:r[0],c:s,cRel:r[1],rRel:r[2]}}}function z5(e,t,r){if(r.biff<8)return Zg(e);var a=e.read_shift(r.biff==12?4:2),s=e.read_shift(r.biff==12?4:2),i=Ja(e),l=Ja(e);return{s:{r:a,c:i[0],cRel:i[1],rRel:i[2]},e:{r:s,c:l[0],cRel:l[1],rRel:l[2]}}}function ev(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return W5(e);var a=e.read_shift(r&&r.biff==12?4:2),s=Ja(e);return{r:a,c:s[0],cRel:s[1],rRel:s[2]}}function W5(e){var t=Ja(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function H5(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function $5(e,t,r){var a=r&&r.biff?r.biff:8;if(a>=2&&a<=5)return V5(e);var s=e.read_shift(a>=12?4:2),i=e.read_shift(2),l=(i&16384)>>14,c=(i&32768)>>15;if(i&=16383,c==1)for(;s>524287;)s-=1048576;if(l==1)for(;i>8191;)i=i-16384;return{r:s,c:i,cRel:l,rRel:c}}function V5(e){var t=e.read_shift(2),r=e.read_shift(1),a=(t&32768)>>15,s=(t&16384)>>14;return t&=16383,a==1&&t>=8192&&(t=t-16384),s==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:s,rRel:a}}function G5(e,t,r){var a=(e[e.l++]&96)>>5,s=Qg(e,r.biff>=2&&r.biff<=5?6:8,r);return[a,s]}function X5(e,t,r){var a=(e[e.l++]&96)>>5,s=e.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}var l=Qg(e,i,r);return[a,s,l]}function K5(e,t,r){var a=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[a]}function Y5(e,t,r){var a=(e[e.l++]&96)>>5,s=e.read_shift(2),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}return e.l+=i,[a,s]}function q5(e,t,r){var a=(e[e.l++]&96)>>5,s=z5(e,t-1,r);return[a,s]}function J5(e,t,r){var a=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[a]}function Wm(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function Q5(e,t,r){e.l+=2;for(var a=e.read_shift(r&&r.biff==2?1:2),s=[],i=0;i<=a;++i)s.push(e.read_shift(r&&r.biff==2?1:2));return s}function Z5(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(r&&r.biff==2?1:2)]}function e3(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(r&&r.biff==2?1:2)]}function t3(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function r3(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[a]}function tv(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function n3(e){return e.read_shift(2),tv(e)}function a3(e){return e.read_shift(2),tv(e)}function s3(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var s=ev(e,0,r);return[a,s]}function i3(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var s=$5(e,0,r);return[a,s]}function l3(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var i=ev(e,0,r);return[a,s,i]}function c3(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(r&&r.biff<=3?1:2);return[u_[s],av[s],a]}function o3(e,t,r){var a=e[e.l++],s=e.read_shift(1),i=r&&r.biff<=3?[a==88?-1:0,e.read_shift(1)]:d3(e);return[s,(i[0]===0?av:d_)[i[1]]]}function d3(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function u3(e,t,r){e.l+=r&&r.biff==2?3:4}function f3(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var a=e.read_shift(2),s=e.read_shift(r&&r.biff==2?1:2);return[a,s]}function x3(e){return e.l++,Na[e.read_shift(1)]}function m3(e){return e.l++,e.read_shift(2)}function h3(e){return e.l++,e.read_shift(1)!==0}function p3(e){return e.l++,Cr(e)}function g3(e,t,r){return e.l++,ql(e,t-1,r)}function v3(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=$t(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=Na[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Cr(e);break;case 2:r[1]=Os(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function y3(e,t,r){for(var a=e.read_shift(r.biff==12?4:2),s=[],i=0;i!=a;++i)s.push((r.biff==12?Rs:Jo)(e));return s}function b3(e,t,r){var a=0,s=0;r.biff==12?(a=e.read_shift(4),s=e.read_shift(4)):(s=1+e.read_shift(1),a=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--a,--s==0&&(s=256));for(var i=0,l=[];i!=a&&(l[i]=[]);++i)for(var c=0;c!=s;++c)l[i][c]=v3(e,r.biff);return l}function w3(e,t,r){var a=e.read_shift(1)>>>5&3,s=!r||r.biff>=8?4:2,i=e.read_shift(s);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[a,0,i]}function N3(e,t,r){if(r.biff==5)return j3(e);var a=e.read_shift(1)>>>5&3,s=e.read_shift(2),i=e.read_shift(4);return[a,s,i]}function j3(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var a=e.read_shift(2);return e.l+=12,[t,r,a]}function k3(e,t,r){var a=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var s=e.read_shift(r&&r.biff==2?1:2);return[a,s]}function _3(e,t,r){var a=e.read_shift(1)>>>5&3,s=e.read_shift(r&&r.biff==2?1:2);return[a,s]}function S3(e,t,r){var a=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[a]}function C3(e,t,r){var a=(e[e.l++]&96)>>5,s=e.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return e.l+=i,[a,s]}var E3=Fr,T3=Fr,F3=Fr;function Ql(e,t,r){return e.l+=2,[H5(e)]}function jf(e){return e.l+=6,[]}var A3=Ql,P3=jf,D3=jf,I3=Ql;function rv(e){return e.l+=2,[qt(e),e.read_shift(2)&1]}var M3=Ql,R3=rv,O3=jf,L3=Ql,B3=Ql,U3=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function z3(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(4),s=e.read_shift(2),i=e.read_shift(2),l=U3[r>>2&31];return{ixti:t,coltype:r&3,rt:l,idx:a,c:s,C:i}}function W3(e){return e.l+=2,[e.read_shift(4)]}function H3(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function $3(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function V3(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function G3(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function X3(e){return e.l+=4,[0,0]}var Hm={1:{n:"PtgExp",f:f3},2:{n:"PtgTbl",f:F3},3:{n:"PtgAdd",f:Kt},4:{n:"PtgSub",f:Kt},5:{n:"PtgMul",f:Kt},6:{n:"PtgDiv",f:Kt},7:{n:"PtgPower",f:Kt},8:{n:"PtgConcat",f:Kt},9:{n:"PtgLt",f:Kt},10:{n:"PtgLe",f:Kt},11:{n:"PtgEq",f:Kt},12:{n:"PtgGe",f:Kt},13:{n:"PtgGt",f:Kt},14:{n:"PtgNe",f:Kt},15:{n:"PtgIsect",f:Kt},16:{n:"PtgUnion",f:Kt},17:{n:"PtgRange",f:Kt},18:{n:"PtgUplus",f:Kt},19:{n:"PtgUminus",f:Kt},20:{n:"PtgPercent",f:Kt},21:{n:"PtgParen",f:Kt},22:{n:"PtgMissArg",f:Kt},23:{n:"PtgStr",f:g3},26:{n:"PtgSheet",f:H3},27:{n:"PtgEndSheet",f:$3},28:{n:"PtgErr",f:x3},29:{n:"PtgBool",f:h3},30:{n:"PtgInt",f:m3},31:{n:"PtgNum",f:p3},32:{n:"PtgArray",f:J5},33:{n:"PtgFunc",f:c3},34:{n:"PtgFuncVar",f:o3},35:{n:"PtgName",f:w3},36:{n:"PtgRef",f:s3},37:{n:"PtgArea",f:G5},38:{n:"PtgMemArea",f:k3},39:{n:"PtgMemErr",f:E3},40:{n:"PtgMemNoMem",f:T3},41:{n:"PtgMemFunc",f:_3},42:{n:"PtgRefErr",f:S3},43:{n:"PtgAreaErr",f:K5},44:{n:"PtgRefN",f:i3},45:{n:"PtgAreaN",f:q5},46:{n:"PtgMemAreaN",f:V3},47:{n:"PtgMemNoMemN",f:G3},57:{n:"PtgNameX",f:N3},58:{n:"PtgRef3d",f:l3},59:{n:"PtgArea3d",f:X5},60:{n:"PtgRefErr3d",f:C3},61:{n:"PtgAreaErr3d",f:Y5},255:{}},K3={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Y3={1:{n:"PtgElfLel",f:rv},2:{n:"PtgElfRw",f:L3},3:{n:"PtgElfCol",f:A3},6:{n:"PtgElfRwV",f:B3},7:{n:"PtgElfColV",f:I3},10:{n:"PtgElfRadical",f:M3},11:{n:"PtgElfRadicalS",f:O3},13:{n:"PtgElfColS",f:P3},15:{n:"PtgElfColSV",f:D3},16:{n:"PtgElfRadicalLel",f:R3},25:{n:"PtgList",f:z3},29:{n:"PtgSxName",f:W3},255:{}},q3={0:{n:"PtgAttrNoop",f:X3},1:{n:"PtgAttrSemi",f:r3},2:{n:"PtgAttrIf",f:e3},4:{n:"PtgAttrChoose",f:Q5},8:{n:"PtgAttrGoto",f:Z5},16:{n:"PtgAttrSum",f:u3},32:{n:"PtgAttrBaxcel",f:Wm},33:{n:"PtgAttrBaxcel",f:Wm},64:{n:"PtgAttrSpace",f:n3},65:{n:"PtgAttrSpaceSemi",f:a3},128:{n:"PtgAttrIfError",f:t3},255:{}};function Zl(e,t,r,a){if(a.biff<8)return Fr(e,t);for(var s=e.l+t,i=[],l=0;l!==r.length;++l)switch(r[l][0]){case"PtgArray":r[l][1]=b3(e,0,a),i.push(r[l][1]);break;case"PtgMemArea":r[l][2]=y3(e,r[l][1],a),i.push(r[l][2]);break;case"PtgExp":a&&a.biff==12&&(r[l][1][1]=e.read_shift(4),i.push(r[l][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[l][0]}return t=s-e.l,t!==0&&i.push(Fr(e,t)),i}function ec(e,t,r){for(var a=e.l+t,s,i,l=[];a!=e.l;)t=a-e.l,i=e[e.l],s=Hm[i]||Hm[K3[i]],(i===24||i===25)&&(s=(i===24?Y3:q3)[e[e.l+1]]),!s||!s.f?Fr(e,t):l.push([s.n,s.f(e,t,r)]);return l}function J3(e){for(var t=[],r=0;r<e.length;++r){for(var a=e[r],s=[],i=0;i<a.length;++i){var l=a[i];if(l)switch(l[0]){case 2:s.push('"'+l[1].replace(/"/g,'""')+'"');break;default:s.push(l[1])}else s.push("")}t.push(s.join(","))}return t.join(";")}var Q3={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function Z3(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function nv(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var a=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!a)return"SH33TJSERR1";var s="";if(r.biff>8)switch(e[a[0]][0]){case 357:return s=a[1]==-1?"#REF":e.SheetNames[a[1]],a[1]==a[2]?s:s+":"+e.SheetNames[a[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[a[0]][0];case 355:default:return"SH33TJSSRC"+e[a[0]][0]}switch(e[a[0]][0][0]){case 1025:return s=a[1]==-1?"#REF":e.SheetNames[a[1]]||"SH33TJSERR3",a[1]==a[2]?s:s+":"+e.SheetNames[a[2]];case 14849:return e[a[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return e[a[0]][0][3]?(s=a[1]==-1?"#REF":e[a[0]][0][3][a[1]]||"SH33TJSERR4",a[1]==a[2]?s:s+":"+e[a[0]][0][3][a[2]]):"SH33TJSERR2"}}function $m(e,t,r){var a=nv(e,t,r);return a=="#REF"?a:Z3(a,r)}function kr(e,t,r,a,s){var i=s&&s.biff||8,l={s:{c:0,r:0},e:{c:0,r:0}},c=[],o,u,d,f=0,x=0,h,p="";if(!e[0]||!e[0][0])return"";for(var m=-1,w="",v=0,b=e[0].length;v<b;++v){var y=e[0][v];switch(y[0]){case"PtgUminus":c.push("-"+c.pop());break;case"PtgUplus":c.push("+"+c.pop());break;case"PtgPercent":c.push(c.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(o=c.pop(),u=c.pop(),m>=0){switch(e[0][m][1][0]){case 0:w=zt(" ",e[0][m][1][1]);break;case 1:w=zt("\r",e[0][m][1][1]);break;default:if(w="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}u=u+w,m=-1}c.push(u+Q3[y[0]]+o);break;case"PtgIsect":o=c.pop(),u=c.pop(),c.push(u+" "+o);break;case"PtgUnion":o=c.pop(),u=c.pop(),c.push(u+","+o);break;case"PtgRange":o=c.pop(),u=c.pop(),c.push(u+":"+o);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=nl(y[1][1],l,s),c.push(al(d,i));break;case"PtgRefN":d=r?nl(y[1][1],r,s):y[1][1],c.push(al(d,i));break;case"PtgRef3d":f=y[1][1],d=nl(y[1][2],l,s),p=$m(a,f,s),c.push(p+"!"+al(d,i));break;case"PtgFunc":case"PtgFuncVar":var N=y[1][0],F=y[1][1];N||(N=0),N&=127;var j=N==0?[]:c.slice(-N);c.length-=N,F==="User"&&(F=j.shift()),c.push(F+"("+j.join(",")+")");break;case"PtgBool":c.push(y[1]?"TRUE":"FALSE");break;case"PtgInt":c.push(y[1]);break;case"PtgNum":c.push(String(y[1]));break;case"PtgStr":c.push('"'+y[1].replace(/"/g,'""')+'"');break;case"PtgErr":c.push(y[1]);break;case"PtgAreaN":h=ym(y[1][1],r?{s:r}:l,s),c.push(F0(h,s));break;case"PtgArea":h=ym(y[1][1],l,s),c.push(F0(h,s));break;case"PtgArea3d":f=y[1][1],h=y[1][2],p=$m(a,f,s),c.push(p+"!"+F0(h,s));break;case"PtgAttrSum":c.push("SUM("+c.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":x=y[1][2];var k=(a.names||[])[x-1]||(a[0]||[])[x],S=k?k.Name:"SH33TJSNAME"+String(x);S&&S.slice(0,6)=="_xlfn."&&!s.xlfn&&(S=S.slice(6)),c.push(S);break;case"PtgNameX":var P=y[1][1];x=y[1][2];var D;if(s.biff<=5)P<0&&(P=-P),a[P]&&(D=a[P][x]);else{var K="";if(((a[P]||[])[0]||[])[0]==14849||(((a[P]||[])[0]||[])[0]==1025?a[P][x]&&a[P][x].itab>0&&(K=a.SheetNames[a[P][x].itab-1]+"!"):K=a.SheetNames[x-1]+"!"),a[P]&&a[P][x])K+=a[P][x].Name;else if(a[0]&&a[0][x])K+=a[0][x].Name;else{var C=(nv(a,P,s)||"").split(";;");C[x-1]?K=C[x-1]:K+="SH33TJSERRX"}c.push(K);break}D||(D={Name:"SH33TJSERRY"}),c.push(D.Name);break;case"PtgParen":var Y="(",B=")";if(m>=0){switch(w="",e[0][m][1][0]){case 2:Y=zt(" ",e[0][m][1][1])+Y;break;case 3:Y=zt("\r",e[0][m][1][1])+Y;break;case 4:B=zt(" ",e[0][m][1][1])+B;break;case 5:B=zt("\r",e[0][m][1][1])+B;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}m=-1}c.push(Y+c.pop()+B);break;case"PtgRefErr":c.push("#REF!");break;case"PtgRefErr3d":c.push("#REF!");break;case"PtgExp":d={c:y[1][1],r:y[1][0]};var ee={c:r.c,r:r.r};if(a.sharedf[Ke(d)]){var re=a.sharedf[Ke(d)];c.push(kr(re,l,ee,a,s))}else{var Q=!1;for(o=0;o!=a.arrayf.length;++o)if(u=a.arrayf[o],!(d.c<u[0].s.c||d.c>u[0].e.c)&&!(d.r<u[0].s.r||d.r>u[0].e.r)){c.push(kr(u[1],l,ee,a,s)),Q=!0;break}Q||c.push(y[1])}break;case"PtgArray":c.push("{"+J3(y[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":m=v;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":c.push("");break;case"PtgAreaErr":c.push("#REF!");break;case"PtgAreaErr3d":c.push("#REF!");break;case"PtgList":c.push("Table"+y[1].idx+"[#"+y[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(y));default:throw new Error("Unrecognized Formula Token: "+String(y))}var te=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&m>=0&&te.indexOf(e[0][v][0])==-1){y=e[0][m];var H=!0;switch(y[1][0]){case 4:H=!1;case 0:w=zt(" ",y[1][1]);break;case 5:H=!1;case 1:w=zt("\r",y[1][1]);break;default:if(w="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+y[1][0])}c.push((H?w:"")+c.pop()+(H?"":w)),m=-1}}if(c.length>1&&s.WTF)throw new Error("bad formula stack");return c[0]}function e_(e,t,r){var a=e.l+t,s=r.biff==2?1:2,i,l=e.read_shift(s);if(l==65535)return[[],Fr(e,t-2)];var c=ec(e,l,r);return t!==l+s&&(i=Zl(e,t-l-s,c,r)),e.l=a,[c,i]}function t_(e,t,r){var a=e.l+t,s=r.biff==2?1:2,i,l=e.read_shift(s);if(l==65535)return[[],Fr(e,t-2)];var c=ec(e,l,r);return t!==l+s&&(i=Zl(e,t-l-s,c,r)),e.l=a,[c,i]}function r_(e,t,r,a){var s=e.l+t,i=ec(e,a,r),l;return s!==e.l&&(l=Zl(e,s-e.l,i,r)),[i,l]}function n_(e,t,r){var a=e.l+t,s,i=e.read_shift(2),l=ec(e,i,r);return i==65535?[[],Fr(e,t-2)]:(t!==i+2&&(s=Zl(e,a-i-2,l,r)),[l,s])}function a_(e){var t;if(oa(e,e.l+6)!==65535)return[Cr(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function s_(e){if(e==null){var t=ye(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return Ss(e);return Ss(0)}function M0(e,t,r){var a=e.l+t,s=ta(e);r.biff==2&&++e.l;var i=a_(e),l=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var c=t_(e,a-e.l,r);return{cell:s,val:i[0],formula:c,shared:l>>3&1,tt:i[1]}}function i_(e,t,r,a,s){var i=Es(t,r,s),l=s_(e.v),c=ye(6),o=33;c.write_shift(2,o),c.write_shift(4,0);for(var u=ye(e.bf.length),d=0;d<e.bf.length;++d)u[d]=e.bf[d];var f=lr([i,l,c,u]);return f}function Qo(e,t,r){var a=e.read_shift(4),s=ec(e,a,r),i=e.read_shift(4),l=i>0?Zl(e,i,s,r):null;return[s,l]}var l_=Qo,Zo=Qo,c_=Qo,o_=Qo,d_={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},av={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},u_={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Vm(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function f_(e){var t="of:="+e.replace(wf,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function R0(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function x_(e){return e.replace(/\./,"!")}var il={},ui={},ll=typeof Map<"u";function kf(e,t,r){var a=0,s=e.length;if(r){if(ll?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var i=ll?r.get(t):r[t];a<i.length;++a)if(e[i[a]].t===t)return e.Count++,i[a]}}else for(;a<s;++a)if(e[a].t===t)return e.Count++,a;return e[s]={t},e.Count++,e.Unique++,r&&(ll?(r.has(t)||r.set(t,[]),r.get(t).push(s)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(s))),s}function e0(e,t){var r={min:e+1,max:e+1},a=-1;return t.MDW&&(Sr=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?a=Ll(t.wpx):t.wch!=null&&(a=t.wch),a>-1?(r.width=Eo(a),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function gs(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function as(e,t,r){var a=r.revssf[t.z!=null?t.z:"General"],s=60,i=e.length;if(a==null&&r.ssf){for(;s<392;++s)if(r.ssf[s]==null){fa(t.z,s),r.ssf[s]=t.z,r.revssf[t.z]=a=s;break}}for(s=0;s!=i;++s)if(e[s].numFmtId===a)return s;return e[i]={numFmtId:a,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function sv(e,t,r,a,s,i){try{a.cellNF&&(e.z=Ge[t])}catch(c){if(a.WTF)throw c}if(!(e.t==="z"&&!a.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=Tt(e.v)),(!a||a.cellText!==!1)&&e.t!=="z")try{if(Ge[t]==null&&fa(dw[t]||"General",t),e.t==="e")e.w=e.w||Na[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Al(e.v);else if(e.t==="d"){var l=tr(e.v);(l|0)===l?e.w=l.toString(10):e.w=Al(l)}else{if(e.v===void 0)return"";e.w=ks(e.v,ui)}else e.t==="d"?e.w=_n(t,tr(e.v),ui):e.w=_n(t,e.v,ui)}catch(c){if(a.WTF)throw c}if(a.cellStyles&&r!=null)try{e.s=i.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Co(s.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),a.WTF&&(e.s.fgColor.raw_rgb=s.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Co(s.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),a.WTF&&(e.s.bgColor.raw_rgb=s.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(c){if(a.WTF&&i.Fills)throw c}}}function m_(e,t,r){if(e&&e["!ref"]){var a=ut(e["!ref"]);if(a.e.c<a.s.c||a.e.r<a.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function h_(e,t){var r=ut(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=et(r))}var p_=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,g_=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,v_=/<(?:\w:)?hyperlink [^>]*>/mg,y_=/"(\w*:\w*)"/,b_=/<(?:\w:)?col\b[^>]*[\/]?>/g,w_=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,N_=/<(?:\w:)?pageMargins[^>]*\/>/g,iv=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,j_=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,k_=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function __(e,t,r,a,s,i,l){if(!e)return e;a||(a={"!id":{}});var c=t.dense?[]:{},o={s:{r:2e6,c:2e6},e:{r:0,c:0}},u="",d="",f=e.match(g_);f?(u=e.slice(0,f.index),d=e.slice(f.index+f[0].length)):u=d=e;var x=u.match(iv);x?_f(x[0],c,s,r):(x=u.match(j_))&&C_(x[0],x[1]||"",c,s,r);var h=(u.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(h>0){var p=u.slice(h,h+50).match(y_);p&&h_(c,p[1])}var m=u.match(k_);m&&m[1]&&U_(m[1],s);var w=[];if(t.cellStyles){var v=u.match(b_);v&&M_(w,v)}f&&H_(f[1],c,t,o,i,l);var b=d.match(w_);b&&(c["!autofilter"]=O_(b[0]));var y=[],N=d.match(p_);if(N)for(h=0;h!=N.length;++h)y[h]=ut(N[h].slice(N[h].indexOf('"')+1));var F=d.match(v_);F&&P_(c,F,a);var j=d.match(N_);if(j&&(c["!margins"]=D_(Ye(j[0]))),!c["!ref"]&&o.e.c>=o.s.c&&o.e.r>=o.s.r&&(c["!ref"]=et(o)),t.sheetRows>0&&c["!ref"]){var k=ut(c["!ref"]);t.sheetRows<=+k.e.r&&(k.e.r=t.sheetRows-1,k.e.r>o.e.r&&(k.e.r=o.e.r),k.e.r<k.s.r&&(k.s.r=k.e.r),k.e.c>o.e.c&&(k.e.c=o.e.c),k.e.c<k.s.c&&(k.s.c=k.e.c),c["!fullref"]=c["!ref"],c["!ref"]=et(k))}return w.length>0&&(c["!cols"]=w),y.length>0&&(c["!merges"]=y),c}function S_(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+et(e[r])+'"/>';return t+"</mergeCells>"}function _f(e,t,r,a){var s=Ye(e);r.Sheets[a]||(r.Sheets[a]={}),s.codeName&&(r.Sheets[a].CodeName=dt(vt(s.codeName)))}function C_(e,t,r,a,s){_f(e.slice(0,e.indexOf(">")),r,a,s)}function E_(e,t,r,a,s){var i=!1,l={},c=null;if(a.bookType!=="xlsx"&&t.vbaraw){var o=t.SheetNames[r];try{t.Workbook&&(o=t.Workbook.Sheets[r].CodeName||o)}catch{}i=!0,l.codeName=qn(pt(o))}if(e&&e["!outline"]){var u={summaryBelow:1,summaryRight:1};e["!outline"].above&&(u.summaryBelow=0),e["!outline"].left&&(u.summaryRight=0),c=(c||"")+Ae("outlinePr",null,u)}!i&&!c||(s[s.length]=Ae("sheetPr",c,l))}var T_=["objects","scenarios","selectLockedCells","selectUnlockedCells"],F_=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function A_(e){var t={sheet:1};return T_.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),F_.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=vf(e.password).toString(16).toUpperCase()),Ae("sheetProtection",null,t)}function P_(e,t,r){for(var a=Array.isArray(e),s=0;s!=t.length;++s){var i=Ye(vt(t[s]),!0);if(!i.ref)return;var l=((r||{})["!id"]||[])[i.id];l?(i.Target=l.Target,i.location&&(i.Target+="#"+dt(i.location))):(i.Target="#"+dt(i.location),l={Target:i.Target,TargetMode:"Internal"}),i.Rel=l,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var c=ut(i.ref),o=c.s.r;o<=c.e.r;++o)for(var u=c.s.c;u<=c.e.c;++u){var d=Ke({c:u,r:o});a?(e[o]||(e[o]=[]),e[o][u]||(e[o][u]={t:"z",v:void 0}),e[o][u].l=i):(e[d]||(e[d]={t:"z",v:void 0}),e[d].l=i)}}}function D_(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function I_(e){return gs(e),Ae("pageMargins",null,e)}function M_(e,t){for(var r=!1,a=0;a!=t.length;++a){var s=Ye(t[a],!0);s.hidden&&(s.hidden=_t(s.hidden));var i=parseInt(s.min,10)-1,l=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!r&&s.width&&(r=!0,yf(s.width)),qa(s);i<=l;)e[i++]=Ft(s)}}function R_(e,t){for(var r=["<cols>"],a,s=0;s!=t.length;++s)(a=t[s])&&(r[r.length]=Ae("col",null,e0(s,a)));return r[r.length]="</cols>",r.join("")}function O_(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function L_(e,t,r,a){var s=typeof e.ref=="string"?e.ref:et(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,l=Jr(s);l.s.r==l.e.r&&(l.e.r=Jr(t["!ref"]).e.r,s=et(l));for(var c=0;c<i.length;++c){var o=i[c];if(o.Name=="_xlnm._FilterDatabase"&&o.Sheet==a){o.Ref="'"+r.SheetNames[a]+"'!"+s;break}}return c==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+r.SheetNames[a]+"'!"+s}),Ae("autoFilter",null,{ref:s})}var B_=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function U_(e,t){t.Views||(t.Views=[{}]),(e.match(B_)||[]).forEach(function(r,a){var s=Ye(r);t.Views[a]||(t.Views[a]={}),+s.zoomScale&&(t.Views[a].zoom=+s.zoomScale),_t(s.rightToLeft)&&(t.Views[a].RTL=!0)})}function z_(e,t,r,a){var s={workbookViewId:"0"};return(((a||{}).Workbook||{}).Views||[])[0]&&(s.rightToLeft=a.Workbook.Views[0].RTL?"1":"0"),Ae("sheetViews",Ae("sheetView",null,s),{})}function W_(e,t,r,a){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var s="",i=e.t,l=e.v;if(e.t!=="z")switch(e.t){case"b":s=e.v?"1":"0";break;case"n":s=""+e.v;break;case"e":s=Na[e.v];break;case"d":a&&a.cellDates?s=Tt(e.v,-1).toISOString():(e=Ft(e),e.t="n",s=""+(e.v=tr(Tt(e.v)))),typeof e.z>"u"&&(e.z=Ge[14]);break;default:s=e.v;break}var c=pr("v",pt(s)),o={r:t},u=as(a.cellXfs,e,a);switch(u!==0&&(o.s=u),e.t){case"n":break;case"d":o.t="d";break;case"b":o.t="b";break;case"e":o.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(a&&a.bookSST){c=pr("v",""+kf(a.Strings,e.v,a.revStrings)),o.t="s";break}o.t="str";break}if(e.t!=i&&(e.t=i,e.v=l),typeof e.f=="string"&&e.f){var d=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;c=Ae("f",pt(e.f),d)+(e.v!=null?c:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(o.cm=1),Ae("c",c,o)}var H_=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,a=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,i=Pl("v"),l=Pl("f");return function(o,u,d,f,x,h){for(var p=0,m="",w=[],v=[],b=0,y=0,N=0,F="",j,k,S=0,P=0,D,K,C=0,Y=0,B=Array.isArray(h.CellXf),ee,re=[],Q=[],te=Array.isArray(u),H=[],ae={},he=!1,O=!!d.sheetStubs,I=o.split(t),g=0,_=I.length;g!=_;++g){m=I[g].trim();var A=m.length;if(A!==0){var ne=0;e:for(p=0;p<A;++p)switch(m[p]){case">":if(m[p-1]!="/"){++p;break e}if(d&&d.cellStyles){if(k=Ye(m.slice(ne,p),!0),S=k.r!=null?parseInt(k.r,10):S+1,P=-1,d.sheetRows&&d.sheetRows<S)continue;ae={},he=!1,k.ht&&(he=!0,ae.hpt=parseFloat(k.ht),ae.hpx=Ni(ae.hpt)),k.hidden=="1"&&(he=!0,ae.hidden=!0),k.outlineLevel!=null&&(he=!0,ae.level=+k.outlineLevel),he&&(H[S-1]=ae)}break;case"<":ne=p;break}if(ne>=p)break;if(k=Ye(m.slice(ne,p),!0),S=k.r!=null?parseInt(k.r,10):S+1,P=-1,!(d.sheetRows&&d.sheetRows<S)){f.s.r>S-1&&(f.s.r=S-1),f.e.r<S-1&&(f.e.r=S-1),d&&d.cellStyles&&(ae={},he=!1,k.ht&&(he=!0,ae.hpt=parseFloat(k.ht),ae.hpx=Ni(ae.hpt)),k.hidden=="1"&&(he=!0,ae.hidden=!0),k.outlineLevel!=null&&(he=!0,ae.level=+k.outlineLevel),he&&(H[S-1]=ae)),w=m.slice(p).split(e);for(var ue=0;ue!=w.length&&w[ue].trim().charAt(0)=="<";++ue);for(w=w.slice(ue),p=0;p!=w.length;++p)if(m=w[p].trim(),m.length!==0){if(v=m.match(r),b=p,y=0,N=0,m="<c "+(m.slice(0,1)=="<"?">":"")+m,v!=null&&v.length===2){for(b=0,F=v[1],y=0;y!=F.length&&!((N=F.charCodeAt(y)-64)<1||N>26);++y)b=26*b+N;--b,P=b}else++P;for(y=0;y!=m.length&&m.charCodeAt(y)!==62;++y);if(++y,k=Ye(m.slice(0,y),!0),k.r||(k.r=Ke({r:S-1,c:P})),F=m.slice(y),j={t:""},(v=F.match(i))!=null&&v[1]!==""&&(j.v=dt(v[1])),d.cellFormula){if((v=F.match(l))!=null&&v[1]!==""){if(j.f=dt(vt(v[1])).replace(/\r\n/g,`
`),d.xlfn||(j.f=zm(j.f)),v[0].indexOf('t="array"')>-1)j.F=(F.match(s)||[])[1],j.F.indexOf(":")>-1&&re.push([ut(j.F),j.F]);else if(v[0].indexOf('t="shared"')>-1){K=Ye(v[0]);var ve=dt(vt(v[1]));d.xlfn||(ve=zm(ve)),Q[parseInt(K.si,10)]=[K,ve,k.r]}}else(v=F.match(/<f[^>]*\/>/))&&(K=Ye(v[0]),Q[K.si]&&(j.f=B5(Q[K.si][1],Q[K.si][2],k.r)));var xe=Rt(k.r);for(y=0;y<re.length;++y)xe.r>=re[y][0].s.r&&xe.r<=re[y][0].e.r&&xe.c>=re[y][0].s.c&&xe.c<=re[y][0].e.c&&(j.F=re[y][1])}if(k.t==null&&j.v===void 0)if(j.f||j.F)j.v=0,j.t="n";else if(O)j.t="z";else continue;else j.t=k.t||"n";switch(f.s.c>P&&(f.s.c=P),f.e.c<P&&(f.e.c=P),j.t){case"n":if(j.v==""||j.v==null){if(!O)continue;j.t="z"}else j.v=parseFloat(j.v);break;case"s":if(typeof j.v>"u"){if(!O)continue;j.t="z"}else D=il[parseInt(j.v,10)],j.v=D.t,j.r=D.r,d.cellHTML&&(j.h=D.h);break;case"str":j.t="s",j.v=j.v!=null?vt(j.v):"",d.cellHTML&&(j.h=rf(j.v));break;case"inlineStr":v=F.match(a),j.t="s",v!=null&&(D=gf(v[1]))?(j.v=D.t,d.cellHTML&&(j.h=D.h)):j.v="";break;case"b":j.v=_t(j.v);break;case"d":d.cellDates?j.v=Tt(j.v,1):(j.v=tr(Tt(j.v,1)),j.t="n");break;case"e":(!d||d.cellText!==!1)&&(j.w=j.v),j.v=cg[j.v];break}if(C=Y=0,ee=null,B&&k.s!==void 0&&(ee=h.CellXf[k.s],ee!=null&&(ee.numFmtId!=null&&(C=ee.numFmtId),d.cellStyles&&ee.fillId!=null&&(Y=ee.fillId))),sv(j,C,Y,d,x,h),d.cellDates&&B&&j.t=="n"&&Si(Ge[C])&&(j.t="d",j.v=qo(j.v)),k.cm&&d.xlmeta){var W=(d.xlmeta.Cell||[])[+k.cm-1];W&&W.type=="XLDAPR"&&(j.D=!0)}if(te){var E=Rt(k.r);u[E.r]||(u[E.r]=[]),u[E.r][E.c]=j}else u[k.r]=j}}}}H.length>0&&(u["!rows"]=H)}}();function $_(e,t,r,a){var s=[],i=[],l=ut(e["!ref"]),c="",o,u="",d=[],f=0,x=0,h=e["!rows"],p=Array.isArray(e),m={r:u},w,v=-1;for(x=l.s.c;x<=l.e.c;++x)d[x]=Mt(x);for(f=l.s.r;f<=l.e.r;++f){for(i=[],u=Gt(f),x=l.s.c;x<=l.e.c;++x){o=d[x]+u;var b=p?(e[f]||[])[x]:e[o];b!==void 0&&(c=W_(b,o,e,t))!=null&&i.push(c)}(i.length>0||h&&h[f])&&(m={r:u},h&&h[f]&&(w=h[f],w.hidden&&(m.hidden=1),v=-1,w.hpx?v=Bl(w.hpx):w.hpt&&(v=w.hpt),v>-1&&(m.ht=v,m.customHeight=1),w.level&&(m.outlineLevel=w.level)),s[s.length]=Ae("row",i.join(""),m))}if(h)for(;f<h.length;++f)h&&h[f]&&(m={r:f+1},w=h[f],w.hidden&&(m.hidden=1),v=-1,w.hpx?v=Bl(w.hpx):w.hpt&&(v=w.hpt),v>-1&&(m.ht=v,m.customHeight=1),w.level&&(m.outlineLevel=w.level),s[s.length]=Ae("row","",m));return s.join("")}function lv(e,t,r,a){var s=[Xt,Ae("worksheet",null,{xmlns:Ps[0],"xmlns:r":Zt.r})],i=r.SheetNames[e],l=0,c="",o=r.Sheets[i];o==null&&(o={});var u=o["!ref"]||"A1",d=ut(u);if(d.e.c>16383||d.e.r>1048575){if(t.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),u=et(d)}a||(a={}),o["!comments"]=[];var f=[];E_(o,r,e,t,s),s[s.length]=Ae("dimension",null,{ref:u}),s[s.length]=z_(o,t,e,r),t.sheetFormat&&(s[s.length]=Ae("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),o["!cols"]!=null&&o["!cols"].length>0&&(s[s.length]=R_(o,o["!cols"])),s[l=s.length]="<sheetData/>",o["!links"]=[],o["!ref"]!=null&&(c=$_(o,t),c.length>0&&(s[s.length]=c)),s.length>l+1&&(s[s.length]="</sheetData>",s[l]=s[l].replace("/>",">")),o["!protect"]&&(s[s.length]=A_(o["!protect"])),o["!autofilter"]!=null&&(s[s.length]=L_(o["!autofilter"],o,r,e)),o["!merges"]!=null&&o["!merges"].length>0&&(s[s.length]=S_(o["!merges"]));var x=-1,h,p=-1;return o["!links"].length>0&&(s[s.length]="<hyperlinks>",o["!links"].forEach(function(m){m[1].Target&&(h={ref:m[0]},m[1].Target.charAt(0)!="#"&&(p=ht(a,-1,pt(m[1].Target).replace(/#.*$/,""),st.HLINK),h["r:id"]="rId"+p),(x=m[1].Target.indexOf("#"))>-1&&(h.location=pt(m[1].Target.slice(x+1))),m[1].Tooltip&&(h.tooltip=pt(m[1].Tooltip)),s[s.length]=Ae("hyperlink",null,h))}),s[s.length]="</hyperlinks>"),delete o["!links"],o["!margins"]!=null&&(s[s.length]=I_(o["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(s[s.length]=pr("ignoredErrors",Ae("ignoredError",null,{numberStoredAsText:1,sqref:u}))),f.length>0&&(p=ht(a,-1,"../drawings/drawing"+(e+1)+".xml",st.DRAW),s[s.length]=Ae("drawing",null,{"r:id":"rId"+p}),o["!drawing"]=f),o["!comments"].length>0&&(p=ht(a,-1,"../drawings/vmlDrawing"+(e+1)+".vml",st.VML),s[s.length]=Ae("legacyDrawing",null,{"r:id":"rId"+p}),o["!legacy"]=p),s.length>1&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function V_(e,t){var r={},a=e.l+t;r.r=e.read_shift(4),e.l+=4;var s=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=a,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=s/20),r}function G_(e,t,r){var a=ye(145),s=(r["!rows"]||[])[e]||{};a.write_shift(4,e),a.write_shift(4,0);var i=320;s.hpx?i=Bl(s.hpx)*20:s.hpt&&(i=s.hpt*20),a.write_shift(2,i),a.write_shift(1,0);var l=0;s.level&&(l|=s.level),s.hidden&&(l|=16),(s.hpx||s.hpt)&&(l|=32),a.write_shift(1,l),a.write_shift(1,0);var c=0,o=a.l;a.l+=4;for(var u={r:e,c:0},d=0;d<16;++d)if(!(t.s.c>d+1<<10||t.e.c<d<<10)){for(var f=-1,x=-1,h=d<<10;h<d+1<<10;++h){u.c=h;var p=Array.isArray(r)?(r[u.r]||[])[u.c]:r[Ke(u)];p&&(f<0&&(f=h),x=h)}f<0||(++c,a.write_shift(4,f),a.write_shift(4,x))}var m=a.l;return a.l=o,a.write_shift(4,c),a.l=m,a.length>a.l?a.slice(0,a.l):a}function X_(e,t,r,a){var s=G_(a,r,t);(s.length>17||(t["!rows"]||[])[a])&&_e(e,0,s)}var K_=Rs,Y_=Ti;function q_(){}function J_(e,t){var r={},a=e[e.l];return++e.l,r.above=!(a&64),r.left=!(a&128),e.l+=18,r.name=eN(e),r}function Q_(e,t,r){r==null&&(r=ye(84+4*e.length));var a=192;t&&(t.above&&(a&=-65),t.left&&(a&=-129)),r.write_shift(1,a);for(var s=1;s<3;++s)r.write_shift(1,0);return ko({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),ng(e,r),r.slice(0,r.l)}function Z_(e){var t=Sn(e);return[t]}function eS(e,t,r){return r==null&&(r=ye(8)),Ds(t,r)}function tS(e){var t=Is(e);return[t]}function rS(e,t,r){return r==null&&(r=ye(4)),Ms(t,r)}function nS(e){var t=Sn(e),r=e.read_shift(1);return[t,r,"b"]}function aS(e,t,r){return r==null&&(r=ye(9)),Ds(t,r),r.write_shift(1,e.v?1:0),r}function sS(e){var t=Is(e),r=e.read_shift(1);return[t,r,"b"]}function iS(e,t,r){return r==null&&(r=ye(5)),Ms(t,r),r.write_shift(1,e.v?1:0),r}function lS(e){var t=Sn(e),r=e.read_shift(1);return[t,r,"e"]}function cS(e,t,r){return r==null&&(r=ye(9)),Ds(t,r),r.write_shift(1,e.v),r}function oS(e){var t=Is(e),r=e.read_shift(1);return[t,r,"e"]}function dS(e,t,r){return r==null&&(r=ye(8)),Ms(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function uS(e){var t=Sn(e),r=e.read_shift(4);return[t,r,"s"]}function fS(e,t,r){return r==null&&(r=ye(12)),Ds(t,r),r.write_shift(4,t.v),r}function xS(e){var t=Is(e),r=e.read_shift(4);return[t,r,"s"]}function mS(e,t,r){return r==null&&(r=ye(8)),Ms(t,r),r.write_shift(4,t.v),r}function hS(e){var t=Sn(e),r=Cr(e);return[t,r,"n"]}function pS(e,t,r){return r==null&&(r=ye(16)),Ds(t,r),Ss(e.v,r),r}function cv(e){var t=Is(e),r=Cr(e);return[t,r,"n"]}function gS(e,t,r){return r==null&&(r=ye(12)),Ms(t,r),Ss(e.v,r),r}function vS(e){var t=Sn(e),r=ff(e);return[t,r,"n"]}function yS(e,t,r){return r==null&&(r=ye(12)),Ds(t,r),ag(e.v,r),r}function bS(e){var t=Is(e),r=ff(e);return[t,r,"n"]}function wS(e,t,r){return r==null&&(r=ye(8)),Ms(t,r),ag(e.v,r),r}function NS(e){var t=Sn(e),r=of(e);return[t,r,"is"]}function jS(e){var t=Sn(e),r=Er(e);return[t,r,"str"]}function kS(e,t,r){return r==null&&(r=ye(12+4*e.v.length)),Ds(t,r),cr(e.v,r),r.length>r.l?r.slice(0,r.l):r}function _S(e){var t=Is(e),r=Er(e);return[t,r,"str"]}function SS(e,t,r){return r==null&&(r=ye(8+4*e.v.length)),Ms(t,r),cr(e.v,r),r.length>r.l?r.slice(0,r.l):r}function CS(e,t,r){var a=e.l+t,s=Sn(e);s.r=r["!row"];var i=e.read_shift(1),l=[s,i,"b"];if(r.cellFormula){e.l+=2;var c=Zo(e,a-e.l,r);l[3]=kr(c,null,s,r.supbooks,r)}else e.l=a;return l}function ES(e,t,r){var a=e.l+t,s=Sn(e);s.r=r["!row"];var i=e.read_shift(1),l=[s,i,"e"];if(r.cellFormula){e.l+=2;var c=Zo(e,a-e.l,r);l[3]=kr(c,null,s,r.supbooks,r)}else e.l=a;return l}function TS(e,t,r){var a=e.l+t,s=Sn(e);s.r=r["!row"];var i=Cr(e),l=[s,i,"n"];if(r.cellFormula){e.l+=2;var c=Zo(e,a-e.l,r);l[3]=kr(c,null,s,r.supbooks,r)}else e.l=a;return l}function FS(e,t,r){var a=e.l+t,s=Sn(e);s.r=r["!row"];var i=Er(e),l=[s,i,"str"];if(r.cellFormula){e.l+=2;var c=Zo(e,a-e.l,r);l[3]=kr(c,null,s,r.supbooks,r)}else e.l=a;return l}var AS=Rs,PS=Ti;function DS(e,t){return t==null&&(t=ye(4)),t.write_shift(4,e),t}function IS(e,t){var r=e.l+t,a=Rs(e),s=df(e),i=Er(e),l=Er(e),c=Er(e);e.l=r;var o={rfx:a,relId:s,loc:i,display:c};return l&&(o.Tooltip=l),o}function MS(e,t){var r=ye(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Ti({s:Rt(e[0]),e:Rt(e[0])},r),uf("rId"+t,r);var a=e[1].Target.indexOf("#"),s=a==-1?"":e[1].Target.slice(a+1);return cr(s||"",r),cr(e[1].Tooltip||"",r),cr("",r),r.slice(0,r.l)}function RS(){}function OS(e,t,r){var a=e.l+t,s=sg(e),i=e.read_shift(1),l=[s];if(l[2]=i,r.cellFormula){var c=l_(e,a-e.l,r);l[1]=c}else e.l=a;return l}function LS(e,t,r){var a=e.l+t,s=Rs(e),i=[s];if(r.cellFormula){var l=o_(e,a-e.l,r);i[1]=l,e.l=a}else e.l=a;return i}function BS(e,t,r){r==null&&(r=ye(18));var a=e0(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(a.width||10)*256),r.write_shift(4,0);var s=0;return t.hidden&&(s|=1),typeof a.width=="number"&&(s|=2),t.level&&(s|=t.level<<8),r.write_shift(2,s),r}var ov=["left","right","top","bottom","header","footer"];function US(e){var t={};return ov.forEach(function(r){t[r]=Cr(e)}),t}function zS(e,t){return t==null&&(t=ye(6*8)),gs(e),ov.forEach(function(r){Ss(e[r],t)}),t}function WS(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function HS(e,t,r){r==null&&(r=ye(30));var a=924;return(((t||{}).Views||[])[0]||{}).RTL&&(a|=32),r.write_shift(2,a),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function $S(e){var t=ye(24);return t.write_shift(4,4),t.write_shift(4,1),Ti(e,t),t}function VS(e,t){return t==null&&(t=ye(16*4+2)),t.write_shift(2,e.password?vf(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function GS(){}function XS(){}function KS(e,t,r,a,s,i,l){if(!e)return e;var c=t||{};a||(a={"!id":{}});var o=c.dense?[]:{},u,d={s:{r:2e6,c:2e6},e:{r:0,c:0}},f=!1,x=!1,h,p,m,w,v,b,y,N,F,j=[];c.biff=12,c["!row"]=0;var k=0,S=!1,P=[],D={},K=c.supbooks||s.supbooks||[[]];if(K.sharedf=D,K.arrayf=P,K.SheetNames=s.SheetNames||s.Sheets.map(function(te){return te.name}),!c.supbooks&&(c.supbooks=K,s.Names))for(var C=0;C<s.Names.length;++C)K[0][C+1]=s.Names[C];var Y=[],B=[],ee=!1;Ul[16]={n:"BrtShortReal",f:cv};var re;if(wa(e,function(H,ae,he){if(!x)switch(he){case 148:u=H;break;case 0:h=H,c.sheetRows&&c.sheetRows<=h.r&&(x=!0),N=Gt(w=h.r),c["!row"]=h.r,(H.hidden||H.hpt||H.level!=null)&&(H.hpt&&(H.hpx=Ni(H.hpt)),B[H.r]=H);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(p={t:H[2]},H[2]){case"n":p.v=H[1];break;case"s":y=il[H[1]],p.v=y.t,p.r=y.r;break;case"b":p.v=!!H[1];break;case"e":p.v=H[1],c.cellText!==!1&&(p.w=Na[p.v]);break;case"str":p.t="s",p.v=H[1];break;case"is":p.t="s",p.v=H[1].t;break}if((m=l.CellXf[H[0].iStyleRef])&&sv(p,m.numFmtId,null,c,i,l),v=H[0].c==-1?v+1:H[0].c,c.dense?(o[w]||(o[w]=[]),o[w][v]=p):o[Mt(v)+N]=p,c.cellFormula){for(S=!1,k=0;k<P.length;++k){var O=P[k];h.r>=O[0].s.r&&h.r<=O[0].e.r&&v>=O[0].s.c&&v<=O[0].e.c&&(p.F=et(O[0]),S=!0)}!S&&H.length>3&&(p.f=H[3])}if(d.s.r>h.r&&(d.s.r=h.r),d.s.c>v&&(d.s.c=v),d.e.r<h.r&&(d.e.r=h.r),d.e.c<v&&(d.e.c=v),c.cellDates&&m&&p.t=="n"&&Si(Ge[m.numFmtId])){var I=us(p.v);I&&(p.t="d",p.v=new Date(I.y,I.m-1,I.d,I.H,I.M,I.S,I.u))}re&&(re.type=="XLDAPR"&&(p.D=!0),re=void 0);break;case 1:case 12:if(!c.sheetStubs||f)break;p={t:"z",v:void 0},v=H[0].c==-1?v+1:H[0].c,c.dense?(o[w]||(o[w]=[]),o[w][v]=p):o[Mt(v)+N]=p,d.s.r>h.r&&(d.s.r=h.r),d.s.c>v&&(d.s.c=v),d.e.r<h.r&&(d.e.r=h.r),d.e.c<v&&(d.e.c=v),re&&(re.type=="XLDAPR"&&(p.D=!0),re=void 0);break;case 176:j.push(H);break;case 49:re=((c.xlmeta||{}).Cell||[])[H-1];break;case 494:var g=a["!id"][H.relId];for(g?(H.Target=g.Target,H.loc&&(H.Target+="#"+H.loc),H.Rel=g):H.relId==""&&(H.Target="#"+H.loc),w=H.rfx.s.r;w<=H.rfx.e.r;++w)for(v=H.rfx.s.c;v<=H.rfx.e.c;++v)c.dense?(o[w]||(o[w]=[]),o[w][v]||(o[w][v]={t:"z",v:void 0}),o[w][v].l=H):(b=Ke({c:v,r:w}),o[b]||(o[b]={t:"z",v:void 0}),o[b].l=H);break;case 426:if(!c.cellFormula)break;P.push(H),F=c.dense?o[w][v]:o[Mt(v)+N],F.f=kr(H[1],d,{r:h.r,c:v},K,c),F.F=et(H[0]);break;case 427:if(!c.cellFormula)break;D[Ke(H[0].s)]=H[1],F=c.dense?o[w][v]:o[Mt(v)+N],F.f=kr(H[1],d,{r:h.r,c:v},K,c);break;case 60:if(!c.cellStyles)break;for(;H.e>=H.s;)Y[H.e--]={width:H.w/256,hidden:!!(H.flags&1),level:H.level},ee||(ee=!0,yf(H.w/256)),qa(Y[H.e+1]);break;case 161:o["!autofilter"]={ref:et(H)};break;case 476:o["!margins"]=H;break;case 147:s.Sheets[r]||(s.Sheets[r]={}),H.name&&(s.Sheets[r].CodeName=H.name),(H.above||H.left)&&(o["!outline"]={above:H.above,left:H.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),H.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:f=!0;break;case 36:f=!1;break;case 37:f=!0;break;case 38:f=!1;break;default:if(!ae.T){if(!f||c.WTF)throw new Error("Unexpected record 0x"+he.toString(16))}}},c),delete c.supbooks,delete c["!row"],!o["!ref"]&&(d.s.r<2e6||u&&(u.e.r>0||u.e.c>0||u.s.r>0||u.s.c>0))&&(o["!ref"]=et(u||d)),c.sheetRows&&o["!ref"]){var Q=ut(o["!ref"]);c.sheetRows<=+Q.e.r&&(Q.e.r=c.sheetRows-1,Q.e.r>d.e.r&&(Q.e.r=d.e.r),Q.e.r<Q.s.r&&(Q.s.r=Q.e.r),Q.e.c>d.e.c&&(Q.e.c=d.e.c),Q.e.c<Q.s.c&&(Q.s.c=Q.e.c),o["!fullref"]=o["!ref"],o["!ref"]=et(Q))}return j.length>0&&(o["!merges"]=j),Y.length>0&&(o["!cols"]=Y),B.length>0&&(o["!rows"]=B),o}function YS(e,t,r,a,s,i,l){if(t.v===void 0)return!1;var c="";switch(t.t){case"b":c=t.v?"1":"0";break;case"d":t=Ft(t),t.z=t.z||Ge[14],t.v=tr(Tt(t.v)),t.t="n";break;case"n":case"e":c=""+t.v;break;default:c=t.v;break}var o={r,c:a};switch(o.s=as(s.cellXfs,t,s),t.l&&i["!links"].push([Ke(o),t.l]),t.c&&i["!comments"].push([Ke(o),t.c]),t.t){case"s":case"str":return s.bookSST?(c=kf(s.Strings,t.v,s.revStrings),o.t="s",o.v=c,l?_e(e,18,mS(t,o)):_e(e,7,fS(t,o))):(o.t="str",l?_e(e,17,SS(t,o)):_e(e,6,kS(t,o))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?l?_e(e,13,wS(t,o)):_e(e,2,yS(t,o)):l?_e(e,16,gS(t,o)):_e(e,5,pS(t,o)),!0;case"b":return o.t="b",l?_e(e,15,iS(t,o)):_e(e,4,aS(t,o)),!0;case"e":return o.t="e",l?_e(e,14,dS(t,o)):_e(e,3,cS(t,o)),!0}return l?_e(e,12,rS(t,o)):_e(e,1,eS(t,o)),!0}function qS(e,t,r,a){var s=ut(t["!ref"]||"A1"),i,l="",c=[];_e(e,145);var o=Array.isArray(t),u=s.e.r;t["!rows"]&&(u=Math.max(s.e.r,t["!rows"].length-1));for(var d=s.s.r;d<=u;++d){l=Gt(d),X_(e,t,s,d);var f=!1;if(d<=s.e.r)for(var x=s.s.c;x<=s.e.c;++x){d===s.s.r&&(c[x]=Mt(x)),i=c[x]+l;var h=o?(t[d]||[])[x]:t[i];if(!h){f=!1;continue}f=YS(e,h,d,x,a,t,f)}}_e(e,146)}function JS(e,t){!t||!t["!merges"]||(_e(e,177,DS(t["!merges"].length)),t["!merges"].forEach(function(r){_e(e,176,PS(r))}),_e(e,178))}function QS(e,t){!t||!t["!cols"]||(_e(e,390),t["!cols"].forEach(function(r,a){r&&_e(e,60,BS(a,r))}),_e(e,391))}function ZS(e,t){!t||!t["!ref"]||(_e(e,648),_e(e,649,$S(ut(t["!ref"]))),_e(e,650))}function eC(e,t,r){t["!links"].forEach(function(a){if(a[1].Target){var s=ht(r,-1,a[1].Target.replace(/#.*$/,""),st.HLINK);_e(e,494,MS(a,s))}}),delete t["!links"]}function tC(e,t,r,a){if(t["!comments"].length>0){var s=ht(a,-1,"../drawings/vmlDrawing"+(r+1)+".vml",st.VML);_e(e,551,uf("rId"+s)),t["!legacy"]=s}}function rC(e,t,r,a){if(t["!autofilter"]){var s=t["!autofilter"],i=typeof s.ref=="string"?s.ref:et(s.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var l=r.Workbook.Names,c=Jr(i);c.s.r==c.e.r&&(c.e.r=Jr(t["!ref"]).e.r,i=et(c));for(var o=0;o<l.length;++o){var u=l[o];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==a){u.Ref="'"+r.SheetNames[a]+"'!"+i;break}}o==l.length&&l.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+r.SheetNames[a]+"'!"+i}),_e(e,161,Ti(ut(i))),_e(e,162)}}function nC(e,t,r){_e(e,133),_e(e,137,HS(t,r)),_e(e,138),_e(e,134)}function aC(e,t){t["!protect"]&&_e(e,535,VS(t["!protect"]))}function sC(e,t,r,a){var s=qr(),i=r.SheetNames[e],l=r.Sheets[i]||{},c=i;try{r&&r.Workbook&&(c=r.Workbook.Sheets[e].CodeName||c)}catch{}var o=ut(l["!ref"]||"A1");if(o.e.c>16383||o.e.r>1048575){if(t.WTF)throw new Error("Range "+(l["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");o.e.c=Math.min(o.e.c,16383),o.e.r=Math.min(o.e.c,1048575)}return l["!links"]=[],l["!comments"]=[],_e(s,129),(r.vbaraw||l["!outline"])&&_e(s,147,Q_(c,l["!outline"])),_e(s,148,Y_(o)),nC(s,l,r.Workbook),QS(s,l),qS(s,l,e,t),aC(s,l),rC(s,l,r,e),JS(s,l),eC(s,l,a),l["!margins"]&&_e(s,476,zS(l["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&ZS(s,l),tC(s,l,e,a),_e(s,130),s.end()}function iC(e){var t=[],r=e.match(/^<c:numCache>/),a;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(i){var l=i.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);l&&(t[+l[1]]=r?+l[2]:l[2])});var s=dt((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(i){a=i.replace(/<.*?>/g,"")}),[t,s,a]}function lC(e,t,r,a,s,i){var l=i||{"!type":"chart"};if(!e)return i;var c=0,o=0,u="A",d={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(f){var x=iC(f);d.s.r=d.s.c=0,d.e.c=c,u=Mt(c),x[0].forEach(function(h,p){l[u+Gt(p)]={t:"n",v:h,z:x[1]},o=p}),d.e.r<o&&(d.e.r=o),++c}),c>0&&(l["!ref"]=et(d)),l}function cC(e,t,r,a,s){if(!e)return e;a||(a={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},l,c=e.match(iv);return c&&_f(c[0],i,s,r),(l=e.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=l[1]),a["!id"][i["!rel"]]&&(i["!drawel"]=a["!id"][i["!rel"]]),i}function oC(e,t){e.l+=10;var r=Er(e);return{name:r}}function dC(e,t,r,a,s){if(!e)return e;a||(a={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},l=!1;return wa(e,function(o,u,d){switch(d){case 550:i["!rel"]=o;break;case 651:s.Sheets[r]||(s.Sheets[r]={}),o.name&&(s.Sheets[r].CodeName=o.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:break;case 38:break;default:if(!(u.T>0)){if(!(u.T<0)){if(!l||t.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}},t),a["!id"][i["!rel"]]&&(i["!drawel"]=a["!id"][i["!rel"]]),i}var Sf=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],uC=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],fC=[],xC=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Gm(e,t){for(var r=0;r!=e.length;++r)for(var a=e[r],s=0;s!=t.length;++s){var i=t[s];if(a[i[0]]==null)a[i[0]]=i[1];else switch(i[2]){case"bool":typeof a[i[0]]=="string"&&(a[i[0]]=_t(a[i[0]]));break;case"int":typeof a[i[0]]=="string"&&(a[i[0]]=parseInt(a[i[0]],10));break}}}function Xm(e,t){for(var r=0;r!=t.length;++r){var a=t[r];if(e[a[0]]==null)e[a[0]]=a[1];else switch(a[2]){case"bool":typeof e[a[0]]=="string"&&(e[a[0]]=_t(e[a[0]]));break;case"int":typeof e[a[0]]=="string"&&(e[a[0]]=parseInt(e[a[0]],10));break}}}function dv(e){Xm(e.WBProps,Sf),Xm(e.CalcPr,xC),Gm(e.WBView,uC),Gm(e.Sheets,fC),ui.date1904=_t(e.WBProps.date1904)}function mC(e){return!e.Workbook||!e.Workbook.WBProps?"false":_t(e.Workbook.WBProps.date1904)?"true":"false"}var hC="][*?/\\".split("");function uv(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return hC.forEach(function(a){if(e.indexOf(a)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function pC(e,t,r){e.forEach(function(a,s){uv(a);for(var i=0;i<s;++i)if(a==e[i])throw new Error("Duplicate Sheet Name: "+a);if(r){var l=t&&t[s]&&t[s].CodeName||a;if(l.charCodeAt(0)==95&&l.length>22)throw new Error("Bad Code Name: Worksheet"+l)}})}function gC(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];pC(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)m_(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var vC=/<\w+:workbook/;function yC(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},a=!1,s="xmlns",i={},l=0;if(e.replace(Ar,function(o,u){var d=Ye(o);switch(ea(d[0])){case"<?xml":break;case"<workbook":o.match(vC)&&(s="xmlns"+o.match(/<(\w+):/)[1]),r.xmlns=d[s];break;case"</workbook>":break;case"<fileVersion":delete d[0],r.AppVersion=d;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Sf.forEach(function(f){if(d[f[0]]!=null)switch(f[2]){case"bool":r.WBProps[f[0]]=_t(d[f[0]]);break;case"int":r.WBProps[f[0]]=parseInt(d[f[0]],10);break;default:r.WBProps[f[0]]=d[f[0]]}}),d.codeName&&(r.WBProps.CodeName=vt(d.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete d[0],r.WBView.push(d);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(d.state){case"hidden":d.Hidden=1;break;case"veryHidden":d.Hidden=2;break;default:d.Hidden=0}delete d.state,d.name=dt(vt(d.name)),delete d[0],r.Sheets.push(d);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":a=!0;break;case"</definedNames>":a=!1;break;case"<definedName":i={},i.Name=vt(d.name),d.comment&&(i.Comment=d.comment),d.localSheetId&&(i.Sheet=+d.localSheetId),_t(d.hidden||"0")&&(i.Hidden=!0),l=u+o.length;break;case"</definedName>":i.Ref=dt(vt(e.slice(l,u))),r.Names.push(i);break;case"<definedName/>":break;case"<calcPr":delete d[0],r.CalcPr=d;break;case"<calcPr/>":delete d[0],r.CalcPr=d;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":a=!0;break;case"</AlternateContent>":a=!1;break;case"<revisionPtr":break;default:if(!a&&t.WTF)throw new Error("unrecognized "+d[0]+" in workbook")}return o}),Ps.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return dv(r),r}function fv(e){var t=[Xt];t[t.length]=Ae("workbook",null,{xmlns:Ps[0],"xmlns:r":Zt.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,a={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(Sf.forEach(function(c){e.Workbook.WBProps[c[0]]!=null&&e.Workbook.WBProps[c[0]]!=c[1]&&(a[c[0]]=e.Workbook.WBProps[c[0]])}),e.Workbook.WBProps.CodeName&&(a.codeName=e.Workbook.WBProps.CodeName,delete a.CodeName)),t[t.length]=Ae("workbookPr",null,a);var s=e.Workbook&&e.Workbook.Sheets||[],i=0;if(s&&s[0]&&s[0].Hidden){for(t[t.length]="<bookViews>",i=0;i!=e.SheetNames.length&&!(!s[i]||!s[i].Hidden);++i);i==e.SheetNames.length&&(i=0),t[t.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",i=0;i!=e.SheetNames.length;++i){var l={name:pt(e.SheetNames[i].slice(0,31))};if(l.sheetId=""+(i+1),l["r:id"]="rId"+(i+1),s[i])switch(s[i].Hidden){case 1:l.state="hidden";break;case 2:l.state="veryHidden";break}t[t.length]=Ae("sheet",null,l)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(c){var o={name:c.Name};c.Comment&&(o.comment=c.Comment),c.Sheet!=null&&(o.localSheetId=""+c.Sheet),c.Hidden&&(o.hidden="1"),c.Ref&&(t[t.length]=Ae("definedName",pt(c.Ref),o))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function bC(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Ld(e),r.name=Er(e),r}function wC(e,t){return t||(t=ye(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),uf(e.strRelID,t),cr(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function NC(e,t){var r={},a=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var s=t>8?Er(e):"";return s.length>0&&(r.CodeName=s),r.autoCompressPictures=!!(a&65536),r.backupFile=!!(a&64),r.checkCompatibility=!!(a&4096),r.date1904=!!(a&1),r.filterPrivacy=!!(a&8),r.hidePivotFieldList=!!(a&1024),r.promptedSolutions=!!(a&16),r.publishItems=!!(a&2048),r.refreshAllConnections=!!(a&262144),r.saveExternalLinkValues=!!(a&128),r.showBorderUnselectedTables=!!(a&4),r.showInkAnnotation=!!(a&32),r.showObjects=["all","placeholders","none"][a>>13&3],r.showPivotChartFilter=!!(a&32768),r.updateLinks=["userSet","never","always"][a>>8&3],r}function jC(e,t){t||(t=ye(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),ng(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function kC(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function _C(e,t,r){var a=e.l+t;e.l+=4,e.l+=1;var s=e.read_shift(4),i=tN(e),l=c_(e,0,r),c=df(e);e.l=a;var o={Name:i,Ptg:l};return s<268435455&&(o.Sheet=s),c&&(o.Comment=c),o}function SC(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},a=[],s=!1;t||(t={}),t.biff=12;var i=[],l=[[]];return l.SheetNames=[],l.XTI=[],Ul[16]={n:"BrtFRTArchID$",f:kC},wa(e,function(o,u,d){switch(d){case 156:l.SheetNames.push(o.name),r.Sheets.push(o);break;case 153:r.WBProps=o;break;case 39:o.Sheet!=null&&(t.SID=o.Sheet),o.Ref=kr(o.Ptg,null,null,l,t),delete t.SID,delete o.Ptg,i.push(o);break;case 1036:break;case 357:case 358:case 355:case 667:l[0].length?l.push([d,o]):l[0]=[d,o],l[l.length-1].XTI=[];break;case 362:l.length===0&&(l[0]=[],l[0].XTI=[]),l[l.length-1].XTI=l[l.length-1].XTI.concat(o),l.XTI=l.XTI.concat(o);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:a.push(d),s=!0;break;case 36:a.pop(),s=!1;break;case 37:a.push(d),s=!0;break;case 38:a.pop(),s=!1;break;case 16:break;default:if(!u.T){if(!s||t.WTF&&a[a.length-1]!=37&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}},t),dv(r),r.Names=i,r.supbooks=l,r}function CC(e,t){_e(e,143);for(var r=0;r!=t.SheetNames.length;++r){var a=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,s={Hidden:a,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};_e(e,156,wC(s))}_e(e,144)}function EC(e,t){t||(t=ye(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return cr("SheetJS",t),cr(go.version,t),cr(go.version,t),cr("7262",t),t.length>t.l?t.slice(0,t.l):t}function TC(e,t){t||(t=ye(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function FC(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,a=0,s=-1,i=-1;a<r.length;++a)!r[a]||!r[a].Hidden&&s==-1?s=a:r[a].Hidden==1&&i==-1&&(i=a);i>s||(_e(e,135),_e(e,158,TC(s)),_e(e,136))}}function AC(e,t){var r=qr();return _e(r,131),_e(r,128,EC()),_e(r,153,jC(e.Workbook&&e.Workbook.WBProps||null)),FC(r,e),CC(r,e),_e(r,132),r.end()}function PC(e,t,r){return t.slice(-4)===".bin"?SC(e,r):yC(e,r)}function DC(e,t,r,a,s,i,l,c){return t.slice(-4)===".bin"?KS(e,a,r,s,i,l,c):__(e,a,r,s,i,l,c)}function IC(e,t,r,a,s,i,l,c){return t.slice(-4)===".bin"?dC(e,a,r,s,i):cC(e,a,r,s,i)}function MC(e,t,r,a,s,i,l,c){return t.slice(-4)===".bin"?O5():L5()}function RC(e,t,r,a,s,i,l,c){return t.slice(-4)===".bin"?M5():R5()}function OC(e,t,r,a){return t.slice(-4)===".bin"?Pk(e,r,a):bk(e,r,a)}function LC(e,t,r){return Gg(e,r)}function BC(e,t,r){return t.slice(-4)===".bin"?B4(e,r):R4(e,r)}function UC(e,t,r){return t.slice(-4)===".bin"?F5(e,r):w5(e,r)}function zC(e,t,r){return t.slice(-4)===".bin"?v5(e):p5(e)}function WC(e,t,r,a){return r.slice(-4)===".bin"?y5(e,t,r,a):void 0}function HC(e,t,r){return t.slice(-4)===".bin"?x5(e,t,r):h5(e,t,r)}function $C(e,t,r){return(t.slice(-4)===".bin"?AC:fv)(e)}function VC(e,t,r,a,s){return(t.slice(-4)===".bin"?sC:lv)(e,r,a,s)}function GC(e,t,r){return(t.slice(-4)===".bin"?Wk:$g)(e,r)}function XC(e,t,r){return(t.slice(-4)===".bin"?W4:Rg)(e,r)}function KC(e,t,r){return(t.slice(-4)===".bin"?A5:Yg)(e)}function YC(e){return(e.slice(-4)===".bin"?m5:Xg)()}var xv=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,mv=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Pn(e,t){var r=e.split(/\s+/),a=[];if(a[0]=r[0],r.length===1)return a;var s=e.match(xv),i,l,c,o;if(s)for(o=0;o!=s.length;++o)i=s[o].match(mv),(l=i[1].indexOf(":"))===-1?a[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?c="xmlns"+i[1].slice(6):c=i[1].slice(l+1),a[c]=i[2].slice(1,i[2].length-1));return a}function qC(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var a=e.match(xv),s,i,l,c;if(a)for(c=0;c!=a.length;++c)s=a[c].match(mv),(i=s[1].indexOf(":"))===-1?r[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?l="xmlns"+s[1].slice(6):l=s[1].slice(i+1),r[l]=s[2].slice(1,s[2].length-1));return r}var cl;function JC(e,t){var r=cl[e]||dt(e);return r==="General"?ks(t):_n(r,t)}function QC(e,t,r,a){var s=a;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=_t(a);break;case"i2":case"int":s=parseInt(a,10);break;case"r4":case"float":s=parseFloat(a);break;case"date":case"dateTime.tz":s=Tt(a);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[dt(t)]=s}function ZC(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||Na[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Al(e.v):e.w=ks(e.v):e.w=JC(t||"General",e.v)}catch(i){if(r.WTF)throw i}try{var a=cl[t]||t||"General";if(r.cellNF&&(e.z=a),r.cellDates&&e.t=="n"&&Si(a)){var s=us(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(i){if(r.WTF)throw i}}}function e6(e,t,r){if(r.cellStyles&&t.Interior){var a=t.Interior;a.Pattern&&(a.patternType=fk[a.Pattern]||a.Pattern)}e[t.ID]=t}function t6(e,t,r,a,s,i,l,c,o,u){var d="General",f=a.StyleID,x={};u=u||{};var h=[],p=0;for(f===void 0&&c&&(f=c.StyleID),f===void 0&&l&&(f=l.StyleID);i[f]!==void 0&&(i[f].nf&&(d=i[f].nf),i[f].Interior&&h.push(i[f].Interior),!!i[f].Parent);)f=i[f].Parent;switch(r.Type){case"Boolean":a.t="b",a.v=_t(e);break;case"String":a.t="s",a.r=dm(dt(e)),a.v=e.indexOf("<")>-1?dt(t||e).replace(/<.*?>/g,""):a.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),a.v=(Tt(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),a.v!==a.v?a.v=dt(e):a.v<60&&(a.v=a.v-1),(!d||d=="General")&&(d="yyyy-mm-dd");case"Number":a.v===void 0&&(a.v=+e),a.t||(a.t="n");break;case"Error":a.t="e",a.v=cg[e],u.cellText!==!1&&(a.w=e);break;default:e==""&&t==""?a.t="z":(a.t="s",a.v=dm(t||e));break}if(ZC(a,d,u),u.cellFormula!==!1)if(a.Formula){var m=dt(a.Formula);m.charCodeAt(0)==61&&(m=m.slice(1)),a.f=di(m,s),delete a.Formula,a.ArrayRange=="RC"?a.F=di("RC:RC",s):a.ArrayRange&&(a.F=di(a.ArrayRange,s),o.push([ut(a.F),a.F]))}else for(p=0;p<o.length;++p)s.r>=o[p][0].s.r&&s.r<=o[p][0].e.r&&s.c>=o[p][0].s.c&&s.c<=o[p][0].e.c&&(a.F=o[p][1]);u.cellStyles&&(h.forEach(function(w){!x.patternType&&w.patternType&&(x.patternType=w.patternType)}),a.s=x),a.StyleID!==void 0&&(a.ixfe=a.StyleID)}function r6(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function O0(e,t){var r=t||{};Ci();var a=$i(nf(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(a=vt(a));var s=a.slice(0,1024).toLowerCase(),i=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var l=Ft(r);return l.type="string",wi.to_workbook(a,l)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(oe){s.indexOf("<"+oe)>=0&&(i=!0)}),i)return z6(a,r);cl={"General Number":"General","General Date":Ge[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Ge[15],"Short Date":Ge[14],"Long Time":Ge[19],"Medium Time":Ge[18],"Short Time":Ge[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Ge[2],Standard:Ge[4],Percent:Ge[10],Scientific:Ge[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var c,o=[],u,d={},f=[],x=r.dense?[]:{},h="",p={},m={},w=Pn('<Data ss:Type="String">'),v=0,b=0,y=0,N={s:{r:2e6,c:2e6},e:{r:0,c:0}},F={},j={},k="",S=0,P=[],D={},K={},C=0,Y=[],B=[],ee={},re=[],Q,te=!1,H=[],ae=[],he={},O=0,I=0,g={Sheets:[],WBProps:{date1904:!1}},_={};Il.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"");for(var A="";c=Il.exec(a);)switch(c[3]=(A=c[3]).toLowerCase()){case"data":if(A=="data"){if(c[1]==="/"){if((u=o.pop())[0]!==c[3])throw new Error("Bad state: "+u.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&o.push([c[3],!0]);break}if(o[o.length-1][1])break;c[1]==="/"?t6(a.slice(v,c.index),k,w,o[o.length-1][0]=="comment"?ee:p,{c:b,r:y},F,re[b],m,H,r):(k="",w=Pn(c[0]),v=c.index+c[0].length);break;case"cell":if(c[1]==="/")if(B.length>0&&(p.c=B),(!r.sheetRows||r.sheetRows>y)&&p.v!==void 0&&(r.dense?(x[y]||(x[y]=[]),x[y][b]=p):x[Mt(b)+Gt(y)]=p),p.HRef&&(p.l={Target:dt(p.HRef)},p.HRefScreenTip&&(p.l.Tooltip=p.HRefScreenTip),delete p.HRef,delete p.HRefScreenTip),(p.MergeAcross||p.MergeDown)&&(O=b+(parseInt(p.MergeAcross,10)|0),I=y+(parseInt(p.MergeDown,10)|0),P.push({s:{c:b,r:y},e:{c:O,r:I}})),!r.sheetStubs)p.MergeAcross?b=O+1:++b;else if(p.MergeAcross||p.MergeDown){for(var ne=b;ne<=O;++ne)for(var ue=y;ue<=I;++ue)(ne>b||ue>y)&&(r.dense?(x[ue]||(x[ue]=[]),x[ue][ne]={t:"z"}):x[Mt(ne)+Gt(ue)]={t:"z"});b=O+1}else++b;else p=qC(c[0]),p.Index&&(b=+p.Index-1),b<N.s.c&&(N.s.c=b),b>N.e.c&&(N.e.c=b),c[0].slice(-2)==="/>"&&++b,B=[];break;case"row":c[1]==="/"||c[0].slice(-2)==="/>"?(y<N.s.r&&(N.s.r=y),y>N.e.r&&(N.e.r=y),c[0].slice(-2)==="/>"&&(m=Pn(c[0]),m.Index&&(y=+m.Index-1)),b=0,++y):(m=Pn(c[0]),m.Index&&(y=+m.Index-1),he={},(m.AutoFitHeight=="0"||m.Height)&&(he.hpx=parseInt(m.Height,10),he.hpt=Bl(he.hpx),ae[y]=he),m.Hidden=="1"&&(he.hidden=!0,ae[y]=he));break;case"worksheet":if(c[1]==="/"){if((u=o.pop())[0]!==c[3])throw new Error("Bad state: "+u.join("|"));f.push(h),N.s.r<=N.e.r&&N.s.c<=N.e.c&&(x["!ref"]=et(N),r.sheetRows&&r.sheetRows<=N.e.r&&(x["!fullref"]=x["!ref"],N.e.r=r.sheetRows-1,x["!ref"]=et(N))),P.length&&(x["!merges"]=P),re.length>0&&(x["!cols"]=re),ae.length>0&&(x["!rows"]=ae),d[h]=x}else N={s:{r:2e6,c:2e6},e:{r:0,c:0}},y=b=0,o.push([c[3],!1]),u=Pn(c[0]),h=dt(u.Name),x=r.dense?[]:{},P=[],H=[],ae=[],_={name:h,Hidden:0},g.Sheets.push(_);break;case"table":if(c[1]==="/"){if((u=o.pop())[0]!==c[3])throw new Error("Bad state: "+u.join("|"))}else{if(c[0].slice(-2)=="/>")break;o.push([c[3],!1]),re=[],te=!1}break;case"style":c[1]==="/"?e6(F,j,r):j=Pn(c[0]);break;case"numberformat":j.nf=dt(Pn(c[0]).Format||"General"),cl[j.nf]&&(j.nf=cl[j.nf]);for(var ve=0;ve!=392&&Ge[ve]!=j.nf;++ve);if(ve==392){for(ve=57;ve!=392;++ve)if(Ge[ve]==null){fa(j.nf,ve);break}}break;case"column":if(o[o.length-1][0]!=="table")break;if(Q=Pn(c[0]),Q.Hidden&&(Q.hidden=!0,delete Q.Hidden),Q.Width&&(Q.wpx=parseInt(Q.Width,10)),!te&&Q.wpx>10){te=!0,Sr=Wg;for(var xe=0;xe<re.length;++xe)re[xe]&&qa(re[xe])}te&&qa(Q),re[Q.Index-1||re.length]=Q;for(var W=0;W<+Q.Span;++W)re[re.length]=Ft(Q);break;case"namedrange":if(c[1]==="/")break;g.Names||(g.Names=[]);var E=Ye(c[0]),ke={Name:E.Name,Ref:di(E.RefersTo.slice(1),{r:0,c:0})};g.Sheets.length>0&&(ke.Sheet=g.Sheets.length-1),g.Names.push(ke);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(c[0].slice(-2)==="/>")break;c[1]==="/"?k+=a.slice(S,c.index):S=c.index+c[0].length;break;case"interior":if(!r.cellStyles)break;j.Interior=Pn(c[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(c[0].slice(-2)==="/>")break;c[1]==="/"?SN(D,A,a.slice(C,c.index)):C=c.index+c[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(c[1]==="/"){if((u=o.pop())[0]!==c[3])throw new Error("Bad state: "+u.join("|"))}else o.push([c[3],!1]);break;case"comment":if(c[1]==="/"){if((u=o.pop())[0]!==c[3])throw new Error("Bad state: "+u.join("|"));r6(ee),B.push(ee)}else o.push([c[3],!1]),u=Pn(c[0]),ee={a:u.Author};break;case"autofilter":if(c[1]==="/"){if((u=o.pop())[0]!==c[3])throw new Error("Bad state: "+u.join("|"))}else if(c[0].charAt(c[0].length-2)!=="/"){var pe=Pn(c[0]);x["!autofilter"]={ref:di(pe.Range).replace(/\$/g,"")},o.push([c[3],!0])}break;case"name":break;case"datavalidation":if(c[1]==="/"){if((u=o.pop())[0]!==c[3])throw new Error("Bad state: "+u.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&o.push([c[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(c[1]==="/"){if((u=o.pop())[0]!==c[3])throw new Error("Bad state: "+u.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&o.push([c[3],!0]);break;case"null":break;default:if(o.length==0&&c[3]=="document"||o.length==0&&c[3]=="uof")return Qm(a,r);var Ue=!0;switch(o[o.length-1][0]){case"officedocumentsettings":switch(c[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Ue=!1}break;case"componentoptions":switch(c[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Ue=!1}break;case"excelworkbook":switch(c[3]){case"date1904":g.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Ue=!1}break;case"workbookoptions":switch(c[3]){case"owcversion":break;case"height":break;case"width":break;default:Ue=!1}break;case"worksheetoptions":switch(c[3]){case"visible":if(c[0].slice(-2)!=="/>")if(c[1]==="/")switch(a.slice(C,c.index)){case"SheetHidden":_.Hidden=1;break;case"SheetVeryHidden":_.Hidden=2;break}else C=c.index+c[0].length;break;case"header":x["!margins"]||gs(x["!margins"]={},"xlml"),isNaN(+Ye(c[0]).Margin)||(x["!margins"].header=+Ye(c[0]).Margin);break;case"footer":x["!margins"]||gs(x["!margins"]={},"xlml"),isNaN(+Ye(c[0]).Margin)||(x["!margins"].footer=+Ye(c[0]).Margin);break;case"pagemargins":var Ne=Ye(c[0]);x["!margins"]||gs(x["!margins"]={},"xlml"),isNaN(+Ne.Top)||(x["!margins"].top=+Ne.Top),isNaN(+Ne.Left)||(x["!margins"].left=+Ne.Left),isNaN(+Ne.Right)||(x["!margins"].right=+Ne.Right),isNaN(+Ne.Bottom)||(x["!margins"].bottom=+Ne.Bottom);break;case"displayrighttoleft":g.Views||(g.Views=[]),g.Views[0]||(g.Views[0]={}),g.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":x["!outline"]||(x["!outline"]={}),x["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":x["!outline"]||(x["!outline"]={}),x["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Ue=!1}break;case"pivottable":case"pivotcache":switch(c[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Ue=!1}break;case"pagebreaks":switch(c[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Ue=!1}break;case"autofilter":switch(c[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Ue=!1}break;case"querytable":switch(c[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Ue=!1}break;case"datavalidation":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Ue=!1}break;case"sorting":case"conditionalformatting":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Ue=!1}break;case"mapinfo":case"schema":case"data":switch(c[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Ue=!1}break;case"smarttags":break;default:Ue=!1;break}if(Ue||c[3].match(/!\[CDATA/))break;if(!o[o.length-1][1])throw"Unrecognized tag: "+c[3]+"|"+o.join("|");if(o[o.length-1][0]==="customdocumentproperties"){if(c[0].slice(-2)==="/>")break;c[1]==="/"?QC(K,A,Y,a.slice(C,c.index)):(Y=c,C=c.index+c[0].length);break}if(r.WTF)throw"Unrecognized tag: "+c[3]+"|"+o.join("|")}var me={};return!r.bookSheets&&!r.bookProps&&(me.Sheets=d),me.SheetNames=f,me.Workbook=g,me.SSF=Ft(Ge),me.Props=D,me.Custprops=K,me}function Vd(e,t){switch(Ef(t=t||{}),t.type||"base64"){case"base64":return O0(cn(e),t);case"binary":case"buffer":case"file":return O0(e,t);case"array":return O0(rs(e),t)}}function n6(e,t){var r=[];return e.Props&&r.push(CN(e.Props,t)),e.Custprops&&r.push(EN(e.Props,e.Custprops)),r.join("")}function a6(){return""}function s6(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(a,s){var i=[];i.push(Ae("NumberFormat",null,{"ss:Format":pt(Ge[a.numFmtId])}));var l={"ss:ID":"s"+(21+s)};r.push(Ae("Style",i.join(""),l))}),Ae("Styles",r.join(""))}function hv(e){return Ae("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+Nf(e.Ref,{r:0,c:0})})}function i6(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],a=0;a<t.length;++a){var s=t[a];s.Sheet==null&&(s.Name.match(/^_xlfn\./)||r.push(hv(s)))}return Ae("Names",r.join(""))}function l6(e,t,r,a){if(!e||!((a||{}).Workbook||{}).Names)return"";for(var s=a.Workbook.Names,i=[],l=0;l<s.length;++l){var c=s[l];c.Sheet==r&&(c.Name.match(/^_xlfn\./)||i.push(hv(c)))}return i.join("")}function c6(e,t,r,a){if(!e)return"";var s=[];if(e["!margins"]&&(s.push("<PageSetup>"),e["!margins"].header&&s.push(Ae("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&s.push(Ae("Footer",null,{"x:Margin":e["!margins"].footer})),s.push(Ae("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),s.push("</PageSetup>")),a&&a.Workbook&&a.Workbook.Sheets&&a.Workbook.Sheets[r])if(a.Workbook.Sheets[r].Hidden)s.push(Ae("Visible",a.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<r&&!(a.Workbook.Sheets[i]&&!a.Workbook.Sheets[i].Hidden);++i);i==r&&s.push("<Selected/>")}return((((a||{}).Workbook||{}).Views||[])[0]||{}).RTL&&s.push("<DisplayRightToLeft/>"),e["!protect"]&&(s.push(pr("ProtectContents","True")),e["!protect"].objects&&s.push(pr("ProtectObjects","True")),e["!protect"].scenarios&&s.push(pr("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?s.push(pr("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&s.push(pr("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(l){e["!protect"][l[0]]&&s.push("<"+l[1]+"/>")})),s.length==0?"":Ae("WorksheetOptions",s.join(""),{xmlns:en.x})}function o6(e){return e.map(function(t){var r=Fw(t.t||""),a=Ae("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Ae("Comment",a,{"ss:Author":t.a})}).join("")}function d6(e,t,r,a,s,i,l){if(!e||e.v==null&&e.f==null)return"";var c={};if(e.f&&(c["ss:Formula"]="="+pt(Nf(e.f,l))),e.F&&e.F.slice(0,t.length)==t){var o=Rt(e.F.slice(t.length+1));c["ss:ArrayRange"]="RC:R"+(o.r==l.r?"":"["+(o.r-l.r)+"]")+"C"+(o.c==l.c?"":"["+(o.c-l.c)+"]")}if(e.l&&e.l.Target&&(c["ss:HRef"]=pt(e.l.Target),e.l.Tooltip&&(c["x:HRefScreenTip"]=pt(e.l.Tooltip))),r["!merges"])for(var u=r["!merges"],d=0;d!=u.length;++d)u[d].s.c!=l.c||u[d].s.r!=l.r||(u[d].e.c>u[d].s.c&&(c["ss:MergeAcross"]=u[d].e.c-u[d].s.c),u[d].e.r>u[d].s.r&&(c["ss:MergeDown"]=u[d].e.r-u[d].s.r));var f="",x="";switch(e.t){case"z":if(!a.sheetStubs)return"";break;case"n":f="Number",x=String(e.v);break;case"b":f="Boolean",x=e.v?"1":"0";break;case"e":f="Error",x=Na[e.v];break;case"d":f="DateTime",x=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||Ge[14]);break;case"s":f="String",x=Tw(e.v||"");break}var h=as(a.cellXfs,e,a);c["ss:StyleID"]="s"+(21+h),c["ss:Index"]=l.c+1;var p=e.v!=null?x:"",m=e.t=="z"?"":'<Data ss:Type="'+f+'">'+p+"</Data>";return(e.c||[]).length>0&&(m+=o6(e.c)),Ae("Cell",m,c)}function u6(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=Ni(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function f6(e,t,r,a){if(!e["!ref"])return"";var s=ut(e["!ref"]),i=e["!merges"]||[],l=0,c=[];e["!cols"]&&e["!cols"].forEach(function(w,v){qa(w);var b=!!w.width,y=e0(v,w),N={"ss:Index":v+1};b&&(N["ss:Width"]=Ol(y.width)),w.hidden&&(N["ss:Hidden"]="1"),c.push(Ae("Column",null,N))});for(var o=Array.isArray(e),u=s.s.r;u<=s.e.r;++u){for(var d=[u6(u,(e["!rows"]||[])[u])],f=s.s.c;f<=s.e.c;++f){var x=!1;for(l=0;l!=i.length;++l)if(!(i[l].s.c>f)&&!(i[l].s.r>u)&&!(i[l].e.c<f)&&!(i[l].e.r<u)){(i[l].s.c!=f||i[l].s.r!=u)&&(x=!0);break}if(!x){var h={r:u,c:f},p=Ke(h),m=o?(e[u]||[])[f]:e[p];d.push(d6(m,p,e,t,r,a,h))}}d.push("</Row>"),d.length>2&&c.push(d.join(""))}return c.join("")}function x6(e,t,r){var a=[],s=r.SheetNames[e],i=r.Sheets[s],l=i?l6(i,t,e,r):"";return l.length>0&&a.push("<Names>"+l+"</Names>"),l=i?f6(i,t,e,r):"",l.length>0&&a.push("<Table>"+l+"</Table>"),a.push(c6(i,t,e,r)),a.join("")}function m6(e,t){t||(t={}),e.SSF||(e.SSF=Ft(Ge)),e.SSF&&(Ci(),Xo(e.SSF),t.revssf=Yo(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],as(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(n6(e,t)),r.push(a6()),r.push(""),r.push("");for(var a=0;a<e.SheetNames.length;++a)r.push(Ae("Worksheet",x6(a,t,e),{"ss:Name":pt(e.SheetNames[a])}));return r[2]=s6(e,t),r[3]=i6(e),Xt+Ae("Workbook",r.join(""),{xmlns:en.ss,"xmlns:o":en.o,"xmlns:x":en.x,"xmlns:ss":en.ss,"xmlns:dt":en.dt,"xmlns:html":en.html})}function h6(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=iN(r),r.length-r.l<=4)return t;var a=r.read_shift(4);if(a==0||a>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(a=r.read_shift(4),a!==1907505652)||(t.UnicodeClipboardFormat=lN(r),a=r.read_shift(4),a==0||a>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var p6=[60,1084,2066,2165,2175];function g6(e,t,r,a,s){var i=a,l=[],c=r.slice(r.l,r.l+i);if(s&&s.enc&&s.enc.insitu&&c.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(c)}l.push(c),r.l+=i;for(var o=oa(r,r.l),u=Gd[o],d=0;u!=null&&p6.indexOf(o)>-1;)i=oa(r,r.l+2),d=r.l+4,o==2066?d+=4:(o==2165||o==2175)&&(d+=12),c=r.slice(d,r.l+4+i),l.push(c),r.l+=4+i,u=Gd[o=oa(r,r.l)];var f=lr(l);hr(f,0);var x=0;f.lens=[];for(var h=0;h<l.length;++h)f.lens.push(x),x+=l[h].length;if(f.length<a)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+f.length+" < "+a;return t.f(f,f.length,s)}function Vn(e,t,r){if(e.t!=="z"&&e.XF){var a=0;try{a=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=Ge[a])}catch(i){if(t.WTF)throw i}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||Na[e.v]:a===0||a=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Al(e.v):e.w=ks(e.v):e.w=_n(a,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(i){if(t.WTF)throw i}if(t.cellDates&&a&&e.t=="n"&&Si(Ge[a]||String(a))){var s=us(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function Ec(e,t,r){return{v:e,ixfe:t,t:r}}function v6(e,t){var r={opts:{}},a={},s=t.dense?[]:{},i={},l={},c=null,o=[],u="",d={},f,x="",h,p,m,w,v={},b=[],y,N,F=[],j=[],k={Sheets:[],WBProps:{date1904:!1},Views:[{}]},S={},P=function(Xe){return Xe<8?ms[Xe]:Xe<64&&j[Xe-8]||ms[Xe]},D=function(Xe,at,se){var Ce=at.XF.data;if(!(!Ce||!Ce.patternType||!se||!se.cellStyles)){at.s={},at.s.patternType=Ce.patternType;var Je;(Je=Rl(P(Ce.icvFore)))&&(at.s.fgColor={rgb:Je}),(Je=Rl(P(Ce.icvBack)))&&(at.s.bgColor={rgb:Je})}},K=function(Xe,at,se){if(!(he>1)&&!(se.sheetRows&&Xe.r>=se.sheetRows)){if(se.cellStyles&&at.XF&&at.XF.data&&D(Xe,at,se),delete at.ixfe,delete at.XF,f=Xe,x=Ke(Xe),(!l||!l.s||!l.e)&&(l={s:{r:0,c:0},e:{r:0,c:0}}),Xe.r<l.s.r&&(l.s.r=Xe.r),Xe.c<l.s.c&&(l.s.c=Xe.c),Xe.r+1>l.e.r&&(l.e.r=Xe.r+1),Xe.c+1>l.e.c&&(l.e.c=Xe.c+1),se.cellFormula&&at.f){for(var Ce=0;Ce<b.length;++Ce)if(!(b[Ce][0].s.c>Xe.c||b[Ce][0].s.r>Xe.r)&&!(b[Ce][0].e.c<Xe.c||b[Ce][0].e.r<Xe.r)){at.F=et(b[Ce][0]),(b[Ce][0].s.c!=Xe.c||b[Ce][0].s.r!=Xe.r)&&delete at.f,at.f&&(at.f=""+kr(b[Ce][1],l,Xe,H,C));break}}se.dense?(s[Xe.r]||(s[Xe.r]=[]),s[Xe.r][Xe.c]=at):s[x]=at}},C={enc:!1,sbcch:0,snames:[],sharedf:v,arrayf:b,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(C.password=t.password);var Y,B=[],ee=[],re=[],Q=[],te=!1,H=[];H.SheetNames=C.snames,H.sharedf=C.sharedf,H.arrayf=C.arrayf,H.names=[],H.XTI=[];var ae=0,he=0,O=0,I=[],g=[],_;C.codepage=1200,Rn(1200);for(var A=!1;e.l<e.length-1;){var ne=e.l,ue=e.read_shift(2);if(ue===0&&ae===10)break;var ve=e.l===e.length?0:e.read_shift(2),xe=Gd[ue];if(xe&&xe.f){if(t.bookSheets&&ae===133&&ue!==133)break;if(ae=ue,xe.r===2||xe.r==12){var W=e.read_shift(2);if(ve-=2,!C.enc&&W!==ue&&((W&255)<<8|W>>8)!==ue)throw new Error("rt mismatch: "+W+"!="+ue);xe.r==12&&(e.l+=10,ve-=10)}var E={};if(ue===10?E=xe.f(e,ve,C):E=g6(ue,xe,e,ve,C),he==0&&[9,521,1033,2057].indexOf(ae)===-1)continue;switch(ue){case 34:r.opts.Date1904=k.WBProps.date1904=E;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(C.enc||(e.l=0),C.enc=E,!t.password)throw new Error("File is password-protected");if(E.valid==null)throw new Error("Encryption scheme unsupported");if(!E.valid)throw new Error("Password is incorrect");break;case 92:C.lastuser=E;break;case 66:var ke=Number(E);switch(ke){case 21010:ke=1200;break;case 32768:ke=1e4;break;case 32769:ke=1252;break}Rn(C.codepage=ke),A=!0;break;case 317:C.rrtabid=E;break;case 25:C.winlocked=E;break;case 439:r.opts.RefreshAll=E;break;case 12:r.opts.CalcCount=E;break;case 16:r.opts.CalcDelta=E;break;case 17:r.opts.CalcIter=E;break;case 13:r.opts.CalcMode=E;break;case 14:r.opts.CalcPrecision=E;break;case 95:r.opts.CalcSaveRecalc=E;break;case 15:C.CalcRefMode=E;break;case 2211:r.opts.FullCalc=E;break;case 129:E.fDialog&&(s["!type"]="dialog"),E.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),E.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:F.push(E);break;case 430:H.push([E]),H[H.length-1].XTI=[];break;case 35:case 547:H[H.length-1].push(E);break;case 24:case 536:_={Name:E.Name,Ref:kr(E.rgce,l,null,H,C)},E.itab>0&&(_.Sheet=E.itab-1),H.names.push(_),H[0]||(H[0]=[],H[0].XTI=[]),H[H.length-1].push(E),E.Name=="_xlnm._FilterDatabase"&&E.itab>0&&E.rgce&&E.rgce[0]&&E.rgce[0][0]&&E.rgce[0][0][0]=="PtgArea3d"&&(g[E.itab-1]={ref:et(E.rgce[0][0][1][2])});break;case 22:C.ExternCount=E;break;case 23:H.length==0&&(H[0]=[],H[0].XTI=[]),H[H.length-1].XTI=H[H.length-1].XTI.concat(E),H.XTI=H.XTI.concat(E);break;case 2196:if(C.biff<8)break;_!=null&&(_.Comment=E[1]);break;case 18:s["!protect"]=E;break;case 19:E!==0&&C.WTF&&console.error("Password verifier: "+E);break;case 133:i[E.pos]=E,C.snames.push(E.name);break;case 10:{if(--he)break;if(l.e){if(l.e.r>0&&l.e.c>0){if(l.e.r--,l.e.c--,s["!ref"]=et(l),t.sheetRows&&t.sheetRows<=l.e.r){var pe=l.e.r;l.e.r=t.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=et(l),l.e.r=pe}l.e.r++,l.e.c++}B.length>0&&(s["!merges"]=B),ee.length>0&&(s["!objects"]=ee),re.length>0&&(s["!cols"]=re),Q.length>0&&(s["!rows"]=Q),k.Sheets.push(S)}u===""?d=s:a[u]=s,s=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(C.biff===8&&(C.biff={9:2,521:3,1033:4}[ue]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[E.BIFFVer]||8),C.biffguess=E.BIFFVer==0,E.BIFFVer==0&&E.dt==4096&&(C.biff=5,A=!0,Rn(C.codepage=28591)),C.biff==8&&E.BIFFVer==0&&E.dt==16&&(C.biff=2),he++)break;if(s=t.dense?[]:{},C.biff<8&&!A&&(A=!0,Rn(C.codepage=t.codepage||1252)),C.biff<5||E.BIFFVer==0&&E.dt==4096){u===""&&(u="Sheet1"),l={s:{r:0,c:0},e:{r:0,c:0}};var Ue={pos:e.l-ve,name:u};i[Ue.pos]=Ue,C.snames.push(u)}else u=(i[ne]||{name:""}).name;E.dt==32&&(s["!type"]="chart"),E.dt==64&&(s["!type"]="macro"),B=[],ee=[],C.arrayf=b=[],re=[],Q=[],te=!1,S={Hidden:(i[ne]||{hs:0}).hs,name:u}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(t.dense?(s[E.r]||[])[E.c]:s[Ke({c:E.c,r:E.r})])&&++E.c,y={ixfe:E.ixfe,XF:F[E.ixfe]||{},v:E.val,t:"n"},O>0&&(y.z=I[y.ixfe>>8&63]),Vn(y,t,r.opts.Date1904),K({c:E.c,r:E.r},y,t);break;case 5:case 517:y={ixfe:E.ixfe,XF:F[E.ixfe],v:E.val,t:E.t},O>0&&(y.z=I[y.ixfe>>8&63]),Vn(y,t,r.opts.Date1904),K({c:E.c,r:E.r},y,t);break;case 638:y={ixfe:E.ixfe,XF:F[E.ixfe],v:E.rknum,t:"n"},O>0&&(y.z=I[y.ixfe>>8&63]),Vn(y,t,r.opts.Date1904),K({c:E.c,r:E.r},y,t);break;case 189:for(var Ne=E.c;Ne<=E.C;++Ne){var me=E.rkrec[Ne-E.c][0];y={ixfe:me,XF:F[me],v:E.rkrec[Ne-E.c][1],t:"n"},O>0&&(y.z=I[y.ixfe>>8&63]),Vn(y,t,r.opts.Date1904),K({c:Ne,r:E.r},y,t)}break;case 6:case 518:case 1030:{if(E.val=="String"){c=E;break}if(y=Ec(E.val,E.cell.ixfe,E.tt),y.XF=F[y.ixfe],t.cellFormula){var oe=E.formula;if(oe&&oe[0]&&oe[0][0]&&oe[0][0][0]=="PtgExp"){var Ie=oe[0][0][1][0],Re=oe[0][0][1][1],Me=Ke({r:Ie,c:Re});v[Me]?y.f=""+kr(E.formula,l,E.cell,H,C):y.F=((t.dense?(s[Ie]||[])[Re]:s[Me])||{}).F}else y.f=""+kr(E.formula,l,E.cell,H,C)}O>0&&(y.z=I[y.ixfe>>8&63]),Vn(y,t,r.opts.Date1904),K(E.cell,y,t),c=E}break;case 7:case 519:if(c)c.val=E,y=Ec(E,c.cell.ixfe,"s"),y.XF=F[y.ixfe],t.cellFormula&&(y.f=""+kr(c.formula,l,c.cell,H,C)),O>0&&(y.z=I[y.ixfe>>8&63]),Vn(y,t,r.opts.Date1904),K(c.cell,y,t),c=null;else throw new Error("String record expects Formula");break;case 33:case 545:{b.push(E);var Oe=Ke(E[0].s);if(h=t.dense?(s[E[0].s.r]||[])[E[0].s.c]:s[Oe],t.cellFormula&&h){if(!c||!Oe||!h)break;h.f=""+kr(E[1],l,E[0],H,C),h.F=et(E[0])}}break;case 1212:{if(!t.cellFormula)break;if(x){if(!c)break;v[Ke(c.cell)]=E[0],h=t.dense?(s[c.cell.r]||[])[c.cell.c]:s[Ke(c.cell)],(h||{}).f=""+kr(E[0],l,f,H,C)}}break;case 253:y=Ec(o[E.isst].t,E.ixfe,"s"),o[E.isst].h&&(y.h=o[E.isst].h),y.XF=F[y.ixfe],O>0&&(y.z=I[y.ixfe>>8&63]),Vn(y,t,r.opts.Date1904),K({c:E.c,r:E.r},y,t);break;case 513:t.sheetStubs&&(y={ixfe:E.ixfe,XF:F[E.ixfe],t:"z"},O>0&&(y.z=I[y.ixfe>>8&63]),Vn(y,t,r.opts.Date1904),K({c:E.c,r:E.r},y,t));break;case 190:if(t.sheetStubs)for(var He=E.c;He<=E.C;++He){var Z=E.ixfe[He-E.c];y={ixfe:Z,XF:F[Z],t:"z"},O>0&&(y.z=I[y.ixfe>>8&63]),Vn(y,t,r.opts.Date1904),K({c:He,r:E.r},y,t)}break;case 214:case 516:case 4:y=Ec(E.val,E.ixfe,"s"),y.XF=F[y.ixfe],O>0&&(y.z=I[y.ixfe>>8&63]),Vn(y,t,r.opts.Date1904),K({c:E.c,r:E.r},y,t);break;case 0:case 512:he===1&&(l=E);break;case 252:o=E;break;case 1054:if(C.biff==4){I[O++]=E[1];for(var Be=0;Be<O+163&&Ge[Be]!=E[1];++Be);Be>=163&&fa(E[1],O+163)}else fa(E[1],E[0]);break;case 30:{I[O++]=E;for(var ze=0;ze<O+163&&Ge[ze]!=E;++ze);ze>=163&&fa(E,O+163)}break;case 229:B=B.concat(E);break;case 93:ee[E.cmo[0]]=C.lastobj=E;break;case 438:C.lastobj.TxO=E;break;case 127:C.lastobj.ImData=E;break;case 440:for(w=E[0].s.r;w<=E[0].e.r;++w)for(m=E[0].s.c;m<=E[0].e.c;++m)h=t.dense?(s[w]||[])[m]:s[Ke({c:m,r:w})],h&&(h.l=E[1]);break;case 2048:for(w=E[0].s.r;w<=E[0].e.r;++w)for(m=E[0].s.c;m<=E[0].e.c;++m)h=t.dense?(s[w]||[])[m]:s[Ke({c:m,r:w})],h&&h.l&&(h.l.Tooltip=E[1]);break;case 28:{if(C.biff<=5&&C.biff>=2)break;h=t.dense?(s[E[0].r]||[])[E[0].c]:s[Ke(E[0])];var nt=ee[E[2]];h||(t.dense?(s[E[0].r]||(s[E[0].r]=[]),h=s[E[0].r][E[0].c]={t:"z"}):h=s[Ke(E[0])]={t:"z"},l.e.r=Math.max(l.e.r,E[0].r),l.s.r=Math.min(l.s.r,E[0].r),l.e.c=Math.max(l.e.c,E[0].c),l.s.c=Math.min(l.s.c,E[0].c)),h.c||(h.c=[]),p={a:E[1],t:nt.TxO.t},h.c.push(p)}break;case 2173:s5(F[E.ixfe],E.ext);break;case 125:{if(!C.cellStyles)break;for(;E.e>=E.s;)re[E.e--]={width:E.w/256,level:E.level||0,hidden:!!(E.flags&1)},te||(te=!0,yf(E.w/256)),qa(re[E.e+1])}break;case 520:{var Qe={};E.level!=null&&(Q[E.r]=Qe,Qe.level=E.level),E.hidden&&(Q[E.r]=Qe,Qe.hidden=!0),E.hpt&&(Q[E.r]=Qe,Qe.hpt=E.hpt,Qe.hpx=Ni(E.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||gs(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ue]]=E;break;case 161:s["!margins"]||gs(s["!margins"]={}),s["!margins"].header=E.header,s["!margins"].footer=E.footer;break;case 574:E.RTL&&(k.Views[0].RTL=!0);break;case 146:j=E;break;case 2198:Y=E;break;case 140:N=E;break;case 442:u?S.CodeName=E||S.name:k.WBProps.CodeName=E||"ThisWorkbook";break}}else xe||console.error("Missing Info for XLS Record 0x"+ue.toString(16)),e.l+=ve}return r.SheetNames=Ht(i).sort(function(Dt,Xe){return Number(Dt)-Number(Xe)}).map(function(Dt){return i[Dt].name}),t.bookSheets||(r.Sheets=a),!r.SheetNames.length&&d["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=d)):r.Preamble=d,r.Sheets&&g.forEach(function(Dt,Xe){r.Sheets[r.SheetNames[Xe]]["!autofilter"]=Dt}),r.Strings=o,r.SSF=Ft(Ge),C.enc&&(r.Encryption=C.enc),Y&&(r.Themes=Y),r.Metadata={},N!==void 0&&(r.Metadata.Country=N),H.names.length>0&&(k.Names=H.names),r.Workbook=k,r}var ol={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function y6(e,t,r){var a=$e.find(e,"/!DocumentSummaryInformation");if(a&&a.size>0)try{var s=Em(a,Bd,ol.DSI);for(var i in s)t[i]=s[i]}catch(u){if(r.WTF)throw u}var l=$e.find(e,"/!SummaryInformation");if(l&&l.size>0)try{var c=Em(l,Ud,ol.SI);for(var o in c)t[o]==null&&(t[o]=c[o])}catch(u){if(r.WTF)throw u}t.HeadingPairs&&t.TitlesOfParts&&(mg(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function b6(e,t){var r=[],a=[],s=[],i=0,l,c=am(Bd,"n"),o=am(Ud,"n");if(e.Props)for(l=Ht(e.Props),i=0;i<l.length;++i)(Object.prototype.hasOwnProperty.call(c,l[i])?r:Object.prototype.hasOwnProperty.call(o,l[i])?a:s).push([l[i],e.Props[l[i]]]);if(e.Custprops)for(l=Ht(e.Custprops),i=0;i<l.length;++i)Object.prototype.hasOwnProperty.call(e.Props||{},l[i])||(Object.prototype.hasOwnProperty.call(c,l[i])?r:Object.prototype.hasOwnProperty.call(o,l[i])?a:s).push([l[i],e.Custprops[l[i]]]);var u=[];for(i=0;i<s.length;++i)wg.indexOf(s[i][0])>-1||xg.indexOf(s[i][0])>-1||s[i][1]!=null&&u.push(s[i]);a.length&&$e.utils.cfb_add(t,"/SummaryInformation",Tm(a,ol.SI,o,Ud)),(r.length||u.length)&&$e.utils.cfb_add(t,"/DocumentSummaryInformation",Tm(r,ol.DSI,c,Bd,u.length?u:null,ol.UDI))}function pv(e,t){t||(t={}),Ef(t),Ku(),t.codepage&&Xu(t.codepage);var r,a;if(e.FullPaths){if($e.find(e,"/encryption"))throw new Error("File is password-protected");r=$e.find(e,"!CompObj"),a=$e.find(e,"/Workbook")||$e.find(e,"/Book")}else{switch(t.type){case"base64":e=rn(cn(e));break;case"binary":e=rn(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}hr(e,0),a={content:e}}var s,i;if(r&&h6(r),t.bookProps&&!t.bookSheets)s={};else{var l=rt?"buffer":"array";if(a&&a.content)s=v6(a.content,t);else if((i=$e.find(e,"PerfectOffice_MAIN"))&&i.content)s=ps.to_workbook(i.content,(t.type=l,t));else if((i=$e.find(e,"NativeContent_MAIN"))&&i.content)s=ps.to_workbook(i.content,(t.type=l,t));else throw(i=$e.find(e,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&$e.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=D5(e))}var c={};return e.FullPaths&&y6(e,c,t),s.Props=s.Custprops=c,t.bookFiles&&(s.cfb=e),s}function w6(e,t){var r=t||{},a=$e.utils.cfb_new({root:"R"}),s="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":s="/Workbook",r.biff=8;break;case"biff5":s="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return $e.utils.cfb_add(a,s,gv(e,r)),r.biff==8&&(e.Props||e.Custprops)&&b6(e,a),r.biff==8&&e.vbaraw&&I5(a,$e.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),a}var Ul={0:{f:V_},1:{f:Z_},2:{f:vS},3:{f:lS},4:{f:nS},5:{f:hS},6:{f:jS},7:{f:uS},8:{f:FS},9:{f:TS},10:{f:CS},11:{f:ES},12:{f:tS},13:{f:bS},14:{f:oS},15:{f:sS},16:{f:cv},17:{f:_S},18:{f:xS},19:{f:of},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:_C},40:{},42:{},43:{f:jk},44:{f:wk},45:{f:Sk},46:{f:Ek},47:{f:Ck},48:{},49:{f:Kw},50:{},51:{f:c5},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Pg},62:{f:NS},63:{f:g5},64:{f:GS},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Fr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:WS},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:J_},148:{f:K_,p:16},151:{f:RS},152:{},153:{f:NC},154:{},155:{},156:{f:bC},157:{},158:{},159:{T:1,f:L4},160:{T:-1},161:{T:1,f:Rs},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:AS},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:i5},336:{T:-1},337:{f:u5,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Ld},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Ag},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:OS},427:{f:LS},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:US},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:q_},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:IS},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Ld},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:E5},633:{T:1},634:{T:-1},635:{T:1,f:S5},636:{T:-1},637:{f:Qw},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:oC},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:XS},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Gd={6:{f:M0},10:{f:Ta},12:{f:qt},13:{f:qt},14:{f:$t},15:{f:$t},16:{f:Cr},17:{f:$t},18:{f:$t},19:{f:qt},20:{f:Mm},21:{f:Mm},23:{f:Ag},24:{f:Om},25:{f:$t},26:{},27:{},28:{f:Xj},29:{},34:{f:$t},35:{f:Rm},38:{f:Cr},39:{f:Cr},40:{f:Cr},41:{f:Cr},42:{f:$t},43:{f:$t},47:{f:sk},49:{f:bj},51:{f:qt},60:{},61:{f:hj},64:{f:$t},65:{f:yj},66:{f:qt},77:{},80:{},81:{},82:{},85:{f:qt},89:{},90:{},91:{},92:{f:aj},93:{f:qj},94:{},95:{f:$t},96:{},97:{},99:{f:$t},125:{f:Pg},128:{f:Mj},129:{f:ij},130:{f:qt},131:{f:$t},132:{f:$t},133:{f:lj},134:{},140:{f:a4},141:{f:qt},144:{},146:{f:l4},151:{},152:{},153:{},154:{},155:{},156:{f:qt},157:{},158:{},160:{f:m4},161:{f:d4},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:Aj},190:{f:Pj},193:{f:Ta},197:{},198:{},199:{},200:{},201:{},202:{f:$t},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:qt},220:{},221:{f:$t},222:{},224:{f:Ij},225:{f:nj},226:{f:Ta},227:{},229:{f:Kj},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:oj},253:{f:Nj},255:{f:uj},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:Ng},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:$t},353:{f:Ta},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:Uj},431:{f:$t},432:{},433:{},434:{},437:{},438:{f:Zj},439:{f:$t},440:{f:e4},441:{},442:{f:Jl},443:{},444:{f:qt},445:{},446:{},448:{f:Ta},449:{f:mj,r:2},450:{f:Ta},512:{f:Pm},513:{f:x4},515:{f:Lj},516:{f:kj},517:{f:Im},519:{f:h4},520:{f:fj},523:{},545:{f:Lm},549:{f:Am},566:{},574:{f:gj},638:{f:Fj},659:{},1048:{},1054:{f:Sj},1084:{},1212:{f:$j},2048:{f:r4},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:_c},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Ta},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:c4,r:12},2173:{f:a5,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:$t,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:Hj,r:12},2197:{},2198:{f:Qk,r:12},2199:{},2200:{},2201:{},2202:{f:Vj,r:12},2203:{f:Ta},2204:{},2205:{},2206:{},2207:{},2211:{f:xj},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:qt},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:u4},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:i4},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:Pm},1:{},2:{f:b4},3:{f:v4},4:{f:g4},5:{f:Im},7:{f:N4},8:{},9:{f:_c},11:{},22:{f:qt},30:{f:Ej},31:{},32:{},33:{f:Lm},36:{},37:{f:Am},50:{f:j4},62:{},52:{},67:{},68:{f:qt},69:{},86:{},126:{},127:{f:p4},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:k4},223:{},234:{},354:{},421:{},518:{f:M0},521:{f:_c},536:{f:Om},547:{f:Rm},561:{},579:{},1030:{f:M0},1033:{f:_c},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function De(e,t,r,a){var s=t;if(!isNaN(s)){var i=a||(r||[]).length||0,l=e.next(4);l.write_shift(2,s),l.write_shift(2,i),i>0&&sf(r)&&e.push(r)}}function N6(e,t,r,a){var s=(r||[]).length||0;if(s<=8224)return De(e,t,r,s);var i=t;if(!isNaN(i)){for(var l=r.parts||[],c=0,o=0,u=0;u+(l[c]||8224)<=8224;)u+=l[c]||8224,c++;var d=e.next(4);for(d.write_shift(2,i),d.write_shift(2,u),e.push(r.slice(o,o+u)),o+=u;o<s;){for(d=e.next(4),d.write_shift(2,60),u=0;u+(l[c]||8224)<=8224;)u+=l[c]||8224,c++;d.write_shift(2,u),e.push(r.slice(o,o+u)),o+=u}}}function tc(e,t,r){return e||(e=ye(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function j6(e,t,r,a){var s=ye(9);return tc(s,e,t),jg(r,a||"b",s),s}function k6(e,t,r){var a=ye(8+2*r.length);return tc(a,e,t),a.write_shift(1,r.length),a.write_shift(r.length,r,"sbcs"),a.l<a.length?a.slice(0,a.l):a}function _6(e,t,r,a){if(t.v!=null)switch(t.t){case"d":case"n":var s=t.t=="d"?tr(Tt(t.v)):t.v;s==(s|0)&&s>=0&&s<65536?De(e,2,w4(r,a,s)):De(e,3,y4(r,a,s));return;case"b":case"e":De(e,5,j6(r,a,t.v,t.t));return;case"s":case"str":De(e,4,k6(r,a,(t.v||"").slice(0,255)));return}De(e,1,tc(null,r,a))}function S6(e,t,r,a){var s=Array.isArray(t),i=ut(t["!ref"]||"A1"),l,c="",o=[];if(i.e.c>255||i.e.r>16383){if(a.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),l=et(i)}for(var u=i.s.r;u<=i.e.r;++u){c=Gt(u);for(var d=i.s.c;d<=i.e.c;++d){u===i.s.r&&(o[d]=Mt(d)),l=o[d]+c;var f=s?(t[u]||[])[d]:t[l];f&&_6(e,f,u,d)}}}function C6(e,t){for(var r=t||{},a=qr(),s=0,i=0;i<e.SheetNames.length;++i)e.SheetNames[i]==r.sheet&&(s=i);if(s==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return De(a,r.biff==4?1033:r.biff==3?521:9,pf(e,16,r)),S6(a,e.Sheets[e.SheetNames[s]],s,r),De(a,10),a.end()}function E6(e,t,r){De(e,49,wj({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},r))}function T6(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var s=a[0];s<=a[1];++s)t[s]!=null&&De(e,1054,Cj(s,t[s],r))})}function F6(e,t){var r=ye(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),De(e,2151,r),r=ye(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),Eg(ut(t["!ref"]||"A1"),r),r.write_shift(4,4),De(e,2152,r)}function A6(e,t){for(var r=0;r<16;++r)De(e,224,Dm({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(a){De(e,224,Dm(a,0,t))})}function P6(e,t){for(var r=0;r<t["!links"].length;++r){var a=t["!links"][r];De(e,440,t4(a)),a[1].Tooltip&&De(e,2048,n4(a))}delete t["!links"]}function D6(e,t){if(t){var r=0;t.forEach(function(a,s){++r<=256&&a&&De(e,125,o4(e0(s,a),s))})}}function I6(e,t,r,a,s){var i=16+as(s.cellXfs,t,s);if(t.v==null&&!t.bf){De(e,513,Es(r,a,i));return}if(t.bf)De(e,6,i_(t,r,a,s,i));else switch(t.t){case"d":case"n":var l=t.t=="d"?tr(Tt(t.v)):t.v;De(e,515,Bj(r,a,l,i));break;case"b":case"e":De(e,517,Oj(r,a,t.v,i,s,t.t));break;case"s":case"str":if(s.bookSST){var c=kf(s.Strings,t.v,s.revStrings);De(e,253,jj(r,a,c,i))}else De(e,516,_j(r,a,(t.v||"").slice(0,255),i,s));break;default:De(e,513,Es(r,a,i))}}function M6(e,t,r){var a=qr(),s=r.SheetNames[e],i=r.Sheets[s]||{},l=(r||{}).Workbook||{},c=(l.Sheets||[])[e]||{},o=Array.isArray(i),u=t.biff==8,d,f="",x=[],h=ut(i["!ref"]||"A1"),p=u?65536:16384;if(h.e.c>255||h.e.r>=p){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");h.e.c=Math.min(h.e.c,255),h.e.r=Math.min(h.e.c,p-1)}De(a,2057,pf(r,16,t)),De(a,13,gn(1)),De(a,12,gn(100)),De(a,15,Rr(!0)),De(a,17,Rr(!1)),De(a,16,Ss(.001)),De(a,95,Rr(!0)),De(a,42,Rr(!1)),De(a,43,Rr(!1)),De(a,130,gn(1)),De(a,128,Rj()),De(a,131,Rr(!1)),De(a,132,Rr(!1)),u&&D6(a,i["!cols"]),De(a,512,Tj(h,t)),u&&(i["!links"]=[]);for(var m=h.s.r;m<=h.e.r;++m){f=Gt(m);for(var w=h.s.c;w<=h.e.c;++w){m===h.s.r&&(x[w]=Mt(w)),d=x[w]+f;var v=o?(i[m]||[])[w]:i[d];v&&(I6(a,v,m,w,t),u&&v.l&&i["!links"].push([d,v.l]))}}var b=c.CodeName||c.name||s;return u&&De(a,574,vj((l.Views||[])[0])),u&&(i["!merges"]||[]).length&&De(a,229,Yj(i["!merges"])),u&&P6(a,i),De(a,442,kg(b)),u&&F6(a,i),De(a,10),a.end()}function R6(e,t,r){var a=qr(),s=(e||{}).Workbook||{},i=s.Sheets||[],l=s.WBProps||{},c=r.biff==8,o=r.biff==5;if(De(a,2057,pf(e,5,r)),r.bookType=="xla"&&De(a,135),De(a,225,c?gn(1200):null),De(a,193,ON(2)),o&&De(a,191),o&&De(a,192),De(a,226),De(a,92,sj("SheetJS",r)),De(a,66,gn(c?1200:1252)),c&&De(a,353,gn(0)),c&&De(a,448),De(a,317,f4(e.SheetNames.length)),c&&e.vbaraw&&De(a,211),c&&e.vbaraw){var u=l.CodeName||"ThisWorkbook";De(a,442,kg(u))}De(a,156,gn(17)),De(a,25,Rr(!1)),De(a,18,Rr(!1)),De(a,19,gn(0)),c&&De(a,431,Rr(!1)),c&&De(a,444,gn(0)),De(a,61,pj()),De(a,64,Rr(!1)),De(a,141,gn(0)),De(a,34,Rr(mC(e)=="true")),De(a,14,Rr(!0)),c&&De(a,439,Rr(!1)),De(a,218,gn(0)),E6(a,e,r),T6(a,e.SSF,r),A6(a,r),c&&De(a,352,Rr(!1));var d=a.end(),f=qr();c&&De(f,140,s4()),c&&r.Strings&&N6(f,252,dj(r.Strings)),De(f,10);var x=f.end(),h=qr(),p=0,m=0;for(m=0;m<e.SheetNames.length;++m)p+=(c?12:11)+(c?2:1)*e.SheetNames[m].length;var w=d.length+p+x.length;for(m=0;m<e.SheetNames.length;++m){var v=i[m]||{};De(h,133,cj({pos:w,hs:v.Hidden||0,dt:0,name:e.SheetNames[m]},r)),w+=t[m].length}var b=h.end();if(p!=b.length)throw new Error("BS8 "+p+" != "+b.length);var y=[];return d.length&&y.push(d),b.length&&y.push(b),x.length&&y.push(x),lr(y)}function O6(e,t){var r=t||{},a=[];e&&!e.SSF&&(e.SSF=Ft(Ge)),e&&e.SSF&&(Ci(),Xo(e.SSF),r.revssf=Yo(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Tf(r),r.cellXfs=[],as(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var s=0;s<e.SheetNames.length;++s)a[a.length]=M6(s,r,e);return a.unshift(R6(e,a,r)),lr(a)}function gv(e,t){for(var r=0;r<=e.SheetNames.length;++r){var a=e.Sheets[e.SheetNames[r]];if(!(!a||!a["!ref"])){var s=Jr(a["!ref"]);s.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var i=t||{};switch(i.biff||2){case 8:case 5:return O6(e,t);case 4:case 3:case 2:return C6(e,t)}throw new Error("invalid type "+i.bookType+" for BIFF")}function Km(e,t){var r=t||{},a=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var s=e.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var i=e.match(/<\/table/i),l=s.index,c=i&&i.index||e.length,o=ww(e.slice(l,c),/(:?<tr[^>]*>)/i,"<tr>"),u=-1,d=0,f=0,x=0,h={s:{r:1e7,c:1e7},e:{r:0,c:0}},p=[];for(l=0;l<o.length;++l){var m=o[l].trim(),w=m.slice(0,3).toLowerCase();if(w=="<tr"){if(++u,r.sheetRows&&r.sheetRows<=u){--u;break}d=0;continue}if(!(w!="<td"&&w!="<th")){var v=m.split(/<\/t[dh]>/i);for(c=0;c<v.length;++c){var b=v[c].trim();if(b.match(/<t[dh]/i)){for(var y=b,N=0;y.charAt(0)=="<"&&(N=y.indexOf(">"))>-1;)y=y.slice(N+1);for(var F=0;F<p.length;++F){var j=p[F];j.s.c==d&&j.s.r<u&&u<=j.e.r&&(d=j.e.c+1,F=-1)}var k=Ye(b.slice(0,b.indexOf(">")));x=k.colspan?+k.colspan:1,((f=+k.rowspan)>1||x>1)&&p.push({s:{r:u,c:d},e:{r:u+(f||1)-1,c:d+x-1}});var S=k.t||k["data-t"]||"";if(!y.length){d+=x;continue}if(y=z1(y),h.s.r>u&&(h.s.r=u),h.e.r<u&&(h.e.r=u),h.s.c>d&&(h.s.c=d),h.e.c<d&&(h.e.c=d),!y.length){d+=x;continue}var P={t:"s",v:y};r.raw||!y.trim().length||S=="s"||(y==="TRUE"?P={t:"b",v:!0}:y==="FALSE"?P={t:"b",v:!1}:isNaN(Un(y))?isNaN(bi(y).getDate())||(P={t:"d",v:Tt(y)},r.cellDates||(P={t:"n",v:tr(P.v)}),P.z=r.dateNF||Ge[14]):P={t:"n",v:Un(y)}),r.dense?(a[u]||(a[u]=[]),a[u][d]=P):a[Ke({r:u,c:d})]=P,d+=x}}}}return a["!ref"]=et(h),p.length&&(a["!merges"]=p),a}function L6(e,t,r,a){for(var s=e["!merges"]||[],i=[],l=t.s.c;l<=t.e.c;++l){for(var c=0,o=0,u=0;u<s.length;++u)if(!(s[u].s.r>r||s[u].s.c>l)&&!(s[u].e.r<r||s[u].e.c<l)){if(s[u].s.r<r||s[u].s.c<l){c=-1;break}c=s[u].e.r-s[u].s.r+1,o=s[u].e.c-s[u].s.c+1;break}if(!(c<0)){var d=Ke({r,c:l}),f=a.dense?(e[r]||[])[l]:e[d],x=f&&f.v!=null&&(f.h||rf(f.w||(va(f),f.w)||""))||"",h={};c>1&&(h.rowspan=c),o>1&&(h.colspan=o),a.editable?x='<span contenteditable="true">'+x+"</span>":f&&(h["data-t"]=f&&f.t||"z",f.v!=null&&(h["data-v"]=f.v),f.z!=null&&(h["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(x='<a href="'+f.l.Target+'">'+x+"</a>")),h.id=(a.id||"sjs")+"-"+d,i.push(Ae("td",x,h))}}var p="<tr>";return p+i.join("")+"</tr>"}var B6='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',U6="</body></html>";function z6(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return ns(Km(r[0],t),t);var a=Pf();return r.forEach(function(s,i){Df(a,Km(s,t),"Sheet"+(i+1))}),a}function W6(e,t,r){var a=[];return a.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function vv(e,t){var r=t||{},a=r.header!=null?r.header:B6,s=r.footer!=null?r.footer:U6,i=[a],l=Jr(e["!ref"]);r.dense=Array.isArray(e),i.push(W6(e,l,r));for(var c=l.s.r;c<=l.e.r;++c)i.push(L6(e,l,c,r));return i.push("</table>"+s),i.join("")}function yv(e,t,r){var a=r||{},s=0,i=0;if(a.origin!=null)if(typeof a.origin=="number")s=a.origin;else{var l=typeof a.origin=="string"?Rt(a.origin):a.origin;s=l.r,i=l.c}var c=t.getElementsByTagName("tr"),o=Math.min(a.sheetRows||1e7,c.length),u={s:{r:0,c:0},e:{r:s,c:i}};if(e["!ref"]){var d=Jr(e["!ref"]);u.s.r=Math.min(u.s.r,d.s.r),u.s.c=Math.min(u.s.c,d.s.c),u.e.r=Math.max(u.e.r,d.e.r),u.e.c=Math.max(u.e.c,d.e.c),s==-1&&(u.e.r=s=d.e.r+1)}var f=[],x=0,h=e["!rows"]||(e["!rows"]=[]),p=0,m=0,w=0,v=0,b=0,y=0;for(e["!cols"]||(e["!cols"]=[]);p<c.length&&m<o;++p){var N=c[p];if(Ym(N)){if(a.display)continue;h[m]={hidden:!0}}var F=N.children;for(w=v=0;w<F.length;++w){var j=F[w];if(!(a.display&&Ym(j))){var k=j.hasAttribute("data-v")?j.getAttribute("data-v"):j.hasAttribute("v")?j.getAttribute("v"):z1(j.innerHTML),S=j.getAttribute("data-z")||j.getAttribute("z");for(x=0;x<f.length;++x){var P=f[x];P.s.c==v+i&&P.s.r<m+s&&m+s<=P.e.r&&(v=P.e.c+1-i,x=-1)}y=+j.getAttribute("colspan")||1,((b=+j.getAttribute("rowspan")||1)>1||y>1)&&f.push({s:{r:m+s,c:v+i},e:{r:m+s+(b||1)-1,c:v+i+(y||1)-1}});var D={t:"s",v:k},K=j.getAttribute("data-t")||j.getAttribute("t")||"";k!=null&&(k.length==0?D.t=K||"z":a.raw||k.trim().length==0||K=="s"||(k==="TRUE"?D={t:"b",v:!0}:k==="FALSE"?D={t:"b",v:!1}:isNaN(Un(k))?isNaN(bi(k).getDate())||(D={t:"d",v:Tt(k)},a.cellDates||(D={t:"n",v:tr(D.v)}),D.z=a.dateNF||Ge[14]):D={t:"n",v:Un(k)})),D.z===void 0&&S!=null&&(D.z=S);var C="",Y=j.getElementsByTagName("A");if(Y&&Y.length)for(var B=0;B<Y.length&&!(Y[B].hasAttribute("href")&&(C=Y[B].getAttribute("href"),C.charAt(0)!="#"));++B);C&&C.charAt(0)!="#"&&(D.l={Target:C}),a.dense?(e[m+s]||(e[m+s]=[]),e[m+s][v+i]=D):e[Ke({c:v+i,r:m+s})]=D,u.e.c<v+i&&(u.e.c=v+i),v+=y}}++m}return f.length&&(e["!merges"]=(e["!merges"]||[]).concat(f)),u.e.r=Math.max(u.e.r,m-1+s),e["!ref"]=et(u),m>=o&&(e["!fullref"]=et((u.e.r=c.length-p+m-1+s,u))),e}function bv(e,t){var r=t||{},a=r.dense?[]:{};return yv(a,e,t)}function H6(e,t){return ns(bv(e,t),t)}function Ym(e){var t="",r=$6(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function $6(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function V6(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(a,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=dt(t.replace(/<[^>]*>/g,""));return[r]}var qm={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function wv(e,t){var r=t||{},a=nf(e),s=[],i,l,c={name:""},o="",u=0,d,f,x={},h=[],p=r.dense?[]:{},m,w,v={value:""},b="",y=0,N=[],F=-1,j=-1,k={s:{r:1e6,c:1e7},e:{r:0,c:0}},S=0,P={},D=[],K={},C=0,Y=0,B=[],ee=1,re=1,Q=[],te={Names:[]},H={},ae=["",""],he=[],O={},I="",g=0,_=!1,A=!1,ne=0;for(Il.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");m=Il.exec(a);)switch(m[3]=m[3].replace(/_.*$/,"")){case"table":case"工作表":m[1]==="/"?(k.e.c>=k.s.c&&k.e.r>=k.s.r?p["!ref"]=et(k):p["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=k.e.r&&(p["!fullref"]=p["!ref"],k.e.r=r.sheetRows-1,p["!ref"]=et(k)),D.length&&(p["!merges"]=D),B.length&&(p["!rows"]=B),d.name=d.名称||d.name,typeof JSON<"u"&&JSON.stringify(d),h.push(d.name),x[d.name]=p,A=!1):m[0].charAt(m[0].length-2)!=="/"&&(d=Ye(m[0],!1),F=j=-1,k.s.r=k.s.c=1e7,k.e.r=k.e.c=0,p=r.dense?[]:{},D=[],B=[],A=!0);break;case"table-row-group":m[1]==="/"?--S:++S;break;case"table-row":case"行":if(m[1]==="/"){F+=ee,ee=1;break}if(f=Ye(m[0],!1),f.行号?F=f.行号-1:F==-1&&(F=0),ee=+f["number-rows-repeated"]||1,ee<10)for(ne=0;ne<ee;++ne)S>0&&(B[F+ne]={level:S});j=-1;break;case"covered-table-cell":m[1]!=="/"&&++j,r.sheetStubs&&(r.dense?(p[F]||(p[F]=[]),p[F][j]={t:"z"}):p[Ke({r:F,c:j})]={t:"z"}),b="",N=[];break;case"table-cell":case"数据":if(m[0].charAt(m[0].length-2)==="/")++j,v=Ye(m[0],!1),re=parseInt(v["number-columns-repeated"]||"1",10),w={t:"z",v:null},v.formula&&r.cellFormula!=!1&&(w.f=Vm(dt(v.formula))),(v.数据类型||v["value-type"])=="string"&&(w.t="s",w.v=dt(v["string-value"]||""),r.dense?(p[F]||(p[F]=[]),p[F][j]=w):p[Ke({r:F,c:j})]=w),j+=re-1;else if(m[1]!=="/"){++j,b="",y=0,N=[],re=1;var ue=ee?F+ee-1:F;if(j>k.e.c&&(k.e.c=j),j<k.s.c&&(k.s.c=j),F<k.s.r&&(k.s.r=F),ue>k.e.r&&(k.e.r=ue),v=Ye(m[0],!1),he=[],O={},w={t:v.数据类型||v["value-type"],v:null},r.cellFormula)if(v.formula&&(v.formula=dt(v.formula)),v["number-matrix-columns-spanned"]&&v["number-matrix-rows-spanned"]&&(C=parseInt(v["number-matrix-rows-spanned"],10)||0,Y=parseInt(v["number-matrix-columns-spanned"],10)||0,K={s:{r:F,c:j},e:{r:F+C-1,c:j+Y-1}},w.F=et(K),Q.push([K,w.F])),v.formula)w.f=Vm(v.formula);else for(ne=0;ne<Q.length;++ne)F>=Q[ne][0].s.r&&F<=Q[ne][0].e.r&&j>=Q[ne][0].s.c&&j<=Q[ne][0].e.c&&(w.F=Q[ne][1]);switch((v["number-columns-spanned"]||v["number-rows-spanned"])&&(C=parseInt(v["number-rows-spanned"],10)||0,Y=parseInt(v["number-columns-spanned"],10)||0,K={s:{r:F,c:j},e:{r:F+C-1,c:j+Y-1}},D.push(K)),v["number-columns-repeated"]&&(re=parseInt(v["number-columns-repeated"],10)),w.t){case"boolean":w.t="b",w.v=_t(v["boolean-value"]);break;case"float":w.t="n",w.v=parseFloat(v.value);break;case"percentage":w.t="n",w.v=parseFloat(v.value);break;case"currency":w.t="n",w.v=parseFloat(v.value);break;case"date":w.t="d",w.v=Tt(v["date-value"]),r.cellDates||(w.t="n",w.v=tr(w.v)),w.z="m/d/yy";break;case"time":w.t="n",w.v=vw(v["time-value"])/86400,r.cellDates&&(w.t="d",w.v=qo(w.v)),w.z="HH:MM:SS";break;case"number":w.t="n",w.v=parseFloat(v.数据数值);break;default:if(w.t==="string"||w.t==="text"||!w.t)w.t="s",v["string-value"]!=null&&(b=dt(v["string-value"]),N=[]);else throw new Error("Unsupported value type "+w.t)}}else{if(_=!1,w.t==="s"&&(w.v=b||"",N.length&&(w.R=N),_=y==0),H.Target&&(w.l=H),he.length>0&&(w.c=he,he=[]),b&&r.cellText!==!1&&(w.w=b),_&&(w.t="z",delete w.v),(!_||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=F))for(var ve=0;ve<ee;++ve){if(re=parseInt(v["number-columns-repeated"]||"1",10),r.dense)for(p[F+ve]||(p[F+ve]=[]),p[F+ve][j]=ve==0?w:Ft(w);--re>0;)p[F+ve][j+re]=Ft(w);else for(p[Ke({r:F+ve,c:j})]=w;--re>0;)p[Ke({r:F+ve,c:j+re})]=Ft(w);k.e.c<=j&&(k.e.c=j)}re=parseInt(v["number-columns-repeated"]||"1",10),j+=re-1,re=0,w={},b="",N=[]}H={};break;case"document":case"document-content":case"电子表格文档":case"spreadsheet":case"主体":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(m[1]==="/"){if((i=s.pop())[0]!==m[3])throw"Bad state: "+i}else m[0].charAt(m[0].length-2)!=="/"&&s.push([m[3],!0]);break;case"annotation":if(m[1]==="/"){if((i=s.pop())[0]!==m[3])throw"Bad state: "+i;O.t=b,N.length&&(O.R=N),O.a=I,he.push(O)}else m[0].charAt(m[0].length-2)!=="/"&&s.push([m[3],!1]);I="",g=0,b="",y=0,N=[];break;case"creator":m[1]==="/"?I=a.slice(g,m.index):g=m.index+m[0].length;break;case"meta":case"元数据":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(m[1]==="/"){if((i=s.pop())[0]!==m[3])throw"Bad state: "+i}else m[0].charAt(m[0].length-2)!=="/"&&s.push([m[3],!1]);b="",y=0,N=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(m[1]==="/"){if(P[c.name]=o,(i=s.pop())[0]!==m[3])throw"Bad state: "+i}else m[0].charAt(m[0].length-2)!=="/"&&(o="",c=Ye(m[0],!1),s.push([m[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":l=Ye(m[0],!1),o+=qm[m[3]][l.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":l=Ye(m[0],!1),o+=qm[m[3]][l.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(m[0].slice(-2)==="/>")break;if(m[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":o+=a.slice(u,m.index);break}else u=m.index+m[0].length;break;case"named-range":l=Ye(m[0],!1),ae=R0(l["cell-range-address"]);var xe={Name:l.name,Ref:ae[0]+"!"+ae[1]};A&&(xe.Sheet=h.length),te.Names.push(xe);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"电子表格":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"文本串":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(m[1]==="/"&&(!v||!v["string-value"])){var W=V6(a.slice(y,m.index));b=(b.length>0?b+`
`:"")+W[0]}else Ye(m[0],!1),y=m.index+m[0].length;break;case"s":break;case"database-range":if(m[1]==="/")break;try{ae=R0(Ye(m[0])["target-range-address"]),x[ae[0]]["!autofilter"]={ref:ae[1]}}catch{}break;case"date":break;case"object":break;case"title":case"标题":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(m[1]!=="/"){if(H=Ye(m[0],!1),!H.href)break;H.Target=dt(H.href),delete H.href,H.Target.charAt(0)=="#"&&H.Target.indexOf(".")>-1?(ae=R0(H.Target.slice(1)),H.Target="#"+ae[0]+"!"+ae[1]):H.Target.match(/^\.\.[\\\/]/)&&(H.Target=H.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(m[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"表:":case"字:":break;default:if(r.WTF)throw new Error(m)}}var E={Sheets:x,SheetNames:h,Workbook:te};return r.bookSheets&&delete E.Sheets,E}function Jm(e,t){t=t||{},pn(e,"META-INF/manifest.xml")&&vN(Yt(e,"META-INF/manifest.xml"),t);var r=nn(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var a=wv(vt(r),t);return pn(e,"meta.xml")&&(a.Props=ug(Yt(e,"meta.xml"))),a}function Qm(e,t){return wv(e,t)}var G6=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+Dl({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Xt+t}}(),Zm=function(){var e=function(i){return pt(i).replace(/  +/g,function(l){return'<text:s text:c="'+l.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,a=function(i,l,c){var o=[];o.push('      <table:table table:name="'+pt(l.SheetNames[c])+`" table:style-name="ta1">
`);var u=0,d=0,f=Jr(i["!ref"]||"A1"),x=i["!merges"]||[],h=0,p=Array.isArray(i);if(i["!cols"])for(d=0;d<=f.e.c;++d)o.push("        <table:table-column"+(i["!cols"][d]?' table:style-name="co'+i["!cols"][d].ods+'"':"")+`></table:table-column>
`);var m="",w=i["!rows"]||[];for(u=0;u<f.s.r;++u)m=w[u]?' table:style-name="ro'+w[u].ods+'"':"",o.push("        <table:table-row"+m+`></table:table-row>
`);for(;u<=f.e.r;++u){for(m=w[u]?' table:style-name="ro'+w[u].ods+'"':"",o.push("        <table:table-row"+m+`>
`),d=0;d<f.s.c;++d)o.push(t);for(;d<=f.e.c;++d){var v=!1,b={},y="";for(h=0;h!=x.length;++h)if(!(x[h].s.c>d)&&!(x[h].s.r>u)&&!(x[h].e.c<d)&&!(x[h].e.r<u)){(x[h].s.c!=d||x[h].s.r!=u)&&(v=!0),b["table:number-columns-spanned"]=x[h].e.c-x[h].s.c+1,b["table:number-rows-spanned"]=x[h].e.r-x[h].s.r+1;break}if(v){o.push(r);continue}var N=Ke({r:u,c:d}),F=p?(i[u]||[])[d]:i[N];if(F&&F.f&&(b["table:formula"]=pt(f_(F.f)),F.F&&F.F.slice(0,N.length)==N)){var j=Jr(F.F);b["table:number-matrix-columns-spanned"]=j.e.c-j.s.c+1,b["table:number-matrix-rows-spanned"]=j.e.r-j.s.r+1}if(!F){o.push(t);continue}switch(F.t){case"b":y=F.v?"TRUE":"FALSE",b["office:value-type"]="boolean",b["office:boolean-value"]=F.v?"true":"false";break;case"n":y=F.w||String(F.v||0),b["office:value-type"]="float",b["office:value"]=F.v||0;break;case"s":case"str":y=F.v==null?"":F.v,b["office:value-type"]="string";break;case"d":y=F.w||Tt(F.v).toISOString(),b["office:value-type"]="date",b["office:date-value"]=Tt(F.v).toISOString(),b["table:style-name"]="ce1";break;default:o.push(t);continue}var k=e(y);if(F.l&&F.l.Target){var S=F.l.Target;S=S.charAt(0)=="#"?"#"+x_(S.slice(1)):S,S.charAt(0)!="#"&&!S.match(/^\w+:/)&&(S="../"+S),k=Ae("text:a",k,{"xlink:href":S.replace(/&/g,"&amp;")})}o.push("          "+Ae("table:table-cell",Ae("text:p",k,{}),b)+`
`)}o.push(`        </table:table-row>
`)}return o.push(`      </table:table>
`),o.join("")},s=function(i,l){i.push(` <office:automatic-styles>
`),i.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),i.push(`   <number:month number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:day number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:year/>
`),i.push(`  </number:date-style>
`);var c=0;l.SheetNames.map(function(u){return l.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var d=0;d<u["!cols"].length;++d)if(u["!cols"][d]){var f=u["!cols"][d];if(f.width==null&&f.wpx==null&&f.wch==null)continue;qa(f),f.ods=c;var x=u["!cols"][d].wpx+"px";i.push('  <style:style style:name="co'+c+`" style:family="table-column">
`),i.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+x+`"/>
`),i.push(`  </style:style>
`),++c}}});var o=0;l.SheetNames.map(function(u){return l.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var d=0;d<u["!rows"].length;++d)if(u["!rows"][d]){u["!rows"][d].ods=o;var f=u["!rows"][d].hpx+"px";i.push('  <style:style style:name="ro'+o+`" style:family="table-row">
`),i.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+f+`"/>
`),i.push(`  </style:style>
`),++o}}}),i.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),i.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),i.push(`  </style:style>
`),i.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),i.push(` </office:automatic-styles>
`)};return function(l,c){var o=[Xt],u=Dl({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),d=Dl({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});c.bookType=="fods"?(o.push("<office:document"+u+d+`>
`),o.push(dg().replace(/office:document-meta/g,"office:meta"))):o.push("<office:document-content"+u+`>
`),s(o,l),o.push(`  <office:body>
`),o.push(`    <office:spreadsheet>
`);for(var f=0;f!=l.SheetNames.length;++f)o.push(a(l.Sheets[l.SheetNames[f]],l,f));return o.push(`    </office:spreadsheet>
`),o.push(`  </office:body>
`),c.bookType=="fods"?o.push("</office:document>"):o.push("</office:document-content>"),o.join("")}}();function Nv(e,t){if(t.bookType=="fods")return Zm(e,t);var r=Zu(),a="",s=[],i=[];return a="mimetype",tt(r,a,"application/vnd.oasis.opendocument.spreadsheet"),a="content.xml",tt(r,a,Zm(e,t)),s.push([a,"text/xml"]),i.push([a,"ContentFile"]),a="styles.xml",tt(r,a,G6(e,t)),s.push([a,"text/xml"]),i.push([a,"StylesFile"]),a="meta.xml",tt(r,a,Xt+dg()),s.push([a,"text/xml"]),i.push([a,"MetadataFile"]),a="manifest.rdf",tt(r,a,wN(i)),s.push([a,"application/rdf+xml"]),a="META-INF/manifest.xml",tt(r,a,yN(s)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Ts(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Xd(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):vt(rs(e))}function X6(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):rn(qn(e))}function K6(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var a=0;a<t.length;++a)if(e[r+a]!=t[a])continue e;return!0}return!1}function Qa(e){var t=e.reduce(function(s,i){return s+i.length},0),r=new Uint8Array(t),a=0;return e.forEach(function(s){r.set(s,a),a+=s.length}),r}function eh(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function Y6(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,a=e[t+14]&1,s=t+13;s>=t;--s)a=a*256+e[s];return(e[t+15]&128?-a:a)*Math.pow(10,r-6176)}function q6(e,t,r){var a=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,s=r/Math.pow(10,a-6176);e[t+15]|=a>>7,e[t+14]|=(a&127)<<1;for(var i=0;s>=1;++i,s/=256)e[t+i]=s&255;e[t+15]|=r>=0?0:128}function zl(e,t){var r=t?t[0]:0,a=e[r]&127;e:if(e[r++]>=128&&(a|=(e[r]&127)<<7,e[r++]<128||(a|=(e[r]&127)<<14,e[r++]<128)||(a|=(e[r]&127)<<21,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),a}function mt(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function Wt(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function ft(e){for(var t=[],r=[0];r[0]<e.length;){var a=r[0],s=zl(e,r),i=s&7;s=Math.floor(s/8);var l=0,c;if(s==0)break;switch(i){case 0:{for(var o=r[0];e[r[0]++]>=128;);c=e.slice(o,r[0])}break;case 5:l=4,c=e.slice(r[0],r[0]+l),r[0]+=l;break;case 1:l=8,c=e.slice(r[0],r[0]+l),r[0]+=l;break;case 2:l=zl(e,r),c=e.slice(r[0],r[0]+l),r[0]+=l;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(s," at offset ").concat(a))}var u={data:c,type:i};t[s]==null?t[s]=[u]:t[s].push(u)}return t}function fr(e){var t=[];return e.forEach(function(r,a){r.forEach(function(s){s.data&&(t.push(mt(a*8+s.type)),s.type==2&&t.push(mt(s.data.length)),t.push(s.data))})}),Qa(t)}function Cf(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function mn(e){for(var t,r=[],a=[0];a[0]<e.length;){var s=zl(e,a),i=ft(e.slice(a[0],a[0]+s));a[0]+=s;var l={id:Wt(i[1][0].data),messages:[]};i[2].forEach(function(c){var o=ft(c.data),u=Wt(o[3][0].data);l.messages.push({meta:o,data:e.slice(a[0],a[0]+u)}),a[0]+=u}),(t=i[3])!=null&&t[0]&&(l.merge=Wt(i[3][0].data)>>>0>0),r.push(l)}return r}function Us(e){var t=[];return e.forEach(function(r){var a=[];a[1]=[{data:mt(r.id),type:0}],a[2]=[],r.merge!=null&&(a[3]=[{data:mt(+!!r.merge),type:0}]);var s=[];r.messages.forEach(function(l){s.push(l.data),l.meta[3]=[{type:0,data:mt(l.data.length)}],a[2].push({data:fr(l.meta),type:2})});var i=fr(a);t.push(mt(i.length)),t.push(i),s.forEach(function(l){return t.push(l)})}),Qa(t)}function J6(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],a=zl(t,r),s=[];r[0]<t.length;){var i=t[r[0]]&3;if(i==0){var l=t[r[0]++]>>2;if(l<60)++l;else{var c=l-59;l=t[r[0]],c>1&&(l|=t[r[0]+1]<<8),c>2&&(l|=t[r[0]+2]<<16),c>3&&(l|=t[r[0]+3]<<24),l>>>=0,l++,r[0]+=c}s.push(t.slice(r[0],r[0]+l)),r[0]+=l;continue}else{var o=0,u=0;if(i==1?(u=(t[r[0]]>>2&7)+4,o=(t[r[0]++]&224)<<3,o|=t[r[0]++]):(u=(t[r[0]++]>>2)+1,i==2?(o=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(o=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),s=[Qa(s)],o==0)throw new Error("Invalid offset 0");if(o>s[0].length)throw new Error("Invalid offset beyond length");if(u>=o)for(s.push(s[0].slice(-o)),u-=o;u>=s[s.length-1].length;)s.push(s[s.length-1]),u-=s[s.length-1].length;s.push(s[0].slice(-o,-o+u))}}var d=Qa(s);if(d.length!=a)throw new Error("Unexpected length: ".concat(d.length," != ").concat(a));return d}function hn(e){for(var t=[],r=0;r<e.length;){var a=e[r++],s=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(J6(a,e.slice(r,r+s))),r+=s}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Qa(t)}function zs(e){for(var t=[],r=0;r<e.length;){var a=Math.min(e.length-r,268435455),s=new Uint8Array(4);t.push(s);var i=mt(a),l=i.length;t.push(i),a<=60?(l++,t.push(new Uint8Array([a-1<<2]))):a<=256?(l+=2,t.push(new Uint8Array([240,a-1&255]))):a<=65536?(l+=3,t.push(new Uint8Array([244,a-1&255,a-1>>8&255]))):a<=16777216?(l+=4,t.push(new Uint8Array([248,a-1&255,a-1>>8&255,a-1>>16&255]))):a<=4294967296&&(l+=5,t.push(new Uint8Array([252,a-1&255,a-1>>8&255,a-1>>16&255,a-1>>>24&255]))),t.push(e.slice(r,r+a)),l+=a,s[0]=0,s[1]=l&255,s[2]=l>>8&255,s[3]=l>>16&255,r+=a}return Qa(t)}function Q6(e,t,r,a){var s=Ts(e),i=s.getUint32(4,!0),l=(a>1?12:8)+eh(i&(a>1?3470:398))*4,c=-1,o=-1,u=NaN,d=new Date(2001,0,1);i&512&&(c=s.getUint32(l,!0),l+=4),l+=eh(i&(a>1?12288:4096))*4,i&16&&(o=s.getUint32(l,!0),l+=4),i&32&&(u=s.getFloat64(l,!0),l+=8),i&64&&(d.setTime(d.getTime()+s.getFloat64(l,!0)*1e3),l+=8);var f;switch(e[2]){case 0:break;case 2:f={t:"n",v:u};break;case 3:f={t:"s",v:t[o]};break;case 5:f={t:"d",v:d};break;case 6:f={t:"b",v:u>0};break;case 7:f={t:"n",v:u/86400};break;case 8:f={t:"e",v:0};break;case 9:if(c>-1)f={t:"s",v:r[c]};else if(o>-1)f={t:"s",v:t[o]};else if(!isNaN(u))f={t:"n",v:u};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return f}function Z6(e,t,r){var a=Ts(e),s=a.getUint32(8,!0),i=12,l=-1,c=-1,o=NaN,u=NaN,d=new Date(2001,0,1);s&1&&(o=Y6(e,i),i+=16),s&2&&(u=a.getFloat64(i,!0),i+=8),s&4&&(d.setTime(d.getTime()+a.getFloat64(i,!0)*1e3),i+=8),s&8&&(c=a.getUint32(i,!0),i+=4),s&16&&(l=a.getUint32(i,!0),i+=4);var f;switch(e[1]){case 0:break;case 2:f={t:"n",v:o};break;case 3:f={t:"s",v:t[c]};break;case 5:f={t:"d",v:d};break;case 6:f={t:"b",v:u>0};break;case 7:f={t:"n",v:u/86400};break;case 8:f={t:"e",v:0};break;case 9:if(l>-1)f={t:"s",v:r[l]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)));break;case 10:f={t:"n",v:o};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)))}return f}function L0(e,t){var r=new Uint8Array(32),a=Ts(r),s=12,i=0;switch(r[0]=5,e.t){case"n":r[1]=2,q6(r,s,e.v),i|=1,s+=16;break;case"b":r[1]=6,a.setFloat64(s,e.v?1:0,!0),i|=2,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,a.setUint32(s,t.indexOf(e.v),!0),i|=8,s+=4;break;default:throw"unsupported cell type "+e.t}return a.setUint32(8,i,!0),r.slice(0,s)}function B0(e,t){var r=new Uint8Array(32),a=Ts(r),s=12,i=0;switch(r[0]=3,e.t){case"n":r[2]=2,a.setFloat64(s,e.v,!0),i|=32,s+=8;break;case"b":r[2]=6,a.setFloat64(s,e.v?1:0,!0),i|=32,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,a.setUint32(s,t.indexOf(e.v),!0),i|=16,s+=4;break;default:throw"unsupported cell type "+e.t}return a.setUint32(4,i,!0),r.slice(0,s)}function eE(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return Q6(e,t,r,e[0]);case 5:return Z6(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function jr(e){var t=ft(e);return zl(t[1][0].data)}function th(e,t){var r=ft(t.data),a=Wt(r[1][0].data),s=r[3],i=[];return(s||[]).forEach(function(l){var c=ft(l.data),o=Wt(c[1][0].data)>>>0;switch(a){case 1:i[o]=Xd(c[3][0].data);break;case 8:{var u=e[jr(c[9][0].data)][0],d=ft(u.data),f=e[jr(d[1][0].data)][0],x=Wt(f.meta[1][0].data);if(x!=2001)throw new Error("2000 unexpected reference to ".concat(x));var h=ft(f.data);i[o]=h[3].map(function(p){return Xd(p.data)}).join("")}break}}),i}function tE(e,t){var r,a,s,i,l,c,o,u,d,f,x,h,p,m,w=ft(e),v=Wt(w[1][0].data)>>>0,b=Wt(w[2][0].data)>>>0,y=((a=(r=w[8])==null?void 0:r[0])==null?void 0:a.data)&&Wt(w[8][0].data)>0||!1,N,F;if((i=(s=w[7])==null?void 0:s[0])!=null&&i.data&&t!=0)N=(c=(l=w[7])==null?void 0:l[0])==null?void 0:c.data,F=(u=(o=w[6])==null?void 0:o[0])==null?void 0:u.data;else if((f=(d=w[4])==null?void 0:d[0])!=null&&f.data&&t!=1)N=(h=(x=w[4])==null?void 0:x[0])==null?void 0:h.data,F=(m=(p=w[3])==null?void 0:p[0])==null?void 0:m.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var j=y?4:1,k=Ts(N),S=[],P=0;P<N.length/2;++P){var D=k.getUint16(P*2,!0);D<65535&&S.push([P,D])}if(S.length!=b)throw"Expected ".concat(b," cells, found ").concat(S.length);var K=[];for(P=0;P<S.length-1;++P)K[S[P][0]]=F.subarray(S[P][1]*j,S[P+1][1]*j);return S.length>=1&&(K[S[S.length-1][0]]=F.subarray(S[S.length-1][1]*j)),{R:v,cells:K}}function rE(e,t){var r,a=ft(t.data),s=(r=a==null?void 0:a[7])!=null&&r[0]?Wt(a[7][0].data)>>>0>0?1:0:-1,i=Cf(a[5],function(l){return tE(l,s)});return{nrows:Wt(a[4][0].data)>>>0,data:i.reduce(function(l,c){return l[c.R]||(l[c.R]=[]),c.cells.forEach(function(o,u){if(l[c.R][u])throw new Error("Duplicate cell r=".concat(c.R," c=").concat(u));l[c.R][u]=o}),l},[])}}function nE(e,t,r){var a,s=ft(t.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(Wt(s[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(i.e.c=(Wt(s[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));r["!ref"]=et(i);var l=ft(s[4][0].data),c=th(e,e[jr(l[4][0].data)][0]),o=(a=l[17])!=null&&a[0]?th(e,e[jr(l[17][0].data)][0]):[],u=ft(l[3][0].data),d=0;u[1].forEach(function(f){var x=ft(f.data),h=e[jr(x[2][0].data)][0],p=Wt(h.meta[1][0].data);if(p!=6002)throw new Error("6001 unexpected reference to ".concat(p));var m=rE(e,h);m.data.forEach(function(w,v){w.forEach(function(b,y){var N=Ke({r:d+v,c:y}),F=eE(b,c,o);F&&(r[N]=F)})}),d+=m.nrows})}function aE(e,t){var r=ft(t.data),a={"!ref":"A1"},s=e[jr(r[2][0].data)],i=Wt(s[0].meta[1][0].data);if(i!=6001)throw new Error("6000 unexpected reference to ".concat(i));return nE(e,s[0],a),a}function sE(e,t){var r,a=ft(t.data),s={name:(r=a[1])!=null&&r[0]?Xd(a[1][0].data):"",sheets:[]},i=Cf(a[2],jr);return i.forEach(function(l){e[l].forEach(function(c){var o=Wt(c.meta[1][0].data);o==6e3&&s.sheets.push(aE(e,c))})}),s}function iE(e,t){var r=Pf(),a=ft(t.data),s=Cf(a[1],jr);if(s.forEach(function(i){e[i].forEach(function(l){var c=Wt(l.meta[1][0].data);if(c==2){var o=sE(e,l);o.sheets.forEach(function(u,d){Df(r,u,d==0?o.name:o.name+"_"+d,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function U0(e){var t,r,a,s,i={},l=[];if(e.FullPaths.forEach(function(o){if(o.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(o){if(o.name.match(/\.iwa$/)){var u;try{u=hn(o.content)}catch(f){return console.log("?? "+o.content.length+" "+(f.message||f))}var d;try{d=mn(u)}catch(f){return console.log("## "+(f.message||f))}d.forEach(function(f){i[f.id]=f.messages,l.push(f.id)})}}),!l.length)throw new Error("File has no messages");var c=((s=(a=(r=(t=i==null?void 0:i[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:a[1])==null?void 0:s[0].data)&&Wt(i[1][0].meta[1][0].data)==1&&i[1][0];if(c||l.forEach(function(o){i[o].forEach(function(u){var d=Wt(u.meta[1][0].data)>>>0;if(d==1)if(!c)c=u;else throw new Error("Document has multiple roots")})}),!c)throw new Error("Cannot find Document root");return iE(i,c)}function lE(e,t,r){var a,s,i,l;if(!((a=e[6])!=null&&a[0])||!((s=e[7])!=null&&s[0]))throw"Mutation only works on post-BNC storages!";var c=((l=(i=e[8])==null?void 0:i[0])==null?void 0:l.data)&&Wt(e[8][0].data)>0||!1;if(c)throw"Math only works with normal offsets";for(var o=0,u=Ts(e[7][0].data),d=0,f=[],x=Ts(e[4][0].data),h=0,p=[],m=0;m<t.length;++m){if(t[m]==null){u.setUint16(m*2,65535,!0),x.setUint16(m*2,65535);continue}u.setUint16(m*2,d,!0),x.setUint16(m*2,h,!0);var w,v;switch(typeof t[m]){case"string":w=L0({t:"s",v:t[m]},r),v=B0({t:"s",v:t[m]},r);break;case"number":w=L0({t:"n",v:t[m]},r),v=B0({t:"n",v:t[m]},r);break;case"boolean":w=L0({t:"b",v:t[m]},r),v=B0({t:"b",v:t[m]},r);break;default:throw new Error("Unsupported value "+t[m])}f.push(w),d+=w.length,p.push(v),h+=v.length,++o}for(e[2][0].data=mt(o);m<e[7][0].data.length/2;++m)u.setUint16(m*2,65535,!0),x.setUint16(m*2,65535,!0);return e[6][0].data=Qa(f),e[3][0].data=Qa(p),o}function cE(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var a=Jr(r["!ref"]);a.s.r=a.s.c=0;var s=!1;a.e.c>9&&(s=!0,a.e.c=9),a.e.r>49&&(s=!0,a.e.r=49),s&&console.error("The Numbers writer is currently limited to ".concat(et(a)));var i=To(r,{range:a,header:1}),l=["~Sh33tJ5~"];i.forEach(function(I){return I.forEach(function(g){typeof g=="string"&&l.push(g)})});var c={},o=[],u=$e.read(t.numbers,{type:"base64"});u.FileIndex.map(function(I,g){return[I,u.FullPaths[g]]}).forEach(function(I){var g=I[0],_=I[1];if(g.type==2&&g.name.match(/\.iwa/)){var A=g.content,ne=hn(A),ue=mn(ne);ue.forEach(function(ve){o.push(ve.id),c[ve.id]={deps:[],location:_,type:Wt(ve.messages[0].meta[1][0].data)}})}}),o.sort(function(I,g){return I-g});var d=o.filter(function(I){return I>1}).map(function(I){return[I,mt(I)]});u.FileIndex.map(function(I,g){return[I,u.FullPaths[g]]}).forEach(function(I){var g=I[0];if(I[1],!!g.name.match(/\.iwa/)){var _=mn(hn(g.content));_.forEach(function(A){A.messages.forEach(function(ne){d.forEach(function(ue){A.messages.some(function(ve){return Wt(ve.meta[1][0].data)!=11006&&K6(ve.data,ue[1])})&&c[ue[0]].deps.push(A.id)})})})}});for(var f=$e.find(u,c[1].location),x=mn(hn(f.content)),h,p=0;p<x.length;++p){var m=x[p];m.id==1&&(h=m)}var w=jr(ft(h.messages[0].data)[1][0].data);for(f=$e.find(u,c[w].location),x=mn(hn(f.content)),p=0;p<x.length;++p)m=x[p],m.id==w&&(h=m);for(w=jr(ft(h.messages[0].data)[2][0].data),f=$e.find(u,c[w].location),x=mn(hn(f.content)),p=0;p<x.length;++p)m=x[p],m.id==w&&(h=m);for(w=jr(ft(h.messages[0].data)[2][0].data),f=$e.find(u,c[w].location),x=mn(hn(f.content)),p=0;p<x.length;++p)m=x[p],m.id==w&&(h=m);var v=ft(h.messages[0].data);{v[6][0].data=mt(a.e.r+1),v[7][0].data=mt(a.e.c+1);var b=jr(v[46][0].data),y=$e.find(u,c[b].location),N=mn(hn(y.content));{for(var F=0;F<N.length&&N[F].id!=b;++F);if(N[F].id!=b)throw"Bad ColumnRowUIDMapArchive";var j=ft(N[F].messages[0].data);j[1]=[],j[2]=[],j[3]=[];for(var k=0;k<=a.e.c;++k){var S=[];S[1]=S[2]=[{type:0,data:mt(k+420690)}],j[1].push({type:2,data:fr(S)}),j[2].push({type:0,data:mt(k)}),j[3].push({type:0,data:mt(k)})}j[4]=[],j[5]=[],j[6]=[];for(var P=0;P<=a.e.r;++P)S=[],S[1]=S[2]=[{type:0,data:mt(P+726270)}],j[4].push({type:2,data:fr(S)}),j[5].push({type:0,data:mt(P)}),j[6].push({type:0,data:mt(P)});N[F].messages[0].data=fr(j)}y.content=zs(Us(N)),y.size=y.content.length,delete v[46];var D=ft(v[4][0].data);{D[7][0].data=mt(a.e.r+1);var K=ft(D[1][0].data),C=jr(K[2][0].data);y=$e.find(u,c[C].location),N=mn(hn(y.content));{if(N[0].id!=C)throw"Bad HeaderStorageBucket";var Y=ft(N[0].messages[0].data);for(P=0;P<i.length;++P){var B=ft(Y[2][0].data);B[1][0].data=mt(P),B[4][0].data=mt(i[P].length),Y[2][P]={type:Y[2][0].type,data:fr(B)}}N[0].messages[0].data=fr(Y)}y.content=zs(Us(N)),y.size=y.content.length;var ee=jr(D[2][0].data);y=$e.find(u,c[ee].location),N=mn(hn(y.content));{if(N[0].id!=ee)throw"Bad HeaderStorageBucket";for(Y=ft(N[0].messages[0].data),k=0;k<=a.e.c;++k)B=ft(Y[2][0].data),B[1][0].data=mt(k),B[4][0].data=mt(a.e.r+1),Y[2][k]={type:Y[2][0].type,data:fr(B)};N[0].messages[0].data=fr(Y)}y.content=zs(Us(N)),y.size=y.content.length;var re=jr(D[4][0].data);(function(){for(var I=$e.find(u,c[re].location),g=mn(hn(I.content)),_,A=0;A<g.length;++A){var ne=g[A];ne.id==re&&(_=ne)}var ue=ft(_.messages[0].data);{ue[3]=[];var ve=[];l.forEach(function(E,ke){ve[1]=[{type:0,data:mt(ke)}],ve[2]=[{type:0,data:mt(1)}],ve[3]=[{type:2,data:X6(E)}],ue[3].push({type:2,data:fr(ve)})})}_.messages[0].data=fr(ue);var xe=Us(g),W=zs(xe);I.content=W,I.size=I.content.length})();var Q=ft(D[3][0].data);{var te=Q[1][0];delete Q[2];var H=ft(te.data);{var ae=jr(H[2][0].data);(function(){for(var I=$e.find(u,c[ae].location),g=mn(hn(I.content)),_,A=0;A<g.length;++A){var ne=g[A];ne.id==ae&&(_=ne)}var ue=ft(_.messages[0].data);{delete ue[6],delete Q[7];var ve=new Uint8Array(ue[5][0].data);ue[5]=[];for(var xe=0,W=0;W<=a.e.r;++W){var E=ft(ve);xe+=lE(E,i[W],l),E[1][0].data=mt(W),ue[5].push({data:fr(E),type:2})}ue[1]=[{type:0,data:mt(a.e.c+1)}],ue[2]=[{type:0,data:mt(a.e.r+1)}],ue[3]=[{type:0,data:mt(xe)}],ue[4]=[{type:0,data:mt(a.e.r+1)}]}_.messages[0].data=fr(ue);var ke=Us(g),pe=zs(ke);I.content=pe,I.size=I.content.length})()}te.data=fr(H)}D[3][0].data=fr(Q)}v[4][0].data=fr(D)}h.messages[0].data=fr(v);var he=Us(x),O=zs(he);return f.content=O,f.size=f.content.length,u}function jv(e){return function(r){for(var a=0;a!=e.length;++a){var s=e[a];r[s[0]]===void 0&&(r[s[0]]=s[1]),s[2]==="n"&&(r[s[0]]=Number(r[s[0]]))}}}function Ef(e){jv([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function Tf(e){jv([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function oE(e){return st.WS.indexOf(e)>-1?"sheet":e==st.CS?"chart":e==st.DS?"dialog":e==st.MS?"macro":e&&e.length?e:"sheet"}function dE(e,t){if(!e)return 0;try{e=t.map(function(a){return a.id||(a.id=a.strRelID),[a.name,e["!id"][a.id].Target,oE(e["!id"][a.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function uE(e,t,r,a,s,i,l,c,o,u,d,f){try{i[a]=sl(nn(e,r,!0),t);var x=Yt(e,t),h;switch(c){case"sheet":h=DC(x,t,s,o,i[a],u,d,f);break;case"chart":if(h=IC(x,t,s,o,i[a],u,d,f),!h||!h["!drawel"])break;var p=Gi(h["!drawel"].Target,t),m=Ml(p),w=b5(nn(e,p,!0),sl(nn(e,m,!0),p)),v=Gi(w,p),b=Ml(v);h=lC(nn(e,v,!0),v,o,sl(nn(e,b,!0),v),u,h);break;case"macro":h=MC(x,t,s,o,i[a],u,d,f);break;case"dialog":h=RC(x,t,s,o,i[a],u,d,f);break;default:throw new Error("Unrecognized sheet type "+c)}l[a]=h;var y=[];i&&i[a]&&Ht(i[a]).forEach(function(N){var F="";if(i[a][N].Type==st.CMNT){F=Gi(i[a][N].Target,t);var j=UC(Yt(e,F,!0),F,o);if(!j||!j.length)return;Um(h,j,!1)}i[a][N].Type==st.TCMNT&&(F=Gi(i[a][N].Target,t),y=y.concat(N5(Yt(e,F,!0),o)))}),y&&y.length&&Um(h,y,!0,o.people||[])}catch(N){if(o.WTF)throw N}}function fn(e){return e.charAt(0)=="/"?e.slice(1):e}function fE(e,t){if(Ci(),t=t||{},Ef(t),pn(e,"META-INF/manifest.xml")||pn(e,"objectdata.xml"))return Jm(e,t);if(pn(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof U0<"u"){if(e.FileIndex)return U0(e);var r=$e.utils.cfb_new();return lm(e).forEach(function(B){tt(r,B,jw(e,B))}),U0(r)}throw new Error("Unsupported NUMBERS file")}if(!pn(e,"[Content_Types].xml"))throw pn(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):pn(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var a=lm(e),s=pN(nn(e,"[Content_Types].xml")),i=!1,l,c;if(s.workbooks.length===0&&(c="xl/workbook.xml",Yt(e,c,!0)&&s.workbooks.push(c)),s.workbooks.length===0){if(c="xl/workbook.bin",!Yt(e,c,!0))throw new Error("Could not find workbook");s.workbooks.push(c),i=!0}s.workbooks[0].slice(-3)=="bin"&&(i=!0);var o={},u={};if(!t.bookSheets&&!t.bookProps){if(il=[],s.sst)try{il=BC(Yt(e,fn(s.sst)),s.sst,t)}catch(B){if(t.WTF)throw B}t.cellStyles&&s.themes.length&&(o=LC(nn(e,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],t)),s.style&&(u=OC(Yt(e,fn(s.style)),s.style,o,t))}s.links.map(function(B){try{var ee=sl(nn(e,Ml(fn(B))),B);return WC(Yt(e,fn(B)),ee,B,t)}catch{}});var d=PC(Yt(e,fn(s.workbooks[0])),s.workbooks[0],t),f={},x="";s.coreprops.length&&(x=Yt(e,fn(s.coreprops[0]),!0),x&&(f=ug(x)),s.extprops.length!==0&&(x=Yt(e,fn(s.extprops[0]),!0),x&&jN(x,f,t)));var h={};(!t.bookSheets||t.bookProps)&&s.custprops.length!==0&&(x=nn(e,fn(s.custprops[0]),!0),x&&(h=_N(x,t)));var p={};if((t.bookSheets||t.bookProps)&&(d.Sheets?l=d.Sheets.map(function(ee){return ee.name}):f.Worksheets&&f.SheetNames.length>0&&(l=f.SheetNames),t.bookProps&&(p.Props=f,p.Custprops=h),t.bookSheets&&typeof l<"u"&&(p.SheetNames=l),t.bookSheets?p.SheetNames:t.bookProps))return p;l={};var m={};t.bookDeps&&s.calcchain&&(m=zC(Yt(e,fn(s.calcchain)),s.calcchain));var w=0,v={},b,y;{var N=d.Sheets;f.Worksheets=N.length,f.SheetNames=[];for(var F=0;F!=N.length;++F)f.SheetNames[F]=N[F].name}var j=i?"bin":"xml",k=s.workbooks[0].lastIndexOf("/"),S=(s.workbooks[0].slice(0,k+1)+"_rels/"+s.workbooks[0].slice(k+1)+".rels").replace(/^\//,"");pn(e,S)||(S="xl/_rels/workbook."+j+".rels");var P=sl(nn(e,S,!0),S.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(t.xlmeta=HC(Yt(e,fn(s.metadata[0])),s.metadata[0],t)),(s.people||[]).length>=1&&(t.people=k5(Yt(e,fn(s.people[0])),t)),P&&(P=dE(P,d.Sheets));var D=Yt(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(w=0;w!=f.Worksheets;++w){var K="sheet";if(P&&P[w]?(b="xl/"+P[w][1].replace(/[\/]?xl\//,""),pn(e,b)||(b=P[w][1]),pn(e,b)||(b=S.replace(/_rels\/.*$/,"")+P[w][1]),K=P[w][2]):(b="xl/worksheets/sheet"+(w+1-D)+"."+j,b=b.replace(/sheet0\./,"sheet.")),y=b.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(w!=t.sheets)continue e;break;case"string":if(f.SheetNames[w].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var C=!1,Y=0;Y!=t.sheets.length;++Y)typeof t.sheets[Y]=="number"&&t.sheets[Y]==w&&(C=1),typeof t.sheets[Y]=="string"&&t.sheets[Y].toLowerCase()==f.SheetNames[w].toLowerCase()&&(C=1);if(!C)continue e}}uE(e,b,y,f.SheetNames[w],w,v,l,K,t,d,o,u)}return p={Directory:s,Workbook:d,Props:f,Custprops:h,Deps:m,Sheets:l,SheetNames:f.SheetNames,Strings:il,Styles:u,Themes:o,SSF:Ft(Ge)},t&&t.bookFiles&&(e.files?(p.keys=a,p.files=e.files):(p.keys=[],p.files={},e.FullPaths.forEach(function(B,ee){B=B.replace(/^Root Entry[\/]/,""),p.keys.push(B),p.files[B]=e.FileIndex[ee]}))),t&&t.bookVBA&&(s.vba.length>0?p.vbaraw=Yt(e,fn(s.vba[0]),!0):s.defaults&&s.defaults.bin===P5&&(p.vbaraw=Yt(e,"xl/vbaProject.bin",!0))),p}function xE(e,t){var r=t||{},a="Workbook",s=$e.find(e,a);try{if(a="/!DataSpaces/Version",s=$e.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(H4(s.content),a="/!DataSpaces/DataSpaceMap",s=$e.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);var i=V4(s.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!=="StrongEncryptionDataSpace"||i[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=$e.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);var l=G4(s.content);if(l.length!=1||l[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=$e.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);K4(s.content)}catch{}if(a="/EncryptionInfo",s=$e.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);var c=Y4(s.content);if(a="/EncryptedPackage",s=$e.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(c[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(c[1],s.content,r.password||"",r);if(c[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(c[1],s.content,r.password||"",r);throw new Error("File is password-protected")}function mE(e,t){return t.bookType=="ods"?Nv(e,t):t.bookType=="numbers"?cE(e,t):t.bookType=="xlsb"?hE(e,t):pE(e,t)}function hE(e,t){ti=1024,e&&!e.SSF&&(e.SSF=Ft(Ge)),e&&e.SSF&&(Ci(),Xo(e.SSF),t.revssf=Yo(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,ll?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",a=qg.indexOf(t.bookType)>-1,s=mf();Tf(t=t||{});var i=Zu(),l="",c=0;if(t.cellXfs=[],as(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),l="docProps/core.xml",tt(i,l,fg(e.Props,t)),s.coreprops.push(l),ht(t.rels,2,l,st.CORE_PROPS),l="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var o=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&o.push(e.SheetNames[u]);e.Props.SheetNames=o}for(e.Props.Worksheets=e.Props.SheetNames.length,tt(i,l,hg(e.Props)),s.extprops.push(l),ht(t.rels,3,l,st.EXT_PROPS),e.Custprops!==e.Props&&Ht(e.Custprops||{}).length>0&&(l="docProps/custom.xml",tt(i,l,pg(e.Custprops)),s.custprops.push(l),ht(t.rels,4,l,st.CUST_PROPS)),c=1;c<=e.SheetNames.length;++c){var d={"!id":{}},f=e.Sheets[e.SheetNames[c-1]],x=(f||{})["!type"]||"sheet";switch(x){case"chart":default:l="xl/worksheets/sheet"+c+"."+r,tt(i,l,VC(c-1,l,t,e,d)),s.sheets.push(l),ht(t.wbrels,-1,"worksheets/sheet"+c+"."+r,st.WS[0])}if(f){var h=f["!comments"],p=!1,m="";h&&h.length>0&&(m="xl/comments"+c+"."+r,tt(i,m,KC(h,m)),s.comments.push(m),ht(d,-1,"../comments"+c+"."+r,st.CMNT),p=!0),f["!legacy"]&&p&&tt(i,"xl/drawings/vmlDrawing"+c+".vml",Kg(c,f["!comments"])),delete f["!comments"],delete f["!legacy"]}d["!id"].rId1&&tt(i,Ml(l),oi(d))}return t.Strings!=null&&t.Strings.length>0&&(l="xl/sharedStrings."+r,tt(i,l,XC(t.Strings,l,t)),s.strs.push(l),ht(t.wbrels,-1,"sharedStrings."+r,st.SST)),l="xl/workbook."+r,tt(i,l,$C(e,l)),s.workbooks.push(l),ht(t.rels,1,l,st.WB),l="xl/theme/theme1.xml",tt(i,l,bf(e.Themes,t)),s.themes.push(l),ht(t.wbrels,-1,"theme/theme1.xml",st.THEME),l="xl/styles."+r,tt(i,l,GC(e,l,t)),s.styles.push(l),ht(t.wbrels,-1,"styles."+r,st.STY),e.vbaraw&&a&&(l="xl/vbaProject.bin",tt(i,l,e.vbaraw),s.vba.push(l),ht(t.wbrels,-1,"vbaProject.bin",st.VBA)),l="xl/metadata."+r,tt(i,l,YC(l)),s.metadata.push(l),ht(t.wbrels,-1,"metadata."+r,st.XLMETA),tt(i,"[Content_Types].xml",og(s,t)),tt(i,"_rels/.rels",oi(t.rels)),tt(i,"xl/_rels/workbook."+r+".rels",oi(t.wbrels)),delete t.revssf,delete t.ssf,i}function pE(e,t){ti=1024,e&&!e.SSF&&(e.SSF=Ft(Ge)),e&&e.SSF&&(Ci(),Xo(e.SSF),t.revssf=Yo(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,ll?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",a=qg.indexOf(t.bookType)>-1,s=mf();Tf(t=t||{});var i=Zu(),l="",c=0;if(t.cellXfs=[],as(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),l="docProps/core.xml",tt(i,l,fg(e.Props,t)),s.coreprops.push(l),ht(t.rels,2,l,st.CORE_PROPS),l="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var o=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&o.push(e.SheetNames[u]);e.Props.SheetNames=o}e.Props.Worksheets=e.Props.SheetNames.length,tt(i,l,hg(e.Props)),s.extprops.push(l),ht(t.rels,3,l,st.EXT_PROPS),e.Custprops!==e.Props&&Ht(e.Custprops||{}).length>0&&(l="docProps/custom.xml",tt(i,l,pg(e.Custprops)),s.custprops.push(l),ht(t.rels,4,l,st.CUST_PROPS));var d=["SheetJ5"];for(t.tcid=0,c=1;c<=e.SheetNames.length;++c){var f={"!id":{}},x=e.Sheets[e.SheetNames[c-1]],h=(x||{})["!type"]||"sheet";switch(h){case"chart":default:l="xl/worksheets/sheet"+c+"."+r,tt(i,l,lv(c-1,t,e,f)),s.sheets.push(l),ht(t.wbrels,-1,"worksheets/sheet"+c+"."+r,st.WS[0])}if(x){var p=x["!comments"],m=!1,w="";if(p&&p.length>0){var v=!1;p.forEach(function(b){b[1].forEach(function(y){y.T==!0&&(v=!0)})}),v&&(w="xl/threadedComments/threadedComment"+c+"."+r,tt(i,w,j5(p,d,t)),s.threadedcomments.push(w),ht(f,-1,"../threadedComments/threadedComment"+c+"."+r,st.TCMNT)),w="xl/comments"+c+"."+r,tt(i,w,Yg(p)),s.comments.push(w),ht(f,-1,"../comments"+c+"."+r,st.CMNT),m=!0}x["!legacy"]&&m&&tt(i,"xl/drawings/vmlDrawing"+c+".vml",Kg(c,x["!comments"])),delete x["!comments"],delete x["!legacy"]}f["!id"].rId1&&tt(i,Ml(l),oi(f))}return t.Strings!=null&&t.Strings.length>0&&(l="xl/sharedStrings."+r,tt(i,l,Rg(t.Strings,t)),s.strs.push(l),ht(t.wbrels,-1,"sharedStrings."+r,st.SST)),l="xl/workbook."+r,tt(i,l,fv(e)),s.workbooks.push(l),ht(t.rels,1,l,st.WB),l="xl/theme/theme1.xml",tt(i,l,bf(e.Themes,t)),s.themes.push(l),ht(t.wbrels,-1,"theme/theme1.xml",st.THEME),l="xl/styles."+r,tt(i,l,$g(e,t)),s.styles.push(l),ht(t.wbrels,-1,"styles."+r,st.STY),e.vbaraw&&a&&(l="xl/vbaProject.bin",tt(i,l,e.vbaraw),s.vba.push(l),ht(t.wbrels,-1,"vbaProject.bin",st.VBA)),l="xl/metadata."+r,tt(i,l,Xg()),s.metadata.push(l),ht(t.wbrels,-1,"metadata."+r,st.XLMETA),d.length>1&&(l="xl/persons/person.xml",tt(i,l,_5(d)),s.people.push(l),ht(t.wbrels,-1,"persons/person.xml",st.PEOPLE)),tt(i,"[Content_Types].xml",og(s,t)),tt(i,"_rels/.rels",oi(t.rels)),tt(i,"xl/_rels/workbook."+r+".rels",oi(t.wbrels)),delete t.revssf,delete t.ssf,i}function Ff(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=cn(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function gE(e,t){return $e.find(e,"EncryptedPackage")?xE(e,t):pv(e,t)}function vE(e,t){var r,a=e,s=t||{};return s.type||(s.type=rt&&Buffer.isBuffer(e)?"buffer":"base64"),r=L1(a,s),fE(r,s)}function kv(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Vd(e.slice(r),t);default:break e}return wi.to_workbook(e,t)}function yE(e,t){var r="",a=Ff(e,t);switch(t.type){case"base64":r=cn(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=_s(e);break;default:throw new Error("Unrecognized type "+t.type)}return a[0]==239&&a[1]==187&&a[2]==191&&(r=vt(r)),t.type="binary",kv(r,t)}function bE(e,t){var r=e;return t.type=="base64"&&(r=cn(r)),r=Ia.utils.decode(1200,r.slice(2),"str"),t.type="binary",kv(r,t)}function wE(e){return e.match(/[^\x00-\x7F]/)?qn(e):e}function z0(e,t,r,a){return a?(r.type="string",wi.to_workbook(e,r)):wi.to_workbook(t,r)}function Kd(e,t){Ku();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Kd(new Uint8Array(e),(r=Ft(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var a=e,s=[0,0,0,0],i=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),ui={},r.dateNF&&(ui.dateNF=r.dateNF),r.type||(r.type=rt&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=rt?"buffer":"binary",a=hw(e),typeof Uint8Array<"u"&&!rt&&(r.type="array")),r.type=="string"&&(i=!0,r.type="binary",r.codepage=65001,a=wE(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var l=new ArrayBuffer(3),c=new Uint8Array(l);if(c.foo="bar",!c.foo)return r=Ft(r),r.type="array",Kd(Yu(a),r)}switch((s=Ff(a,r))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return gE($e.read(a,r),r);break;case 9:if(s[1]<=8)return pv(a,r);break;case 60:return Vd(a,r);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return S4(a,r);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return Ig.to_workbook(a,r);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?vE(a,r):z0(e,a,r,i);case 239:return s[3]===60?Vd(a,r):z0(e,a,r,i);case 255:if(s[1]===254)return bE(a,r);if(s[1]===0&&s[2]===2&&s[3]===0)return ps.to_workbook(a,r);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return ps.to_workbook(a,r);break;case 3:case 131:case 139:case 140:return $d.to_workbook(a,r);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return zg.to_workbook(a,r);break;case 10:case 13:case 32:return yE(a,r);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return _4.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?$d.to_workbook(a,r):z0(e,a,r,i)}function _v(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return Kl(t.file,$e.write(e,{type:rt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return $e.write(e,t)}function NE(e,t){var r=Ft(t||{}),a=mE(e,r);return jE(a,r)}function jE(e,t){var r={},a=rt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=a;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=a;break;default:throw new Error("Unrecognized type "+t.type)}var s=e.FullPaths?$e.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof s=="string"){if(t.type=="binary"||t.type=="base64")return s;s=new Uint8Array(Go(s))}return t.password&&typeof encrypt_agile<"u"?_v(encrypt_agile(s,t.password),t):t.type==="file"?Kl(t.file,s):t.type=="string"?vt(s):s}function kE(e,t){var r=t||{},a=w6(e,r);return _v(a,r)}function Xn(e,t,r){r||(r="");var a=r+e;switch(t.type){case"base64":return Fl(qn(a));case"binary":return qn(a);case"string":return e;case"file":return Kl(t.file,a,"utf8");case"buffer":return rt?ba(a,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(a):Xn(a,{type:"binary"}).split("").map(function(s){return s.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function _E(e,t){switch(t.type){case"base64":return Fl(e);case"binary":return e;case"string":return e;case"file":return Kl(t.file,e,"binary");case"buffer":return rt?ba(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Tc(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",a=0;a<e.length;++a)r+=String.fromCharCode(e[a]);return t.type=="base64"?Fl(r):t.type=="string"?vt(r):r;case"file":return Kl(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function Sv(e,t){Ku(),gC(e);var r=Ft(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var a=Sv(e,r);return r.type="array",Go(a)}var s=0;if(r.sheet&&(typeof r.sheet=="number"?s=r.sheet:s=e.SheetNames.indexOf(r.sheet),!e.SheetNames[s]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Xn(m6(e,r),r);case"slk":case"sylk":return Xn(Dg.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"htm":case"html":return Xn(vv(e.Sheets[e.SheetNames[s]],r),r);case"txt":return _E(Cv(e.Sheets[e.SheetNames[s]],r),r);case"csv":return Xn(Af(e.Sheets[e.SheetNames[s]],r),r,"\uFEFF");case"dif":return Xn(Ig.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"dbf":return Tc($d.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"prn":return Xn(wi.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"rtf":return Xn(zg.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"eth":return Xn(Mg.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"fods":return Xn(Nv(e,r),r);case"wk1":return Tc(ps.sheet_to_wk1(e.Sheets[e.SheetNames[s]],r),r);case"wk3":return Tc(ps.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),Tc(gv(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),kE(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return NE(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function SE(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function CE(e,t,r){var a={};return a.type="file",a.file=t,SE(a),Sv(e,a)}function EE(e,t,r,a,s,i,l,c){var o=Gt(r),u=c.defval,d=c.raw||!Object.prototype.hasOwnProperty.call(c,"raw"),f=!0,x=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(x,"__rowNum__",{value:r,enumerable:!1})}catch{x.__rowNum__=r}else x.__rowNum__=r;if(!l||e[r])for(var h=t.s.c;h<=t.e.c;++h){var p=l?e[r][h]:e[a[h]+o];if(p===void 0||p.t===void 0){if(u===void 0)continue;i[h]!=null&&(x[i[h]]=u);continue}var m=p.v;switch(p.t){case"z":if(m==null)break;continue;case"e":m=m==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+p.t)}if(i[h]!=null){if(m==null)if(p.t=="e"&&m===null)x[i[h]]=null;else if(u!==void 0)x[i[h]]=u;else if(d&&m===null)x[i[h]]=null;else continue;else x[i[h]]=d&&(p.t!=="n"||p.t==="n"&&c.rawNumbers!==!1)?m:va(p,m,c);m!=null&&(f=!1)}}return{row:x,isempty:f}}function To(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},a=0,s=1,i=[],l=0,c="",o={s:{r:0,c:0},e:{r:0,c:0}},u=t||{},d=u.range!=null?u.range:e["!ref"];switch(u.header===1?a=1:u.header==="A"?a=2:Array.isArray(u.header)?a=3:u.header==null&&(a=0),typeof d){case"string":o=ut(d);break;case"number":o=ut(e["!ref"]),o.s.r=d;break;default:o=d}a>0&&(s=0);var f=Gt(o.s.r),x=[],h=[],p=0,m=0,w=Array.isArray(e),v=o.s.r,b=0,y={};w&&!e[v]&&(e[v]=[]);var N=u.skipHidden&&e["!cols"]||[],F=u.skipHidden&&e["!rows"]||[];for(b=o.s.c;b<=o.e.c;++b)if(!(N[b]||{}).hidden)switch(x[b]=Mt(b),r=w?e[v][b]:e[x[b]+f],a){case 1:i[b]=b-o.s.c;break;case 2:i[b]=x[b];break;case 3:i[b]=u.header[b-o.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),c=l=va(r,null,u),m=y[l]||0,!m)y[l]=1;else{do c=l+"_"+m++;while(y[c]);y[l]=m,y[c]=1}i[b]=c}for(v=o.s.r+s;v<=o.e.r;++v)if(!(F[v]||{}).hidden){var j=EE(e,o,v,x,a,i,w,u);(j.isempty===!1||(a===1?u.blankrows!==!1:u.blankrows))&&(h[p++]=j.row)}return h.length=p,h}var rh=/"/g;function TE(e,t,r,a,s,i,l,c){for(var o=!0,u=[],d="",f=Gt(r),x=t.s.c;x<=t.e.c;++x)if(a[x]){var h=c.dense?(e[r]||[])[x]:e[a[x]+f];if(h==null)d="";else if(h.v!=null){o=!1,d=""+(c.rawNumbers&&h.t=="n"?h.v:va(h,null,c));for(var p=0,m=0;p!==d.length;++p)if((m=d.charCodeAt(p))===s||m===i||m===34||c.forceQuotes){d='"'+d.replace(rh,'""')+'"';break}d=="ID"&&(d='"ID"')}else h.f!=null&&!h.F?(o=!1,d="="+h.f,d.indexOf(",")>=0&&(d='"'+d.replace(rh,'""')+'"')):d="";u.push(d)}return c.blankrows===!1&&o?null:u.join(l)}function Af(e,t){var r=[],a=t??{};if(e==null||e["!ref"]==null)return"";var s=ut(e["!ref"]),i=a.FS!==void 0?a.FS:",",l=i.charCodeAt(0),c=a.RS!==void 0?a.RS:`
`,o=c.charCodeAt(0),u=new RegExp((i=="|"?"\\|":i)+"+$"),d="",f=[];a.dense=Array.isArray(e);for(var x=a.skipHidden&&e["!cols"]||[],h=a.skipHidden&&e["!rows"]||[],p=s.s.c;p<=s.e.c;++p)(x[p]||{}).hidden||(f[p]=Mt(p));for(var m=0,w=s.s.r;w<=s.e.r;++w)(h[w]||{}).hidden||(d=TE(e,s,w,f,l,o,i,a),d!=null&&(a.strip&&(d=d.replace(u,"")),(d||a.blankrows!==!1)&&r.push((m++?c:"")+d)));return delete a.dense,r.join("")}function Cv(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=Af(e,t);return r}function FE(e){var t="",r,a="";if(e==null||e["!ref"]==null)return[];var s=ut(e["!ref"]),i="",l=[],c,o=[],u=Array.isArray(e);for(c=s.s.c;c<=s.e.c;++c)l[c]=Mt(c);for(var d=s.s.r;d<=s.e.r;++d)for(i=Gt(d),c=s.s.c;c<=s.e.c;++c)if(t=l[c]+i,r=u?(e[d]||[])[c]:e[t],a="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;a=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)a=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)a=""+r.v;else if(r.t=="b")a=r.v?"TRUE":"FALSE";else if(r.w!==void 0)a="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?a="'"+r.v:a=""+r.v}}o[o.length]=t+"="+a}return o}function Ev(e,t,r){var a=r||{},s=+!a.skipHeader,i=e||{},l=0,c=0;if(i&&a.origin!=null)if(typeof a.origin=="number")l=a.origin;else{var o=typeof a.origin=="string"?Rt(a.origin):a.origin;l=o.r,c=o.c}var u,d={s:{c:0,r:0},e:{c,r:l+t.length-1+s}};if(i["!ref"]){var f=ut(i["!ref"]);d.e.c=Math.max(d.e.c,f.e.c),d.e.r=Math.max(d.e.r,f.e.r),l==-1&&(l=f.e.r+1,d.e.r=l+t.length-1+s)}else l==-1&&(l=0,d.e.r=t.length-1+s);var x=a.header||[],h=0;t.forEach(function(m,w){Ht(m).forEach(function(v){(h=x.indexOf(v))==-1&&(x[h=x.length]=v);var b=m[v],y="z",N="",F=Ke({c:c+h,r:l+w+s});u=Wl(i,F),b&&typeof b=="object"&&!(b instanceof Date)?i[F]=b:(typeof b=="number"?y="n":typeof b=="boolean"?y="b":typeof b=="string"?y="s":b instanceof Date?(y="d",a.cellDates||(y="n",b=tr(b)),N=a.dateNF||Ge[14]):b===null&&a.nullError&&(y="e",b=0),u?(u.t=y,u.v=b,delete u.w,delete u.R,N&&(u.z=N)):i[F]=u={t:y,v:b},N&&(u.z=N))})}),d.e.c=Math.max(d.e.c,c+x.length-1);var p=Gt(l);if(s)for(h=0;h<x.length;++h)i[Mt(h+c)+p]={t:"s",v:x[h]};return i["!ref"]=et(d),i}function AE(e,t){return Ev(null,e,t)}function Wl(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var a=Rt(t);return e[a.r]||(e[a.r]=[]),e[a.r][a.c]||(e[a.r][a.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?Wl(e,Ke(t)):Wl(e,Ke({r:t,c:r||0}))}function PE(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function Pf(){return{SheetNames:[],Sheets:{}}}function Df(e,t,r,a){var s=1;if(!r)for(;s<=65535&&e.SheetNames.indexOf(r="Sheet"+s)!=-1;++s,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(a&&e.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);s=i&&+i[2]||0;var l=i&&i[1]||r;for(++s;s<=65535&&e.SheetNames.indexOf(r=l+s)!=-1;++s);}if(uv(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function DE(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var a=PE(e,t);switch(e.Workbook.Sheets[a]||(e.Workbook.Sheets[a]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[a].Hidden=r}function IE(e,t){return e.z=t,e}function Tv(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function ME(e,t,r){return Tv(e,"#"+t,r)}function RE(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function OE(e,t,r,a){for(var s=typeof t!="string"?t:ut(t),i=typeof t=="string"?t:et(t),l=s.s.r;l<=s.e.r;++l)for(var c=s.s.c;c<=s.e.c;++c){var o=Wl(e,l,c);o.t="n",o.F=i,delete o.v,l==s.s.r&&c==s.s.c&&(o.f=r,a&&(o.D=!0))}return e}var Fc={encode_col:Mt,encode_row:Gt,encode_cell:Ke,encode_range:et,decode_col:cf,decode_row:lf,split_cell:Xw,decode_cell:Rt,decode_range:Jr,format_cell:va,sheet_add_aoa:rg,sheet_add_json:Ev,sheet_add_dom:yv,aoa_to_sheet:Ei,json_to_sheet:AE,table_to_sheet:bv,table_to_book:H6,sheet_to_csv:Af,sheet_to_txt:Cv,sheet_to_json:To,sheet_to_html:vv,sheet_to_formulae:FE,sheet_to_row_object_array:To,sheet_get_cell:Wl,book_new:Pf,book_append_sheet:Df,book_set_sheet_visibility:DE,cell_set_number_format:IE,cell_set_hyperlink:Tv,cell_set_internal_link:ME,cell_add_comment:RE,sheet_set_array_formula:OE,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const LE=({companyId:e,readOnly:t=!1})=>{const[r,a]=M.useState(()=>{const G=localStorage.getItem(`performance_${e}`);return G?JSON.parse(G):[]});M.useEffect(()=>{localStorage.setItem(`performance_${e}`,JSON.stringify(r))},[r,e]);const[s,i]=M.useState(""),[l,c]=M.useState(""),[o,u]=M.useState(""),[d,f]=M.useState(""),[x,h]=M.useState(""),[p,m]=M.useState(""),[w,v]=M.useState(1),[b,y]=M.useState(10),[N,F]=M.useState(""),[j,k]=M.useState(!1),[S,P]=M.useState(!1),[D,K]=M.useState(!1),[C,Y]=M.useState(null),[B,ee]=M.useState(null),[re,Q]=M.useState(!1),[te,H]=M.useState(null),[ae,he]=M.useState(!0),[O,I]=M.useState(!0),[g,_]=M.useState(!1),[A,ne]=M.useState(null),[ue,ve]=M.useState(1),[xe,W]=M.useState(5),[E,ke]=M.useState(""),[pe,Ue]=M.useState(1),[Ne,me]=M.useState(5),[oe,Ie]=M.useState(""),[Re,Me]=M.useState(1),[Oe,He]=M.useState(!1),[Z,Be]=M.useState(!1),[ze,nt]=M.useState(""),Qe=()=>{i(""),c(""),u(""),f(""),h(""),m(""),v(1)},Dt=()=>{console.log("Searching:",s,l,o)},Xe=()=>{ee({id:"",contractNumber:"",contractType:"total",projectName:"",clientName:"",contractEffectiveDate:"",projectAmount:"",contractDescription:"",partyAContact:"",partyAContactInfo:"",partyBContact:"",partyBContactInfo:"",attachments:{wholeContract:[],contractFirstPage:[],contractMainTerms:[],contractSealPage:[],acceptanceCertificate:[],clientProof:[]},products:[],invoices:[]}),ve(1),Me(1),He(!1),k(!0)},at=G=>{ee({...G}),ve(1),Me(1),He(!0),P(!0)},se=G=>{Y(G),K(!0)},Ce=()=>{if(B){const G={...B,id:String(Date.now()),createdAt:new Date().toISOString()};a([...r,G]),k(!1),Me(1)}},Je=()=>{B&&(a(r.map(G=>G.id===B.id?B:G)),P(!1),Me(1))},Bt=()=>{C&&(a(r.filter(G=>G.id!==C.id)),K(!1))},rr=()=>{H({id:String(Date.now()),invoiceNumber:"",invoiceAmount:"",invoiceFile:void 0,verificationFile:void 0}),Q(!0)},dr=G=>{H({...G}),Q(!0)},yr=G=>{B&&ee({...B,invoices:B.invoices.filter(je=>je.id!==G)})},jt=()=>{if(B&&te){const G=B.invoices.findIndex(je=>je.id===te.id);if(G>=0){const je=[...B.invoices];je[G]=te,ee({...B,invoices:je})}else ee({...B,invoices:[...B.invoices,te]});Q(!1),H(null)}},zr=()=>{ne({id:String(Date.now()),productName:"",productSpec:"",quantity:"",unitPrice:"",totalPrice:"",remarks:""}),_(!0)},nr=G=>{ne({...G}),_(!0)},Pr=G=>{if(B){const je=B.products.filter(Fe=>Fe.id!==G);ee({...B,products:je})}},ur=()=>{if(B&&A){const G=B.products.findIndex(je=>je.id===A.id);if(G>=0){const je=[...B.products];je[G]=A,ee({...B,products:je})}else ee({...B,products:[...B.products,A]});_(!1),ne(null)}},ja=G=>{var we;const je=(we=G.target.files)==null?void 0:we[0];if(!je)return;nt("");const Fe=new FileReader;Fe.onload=ct=>{var xt;try{const yt=(xt=ct.target)==null?void 0:xt.result,Wr=Kd(yt,{type:"binary"}),Sa=Wr.SheetNames[0],aa=Wr.Sheets[Sa],Ca=Fc.sheet_to_json(aa);if(Ca.length===0){nt("Excel文件为空，请检查文件内容");return}const Pe=Ca.map((lt,Dr)=>{const Hr=String(lt.数量||lt.quantity||""),Fn=String(lt.单价||lt.unitPrice||""),If=parseFloat(Hr)||0,Fv=parseFloat(Fn)||0,Av=(If*Fv).toFixed(2);return{id:String(Date.now()+Dr),productName:String(lt.产品名称||lt.productName||""),productSpec:String(lt.产品规格||lt.productSpec||""),quantity:Hr,unitPrice:Fn,totalPrice:Av,remarks:String(lt.备注||lt.remarks||"")}}).filter(lt=>lt.productName);if(Pe.length===0){nt("未找到有效的产品数据，请检查Excel格式");return}B&&ee({...B,products:[...B.products,...Pe]}),Be(!1),alert(`成功导入 ${Pe.length} 条产品信息`)}catch(yt){console.error("Excel解析错误:",yt),nt("Excel文件解析失败，请检查文件格式")}},Fe.readAsBinaryString(je),G.target.value=""},ka=()=>{const G=[{产品名称:"示例产品A",产品规格:"V1.0标准版",数量:"10",单价:"5000",备注:"第一批采购"},{产品名称:"示例产品B",产品规格:"V2.0专业版",数量:"5",单价:"8000",备注:""}],je=Fc.json_to_sheet(G),Fe=Fc.book_new();Fc.book_append_sheet(Fe,je,"产品信息模板");const we=[{wch:20},{wch:20},{wch:10},{wch:10},{wch:20}];je["!cols"]=we,CE(Fe,"产品信息导入模板.xlsx")},Cn=(G,je)=>{if(B){const Fe=new FileReader;Fe.onloadend=()=>{const we={url:Fe.result,name:je.name};ee({...B,attachments:{...B.attachments,[G]:[...B.attachments[G],we]}})},Fe.readAsDataURL(je)}},un=(G,je)=>{if(B){const Fe=B.attachments[G].filter((we,ct)=>ct!==je);ee({...B,attachments:{...B.attachments,[G]:Fe}})}},ra=(G,je)=>{if(te){const Fe=new FileReader;Fe.onloadend=()=>{H({...te,[G]:{url:Fe.result,name:je.name}})},Fe.readAsDataURL(je)}},En=G=>{te&&H({...te,[G]:void 0})},Tn=r.filter(G=>{const je=!s||G.contractNumber.toLowerCase().includes(s.toLowerCase()),Fe=!l||G.projectName.toLowerCase().includes(l.toLowerCase()),we=!o||G.clientName.toLowerCase().includes(o.toLowerCase()),ct=!d||parseFloat(G.projectAmount.replace(/[^\d.]/g,""))>=parseFloat(d);let xt=!0;if(x||p){const yt=G.contractEffectiveDate?new Date(G.contractEffectiveDate):null;if(yt){if(x&&p){const Wr=new Date(x),Sa=new Date(p);xt=yt>=Wr&&yt<=Sa}else if(x){const Wr=new Date(x);xt=yt>=Wr}else if(p){const Wr=new Date(p);xt=yt<=Wr}}else xt=!1}return je&&Fe&&we&&ct&&xt}).sort((G,je)=>{const Fe=G.createdAt?new Date(G.createdAt).getTime():0;return(je.createdAt?new Date(je.createdAt).getTime():0)-Fe}),na=()=>{const G=(w-1)*b,je=G+b;return Tn.slice(G,je)},ar=Math.ceil(Tn.length/b),_a=G=>{y(G),v(1)},Qr=()=>{const G=parseInt(N);G>=1&&G<=ar&&(v(G),F(""))},bt=()=>{if(!B)return[];const G=(ue-1)*xe,je=G+xe;return B.products.slice(G,je)},T=B?Math.ceil(B.products.length/xe):0,z=G=>{W(G),ve(1)},R=()=>{const G=parseInt(E);G>=1&&G<=T&&(ve(G),ke(""))},L=B?Math.ceil(B.invoices.length/Ne):1,V=()=>{if(!B)return[];const G=(pe-1)*Ne;return B.invoices.slice(G,G+Ne)},X=G=>{me(G),Ue(1)},le=()=>{const G=parseInt(oe);G>=1&&G<=L&&(Ue(G),Ie(""))},ge=()=>B&&B.contractType==="total"?3:4,ie=G=>{if(!B)return"";if(ge(),G===1)return"基础信息和联系人信息";if(B.contractType==="total"){if(G===2)return"上传合同附件、验收证明";if(G===3)return"上传发票信息"}else{if(G===2)return"录入合同产品信息";if(G===3)return"上传合同附件、验收证明";if(G===4)return"上传发票信息"}return""},ce=()=>B?Re===1?B.contractNumber&&B.projectName&&B.clientName&&B.contractEffectiveDate&&B.projectAmount:!0:!1,de=()=>{const G=ge();Re<G&&ce()&&Me(Re+1)},Se=()=>{Re>1&&Me(Re-1)},Ee=()=>{Oe?Je():Ce()},U=()=>{const G=ge(),je=[];for(let Fe=1;Fe<=G;Fe++)je.push(n.jsxs("div",{className:"flex items-center",children:[n.jsxs("div",{className:"flex items-center",children:[n.jsx("div",{className:`flex items-center justify-center w-8 h-8 rounded-full border-2 transition-colors ${Fe<Re?"bg-green-500 border-green-500 text-white":Fe===Re?"bg-blue-600 border-blue-600 text-white":"bg-white border-neutral-300 text-neutral-500"}`,children:Fe<Re?n.jsx(mb,{className:"w-4 h-4"}):Fe}),n.jsx("div",{className:"ml-2",children:n.jsx("div",{className:`text-sm font-medium ${Fe===Re?"text-blue-900":"text-neutral-600"}`,children:ie(Fe)})})]}),Fe<G&&n.jsx(Hu,{className:"w-5 h-5 mx-4 text-neutral-400"})]},Fe));return n.jsx("div",{className:"bg-neutral-50 px-6 py-4 border-b border-neutral-200",children:n.jsx("div",{className:"flex items-center justify-between",children:je})})},q=()=>n.jsxs("div",{className:"p-6 space-y-6",children:[n.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:n.jsx("p",{className:"text-sm text-blue-800",children:"第一步：填写项目的基础信息和联系人信息。合同类型分为总价合同和单价合同，总价合同无需录入产品信息。"})}),n.jsxs("div",{className:"border-b border-neutral-200 pb-4",children:[n.jsx("h4",{className:"text-sm font-semibold text-neutral-900 mb-3",children:"基础信息"}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:["合同编号 ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:(B==null?void 0:B.contractNumber)||"",onChange:G=>ee(B?{...B,contractNumber:G.target.value}:null),placeholder:"请输入合同编号",className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:["合同类型 ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsxs("select",{value:(B==null?void 0:B.contractType)||"total",onChange:G=>ee(B?{...B,contractType:G.target.value}:null),className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[n.jsx("option",{value:"total",children:"总价合同"}),n.jsx("option",{value:"unit",children:"单价合同"})]})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:["项目名称 ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:(B==null?void 0:B.projectName)||"",onChange:G=>ee(B?{...B,projectName:G.target.value}:null),placeholder:"请输入项目名称",className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:["客户名称 ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:(B==null?void 0:B.clientName)||"",onChange:G=>ee(B?{...B,clientName:G.target.value}:null),placeholder:"请输入客户名称",className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:["合同生效日期 ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"date",value:(B==null?void 0:B.contractEffectiveDate)||"",onChange:G=>ee(B?{...B,contractEffectiveDate:G.target.value}:null),className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:["项目金额 ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:(B==null?void 0:B.projectAmount)||"",onChange:G=>ee(B?{...B,projectAmount:G.target.value}:null),placeholder:"如：100万元",className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]})]}),n.jsxs("div",{className:"mt-4",children:[n.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:"合同描述"}),n.jsx("textarea",{value:(B==null?void 0:B.contractDescription)||"",onChange:G=>ee(B?{...B,contractDescription:G.target.value}:null),placeholder:"请输入合同描述",rows:3,className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]})]}),n.jsxs("div",{children:[n.jsx("h4",{className:"text-sm font-semibold text-neutral-900 mb-3",children:"联系人信息"}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:"甲方联系人"}),n.jsx("input",{type:"text",value:(B==null?void 0:B.partyAContact)||"",onChange:G=>ee(B?{...B,partyAContact:G.target.value}:null),placeholder:"请输入甲方联系人",className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:"甲方联系方式"}),n.jsx("input",{type:"text",value:(B==null?void 0:B.partyAContactInfo)||"",onChange:G=>ee(B?{...B,partyAContactInfo:G.target.value}:null),placeholder:"请输入联系方式",className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:"乙方联系人"}),n.jsx("input",{type:"text",value:(B==null?void 0:B.partyBContact)||"",onChange:G=>ee(B?{...B,partyBContact:G.target.value}:null),placeholder:"请输入乙方联系人",className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:"乙方联系方式"}),n.jsx("input",{type:"text",value:(B==null?void 0:B.partyBContactInfo)||"",onChange:G=>ee(B?{...B,partyBContactInfo:G.target.value}:null),placeholder:"请输入联系方式",className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]})]})]})]}),J=()=>n.jsxs("div",{className:"p-6 space-y-4",children:[n.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:n.jsx("p",{className:"text-sm text-blue-800",children:"第二步：录入合同产品信息，包括产品名称、规格、数量、单价等详细信息。"})}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("h4",{className:"text-sm font-semibold text-neutral-900",children:"合同产品列表"}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("button",{onClick:()=>Be(!0),className:"px-3 py-1.5 text-sm bg-green-600 text-white rounded hover:bg-green-700 transition-colors flex items-center",children:[n.jsx(Vx,{className:"w-4 h-4 mr-1"}),"批量上传"]}),n.jsxs("button",{onClick:zr,className:"px-3 py-1.5 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors flex items-center",children:[n.jsx(Ct,{className:"w-4 h-4 mr-1"}),"新增产品"]})]})]}),n.jsx("div",{className:"border border-neutral-200 rounded-lg overflow-hidden",children:n.jsxs("table",{className:"w-full",children:[n.jsx("thead",{className:"bg-neutral-50 border-b border-neutral-200",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"序号"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"产品名称"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"产品规格"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"数量"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"单价"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"总价"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"操作"})]})}),n.jsx("tbody",{className:"divide-y divide-neutral-200",children:B&&bt().length===0?n.jsx("tr",{children:n.jsx("td",{colSpan:7,className:"px-4 py-8 text-center text-neutral-500",children:'暂无产品，请点击"新增产品"添加'})}):bt().map((G,je)=>n.jsxs("tr",{className:"hover:bg-neutral-50",children:[n.jsx("td",{className:"px-4 py-3 text-sm text-neutral-900",children:(ue-1)*xe+je+1}),n.jsx("td",{className:"px-4 py-3 text-sm text-neutral-900",children:G.productName}),n.jsx("td",{className:"px-4 py-3 text-sm text-neutral-600",children:G.productSpec||"-"}),n.jsx("td",{className:"px-4 py-3 text-sm text-neutral-600",children:G.quantity}),n.jsx("td",{className:"px-4 py-3 text-sm text-neutral-600",children:G.unitPrice}),n.jsx("td",{className:"px-4 py-3 text-sm text-neutral-600",children:G.totalPrice}),n.jsx("td",{className:"px-4 py-3 text-sm",children:n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("button",{onClick:()=>nr(G),className:"text-primary-600 hover:text-primary-800",title:"编辑",children:n.jsx(Et,{className:"w-4 h-4"})}),n.jsx("button",{onClick:()=>Pr(G.id),className:"text-red-600 hover:text-red-800",title:"删除",children:n.jsx(qe,{className:"w-4 h-4"})})]})})]},G.id))})]})}),B&&B.products.length>0&&n.jsxs("div",{className:"flex items-center justify-center gap-6 pt-3 border-t border-neutral-200",children:[n.jsxs("div",{className:"text-sm text-neutral-700",children:["共 ",B.products.length," 条"]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("button",{onClick:()=>ve(Math.max(1,ue-1)),disabled:ue===1,className:`px-2 py-1 text-sm rounded transition-colors ${ue===1?"bg-neutral-100 text-neutral-400 cursor-not-allowed":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:"<"}),Array.from({length:Math.min(5,T)},(G,je)=>{let Fe;return T<=5||ue<=3?Fe=je+1:ue>=T-2?Fe=T-4+je:Fe=ue-2+je,n.jsx("button",{onClick:()=>ve(Fe),className:`px-2.5 py-1 text-sm rounded transition-colors ${ue===Fe?"bg-primary-600 text-white":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:Fe},Fe)}),n.jsx("button",{onClick:()=>ve(Math.min(T,ue+1)),disabled:ue===T,className:`px-2 py-1 text-sm rounded transition-colors ${ue===T?"bg-neutral-100 text-neutral-400 cursor-not-allowed":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:">"})]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsxs("select",{value:xe,onChange:G=>z(Number(G.target.value)),className:"px-2 py-1 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500",children:[n.jsx("option",{value:5,children:"5条/页"}),n.jsx("option",{value:10,children:"10条/页"}),n.jsx("option",{value:20,children:"20条/页"})]}),n.jsx("span",{className:"text-sm text-neutral-700",children:"前往"}),n.jsx("input",{type:"number",value:E,onChange:G=>ke(G.target.value),placeholder:"页",className:"w-12 px-2 py-1 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500",min:1,max:T}),n.jsx("button",{onClick:R,className:"px-3 py-1 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-50 transition-colors",children:"页"})]})]})]}),fe=()=>n.jsxs("div",{className:"p-6 space-y-6",children:[n.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:n.jsxs("p",{className:"text-sm text-blue-800",children:[(B==null?void 0:B.contractType)==="total"?"第二步":"第三步","：上传合同附件和验收证明。您可以选择上传完整合同或关键页。"]})}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-3",children:["请选择上传方式 ",n.jsx("span",{className:"text-red-500",children:"*"}),n.jsx("span",{className:"text-xs text-neutral-500 ml-2",children:"(可多选)"})]}),n.jsxs("div",{className:"flex items-center space-x-4",children:[n.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[n.jsx("input",{type:"checkbox",checked:ae,onChange:G=>he(G.target.checked),className:"w-4 h-4 text-primary-600 rounded"}),n.jsx("span",{className:"text-sm font-medium text-neutral-700",children:"上传完整合同"})]}),n.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[n.jsx("input",{type:"checkbox",checked:O,onChange:G=>I(G.target.checked),className:"w-4 h-4 text-primary-600 rounded"}),n.jsx("span",{className:"text-sm font-medium text-neutral-700",children:"上传关键页"})]})]})]}),ae&&n.jsxs("div",{className:"border border-neutral-200 rounded-lg p-4",children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:["完整合同 ",n.jsx("span",{className:"text-neutral-500 text-xs",children:"(支持多文件上传)"})]}),n.jsxs("div",{className:"border-2 border-dashed border-neutral-300 rounded-lg p-6 text-center hover:border-primary-500 transition-colors cursor-pointer",onClick:()=>{var G;return(G=document.getElementById("whole-contract-upload"))==null?void 0:G.click()},children:[n.jsx(wt,{className:"w-8 h-8 mx-auto text-neutral-400 mb-2"}),n.jsx("p",{className:"text-sm text-neutral-600",children:"点击或拖拽文件到此处上传（支持多选）"}),n.jsx("p",{className:"text-xs text-neutral-500 mt-1",children:"支持 PDF、Word 格式"}),n.jsx("input",{id:"whole-contract-upload",type:"file",className:"hidden",accept:".pdf,.doc,.docx",multiple:!0,onChange:G=>{G.target.files&&Array.from(G.target.files).forEach(je=>Cn("wholeContract",je))}})]}),B&&B.attachments.wholeContract.length>0&&n.jsxs("div",{className:"mt-3 space-y-2",children:[n.jsx("p",{className:"text-sm font-medium text-neutral-700",children:"已上传文件："}),B.attachments.wholeContract.map((G,je)=>n.jsxs("div",{className:"flex items-center justify-between bg-neutral-50 px-3 py-2 rounded",children:[n.jsxs("div",{className:"flex items-center space-x-2 flex-1 min-w-0",children:[n.jsx(Pt,{className:"w-4 h-4 text-neutral-400 flex-shrink-0"}),n.jsx("span",{className:"text-sm text-neutral-900 truncate",children:G.name})]}),n.jsx("button",{onClick:()=>un("wholeContract",je),className:"text-red-600 hover:text-red-800 ml-2 flex-shrink-0",children:n.jsx(qe,{className:"w-4 h-4"})})]},je))]})]}),O&&n.jsx("div",{className:"space-y-4",children:[{key:"contractFirstPage",label:"合同首页"},{key:"contractMainTerms",label:"合同主要条款页"},{key:"contractSealPage",label:"合同盖章页"}].map(({key:G,label:je})=>n.jsxs("div",{className:"border border-neutral-200 rounded-lg p-4",children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:[je," ",n.jsx("span",{className:"text-neutral-500 text-xs",children:"(支持多文件上传)"})]}),n.jsxs("div",{className:"border-2 border-dashed border-neutral-300 rounded-lg p-6 text-center hover:border-primary-500 transition-colors cursor-pointer",onClick:()=>{var Fe;return(Fe=document.getElementById(`${G}-upload`))==null?void 0:Fe.click()},children:[n.jsx(wt,{className:"w-8 h-8 mx-auto text-neutral-400 mb-2"}),n.jsx("p",{className:"text-sm text-neutral-600",children:"点击或拖拽文件到此处上传（支持多选）"}),n.jsx("p",{className:"text-xs text-neutral-500 mt-1",children:"支持 PDF、Word、图片 格式"}),n.jsx("input",{id:`${G}-upload`,type:"file",className:"hidden",accept:".pdf,.doc,.docx,image/*",multiple:!0,onChange:Fe=>{Fe.target.files&&Array.from(Fe.target.files).forEach(we=>Cn(G,we))}})]}),B&&B.attachments[G].length>0&&n.jsxs("div",{className:"mt-3 space-y-2",children:[n.jsx("p",{className:"text-sm font-medium text-neutral-700",children:"已上传文件："}),B.attachments[G].map((Fe,we)=>n.jsxs("div",{className:"flex items-center justify-between bg-neutral-50 px-3 py-2 rounded",children:[n.jsxs("div",{className:"flex items-center space-x-2 flex-1 min-w-0",children:[n.jsx(Pt,{className:"w-4 h-4 text-neutral-400 flex-shrink-0"}),n.jsx("span",{className:"text-sm text-neutral-900 truncate",children:Fe.name})]}),n.jsx("button",{onClick:()=>un(G,we),className:"text-red-600 hover:text-red-800 ml-2 flex-shrink-0",children:n.jsx(qe,{className:"w-4 h-4"})})]},we))]})]},G))}),n.jsxs("div",{className:"border border-neutral-200 rounded-lg p-4",children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:["验收证明 ",n.jsx("span",{className:"text-neutral-500 text-xs",children:"(支持多文件上传)"})]}),n.jsxs("div",{className:"border-2 border-dashed border-neutral-300 rounded-lg p-6 text-center hover:border-primary-500 transition-colors cursor-pointer",onClick:()=>{var G;return(G=document.getElementById("acceptance-upload"))==null?void 0:G.click()},children:[n.jsx(wt,{className:"w-8 h-8 mx-auto text-neutral-400 mb-2"}),n.jsx("p",{className:"text-sm text-neutral-600",children:"点击或拖拽文件到此处上传（支持多选）"}),n.jsx("p",{className:"text-xs text-neutral-500 mt-1",children:"支持 PDF、Word、图片 格式"}),n.jsx("input",{id:"acceptance-upload",type:"file",className:"hidden",accept:".pdf,.doc,.docx,image/*",multiple:!0,onChange:G=>{G.target.files&&Array.from(G.target.files).forEach(je=>Cn("acceptanceCertificate",je))}})]}),B&&B.attachments.acceptanceCertificate.length>0&&n.jsxs("div",{className:"mt-3 space-y-2",children:[n.jsx("p",{className:"text-sm font-medium text-neutral-700",children:"已上传文件："}),B.attachments.acceptanceCertificate.map((G,je)=>n.jsxs("div",{className:"flex items-center justify-between bg-neutral-50 px-3 py-2 rounded",children:[n.jsxs("div",{className:"flex items-center space-x-2 flex-1 min-w-0",children:[n.jsx(Pt,{className:"w-4 h-4 text-neutral-400 flex-shrink-0"}),n.jsx("span",{className:"text-sm text-neutral-900 truncate",children:G.name})]}),n.jsx("button",{onClick:()=>un("acceptanceCertificate",je),className:"text-red-600 hover:text-red-800 ml-2 flex-shrink-0",children:n.jsx(qe,{className:"w-4 h-4"})})]},je))]})]}),n.jsxs("div",{className:"border border-neutral-200 rounded-lg p-4",children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:["客户证明材料 ",n.jsx("span",{className:"text-neutral-500 text-xs",children:"(支持多文件上传)"})]}),n.jsxs("div",{className:"border-2 border-dashed border-neutral-300 rounded-lg p-6 text-center hover:border-primary-500 transition-colors cursor-pointer",onClick:()=>{var G;return(G=document.getElementById("client-proof-upload"))==null?void 0:G.click()},children:[n.jsx(wt,{className:"w-8 h-8 mx-auto text-neutral-400 mb-2"}),n.jsx("p",{className:"text-sm text-neutral-600",children:"点击或拖拽文件到此处上传（支持多选）"}),n.jsx("p",{className:"text-xs text-neutral-500 mt-1",children:"支持 PDF、Word、图片 格式"}),n.jsx("input",{id:"client-proof-upload",type:"file",className:"hidden",accept:".pdf,.doc,.docx,image/*",multiple:!0,onChange:G=>{G.target.files&&Array.from(G.target.files).forEach(je=>Cn("clientProof",je))}})]}),B&&B.attachments.clientProof.length>0&&n.jsxs("div",{className:"mt-3 space-y-2",children:[n.jsx("p",{className:"text-sm font-medium text-neutral-700",children:"已上传文件："}),B.attachments.clientProof.map((G,je)=>n.jsxs("div",{className:"flex items-center justify-between bg-neutral-50 px-3 py-2 rounded",children:[n.jsxs("div",{className:"flex items-center space-x-2 flex-1 min-w-0",children:[n.jsx(Pt,{className:"w-4 h-4 text-neutral-400 flex-shrink-0"}),n.jsx("span",{className:"text-sm text-neutral-900 truncate",children:G.name})]}),n.jsx("button",{onClick:()=>un("clientProof",je),className:"text-red-600 hover:text-red-800 ml-2 flex-shrink-0",children:n.jsx(qe,{className:"w-4 h-4"})})]},je))]})]})]})]}),be=()=>n.jsxs("div",{className:"p-6 space-y-4",children:[n.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:n.jsxs("p",{className:"text-sm text-blue-800",children:[(B==null?void 0:B.contractType)==="total"?"第三步":"第四步","：上传发票信息，包括发票编号、金额及发票文件。"]})}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("h4",{className:"text-sm font-semibold text-neutral-900",children:"发票列表"}),n.jsxs("button",{onClick:rr,className:"px-3 py-1.5 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors flex items-center",children:[n.jsx(Ct,{className:"w-4 h-4 mr-1"}),"新增发票"]})]}),n.jsx("div",{className:"border border-neutral-200 rounded-lg overflow-hidden",children:n.jsxs("table",{className:"w-full",children:[n.jsx("thead",{className:"bg-neutral-50 border-b border-neutral-200",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"序号"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"发票编号"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"发票金额"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"发票文件"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"操作"})]})}),n.jsx("tbody",{className:"divide-y divide-neutral-200",children:B&&B.invoices.length===0?n.jsx("tr",{children:n.jsx("td",{colSpan:5,className:"px-4 py-8 text-center text-neutral-500",children:'暂无发票，请点击"新增发票"添加'})}):V().map((G,je)=>n.jsxs("tr",{className:"hover:bg-neutral-50",children:[n.jsx("td",{className:"px-4 py-3 text-sm text-neutral-900",children:(pe-1)*Ne+je+1}),n.jsx("td",{className:"px-4 py-3 text-sm text-neutral-900",children:G.invoiceNumber}),n.jsx("td",{className:"px-4 py-3 text-sm text-neutral-600",children:G.invoiceAmount}),n.jsx("td",{className:"px-4 py-3 text-sm text-neutral-600",children:G.invoiceFile?"已上传":"未上传"}),n.jsx("td",{className:"px-4 py-3 text-sm",children:n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("button",{onClick:()=>dr(G),className:"text-primary-600 hover:text-primary-800",title:"编辑",children:n.jsx(Et,{className:"w-4 h-4"})}),n.jsx("button",{onClick:()=>yr(G.id),className:"text-red-600 hover:text-red-800",title:"删除",children:n.jsx(qe,{className:"w-4 h-4"})})]})})]},G.id))})]})}),B&&B.invoices.length>0&&n.jsxs("div",{className:"flex items-center justify-center gap-6 pt-3 border-t border-neutral-200",children:[n.jsxs("div",{className:"text-sm text-neutral-700",children:["共 ",B.invoices.length," 条"]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("button",{onClick:()=>Ue(Math.max(1,pe-1)),disabled:pe===1,className:`px-2 py-1 text-sm rounded transition-colors ${pe===1?"bg-neutral-100 text-neutral-400 cursor-not-allowed":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:"<"}),n.jsx("div",{className:"flex items-center space-x-1",children:Array.from({length:Math.min(10,L)},(G,je)=>{let Fe;return L<=10||pe<=5?Fe=je+1:pe>=L-4?Fe=L-9+je:Fe=pe-4+je,n.jsx("button",{onClick:()=>Ue(Fe),className:`px-2.5 py-1 text-sm rounded transition-colors ${pe===Fe?"bg-primary-600 text-white":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:Fe},Fe)})}),n.jsx("button",{onClick:()=>Ue(Math.min(L,pe+1)),disabled:pe===L,className:`px-2 py-1 text-sm rounded transition-colors ${pe===L?"bg-neutral-100 text-neutral-400 cursor-not-allowed":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:">"})]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsxs("select",{value:Ne,onChange:G=>X(Number(G.target.value)),className:"px-2 py-1 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500",children:[n.jsx("option",{value:5,children:"5条/页"}),n.jsx("option",{value:10,children:"10条/页"}),n.jsx("option",{value:20,children:"20条/页"})]}),n.jsx("span",{className:"text-sm text-neutral-700",children:"前往"}),n.jsx("input",{type:"number",value:oe,onChange:G=>Ie(G.target.value),placeholder:"页",className:"w-12 px-2 py-1 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500",min:1,max:L}),n.jsx("button",{onClick:le,className:"px-3 py-1 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-50 transition-colors",children:"页"})]})]})]}),Le=()=>B?Re===1?q():B.contractType==="unit"&&Re===2?J():B.contractType==="total"&&Re===2||B.contractType==="unit"&&Re===3?fe():B.contractType==="total"&&Re===3||B.contractType==="unit"&&Re===4?be():null:null;return n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"bg-white rounded-lg border border-neutral-200",children:[n.jsxs("div",{className:"px-6 py-4 border-b border-neutral-200",children:[n.jsx("div",{className:"flex items-center justify-between mb-4",children:n.jsx("h2",{className:"text-lg font-medium text-neutral-900",children:"业绩信息"})}),n.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4",children:n.jsx("p",{className:"text-sm text-blue-700",children:"该模块用于管理企业的历史业绩和项目经验，包括合同信息、项目详情、项目产品、发票信息等。业绩信息是证明企业实力和项目经验的重要依据，在投标时将自动匹配相关项目要求。请详细填写项目信息。"})}),n.jsxs("div",{className:"flex flex-col gap-3",children:[n.jsxs("div",{className:"flex items-center gap-3 flex-wrap",children:[n.jsx("span",{className:"text-sm text-neutral-700",children:"合同时间"}),n.jsx("input",{type:"date",value:x,onChange:G=>h(G.target.value),className:"px-3 py-1.5 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500"}),n.jsx("span",{className:"text-sm text-neutral-500",children:"至"}),n.jsx("input",{type:"date",value:p,onChange:G=>m(G.target.value),className:"px-3 py-1.5 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500"}),n.jsx("span",{className:"text-sm text-neutral-700",children:"合同编号"}),n.jsx("input",{type:"text",placeholder:"请输入合同编号",value:s,onChange:G=>i(G.target.value),className:"w-40 px-3 py-1.5 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500"}),n.jsx("span",{className:"text-sm text-neutral-700",children:"项目名称"}),n.jsx("input",{type:"text",placeholder:"请输入项目名称",value:l,onChange:G=>c(G.target.value),className:"w-40 px-3 py-1.5 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500"}),n.jsx("span",{className:"text-sm text-neutral-700",children:"客户名称"}),n.jsx("input",{type:"text",placeholder:"请输入客户名称",value:o,onChange:G=>u(G.target.value),className:"w-40 px-3 py-1.5 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500"}),n.jsx("span",{className:"text-sm text-neutral-700",children:"最低金额"}),n.jsx("input",{type:"text",placeholder:"如：100",value:d,onChange:G=>f(G.target.value),className:"w-32 px-3 py-1.5 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{className:"flex items-center justify-end gap-2",children:[n.jsx("button",{onClick:Qe,className:"px-4 py-1.5 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-50 transition-colors",children:"重置"}),n.jsx("button",{onClick:Dt,className:"px-4 py-1.5 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors",children:"查询"})]})]})]}),!t&&n.jsx("div",{className:"px-6 py-3 border-b border-neutral-200",children:n.jsxs("button",{onClick:Xe,className:"px-4 py-1.5 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors flex items-center",children:[n.jsx(Ct,{className:"w-4 h-4 mr-1"}),"新增业绩"]})}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"w-full",children:[n.jsx("thead",{className:"bg-neutral-50 border-b border-neutral-200",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"序号"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"合同编号"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"合同类型"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"项目名称"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"客户名称"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"合同时间"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"项目金额"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"操作"})]})}),n.jsx("tbody",{className:"divide-y divide-neutral-200",children:na().length===0?n.jsx("tr",{children:n.jsx("td",{colSpan:8,className:"px-4 py-8 text-center text-neutral-500",children:"暂无数据"})}):na().map((G,je)=>n.jsxs("tr",{className:"hover:bg-neutral-50",children:[n.jsx("td",{className:"px-4 py-3 text-sm text-neutral-900",children:(w-1)*b+je+1}),n.jsx("td",{className:"px-4 py-3 text-sm text-neutral-900",children:G.contractNumber}),n.jsx("td",{className:"px-4 py-3 text-sm text-neutral-600",children:n.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded text-xs font-medium ${G.contractType==="total"?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"}`,children:G.contractType==="total"?"总价合同":"单价合同"})}),n.jsx("td",{className:"px-4 py-3 text-sm text-neutral-900",children:G.projectName}),n.jsx("td",{className:"px-4 py-3 text-sm text-neutral-600",children:G.clientName}),n.jsx("td",{className:"px-4 py-3 text-sm text-neutral-600",children:G.contractEffectiveDate||"-"}),n.jsx("td",{className:"px-4 py-3 text-sm text-neutral-600",children:G.projectAmount}),n.jsx("td",{className:"px-4 py-3 text-sm",children:n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("button",{onClick:()=>at(G),className:"text-primary-600 hover:text-primary-800",title:"编辑",children:n.jsx(Et,{className:"w-4 h-4"})}),!t&&n.jsx("button",{onClick:()=>se(G),className:"text-red-600 hover:text-red-800",title:"删除",children:n.jsx(qe,{className:"w-4 h-4"})})]})})]},G.id))})]})}),n.jsxs("div",{className:"bg-white border-t border-neutral-200 px-6 py-3 flex items-center justify-center gap-6",children:[n.jsxs("div",{className:"text-sm text-neutral-700",children:["共 ",Tn.length," 条"]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("button",{onClick:()=>v(Math.max(1,w-1)),disabled:w===1,className:`px-2 py-1 text-sm rounded transition-colors ${w===1?"bg-neutral-100 text-neutral-400 cursor-not-allowed":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:"<"}),n.jsx("div",{className:"flex items-center space-x-1",children:Array.from({length:Math.min(10,ar)},(G,je)=>{let Fe;return ar<=10||w<=5?Fe=je+1:w>=ar-4?Fe=ar-9+je:Fe=w-4+je,n.jsx("button",{onClick:()=>v(Fe),className:`px-2.5 py-1 text-sm rounded transition-colors ${w===Fe?"bg-primary-600 text-white":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:Fe},Fe)})}),n.jsx("button",{onClick:()=>v(Math.min(ar,w+1)),disabled:w===ar,className:`px-2 py-1 text-sm rounded transition-colors ${w===ar?"bg-neutral-100 text-neutral-400 cursor-not-allowed":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:">"})]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsxs("select",{value:b,onChange:G=>_a(Number(G.target.value)),className:"px-2 py-1 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500",children:[n.jsx("option",{value:10,children:"10条/页"}),n.jsx("option",{value:20,children:"20条/页"}),n.jsx("option",{value:50,children:"50条/页"})]}),n.jsx("span",{className:"text-sm text-neutral-700",children:"前往"}),n.jsx("input",{type:"number",value:N,onChange:G=>F(G.target.value),placeholder:"页",className:"w-12 px-2 py-1 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500",min:1,max:ar}),n.jsx("button",{onClick:Qr,className:"px-3 py-1 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-50 transition-colors",children:"页"})]})]})]}),(j||S)&&B&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-5xl max-h-[90vh] flex flex-col",children:[n.jsxs("div",{className:"px-6 py-4 border-b border-neutral-200 flex items-center justify-between flex-shrink-0",children:[n.jsx("h3",{className:"text-lg font-semibold text-neutral-900",children:Oe?"编辑业绩信息":"新增业绩信息"}),n.jsx("button",{onClick:()=>{k(!1),P(!1),Me(1)},className:"text-neutral-400 hover:text-neutral-600",children:n.jsx(Ze,{className:"w-6 h-6"})})]}),U(),n.jsx("div",{className:"flex-1 overflow-y-auto",children:Le()}),n.jsxs("div",{className:"px-6 py-4 border-t border-neutral-200 flex justify-between flex-shrink-0",children:[n.jsx("button",{onClick:Se,disabled:Re===1,className:`px-4 py-2 border border-neutral-300 text-neutral-700 rounded-lg transition-colors ${Re===1?"opacity-50 cursor-not-allowed":"hover:bg-neutral-50"}`,children:"上一步"}),n.jsxs("div",{className:"flex space-x-3",children:[n.jsx("button",{onClick:()=>{k(!1),P(!1),Me(1)},className:"px-4 py-2 border border-neutral-300 text-neutral-700 rounded-lg hover:bg-neutral-100 transition-colors",children:"取消"}),Re<ge()?n.jsx("button",{onClick:de,disabled:!ce(),className:`px-4 py-2 bg-primary-600 text-white rounded-lg transition-colors ${ce()?"hover:bg-primary-700":"opacity-50 cursor-not-allowed"}`,children:"下一步"}):n.jsx("button",{onClick:Ee,className:"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors",children:"完成"})]})]})]})}),g&&A&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[60] p-4",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[n.jsxs("div",{className:"px-6 py-4 border-b border-neutral-200 flex items-center justify-between sticky top-0 bg-white",children:[n.jsx("h3",{className:"text-lg font-medium text-neutral-900",children:A.id&&(B!=null&&B.products.some(G=>G.id===A.id))?"编辑产品":"新增产品"}),n.jsx("button",{onClick:()=>{_(!1),ne(null)},className:"text-neutral-400 hover:text-neutral-600",children:n.jsx(Ze,{className:"w-5 h-5"})})]}),n.jsx("div",{className:"p-6 space-y-4",children:n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:["产品名称 ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:A.productName,onChange:G=>ne({...A,productName:G.target.value}),placeholder:"请输入产品名称",className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:"产品规格"}),n.jsx("input",{type:"text",value:A.productSpec,onChange:G=>ne({...A,productSpec:G.target.value}),placeholder:"请输入产品规格",className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:["数量 ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:A.quantity,onChange:G=>{const je=G.target.value;ne({...A,quantity:je});const Fe=parseFloat(je.replace(/[^0-9.]/g,"")),we=parseFloat(A.unitPrice.replace(/[^0-9.]/g,""));if(!isNaN(Fe)&&!isNaN(we)){const ct=Fe*we;ne(xt=>({...xt,quantity:je,totalPrice:ct.toFixed(2)+"元"}))}},placeholder:"如：100台",className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:["单价 ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:A.unitPrice,onChange:G=>{const je=G.target.value;ne({...A,unitPrice:je});const Fe=parseFloat(A.quantity.replace(/[^0-9.]/g,"")),we=parseFloat(je.replace(/[^0-9.]/g,""));if(!isNaN(Fe)&&!isNaN(we)){const ct=Fe*we;ne(xt=>({...xt,unitPrice:je,totalPrice:ct.toFixed(2)+"元"}))}},placeholder:"如：5000元/台",className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:["总价 ",n.jsx("span",{className:"text-red-500",children:"*"}),n.jsx("span",{className:"text-xs text-neutral-500 ml-2",children:"(自动计算)"})]}),n.jsx("input",{type:"text",value:A.totalPrice,onChange:G=>ne({...A,totalPrice:G.target.value}),placeholder:"如：50万元",className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 bg-neutral-50"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:"备注"}),n.jsx("input",{type:"text",value:A.remarks,onChange:G=>ne({...A,remarks:G.target.value}),placeholder:"请输入备注",className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]})]})}),n.jsxs("div",{className:"px-6 py-4 bg-neutral-50 flex justify-end gap-2 rounded-b-lg sticky bottom-0",children:[n.jsx("button",{onClick:()=>{_(!1),ne(null)},className:"px-4 py-2 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-100 transition-colors",children:"取消"}),n.jsx("button",{onClick:ur,disabled:!A.productName||!A.quantity||!A.unitPrice||!A.totalPrice,className:"px-4 py-2 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"保存"})]})]})}),Z&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[60] p-4",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-lg w-full",children:[n.jsxs("div",{className:"px-6 py-4 border-b border-neutral-200 flex items-center justify-between",children:[n.jsx("h3",{className:"text-lg font-medium text-neutral-900",children:"批量上传产品信息"}),n.jsx("button",{onClick:()=>{Be(!1),nt("")},className:"text-neutral-400 hover:text-neutral-600",children:n.jsx(Ze,{className:"w-5 h-5"})})]}),n.jsxs("div",{className:"p-6 space-y-4",children:[n.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[n.jsx("h4",{className:"text-sm font-semibold text-blue-900 mb-2",children:"上传说明"}),n.jsxs("ul",{className:"text-sm text-blue-800 space-y-1 list-disc list-inside",children:[n.jsx("li",{children:"请先下载模板，按照模板格式填写产品信息"}),n.jsx("li",{children:"必填字段：产品名称、数量、单价"}),n.jsx("li",{children:"支持格式：.xlsx, .xls"}),n.jsx("li",{children:"系统会自动计算总价"})]})]}),n.jsx("div",{className:"flex items-center justify-center gap-3",children:n.jsxs("button",{onClick:ka,className:"flex items-center gap-2 px-4 py-2 text-sm bg-neutral-100 text-neutral-700 rounded-lg hover:bg-neutral-200 transition-colors",children:[n.jsx(js,{className:"w-4 h-4"}),"下载模板"]})}),n.jsx("div",{className:"border-2 border-dashed border-neutral-300 rounded-lg p-8",children:n.jsxs("label",{className:"flex flex-col items-center cursor-pointer hover:border-primary-500 transition-colors",children:[n.jsx(Vx,{className:"w-12 h-12 text-neutral-400 mb-3"}),n.jsx("span",{className:"text-sm font-medium text-neutral-700 mb-1",children:"点击选择Excel文件"}),n.jsx("span",{className:"text-xs text-neutral-500",children:"支持 .xlsx, .xls 格式"}),n.jsx("input",{type:"file",accept:".xlsx,.xls",onChange:ja,className:"hidden"})]})}),ze&&n.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:n.jsx("p",{className:"text-sm text-red-800",children:ze})}),n.jsxs("div",{className:"bg-neutral-50 border border-neutral-200 rounded-lg p-3",children:[n.jsx("h5",{className:"text-xs font-semibold text-neutral-700 mb-2",children:"Excel列名要求："}),n.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs text-neutral-600",children:[n.jsx("div",{children:"• 产品名称 (必填)"}),n.jsx("div",{children:"• 产品规格"}),n.jsx("div",{children:"• 数量 (必填)"}),n.jsx("div",{children:"• 单价 (必填)"}),n.jsx("div",{children:"• 备注"})]})]})]}),n.jsx("div",{className:"px-6 py-4 bg-neutral-50 flex justify-end gap-2 rounded-b-lg",children:n.jsx("button",{onClick:()=>{Be(!1),nt("")},className:"px-4 py-2 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-100 transition-colors",children:"关闭"})})]})}),re&&te&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[60] p-4",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[n.jsxs("div",{className:"px-6 py-4 border-b border-neutral-200 flex items-center justify-between sticky top-0 bg-white",children:[n.jsx("h3",{className:"text-lg font-medium text-neutral-900",children:te.id&&(B!=null&&B.invoices.some(G=>G.id===te.id))?"编辑发票":"新增发票"}),n.jsx("button",{onClick:()=>{Q(!1),H(null)},className:"text-neutral-400 hover:text-neutral-600",children:n.jsx(Ze,{className:"w-5 h-5"})})]}),n.jsxs("div",{className:"p-6 space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:["发票编号 ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:te.invoiceNumber,onChange:G=>H({...te,invoiceNumber:G.target.value}),placeholder:"请输入发票编号",className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:["发票金额 ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:te.invoiceAmount,onChange:G=>H({...te,invoiceAmount:G.target.value}),placeholder:"如：10万元",className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:"发票文件"}),n.jsxs("div",{className:"border-2 border-dashed border-neutral-300 rounded-lg p-6 text-center hover:border-primary-500 transition-colors cursor-pointer",onClick:()=>{var G;return(G=document.getElementById("invoice-file-upload"))==null?void 0:G.click()},children:[n.jsx(wt,{className:"w-8 h-8 mx-auto text-neutral-400 mb-2"}),n.jsx("p",{className:"text-sm text-neutral-600",children:"点击或拖拽文件到此处上传"}),n.jsx("p",{className:"text-xs text-neutral-500 mt-1",children:"支持 PDF、图片 格式"}),n.jsx("input",{id:"invoice-file-upload",type:"file",className:"hidden",accept:".pdf,image/*",onChange:G=>{var je;return((je=G.target.files)==null?void 0:je[0])&&ra("invoiceFile",G.target.files[0])}})]}),te.invoiceFile&&n.jsxs("div",{className:"mt-3",children:[n.jsx("p",{className:"text-sm font-medium text-neutral-700 mb-2",children:"已上传文件："}),n.jsxs("div",{className:"flex items-center justify-between bg-neutral-50 px-3 py-2 rounded",children:[n.jsxs("div",{className:"flex items-center space-x-2 flex-1 min-w-0",children:[n.jsx(Pt,{className:"w-4 h-4 text-neutral-400 flex-shrink-0"}),n.jsx("span",{className:"text-sm text-neutral-900 truncate",children:te.invoiceFile.name})]}),n.jsx("button",{onClick:()=>En("invoiceFile"),className:"text-red-600 hover:text-red-800 ml-2 flex-shrink-0",children:n.jsx(qe,{className:"w-4 h-4"})})]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:"验证材料"}),n.jsxs("div",{className:"border-2 border-dashed border-neutral-300 rounded-lg p-6 text-center hover:border-primary-500 transition-colors cursor-pointer",onClick:()=>{var G;return(G=document.getElementById("verification-file-upload"))==null?void 0:G.click()},children:[n.jsx(wt,{className:"w-8 h-8 mx-auto text-neutral-400 mb-2"}),n.jsx("p",{className:"text-sm text-neutral-600",children:"点击或拖拽文件到此处上传"}),n.jsx("p",{className:"text-xs text-neutral-500 mt-1",children:"支持 PDF、图片 格式"}),n.jsx("input",{id:"verification-file-upload",type:"file",className:"hidden",accept:".pdf,image/*",onChange:G=>{var je;return((je=G.target.files)==null?void 0:je[0])&&ra("verificationFile",G.target.files[0])}})]}),te.verificationFile&&n.jsxs("div",{className:"mt-3",children:[n.jsx("p",{className:"text-sm font-medium text-neutral-700 mb-2",children:"已上传文件："}),n.jsxs("div",{className:"flex items-center justify-between bg-neutral-50 px-3 py-2 rounded",children:[n.jsxs("div",{className:"flex items-center space-x-2 flex-1 min-w-0",children:[n.jsx(Pt,{className:"w-4 h-4 text-neutral-400 flex-shrink-0"}),n.jsx("span",{className:"text-sm text-neutral-900 truncate",children:te.verificationFile.name})]}),n.jsx("button",{onClick:()=>En("verificationFile"),className:"text-red-600 hover:text-red-800 ml-2 flex-shrink-0",children:n.jsx(qe,{className:"w-4 h-4"})})]})]})]})]}),n.jsxs("div",{className:"px-6 py-4 bg-neutral-50 flex justify-end gap-2 rounded-b-lg sticky bottom-0",children:[n.jsx("button",{onClick:()=>{Q(!1),H(null)},className:"px-4 py-2 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-100 transition-colors",children:"取消"}),n.jsx("button",{onClick:jt,disabled:!te.invoiceNumber||!te.invoiceAmount,className:"px-4 py-2 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"保存"})]})]})}),D&&C&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full",children:[n.jsx("div",{className:"px-6 py-4 border-b border-neutral-200",children:n.jsx("h3",{className:"text-lg font-medium text-neutral-900",children:"确认删除"})}),n.jsx("div",{className:"p-6",children:n.jsxs("div",{className:"flex items-start space-x-3",children:[n.jsx(Hn,{className:"w-6 h-6 text-red-600 flex-shrink-0 mt-0.5"}),n.jsxs("div",{children:[n.jsxs("p",{className:"text-sm text-neutral-700",children:["确定要删除业绩项目 ",n.jsx("strong",{children:C.projectName})," 吗？"]}),n.jsx("p",{className:"text-sm text-neutral-500 mt-1",children:"删除后将无法恢复，请谨慎操作。"})]})]})}),n.jsxs("div",{className:"px-6 py-4 bg-neutral-50 flex justify-end gap-2 rounded-b-lg",children:[n.jsx("button",{onClick:()=>K(!1),className:"px-4 py-2 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-100 transition-colors",children:"取消"}),n.jsx("button",{onClick:Bt,className:"px-4 py-2 text-sm bg-red-600 text-white rounded hover:bg-red-700 transition-colors",children:"删除"})]})]})})]})},BE=({companyId:e,readOnly:t=!1})=>{const[r,a]=M.useState(()=>{const se=localStorage.getItem(`personnel_${e}`);return se?JSON.parse(se):[{id:"1",name:"张三",gender:"男",idNumber:"110101199001011234",isLegalPerson:!0,isAuthorizedRepresentative:!0,phone:"13800138000",position:"项目经理",status:"active",projectExperience:"某某项目、某某项目",idCardFront:null,idCardBack:null,certificates:[{id:"1",name:"本科毕业证",certNumber:"20150001234",issuingOrganization:"某某大学",issueDate:"2015-07-01",validUntil:"",attachments:[{url:"",name:"本科毕业证.pdf",size:1024e3}]}],qualifications:[{id:"1",name:"一级建造师",certNumber:"JZS2020001234",issuingOrganization:"中国建设教育协会",issueDate:"2020-05-15",validUntil:"2026-05-15",attachments:[{url:"",name:"一建证书.pdf",size:2048e3}]}],createdAt:new Date().toISOString()}]});M.useEffect(()=>{localStorage.setItem(`personnel_${e}`,JSON.stringify(r))},[r,e]);const[s,i]=M.useState(""),[l,c]=M.useState("all"),[o,u]=M.useState("all"),[d,f]=M.useState(1),[x,h]=M.useState(10),[p,m]=M.useState(""),[w,v]=M.useState(!1),[b,y]=M.useState(!1),[N,F]=M.useState(!1),[j,k]=M.useState(null),[S,P]=M.useState(null),[D,K]=M.useState(!1),[C,Y]=M.useState(null),[B,ee]=M.useState(!1),[re,Q]=M.useState(null),te=50*1024*1024,H=se=>({active:"可用",resigned:"不可用"})[se]||se,ae=se=>({active:"text-green-600 bg-green-50",resigned:"text-neutral-600 bg-neutral-50",suspended:"text-red-600 bg-red-50"})[se]||"text-neutral-600 bg-neutral-50",he=se=>({status:"正常",color:"text-green-600"}),O=()=>{i(""),c("all"),u("all"),f(1)},I=()=>{console.log("Searching:",s,l,o)},g=()=>{P({id:"",name:"",gender:"男",idNumber:"",isLegalPerson:!1,isAuthorizedRepresentative:!1,phone:"",position:"",status:"active",projectExperience:"",idCardFront:null,idCardBack:null,certificates:[],qualifications:[]}),v(!0)},_=se=>{P({...se}),y(!0)},A=se=>{k(se),F(!0)},ne=()=>{if(S){const se={...S,id:String(Date.now()),createdAt:new Date().toISOString()};a([...r,se]),v(!1)}},ue=()=>{S&&(a(r.map(se=>se.id===S.id?S:se)),y(!1))},ve=()=>{j&&(a(r.filter(se=>se.id!==j.id)),F(!1))},xe=se=>{const Ce=document.createElement("input");Ce.type="file",Ce.accept="image/jpeg,image/png,image/jpg",Ce.onchange=async Je=>{var dr;const rr=(dr=Je.target.files)==null?void 0:dr[0];if(rr&&S){if(rr.size>te){alert(`文件 "${rr.name}" 超过50MB限制，无法上传`);return}const yr=new FileReader;yr.onload=jt=>{var Pr;const nr={url:(Pr=jt.target)==null?void 0:Pr.result,name:rr.name,size:rr.size};P(se==="front"?{...S,idCardFront:nr}:{...S,idCardBack:nr})},yr.readAsDataURL(rr)}},Ce.click()},W=se=>{S&&P(se==="front"?{...S,idCardFront:null}:{...S,idCardBack:null})},E=()=>{Y({id:"",name:"",certNumber:"",issuingOrganization:"",issueDate:"",validUntil:"",attachments:[]}),K(!0)},ke=se=>{Y({...se}),K(!0)},pe=se=>{S&&P({...S,certificates:S.certificates.filter(Ce=>Ce.id!==se)})},Ue=()=>{if(S&&C){if(C.id)P({...S,certificates:S.certificates.map(se=>se.id===C.id?C:se)});else{const se={...C,id:String(Date.now())};P({...S,certificates:[...S.certificates,se]})}K(!1),Y(null)}},Ne=(se,Ce)=>{C&&Y({...C,[se]:Ce})},me=()=>{const se=document.createElement("input");se.type="file",se.accept="image/jpeg,image/png,image/jpg,application/pdf",se.multiple=!0,se.onchange=async Ce=>{const Bt=Ce.target.files;if(Bt&&C){const dr=Array.from(Bt).filter(jt=>jt.size>te?(alert(`文件 "${jt.name}" 超过50MB限制，无法上传`),!1):!0).map(jt=>new Promise(zr=>{const nr=new FileReader;nr.onload=Pr=>{var ur;zr({url:(ur=Pr.target)==null?void 0:ur.result,name:jt.name,size:jt.size})},nr.readAsDataURL(jt)})),yr=await Promise.all(dr);Y({...C,attachments:[...C.attachments,...yr]})}},se.click()},oe=se=>{C&&Y({...C,attachments:C.attachments.filter((Ce,Je)=>Je!==se)})},Ie=()=>{Q({id:"",name:"",certNumber:"",issuingOrganization:"",issueDate:"",validUntil:"",attachments:[]}),ee(!0)},Re=se=>{Q({...se}),ee(!0)},Me=se=>{S&&P({...S,qualifications:S.qualifications.filter(Ce=>Ce.id!==se)})},Oe=()=>{if(S&&re){if(re.id)P({...S,qualifications:S.qualifications.map(se=>se.id===re.id?re:se)});else{const se={...re,id:String(Date.now())};P({...S,qualifications:[...S.qualifications,se]})}ee(!1),Q(null)}},He=(se,Ce)=>{re&&Q({...re,[se]:Ce})},Z=()=>{const se=document.createElement("input");se.type="file",se.accept="image/jpeg,image/png,image/jpg,application/pdf",se.multiple=!0,se.onchange=async Ce=>{const Bt=Ce.target.files;if(Bt&&re){const dr=Array.from(Bt).filter(jt=>jt.size>te?(alert(`文件 "${jt.name}" 超过50MB限制，无法上传`),!1):!0).map(jt=>new Promise(zr=>{const nr=new FileReader;nr.onload=Pr=>{var ur;zr({url:(ur=Pr.target)==null?void 0:ur.result,name:jt.name,size:jt.size})},nr.readAsDataURL(jt)})),yr=await Promise.all(dr);Q({...re,attachments:[...re.attachments,...yr]})}},se.click()},Be=se=>{re&&Q({...re,attachments:re.attachments.filter((Ce,Je)=>Je!==se)})},ze=r.filter(se=>{const Ce=!s||se.name.toLowerCase().includes(s.toLowerCase()),Je=l==="all"||se.status===l,Bt=o==="all"||o==="yes"&&se.isLegalPerson||o==="no"&&!se.isLegalPerson;return Ce&&Je&&Bt}).sort((se,Ce)=>{const Je=se.createdAt?new Date(se.createdAt).getTime():0;return(Ce.createdAt?new Date(Ce.createdAt).getTime():0)-Je}),nt=()=>{const se=(d-1)*x,Ce=se+x;return ze.slice(se,Ce)},Qe=Math.ceil(ze.length/x),Dt=se=>{h(se),f(1)},Xe=()=>{const se=parseInt(p);se>=1&&se<=Qe&&(f(se),m(""))},at=se=>S?n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-6xl w-full max-h-[90vh] overflow-y-auto",children:[n.jsxs("div",{className:"px-6 py-4 border-b border-neutral-200 flex items-center justify-between sticky top-0 bg-white z-10",children:[n.jsx("h3",{className:"text-lg font-medium text-neutral-900",children:se?"编辑人员信息":"新增人员信息"}),n.jsx("button",{onClick:()=>se?y(!1):v(!1),className:"text-neutral-400 hover:text-neutral-600 transition-colors",children:n.jsx(Ze,{className:"w-5 h-5"})})]}),n.jsxs("div",{className:"p-6 space-y-6",children:[n.jsxs("div",{className:"border-b border-neutral-200 pb-4",children:[n.jsx("h4",{className:"text-sm font-semibold text-neutral-900 mb-3",children:"基本信息"}),n.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:["姓名 ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:S.name,onChange:Ce=>P({...S,name:Ce.target.value}),placeholder:"请输入姓名",className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:["性别 ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsxs("select",{value:S.gender,onChange:Ce=>P({...S,gender:Ce.target.value}),className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[n.jsx("option",{value:"男",children:"男"}),n.jsx("option",{value:"女",children:"女"})]})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:["身份证号 ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:S.idNumber,onChange:Ce=>P({...S,idNumber:Ce.target.value}),placeholder:"请输入身份证号",maxLength:18,className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:["联系电话 ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"tel",value:S.phone,onChange:Ce=>P({...S,phone:Ce.target.value}),placeholder:"请输入联系电话",className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:["状态 ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsxs("select",{value:S.status,onChange:Ce=>P({...S,status:Ce.target.value}),className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[n.jsx("option",{value:"active",children:"可用"}),n.jsx("option",{value:"resigned",children:"不可用"})]})]}),n.jsx("div",{className:"col-span-3 flex gap-6",children:n.jsxs("label",{className:"flex items-center space-x-2",children:[n.jsx("input",{type:"checkbox",checked:S.isLegalPerson,onChange:Ce=>P({...S,isLegalPerson:Ce.target.checked}),className:"w-4 h-4 text-primary-600 border-neutral-300 rounded focus:ring-primary-500"}),n.jsx("span",{className:"text-sm font-medium text-neutral-700",children:"是否法人"})]})})]})]}),n.jsxs("div",{className:"border-b border-neutral-200 pb-4",children:[n.jsx("h4",{className:"text-sm font-semibold text-neutral-900 mb-3",children:"身份证件"}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:["身份证人像面 ",n.jsx("span",{className:"text-red-500",children:"*"})]}),S.idCardFront?n.jsxs("div",{className:"relative",children:[n.jsx("img",{src:S.idCardFront.url,alt:"身份证人像面",className:"w-full h-48 object-cover rounded-lg border border-neutral-200"}),n.jsx("button",{onClick:()=>W("front"),className:"absolute top-2 right-2 bg-red-600 text-white p-1.5 rounded-full hover:bg-red-700 transition-colors shadow-lg",children:n.jsx(qe,{className:"w-4 h-4"})}),n.jsx("div",{className:"mt-2 text-xs text-neutral-600 truncate",children:S.idCardFront.name})]}):n.jsxs("div",{className:"border-2 border-dashed border-neutral-300 rounded-lg p-4 text-center hover:border-primary-500 transition-colors cursor-pointer",onClick:()=>xe("front"),children:[n.jsx(wt,{className:"w-6 h-6 mx-auto text-neutral-400 mb-1"}),n.jsx("p",{className:"text-xs text-neutral-600",children:"点击上传"}),n.jsx("p",{className:"text-xs text-neutral-500 mt-0.5",children:"支持JPG、PNG、JPEG格式"})]})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:["身份证国徽面 ",n.jsx("span",{className:"text-red-500",children:"*"})]}),S.idCardBack?n.jsxs("div",{className:"relative",children:[n.jsx("img",{src:S.idCardBack.url,alt:"身份证国徽面",className:"w-full h-48 object-cover rounded-lg border border-neutral-200"}),n.jsx("button",{onClick:()=>W("back"),className:"absolute top-2 right-2 bg-red-600 text-white p-1.5 rounded-full hover:bg-red-700 transition-colors shadow-lg",children:n.jsx(qe,{className:"w-4 h-4"})}),n.jsx("div",{className:"mt-2 text-xs text-neutral-600 truncate",children:S.idCardBack.name})]}):n.jsxs("div",{className:"border-2 border-dashed border-neutral-300 rounded-lg p-4 text-center hover:border-primary-500 transition-colors cursor-pointer",onClick:()=>xe("back"),children:[n.jsx(wt,{className:"w-6 h-6 mx-auto text-neutral-400 mb-1"}),n.jsx("p",{className:"text-xs text-neutral-600",children:"点击上传"}),n.jsx("p",{className:"text-xs text-neutral-500 mt-0.5",children:"支持JPG、PNG、JPEG格式"})]})]})]})]}),n.jsxs("div",{className:"border-b border-neutral-200 pb-4",children:[n.jsxs("div",{className:"flex items-center justify-between mb-3",children:[n.jsx("h4",{className:"text-sm font-semibold text-neutral-900",children:"毕业证书"}),n.jsxs("button",{onClick:E,className:"px-3 py-1.5 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors flex items-center",children:[n.jsx(Ct,{className:"w-4 h-4 mr-1"}),"添加证书"]})]}),S.certificates.length>0?n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"w-full border border-neutral-200 rounded-lg",children:[n.jsx("thead",{className:"bg-neutral-50",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600 border-b",children:"序号"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600 border-b",children:"证书名称"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600 border-b",children:"证书编号"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600 border-b",children:"颁发机构"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600 border-b",children:"操作"})]})}),n.jsx("tbody",{children:S.certificates.map((Ce,Je)=>n.jsxs("tr",{className:"hover:bg-neutral-50",children:[n.jsx("td",{className:"px-4 py-2.5 text-sm text-neutral-900",children:Je+1}),n.jsx("td",{className:"px-4 py-2.5 text-sm text-neutral-900",children:Ce.name}),n.jsx("td",{className:"px-4 py-2.5 text-sm text-neutral-900",children:Ce.certNumber}),n.jsx("td",{className:"px-4 py-2.5 text-sm text-neutral-900",children:Ce.issuingOrganization}),n.jsx("td",{className:"px-4 py-2.5 text-sm",children:n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("button",{onClick:()=>ke(Ce),className:"text-primary-600 hover:text-primary-800",children:n.jsx(Et,{className:"w-4 h-4"})}),n.jsx("button",{onClick:()=>pe(Ce.id),className:"text-red-600 hover:text-red-800",children:n.jsx(qe,{className:"w-4 h-4"})})]})})]},Ce.id))})]})}):n.jsx("div",{className:"text-center py-8 text-neutral-500 border border-dashed border-neutral-300 rounded-lg",children:"暂无毕业证书"})]}),n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center justify-between mb-3",children:[n.jsx("h4",{className:"text-sm font-semibold text-neutral-900",children:"资质证书"}),n.jsxs("button",{onClick:Ie,className:"px-3 py-1.5 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors flex items-center",children:[n.jsx(Ct,{className:"w-4 h-4 mr-1"}),"添加资质"]})]}),S.qualifications.length>0?n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"w-full border border-neutral-200 rounded-lg",children:[n.jsx("thead",{className:"bg-neutral-50",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600 border-b",children:"序号"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600 border-b",children:"证书名称"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600 border-b",children:"证书编号"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600 border-b",children:"颁发机构"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600 border-b",children:"操作"})]})}),n.jsx("tbody",{children:S.qualifications.map((Ce,Je)=>n.jsxs("tr",{className:"hover:bg-neutral-50",children:[n.jsx("td",{className:"px-4 py-2.5 text-sm text-neutral-900",children:Je+1}),n.jsx("td",{className:"px-4 py-2.5 text-sm text-neutral-900",children:Ce.name}),n.jsx("td",{className:"px-4 py-2.5 text-sm text-neutral-900",children:Ce.certNumber}),n.jsx("td",{className:"px-4 py-2.5 text-sm text-neutral-900",children:Ce.issuingOrganization}),n.jsx("td",{className:"px-4 py-2.5 text-sm",children:n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("button",{onClick:()=>Re(Ce),className:"text-primary-600 hover:text-primary-800",children:n.jsx(Et,{className:"w-4 h-4"})}),n.jsx("button",{onClick:()=>Me(Ce.id),className:"text-red-600 hover:text-red-800",children:n.jsx(qe,{className:"w-4 h-4"})})]})})]},Ce.id))})]})}):n.jsx("div",{className:"text-center py-8 text-neutral-500 border border-dashed border-neutral-300 rounded-lg",children:"暂无资质证书"})]})]}),n.jsxs("div",{className:"px-6 py-4 bg-neutral-50 flex justify-end gap-2 rounded-b-lg sticky bottom-0",children:[n.jsx("button",{onClick:()=>se?y(!1):v(!1),className:"px-4 py-2 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-100 transition-colors",children:"取消"}),n.jsx("button",{onClick:se?ue:ne,className:"px-4 py-2 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors",children:se?"保存":"确定"})]})]})}):null;return n.jsxs("div",{className:"flex flex-col h-full",children:[t&&n.jsx("div",{className:"px-6 py-3 bg-yellow-50 border-b border-yellow-200",children:n.jsxs("p",{className:"text-sm text-yellow-800",children:[n.jsx(Hn,{className:"w-4 h-4 inline mr-2"}),"只读模式 - 无法编辑此信息"]})}),n.jsx("div",{className:"flex-1 overflow-auto",children:n.jsxs("div",{className:"bg-white rounded-lg border border-neutral-200",children:[n.jsxs("div",{className:"px-6 py-4 border-b border-neutral-200",children:[n.jsx("div",{className:"flex items-center justify-between mb-4",children:n.jsx("h2",{className:"text-lg font-medium text-neutral-900",children:"人员信息"})}),n.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4",children:n.jsx("p",{className:"text-sm text-blue-700",children:"该模块用于管理企业的人员信息，包括员工的基本信息、职称资质、学历证书等。人员信息将用于生成投标文件中的项目团队介绍、人员配备表等内容，并在投标时自动匹配项目对人员的要求。请保持人员信息的准确和完整。"})}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex items-center gap-3 flex-wrap",children:["姓名",n.jsx("input",{type:"text",placeholder:"请输入姓名",value:s,onChange:se=>i(se.target.value),className:"w-40 px-3 py-1.5 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500"}),"状态",n.jsxs("select",{value:l,onChange:se=>c(se.target.value),className:"px-3 py-1.5 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500",children:[n.jsx("option",{value:"all",children:"全部"}),n.jsx("option",{value:"active",children:"可用"}),n.jsx("option",{value:"resigned",children:"不可用"})]}),"是否法人",n.jsxs("select",{value:o,onChange:se=>u(se.target.value),className:"px-3 py-1.5 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500",children:[n.jsx("option",{value:"all",children:"全部"}),n.jsx("option",{value:"yes",children:"是"}),n.jsx("option",{value:"no",children:"否"})]})]}),n.jsxs("div",{className:"flex justify-end gap-2",children:[n.jsx("button",{onClick:O,className:"px-4 py-1.5 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-50 transition-colors",children:"重置"}),n.jsx("button",{onClick:I,className:"px-4 py-1.5 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors",children:"查询"})]})]})]}),!t&&n.jsx("div",{className:"px-6 py-3 border-b border-neutral-200",children:n.jsxs("button",{onClick:g,className:"px-4 py-1.5 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors flex items-center",children:[n.jsx(Ct,{className:"w-4 h-4 mr-1"}),"新增人员"]})}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"w-full",children:[n.jsx("thead",{className:"bg-neutral-50 border-b border-neutral-200",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"序号"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"姓名"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"性别"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"联系电话"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"是否法人"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"人员状态"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"证书数量"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"证书状态"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"操作"})]})}),n.jsx("tbody",{className:"divide-y divide-neutral-200",children:nt().length===0?n.jsx("tr",{children:n.jsx("td",{colSpan:9,className:"px-4 py-8 text-center text-neutral-500",children:"暂无数据"})}):nt().map((se,Ce)=>{const Je=he();return n.jsxs("tr",{className:"hover:bg-neutral-50 transition-colors",children:[n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm text-neutral-900",children:(d-1)*x+Ce+1}),n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm text-neutral-900",children:se.name}),n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm text-neutral-900",children:se.gender}),n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm text-neutral-900",children:se.phone}),n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm text-neutral-900",children:se.isLegalPerson?"是":"否"}),n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm",children:n.jsx("span",{className:`inline-flex px-2 py-0.5 rounded-full text-xs font-medium ${ae(se.status)}`,children:H(se.status)})}),n.jsxs("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm text-neutral-900",children:[se.certificates.length+se.qualifications.length," 份"]}),n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm",children:n.jsx("span",{className:Je.color,children:Je.status})}),n.jsxs("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm",children:[!t&&n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsxs("button",{onClick:()=>_(se),className:"px-2 py-1 text-xs text-primary-600 hover:text-primary-800 hover:bg-primary-50 rounded transition-colors flex items-center gap-1",children:[n.jsx(Et,{className:"w-3.5 h-3.5"}),"编辑"]}),n.jsxs("button",{onClick:()=>A(se),className:"px-2 py-1 text-xs text-red-600 hover:text-red-800 hover:bg-red-50 rounded transition-colors flex items-center gap-1",children:[n.jsx(qe,{className:"w-3.5 h-3.5"}),"删除"]})]}),t&&n.jsx("span",{className:"text-xs text-neutral-400",children:"只读"})]})]},se.id)})})]})}),n.jsxs("div",{className:"bg-white border-t border-neutral-200 px-6 py-3 flex items-center justify-center gap-6",children:[n.jsxs("div",{className:"text-sm text-neutral-700",children:["共 ",ze.length," 条"]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("button",{onClick:()=>f(Math.max(1,d-1)),disabled:d===1,className:`px-2 py-1 text-sm rounded transition-colors ${d===1?"bg-neutral-100 text-neutral-400 cursor-not-allowed":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:"<"}),n.jsx("div",{className:"flex items-center space-x-1",children:Array.from({length:Math.min(10,Qe)},(se,Ce)=>{let Je;return Qe<=10||d<=5?Je=Ce+1:d>=Qe-4?Je=Qe-9+Ce:Je=d-4+Ce,n.jsx("button",{onClick:()=>f(Je),className:`px-2.5 py-1 text-sm rounded transition-colors ${d===Je?"bg-primary-600 text-white":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:Je},Je)})}),Qe>10&&n.jsxs(n.Fragment,{children:[n.jsx("span",{className:"text-neutral-500",children:"..."}),n.jsx("button",{onClick:()=>f(Qe),className:`px-2.5 py-1 text-sm rounded transition-colors ${d===Qe?"bg-primary-600 text-white":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:Qe})]}),n.jsx("button",{onClick:()=>f(Math.min(Qe,d+1)),disabled:d===Qe,className:`px-2 py-1 text-sm rounded transition-colors ${d===Qe?"bg-neutral-100 text-neutral-400 cursor-not-allowed":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:">"})]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsxs("select",{value:x,onChange:se=>Dt(Number(se.target.value)),className:"px-2 py-1 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500",children:[n.jsx("option",{value:10,children:"10条/页"}),n.jsx("option",{value:20,children:"20条/页"}),n.jsx("option",{value:50,children:"50条/页"})]}),n.jsx("span",{className:"text-sm text-neutral-700",children:"前往"}),n.jsx("input",{type:"number",value:p,onChange:se=>m(se.target.value),placeholder:"页",className:"w-12 px-2 py-1 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500",min:1,max:Qe}),n.jsx("button",{onClick:Xe,className:"px-3 py-1 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-50 transition-colors",children:"页"})]})]})]})}),w&&at(!1),b&&at(!0),N&&j&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4",children:[n.jsx("div",{className:"px-6 py-4 border-b border-neutral-200",children:n.jsx("h3",{className:"text-lg font-medium text-neutral-900",children:"确认删除"})}),n.jsx("div",{className:"p-6",children:n.jsxs("p",{className:"text-neutral-600",children:["确定要删除人员 ",n.jsxs("span",{className:"font-medium",children:['"',j.name,'"']})," 吗？此操作不可恢复。"]})}),n.jsxs("div",{className:"px-6 py-4 bg-neutral-50 flex justify-end gap-2 rounded-b-lg",children:[n.jsx("button",{onClick:()=>F(!1),className:"px-4 py-2 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-100 transition-colors",children:"取消"}),n.jsx("button",{onClick:ve,className:"px-4 py-2 text-sm bg-red-600 text-white rounded hover:bg-red-700 transition-colors",children:"删除"})]})]})}),D&&C&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[n.jsxs("div",{className:"px-6 py-4 border-b border-neutral-200 flex items-center justify-between sticky top-0 bg-white z-10",children:[n.jsx("h3",{className:"text-lg font-medium text-neutral-900",children:C.id?"编辑毕业证书":"新增毕业证书"}),n.jsx("button",{onClick:()=>{K(!1),Y(null)},className:"text-neutral-400 hover:text-neutral-600 transition-colors",children:n.jsx(Ze,{className:"w-5 h-5"})})]}),n.jsxs("div",{className:"p-6 space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:["证书名称 ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:C.name,onChange:se=>Ne("name",se.target.value),placeholder:"如：本科毕业证书",className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:["证书编号 ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:C.certNumber,onChange:se=>Ne("certNumber",se.target.value),placeholder:"请输入证书编号",className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:["颁发机构 ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:C.issuingOrganization,onChange:se=>Ne("issuingOrganization",se.target.value),placeholder:"如：某某大学",className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:["颁发日期 ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"date",value:C.issueDate,onChange:se=>Ne("issueDate",se.target.value),className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:"有效期至（永久有效可留空）"}),n.jsx("input",{type:"date",value:C.validUntil,onChange:se=>Ne("validUntil",se.target.value),className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:"证书附件"}),n.jsxs("div",{className:"border-2 border-dashed border-neutral-300 rounded-lg p-4 text-center hover:border-primary-500 transition-colors cursor-pointer mb-3",onClick:me,children:[n.jsx(wt,{className:"w-6 h-6 mx-auto text-neutral-400 mb-1"}),n.jsx("p",{className:"text-sm text-neutral-600",children:"点击上传（支持多选）"}),n.jsx("p",{className:"text-xs text-neutral-500 mt-1",children:"仅支持JPG、PNG、JPEG格式"})]}),C.attachments.length>0&&n.jsx("div",{className:"grid grid-cols-2 gap-3",children:C.attachments.map((se,Ce)=>n.jsxs("div",{className:"relative",children:[n.jsx("img",{src:se.url,alt:se.name,className:"w-full h-32 object-cover rounded-lg border border-neutral-200"}),n.jsx("button",{onClick:()=>oe(Ce),className:"absolute top-2 right-2 bg-red-600 text-white p-1 rounded-full hover:bg-red-700 transition-colors shadow-lg",children:n.jsx(qe,{className:"w-3.5 h-3.5"})}),n.jsx("div",{className:"mt-1 text-xs text-neutral-600 truncate px-1",children:se.name})]},Ce))})]})]}),n.jsxs("div",{className:"px-6 py-4 bg-neutral-50 flex justify-end gap-2 rounded-b-lg sticky bottom-0",children:[n.jsx("button",{onClick:()=>{K(!1),Y(null)},className:"px-4 py-2 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-100 transition-colors",children:"取消"}),n.jsx("button",{onClick:Ue,className:"px-4 py-2 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors",children:"保存"})]})]})}),B&&re&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[n.jsxs("div",{className:"px-6 py-4 border-b border-neutral-200 flex items-center justify-between sticky top-0 bg-white z-10",children:[n.jsx("h3",{className:"text-lg font-medium text-neutral-900",children:re.id?"编辑资质证书":"新增资质证书"}),n.jsx("button",{onClick:()=>{ee(!1),Q(null)},className:"text-neutral-400 hover:text-neutral-600 transition-colors",children:n.jsx(Ze,{className:"w-5 h-5"})})]}),n.jsxs("div",{className:"p-6 space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:["证书名称 ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:re.name,onChange:se=>He("name",se.target.value),placeholder:"如：一级建造师",className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:["证书编号 ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:re.certNumber,onChange:se=>He("certNumber",se.target.value),placeholder:"请输入证书编号",className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:["颁发机构 ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:re.issuingOrganization,onChange:se=>He("issuingOrganization",se.target.value),placeholder:"如：中国建设教育协会",className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:["颁发日期 ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"date",value:re.issueDate,onChange:se=>He("issueDate",se.target.value),className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:["有效期至 ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"date",value:re.validUntil,onChange:se=>He("validUntil",se.target.value),className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:"证书附件"}),n.jsxs("div",{className:"border-2 border-dashed border-neutral-300 rounded-lg p-4 text-center hover:border-primary-500 transition-colors cursor-pointer mb-3",onClick:Z,children:[n.jsx(wt,{className:"w-6 h-6 mx-auto text-neutral-400 mb-1"}),n.jsx("p",{className:"text-sm text-neutral-600",children:"点击上传（支持多选）"}),n.jsx("p",{className:"text-xs text-neutral-500 mt-1",children:"仅支持JPG、PNG、JPEG格式"})]}),re.attachments.length>0&&n.jsx("div",{className:"grid grid-cols-2 gap-3",children:re.attachments.map((se,Ce)=>n.jsxs("div",{className:"relative",children:[n.jsx("img",{src:se.url,alt:se.name,className:"w-full h-32 object-cover rounded-lg border border-neutral-200"}),n.jsx("button",{onClick:()=>Be(Ce),className:"absolute top-2 right-2 bg-red-600 text-white p-1 rounded-full hover:bg-red-700 transition-colors shadow-lg",children:n.jsx(qe,{className:"w-3.5 h-3.5"})}),n.jsx("div",{className:"mt-1 text-xs text-neutral-600 truncate px-1",children:se.name})]},Ce))})]})]}),n.jsxs("div",{className:"px-6 py-4 bg-neutral-50 flex justify-end gap-2 rounded-b-lg sticky bottom-0",children:[n.jsx("button",{onClick:()=>{ee(!1),Q(null)},className:"px-4 py-2 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-100 transition-colors",children:"取消"}),n.jsx("button",{onClick:Oe,className:"px-4 py-2 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors",children:"保存"})]})]})})]})},UE=50*1024*1024,zE=({companyId:e,readOnly:t=!1})=>{var He;const[r,a]=M.useState("productionEquipment"),[s,i]=M.useState(()=>{const Z=localStorage.getItem(`product_info_${e}`);return Z?JSON.parse(Z):{productionEquipment:[],testingEquipment:[],companyProducts:[]}}),[l,c]=M.useState(()=>{const Z=localStorage.getItem(`product_categories_${e}`);return Z?JSON.parse(Z):{productionEquipment:[],testingEquipment:[],companyProducts:[]}}),[o,u]=M.useState(""),[d,f]=M.useState(""),[x,h]=M.useState(""),[p,m]=M.useState("all"),[w,v]=M.useState(1),[b,y]=M.useState(10),[N,F]=M.useState(""),[j,k]=M.useState(!1),[S,P]=M.useState(null),[D,K]=M.useState(!1),[C,Y]=M.useState(null),[B,ee]=M.useState(!1),[re,Q]=M.useState(null),[te,H]=M.useState(!1);M.useEffect(()=>{localStorage.setItem(`product_info_${e}`,JSON.stringify(s))},[s,e]),M.useEffect(()=>{localStorage.setItem(`product_categories_${e}`,JSON.stringify(l))},[l,e]);const ae=()=>{P({id:"",categoryId:"",name:"",brand:"",specification:"",model:"",description:"",source:"own",attachments:[]}),k(!0)},he=Z=>{P({...Z}),k(!0)},O=()=>{if(!S)return;if(!S.name.trim()){alert("请输入产品名称");return}if(!S.categoryId){alert("请选择产品分类");return}const Z=[...s[r]];if(S.id){const Be=Z.findIndex(ze=>ze.id===S.id);Be!==-1&&(Z[Be]=S)}else Z.push({...S,id:Date.now().toString(),createdAt:new Date().toISOString()});i({...s,[r]:Z}),k(!1),P(null)},I=Z=>{confirm("确定要删除此产品吗？删除后将无法恢复。")&&i({...s,[r]:s[r].filter(Be=>Be.id!==Z)})},g=Z=>{Q({id:"",name:"",description:"",parentId:Z}),ee(!0)},_=Z=>{Q({...Z}),ee(!0)},A=()=>{if(!re)return;if(!re.name.trim()){alert("请输入分类名称");return}const Z=[...l[r]];if(re.id){const Be=Z.findIndex(ze=>ze.id===re.id);Be!==-1&&(Z[Be]=re)}else Z.push({...re,id:Date.now().toString()});c({...l,[r]:Z}),ee(!1),Q(null)},ne=Z=>{if(s[r].some(ze=>ze.categoryId===Z)){alert("该分类下存在产品，无法删除");return}confirm("确定要删除此分类吗？")&&c({...l,[r]:l[r].filter(ze=>ze.id!==Z)})},ue=()=>{Y({id:"",name:"",description:"",files:[]}),K(!0)},ve=Z=>{Y({...Z}),K(!0)},xe=()=>{if(!C||!S)return;if(!C.name.trim()){alert("请输入附件名称");return}const Z=[...S.attachments];if(C.id){const Be=Z.findIndex(ze=>ze.id===C.id);Be!==-1&&(Z[Be]=C)}else Z.push({...C,id:Date.now().toString()});P({...S,attachments:Z}),K(!1),Y(null)},W=Z=>{S&&confirm("确定要删除此附件吗？")&&P({...S,attachments:S.attachments.filter(Be=>Be.id!==Z)})},E=async()=>{const Z=document.createElement("input");Z.type="file",Z.accept="image/jpeg,image/png,image/jpg,application/pdf",Z.multiple=!0,Z.onchange=async Be=>{const nt=Be.target.files;if(nt&&C){const Dt=Array.from(nt).filter(at=>at.size>UE?(alert(`文件 "${at.name}" 超过50MB限制，无法上传`),!1):!0).map(at=>new Promise(se=>{const Ce=new FileReader;Ce.onload=Je=>{var Bt;se({url:(Bt=Je.target)==null?void 0:Bt.result,name:at.name,size:at.size})},Ce.readAsDataURL(at)})),Xe=await Promise.all(Dt);Y({...C,files:[...C.files,...Xe]})}},Z.click()},ke=Z=>{C&&Y({...C,files:C.files.filter((Be,ze)=>ze!==Z)})},pe=()=>s[r].filter(Z=>{const Be=!o||Z.name.toLowerCase().includes(o.toLowerCase()),ze=!d||Z.brand.toLowerCase().includes(d.toLowerCase()),nt=!x||Z.model.toLowerCase().includes(x.toLowerCase()),Qe=p==="all"||Z.categoryId===p;return Be&&ze&&nt&&Qe}).sort((Z,Be)=>{const ze=Z.createdAt?new Date(Z.createdAt).getTime():0;return(Be.createdAt?new Date(Be.createdAt).getTime():0)-ze}),Ue=()=>{const Z=pe(),Be=(w-1)*b,ze=Be+b;return Z.slice(Be,ze)},Ne=Math.ceil(pe().length/b),me=()=>{u(""),f(""),h(""),m("all"),v(1)},oe=()=>{v(1)},Ie=Z=>{y(Z),v(1)},Re=()=>{const Z=parseInt(N);Z>=1&&Z<=Ne&&(v(Z),F(""))},Me=Z=>{const Be=l[r].find(ze=>ze.id===Z);if(!Be)return"-";if(Be.parentId){const ze=l[r].find(nt=>nt.id===Be.parentId);return ze?`${Be.name} (${ze.name})`:Be.name}return Be.name},Oe={productionEquipment:"生产设备",testingEquipment:"检测设备",companyProducts:"企业产品"};return n.jsxs("div",{className:"flex h-full",children:[n.jsxs("div",{className:"flex-1 flex flex-col min-w-0",children:[t&&n.jsx("div",{className:"px-6 py-3 bg-yellow-50 border-b border-yellow-200 rounded-lg mb-4",children:n.jsxs("p",{className:"text-sm text-yellow-800",children:[n.jsx(Hn,{className:"w-4 h-4 inline mr-2"}),"只读模式 - 无法编辑此信息"]})}),n.jsx("div",{className:"flex-1 overflow-auto",children:n.jsxs("div",{className:"bg-white rounded-lg border border-neutral-200",children:[n.jsxs("div",{className:"px-6 py-4 border-b border-neutral-200",children:[n.jsx("div",{className:"flex items-center justify-between mb-4",children:n.jsx("h2",{className:"text-lg font-medium text-neutral-900",children:"产品信息"})}),n.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4",children:n.jsx("p",{className:"text-sm text-blue-700",children:"该模块用于管理企业的产品信息，包括生产设备、检测设备和企业产品三大类别。产品信息将用于生成投标文件中的产品介绍、设备清单等内容。其中，企业产品可以标注产品来源（自有产品或代理产品）。请详细填写产品信息和相关附件。"})}),n.jsx("div",{className:"flex space-x-2 mb-4",children:Object.keys(Oe).map(Z=>n.jsx("button",{onClick:()=>{a(Z),v(1),me()},className:`px-4 py-2 text-sm font-medium transition-colors rounded ${r===Z?"bg-primary-600 text-white":"bg-neutral-100 text-neutral-600 hover:bg-neutral-200"}`,children:Oe[Z]},Z))}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex items-center gap-3 flex-wrap",children:["产品名称",n.jsx("input",{type:"text",placeholder:"请输入产品名称",value:o,onChange:Z=>u(Z.target.value),className:"w-40 px-3 py-1.5 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500"}),"产品品牌",n.jsx("input",{type:"text",placeholder:"请输入产品品牌",value:d,onChange:Z=>f(Z.target.value),className:"w-40 px-3 py-1.5 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500"}),"产品型号",n.jsx("input",{type:"text",placeholder:"请输入产品型号",value:x,onChange:Z=>h(Z.target.value),className:"w-40 px-3 py-1.5 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500"}),"产品分类",n.jsxs("select",{value:p,onChange:Z=>m(Z.target.value),className:"px-3 py-1.5 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500",children:[n.jsx("option",{value:"all",children:"全部"}),l[r].filter(Z=>!Z.parentId).map(Z=>{const Be=l[r].filter(ze=>ze.parentId===Z.id);return n.jsxs(mr.Fragment,{children:[n.jsx("option",{value:Z.id,children:Z.name}),Be.map(ze=>n.jsxs("option",{value:ze.id,children:["└─ ",ze.name," (父级: ",Z.name,")"]},ze.id))]},Z.id)})]})]}),n.jsxs("div",{className:"flex justify-end gap-2",children:[n.jsx("button",{onClick:me,className:"px-4 py-1.5 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-50 transition-colors",children:"重置"}),n.jsx("button",{onClick:oe,className:"px-4 py-1.5 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors",children:"查询"})]})]})]}),!t&&n.jsxs("div",{className:"px-6 py-3 border-b border-neutral-200 flex items-center gap-2",children:[n.jsxs("button",{onClick:ae,className:"px-4 py-1.5 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors flex items-center",children:[n.jsx(Ct,{className:"w-4 h-4 mr-1"}),"新增",Oe[r]]}),n.jsxs("button",{onClick:()=>H(!0),className:"px-4 py-1.5 text-sm bg-green-600 text-white rounded hover:bg-green-700 transition-colors flex items-center",children:[n.jsx(Vu,{className:"w-4 h-4 mr-1"}),"产品分类管理"]})]}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"w-full",children:[n.jsx("thead",{className:"bg-neutral-50 border-b border-neutral-200",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"序号"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"产品分类"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"产品名称"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"产品品牌"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"产品型号"}),r==="companyProducts"&&n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"产品来源"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"相关附件"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"操作"})]})}),n.jsx("tbody",{className:"divide-y divide-neutral-200",children:Ue().length===0?n.jsx("tr",{children:n.jsx("td",{colSpan:r==="companyProducts"?8:7,className:"px-4 py-8 text-center text-neutral-500",children:"暂无数据"})}):Ue().map((Z,Be)=>n.jsxs("tr",{className:"hover:bg-neutral-50",children:[n.jsx("td",{className:"px-4 py-3 text-sm text-neutral-900",children:(w-1)*b+Be+1}),n.jsx("td",{className:"px-4 py-3 text-sm text-neutral-600",children:Me(Z.categoryId)}),n.jsx("td",{className:"px-4 py-3 text-sm text-neutral-900",children:Z.name}),n.jsx("td",{className:"px-4 py-3 text-sm text-neutral-600",children:Z.brand||"-"}),n.jsx("td",{className:"px-4 py-3 text-sm text-neutral-600",children:Z.model||"-"}),r==="companyProducts"&&n.jsx("td",{className:"px-4 py-3 text-sm text-neutral-600",children:n.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded text-xs font-medium ${Z.source==="own"?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"}`,children:Z.source==="own"?"自有产品":"代理产品"})}),n.jsxs("td",{className:"px-4 py-3 text-sm text-neutral-600",children:[Z.attachments.length,"个"]}),n.jsx("td",{className:"px-4 py-3 text-sm",children:n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("button",{onClick:()=>he(Z),className:"text-primary-600 hover:text-primary-800",title:"编辑",children:n.jsx(Et,{className:"w-4 h-4"})}),!t&&n.jsx("button",{onClick:()=>I(Z.id),className:"text-red-600 hover:text-red-800",title:"删除",children:n.jsx(qe,{className:"w-4 h-4"})})]})})]},Z.id))})]})}),n.jsxs("div",{className:"bg-white border-t border-neutral-200 px-6 py-3 flex items-center justify-center gap-6",children:[n.jsxs("div",{className:"text-sm text-neutral-700",children:["共 ",pe().length," 条"]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("button",{onClick:()=>v(Math.max(1,w-1)),disabled:w===1,className:`px-2 py-1 text-sm rounded transition-colors ${w===1?"bg-neutral-100 text-neutral-400 cursor-not-allowed":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:"<"}),n.jsx("div",{className:"flex items-center space-x-1",children:Array.from({length:Math.min(10,Ne)},(Z,Be)=>{let ze;return Ne<=10||w<=5?ze=Be+1:w>=Ne-4?ze=Ne-9+Be:ze=w-4+Be,n.jsx("button",{onClick:()=>v(ze),className:`px-2.5 py-1 text-sm rounded transition-colors ${w===ze?"bg-primary-600 text-white":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:ze},ze)})}),Ne>10&&n.jsxs(n.Fragment,{children:[n.jsx("span",{className:"text-neutral-500",children:"..."}),n.jsx("button",{onClick:()=>v(Ne),className:`px-2.5 py-1 text-sm rounded transition-colors ${w===Ne?"bg-primary-600 text-white":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:Ne})]}),n.jsx("button",{onClick:()=>v(Math.min(Ne,w+1)),disabled:w===Ne,className:`px-2 py-1 text-sm rounded transition-colors ${w===Ne?"bg-neutral-100 text-neutral-400 cursor-not-allowed":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:">"})]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsxs("select",{value:b,onChange:Z=>Ie(Number(Z.target.value)),className:"px-2 py-1 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500",children:[n.jsx("option",{value:5,children:"5条/页"}),n.jsx("option",{value:10,children:"10条/页"}),n.jsx("option",{value:20,children:"20条/页"}),n.jsx("option",{value:50,children:"50条/页"})]}),n.jsx("span",{className:"text-sm text-neutral-700",children:"前往"}),n.jsx("input",{type:"number",value:N,onChange:Z=>F(Z.target.value),placeholder:"页",className:"w-12 px-2 py-1 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500",min:1,max:Ne}),n.jsx("button",{onClick:Re,className:"px-3 py-1 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-50 transition-colors",children:"页"})]})]})]})})]}),te&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[n.jsxs("div",{className:"sticky top-0 bg-white border-b border-neutral-200 px-6 py-4 flex items-center justify-between z-10",children:[n.jsx("h3",{className:"text-lg font-semibold text-neutral-900",children:"产品分类管理"}),n.jsx("button",{onClick:()=>H(!1),className:"text-neutral-400 hover:text-neutral-600",children:n.jsx(Ze,{className:"w-6 h-6"})})]}),n.jsxs("div",{className:"p-6",children:[n.jsx("div",{className:"mb-4",children:n.jsxs("button",{onClick:()=>g(),className:"px-4 py-2 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors flex items-center",children:[n.jsx(Ct,{className:"w-4 h-4 mr-1"}),"新增分类"]})}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"w-full",children:[n.jsx("thead",{className:"bg-neutral-50 border-b border-neutral-200",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"序号"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"分类名称"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"分类描述"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"操作"})]})}),n.jsx("tbody",{className:"divide-y divide-neutral-200",children:l[r].length===0?n.jsx("tr",{children:n.jsx("td",{colSpan:4,className:"px-4 py-8 text-center text-neutral-500",children:"暂无分类"})}):l[r].filter(Z=>!Z.parentId).map((Z,Be)=>{const ze=l[r].filter(nt=>nt.parentId===Z.id);return n.jsxs(mr.Fragment,{children:[n.jsxs("tr",{className:"hover:bg-neutral-50",children:[n.jsx("td",{className:"px-4 py-3 text-sm text-neutral-900",children:Be+1}),n.jsx("td",{className:"px-4 py-3 text-sm text-neutral-900 font-medium",children:Z.name}),n.jsx("td",{className:"px-4 py-3 text-sm text-neutral-600",children:Z.description||"-"}),n.jsx("td",{className:"px-4 py-3 text-sm",children:n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("button",{onClick:()=>g(Z.id),className:"text-green-600 hover:text-green-800",title:"添加子分类",children:n.jsx(Ct,{className:"w-4 h-4"})}),n.jsx("button",{onClick:()=>_(Z),className:"text-primary-600 hover:text-primary-800",title:"编辑",children:n.jsx(Et,{className:"w-4 h-4"})}),n.jsx("button",{onClick:()=>ne(Z.id),className:"text-red-600 hover:text-red-800",title:"删除",children:n.jsx(qe,{className:"w-4 h-4"})})]})})]}),ze.map((nt,Qe)=>n.jsxs("tr",{className:"hover:bg-neutral-50 bg-neutral-25",children:[n.jsxs("td",{className:"px-4 py-3 text-sm text-neutral-900 pl-8",children:[Be+1,".",Qe+1]}),n.jsxs("td",{className:"px-4 py-3 text-sm text-neutral-700 pl-8",children:["└─ ",nt.name]}),n.jsx("td",{className:"px-4 py-3 text-sm text-neutral-600",children:nt.description||"-"}),n.jsx("td",{className:"px-4 py-3 text-sm",children:n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("button",{onClick:()=>_(nt),className:"text-primary-600 hover:text-primary-800",title:"编辑",children:n.jsx(Et,{className:"w-4 h-4"})}),n.jsx("button",{onClick:()=>ne(nt.id),className:"text-red-600 hover:text-red-800",title:"删除",children:n.jsx(qe,{className:"w-4 h-4"})})]})})]},nt.id))]},Z.id)})})]})})]}),n.jsx("div",{className:"sticky bottom-0 bg-neutral-50 px-6 py-4 border-t border-neutral-200 flex justify-end",children:n.jsx("button",{onClick:()=>H(!1),className:"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors",children:"关闭"})})]})}),j&&S&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[n.jsxs("div",{className:"sticky top-0 bg-white border-b border-neutral-200 px-6 py-4 flex items-center justify-between z-10",children:[n.jsxs("h3",{className:"text-lg font-semibold text-neutral-900",children:[S.id?"编辑":"添加",Oe[r]]}),n.jsx("button",{onClick:()=>{k(!1),P(null)},className:"text-neutral-400 hover:text-neutral-600",children:n.jsx(Ze,{className:"w-6 h-6"})})]}),n.jsxs("div",{className:"p-6 space-y-6",children:[n.jsxs("div",{className:"border-b border-neutral-200 pb-4",children:[n.jsx("h4",{className:"text-sm font-semibold text-neutral-900 mb-3",children:"基本信息"}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:["产品分类 ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsxs("select",{value:S.categoryId,onChange:Z=>P({...S,categoryId:Z.target.value}),className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[n.jsx("option",{value:"",children:"请选择分类"}),l[r].filter(Z=>!Z.parentId).map(Z=>{const Be=l[r].filter(ze=>ze.parentId===Z.id);return n.jsxs(mr.Fragment,{children:[n.jsx("option",{value:Z.id,children:Z.name}),Be.map(ze=>n.jsxs("option",{value:ze.id,children:["└─ ",ze.name," (父级: ",Z.name,")"]},ze.id))]},Z.id)})]})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:["产品名称 ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:S.name,onChange:Z=>P({...S,name:Z.target.value}),placeholder:"请输入产品名称",className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:"产品品牌"}),n.jsx("input",{type:"text",value:S.brand,onChange:Z=>P({...S,brand:Z.target.value}),placeholder:"请输入产品品牌",className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:"产品型号"}),n.jsx("input",{type:"text",value:S.model,onChange:Z=>P({...S,model:Z.target.value}),placeholder:"请输入产品型号",className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),r==="companyProducts"&&n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:["产品来源 ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsxs("select",{value:S.source,onChange:Z=>P({...S,source:Z.target.value}),className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[n.jsx("option",{value:"own",children:"自有产品"}),n.jsx("option",{value:"agency",children:"代理产品"})]})]})]}),n.jsxs("div",{className:"mt-4",children:[n.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:"产品规格"}),n.jsx("textarea",{value:S.description,onChange:Z=>P({...S,description:Z.target.value}),placeholder:"请输入产品规格",rows:4,className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]})]}),n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center justify-between mb-3",children:[n.jsx("h4",{className:"text-sm font-semibold text-neutral-900",children:"相关附件"}),n.jsxs("button",{onClick:ue,className:"px-3 py-1.5 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors flex items-center",children:[n.jsx(Ct,{className:"w-4 h-4 mr-1"}),"新增附件"]})]}),S.attachments.length===0?n.jsx("div",{className:"text-center py-8 text-neutral-500 bg-neutral-50 rounded-lg border border-neutral-200",children:"暂无附件"}):n.jsx("div",{className:"overflow-x-auto border border-neutral-200 rounded-lg",children:n.jsxs("table",{className:"w-full",children:[n.jsx("thead",{className:"bg-neutral-50 border-b border-neutral-200",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"序号"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"附件名称"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"附件描述"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"操作"})]})}),n.jsx("tbody",{className:"divide-y divide-neutral-200",children:S.attachments.map((Z,Be)=>n.jsxs("tr",{className:"hover:bg-neutral-50",children:[n.jsx("td",{className:"px-4 py-3 text-sm text-neutral-900",children:Be+1}),n.jsx("td",{className:"px-4 py-3 text-sm text-neutral-900",children:Z.name}),n.jsx("td",{className:"px-4 py-3 text-sm text-neutral-600",children:Z.description||"-"}),n.jsx("td",{className:"px-4 py-3 text-sm",children:n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("button",{onClick:()=>ve(Z),className:"text-primary-600 hover:text-primary-800",children:n.jsx(Et,{className:"w-4 h-4"})}),n.jsx("button",{onClick:()=>W(Z.id),className:"text-red-600 hover:text-red-800",children:n.jsx(qe,{className:"w-4 h-4"})})]})})]},Z.id))})]})})]})]}),n.jsxs("div",{className:"sticky bottom-0 bg-neutral-50 px-6 py-4 border-t border-neutral-200 flex justify-end space-x-3",children:[n.jsx("button",{onClick:()=>{k(!1),P(null)},className:"px-4 py-2 border border-neutral-300 text-neutral-700 rounded-lg hover:bg-neutral-100 transition-colors",children:"取消"}),n.jsx("button",{onClick:O,className:"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors",children:"保存"})]})]})}),B&&re&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full",children:[n.jsxs("div",{className:"px-6 py-4 border-b border-neutral-200 flex items-center justify-between",children:[n.jsx("h3",{className:"text-lg font-medium text-neutral-900",children:re.id?"编辑分类":"新增分类"}),n.jsx("button",{onClick:()=>{ee(!1),Q(null)},className:"text-neutral-400 hover:text-neutral-600",children:n.jsx(Ze,{className:"w-5 h-5"})})]}),n.jsxs("div",{className:"p-6 space-y-4",children:[re.parentId&&n.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3 text-sm text-blue-800",children:["正在创建子分类，父分类：",(He=l[r].find(Z=>Z.id===re.parentId))==null?void 0:He.name]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:["分类名称 ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:re.name,onChange:Z=>Q({...re,name:Z.target.value}),placeholder:"请输入分类名称",className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:"分类描述"}),n.jsx("textarea",{value:re.description,onChange:Z=>Q({...re,description:Z.target.value}),placeholder:"请输入分类描述",rows:3,className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]})]}),n.jsxs("div",{className:"px-6 py-4 bg-neutral-50 flex justify-end gap-2 rounded-b-lg",children:[n.jsx("button",{onClick:()=>{ee(!1),Q(null)},className:"px-4 py-2 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-100 transition-colors",children:"取消"}),n.jsx("button",{onClick:A,className:"px-4 py-2 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors",children:"保存"})]})]})}),D&&C&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[60] p-4",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[n.jsxs("div",{className:"px-6 py-4 border-b border-neutral-200 flex items-center justify-between sticky top-0 bg-white z-10",children:[n.jsx("h3",{className:"text-lg font-medium text-neutral-900",children:C.id?"编辑附件":"新增附件"}),n.jsx("button",{onClick:()=>{K(!1),Y(null)},className:"text-neutral-400 hover:text-neutral-600",children:n.jsx(Ze,{className:"w-5 h-5"})})]}),n.jsxs("div",{className:"p-6 space-y-4",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:["附件名称 ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:C.name,onChange:Z=>Y({...C,name:Z.target.value}),placeholder:"如：产品检测报告",className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:"附件描述"}),n.jsx("textarea",{value:C.description,onChange:Z=>Y({...C,description:Z.target.value}),placeholder:"请输入附件描述",rows:3,className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:"附件文件"}),n.jsxs("div",{className:"border-2 border-dashed border-neutral-300 rounded-lg p-4 text-center hover:border-primary-500 transition-colors cursor-pointer mb-3",onClick:E,children:[n.jsx(wt,{className:"w-6 h-6 mx-auto text-neutral-400 mb-1"}),n.jsx("p",{className:"text-sm text-neutral-600",children:"点击上传（支持多选）"}),n.jsx("p",{className:"text-xs text-neutral-500 mt-1",children:"仅支持JPG、PNG、JPEG、PDF、WORD格式"})]}),C.files.length>0&&n.jsx("div",{className:"grid grid-cols-2 gap-3",children:C.files.map((Z,Be)=>n.jsxs("div",{className:"relative",children:[n.jsx("img",{src:Z.url,alt:Z.name,className:"w-full h-32 object-cover rounded-lg border border-neutral-200"}),n.jsx("button",{onClick:()=>ke(Be),className:"absolute top-2 right-2 bg-red-600 text-white p-1 rounded-full hover:bg-red-700 transition-colors shadow-lg",children:n.jsx(qe,{className:"w-3.5 h-3.5"})}),n.jsx("div",{className:"mt-1 text-xs text-neutral-600 truncate px-1",children:Z.name})]},Be))})]})]}),n.jsxs("div",{className:"px-6 py-4 bg-neutral-50 flex justify-end gap-2 rounded-b-lg sticky bottom-0",children:[n.jsx("button",{onClick:()=>{K(!1),Y(null)},className:"px-4 py-2 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-100 transition-colors",children:"取消"}),n.jsx("button",{onClick:xe,className:"px-4 py-2 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors",children:"保存"})]})]})})]})},WE=({companyId:e,readOnly:t=!1})=>{const[r,a]=M.useState(()=>{const g=localStorage.getItem(`historical_${e}`);return g?JSON.parse(g):[]});M.useEffect(()=>{localStorage.setItem(`historical_${e}`,JSON.stringify(r))},[r,e]);const[s,i]=M.useState(""),[l,c]=M.useState(1),[o,u]=M.useState(10),[d,f]=M.useState(""),[x,h]=M.useState(!1),[p,m]=M.useState(!1),[w,v]=M.useState(!1),[b,y]=M.useState(null),[N,F]=M.useState(null),j=50*1024*1024,k=g=>{if(g===0)return"0 B";const _=1024,A=["B","KB","MB","GB"],ne=Math.floor(Math.log(g)/Math.log(_));return Math.round(g/Math.pow(_,ne)*100)/100+" "+A[ne]},S=()=>{i(""),c(1)},P=()=>{console.log("Searching:",s)},D=()=>{F({id:"",fileName:"",fileType:"",fileDescription:"",attachments:[]}),h(!0)},K=g=>{F({...g}),m(!0)},C=g=>{y(g),v(!0)},Y=()=>{if(N){const g={...N,id:String(Date.now()),createdAt:new Date().toISOString()};a([...r,g]),h(!1)}},B=()=>{N&&(a(r.map(g=>g.id===N.id?N:g)),m(!1))},ee=()=>{b&&(a(r.filter(g=>g.id!==b.id)),v(!1))},re=g=>{if(N){if(g.size>j){alert(`文件 "${g.name}" 超过50MB限制，无法上传`);return}const _={url:"",name:g.name,size:g.size};F({...N,attachments:[...N.attachments,_]})}},Q=g=>{N&&F({...N,attachments:N.attachments.filter((_,A)=>A!==g)})},te=r.filter(g=>!s||g.fileName.toLowerCase().includes(s.toLowerCase())||g.fileType.toLowerCase().includes(s.toLowerCase())).sort((g,_)=>{const A=g.createdAt?new Date(g.createdAt).getTime():0;return(_.createdAt?new Date(_.createdAt).getTime():0)-A}),H=()=>{const g=(l-1)*o,_=g+o;return te.slice(g,_)},ae=Math.ceil(te.length/o),he=g=>{u(g),c(1)},O=()=>{const g=parseInt(d);g>=1&&g<=ae&&(c(g),f(""))},I=g=>N?n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-3xl w-full max-h-[90vh] overflow-y-auto",children:[n.jsxs("div",{className:"px-6 py-4 border-b border-neutral-200 flex items-center justify-between sticky top-0 bg-white z-10",children:[n.jsx("h3",{className:"text-lg font-medium text-neutral-900",children:g?"编辑历史投标文件":"上传历史投标文件"}),n.jsx("button",{onClick:()=>g?m(!1):h(!1),className:"text-neutral-400 hover:text-neutral-600 transition-colors",children:n.jsx(Ze,{className:"w-5 h-5"})})]}),n.jsxs("div",{className:"p-6 space-y-4",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:["文件名称 ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:N.fileName,onChange:_=>F({...N,fileName:_.target.value}),placeholder:"请输入文件名称",className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:["文件类型 ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:N.fileType,onChange:_=>F({...N,fileType:_.target.value}),placeholder:"请输入文件类型",className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:"文件描述"}),n.jsx("textarea",{value:N.fileDescription,onChange:_=>F({...N,fileDescription:_.target.value}),placeholder:"请输入文件描述",rows:4,className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:["附件 ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsxs("div",{className:"border-2 border-dashed border-neutral-300 rounded-lg p-6 text-center hover:border-primary-500 transition-colors cursor-pointer",onClick:()=>re({name:`${N.fileName||"文件"}.pdf`,size:2048e3}),children:[n.jsx(wt,{className:"w-8 h-8 mx-auto text-neutral-400 mb-2"}),n.jsx("p",{className:"text-sm text-neutral-600 mb-1",children:"点击上传文件（支持多选）"}),n.jsx("p",{className:"text-xs text-neutral-500",children:"仅支持 WORD、PDF 格式"})]}),N.attachments.length>0&&n.jsx("div",{className:"mt-3 space-y-2",children:N.attachments.map((_,A)=>n.jsxs("div",{className:"flex items-center justify-between bg-neutral-50 px-3 py-2 rounded-lg",children:[n.jsxs("div",{className:"flex items-center space-x-2 flex-1 min-w-0",children:[n.jsx(Pt,{className:"w-4 h-4 text-neutral-400 flex-shrink-0"}),n.jsx("span",{className:"text-sm text-neutral-900 truncate",children:_.name}),n.jsxs("span",{className:"text-xs text-neutral-500 flex-shrink-0",children:["(",k(_.size),")"]})]}),n.jsx("button",{onClick:()=>Q(A),className:"text-red-600 hover:text-red-800 ml-2 flex-shrink-0",children:n.jsx(qe,{className:"w-4 h-4"})})]},A))})]})]}),n.jsxs("div",{className:"px-6 py-4 bg-neutral-50 flex justify-end gap-2 rounded-b-lg sticky bottom-0",children:[n.jsx("button",{onClick:()=>g?m(!1):h(!1),className:"px-4 py-2 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-100 transition-colors",children:"取消"}),n.jsx("button",{onClick:g?B:Y,className:"px-4 py-2 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors",children:g?"保存":"确定"})]})]})}):null;return n.jsxs("div",{className:"flex flex-col h-full",children:[t&&n.jsx("div",{className:"px-6 py-3 bg-yellow-50 border-b border-yellow-200",children:n.jsxs("p",{className:"text-sm text-yellow-800",children:[n.jsx(Hn,{className:"w-4 h-4 inline mr-2"}),"只读模式 - 无法编辑此信息"]})}),n.jsx("div",{className:"flex-1 overflow-auto",children:n.jsxs("div",{className:"bg-white rounded-lg border border-neutral-200",children:[n.jsxs("div",{className:"px-6 py-4 border-b border-neutral-200",children:[n.jsx("div",{className:"flex items-center justify-between mb-4",children:n.jsx("h2",{className:"text-lg font-medium text-neutral-900",children:"历史投标文件"})}),n.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4",children:n.jsx("p",{className:"text-sm text-blue-700",children:"该模块用于存储企业历史优质的投标文件。这些历史文件可以作为参考模板，帮助快速生成新的投标文件，提高文件准备效率。请按项目分类上传，并添加详细说明。"})}),n.jsxs("div",{className:"flex items-center justify-between gap-3",children:[n.jsxs("div",{className:"flex items-center gap-3",children:["文件名称",n.jsx("input",{type:"text",placeholder:"请输入文件名称",value:s,onChange:g=>i(g.target.value),className:"w-48 px-3 py-1.5 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{onClick:S,className:"px-4 py-1.5 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-50 transition-colors",children:"重置"}),n.jsx("button",{onClick:P,className:"px-4 py-1.5 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors",children:"查询"})]})]})]}),!t&&n.jsx("div",{className:"px-6 py-3 border-b border-neutral-200",children:n.jsxs("button",{onClick:D,className:"px-4 py-1.5 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors flex items-center",children:[n.jsx(Ct,{className:"w-4 h-4 mr-1"}),"上传历史投标文件"]})}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"w-full",children:[n.jsx("thead",{className:"bg-neutral-50 border-b border-neutral-200",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"序号"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"文件名称"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"文件类型"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"文件描述"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"附件数量"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"操作"})]})}),n.jsx("tbody",{className:"divide-y divide-neutral-200",children:H().length===0?n.jsx("tr",{children:n.jsx("td",{colSpan:6,className:"px-4 py-8 text-center text-neutral-500",children:"暂无数据"})}):H().map((g,_)=>n.jsxs("tr",{className:"hover:bg-neutral-50 transition-colors",children:[n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm text-neutral-900",children:(l-1)*o+_+1}),n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm text-neutral-900",children:n.jsx("div",{className:"max-w-xs truncate",title:g.fileName,children:g.fileName})}),n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm text-neutral-900",children:g.fileType}),n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm text-neutral-900",children:n.jsx("div",{className:"max-w-xs truncate",title:g.fileDescription,children:g.fileDescription||"-"})}),n.jsxs("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm text-neutral-900",children:[g.attachments.length," 个文件"]}),n.jsxs("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm",children:[!t&&n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsxs("button",{onClick:()=>K(g),className:"px-2 py-1 text-xs text-primary-600 hover:text-primary-800 hover:bg-primary-50 rounded transition-colors flex items-center gap-1",children:[n.jsx(Et,{className:"w-3.5 h-3.5"}),"编辑"]}),n.jsxs("button",{onClick:()=>C(g),className:"px-2 py-1 text-xs text-red-600 hover:text-red-800 hover:bg-red-50 rounded transition-colors flex items-center gap-1",children:[n.jsx(qe,{className:"w-3.5 h-3.5"}),"删除"]})]}),t&&n.jsx("span",{className:"text-xs text-neutral-400",children:"只读"})]})]},g.id))})]})}),n.jsxs("div",{className:"bg-white border-t border-neutral-200 px-6 py-3 flex items-center justify-center gap-6",children:[n.jsxs("div",{className:"text-sm text-neutral-700",children:["共 ",te.length," 条"]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("button",{onClick:()=>c(Math.max(1,l-1)),disabled:l===1,className:`px-2 py-1 text-sm rounded transition-colors ${l===1?"bg-neutral-100 text-neutral-400 cursor-not-allowed":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:"<"}),n.jsx("div",{className:"flex items-center space-x-1",children:Array.from({length:Math.min(10,ae)},(g,_)=>{let A;return ae<=10||l<=5?A=_+1:l>=ae-4?A=ae-9+_:A=l-4+_,n.jsx("button",{onClick:()=>c(A),className:`px-2.5 py-1 text-sm rounded transition-colors ${l===A?"bg-primary-600 text-white":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:A},A)})}),ae>10&&n.jsxs(n.Fragment,{children:[n.jsx("span",{className:"text-neutral-500",children:"..."}),n.jsx("button",{onClick:()=>c(ae),className:`px-2.5 py-1 text-sm rounded transition-colors ${l===ae?"bg-primary-600 text-white":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:ae})]}),n.jsx("button",{onClick:()=>c(Math.min(ae,l+1)),disabled:l===ae,className:`px-2 py-1 text-sm rounded transition-colors ${l===ae?"bg-neutral-100 text-neutral-400 cursor-not-allowed":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:">"})]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsxs("select",{value:o,onChange:g=>he(Number(g.target.value)),className:"px-2 py-1 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500",children:[n.jsx("option",{value:10,children:"10条/页"}),n.jsx("option",{value:20,children:"20条/页"}),n.jsx("option",{value:50,children:"50条/页"})]}),n.jsx("span",{className:"text-sm text-neutral-700",children:"前往"}),n.jsx("input",{type:"number",value:d,onChange:g=>f(g.target.value),placeholder:"页",className:"w-12 px-2 py-1 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500",min:1,max:ae}),n.jsx("button",{onClick:O,className:"px-3 py-1 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-50 transition-colors",children:"页"})]})]})]})}),x&&I(!1),p&&I(!0),w&&b&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4",children:[n.jsx("div",{className:"px-6 py-4 border-b border-neutral-200",children:n.jsx("h3",{className:"text-lg font-medium text-neutral-900",children:"确认删除"})}),n.jsx("div",{className:"p-6",children:n.jsxs("p",{className:"text-neutral-600",children:["确定要删除文件 ",n.jsxs("span",{className:"font-medium",children:['"',b.fileName,'"']})," 吗？此操作不可恢复。"]})}),n.jsxs("div",{className:"px-6 py-4 bg-neutral-50 flex justify-end gap-2 rounded-b-lg",children:[n.jsx("button",{onClick:()=>v(!1),className:"px-4 py-2 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-100 transition-colors",children:"取消"}),n.jsx("button",{onClick:ee,className:"px-4 py-2 text-sm bg-red-600 text-white rounded hover:bg-red-700 transition-colors",children:"删除"})]})]})})]})},HE=({companyId:e,readOnly:t=!1})=>{const[r,a]=M.useState(()=>{const g=localStorage.getItem(`reference_files_${e}`);return g?JSON.parse(g):[]});M.useEffect(()=>{localStorage.setItem(`reference_files_${e}`,JSON.stringify(r))},[r,e]);const[s,i]=M.useState(""),[l,c]=M.useState(1),[o,u]=M.useState(10),[d,f]=M.useState(""),[x,h]=M.useState(!1),[p,m]=M.useState(!1),[w,v]=M.useState(!1),[b,y]=M.useState(null),[N,F]=M.useState(null),j=50*1024*1024,k=g=>{if(g===0)return"0 B";const _=1024,A=["B","KB","MB","GB"],ne=Math.floor(Math.log(g)/Math.log(_));return Math.round(g/Math.pow(_,ne)*100)/100+" "+A[ne]},S=()=>{i(""),c(1)},P=()=>{console.log("Searching:",s)},D=()=>{F({id:"",fileName:"",fileType:"",fileDescription:"",attachments:[]}),h(!0)},K=g=>{F({...g}),m(!0)},C=g=>{y(g),v(!0)},Y=()=>{if(N){const g={...N,id:String(Date.now()),createdAt:new Date().toISOString()};a([...r,g]),h(!1)}},B=()=>{N&&(a(r.map(g=>g.id===N.id?N:g)),m(!1))},ee=()=>{b&&(a(r.filter(g=>g.id!==b.id)),v(!1))},re=g=>{if(N){if(g.size>j){alert(`文件 "${g.name}" 超过50MB限制，无法上传`);return}const _={url:"",name:g.name,size:g.size};F({...N,attachments:[...N.attachments,_]})}},Q=g=>{N&&F({...N,attachments:N.attachments.filter((_,A)=>A!==g)})},te=r.filter(g=>!s||g.fileName.toLowerCase().includes(s.toLowerCase())||g.fileType.toLowerCase().includes(s.toLowerCase())).sort((g,_)=>{const A=g.createdAt?new Date(g.createdAt).getTime():0;return(_.createdAt?new Date(_.createdAt).getTime():0)-A}),H=()=>{const g=(l-1)*o,_=g+o;return te.slice(g,_)},ae=Math.ceil(te.length/o),he=g=>{u(g),c(1)},O=()=>{const g=parseInt(d);g>=1&&g<=ae&&(c(g),f(""))},I=g=>N?n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-3xl w-full max-h-[90vh] overflow-y-auto",children:[n.jsxs("div",{className:"px-6 py-4 border-b border-neutral-200 flex items-center justify-between sticky top-0 bg-white z-10",children:[n.jsx("h3",{className:"text-lg font-medium text-neutral-900",children:g?"编辑其他参考文件":"上传其他参考文件"}),n.jsx("button",{onClick:()=>g?m(!1):h(!1),className:"text-neutral-400 hover:text-neutral-600 transition-colors",children:n.jsx(Ze,{className:"w-5 h-5"})})]}),n.jsxs("div",{className:"p-6 space-y-4",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:["文件名称 ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:N.fileName,onChange:_=>F({...N,fileName:_.target.value}),placeholder:"请输入文件名称",className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:["文件类型 ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:N.fileType,onChange:_=>F({...N,fileType:_.target.value}),placeholder:"请输入文件类型",className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:"文件描述"}),n.jsx("textarea",{value:N.fileDescription,onChange:_=>F({...N,fileDescription:_.target.value}),placeholder:"请输入文件描述",rows:4,className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:["附件 ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsxs("div",{className:"border-2 border-dashed border-neutral-300 rounded-lg p-6 text-center hover:border-primary-500 transition-colors cursor-pointer",onClick:()=>re({name:`${N.fileName||"文件"}.pdf`,size:2048e3}),children:[n.jsx(wt,{className:"w-8 h-8 mx-auto text-neutral-400 mb-2"}),n.jsx("p",{className:"text-sm text-neutral-600 mb-1",children:"点击上传文件（支持多选）"}),n.jsx("p",{className:"text-xs text-neutral-500",children:"仅支持 WORD、PDF 格式"})]}),N.attachments.length>0&&n.jsx("div",{className:"mt-3 space-y-2",children:N.attachments.map((_,A)=>n.jsxs("div",{className:"flex items-center justify-between bg-neutral-50 px-3 py-2 rounded-lg",children:[n.jsxs("div",{className:"flex items-center space-x-2 flex-1 min-w-0",children:[n.jsx(Pt,{className:"w-4 h-4 text-neutral-400 flex-shrink-0"}),n.jsx("span",{className:"text-sm text-neutral-900 truncate",children:_.name}),n.jsxs("span",{className:"text-xs text-neutral-500 flex-shrink-0",children:["(",k(_.size),")"]})]}),n.jsx("button",{onClick:()=>Q(A),className:"text-red-600 hover:text-red-800 ml-2 flex-shrink-0",children:n.jsx(qe,{className:"w-4 h-4"})})]},A))})]})]}),n.jsxs("div",{className:"px-6 py-4 bg-neutral-50 flex justify-end gap-2 rounded-b-lg sticky bottom-0",children:[n.jsx("button",{onClick:()=>g?m(!1):h(!1),className:"px-4 py-2 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-100 transition-colors",children:"取消"}),n.jsx("button",{onClick:g?B:Y,className:"px-4 py-2 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors",children:g?"保存":"确定"})]})]})}):null;return n.jsxs("div",{className:"flex flex-col h-full",children:[t&&n.jsx("div",{className:"px-6 py-3 bg-yellow-50 border-b border-yellow-200",children:n.jsxs("p",{className:"text-sm text-yellow-800",children:[n.jsx(Hn,{className:"w-4 h-4 inline mr-2"}),"只读模式 - 无法编辑此信息"]})}),n.jsx("div",{className:"flex-1 overflow-auto",children:n.jsxs("div",{className:"bg-white rounded-lg border border-neutral-200",children:[n.jsxs("div",{className:"px-6 py-4 border-b border-neutral-200",children:[n.jsx("div",{className:"flex items-center justify-between mb-4",children:n.jsx("h2",{className:"text-lg font-medium text-neutral-900",children:"其他参考文件"})}),n.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4",children:n.jsx("p",{className:"text-sm text-blue-700",children:"该模块用于存储其他类型的参考文件，如售后服务保障、质量保证措施等。这些文件可以在生成投标文件时作为参考和素材使用，丰富文件内容。请按照文件类型分类存储，方便查找和使用。"})}),n.jsxs("div",{className:"flex items-center justify-between gap-3",children:[n.jsxs("div",{className:"flex items-center gap-3",children:["文件名称",n.jsx("input",{type:"text",placeholder:"请输入文件名称",value:s,onChange:g=>i(g.target.value),className:"w-48 px-3 py-1.5 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{onClick:S,className:"px-4 py-1.5 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-50 transition-colors",children:"重置"}),n.jsx("button",{onClick:P,className:"px-4 py-1.5 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors",children:"查询"})]})]})]}),!t&&n.jsx("div",{className:"px-6 py-3 border-b border-neutral-200",children:n.jsxs("button",{onClick:D,className:"px-4 py-1.5 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors flex items-center",children:[n.jsx(Ct,{className:"w-4 h-4 mr-1"}),"上传其他参考文件"]})}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"w-full",children:[n.jsx("thead",{className:"bg-neutral-50 border-b border-neutral-200",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"序号"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"文件名称"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"文件类型"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"文件描述"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"附件数量"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"操作"})]})}),n.jsx("tbody",{className:"divide-y divide-neutral-200",children:H().length===0?n.jsx("tr",{children:n.jsx("td",{colSpan:6,className:"px-4 py-8 text-center text-neutral-500",children:"暂无数据"})}):H().map((g,_)=>n.jsxs("tr",{className:"hover:bg-neutral-50 transition-colors",children:[n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm text-neutral-900",children:(l-1)*o+_+1}),n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm text-neutral-900",children:n.jsx("div",{className:"max-w-xs truncate",title:g.fileName,children:g.fileName})}),n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm text-neutral-900",children:g.fileType}),n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm text-neutral-900",children:n.jsx("div",{className:"max-w-xs truncate",title:g.fileDescription,children:g.fileDescription||"-"})}),n.jsxs("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm text-neutral-900",children:[g.attachments.length," 个文件"]}),n.jsxs("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm",children:[!t&&n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsxs("button",{onClick:()=>K(g),className:"px-2 py-1 text-xs text-primary-600 hover:text-primary-800 hover:bg-primary-50 rounded transition-colors flex items-center gap-1",children:[n.jsx(Et,{className:"w-3.5 h-3.5"}),"编辑"]}),n.jsxs("button",{onClick:()=>C(g),className:"px-2 py-1 text-xs text-red-600 hover:text-red-800 hover:bg-red-50 rounded transition-colors flex items-center gap-1",children:[n.jsx(qe,{className:"w-3.5 h-3.5"}),"删除"]})]}),t&&n.jsx("span",{className:"text-xs text-neutral-400",children:"只读"})]})]},g.id))})]})}),n.jsxs("div",{className:"bg-white border-t border-neutral-200 px-6 py-3 flex items-center justify-center gap-6",children:[n.jsxs("div",{className:"text-sm text-neutral-700",children:["共 ",te.length," 条"]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("button",{onClick:()=>c(Math.max(1,l-1)),disabled:l===1,className:`px-2 py-1 text-sm rounded transition-colors ${l===1?"bg-neutral-100 text-neutral-400 cursor-not-allowed":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:"<"}),n.jsx("div",{className:"flex items-center space-x-1",children:Array.from({length:Math.min(10,ae)},(g,_)=>{let A;return ae<=10||l<=5?A=_+1:l>=ae-4?A=ae-9+_:A=l-4+_,n.jsx("button",{onClick:()=>c(A),className:`px-2.5 py-1 text-sm rounded transition-colors ${l===A?"bg-primary-600 text-white":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:A},A)})}),ae>10&&n.jsxs(n.Fragment,{children:[n.jsx("span",{className:"text-neutral-500",children:"..."}),n.jsx("button",{onClick:()=>c(ae),className:`px-2.5 py-1 text-sm rounded transition-colors ${l===ae?"bg-primary-600 text-white":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:ae})]}),n.jsx("button",{onClick:()=>c(Math.min(ae,l+1)),disabled:l===ae,className:`px-2 py-1 text-sm rounded transition-colors ${l===ae?"bg-neutral-100 text-neutral-400 cursor-not-allowed":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:">"})]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsxs("select",{value:o,onChange:g=>he(Number(g.target.value)),className:"px-2 py-1 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500",children:[n.jsx("option",{value:10,children:"10条/页"}),n.jsx("option",{value:20,children:"20条/页"}),n.jsx("option",{value:50,children:"50条/页"})]}),n.jsx("span",{className:"text-sm text-neutral-700",children:"前往"}),n.jsx("input",{type:"number",value:d,onChange:g=>f(g.target.value),placeholder:"页",className:"w-12 px-2 py-1 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500",min:1,max:ae}),n.jsx("button",{onClick:O,className:"px-3 py-1 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-50 transition-colors",children:"页"})]})]})]})}),x&&I(!1),p&&I(!0),w&&b&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4",children:[n.jsx("div",{className:"px-6 py-4 border-b border-neutral-200",children:n.jsx("h3",{className:"text-lg font-medium text-neutral-900",children:"确认删除"})}),n.jsx("div",{className:"p-6",children:n.jsxs("p",{className:"text-neutral-600",children:["确定要删除文件 ",n.jsxs("span",{className:"font-medium",children:['"',b.fileName,'"']})," 吗？此操作不可恢复。"]})}),n.jsxs("div",{className:"px-6 py-4 bg-neutral-50 flex justify-end gap-2 rounded-b-lg",children:[n.jsx("button",{onClick:()=>v(!1),className:"px-4 py-2 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-100 transition-colors",children:"取消"}),n.jsx("button",{onClick:ee,className:"px-4 py-2 text-sm bg-red-600 text-white rounded hover:bg-red-700 transition-colors",children:"删除"})]})]})})]})},$E=[{id:"1",name:"北京某某科技有限公司",created_at:"2024-01-15"},{id:"2",name:"上海XX信息技术有限公司",created_at:"2024-01-10"},{id:"3",name:"深圳YY软件开发公司",created_at:"2024-01-08"},{id:"4",name:"广州ZZ网络科技公司",created_at:"2024-01-05"}],VE=({canEdit:e=!1,canDelete:t=!1,dataScope:r,readOnly:a=!1,currentUser:s})=>{const[i]=M.useState($E),[l,c]=M.useState(null),[o,u]=M.useState(""),[d,f]=M.useState("company");M.useState(!1),M.useState(!1),M.useState(!1),M.useState(!1),M.useState(null),M.useState(null),M.useState(null),M.useState("");const[x,h]=M.useState(""),[p,m]=M.useState(1),[w]=M.useState(10),[v,b]=M.useState([{id:"company",label:"公司基础信息",icon:El,count:25},{id:"qualification",label:"资质信息",icon:g1,count:18},{id:"financial",label:"财务信息",icon:vb,count:15},{id:"performance",label:"业绩信息",icon:Pt,count:35},{id:"personnel",label:"人员信息",icon:b1,count:28},{id:"product",label:"产品信息",icon:Sb,count:0},{id:"templates",label:"历史投标文件",icon:wt,count:22},{id:"referenceFiles",label:"其他参考文件",icon:po,count:0}]),y=Y=>{c(Y)},N=()=>{c(null),f("company"),h("")},F=()=>o?i.filter(Y=>Y.name.toLowerCase().includes(o.toLowerCase())):i,j=()=>{u("")},k={company:[{id:1,name:"公司营业执照",type:"PDF",date:"2024-01-15",status:"已验证"},{id:2,name:"公司简介",type:"DOCX",date:"2024-01-10",status:"已验证"},{id:3,name:"组织架构图",type:"PDF",date:"2024-01-08",status:"待更新"},{id:4,name:"公司资质证书",type:"PDF",date:"2024-01-12",status:"已验证"},{id:5,name:"企业文化介绍",type:"DOCX",date:"2024-01-05",status:"已验证"}],qualification:[{id:1,name:"软件企业认定证书",type:"PDF",date:"2024-01-20",status:"已验证"},{id:2,name:"ISO9001质量管理体系",type:"PDF",date:"2024-01-18",status:"已验证"},{id:3,name:"信息安全等级保护证书",type:"PDF",date:"2024-01-16",status:"已验证"}],financial:[{id:1,name:"2023年度财务报告",type:"PDF",date:"2024-01-25",status:"已验证"},{id:2,name:"2022年度财务报告",type:"PDF",date:"2023-12-20",status:"已验证"},{id:3,name:"审计报告",type:"PDF",date:"2024-01-20",status:"已验证"}],performance:[{id:1,name:"某三甲医院HIS系统项目",type:"PDF",date:"2024-01-20",status:"已验证"},{id:2,name:"市政府政务服务平台",type:"PDF",date:"2024-01-18",status:"已验证"},{id:3,name:"智慧城市综合管理平台",type:"PDF",date:"2024-01-16",status:"已验证"}],personnel:[{id:1,name:"项目经理-张三简历",type:"PDF",date:"2024-01-20",status:"已验证"},{id:2,name:"系统架构师-李四简历",type:"PDF",date:"2024-01-18",status:"已验证"},{id:3,name:"高级开发工程师-王五简历",type:"PDF",date:"2024-01-16",status:"已验证"}],templates:[{id:1,name:"医院信息化项目投标模板",type:"DOCX",date:"2024-01-20",status:"已验证"},{id:2,name:"政府采购项目投标模板",type:"DOCX",date:"2024-01-18",status:"已验证"},{id:3,name:"软件开发项目投标模板",type:"DOCX",date:"2024-01-16",status:"已验证"}]},[S,P]=M.useState(k);Math.ceil((()=>{const Y=S[d]||[];return x?Y.filter(B=>B.name.toLowerCase().includes(x.toLowerCase())||B.type.toLowerCase().includes(x.toLowerCase())||B.status.toLowerCase().includes(x.toLowerCase())):Y})().length/w);const K=Y=>{f(Y),m(1),h("")};if(!l)return n.jsx("div",{className:"flex flex-col h-full",children:n.jsx("div",{className:"flex-1 flex flex-col overflow-hidden",children:n.jsxs("div",{className:"bg-white rounded-lg border border-neutral-200 flex flex-col h-full",children:[n.jsxs("div",{className:"px-6 py-4 border-b border-neutral-200 flex-shrink-0",children:[n.jsx("div",{className:"flex items-center justify-between mb-4",children:n.jsx("h2",{className:"text-lg font-medium text-neutral-900",children:"企业知识库管理"})}),n.jsxs("div",{className:"flex items-center justify-between gap-3",children:[n.jsxs("div",{className:"flex items-center gap-3",children:["企业名称",n.jsx("input",{type:"text",placeholder:"请输入企业名称",value:o,onChange:Y=>u(Y.target.value),className:"w-48 px-3 py-1.5 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{onClick:j,className:"px-4 py-1.5 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-50 transition-colors",children:"重置"}),n.jsx("button",{onClick:j,className:"px-4 py-1.5 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors",children:"查询"})]})]})]}),n.jsx("div",{className:"px-6 py-3 border-b border-neutral-200 flex-shrink-0",children:n.jsx("div",{className:"text-sm text-neutral-500 italic",children:"企业列表（仅查看）"})}),n.jsx("div",{className:"p-6 flex-1 overflow-auto",children:n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:F().map(Y=>n.jsx("div",{className:"p-6 rounded-lg border-2 border-gray-200 hover:border-primary-500 hover:shadow-md transition-all duration-200 group relative",children:n.jsxs("div",{onClick:()=>y(Y),className:"cursor-pointer",children:[n.jsx("div",{className:"flex items-start justify-between mb-3",children:n.jsx("div",{className:"w-12 h-12 bg-primary-100 rounded-lg flex items-center justify-center group-hover:bg-primary-200 transition-colors",children:n.jsx(El,{className:"w-6 h-6 text-primary-600"})})}),n.jsx("h3",{className:"font-semibold text-gray-900 mb-2 line-clamp-2 min-h-[3rem]",children:Y.name}),n.jsxs("p",{className:"text-sm text-gray-500",children:["创建时间：",Y.created_at]})]})},Y.id))})})]})})});const C=()=>{if(!l)return null;switch(d){case"company":return n.jsx(Xx,{companyId:l.id,readOnly:a});case"qualification":return n.jsx(Mb,{companyId:l.id,readOnly:a});case"financial":return n.jsx(Rb,{companyId:l.id,readOnly:a});case"performance":return n.jsx(LE,{companyId:l.id,readOnly:a});case"personnel":return n.jsx(BE,{companyId:l.id,readOnly:a});case"product":return n.jsx(zE,{companyId:l.id,readOnly:a});case"templates":return n.jsx(WE,{companyId:l.id,readOnly:a});case"referenceFiles":return n.jsx(HE,{companyId:l.id,readOnly:a});default:return n.jsx(Xx,{companyId:l.id,readOnly:a})}};return n.jsxs("div",{className:"flex flex-col h-full",children:[n.jsx("div",{className:"bg-white border-b border-neutral-200 px-6 py-4",children:n.jsxs("div",{className:"flex items-center space-x-4",children:[n.jsx("button",{onClick:N,className:"text-neutral-600 hover:text-neutral-900 transition-colors",children:n.jsx(yi,{className:"w-6 h-6"})}),n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsx("h2",{className:"text-lg font-medium text-neutral-900",children:l.name}),n.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-primary-100 text-primary-800",children:"当前企业"})]}),n.jsx("p",{className:"text-sm text-neutral-500",children:"企业知识库（数据独立，不与其他企业共享）"})]})]})}),n.jsx("div",{className:"bg-white border-b border-neutral-200",children:n.jsx("div",{className:"flex overflow-x-auto",children:v.map(Y=>{const B=Y.icon;return n.jsxs("button",{onClick:()=>K(Y.id),className:`flex items-center space-x-2 px-6 py-3 border-b-2 transition-colors whitespace-nowrap ${d===Y.id?"border-primary-600 text-primary-600":"border-transparent text-neutral-600 hover:text-neutral-900 hover:border-neutral-300"}`,children:[n.jsx(B,{className:"w-4 h-4"}),n.jsx("span",{className:"text-sm font-medium",children:Y.label})]},Y.id)})})}),n.jsx("div",{className:"flex-1 overflow-auto",children:C()})]})},GE=({projects:e,onUploadClick:t,onViewProject:r,onDeleteProject:a,onReparse:s,onGenerateDocument:i,onDownloadProject:l})=>{const[c,o]=M.useState(""),[u,d]=M.useState("all"),[f,x]=M.useState(!1),[h,p]=M.useState(null),[m,w]=M.useState(null),[v,b]=M.useState(1),[y,N]=M.useState(10),[F,j]=M.useState(""),[k,S]=M.useState(!1),[P,D]=M.useState(null),K=()=>{o(""),d("all")},C=()=>{console.log("Searching:",c,u)},Y=I=>{p(I),x(!0)},B=()=>{h&&(a(h.id),x(!1),p(null))},ee=I=>{I.status==="completed"?(D(I),S(!0)):r(I)},re=()=>{P&&(r(P),S(!1),D(null))},Q=e.filter(I=>{const g=!c||I.projectName.toLowerCase().includes(c.toLowerCase()),_=u==="all"||I.status===u;return g&&_}).sort((I,g)=>new Date(g.uploadTime).getTime()-new Date(I.uploadTime).getTime()),te=()=>{const I=(v-1)*y,g=I+y;return Q.slice(I,g)},H=Math.ceil(Q.length/y),ae=I=>{N(I),b(1)},he=()=>{const I=parseInt(F);I>=1&&I<=H&&(b(I),j(""))},O=I=>{const _={pending:{label:"待解析",className:"bg-gray-100 text-gray-800"},parsing:{label:"解析中",className:"bg-blue-100 text-blue-800"},parsed:{label:"已解析",className:"bg-green-100 text-green-800"},failed:{label:"解析失败",className:"bg-red-100 text-red-800"},completed:{label:"已完成",className:"bg-primary-100 text-primary-800"}}[I];return n.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${_.className}`,children:_.label})};return n.jsxs("div",{className:"flex flex-col h-full",children:[n.jsx("div",{className:"flex-1 flex flex-col overflow-hidden",children:n.jsxs("div",{className:"bg-white rounded-lg border border-neutral-200 flex flex-col h-full",children:[n.jsxs("div",{className:"px-6 py-4 border-b border-neutral-200 flex-shrink-0",children:[n.jsx("div",{className:"flex items-center justify-between mb-4",children:n.jsx("h2",{className:"text-lg font-medium text-neutral-900",children:"招标项目管理"})}),n.jsxs("div",{className:"flex items-center justify-between gap-3",children:[n.jsxs("div",{className:"flex items-center gap-3 flex-wrap",children:["项目名称",n.jsx("input",{type:"text",placeholder:"请输入项目名称",value:c,onChange:I=>o(I.target.value),className:"w-48 px-3 py-1.5 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500"}),"状态",n.jsxs("select",{value:u,onChange:I=>d(I.target.value),className:"px-3 py-1.5 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500",children:[n.jsx("option",{value:"all",children:"全部"}),n.jsx("option",{value:"pending",children:"待解析"}),n.jsx("option",{value:"parsing",children:"解析中"}),n.jsx("option",{value:"parsed",children:"已解析"}),n.jsx("option",{value:"failed",children:"解析失败"}),n.jsx("option",{value:"completed",children:"已完成"})]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{onClick:K,className:"px-4 py-1.5 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-50 transition-colors",children:"重置"}),n.jsx("button",{onClick:C,className:"px-4 py-1.5 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors",children:"查询"})]})]})]}),n.jsx("div",{className:"px-6 py-3 border-b border-neutral-200 flex-shrink-0",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("button",{onClick:t,className:"px-4 py-1.5 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors flex items-center",children:[n.jsx(Ct,{className:"w-4 h-4 mr-1"}),"上传招标文件"]}),n.jsxs("button",{onClick:()=>m?i(m):null,disabled:!m||m.status!=="completed",className:"px-4 py-1.5 text-sm bg-green-600 text-white rounded hover:bg-green-700 transition-colors flex items-center disabled:opacity-50 disabled:cursor-not-allowed",title:m?m.status!=="completed"?"仅已完成的项目可生成投标文件":"":"请先选择已完成的项目",children:[n.jsx(Pt,{className:"w-4 h-4 mr-1"}),"投标文件生成"]})]})}),n.jsx("div",{className:"overflow-x-auto flex-1 overflow-y-auto",children:n.jsxs("table",{className:"w-full",children:[n.jsx("thead",{className:"bg-neutral-50 border-b border-neutral-200",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"选择"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"序号"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"招标项目名称"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"状态"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"上传时间"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"操作"})]})}),n.jsx("tbody",{className:"divide-y divide-neutral-200",children:Q.length===0?n.jsx("tr",{children:n.jsx("td",{colSpan:6,className:"px-4 py-8 text-center text-neutral-500",children:"暂无数据"})}):te().map((I,g)=>n.jsxs("tr",{className:"hover:bg-neutral-50 transition-colors",children:[n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm text-neutral-900",children:n.jsx("input",{type:"radio",name:"selectedProject",checked:(m==null?void 0:m.id)===I.id,onChange:()=>w(I),disabled:I.status!=="completed",className:"w-4 h-4 text-primary-600 focus:ring-primary-500 disabled:opacity-30 disabled:cursor-not-allowed",title:I.status!=="completed"?"仅已完成的项目可选择":""})}),n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm text-neutral-900",children:(v-1)*y+g+1}),n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm text-neutral-900",children:n.jsx("div",{className:"max-w-md truncate",title:I.projectName,children:I.projectName})}),n.jsxs("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm",children:[O(I.status),I.status==="parsing"&&I.parseProgress!==void 0&&n.jsxs("span",{className:"ml-2 text-xs text-neutral-500",children:[I.parseProgress,"%"]})]}),n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm text-neutral-900",children:I.uploadTime}),n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm",children:n.jsx("div",{className:"flex items-center space-x-3",children:I.status==="failed"?n.jsxs(n.Fragment,{children:[n.jsxs("button",{onClick:()=>s(I),className:"px-2 py-1 text-xs text-orange-600 hover:text-orange-800 hover:bg-orange-50 rounded transition-colors flex items-center gap-1",children:[n.jsx(Tl,{className:"w-3.5 h-3.5"}),"重试"]}),n.jsxs("button",{onClick:()=>Y(I),className:"px-2 py-1 text-xs text-red-600 hover:text-red-800 hover:bg-red-50 rounded transition-colors flex items-center gap-1",children:[n.jsx(qe,{className:"w-3.5 h-3.5"}),"删除"]})]}):I.status==="parsing"?n.jsxs(n.Fragment,{children:[n.jsxs("button",{disabled:!0,className:"px-2 py-1 text-xs text-neutral-400 cursor-not-allowed rounded flex items-center gap-1",children:[n.jsx(Et,{className:"w-3.5 h-3.5"}),"编辑"]}),n.jsxs("button",{disabled:!0,className:"px-2 py-1 text-xs text-neutral-400 cursor-not-allowed rounded flex items-center gap-1",children:[n.jsx(qe,{className:"w-3.5 h-3.5"}),"删除"]})]}):n.jsxs(n.Fragment,{children:[n.jsxs("button",{onClick:()=>ee(I),className:"px-2 py-1 text-xs text-primary-600 hover:text-primary-800 hover:bg-primary-50 rounded transition-colors flex items-center gap-1",children:[n.jsx(Et,{className:"w-3.5 h-3.5"}),"编辑"]}),n.jsxs("button",{onClick:()=>Y(I),className:"px-2 py-1 text-xs text-red-600 hover:text-red-800 hover:bg-red-50 rounded transition-colors flex items-center gap-1",children:[n.jsx(qe,{className:"w-3.5 h-3.5"}),"删除"]})]})})})]},I.id))})]})}),n.jsxs("div",{className:"bg-white border-t border-neutral-200 px-6 py-3 flex items-center justify-center gap-6 flex-shrink-0",children:[n.jsxs("div",{className:"text-sm text-neutral-700",children:["共 ",Q.length," 条"]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("button",{onClick:()=>b(Math.max(1,v-1)),disabled:v===1,className:`px-2 py-1 text-sm rounded transition-colors ${v===1?"bg-neutral-100 text-neutral-400 cursor-not-allowed":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:"<"}),n.jsx("div",{className:"flex items-center space-x-1",children:Array.from({length:Math.min(10,H)},(I,g)=>{let _;return H<=10||v<=5?_=g+1:v>=H-4?_=H-9+g:_=v-4+g,n.jsx("button",{onClick:()=>b(_),className:`px-2.5 py-1 text-sm rounded transition-colors ${v===_?"bg-primary-600 text-white":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:_},_)})}),H>10&&n.jsxs(n.Fragment,{children:[n.jsx("span",{className:"text-neutral-500",children:"..."}),n.jsx("button",{onClick:()=>b(H),className:`px-2.5 py-1 text-sm rounded transition-colors ${v===H?"bg-primary-600 text-white":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:H})]}),n.jsx("button",{onClick:()=>b(Math.min(H,v+1)),disabled:v===H,className:`px-2 py-1 text-sm rounded transition-colors ${v===H?"bg-neutral-100 text-neutral-400 cursor-not-allowed":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:">"})]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsxs("select",{value:y,onChange:I=>ae(Number(I.target.value)),className:"px-2 py-1 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500",children:[n.jsx("option",{value:10,children:"10条/页"}),n.jsx("option",{value:20,children:"20条/页"}),n.jsx("option",{value:50,children:"50条/页"})]}),n.jsx("span",{className:"text-sm text-neutral-700",children:"前往"}),n.jsx("input",{type:"number",value:F,onChange:I=>j(I.target.value),onKeyDown:I=>I.key==="Enter"&&he(),placeholder:"页",className:"w-12 px-2 py-1 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500",min:1,max:H}),n.jsx("button",{onClick:he,className:"px-3 py-1 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors",children:"跳转"})]})]})]})}),f&&h&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4",children:[n.jsx("div",{className:"px-6 py-4 border-b border-neutral-200",children:n.jsx("h3",{className:"text-lg font-medium text-neutral-900",children:"确认删除"})}),n.jsx("div",{className:"p-6",children:n.jsxs("p",{className:"text-neutral-600",children:["确定要删除项目 ",n.jsxs("span",{className:"font-medium",children:['"',h.projectName,'"']})," 吗？此操作不可恢复。"]})}),n.jsxs("div",{className:"px-6 py-4 bg-neutral-50 flex justify-end gap-2 rounded-b-lg",children:[n.jsx("button",{onClick:()=>x(!1),className:"px-4 py-2 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-100 transition-colors",children:"取消"}),n.jsx("button",{onClick:B,className:"px-4 py-2 text-sm bg-red-600 text-white rounded hover:bg-red-700 transition-colors",children:"删除"})]})]})}),k&&P&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4",children:[n.jsx("div",{className:"px-6 py-4 border-b border-neutral-200",children:n.jsx("h3",{className:"text-lg font-medium text-neutral-900",children:"确认编辑"})}),n.jsx("div",{className:"p-6",children:n.jsx("p",{className:"text-neutral-600",children:"当前项目已经完成解析并核对完成，是否要继续修改？"})}),n.jsxs("div",{className:"px-6 py-4 bg-neutral-50 flex justify-end gap-2 rounded-b-lg",children:[n.jsx("button",{onClick:()=>{S(!1),D(null)},className:"px-4 py-2 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-100 transition-colors",children:"取消"}),n.jsx("button",{onClick:re,className:"px-4 py-2 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors",children:"继续修改"})]})]})})]})},XE=({onBack:e,onStartParsing:t,initialProjectName:r="",initialFileName:a=""})=>{const[s,i]=M.useState(r),[l,c]=M.useState(a?[{name:a,size:0,category:"tender"}]:[]),[o,u]=M.useState(null),d=50*1024*1024,f=[{id:"tender",label:"招标文件",required:!0,description:"主要招标文件，包含项目基本信息、评审标准等"},{id:"specification",label:"招标技术规范书",required:!1,description:"技术要求、性能指标、验收标准等技术文件"},{id:"other",label:"其他文件",required:!1,description:"补充说明、图纸资料、附件等（可选）"}],x=P=>{if(P===0)return"0 B";const D=1024,K=["B","KB","MB","GB"],C=Math.floor(Math.log(P)/Math.log(D));return Math.round(P/Math.pow(D,C)*100)/100+" "+K[C]},h=(P,D)=>{const K=[],C=[".doc",".docx"];Array.from(P).forEach(Y=>{const B=Y.name.substring(Y.name.lastIndexOf(".")).toLowerCase();if(!C.includes(B)){alert(`文件 "${Y.name}" 格式不支持，仅支持 DOC、DOCX 格式`);return}if(Y.size>d){alert(`文件 "${Y.name}" 超过50MB限制，无法上传`);return}K.push({name:Y.name,size:Y.size,category:D})}),K.length>0&&(c([...l,...K]),!s&&K.length>0&&i(K[0].name.replace(/\.[^/.]+$/,"")))},p=(P,D)=>{P.preventDefault(),u(null),P.dataTransfer.files.length>0&&h(P.dataTransfer.files,D)},m=(P,D)=>{P.preventDefault(),u(D)},w=()=>{u(null)},v=(P,D)=>{P.target.files&&P.target.files.length>0&&h(P.target.files,D),P.target.value=""},b=()=>{if(!s.trim()){alert("请输入项目名称");return}const P=l.filter(K=>K.category==="tender"),D=l.filter(K=>K.category==="specification");if(P.length===0){alert("请至少上传一个招标文件");return}if(D.length===0){alert("请至少上传一个招标技术规范书");return}t(s.trim(),l)},y=P=>{c(l.filter((D,K)=>K!==P))},N=P=>l.filter(D=>D.category===P),F=P=>{const D=N(P.id),K=o===P.id;return n.jsxs("div",{className:"h-full flex flex-col border border-neutral-200 rounded-lg bg-neutral-50/50 p-4",children:[n.jsxs("div",{className:"mb-3",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsxs("label",{className:"text-sm font-semibold text-neutral-900",children:[P.label,P.required&&n.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),n.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-neutral-200 text-neutral-700",children:D.length})]}),n.jsx("p",{className:"text-xs text-neutral-500 leading-relaxed",children:P.description})]}),n.jsxs("div",{className:`border-2 border-dashed rounded-lg p-6 text-center transition-all cursor-pointer mb-3 ${K?"border-primary-500 bg-primary-50 scale-105":P.required&&D.length===0?"border-red-300 hover:border-red-400 bg-red-50/50":"border-neutral-300 hover:border-primary-400 hover:bg-white"}`,onDrop:C=>p(C,P.id),onDragOver:C=>m(C,P.id),onDragLeave:w,onClick:()=>{var C;return(C=document.getElementById(`file-upload-${P.id}`))==null?void 0:C.click()},children:[n.jsx(wt,{className:`w-8 h-8 mx-auto mb-2 ${P.required&&D.length===0?"text-red-400":"text-neutral-400"}`}),n.jsx("p",{className:"text-sm text-neutral-700 font-medium mb-1",children:"点击上传"}),n.jsx("p",{className:"text-xs text-neutral-500",children:"或拖拽文件到此处"}),n.jsx("input",{id:`file-upload-${P.id}`,type:"file",className:"hidden",accept:".doc,.docx",multiple:!0,onChange:C=>v(C,P.id)})]}),D.length>0&&n.jsx("div",{className:"flex-1 overflow-auto space-y-2",children:D.map((C,Y)=>{const B=l.findIndex(ee=>ee.name===C.name&&ee.category===C.category);return n.jsx("div",{className:"group bg-white px-2.5 py-2 rounded border border-neutral-200 hover:border-primary-300 hover:shadow-sm transition-all",children:n.jsxs("div",{className:"flex items-start justify-between gap-2",children:[n.jsxs("div",{className:"flex items-start space-x-2 flex-1 min-w-0",children:[n.jsx(Pt,{className:"w-4 h-4 text-primary-500 flex-shrink-0 mt-0.5"}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("p",{className:"text-xs text-neutral-900 truncate font-medium",title:C.name,children:C.name}),n.jsx("p",{className:"text-xs text-neutral-500 mt-0.5",children:x(C.size)})]})]}),n.jsx("button",{onClick:ee=>{ee.stopPropagation(),y(B)},className:"opacity-0 group-hover:opacity-100 text-red-500 hover:text-red-700 flex-shrink-0 transition-opacity",children:n.jsx(Ze,{className:"w-4 h-4"})})]})},Y)})})]})},j=l.filter(P=>P.category==="tender"),k=l.filter(P=>P.category==="specification"),S=s.trim()&&j.length>0&&k.length>0;return n.jsx("div",{className:"flex flex-col h-full",children:n.jsx("div",{className:"flex-1 overflow-auto",children:n.jsxs("div",{className:"bg-white rounded-lg border border-neutral-200",children:[n.jsx("div",{className:"px-6 py-4 border-b border-neutral-200",children:n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsx("button",{onClick:e,className:"text-neutral-600 hover:text-neutral-900 transition-colors",children:n.jsx(yi,{className:"w-5 h-5"})}),n.jsx("h2",{className:"text-lg font-medium text-neutral-900",children:"上传招标文件"})]})}),n.jsxs("div",{className:"p-6",children:[n.jsxs("div",{className:"mb-6",children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:["项目名称 ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:s,onChange:P=>i(P.target.value),placeholder:"请输入招标项目名称",className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsx("div",{className:"grid grid-cols-3 gap-6",children:f.map(P=>n.jsx("div",{children:F(P)},P.id))}),(j.length===0||k.length===0)&&n.jsxs("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-4 flex items-start mt-6",children:[n.jsx(Cl,{className:"w-5 h-5 text-amber-600 mr-3 flex-shrink-0 mt-0.5"}),n.jsxs("div",{children:[n.jsx("h4",{className:"text-sm font-medium text-amber-900 mb-1",children:"必选项提醒"}),n.jsxs("p",{className:"text-sm text-amber-700",children:[j.length===0&&k.length===0&&"请上传招标文件和招标技术规范书",j.length===0&&k.length>0&&"请上传招标文件",j.length>0&&k.length===0&&"请上传招标技术规范书"]})]})]}),n.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mt-6",children:[n.jsx("h4",{className:"text-sm font-medium text-blue-900 mb-2",children:"温馨提示"}),n.jsxs("ul",{className:"text-sm text-blue-700 space-y-1",children:[n.jsx("li",{children:"• 招标文件为必选项"}),n.jsx("li",{children:"• 其他文件为可选项，可上传补充材料和附件"}),n.jsx("li",{children:"• 支持同时上传多个文件，系统会自动合并解析"}),n.jsx("li",{children:"• 解析过程可能需要几分钟，请耐心等待"}),n.jsx("li",{children:"• 解析完成后，请仔细核对解析内容"})]})]})]}),n.jsxs("div",{className:"px-6 py-4 bg-neutral-50 flex justify-between items-center gap-2 border-t border-neutral-200",children:[n.jsxs("div",{className:"text-sm text-neutral-600",children:["已上传 ",n.jsx("span",{className:"font-medium text-neutral-900",children:l.length})," 个文件"]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx("button",{onClick:e,className:"px-4 py-2 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-100 transition-colors",children:"返回"}),n.jsx("button",{onClick:b,disabled:!S,className:"px-6 py-2 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors disabled:bg-neutral-300 disabled:cursor-not-allowed",children:"开始解析"})]})]})]})})})},KE=({projectId:e,projectName:t,onBack:r,onParsingComplete:a})=>{const[s,i]=M.useState(0),[l,c]=M.useState(0),[o,u]=M.useState(!1),d=[{id:0,name:"上传文件",description:"正在上传招标文件..."},{id:1,name:"文件预处理",description:"正在解析文件格式..."},{id:2,name:"基础信息提取",description:"正在提取招标人、代理人、项目信息..."},{id:3,name:"资格要求分析",description:"正在分析投标人资格要求..."},{id:4,name:"评审标准提取",description:"正在提取商务和技术评分标准..."},{id:5,name:"文件要求整理",description:"正在整理投标文件格式要求..."},{id:6,name:"风险识别",description:"正在识别风险项和废标条款..."},{id:7,name:"目录生成",description:"正在生成投标文件目录..."},{id:8,name:"完成",description:"解析完成"}];return M.useEffect(()=>{const f=setInterval(()=>{c(x=>x>=100?(clearInterval(f),100):x+1)},100);return()=>clearInterval(f)},[]),M.useEffect(()=>{const f=Math.floor(l/(100/d.length));f<d.length&&i(f),l===100&&setTimeout(()=>{a({basicInfo:{projectInfo:{projectName:"智慧城市信息化建设项目",projectNumber:"ZFCG-2024-001",packageName:"信息系统集成服务包",packageNumber:"FB-01",lotName:"第一标段",lotNumber:"BD-01",projectOverview:"本项目旨在建设智慧城市信息化平台，包括数据中心建设、智能交通系统、公共服务平台等内容。项目建设内容包括：服务器及存储设备采购、网络设备配置、软件系统开发、系统集成实施、人员培训及售后服务等。预计建设周期12个月，分为需求分析、系统设计、开发实施、测试验收四个阶段。",budgetAmount:"人民币 5000 万元",allowConsortium:"本项目接受联合体投标，联合体成员不得超过3家"},tenderer:{name:"北京市朝阳区人民政府",contact:"张先生 / 010-12345678",email:"zhangsan@bjcy.gov.cn",address:"北京市朝阳区朝外大街123号",zipCode:"100020"},agent:{name:"北京中诚招标代理有限公司",contact:"李女士 / 010-87654321",email:"lisi@zcbidding.com",address:"北京市海淀区中关村大街456号科技大厦10层",zipCode:"100080"},keyTimeline:{bidDeadline:"2024年12月15日 09:00:00（北京时间）",submissionMethod:"现场递交纸质投标文件并同时提交电子版",openingTime:"2024年12月15日 09:30:00（北京时间）",openingLocation:"北京市朝阳区朝外大街123号政府采购中心开标室（三楼301室）"},bidBond:{submissionMethod:"银行转账、银行保函或保险保函（任选其一）",amount:"人民币 50 万元整（¥500,000.00）",refundPolicy:`1. 未中标单位的投标保证金在中标通知书发出后5个工作日内无息退还；
2. 中标单位的投标保证金在签订合同并缴纳履约保证金后5个工作日内无息退还；
3. 投标保证金账户信息：
   开户名称：北京中诚招标代理有限公司
   开户银行：中国工商银行北京中关村支行
   账号：0200 1234 5678 9012 3456
   用途：项目编号+投标单位名称`}},qualificationRequirements:`1. 具有独立承担民事责任的能力（提供有效的营业执照或事业单位法人证书）
2. 具有良好的商业信誉和健全的财务会计制度（提供2023年度财务审计报告）
3. 具有履行合同所必需的设备和专业技术能力（提供设备清单及技术人员证明）
4. 具有信息系统集成及服务资质三级及以上或同等能力证明
5. 参加政府采购活动前三年内，在经营活动中没有重大违法记录（提供声明函）
6. 近三年内至少完成过2个类似信息化项目，单个合同金额不低于1000万元（提供合同复印件及验收证明）
7. 本项目不接受联合体投标人之间存在控股、管理关系`,evaluationCriteria:{commercial:`1. 投标报价（30分）：以有效投标报价最低价为基准价，得满分30分。其他投标人得分=（基准价/投标报价）×30分
2. 企业资质（15分）：信息系统集成资质一级15分，二级10分，三级5分
3. 类似业绩（20分）：近三年每提供1个合同金额3000万以上的类似项目得5分，最高20分
4. 企业实力（10分）：注册资本5000万以上10分，3000-5000万8分，1000-3000万5分
5. 财务状况（5分）：2023年营业收入1亿以上5分，5000万-1亿3分，5000万以下1分`,technical:`1. 技术方案（25分）：方案完整性、可行性、创新性、符合程度
2. 实施方案（15分）：实施计划合理性、进度安排、质量保证措施、风险应对
3. 项目团队（10分）：项目经理具有PMP或同等资格5分，团队成员专业配置合理性5分
4. 售后服务（10分）：质保期、响应时间、培训方案、维护方案
5. 演示答辩（20分）：现场演示系统功能、回答评委提问`},documentRequirements:`1. 投标文件需包含商务标和技术标两个部分，分别独立密封包装
2. 采用A4纸打印或打印，双面打印，左侧装订
3. 商务标：正本1份，副本5份；技术标：正本1份，副本5份
4. 电子版光盘或U盘2份（PDF格式，不得加密）
5. 投标文件需使用密封袋密封，并在封口处加盖投标人公章
6. 封面标注项目名称、项目编号、投标人名称、标段号
7. 投标文件每页需加盖投标人公章或骑缝章
8. 所有证明材料需提供原件备查或加盖公章的复印件`,risks:`1. 投标文件逾期送达或未按要求密封的将被拒收
2. 投标保证金未按时到账或金额不足视为无效投标
3. 联合体投标未提供联合体协议或协议不符合要求将被拒绝
4. 投标文件出现以下情况将作废标处理：
   - 未按规定格式填写、内容不全或关键字迹模糊导致无法辨认
   - 投标人名称或组织结构与营业执照不一致
   - 投标文件未加盖公章或关键内容未签字盖章
   - 报价超过招标控制价
   - 不同投标人的投标文件出现实质性雷同
5. 投标人不得串通投标、弄虚作假、行贿等违法行为，一经发现将取消资格并记入不良行为记录`,documentDirectory:{commercial:`一、资格证明文件
  1.1 营业执照副本
  1.2 资质证书
二、商务响应文件
  2.1 投标函
  2.2 法定代表人授权书
三、报价文件
  3.1 投标报价表
  3.2 报价说明
四、其他材料`,technical:""}})},1e3)},[l,a,d.length]),n.jsx("div",{className:"flex flex-col h-full",children:n.jsx("div",{className:"flex-1 overflow-auto",children:n.jsxs("div",{className:"bg-white rounded-lg border border-neutral-200",children:[n.jsx("div",{className:"px-6 py-4 border-b border-neutral-200",children:n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsx("button",{onClick:r,className:"text-neutral-600 hover:text-neutral-900 transition-colors",children:n.jsx(yi,{className:"w-5 h-5"})}),n.jsxs("div",{children:[n.jsx("h2",{className:"text-lg font-medium text-neutral-900",children:"解析进度"}),n.jsx("p",{className:"text-sm text-neutral-500",children:t})]})]})}),n.jsxs("div",{className:"p-6",children:[n.jsxs("div",{className:"mb-8",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("span",{className:"text-sm font-medium text-neutral-700",children:"解析进度"}),n.jsxs("span",{className:"text-sm font-medium text-primary-600",children:[l,"%"]})]}),n.jsx("div",{className:"w-full bg-neutral-200 rounded-full h-2",children:n.jsx("div",{className:"bg-primary-600 h-2 rounded-full transition-all duration-300",style:{width:`${l}%`}})})]}),n.jsx("div",{className:"space-y-4",children:d.map((f,x)=>{const h=x<s,p=x===s,m=x>s;return n.jsxs("div",{className:`flex items-start space-x-3 p-4 rounded-lg transition-colors ${p?"bg-blue-50 border border-blue-200":"bg-neutral-50"}`,children:[n.jsxs("div",{className:"flex-shrink-0 mt-0.5",children:[h&&n.jsx(Zn,{className:"w-5 h-5 text-green-600"}),p&&n.jsx($u,{className:"w-5 h-5 text-blue-600 animate-spin"}),m&&n.jsx("div",{className:"w-5 h-5 rounded-full border-2 border-neutral-300"})]}),n.jsxs("div",{className:"flex-1",children:[n.jsx("h4",{className:`text-sm font-medium ${p?"text-blue-900":h?"text-neutral-900":"text-neutral-500"}`,children:f.name}),(p||h)&&n.jsx("p",{className:`text-xs mt-1 ${p?"text-blue-700":"text-neutral-500"}`,children:f.description})]})]},f.id)})}),o&&n.jsx("div",{className:"mt-6 p-4 bg-red-50 border border-red-200 rounded-lg",children:n.jsxs("div",{className:"flex items-start space-x-3",children:[n.jsx(Cl,{className:"w-5 h-5 text-red-600 flex-shrink-0 mt-0.5"}),n.jsxs("div",{children:[n.jsx("h4",{className:"text-sm font-medium text-red-900",children:"解析失败"}),n.jsx("p",{className:"text-sm text-red-700 mt-1",children:"文件格式不支持或内容无法识别，请检查文件后重新上传。"})]})]})})]}),n.jsx("div",{className:"px-6 py-4 bg-neutral-50 flex justify-between gap-2 border-t border-neutral-200",children:n.jsx("button",{onClick:r,className:"px-4 py-2 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-100 transition-colors",children:"返回列表"})})]})})})},YE=({value:e,onChange:t,placeholder:r})=>{const a=M.useRef(null);M.useEffect(()=>{a.current&&a.current.innerHTML!==e&&(a.current.innerHTML=e||"")},[e]);const s=()=>{a.current&&t(a.current.innerHTML)},i=(c,o)=>{var u;document.execCommand(c,!1,o),(u=a.current)==null||u.focus(),s()},l=c=>{c.preventDefault();const o=c.clipboardData.getData("text/plain");document.execCommand("insertText",!1,o)};return n.jsxs("div",{className:"border-2 border-neutral-300 rounded-lg bg-white shadow-sm hover:border-primary-400 focus-within:border-primary-500 transition-colors",children:[n.jsxs("div",{className:"flex items-center gap-1 p-2 border-b border-neutral-200 bg-gradient-to-r from-neutral-50 to-neutral-100 flex-wrap rounded-t-lg",children:[n.jsx("button",{type:"button",onClick:()=>i("bold"),className:"p-1.5 hover:bg-primary-100 hover:text-primary-700 rounded transition-all active:scale-95",title:"粗体 (Ctrl+B)",children:n.jsx(ub,{className:"w-4 h-4"})}),n.jsx("button",{type:"button",onClick:()=>i("italic"),className:"p-1.5 hover:bg-primary-100 hover:text-primary-700 rounded transition-all active:scale-95",title:"斜体 (Ctrl+I)",children:n.jsx(bb,{className:"w-4 h-4"})}),n.jsx("button",{type:"button",onClick:()=>i("underline"),className:"p-1.5 hover:bg-primary-100 hover:text-primary-700 rounded transition-all active:scale-95",title:"下划线 (Ctrl+U)",children:n.jsx(Ab,{className:"w-4 h-4"})}),n.jsx("div",{className:"w-px h-6 bg-neutral-300 mx-1"}),n.jsx("button",{type:"button",onClick:()=>i("insertUnorderedList"),className:"p-1.5 hover:bg-primary-100 hover:text-primary-700 rounded transition-all active:scale-95",title:"无序列表",children:n.jsx(jb,{className:"w-4 h-4"})}),n.jsx("button",{type:"button",onClick:()=>i("insertOrderedList"),className:"p-1.5 hover:bg-primary-100 hover:text-primary-700 rounded transition-all active:scale-95",title:"有序列表",children:n.jsx(Nb,{className:"w-4 h-4"})}),n.jsx("div",{className:"w-px h-6 bg-neutral-300 mx-1"}),n.jsx("button",{type:"button",onClick:()=>i("justifyLeft"),className:"p-1.5 hover:bg-primary-100 hover:text-primary-700 rounded transition-all active:scale-95",title:"左对齐",children:n.jsx(cb,{className:"w-4 h-4"})}),n.jsx("button",{type:"button",onClick:()=>i("justifyCenter"),className:"p-1.5 hover:bg-primary-100 hover:text-primary-700 rounded transition-all active:scale-95",title:"居中对齐",children:n.jsx(lb,{className:"w-4 h-4"})}),n.jsx("button",{type:"button",onClick:()=>i("justifyRight"),className:"p-1.5 hover:bg-primary-100 hover:text-primary-700 rounded transition-all active:scale-95",title:"右对齐",children:n.jsx(ob,{className:"w-4 h-4"})}),n.jsx("div",{className:"w-px h-6 bg-neutral-300 mx-1"}),n.jsxs("select",{onChange:c=>i("formatBlock",c.target.value),className:"px-3 py-1.5 text-xs border border-neutral-300 rounded hover:bg-white hover:border-primary-400 transition-colors cursor-pointer",defaultValue:"",children:[n.jsx("option",{value:"",children:"正文"}),n.jsx("option",{value:"h1",children:"标题 1"}),n.jsx("option",{value:"h2",children:"标题 2"}),n.jsx("option",{value:"h3",children:"标题 3"})]})]}),n.jsx("div",{ref:a,contentEditable:!0,onInput:s,onPaste:l,className:"min-h-[200px] max-h-[500px] overflow-y-auto p-4 text-sm focus:outline-none","data-placeholder":r,style:{whiteSpace:"pre-wrap"}})]})},qE=({projectId:e,projectName:t,initialData:r,projectStatus:a="parsed",onBack:s,onSave:i,onConfirm:l})=>{const c=W=>{const E=W.toLowerCase().replace(/\s+/g,"");return E.includes("投标函")||E.includes("投标涵")?`<p><strong>投标函</strong></p>
<p><br></p>
<p>致：[招标人名称]</p>
<p><br></p>
<p>我方确认收到贵方<strong>[项目名称]</strong>（项目编号：<strong>[项目编号]</strong>）的招标文件，经认真研究，我方愿意按招标文件的要求参加投标，提交投标文件，并承诺如下：</p>
<p><br></p>
<p><strong>一、我方完全接受招标文件的各项条款和要求。</strong></p>
<p><br></p>
<p><strong>二、我方承诺按照招标文件要求完成本项目，质量符合国家现行相关标准及招标文件要求。</strong></p>
<p><br></p>
<p><strong>三、投标有效期：</strong>自开标之日起[XX]天内有效。</p>
<p><br></p>
<p><strong>四、如果我方中标：</strong></p>
<ol>
<li>我方将在收到中标通知书后，在中标通知书规定的时间内与贵方签订合同。</li>
<li>我方将按照招标文件和合同约定履行全部义务。</li>
<li>我方将按招标文件要求提交履约保证金。</li>
</ol>
<p><br></p>
<p><strong>五、我方理解贵方不一定接受最低报价的投标或收到的任何投标。</strong></p>
<p><br></p>
<p>投标人：[投标人名称]（盖章）</p>
<p>法定代表人或授权代表：_________（签字或盖章）</p>
<p>日期：____年____月____日</p>`:E.includes("授权委托书")||E.includes("委托书")?`<p><strong>法定代表人授权委托书</strong></p>
<p><br></p>
<p>本授权委托书声明：注册于<strong>[注册地址]</strong>的<strong>[投标人全称]</strong>（以下简称"我公司"）的法定代表人<strong>[法定代表人姓名]</strong>代表我公司授权<strong>[被授权人姓名]</strong>为我公司的合法代理人，就<strong>[项目名称]</strong>（项目编号：<strong>[项目编号]</strong>）投标及合同执行事宜，以我公司名义处理一切与之有关的事务。</p>
<p><br></p>
<p><strong>授权范围：</strong></p>
<ol>
<li>参加该项目的投标活动；</li>
<li>签署、提交投标文件、签订合同及处理有关事宜；</li>
<li>参加开标、谈判、签约等活动；</li>
<li>处理与本项目投标有关的一切事务。</li>
</ol>
<p><br></p>
<p>被授权人在授权范围内签署的一切文件和处理的一切事务，我公司均予以认可。</p>
<p><br></p>
<p>本授权书自签署之日起生效，有效期至本项目履行完毕止。</p>
<p><br></p>
<p><strong>附：</strong></p>
<ul>
<li>法定代表人身份证复印件</li>
<li>被授权人身份证复印件</li>
</ul>
<p><br></p>
<p>投标人：[投标人全称]（盖章）</p>
<p>法定代表人：_________（签字或盖章）</p>
<p>被授权人：_________（签字）</p>
<p><br></p>
<p>法定代表人身份证号：__________________</p>
<p>被授权人身份证号：__________________</p>
<p><br></p>
<p>日期：____年____月____日</p>`:""},u=(W=>{var Ne,me,oe,Ie,Re,Me,Oe,He,Z,Be,ze,nt,Qe,Dt,Xe,at,se,Ce,Je,Bt,rr,dr,yr,jt,zr,nr,Pr,ur,ja,ka,Cn,un,ra,En,Tn,na,ar,_a,Qr,bt,T,z,R,L,V,X,le,ge,ie,ce,de,Se;const E={projectInfo:{projectName:((me=(Ne=W==null?void 0:W.basicInfo)==null?void 0:Ne.projectInfo)==null?void 0:me.projectName)||"",projectNumber:((Ie=(oe=W==null?void 0:W.basicInfo)==null?void 0:oe.projectInfo)==null?void 0:Ie.projectNumber)||"",packageName:((Me=(Re=W==null?void 0:W.basicInfo)==null?void 0:Re.projectInfo)==null?void 0:Me.packageName)||"",packageNumber:((He=(Oe=W==null?void 0:W.basicInfo)==null?void 0:Oe.projectInfo)==null?void 0:He.packageNumber)||"",lotName:((Be=(Z=W==null?void 0:W.basicInfo)==null?void 0:Z.projectInfo)==null?void 0:Be.lotName)||"",lotNumber:((nt=(ze=W==null?void 0:W.basicInfo)==null?void 0:ze.projectInfo)==null?void 0:nt.lotNumber)||"",projectOverview:((Dt=(Qe=W==null?void 0:W.basicInfo)==null?void 0:Qe.projectInfo)==null?void 0:Dt.projectOverview)||"",budgetAmount:((at=(Xe=W==null?void 0:W.basicInfo)==null?void 0:Xe.projectInfo)==null?void 0:at.budgetAmount)||"",allowConsortium:((Ce=(se=W==null?void 0:W.basicInfo)==null?void 0:se.projectInfo)==null?void 0:Ce.allowConsortium)||""},tenderer:{name:((Bt=(Je=W==null?void 0:W.basicInfo)==null?void 0:Je.tenderer)==null?void 0:Bt.name)||"",contact:((dr=(rr=W==null?void 0:W.basicInfo)==null?void 0:rr.tenderer)==null?void 0:dr.contact)||"",email:((jt=(yr=W==null?void 0:W.basicInfo)==null?void 0:yr.tenderer)==null?void 0:jt.email)||"",address:((nr=(zr=W==null?void 0:W.basicInfo)==null?void 0:zr.tenderer)==null?void 0:nr.address)||"",zipCode:((ur=(Pr=W==null?void 0:W.basicInfo)==null?void 0:Pr.tenderer)==null?void 0:ur.zipCode)||""},agent:{name:((ka=(ja=W==null?void 0:W.basicInfo)==null?void 0:ja.agent)==null?void 0:ka.name)||"",contact:((un=(Cn=W==null?void 0:W.basicInfo)==null?void 0:Cn.agent)==null?void 0:un.contact)||"",email:((En=(ra=W==null?void 0:W.basicInfo)==null?void 0:ra.agent)==null?void 0:En.email)||"",address:((na=(Tn=W==null?void 0:W.basicInfo)==null?void 0:Tn.agent)==null?void 0:na.address)||"",zipCode:((_a=(ar=W==null?void 0:W.basicInfo)==null?void 0:ar.agent)==null?void 0:_a.zipCode)||""},keyTimeline:{bidDeadline:((bt=(Qr=W==null?void 0:W.basicInfo)==null?void 0:Qr.keyTimeline)==null?void 0:bt.bidDeadline)||"",submissionMethod:((z=(T=W==null?void 0:W.basicInfo)==null?void 0:T.keyTimeline)==null?void 0:z.submissionMethod)||"",openingTime:((L=(R=W==null?void 0:W.basicInfo)==null?void 0:R.keyTimeline)==null?void 0:L.openingTime)||"",openingLocation:((X=(V=W==null?void 0:W.basicInfo)==null?void 0:V.keyTimeline)==null?void 0:X.openingLocation)||""},bidBond:{submissionMethod:((ge=(le=W==null?void 0:W.basicInfo)==null?void 0:le.bidBond)==null?void 0:ge.submissionMethod)||"",amount:((ce=(ie=W==null?void 0:W.basicInfo)==null?void 0:ie.bidBond)==null?void 0:ce.amount)||"",refundPolicy:((Se=(de=W==null?void 0:W.basicInfo)==null?void 0:de.bidBond)==null?void 0:Se.refundPolicy)||""}};if(!W.documentDirectory)return{...W,basicInfo:E,documentDirectory:{summary:`请手动录入${a==="parsed"?"投标文件格式":"投标文件目录"}。`,files:[{name:"商务文件",items:[{title:"第一章",description:"请输入说明"}]}]}};if(W.documentDirectory.files){const Ee=q=>{const J=c(q.title),fe=q.contentFormat&&q.contentFormat.trim()||J,be={...q,contentFormat:fe};return q.children&&q.children.length>0&&(be.children=q.children.map(Ee)),be},U=W.documentDirectory.files.map(q=>({...q,items:q.items.map(Ee)}));return{...W,basicInfo:E,documentDirectory:{...W.documentDirectory,files:U}}}const ke=W.documentDirectory.commercial||"",pe=W.documentDirectory.technical||"",Ue=[];return ke.trim()&&Ue.push({name:"商务文件",items:ke.split(`
`).filter(Ee=>Ee.trim()).map(Ee=>{const U=Ee.trim();return{title:U,description:"",contentFormat:c(U)}})}),pe.trim()&&Ue.push({name:"技术文件",items:pe.split(`
`).filter(Ee=>Ee.trim()).map(Ee=>{const U=Ee.trim();return{title:U,description:"",contentFormat:c(U)}})}),Ue.length===0&&Ue.push({name:"商务文件",items:[{title:"第一章",description:"请输入说明"}]}),{...W,basicInfo:E,documentDirectory:{summary:"本次投标需要提交商务文件和技术文件。",files:Ue}}})(r),[d,f]=M.useState(u),[x,h]=M.useState(null),[p,m]=M.useState(!1),[w,v]=M.useState("basicInfo"),[b,y]=M.useState(!1),[N,F]=M.useState(new Set),[j,k]=M.useState({projectInfo:[],tenderer:[],agent:[],keyTimeline:[],bidBond:[]});console.log("BiddingProjectReview - initialData:",r),console.log("BiddingProjectReview - normalizedInitialData:",u),console.log("BiddingProjectReview - data.basicInfo.projectInfo:",d.basicInfo.projectInfo);const S=[{id:"basicInfo",label:"基础信息",icon:Pt},{id:"qualificationRequirements",label:"资格要求",icon:Zn},{id:"evaluationCriteria",label:"评审要求",icon:Zn},{id:"documentRequirements",label:"投标文件要求",icon:Pt},{id:"risks",label:"风险项/废标项",icon:Hn},{id:"documentDirectory",label:a==="parsed"?"投标文件格式":"投标文件目录",icon:Rd}],P=W=>{h(W)},D=()=>{h(null)},K=()=>{h(null),m(!0)},C=W=>{const E={id:`field_${Date.now()}`,label:"新增字段",value:""};k({...j,[W]:[...j[W],E]}),m(!0)},Y=(W,E,ke,pe)=>{k({...j,[W]:j[W].map(Ue=>Ue.id===E?{...Ue,[ke]:pe}:Ue)}),m(!0)},B=(W,E)=>{k({...j,[W]:j[W].filter(ke=>ke.id!==E)}),m(!0)},ee=()=>S.findIndex(W=>W.id===w),re=()=>ee()===S.length-1,Q=()=>{const W=ee(),E=new Set(N);E.add(w),F(E),re()?y(!0):v(S[W+1].id)},te=()=>{y(!1),l(d)},H=()=>{y(!1)},ae=(W,E)=>{const ke=x===W;return n.jsx("div",{className:"px-4 py-3 flex items-start gap-2",children:ke?n.jsxs(n.Fragment,{children:[n.jsx("input",{type:"text",value:E.label,onChange:pe=>Y(W,E.id,"label",pe.target.value),placeholder:"字段名称",className:"w-32 flex-shrink-0 px-3 py-1.5 text-sm border border-neutral-300 rounded focus:ring-2 focus:ring-primary-500 focus:border-primary-500"}),n.jsx("input",{type:"text",value:E.value,onChange:pe=>Y(W,E.id,"value",pe.target.value),placeholder:"字段值",className:"flex-1 px-3 py-1.5 text-sm border border-neutral-300 rounded focus:ring-2 focus:ring-primary-500 focus:border-primary-500"}),n.jsx("button",{onClick:()=>B(W,E.id),className:"flex-shrink-0 p-2 text-red-600 hover:text-red-800 hover:bg-red-50 rounded transition-colors",title:"删除",children:n.jsx(qe,{className:"w-4 h-4"})})]}):n.jsxs(n.Fragment,{children:[n.jsx("label",{className:"w-32 text-sm font-medium text-neutral-600 flex-shrink-0",children:E.label}),n.jsx("div",{className:"flex-1 text-sm text-neutral-900 whitespace-pre-wrap",children:E.value||n.jsx("span",{className:"text-neutral-400 italic",children:"未填写"})})]})},E.id)},he=(W,E,ke,pe,Ue="input",Ne=!1,me,oe=!1)=>{const Ie=x===pe,Re=Me=>{const Oe=Me.split(`
`).length,He=Math.ceil(Me.length/80);return Math.max(3,Math.min(15,Math.max(Oe,He)))};return n.jsxs("div",{className:"px-4 py-3 flex items-start gap-2",children:[!oe&&n.jsx("label",{className:"w-32 text-sm font-medium text-neutral-600 flex-shrink-0",children:W}),Ie?n.jsxs(n.Fragment,{children:[Ue==="textarea"?n.jsx("textarea",{value:E,onChange:Me=>ke(Me.target.value),rows:Re(E),className:`${oe?"w-full":"flex-1"} px-3 py-1.5 text-sm border border-neutral-300 rounded focus:ring-2 focus:ring-primary-500 focus:border-primary-500 font-mono`}):n.jsx("input",{type:"text",value:E,onChange:Me=>ke(Me.target.value),className:`${oe?"w-full":"flex-1"} px-3 py-1.5 text-sm border border-neutral-300 rounded focus:ring-2 focus:ring-primary-500 focus:border-primary-500`}),Ne&&me&&n.jsx("button",{onClick:me,className:"flex-shrink-0 p-2 text-red-600 hover:text-red-800 hover:bg-red-50 rounded transition-colors",title:"删除",children:n.jsx(qe,{className:"w-4 h-4"})})]}):n.jsx("div",{className:`${oe?"w-full":"flex-1"} text-sm text-neutral-900 whitespace-pre-wrap`,children:E})]})},O=(W,E,ke,pe=!1,Ue)=>{const Ne=x===E,me=a==="completed";return n.jsxs("div",{className:"border border-neutral-200 rounded-lg overflow-hidden",children:[n.jsxs("div",{className:"bg-neutral-50 px-4 py-3 border-b border-neutral-200 flex items-center justify-between",children:[n.jsx("h4",{className:"text-sm font-semibold text-neutral-900",children:W}),!me&&(Ne?n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsxs("button",{onClick:K,className:"text-green-600 hover:text-green-800 transition-colors flex items-center text-sm",children:[n.jsx(Gx,{className:"w-4 h-4 mr-1"}),"保存"]}),n.jsxs("button",{onClick:D,className:"text-neutral-600 hover:text-neutral-800 transition-colors flex items-center text-sm",children:[n.jsx(Ze,{className:"w-4 h-4 mr-1"}),"取消"]})]}):n.jsxs("button",{onClick:()=>P(E),className:"text-primary-600 hover:text-primary-800 transition-colors flex items-center text-sm",children:[n.jsx(Md,{className:"w-4 h-4 mr-1"}),"编辑"]}))]}),n.jsx("div",{className:"divide-y divide-neutral-200",children:ke}),Ne&&pe&&Ue&&n.jsx("div",{className:"px-4 py-3 border-t border-neutral-200 bg-neutral-50",children:n.jsxs("button",{onClick:Ue,className:"w-full px-4 py-2 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors flex items-center justify-center",children:[n.jsx(Ct,{className:"w-4 h-4 mr-1"}),"新增字段"]})})]})},I=()=>n.jsxs("div",{className:"p-6 space-y-6",children:[a!=="completed"&&n.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[n.jsx("h4",{className:"text-sm font-medium text-blue-900 mb-1",children:"核对提示"}),n.jsx("p",{className:"text-sm text-blue-700",children:'请仔细核对以下解析内容，如有错误或遗漏，请点击"编辑"按钮进行修改。'})]}),O("1. 项目信息","projectInfo",n.jsxs(n.Fragment,{children:[he("项目名称",d.basicInfo.projectInfo.projectName,W=>f({...d,basicInfo:{...d.basicInfo,projectInfo:{...d.basicInfo.projectInfo,projectName:W}}}),"projectInfo"),he("项目编号",d.basicInfo.projectInfo.projectNumber,W=>f({...d,basicInfo:{...d.basicInfo,projectInfo:{...d.basicInfo.projectInfo,projectNumber:W}}}),"projectInfo"),he("分标名称",d.basicInfo.projectInfo.packageName,W=>f({...d,basicInfo:{...d.basicInfo,projectInfo:{...d.basicInfo.projectInfo,packageName:W}}}),"projectInfo"),he("分标编号",d.basicInfo.projectInfo.packageNumber,W=>f({...d,basicInfo:{...d.basicInfo,projectInfo:{...d.basicInfo.projectInfo,packageNumber:W}}}),"projectInfo"),he("包名称",d.basicInfo.projectInfo.lotName,W=>f({...d,basicInfo:{...d.basicInfo,projectInfo:{...d.basicInfo.projectInfo,lotName:W}}}),"projectInfo"),he("包号",d.basicInfo.projectInfo.lotNumber,W=>f({...d,basicInfo:{...d.basicInfo,projectInfo:{...d.basicInfo.projectInfo,lotNumber:W}}}),"projectInfo"),he("招标控制价",d.basicInfo.projectInfo.budgetAmount,W=>f({...d,basicInfo:{...d.basicInfo,projectInfo:{...d.basicInfo.projectInfo,budgetAmount:W}}}),"projectInfo"),he("是否接受联合体投标",d.basicInfo.projectInfo.allowConsortium,W=>f({...d,basicInfo:{...d.basicInfo,projectInfo:{...d.basicInfo.projectInfo,allowConsortium:W}}}),"projectInfo"),he("项目概况",d.basicInfo.projectInfo.projectOverview,W=>f({...d,basicInfo:{...d.basicInfo,projectInfo:{...d.basicInfo.projectInfo,projectOverview:W}}}),"projectInfo","textarea"),j.projectInfo.map(W=>ae("projectInfo",W))]}),!0,()=>C("projectInfo")),O("2. 招标人信息","tenderer",n.jsxs(n.Fragment,{children:[he("招标人名称",d.basicInfo.tenderer.name,W=>f({...d,basicInfo:{...d.basicInfo,tenderer:{...d.basicInfo.tenderer,name:W}}}),"tenderer"),he("联系方式",d.basicInfo.tenderer.contact,W=>f({...d,basicInfo:{...d.basicInfo,tenderer:{...d.basicInfo.tenderer,contact:W}}}),"tenderer"),he("邮件",d.basicInfo.tenderer.email,W=>f({...d,basicInfo:{...d.basicInfo,tenderer:{...d.basicInfo.tenderer,email:W}}}),"tenderer"),he("地址",d.basicInfo.tenderer.address,W=>f({...d,basicInfo:{...d.basicInfo,tenderer:{...d.basicInfo.tenderer,address:W}}}),"tenderer"),he("邮编",d.basicInfo.tenderer.zipCode,W=>f({...d,basicInfo:{...d.basicInfo,tenderer:{...d.basicInfo.tenderer,zipCode:W}}}),"tenderer"),j.tenderer.map(W=>ae("tenderer",W))]}),!0,()=>C("tenderer")),O("3. 代理机构信息","agent",n.jsxs(n.Fragment,{children:[he("代理机构名称",d.basicInfo.agent.name,W=>f({...d,basicInfo:{...d.basicInfo,agent:{...d.basicInfo.agent,name:W}}}),"agent"),he("联系方式",d.basicInfo.agent.contact,W=>f({...d,basicInfo:{...d.basicInfo,agent:{...d.basicInfo.agent,contact:W}}}),"agent"),he("邮件",d.basicInfo.agent.email,W=>f({...d,basicInfo:{...d.basicInfo,agent:{...d.basicInfo.agent,email:W}}}),"agent"),he("地址",d.basicInfo.agent.address,W=>f({...d,basicInfo:{...d.basicInfo,agent:{...d.basicInfo.agent,address:W}}}),"agent"),he("邮编",d.basicInfo.agent.zipCode,W=>f({...d,basicInfo:{...d.basicInfo,agent:{...d.basicInfo.agent,zipCode:W}}}),"agent"),j.agent.map(W=>ae("agent",W))]}),!0,()=>C("agent")),O("4. 关键时间点及内容","keyTimeline",n.jsxs(n.Fragment,{children:[he("投标截止时间",d.basicInfo.keyTimeline.bidDeadline,W=>f({...d,basicInfo:{...d.basicInfo,keyTimeline:{...d.basicInfo.keyTimeline,bidDeadline:W}}}),"keyTimeline"),he("投标文件递交方式",d.basicInfo.keyTimeline.submissionMethod,W=>f({...d,basicInfo:{...d.basicInfo,keyTimeline:{...d.basicInfo.keyTimeline,submissionMethod:W}}}),"keyTimeline"),he("开标时间",d.basicInfo.keyTimeline.openingTime,W=>f({...d,basicInfo:{...d.basicInfo,keyTimeline:{...d.basicInfo.keyTimeline,openingTime:W}}}),"keyTimeline"),he("开标地点",d.basicInfo.keyTimeline.openingLocation,W=>f({...d,basicInfo:{...d.basicInfo,keyTimeline:{...d.basicInfo.keyTimeline,openingLocation:W}}}),"keyTimeline"),j.keyTimeline.map(W=>ae("keyTimeline",W))]}),!0,()=>C("keyTimeline")),O("5. 投标保证金","bidBond",n.jsxs(n.Fragment,{children:[he("递交方式",d.basicInfo.bidBond.submissionMethod,W=>f({...d,basicInfo:{...d.basicInfo,bidBond:{...d.basicInfo.bidBond,submissionMethod:W}}}),"bidBond"),he("金额",d.basicInfo.bidBond.amount,W=>f({...d,basicInfo:{...d.basicInfo,bidBond:{...d.basicInfo.bidBond,amount:W}}}),"bidBond"),he("退还规定",d.basicInfo.bidBond.refundPolicy,W=>f({...d,basicInfo:{...d.basicInfo,bidBond:{...d.basicInfo.bidBond,refundPolicy:W}}}),"bidBond","textarea"),j.bidBond.map(W=>ae("bidBond",W))]}),!0,()=>C("bidBond"))]}),g=()=>{const W=d.qualificationRequirements.split(`
`),E=W.length===1&&W[0].trim()===""?[]:W,ke=(Ne,me)=>{const oe=[...E];oe[Ne]=me,f({...d,qualificationRequirements:oe.join(`
`)})},pe=Ne=>{const me=E.filter((oe,Ie)=>Ie!==Ne);f({...d,qualificationRequirements:me.length>0?me.join(`
`):""})},Ue=()=>{const Ne=[...E,"新增资格要求"];f({...d,qualificationRequirements:Ne.join(`
`)})};return n.jsxs("div",{className:"p-6 space-y-4",children:[a!=="completed"&&n.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[n.jsx("h4",{className:"text-sm font-medium text-blue-900 mb-1",children:"核对提示"}),n.jsx("p",{className:"text-sm text-blue-700",children:'请仔细核对以下解析内容，如有错误或遗漏，请点击"编辑"按钮进行修改。'})]}),O("资格要求","qualificationRequirements",n.jsx(n.Fragment,{children:E.length===0?n.jsx("div",{className:"px-4 py-8 text-center text-neutral-500",children:'暂无资格要求，点击"新增字段"添加'}):E.map((Ne,me)=>he("",Ne,oe=>ke(me,oe),"qualificationRequirements","textarea",!0,()=>pe(me),!0))}),!0,Ue)]})},_=()=>{const W=d.evaluationCriteria.commercial.split(`
`),E=W.length===1&&W[0].trim()===""?[]:W,ke=d.evaluationCriteria.technical.split(`
`),pe=ke.length===1&&ke[0].trim()===""?[]:ke,Ue=(Me,Oe)=>{const He=[...E];He[Me]=Oe,f({...d,evaluationCriteria:{...d.evaluationCriteria,commercial:He.join(`
`)}})},Ne=Me=>{const Oe=E.filter((He,Z)=>Z!==Me);f({...d,evaluationCriteria:{...d.evaluationCriteria,commercial:Oe.length>0?Oe.join(`
`):""}})},me=()=>{const Me=[...E,"新增商务评分项"];f({...d,evaluationCriteria:{...d.evaluationCriteria,commercial:Me.join(`
`)}})},oe=(Me,Oe)=>{const He=[...pe];He[Me]=Oe,f({...d,evaluationCriteria:{...d.evaluationCriteria,technical:He.join(`
`)}})},Ie=Me=>{const Oe=pe.filter((He,Z)=>Z!==Me);f({...d,evaluationCriteria:{...d.evaluationCriteria,technical:Oe.length>0?Oe.join(`
`):""}})},Re=()=>{const Me=[...pe,"新增技术评分项"];f({...d,evaluationCriteria:{...d.evaluationCriteria,technical:Me.join(`
`)}})};return n.jsxs("div",{className:"p-6 space-y-4",children:[a!=="completed"&&n.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[n.jsx("h4",{className:"text-sm font-medium text-blue-900 mb-1",children:"核对提示"}),n.jsx("p",{className:"text-sm text-blue-700",children:'请仔细核对以下解析内容，如有错误或遗漏，请点击"编辑"按钮进行修改。'})]}),O("商务评分标准","evaluationCommercial",n.jsx(n.Fragment,{children:E.length===0?n.jsx("div",{className:"px-4 py-8 text-center text-neutral-500",children:'暂无商务评分标准，点击"新增字段"添加'}):E.map((Me,Oe)=>he("",Me,He=>Ue(Oe,He),"evaluationCommercial","textarea",!0,()=>Ne(Oe),!0))}),!0,me),O("技术评分标准","evaluationTechnical",n.jsx(n.Fragment,{children:pe.length===0?n.jsx("div",{className:"px-4 py-8 text-center text-neutral-500",children:'暂无技术评分标准，点击"新增字段"添加'}):pe.map((Me,Oe)=>he("",Me,He=>oe(Oe,He),"evaluationTechnical","textarea",!0,()=>Ie(Oe),!0))}),!0,Re)]})},A=()=>{const W=d.documentRequirements.split(`
`),E=W.length===1&&W[0].trim()===""?[]:W,ke=(Ne,me)=>{const oe=[...E];oe[Ne]=me,f({...d,documentRequirements:oe.join(`
`)})},pe=Ne=>{const me=E.filter((oe,Ie)=>Ie!==Ne);f({...d,documentRequirements:me.length>0?me.join(`
`):""})},Ue=()=>{const Ne=[...E,"新增投标文件要求"];f({...d,documentRequirements:Ne.join(`
`)})};return n.jsxs("div",{className:"p-6 space-y-4",children:[a!=="completed"&&n.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[n.jsx("h4",{className:"text-sm font-medium text-blue-900 mb-1",children:"核对提示"}),n.jsx("p",{className:"text-sm text-blue-700",children:'请仔细核对以下解析内容，如有错误或遗漏，请点击"编辑"按钮进行修改。'})]}),O("投标文件要求","documentRequirements",n.jsx(n.Fragment,{children:E.length===0?n.jsx("div",{className:"px-4 py-8 text-center text-neutral-500",children:'暂无投标文件要求，点击"新增字段"添加'}):E.map((Ne,me)=>he("",Ne,oe=>ke(me,oe),"documentRequirements","textarea",!0,()=>pe(me),!0))}),!0,Ue)]})},ne=()=>{const E=d.risks.split(`
`).filter(Me=>Me.trim()!==""),ke=[],pe=[];E.forEach(Me=>{const Oe=Me.trim();Oe.includes("废标")||Oe.includes("无效标")?pe.push(Oe):ke.push(Oe)});const Ue=(Me,Oe)=>{const He=[...ke];He[Me]=Oe;const Z=[...He,...pe];f({...d,risks:Z.join(`
`)})},Ne=Me=>{const He=[...ke.filter((Z,Be)=>Be!==Me),...pe];f({...d,risks:He.length>0?He.join(`
`):""})},me=()=>{const Oe=[...[...ke,"新增风险项"],...pe];f({...d,risks:Oe.join(`
`)})},oe=(Me,Oe)=>{const He=[...pe];He[Me]=Oe;const Z=[...ke,...He];f({...d,risks:Z.join(`
`)})},Ie=Me=>{const Oe=pe.filter((Z,Be)=>Be!==Me),He=[...ke,...Oe];f({...d,risks:He.length>0?He.join(`
`):""})},Re=()=>{const Me=[...pe,"新增废标项"],Oe=[...ke,...Me];f({...d,risks:Oe.join(`
`)})};return n.jsxs("div",{className:"p-6 space-y-4",children:[a!=="completed"&&n.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[n.jsx("h4",{className:"text-sm font-medium text-blue-900 mb-1",children:"核对提示"}),n.jsx("p",{className:"text-sm text-blue-700",children:'请仔细核对以下解析内容，如有错误或遗漏，请点击"编辑"按钮进行修改。'})]}),O("风险项","riskItems",n.jsx(n.Fragment,{children:ke.length===0?n.jsx("div",{className:"px-4 py-8 text-center text-neutral-500",children:'暂无风险项，点击"新增字段"添加'}):ke.map((Me,Oe)=>he("",Me,He=>Ue(Oe,He),"riskItems","textarea",!0,()=>Ne(Oe),!0))}),!0,me),O("废标项","invalidItems",n.jsx(n.Fragment,{children:pe.length===0?n.jsx("div",{className:"px-4 py-8 text-center text-neutral-500",children:'暂无废标项，点击"新增字段"添加'}):pe.map((Me,Oe)=>he("",Me,He=>oe(Oe,He),"invalidItems","textarea",!0,()=>Ie(Oe),!0))}),!0,Re)]})},ue=(W,E=0,ke,pe)=>{const Ue=x==="documentDirectory",Ne=E*24,me=(Re,Me)=>{const Oe=[...d.documentDirectory.files];let He=Oe[ke].items;for(let Z=0;Z<pe.length-1;Z++)He=He[pe[Z]].children;He[pe[pe.length-1]][Re]=Me,f({...d,documentDirectory:{...d.documentDirectory,files:Oe}})},oe=()=>{const Re=[...d.documentDirectory.files];let Me=Re[ke].items;for(let Oe=0;Oe<pe.length;Oe++)Oe===pe.length-1?(Me[pe[Oe]].children||(Me[pe[Oe]].children=[]),Me[pe[Oe]].children.push({title:"新增章节",description:"请输入说明"})):Me=Me[pe[Oe]].children;f({...d,documentDirectory:{...d.documentDirectory,files:Re}})},Ie=()=>{const Re=[...d.documentDirectory.files];let Me=Re[ke].items;if(pe.length===1)Re[ke].items.splice(pe[0],1);else{for(let Oe=0;Oe<pe.length-1;Oe++)Me=Me[pe[Oe]].children;Me.splice(pe[pe.length-1],1)}f({...d,documentDirectory:{...d.documentDirectory,files:Re}})};return n.jsxs("div",{className:"mb-2",children:[n.jsx("div",{style:{paddingLeft:`${Ne}px`},className:"border-l-2 border-neutral-200 pl-3",children:Ue?n.jsxs("div",{className:"space-y-2 bg-neutral-50 p-3 rounded border border-neutral-200",children:[n.jsxs("div",{className:"flex items-start gap-2",children:[n.jsx("input",{type:"text",value:W.title,onChange:Re=>me("title",Re.target.value),className:"flex-1 px-2 py-1 text-sm border border-neutral-300 rounded focus:ring-2 focus:ring-primary-500 focus:border-primary-500 font-medium",placeholder:"章节标题"}),n.jsx("button",{onClick:oe,className:"p-1 text-green-600 hover:bg-green-50 rounded",title:"添加子章节",children:n.jsx(Ct,{className:"w-4 h-4"})}),E>0&&n.jsx("button",{onClick:Ie,className:"p-1 text-red-600 hover:bg-red-50 rounded",title:"删除章节",children:n.jsx(qe,{className:"w-4 h-4"})})]}),n.jsx("textarea",{value:W.description,onChange:Re=>me("description",Re.target.value),rows:2,className:"w-full px-2 py-1 text-xs text-neutral-600 border border-neutral-300 rounded focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"说明"}),a==="parsed"&&n.jsxs("div",{className:"space-y-2",children:[n.jsx("label",{className:"text-xs font-medium text-neutral-700",children:"内容格式："}),n.jsx(YE,{value:W.contentFormat||"",onChange:Re=>me("contentFormat",Re),placeholder:"输入内容格式要求（支持富文本格式）..."})]})]}):n.jsxs("div",{children:[n.jsx("div",{className:"font-medium text-sm text-neutral-900",children:W.title}),W.description&&n.jsxs("div",{className:"text-xs text-neutral-600 mt-0.5",children:["说明：",W.description]}),a==="parsed"&&n.jsxs("div",{className:"mt-2 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("div",{className:"text-xs font-medium text-blue-900",children:"内容格式："}),W.contentFormat&&W.contentFormat.replace(/<[^>]*>/g,"").trim()&&n.jsx("span",{className:"text-xs text-blue-600 bg-blue-100 px-2 py-0.5 rounded",children:"已设置格式要求"})]}),W.contentFormat&&W.contentFormat.replace(/<[^>]*>/g,"").trim()?n.jsx("div",{className:"text-xs text-neutral-800 prose prose-sm max-w-none bg-white p-3 rounded border border-blue-100",style:{lineHeight:"1.6"},dangerouslySetInnerHTML:{__html:W.contentFormat}}):n.jsx("div",{className:"text-xs text-blue-600 italic bg-blue-100 p-2 rounded text-center",children:"暂无格式要求"})]})]})}),W.children&&W.children.length>0&&n.jsx("div",{className:"mt-2",children:W.children.map((Re,Me)=>ue(Re,E+1,ke,[...pe,Me]))})]},pe.join("-"))},ve=()=>{const W=x==="documentDirectory";if(!d.documentDirectory||!d.documentDirectory.files)return n.jsx("div",{className:"p-6",children:n.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:n.jsxs("p",{className:"text-sm text-red-700",children:[a==="parsed"?"投标文件格式":"投标文件目录","数据格式错误，请重新解析或手动录入。"]})})});const E=()=>{const Ne=[...d.documentDirectory.files,{name:"新文件",items:[{title:"第一章",description:"请输入说明"}]}];f({...d,documentDirectory:{...d.documentDirectory,files:Ne}})},ke=Ne=>{const me=d.documentDirectory.files.filter((oe,Ie)=>Ie!==Ne);f({...d,documentDirectory:{...d.documentDirectory,files:me}})},pe=(Ne,me)=>{const oe=[...d.documentDirectory.files];oe[Ne].name=me,f({...d,documentDirectory:{...d.documentDirectory,files:oe}})},Ue=Ne=>{const me=[...d.documentDirectory.files];me[Ne].items.push({title:"新增章节",description:"请输入说明"}),f({...d,documentDirectory:{...d.documentDirectory,files:me}})};return n.jsxs("div",{className:"p-6 space-y-4",children:[a!=="completed"&&n.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[n.jsx("h4",{className:"text-sm font-medium text-blue-900 mb-1",children:"核对提示"}),n.jsxs("p",{className:"text-sm text-blue-700",children:['请仔细核对以下解析内容，如有错误或遗漏，请点击"编辑"按钮进行修改。如果招标文件中没有提供',a==="parsed"?"投标文件格式":"投标文件目录","，请手动录入。"]})]}),n.jsxs("div",{className:"border border-neutral-200 rounded-lg overflow-hidden",children:[n.jsxs("div",{className:"bg-neutral-50 px-4 py-3 border-b border-neutral-200 flex items-center justify-between",children:[n.jsx("h4",{className:"text-sm font-semibold text-neutral-900",children:a==="parsed"?"投标文件格式":"投标文件目录"}),!a||a!=="completed"?W?n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsxs("button",{onClick:K,className:"text-green-600 hover:text-green-800 transition-colors flex items-center text-sm",children:[n.jsx(Gx,{className:"w-4 h-4 mr-1"}),"保存"]}),n.jsxs("button",{onClick:D,className:"text-neutral-600 hover:text-neutral-800 transition-colors flex items-center text-sm",children:[n.jsx(Ze,{className:"w-4 h-4 mr-1"}),"取消"]})]}):n.jsxs("button",{onClick:()=>P("documentDirectory"),className:"text-primary-600 hover:text-primary-800 transition-colors flex items-center text-sm",children:[n.jsx(Md,{className:"w-4 h-4 mr-1"}),"编辑"]}):null]}),n.jsxs("div",{className:"p-4 space-y-4",children:[n.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded p-3",children:n.jsx("div",{className:"text-sm text-amber-900 whitespace-pre-wrap",children:d.documentDirectory.summary})}),d.documentDirectory.files.map((Ne,me)=>n.jsxs("div",{className:"border border-neutral-300 rounded-lg overflow-hidden",children:[n.jsxs("div",{className:"bg-neutral-100 px-3 py-2 flex items-center justify-between",children:[W?n.jsx("input",{type:"text",value:Ne.name,onChange:oe=>pe(me,oe.target.value),className:"flex-1 px-2 py-1 text-sm font-semibold border border-neutral-300 rounded focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"文件名称"}):n.jsx("h5",{className:"text-sm font-semibold text-neutral-900",children:Ne.name}),W&&n.jsxs("div",{className:"flex items-center gap-2 ml-2",children:[n.jsx("button",{onClick:()=>Ue(me),className:"p-1 text-green-600 hover:bg-green-50 rounded text-xs",title:"添加章节",children:n.jsx(Ct,{className:"w-4 h-4"})}),d.documentDirectory.files.length>1&&n.jsx("button",{onClick:()=>ke(me),className:"p-1 text-red-600 hover:bg-red-50 rounded text-xs",title:"删除文件",children:n.jsx(qe,{className:"w-4 h-4"})})]})]}),n.jsx("div",{className:"p-3 space-y-2",children:Ne.items.map((oe,Ie)=>ue(oe,0,me,[Ie]))})]},me)),W&&n.jsxs("button",{onClick:E,className:"w-full py-2 border-2 border-dashed border-neutral-300 rounded-lg text-neutral-600 hover:border-primary-500 hover:text-primary-600 transition-colors flex items-center justify-center gap-2",children:[n.jsx(Ct,{className:"w-4 h-4"}),"添加文件"]})]})]})]})},xe=()=>{switch(w){case"basicInfo":return I();case"qualificationRequirements":return g();case"evaluationCriteria":return _();case"documentRequirements":return A();case"risks":return ne();case"documentDirectory":return ve();default:return I()}};return n.jsxs("div",{className:"flex flex-col h-full",children:[n.jsx("div",{className:"bg-white border-b border-neutral-200 px-6 py-4",children:n.jsxs("div",{className:"flex items-center space-x-4",children:[n.jsx("button",{onClick:s,className:"text-neutral-600 hover:text-neutral-900 transition-colors",children:n.jsx(yi,{className:"w-6 h-6"})}),n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsx("h2",{className:"text-lg font-medium text-neutral-900",children:t}),n.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"已解析"})]}),n.jsx("p",{className:"text-sm text-neutral-500",children:"核对解析内容"})]})]})}),n.jsx("div",{className:"bg-white border-b border-neutral-200",children:n.jsx("div",{className:"flex overflow-x-auto",children:S.map(W=>{const E=W.icon,ke=N.has(W.id);return n.jsxs("button",{onClick:()=>v(W.id),className:`flex items-center space-x-2 px-6 py-3 border-b-2 transition-colors whitespace-nowrap relative ${w===W.id?"border-primary-600 text-primary-600":"border-transparent text-neutral-600 hover:text-neutral-900 hover:border-neutral-300"}`,children:[n.jsx(E,{className:"w-4 h-4"}),n.jsx("span",{className:"text-sm font-medium",children:W.label}),ke&&a!=="completed"&&n.jsx(Zn,{className:"w-4 h-4 text-green-600"})]},W.id)})})}),n.jsx("div",{className:"flex-1 overflow-auto",children:xe()}),n.jsxs("div",{className:"bg-white border-t border-neutral-200 px-6 py-4 flex justify-between gap-2",children:[n.jsx("button",{onClick:s,className:"px-4 py-2 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-100 transition-colors",children:"返回上一级"}),a!=="completed"&&n.jsx("button",{onClick:Q,className:"px-6 py-2 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors",children:re()?"核对完成":"下一级"})]}),b&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4",children:[n.jsx("div",{className:"px-6 py-4 border-b border-neutral-200",children:n.jsx("h3",{className:"text-lg font-semibold text-neutral-900",children:"确认核对完成"})}),n.jsxs("div",{className:"px-6 py-4",children:[n.jsx("p",{className:"text-neutral-700 mb-4",children:"所有页面已核对完成。确认后将无法再次修改解析内容，请确保所有信息已核对无误。"}),n.jsxs("p",{className:"text-sm text-amber-600 flex items-start",children:[n.jsx(Hn,{className:"w-4 h-4 mr-2 mt-0.5 flex-shrink-0"}),n.jsx("span",{children:"此操作不可撤销，是否确认提交？"})]})]}),n.jsxs("div",{className:"px-6 py-4 border-t border-neutral-200 flex justify-end gap-3",children:[n.jsx("button",{onClick:H,className:"px-4 py-2 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-50 transition-colors",children:"取消"}),n.jsx("button",{onClick:te,className:"px-4 py-2 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors",children:"确认提交"})]})]})})]})},nh=({canEdit:e=!0,canDelete:t=!0})=>{const r="bidding_projects_v8",[a,s]=M.useState(()=>(["bidding_projects_v7","bidding_projects_v6","bidding_projects_v5","bidding_projects_v4","bidding_projects_v3","bidding_projects_v2","bidding_projects_v1","bidding_projects"].forEach(b=>{localStorage.removeItem(b)}),[{id:"5",projectName:"城市轨道交通信号系统项目",status:"parsing",uploadTime:"2025-10-13 10:15:00",fileName:"城市轨道交通信号系统招标文件.pdf",parseProgress:65},{id:"4",projectName:"软件系统开发项目",status:"failed",uploadTime:"2025-10-12 11:00:00",fileName:"软件开发招标文件.pdf",parseProgress:0,errorMessage:"文件格式不支持或文件已损坏，请重新上传"},{id:"2",projectName:"办公楼智能化系统集成项目",status:"parsed",uploadTime:"2025-10-11 14:20:00",fileName:"办公楼智能化招标文件.pdf",parseProgress:100,parsedData:{basicInfo:{projectInfo:{projectName:"办公楼智能化系统集成项目",projectNumber:"ZFCG-2025-088",packageName:"智能化系统集成服务包",packageNumber:"FB-01",lotName:"第一标段",lotNumber:"BD-01",projectOverview:"本项目旨在对办公楼进行智能化系统集成改造，包括楼宇自控系统、安防监控系统、综合布线系统、计算机网络系统、会议系统等多个子系统的设计、采购、安装、调试及培训。项目建设内容涵盖智能照明控制、空调新风控制、电梯监控、门禁系统、视频监控、周界报警、停车管理等功能模块。预计建设周期3个月，分为方案设计、设备采购、现场施工、系统调试、竣工验收五个阶段。",budgetAmount:"人民币 800 万元",allowConsortium:"本项目不接受联合体投标"},tenderer:{name:"某某科技园管理委员会",contact:"王主任 / 0755-12345678",email:"wangzr@techpark.gov.cn",address:"深圳市南山区高新技术产业园区科技路100号",zipCode:"518057"},agent:{name:"深圳建信招标代理有限公司",contact:"李经理 / 0755-87654321",email:"lijl@jxbidding.com",address:"深圳市福田区深南大道1000号招商银行大厦20层",zipCode:"518040"},keyTimeline:{bidDeadline:"2025年10月28日 09:30:00（北京时间）",submissionMethod:"现场递交纸质投标文件正副本各一套，同时提交电子版U盘",openingTime:"2025年10月28日 10:00:00（北京时间）",openingLocation:"深圳市南山区高新技术产业园区管委会开标室（主楼5楼503室）"},bidBond:{submissionMethod:"银行转账、银行保函或保险保函（任选其一）",amount:"人民币 80 万元整（¥800,000.00）",refundPolicy:`1. 未中标单位的投标保证金在中标通知书发出后5个工作日内无息退还；
2. 中标单位的投标保证金在签订合同并缴纳履约保证金后5个工作日内无息退还；
3. 投标保证金账户信息：
   开户名称：深圳建信招标代理有限公司
   开户银行：招商银行深圳分行福田支行
   账号：7559 1234 5678 9012
   用途：项目编号-ZFCG-2025-088+投标单位名称`}},qualificationRequirements:`1. 具有独立承担民事责任的能力（提供有效的营业执照或事业单位法人证书）
2. 具有良好的商业信誉和健全的财务会计制度（提供2024年度财务审计报告）
3. 具有建筑智能化工程专业承包一级资质或电子与智能化工程专业承包一级资质
4. 注册资本不低于2000万元人民币
5. 具有ISO9001质量管理体系认证证书
6. 参加政府采购活动前三年内，在经营活动中没有重大违法记录（提供声明函）
7. 近三年内至少完成过2个类似智能化系统集成项目，单个合同金额不低于500万元（提供合同复印件及竣工验收证明）
8. 拟派项目经理须具有建造师一级资质或高级工程师职称，且具有智能化系统项目管理经验`,evaluationCriteria:{commercial:`一、履约能力评价（17-27）
1. 经营状况（1-5）：对企业经营状况进行综合评价：企业资产运营能力、履约能力强，整体经营状况优良【4-5分】；企业资产运营能力、履约能力较强，整体经营状况较好【2-3.5分】；企业资产运营能力、履约能力一般，整体经营状况一般【1-1.5分】。
2. 售后服务（1-5）：对企业售后服务能力进行综合评价：企业售后服务响应时间、售后服务团队、培训、相关保障措施等优良【4-5分】；企业售后服务响应时间、售后服务团队、培训、相关保障措施等较好【2-3.5分】；企业售后服务响应时间、售后服务团队、培训、相关保障措施等一般【1-1.5分】。
3. 应急保供（15-17）：对应急抢险保电物资供应能力进行综合评价：作出突出贡献的【17分】；其余情况【15分】。
二、高质量发展评价（36-65）
1. 绿色发展规划（3-5）：对企业的绿色发展顶层规划及执行情况进行综合评价：建立了科学合理的绿色发展顶层规划并执行优秀【5分】；建立了科学合理的绿色发展顶层规划并执行良好【4分】；建立了科学合理的绿色发展顶层规划并执行一般【3分】。
2. 绿色管理体系认证（3-5）：对国家级能源管理体系、质量管理体系、职业健康安全管理体系及环境管理体系证书认证情况进行评价：取得4项认证【5分】；取得1-3项认证【4分】；其他情况得【3分】。
3. 环境影响评价（3-5）：对企业发布ESG（环境、社会和公司治理）报告，取得环评/能评报告，取得废水/废气/废固报告情况进行评价：具有2类/3类报告【5分】；具有1类报告【4分】；其他情况【3分】。
4. 绿电绿证（3-4）：对企业取得绿色电力证书情况进行评价：取得证书或凭证【4分】；其他情况【3分】。
5. 绿色低碳认证（3-5）：对企业绿码、绿色工厂、绿色供应链管理企业的国家级认证情况进行评价：取得2项及以上认证【5分】；取得1项认证的【4分】；其他情况【3分】。
6. 企业创新成果（5-7）：对企业取得的科技成果情况进行综合评价：企业近3年取得过国家级科技创新成果【7分】；企业近3年取得过省级科技创新成果【6分】；其他情况【5分】。
7. 研发团队规模（4-6）：对企业拥有高级及以上职称人员和高级技师人员数量进行评价：拥有高级及以上职称人员和高级技师人员X≥30人【6分】；拥有高级及以上职称人员和高级技师人员15≤X＜30人【5分】；拥有高级及以上职称人员和高级技师人员X＜15人【4分】。
8. 科研经费占比（3-5）：对企业近3年科研经费占比进行评价：企业近3年任一年研发投入占比达2%以上【5分】；企业近3年有研发投入【4分】；企业近3年无研发投入【3分】。
9. 高新技术企业（0-2）：对企业获得国家级高新技术企业证书进行评价：获得国家级高新技术企业证书【2分】；未取得【0分】。
10. 创新激励机制、供应链保障措施（3-5）：对企业制定创新激励相关政策和机制的情况，有效应对供应链外部系统风险，积极响应落实国家激励或扶持政策，制定供应链保障措施的情况进行综合评价:优秀【5分】；良好【4分】；一般【3分】。
11. 数智化评价（6-8）：对"数字领航"企业、智能制造示范工厂、智能制造优秀场景的国家级认定情况进行评价：取得"数字领航"企业或智能制造示范工厂【8分】；取得智能制造优秀场景【7分】；其他情况得【6分】。
12. 未来工厂、智能工厂、数字化车间（0-3）：对国家级"智能工厂"、"数字化车间"、"未来工厂"认定情况进行评价：取得3项【3分】；取得2项【2分】；取得1项【1分】；未取得【0分】。
13. 中国质量奖（0-2）：对企业获得国家级质量奖情况进行评价：获得国家级质量奖【2分】；未获得【0分】。
14. 专精特新认定（0-1）：对企业"专精特新企业"认定情况进行评价：被国家或地方政府部门认定为专精特新企业的【1分】；未获得【0分】。
15. 实体清单应对举措（0-2）：对积极应对国际贸易壁垒，成功获得国家财政补贴、税收优惠、融资支持等政府帮助和扶持的企业，在招标过程中提供相应证明材料（包括但不限于应对国际贸易壁垒举措、补贴批文、税收优惠证明、融资协议等）进行评价：取得2项【2分】；取得1项【1分】；未取得【0分】。
三、投标响应（4-8）
1. 报价质量（4-8）：对报价文件完整性、准确性、规范性、合理性进行综合评审：报价文件响应情况良好【8分】；报价文件响应情况一般【6分】；报价文件响应情况较差【4分】。
四、诚信评价（-65-0）
1. 不良行为处理情况通报（-30-0）：不存在《国家电网有限公司供应商关系管理办法》中规定的不良行为，或存在《国家电网有限公司供应商关系管理办法》中规定的不良行为，但最近一次受到供应商不良行为处理解除之日，距离投标截止日超过3年【不扣分】；至本项目投标截止日，存在《国家电网有限公司供应商关系管理办法》中规定的不良行为，且最近一次受到供应商不良行为处理解除之日，距离投标截止日超过2年但在3年以内（含）【扣5分】，其中，存在行贿行为的【扣10分】；至本项目投标截止日，存在《国家电网有限公司供应商关系管理办法》中规定的不良行为，且最近一次受到供应商不良行为处理解除之日，距离投标截止日超过1年但在2年以内（含）【扣10分】，其中，存在行贿行为的【扣20分】；至本项目投标截止日，存在《国家电网有限公司供应商关系管理办法》中规定的不良行为，且最近一次受到供应商不良行为处理解除之日，距离投标截止日1年以内（含）【扣15分】，其中，存在行贿行为的【扣30分】。
2. 公共信用信息报告、企业信用信息公示报告（-10-0）：不存在失信行为，或存在质量、诚信、环境行政处罚以外失信行为，情节轻微，行政处罚罚款累计在1万元以下【不扣分】；存在质量、诚信、环境行政处罚以外失信行为，行政处罚罚款累计在1万元及以上30万元以下【扣5分】；存在质量、诚信失信行为，或存在质量、诚信、环境行政处罚以外失信行为，但未纳入失信黑名单，行政处罚罚款累计在30万元及以上【扣10分】。
3. 影响评标工作公正性行为的凭证（-20-0）：投标截止日近一年内，经查证核实，投标人存在打招呼、请托关照等可能影响评标工作公正性行为【扣20分】；【无上述行为的，不扣分】。
4. 环保行政处罚（-5-0）：公共信用信息报告、企业信用信息公示报告中存在环境行政处罚的【扣5分】；【无上述处罚的，不扣分】。`,technical:`一、技术水平（30-50）
1. 企业品牌（5-15）：按照企业品牌知名程度分为三档，非常知名品牌15分；比较知名品牌10分；一般知名品牌5分。
2. 产品参数（25-35）：核心参数优于招标文件内设备材料性能指标的:31~35分；一般参数优于招标文件内设备材料性能指标的：26~30分；仅满足招标文件内设备材料性能指标的：25分。
二、市场业绩（12-20）
1. 供货业绩（6-10）：供货业绩高于资质要求的基本供货业绩80%以上的（含80%）:9~10分；供货业绩高于资质要求的基本供货业绩50～80%之间的（含50%）：7~8分；供货业绩高于资质要求的基本供货业绩50%以内的：6分。
2. 运行情况（6-10）：运行情况优秀:9~10分；运行情况良好：7~8分；运行情况一般：6分。
三、资源实力（6-10）
1. 5M1E（人力、设备、工艺、材料、检测、环境）（6-8）：高于招标文件要求:8分；等同于招标文件要求：7分；略有差异，但基本满足招标文件要求：6分。
2. 绿色数智（0-2）：在生产制造过程中统筹考虑环境保护措施，各工序实现能源降耗，资源利用率高、清洁生产工艺，利用互联网和物联网技术提升数智制造水平，应用智能化设计手段、建设智能化生产线或智能车间、构建数字化智能化生产管理体系，强化设备质量管控能力，推进高端制造转型升级的等情况。
四、组件材料（6-10）
1. 外购外协组件材料优秀可靠水平（6-10）：主要原材料或主要部件高于招标文件要求:10分；主要原材料或主要部件等同于招标文件要求：8分；主要原材料或主要部件略有差异，但基本满足招标文件要求：6分。
五、服务合作（6-10）
1. 现场安装调试服务、售后服务、履约评价（6-10）：现场安装及售后服务良好，履约情况良好:9~10分；现场安装及售后服务一般，履约情况一般：7~8分；现场安装及售后服务较差，履约情况较差：6分。`},documentRequirements:`1. 投标文件需包含商务标和技术标两个部分，分别独立密封包装
2. 采用A4纸打印，双面打印，左侧装订成册
3. 商务标：正本1份，副本3份；技术标：正本1份，副本3份
4. 电子版U盘2份（PDF格式，不得加密，需与纸质版完全一致）
5. 投标文件需使用不透明密封袋密封，并在封口处加盖投标人公章骑缝章
6. 封面需标注：项目名称、项目编号、投标人名称、商务标/技术标标识
7. 投标文件每页需加盖投标人公章（骑缝章）或在目录、封面、封底加盖公章
8. 所有证明材料需提供原件备查或加盖公章的彩色复印件
9. 报价表需单独密封提交，在开标现场唱标时当众拆封`,risks:`1. 投标文件逾期送达或未按要求密封的将被拒收，不得进入开标环节
2. 投标保证金未按时到账或金额不足的视为无效投标
3. 投标文件出现以下情况将作废标处理：
   - 未按规定格式填写、内容不全或关键字迹模糊导致无法辨认
   - 投标人名称或组织结构与营业执照、资质证书不一致
   - 投标文件未加盖公章或关键内容（投标函、报价表等）未签字盖章
   - 报价超过招标控制价或低于成本价
   - 同一投标人提交两个或以上不同的投标文件
   - 不同投标人的投标文件出现实质性雷同（IP地址相同、编制人相同等）
4. 项目工期紧张，必须在3个月内完成全部施工、调试及验收工作
5. 涉及楼宇自控、安防、网络等多个专业子系统，各系统需深度集成联动
6. 需与现有办公自动化系统、物业管理系统进行数据对接，接口兼容性要求高
7. 施工期间办公楼正常使用，需采取分区域分时段施工，不得影响日常办公
8. 投标人不得串通投标、弄虚作假、行贿等违法行为，一经发现将取消投标资格并记入不良行为记录`,documentDirectory:{summary:"根据招标文件要求，本次投标需要提交3个文件：商务文件、技术文件、授权委托书。",files:[{name:"商务文件",items:[{title:"一、资格证明文件",description:"提供企业资质、营业执照等证明文件",children:[{title:"1.1 营业执照副本",description:"提供有效期内的营业执照副本复印件并加盖公章"},{title:"1.2 资质证书",description:"提供建筑智能化工程专业承包一级资质证书复印件并加盖公章"}]},{title:"二、商务响应文件",description:"投标函及相关商务文件",children:[{title:"2.1 投标函",description:"按照招标文件格式填写投标函"},{title:"2.2 法定代表人授权书",description:"如非法定代表人签字，需提供授权书原件"},{title:"2.3 投标保证金",description:"提供投标保证金缴纳凭证"}]},{title:"三、报价文件",description:"投标报价及说明",children:[{title:"3.1 投标报价表",description:"按照招标文件格式填写报价表"},{title:"3.2 报价说明",description:"对报价进行详细说明，包括费用构成等"}]}]},{name:"技术文件",items:[{title:"一、技术方案",description:"整体技术解决方案",children:[{title:"1.1 技术方案总体设计",description:"描述整体技术架构和设计思路"},{title:"1.2 综合布线系统方案",description:"详细说明综合布线系统的设计和实施方案"},{title:"1.3 安防监控系统方案",description:"详细说明安防监控系统的设计和实施方案"}]},{title:"二、实施方案",description:"项目实施计划",children:[{title:"2.1 施工组织设计",description:"详细的施工组织设计方案"},{title:"2.2 施工进度计划",description:"项目施工进度安排及里程碑"},{title:"2.3 质量保证措施",description:"确保项目质量的具体措施"}]},{title:"三、售后服务",description:"售后服务及培训",children:[{title:"3.1 售后服务方案",description:"详细的售后服务承诺和措施"},{title:"3.2 培训方案",description:"针对使用方的培训计划"}]}]},{name:"授权委托书",items:[{title:"法定代表人授权委托书",description:"如非法定代表人参加投标，需提供授权委托书原件，明确授权范围和期限"}]}]}}},{id:"1",projectName:"市政道路改造工程项目",status:"pending",uploadTime:"2025-10-10 09:30:00",fileName:"市政道路改造工程招标文件.pdf"},{id:"3",projectName:"医院设备采购项目",status:"parsed",uploadTime:"2025-10-09 16:45:00",fileName:"医院设备采购招标文件.pdf",parseProgress:100,parsedData:{basicInfo:{tenderer:"市中心医院",agent:"某某招标代理有限公司",projectInfo:"医疗设备采购及安装",keyTimeline:"投标截止：2025-10-25 09:00",bidBond:"50万元"},qualificationRequirements:"具有医疗器械经营许可证，注册资金不低于500万元",evaluationCriteria:{commercial:"价格分40分，商务分20分",technical:"技术方案30分，售后服务10分"},documentRequirements:"营业执照、资质证书、业绩证明等",risks:"交货期较紧，需注意设备进口周期",documentDirectory:{summary:"本次投标需要提交2个文件：商务文件、技术文件。",files:[{name:"商务文件",items:[{title:"第一章 投标函",description:"按照规定格式填写投标函"},{title:"第二章 报价清单",description:"详细列明设备清单及报价"},{title:"第三章 商务文件",description:"营业执照、资质证书等商务文件"}]},{name:"技术文件",items:[{title:"第一章 技术方案",description:"设备技术参数及配置方案"},{title:"第二章 实施计划",description:"设备安装及调试计划"},{title:"第三章 售后服务",description:"售后服务承诺及保障措施"}]}]}}},{id:"5",projectName:"城市绿化景观工程",status:"completed",uploadTime:"2025-10-08 10:15:00",fileName:"城市绿化景观招标文件.pdf",parseProgress:100,parsedData:{basicInfo:{tenderer:"市园林局",agent:"市政工程招标中心",projectInfo:"公园景观提升改造工程",keyTimeline:"投标截止：2025-10-20 14:00",bidBond:"30万元"},qualificationRequirements:"园林绿化一级资质，近三年完成类似项目不少于2个",evaluationCriteria:{commercial:"价格分50分，商务分10分",technical:"设计方案30分，施工组织10分"},documentRequirements:"资质证书、项目经理证书、类似业绩",risks:"雨季施工影响，需做好应急预案",documentDirectory:{summary:"本次投标需要提交2个文件：商务文件、技术文件。",files:[{name:"商务文件",items:[{title:"第一章 投标函",description:"投标函及投标函附录"},{title:"第二章 工程量清单",description:"已标价工程量清单"},{title:"第三章 商务资料",description:"营业执照、资质证书等"}]},{name:"技术文件",items:[{title:"第一章 施工方案",description:"施工组织设计及方案"},{title:"第二章 进度计划",description:"施工进度计划安排"},{title:"第三章 质量保证",description:"质量保证措施及承诺"}]}]}}}])),[i,l]=M.useState("list"),[c,o]=M.useState(null);M.useEffect(()=>{localStorage.setItem(r,JSON.stringify(a))},[a]);const u=(b,y)=>{const N=y.map(j=>j.name).join(", "),F={id:String(Date.now()),projectName:b,status:"parsing",uploadTime:new Date().toISOString().slice(0,19).replace("T"," "),fileName:N,parseProgress:0};s([...a,F]),o(F),l("parsing")},d=b=>{if(c){const y={...c,status:"parsed",parseProgress:100,parsedData:b};s(a.map(N=>N.id===c.id?y:N)),o(y),l("review")}},f=b=>{if(c){const y={...c,parsedData:b};s(a.map(N=>N.id===c.id?y:N)),o(y)}},x=b=>{if(c){const y={...c,status:"completed",parsedData:b};s(a.map(N=>N.id===c.id?y:N)),l("list"),o(null)}},h=()=>{l("list"),o(null)},p=b=>{o(b),b.status==="pending"||b.status==="failed"?l("upload"):b.status==="parsing"?l("parsing"):(b.status==="parsed"||b.status==="completed")&&l("review")},m=b=>{s(a.filter(y=>y.id!==b))},w=b=>{const y={...b,status:"parsing",parseProgress:0,errorMessage:void 0};s(a.map(N=>N.id===b.id?y:N)),o(y),l("parsing")},v=b=>{const y={projectName:b.projectName,uploadTime:b.uploadTime,parsedData:b.parsedData},N=JSON.stringify(y,null,2),F=new Blob([N],{type:"application/json"}),j=URL.createObjectURL(F),k=document.createElement("a");k.href=j,k.download=`${b.projectName}_解析文件.json`,document.body.appendChild(k),k.click(),document.body.removeChild(k),URL.revokeObjectURL(j)};return i==="upload"?n.jsx(XE,{onBack:h,onStartParsing:u,initialProjectName:c==null?void 0:c.projectName,initialFileName:c==null?void 0:c.fileName}):i==="parsing"&&c?n.jsx(KE,{projectId:c.id,projectName:c.projectName,onBack:h,onParsingComplete:d}):i==="review"&&c&&c.parsedData?n.jsx(qE,{projectId:c.id,projectName:c.projectName,initialData:c.parsedData,projectStatus:c.status,onBack:h,onSave:f,onConfirm:x}):n.jsx(GE,{projects:a,onUploadClick:()=>l("upload"),onViewProject:p,onDeleteProject:m,onReparse:w,onDownloadProject:v,onGenerateDocument:b=>{b&&(localStorage.setItem("preselected_bidding_project",JSON.stringify(b)),window.dispatchEvent(new CustomEvent("navigate-to-generate")))}})},JE=({documents:e,onCreateClick:t,onViewDocument:r,onEditDocument:a,onDeleteDocument:s,onDownloadDocument:i})=>{const[l,c]=M.useState(""),[o,u]=M.useState(""),[d,f]=M.useState("all"),[x,h]=M.useState(1),[p,m]=M.useState(10),[w,v]=M.useState(""),[b,y]=M.useState(!1),[N,F]=M.useState(null),j=()=>{c(""),u(""),f("all"),h(1)},k=()=>{},S=e.filter(Q=>{const te=l===""||Q.projectName.toLowerCase().includes(l.toLowerCase()),H=o===""||Q.companyName.toLowerCase().includes(o.toLowerCase()),ae=d==="all"||Q.status===d;return te&&H&&ae}).sort((Q,te)=>new Date(te.createdAt).getTime()-new Date(Q.createdAt).getTime()),P=()=>{const Q=(x-1)*p,te=Q+p;return S.slice(Q,te)},D=Math.ceil(S.length/p),K=Q=>{m(Q),h(1)},C=()=>{const Q=parseInt(w);Q>=1&&Q<=D&&(h(Q),v(""))},Y=Q=>{F(Q),y(!0)},B=()=>{N&&(s(N.id),y(!1),F(null))},ee=Q=>Q.includes(":")?Q:`${Q} 00:00:00`,re=Q=>{const te={draft:{label:"草稿",className:"bg-neutral-100 text-neutral-700"},generating:{label:"生成中",className:"bg-blue-100 text-blue-700"},completed:{label:"已完成",className:"bg-green-100 text-green-700"}},H=te[Q]||te.draft;return n.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${H.className}`,children:H.label})};return n.jsxs("div",{className:"flex flex-col h-full",children:[n.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[n.jsxs("div",{className:"bg-white rounded-lg border border-neutral-200 flex flex-col h-full",children:[n.jsxs("div",{className:"px-6 py-4 border-b border-neutral-200 flex-shrink-0",children:[n.jsx("div",{className:"flex items-center justify-between mb-4",children:n.jsx("h2",{className:"text-lg font-medium text-neutral-900",children:"投标文件生成管理"})}),n.jsxs("div",{className:"flex items-center justify-between gap-3",children:[n.jsxs("div",{className:"flex items-center gap-3 flex-wrap",children:["项目名称",n.jsx("input",{type:"text",placeholder:"请输入项目名称",value:l,onChange:Q=>c(Q.target.value),className:"w-48 px-3 py-1.5 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500"}),"企业名称",n.jsx("input",{type:"text",placeholder:"请输入企业名称",value:o,onChange:Q=>u(Q.target.value),className:"w-48 px-3 py-1.5 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500"}),"状态",n.jsxs("select",{value:d,onChange:Q=>f(Q.target.value),className:"px-3 py-1.5 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500",children:[n.jsx("option",{value:"all",children:"全部"}),n.jsx("option",{value:"draft",children:"草稿"}),n.jsx("option",{value:"generating",children:"生成中"}),n.jsx("option",{value:"completed",children:"已完成"})]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{onClick:j,className:"px-4 py-1.5 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-50 transition-colors",children:"重置"}),n.jsx("button",{onClick:k,className:"px-4 py-1.5 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors",children:"查询"})]})]})]}),n.jsx("div",{className:"px-6 py-3 border-b border-neutral-200 flex-shrink-0",children:n.jsx("div",{className:"flex items-center gap-3",children:n.jsxs("button",{onClick:t,className:"px-4 py-1.5 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors flex items-center",children:[n.jsx(Ct,{className:"w-4 h-4 mr-1"}),"新增投标文件"]})})}),n.jsx("div",{className:"overflow-x-auto flex-1 overflow-y-auto",children:n.jsxs("table",{className:"w-full",children:[n.jsx("thead",{className:"bg-neutral-50 border-b border-neutral-200",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"序号"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"项目名称"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"投标文件类型"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"招标项目"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"企业名称"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"状态"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"创建时间"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"操作"})]})}),n.jsx("tbody",{className:"divide-y divide-neutral-200",children:P().length===0?n.jsx("tr",{children:n.jsx("td",{colSpan:8,className:"px-4 py-8 text-center text-neutral-500",children:"暂无数据"})}):P().map((Q,te)=>n.jsxs("tr",{className:"hover:bg-neutral-50 transition-colors",children:[n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm text-neutral-900",children:(x-1)*p+te+1}),n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm text-neutral-900",children:n.jsx("div",{className:"max-w-xs truncate",title:Q.name,children:Q.name})}),n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm text-neutral-900",children:Q.fileTypes.map(H=>H==="commercial"?"商务文件":"技术文件").join("、")}),n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm text-neutral-900",children:n.jsx("div",{className:"max-w-xs truncate",title:Q.projectName,children:Q.projectName})}),n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm text-neutral-900",children:n.jsx("div",{className:"max-w-xs truncate",title:Q.companyName,children:Q.companyName})}),n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm",children:n.jsxs("div",{className:"flex items-center gap-2",children:[re(Q.status),Q.status==="generating"&&Q.generationProgress!==void 0&&n.jsxs("span",{className:"text-xs text-blue-600 font-medium",children:[Q.generationProgress,"%"]})]})}),n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm text-neutral-900",children:ee(Q.createdAt)}),n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm",children:n.jsx("div",{className:"flex items-center space-x-2",children:Q.status==="generating"?n.jsxs(n.Fragment,{children:[n.jsxs("button",{disabled:!0,className:"px-2 py-1 text-xs text-neutral-400 cursor-not-allowed rounded flex items-center gap-1",children:[n.jsx(Et,{className:"w-3.5 h-3.5"}),"编辑"]}),n.jsxs("button",{disabled:!0,className:"px-2 py-1 text-xs text-neutral-400 cursor-not-allowed rounded flex items-center gap-1",children:[n.jsx(qe,{className:"w-3.5 h-3.5"}),"删除"]})]}):n.jsxs(n.Fragment,{children:[Q.status==="completed"&&n.jsxs("button",{onClick:()=>r(Q),className:"px-2 py-1 text-xs text-primary-600 hover:text-primary-800 hover:bg-primary-50 rounded transition-colors flex items-center gap-1",children:[n.jsx(v1,{className:"w-3.5 h-3.5"}),"查看"]}),Q.status==="draft"&&n.jsxs("button",{onClick:()=>a(Q),className:"px-2 py-1 text-xs text-blue-600 hover:text-blue-800 hover:bg-blue-50 rounded transition-colors flex items-center gap-1",children:[n.jsx(Et,{className:"w-3.5 h-3.5"}),"编辑"]}),Q.status==="completed"&&n.jsxs("button",{onClick:()=>i(Q),className:"px-2 py-1 text-xs text-green-600 hover:text-green-800 hover:bg-green-50 rounded transition-colors flex items-center gap-1",children:[n.jsx(js,{className:"w-3.5 h-3.5"}),"下载"]}),n.jsxs("button",{onClick:()=>Y(Q),className:"px-2 py-1 text-xs text-red-600 hover:text-red-800 hover:bg-red-50 rounded transition-colors flex items-center gap-1",children:[n.jsx(qe,{className:"w-3.5 h-3.5"}),"删除"]})]})})})]},Q.id))})]})})]}),n.jsxs("div",{className:"bg-white border-t border-neutral-200 px-6 py-3 flex items-center justify-center gap-6",children:[n.jsxs("div",{className:"text-sm text-neutral-700",children:["共 ",S.length," 条"]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("button",{onClick:()=>h(Math.max(1,x-1)),disabled:x===1,className:`px-2 py-1 text-sm rounded transition-colors ${x===1?"bg-neutral-100 text-neutral-400 cursor-not-allowed":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:"<"}),n.jsx("div",{className:"flex items-center space-x-1",children:Array.from({length:Math.min(10,D)},(Q,te)=>{let H;return D<=10||x<=5?H=te+1:x>=D-4?H=D-9+te:H=x-4+te,n.jsx("button",{onClick:()=>h(H),className:`px-2.5 py-1 text-sm rounded transition-colors ${x===H?"bg-primary-600 text-white":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:H},H)})}),D>10&&n.jsxs(n.Fragment,{children:[n.jsx("span",{className:"text-neutral-500",children:"..."}),n.jsx("button",{onClick:()=>h(D),className:`px-2.5 py-1 text-sm rounded transition-colors ${x===D?"bg-primary-600 text-white":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:D})]}),n.jsx("button",{onClick:()=>h(Math.min(D,x+1)),disabled:x===D,className:`px-2 py-1 text-sm rounded transition-colors ${x===D?"bg-neutral-100 text-neutral-400 cursor-not-allowed":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:">"})]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsxs("select",{value:p,onChange:Q=>K(Number(Q.target.value)),className:"px-2 py-1 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500",children:[n.jsx("option",{value:10,children:"10条/页"}),n.jsx("option",{value:20,children:"20条/页"}),n.jsx("option",{value:50,children:"50条/页"})]}),n.jsx("span",{className:"text-sm text-neutral-700",children:"前往"}),n.jsx("input",{type:"number",value:w,onChange:Q=>v(Q.target.value),placeholder:"页",className:"w-12 px-2 py-1 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500",min:1,max:D}),n.jsx("button",{onClick:C,className:"px-3 py-1 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-50 transition-colors",children:"页"})]})]})]}),b&&N&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[n.jsx("h3",{className:"text-lg font-semibold text-neutral-900 mb-4",children:"确认删除"}),n.jsxs("p",{className:"text-neutral-700 mb-6",children:['确定要删除文件 "',n.jsx("strong",{children:N.name}),'" 吗？此操作无法撤销。']}),n.jsxs("div",{className:"flex justify-end space-x-3",children:[n.jsx("button",{onClick:()=>{y(!1),F(null)},className:"px-4 py-2 border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-50 transition-colors",children:"取消"}),n.jsx("button",{onClick:B,className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 transition-colors",children:"确认删除"})]})]})})]})},W0=({onClose:e,preSelectedProject:t,mode:r="create",existingDocument:a})=>{const s=r==="view",i=r==="edit",[l,c]=M.useState(1),[o,u]=M.useState((a==null?void 0:a.name)||""),[d,f]=M.useState((a==null?void 0:a.fileTypes)||[]),[x,h]=M.useState(t||null),[p,m]=M.useState([]),[w,v]=M.useState([]),[b,y]=M.useState(null),[N,F]=M.useState(null),[j,k]=M.useState([]),[S,P]=M.useState([]),[D,K]=M.useState({}),[C,Y]=M.useState({}),[B,ee]=M.useState("company"),[re,Q]=M.useState("productionEquipment"),[te,H]=M.useState("legalPerson"),[ae,he]=M.useState(!1),[O,I]=M.useState(0),[g,_]=M.useState(!1),[A,ne]=M.useState(""),[ue,ve]=M.useState("");M.useState(1),M.useState(1);const[xe,W]=M.useState(!1),[E,ke]=M.useState(!1),[pe,Ue]=M.useState(!1),[Ne,me]=M.useState(!1),[oe,Ie]=M.useState(null),[Re,Me]=M.useState("commercial"),[Oe,He]=M.useState([]),[Z,Be]=M.useState([]),ze=mr.useRef(null),nt=mr.useRef(null);mr.useEffect(()=>{var U,q;t&&((U=t.documentDirectory)!=null&&U.commercial&&m(se(t.documentDirectory.commercial)),(q=t.documentDirectory)!=null&&q.technical&&v(se(t.documentDirectory.technical)))},[t]),mr.useEffect(()=>{var U,q;if((i||s)&&(a!=null&&a.projectId)&&Qe.length>0){const J=Qe.find(fe=>fe.id===a.projectId);J&&(!x||x.id!==J.id)&&(h(J),ke(!1),(U=J.documentDirectory)!=null&&U.commercial&&m(se(J.documentDirectory.commercial)),(q=J.documentDirectory)!=null&&q.technical&&v(se(J.documentDirectory.technical)))}},[i,s,a,x]),mr.useEffect(()=>{if((i||s)&&!b&&Dt.length>0){const U=Dt.filter(q=>q.name.toLowerCase().includes(ue.toLowerCase()));U.length>0&&rr(U[0])}},[i,s]),mr.useEffect(()=>{const U=q=>{ze.current&&!ze.current.contains(q.target)&&W(!1),nt.current&&!nt.current.contains(q.target)&&ke(!1)};return document.addEventListener("mousedown",U),()=>{document.removeEventListener("mousedown",U)}},[]);const Qe=[{id:"1",projectName:"某市智慧城市建设项目",status:"parsed",uploadTime:"2024-01-15",documentDirectory:{commercial:`一、资格证明文件
  1.1 营业执照副本
  1.2 资质证书
二、商务响应文件
  2.1 投标函
  2.2 法定代表人授权书
三、报价文件
  3.1 投标报价表
  3.2 报价说明`,technical:`一、技术方案
  1.1 总体技术方案
  1.2 系统架构设计
二、实施方案
  2.1 项目实施计划
  2.2 质量保证措施`}},{id:"2",projectName:"教育信息化平台采购项目",status:"parsed",uploadTime:"2024-01-12",documentDirectory:{commercial:`一、资格文件
  1.1 企业资质
  1.2 授权书
二、商务文件
  2.1 投标承诺函
  2.2 报价清单`,technical:`一、技术响应
  1.1 技术方案
  1.2 系统设计
二、服务方案
  2.1 实施计划
  2.2 培训方案`}}],Dt=[{id:"1",name:"北京某某科技有限公司"},{id:"2",name:"上海XX信息技术有限公司"},{id:"3",name:"深圳YY软件开发公司"}],Xe=[{id:"fmt_1",company_id:"1",name:"标准格式A",header:"北京某某科技有限公司",footer:"第 {page} 页 共 {total} 页",margin_top:25,margin_bottom:25,margin_left:30,margin_right:30,heading_styles:{heading1:{numberingStyle:"一、",fontFamily:"宋体",fontSize:18,indent:0,lineSpacing:1.5,alignment:"center",bold:!0},heading2:{numberingStyle:"（一）",fontFamily:"宋体",fontSize:16,indent:0,lineSpacing:1.5,alignment:"left",bold:!0},heading3:{numberingStyle:"1.",fontFamily:"宋体",fontSize:15,indent:0,lineSpacing:1.5,alignment:"left",bold:!0}},body_text_style:{numberingStyle:"1.",fontFamily:"宋体",fontSize:14,indent:2,lineSpacing:1.5,alignment:"left",bold:!1},is_default:!0,created_at:"2024-10-20",updated_at:"2024-10-20"},{id:"fmt_2",company_id:"1",name:"简约格式B",header:"",footer:"第 {page} 页",margin_top:20,margin_bottom:20,margin_left:25,margin_right:25,heading_styles:{heading1:{numberingStyle:"1.",fontFamily:"微软雅黑",fontSize:16,indent:0,lineSpacing:1.3,alignment:"left",bold:!0},heading2:{numberingStyle:"1.1",fontFamily:"微软雅黑",fontSize:14,indent:0,lineSpacing:1.3,alignment:"left",bold:!0},heading3:{numberingStyle:"1.1.1",fontFamily:"微软雅黑",fontSize:13,indent:0,lineSpacing:1.3,alignment:"left",bold:!1}},body_text_style:{numberingStyle:"",fontFamily:"微软雅黑",fontSize:12,indent:2,lineSpacing:1.3,alignment:"left",bold:!1},is_default:!1,created_at:"2024-10-18",updated_at:"2024-10-18"},{id:"fmt_3",company_id:"2",name:"正式格式",header:"上海XX信息技术有限公司投标文件",footer:"第 {page} 页 共 {total} 页",margin_top:30,margin_bottom:30,margin_left:35,margin_right:35,heading_styles:{heading1:{numberingStyle:"第一章 ",fontFamily:"仿宋",fontSize:20,indent:0,lineSpacing:2,alignment:"center",bold:!0},heading2:{numberingStyle:"一、",fontFamily:"仿宋",fontSize:16,indent:0,lineSpacing:1.8,alignment:"left",bold:!0},heading3:{numberingStyle:"（一）",fontFamily:"仿宋",fontSize:15,indent:0,lineSpacing:1.5,alignment:"left",bold:!0}},body_text_style:{numberingStyle:"",fontFamily:"仿宋",fontSize:14,indent:2,lineSpacing:1.5,alignment:"justify",bold:!1},is_default:!0,created_at:"2024-10-15",updated_at:"2024-10-15"}],at=[{id:"company",name:"公司基础信息",items:[{id:"company_1",name:"营业执照副本",selected:!0},{id:"company_2",name:"公司简介",selected:!0},{id:"company_3",name:"组织架构图",selected:!1},{id:"company_4",name:"公司发展历程",selected:!1},{id:"company_5",name:"公司文化介绍",selected:!1}]},{id:"qualification",name:"资质信息",items:[{id:"qual_1",name:"软件企业认定证书",certNumber:"CERT-2024-001",rating:"甲级",status:"valid",uploadTime:"2024-10-20",selected:!0},{id:"qual_2",name:"ISO9001质量管理体系认证",certNumber:"ISO-2024-002",rating:"无",status:"valid",uploadTime:"2024-10-18",selected:!0},{id:"qual_3",name:"信息安全等保三级证书",certNumber:"SEC-2024-003",rating:"三级",status:"valid",uploadTime:"2024-10-15",selected:!1},{id:"qual_4",name:"CMMI认证证书",certNumber:"CMMI-2023-004",rating:"三级",status:"expired",uploadTime:"2024-09-10",selected:!1},{id:"qual_5",name:"高新技术企业证书",certNumber:"HIGH-2024-005",rating:"无",status:"valid",uploadTime:"2024-08-25",selected:!0},{id:"qual_6",name:"建筑业企业资质证书",certNumber:"BUILD-2024-006",rating:"乙级",status:"valid",uploadTime:"2024-07-12",selected:!1}],filters:{rating:["无","特级","一级","二级","三级","四级","五级","甲级","乙级","丙级","AAA","AAAA","AAAAA","CS1","CS2","CS3","CS4","CS5","一星级","二星级","三星级","四星级","五星级","六星级","七星级","八星级","九星级","十星级","十一星级","十二星级"],status:["valid","expired"]}},{id:"financial",name:"财务信息",items:[{id:"fin_4",name:"2024年资产负债表",year:"2024",selected:!0},{id:"fin_5",name:"2024年利润表",year:"2024",selected:!1},{id:"fin_6",name:"纳税证明",year:"2024",selected:!0},{id:"fin_1",name:"2024年度财务审计报告",year:"2024",selected:!0},{id:"fin_2",name:"2023年度财务审计报告",year:"2023",selected:!1},{id:"fin_3",name:"2022年度财务审计报告",year:"2022",selected:!1}],filters:{year:["2024","2023","2022","2021"]}},{id:"performance",name:"业绩信息",items:[{id:"perf_1",name:"智慧城市建设项目",projectName:"智慧城市建设项目",clientName:"北京市政府",contractNumber:"CT-2024-001",signYear:"2024",selected:!0},{id:"perf_2",name:"教育信息化平台",projectName:"教育信息化平台",clientName:"教育部",contractNumber:"CT-2024-002",signYear:"2024",selected:!0},{id:"perf_3",name:"政务服务平台",projectName:"政务服务平台",clientName:"上海市政府",contractNumber:"CT-2023-003",signYear:"2023",selected:!1},{id:"perf_4",name:"医疗信息系统",projectName:"医疗信息系统",clientName:"华山医院",contractNumber:"CT-2023-004",signYear:"2023",selected:!1},{id:"perf_5",name:"企业ERP系统",projectName:"企业ERP系统",clientName:"万科集团",contractNumber:"CT-2022-005",signYear:"2022",selected:!1}]},{id:"legalPerson",name:"人员信息 - 法人",items:[{id:"legal_1",name:"王建国",position:"法定代表人",status:"active",uploadTime:"2024-10-20",isLegalPerson:!0,selected:!0}],filters:{status:["active","resigned"]}},{id:"authorizedDelegate",name:"人员信息 - 授权委托人",items:[{id:"per_1",name:"张三",position:"其他人员",status:"active",uploadTime:"2024-10-22",selected:!0},{id:"per_2",name:"李四",position:"其他人员",status:"active",uploadTime:"2024-10-20",selected:!0},{id:"per_3",name:"王五",position:"其他人员",status:"active",uploadTime:"2024-10-15",selected:!1},{id:"per_4",name:"赵六",position:"其他人员",status:"active",uploadTime:"2024-09-28",selected:!1},{id:"per_5",name:"孙七",position:"其他人员",status:"resigned",uploadTime:"2024-08-10",selected:!1},{id:"per_6",name:"周八",position:"其他人员",status:"active",uploadTime:"2024-09-15",selected:!1},{id:"per_7",name:"吴九",position:"其他人员",status:"active",uploadTime:"2024-09-01",selected:!1}]},{id:"otherPersonnel",name:"人员信息 - 其他人员",items:[{id:"per_1",name:"张三",position:"其他人员",projectPosition:"项目经理",status:"active",uploadTime:"2024-10-22",selected:!0},{id:"per_2",name:"李四",position:"其他人员",projectPosition:"技术总监",status:"active",uploadTime:"2024-10-20",selected:!0},{id:"per_3",name:"王五",position:"其他人员",projectPosition:"",status:"active",uploadTime:"2024-10-15",selected:!1},{id:"per_4",name:"赵六",position:"其他人员",projectPosition:"",status:"active",uploadTime:"2024-09-28",selected:!1},{id:"per_5",name:"孙七",position:"其他人员",projectPosition:"",status:"resigned",uploadTime:"2024-08-10",selected:!1},{id:"per_6",name:"周八",position:"其他人员",projectPosition:"",status:"active",uploadTime:"2024-09-15",selected:!1},{id:"per_7",name:"吴九",position:"其他人员",projectPosition:"",status:"active",uploadTime:"2024-09-01",selected:!1}]},{id:"productionEquipment",name:"产品信息 - 生产设备",items:[{id:"prod_1",name:"数控机床 CNC-5000",productCategory:"加工设备",productBrand:"某某机械",productSpec:"五轴联动",productModel:"CNC-5000",selected:!0},{id:"prod_2",name:"注塑机 INJ-800T",productCategory:"成型设备",productBrand:"某某塑机",productSpec:"800吨锁模力",productModel:"INJ-800T",selected:!1},{id:"prod_3",name:"激光切割机 LC-3015",productCategory:"切割设备",productBrand:"某某激光",productSpec:"3000W",productModel:"LC-3015",selected:!0}],filters:{productCategory:["加工设备","成型设备","切割设备","焊接设备"]}},{id:"testingEquipment",name:"产品信息 - 检测设备",items:[{id:"test_1",name:"三坐标测量仪 CMM-7106",productCategory:"精密测量",productBrand:"某某测量",productSpec:"700x1000x600mm",productModel:"CMM-7106",selected:!0},{id:"test_2",name:"硬度计 HR-150A",productCategory:"硬度检测",productBrand:"某某仪器",productSpec:"洛氏硬度",productModel:"HR-150A",selected:!1},{id:"test_3",name:"光谱仪 OES-2000",productCategory:"成分分析",productBrand:"某某光学",productSpec:"全谱直读",productModel:"OES-2000",selected:!0}],filters:{productCategory:["精密测量","硬度检测","成分分析","无损检测"]}},{id:"companyProducts",name:"产品信息 - 企业产品",items:[{id:"cprod_1",name:"企业级路由器 ER8300G",productCategory:"自由产品",productBrand:"华为",productSpec:"企业级",productModel:"ER8300G",selected:!0},{id:"cprod_2",name:"高性能交换机 S5720-SI",productCategory:"自由产品",productBrand:"华为",productSpec:"千兆24口",productModel:"S5720-28P-SI",selected:!0},{id:"cprod_3",name:"Dell PowerEdge R740 服务器",productCategory:"代理产品",productBrand:"Dell",productSpec:"2U机架式",productModel:"R740",selected:!0}],filters:{productCategory:["网络设备","计算机设备","服务器","办公设备"]}},{id:"templates",name:"历史投标文件",items:[{id:"temp_1",name:"类似项目投标文件模板",uploadTime:"2024-10-21",selected:!0},{id:"temp_2",name:"技术方案参考文档",uploadTime:"2024-10-18",selected:!0},{id:"temp_3",name:"售后服务方案模板",uploadTime:"2024-10-12",selected:!1},{id:"temp_4",name:"项目实施计划模板",uploadTime:"2024-09-25",selected:!1},{id:"temp_5",name:"培训方案模板",uploadTime:"2024-09-10",selected:!1}]},{id:"otherFiles",name:"其他参考文件",items:[{id:"other_1",name:"行业标准规范文档",uploadTime:"2024-10-20",selected:!1},{id:"other_2",name:"产品说明书",uploadTime:"2024-10-15",selected:!1},{id:"other_3",name:"技术白皮书",uploadTime:"2024-10-10",selected:!1},{id:"other_4",name:"合作协议模板",uploadTime:"2024-09-30",selected:!1},{id:"other_5",name:"项目案例分析报告",uploadTime:"2024-09-20",selected:!1}]}],se=U=>{const q=U.split(`
`).filter(be=>be.trim()),J=[],fe=[];return q.forEach((be,Le)=>{var ct;const G=((ct=be.match(/^\s*/))==null?void 0:ct[0].length)||0,je=Math.floor(G/2),Fe=be.trim(),we={id:`item-${Le}`,title:Fe,level:je,generationMode:"detailed",children:[]};if(je===0)J.push(we),fe.length=0,fe.push(we);else{for(;fe.length>je;)fe.pop();fe.length>0&&fe[fe.length-1].children.push(we),fe.push(we)}}),J},Ce=U=>{f(q=>q.includes(U)?q.length===1?q:q.filter(J=>J!==U):[...q,U])},Je=M.useCallback(U=>{var q,J;h(U),ke(!1),(q=U.documentDirectory)!=null&&q.commercial&&m(se(U.documentDirectory.commercial)),(J=U.documentDirectory)!=null&&J.technical&&v(se(U.documentDirectory.technical))},[]),Bt=()=>{h(null),ne(""),ke(!1)},rr=U=>{y(U),P(at);const q=Xe.filter(fe=>fe.company_id===U.id);k(q);const J=q.find(fe=>fe.is_default);F(J||q[0]||null)},dr=(U,q,J)=>J.map(fe=>fe.id===U?{...fe,generationMode:q}:fe.children.length>0?{...fe,children:dr(U,q,fe.children)}:fe),yr=(U,q)=>{m(J=>dr(U,q,J))},jt=(U,q)=>{v(J=>dr(U,q,J))},zr=(U,q)=>{P(J=>J.map(fe=>fe.id===U?{...fe,items:fe.items.map(be=>be.id===q?(U==="legalPerson"||U==="authorizedDelegate"||U==="otherPersonnel")&&be.status==="resigned"&&!be.selected?be:{...be,selected:!be.selected}:be)}:fe))},nr=(U,q)=>{P(J=>J.map(fe=>fe.id===U?{...fe,items:fe.items.map(be=>({...be,selected:q}))}:fe))},Pr=()=>{he(!0),I(0);const U=setInterval(()=>{I(q=>q>=100?(clearInterval(U),he(!1),_(!0),100):q+10)},300)},ur=()=>{alert("导出为 Word 文档功能")},ja=U=>{rr(U),W(!1),ve("")},ka=()=>{y(null),ve(""),W(!0)},Cn=()=>{c(U=>Math.min(U+1,6))},un=()=>{c(U=>Math.max(U-1,1))},ra=()=>{switch(l){case 1:return o.trim()!=="";case 2:return x!==null&&d.length>0;case 3:return b!==null;case 4:return!0;case 5:return N!==null;default:return!0}},En=(U,q=0,J,fe="commercial")=>U.map(be=>{var G;const Le=((G=be.selectedKnowledgeItems)==null?void 0:G.length)||0;return n.jsxs("div",{style:{paddingLeft:`${q*24}px`},children:[n.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-neutral-100 gap-3",children:[n.jsx("div",{className:"flex-1 min-w-0",children:n.jsx("span",{className:`text-sm ${q===0?"font-semibold text-neutral-900":"text-neutral-700"}`,children:be.title})}),n.jsxs("div",{className:"flex items-center space-x-2 flex-shrink-0",children:[n.jsxs("button",{onClick:()=>{Ie(be),Me(fe),He(be.selectedKnowledgeItems||[]),Ue(!0)},disabled:s,className:`flex items-center gap-1 px-2 py-1 text-xs rounded transition-colors ${Le>0?"bg-primary-100 text-primary-700 hover:bg-primary-200":"bg-neutral-100 text-neutral-600 hover:bg-neutral-200"} disabled:opacity-50 disabled:cursor-not-allowed`,title:"选择知识库资料",children:[n.jsx(fb,{className:"w-3.5 h-3.5"}),n.jsx("span",{children:Le>0?`已选${Le}`:"选择资料"})]}),n.jsxs("select",{value:be.generationMode,onChange:je=>{J(be.id,je.target.value)},disabled:s,className:"px-2 py-1 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500 disabled:bg-neutral-50 disabled:cursor-not-allowed",children:[n.jsx("option",{value:"copy",children:"仅复制"}),n.jsx("option",{value:"brief",children:"简要生成"}),n.jsx("option",{value:"detailed",children:"详细生成"})]})]})]}),be.children.length>0&&En(be.children,q+1,J,fe)]},be.id)}),Tn=[{number:1,name:"项目名称"},{number:2,name:"招标项目"},{number:3,name:"企业知识库"},{number:4,name:"章节设置"},{number:5,name:"文件格式"},{number:6,name:"生成文件"}],na=()=>n.jsx("div",{className:"flex items-center justify-between mb-8",children:Tn.map((U,q)=>{const J=l===U.number,fe=l>U.number;return n.jsxs(mr.Fragment,{children:[n.jsxs("div",{className:"flex flex-col items-center",children:[n.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center font-medium transition-colors ${J||fe?"bg-primary-600 text-white":"bg-neutral-200 text-neutral-600"}`,children:U.number}),n.jsx("span",{className:`text-xs mt-2 text-center ${J||fe?"text-primary-600 font-medium":"text-neutral-600"}`,children:U.name})]}),q<Tn.length-1&&n.jsx("div",{className:`flex-1 h-0.5 mx-2 transition-colors ${fe?"bg-primary-600":"bg-neutral-200"}`})]},U.number)})}),ar=()=>n.jsxs("div",{className:"max-w-2xl mx-auto space-y-6",children:[n.jsx("div",{className:"mb-4 bg-blue-50 border border-blue-200 rounded-lg p-4",children:n.jsx("p",{className:"text-sm text-blue-800",children:"第一步：输入投标文件名称，用于标识和管理生成的投标文件。"})}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:["投标文件名称 ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:o,onChange:U=>u(U.target.value),placeholder:"例如：某市智慧城市建设项目投标文件",disabled:s,className:"w-full px-4 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 disabled:bg-neutral-50 disabled:cursor-not-allowed"})]})]}),_a=()=>n.jsxs("div",{className:"max-w-4xl mx-auto",children:[n.jsx("div",{className:"mb-6 bg-blue-50 border border-blue-200 rounded-lg p-4",children:n.jsx("p",{className:"text-sm text-blue-800",children:"第四步：为每个章节设置生成字数，并可选择对应的知识库资料。如果不选择，系统将自动匹配最合适的资料。"})}),d.length===0?n.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-6 text-center",children:n.jsx("p",{className:"text-amber-800",children:"请先在第三步选择需要生成的文件类型"})}):n.jsxs("div",{className:"space-y-6",children:[n.jsx("h3",{className:"text-lg font-medium text-neutral-900",children:"目录章节设置"}),d.includes("commercial")&&n.jsxs("div",{className:"border border-neutral-200 rounded-lg overflow-hidden",children:[n.jsx("div",{className:"bg-green-50 px-4 py-3 border-b border-green-200",children:n.jsx("span",{className:"text-sm font-semibold text-green-900",children:"商务文件目录结构"})}),n.jsx("div",{className:"max-h-96 overflow-y-auto p-4",children:p.length>0?En(p,0,yr,"commercial"):n.jsx("p",{className:"text-center text-neutral-500 py-8",children:"该项目暂无商务文件目录"})})]}),d.includes("technical")&&n.jsxs("div",{className:"border border-neutral-200 rounded-lg overflow-hidden",children:[n.jsx("div",{className:"bg-blue-50 px-4 py-3 border-b border-blue-200",children:n.jsx("span",{className:"text-sm font-semibold text-blue-900",children:"技术文件目录结构"})}),n.jsx("div",{className:"max-h-96 overflow-y-auto p-4",children:w.length>0?En(w,0,jt,"technical"):n.jsx("p",{className:"text-center text-neutral-500 py-8",children:"该项目暂无技术文件目录"})})]})]})]}),Qr=(U,q,J)=>{K(fe=>({...fe,[U]:{...fe[U],[q]:J}}))},bt=(U,q,J)=>{Y(fe=>({...fe,[U]:{...fe[U],[q]:J}}))},T=U=>{const q=D[U.id]||{},J=C[U.id]||{};let fe=U.items.filter(be=>{var Le,G,je,Fe,we,ct,xt,yt,Wr,Sa,aa,Ca,Fi,Pe,lt,Dr,Hr;if(q.year&&be.year&&be.year!==q.year||q.rating&&be.rating&&be.rating!==q.rating||q.status&&be.status&&be.status!==q.status||q.position&&be.position&&be.position!==q.position||q.productCategory&&be.productCategory&&be.productCategory!==q.productCategory||U.id==="company"&&J.name&&!((Le=be.name)!=null&&Le.toLowerCase().includes(J.name.toLowerCase()))||U.id==="qualification"&&(J.name&&!((G=be.name)!=null&&G.toLowerCase().includes(J.name.toLowerCase()))||J.certNumber&&!((je=be.certNumber)!=null&&je.toLowerCase().includes(J.certNumber.toLowerCase()))||J.rating&&!((Fe=be.rating)!=null&&Fe.toLowerCase().includes(J.rating.toLowerCase())))||U.id==="financial"&&J.name&&!((we=be.name)!=null&&we.toLowerCase().includes(J.name.toLowerCase())))return!1;if(U.id==="performance"){if(J.projectName&&!((ct=be.projectName)!=null&&ct.toLowerCase().includes(J.projectName.toLowerCase()))||J.contractNumber&&!((xt=be.contractNumber)!=null&&xt.toLowerCase().includes(J.contractNumber.toLowerCase())))return!1;if(J.contractAmountMin){const Fn=parseFloat(J.contractAmountMin);if(parseFloat(((yt=be.contractAmount)==null?void 0:yt.replace(/[^\d.]/g,""))||"0")<=Fn)return!1}if(J.productName&&!((Wr=be.productName)!=null&&Wr.toLowerCase().includes(J.productName.toLowerCase()))||J.productBrand&&!((Sa=be.productBrand)!=null&&Sa.toLowerCase().includes(J.productBrand.toLowerCase()))||J.productModel&&!((aa=be.productModel)!=null&&aa.toLowerCase().includes(J.productModel.toLowerCase()))||J.productQuantity&&!((Ca=be.productQuantity)!=null&&Ca.toLowerCase().includes(J.productQuantity.toLowerCase())))return!1}return!((U.id==="legalPerson"||U.id==="authorizedDelegate"||U.id==="otherPersonnel")&&J.name&&!((Fi=be.name)!=null&&Fi.toLowerCase().includes(J.name.toLowerCase()))||(U.id==="productionEquipment"||U.id==="testingEquipment"||U.id==="companyProducts")&&(J.name&&!((Pe=be.name)!=null&&Pe.toLowerCase().includes(J.name.toLowerCase()))||J.productBrand&&!((lt=be.productBrand)!=null&&lt.toLowerCase().includes(J.productBrand.toLowerCase()))||J.productModel&&!((Dr=be.productModel)!=null&&Dr.toLowerCase().includes(J.productModel.toLowerCase())))||U.id==="templates"&&J.name&&!((Hr=be.name)!=null&&Hr.toLowerCase().includes(J.name.toLowerCase())))});return U.id==="qualification"&&fe.length>0&&(fe=fe.sort((be,Le)=>!be.uploadTime||!Le.uploadTime?0:new Date(Le.uploadTime).getTime()-new Date(be.uploadTime).getTime())),U.id==="financial"&&fe.length>0&&(fe=fe.sort((be,Le)=>!be.year||!Le.year?0:parseInt(Le.year)-parseInt(be.year))),U.id==="performance"&&fe.length>0&&(fe=fe.sort((be,Le)=>!be.signYear||!Le.signYear?0:parseInt(Le.signYear)-parseInt(be.signYear))),(U.id==="legalPerson"||U.id==="authorizedDelegate"||U.id==="otherPersonnel")&&fe.length>0&&(fe=fe.sort((be,Le)=>!be.uploadTime||!Le.uploadTime?0:new Date(Le.uploadTime).getTime()-new Date(be.uploadTime).getTime())),U.id==="templates"&&fe.length>0&&(fe=fe.sort((be,Le)=>!be.uploadTime||!Le.uploadTime?0:new Date(Le.uploadTime).getTime()-new Date(be.uploadTime).getTime())),U.id==="otherFiles"&&fe.length>0&&(fe=fe.sort((be,Le)=>!be.uploadTime||!Le.uploadTime?0:new Date(Le.uploadTime).getTime()-new Date(be.uploadTime).getTime())),fe},z=U=>{var fe,be,Le,G,je,Fe;const q=C[U.id]||{},J=D[U.id]||{};return U.id==="company"?n.jsx("div",{className:"flex items-center gap-2 flex-wrap",children:n.jsx("input",{type:"text",placeholder:"公司名称",value:q.name||"",onChange:we=>bt(U.id,"name",we.target.value),className:"text-xs px-2 py-1 border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 w-40"})}):U.id==="qualification"?n.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[n.jsx("input",{type:"text",placeholder:"资质名称",value:q.name||"",onChange:we=>bt(U.id,"name",we.target.value),className:"text-xs px-2 py-1 border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 w-32"}),n.jsx("input",{type:"text",placeholder:"资质编号",value:q.certNumber||"",onChange:we=>bt(U.id,"certNumber",we.target.value),className:"text-xs px-2 py-1 border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 w-32"}),n.jsx("input",{type:"text",placeholder:"证书级别",value:q.rating||"",onChange:we=>bt(U.id,"rating",we.target.value),className:"text-xs px-2 py-1 border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 w-24"}),((fe=U.filters)==null?void 0:fe.rating)&&n.jsxs("select",{value:J.rating||"",onChange:we=>Qr(U.id,"rating",we.target.value),className:"text-xs px-2 py-1 border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500",children:[n.jsx("option",{value:"",children:"所有等级"}),U.filters.rating.map(we=>n.jsx("option",{value:we,children:we},we))]}),((be=U.filters)==null?void 0:be.status)&&n.jsxs("select",{value:J.status||"",onChange:we=>Qr(U.id,"status",we.target.value),className:"text-xs px-2 py-1 border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500",children:[n.jsx("option",{value:"",children:"所有状态"}),U.filters.status.map(we=>n.jsx("option",{value:we,children:we==="valid"?"有效":we==="expired"?"已过期":we==="active"?"可用":"不可用"},we))]})]}):U.id==="financial"?n.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[n.jsx("input",{type:"text",placeholder:"财务信息名称",value:q.name||"",onChange:we=>bt(U.id,"name",we.target.value),className:"text-xs px-2 py-1 border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 w-40"}),((Le=U.filters)==null?void 0:Le.year)&&n.jsxs("select",{value:J.year||"",onChange:we=>Qr(U.id,"year",we.target.value),className:"text-xs px-2 py-1 border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500",children:[n.jsx("option",{value:"",children:"所有年份"}),U.filters.year.map(we=>n.jsxs("option",{value:we,children:[we,"年"]},we))]})]}):U.id==="performance"?n.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[n.jsx("input",{type:"text",placeholder:"项目名称",value:q.projectName||"",onChange:we=>bt(U.id,"projectName",we.target.value),className:"text-xs px-2 py-1 border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 w-28"}),n.jsx("input",{type:"text",placeholder:"合同编号",value:q.contractNumber||"",onChange:we=>bt(U.id,"contractNumber",we.target.value),className:"text-xs px-2 py-1 border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 w-28"}),n.jsx("input",{type:"number",placeholder:"金额大于",value:q.contractAmountMin||"",onChange:we=>bt(U.id,"contractAmountMin",we.target.value),className:"text-xs px-2 py-1 border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 w-24"}),n.jsx("input",{type:"text",placeholder:"产品名称",value:q.productName||"",onChange:we=>bt(U.id,"productName",we.target.value),className:"text-xs px-2 py-1 border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 w-24"}),n.jsx("input",{type:"text",placeholder:"产品品牌",value:q.productBrand||"",onChange:we=>bt(U.id,"productBrand",we.target.value),className:"text-xs px-2 py-1 border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 w-24"}),n.jsx("input",{type:"text",placeholder:"产品型号",value:q.productModel||"",onChange:we=>bt(U.id,"productModel",we.target.value),className:"text-xs px-2 py-1 border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 w-24"}),n.jsx("input",{type:"text",placeholder:"产品数量",value:q.productQuantity||"",onChange:we=>bt(U.id,"productQuantity",we.target.value),className:"text-xs px-2 py-1 border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 w-24"})]}):U.id==="legalPerson"||U.id==="authorizedDelegate"||U.id==="otherPersonnel"?n.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[n.jsx("input",{type:"text",placeholder:"人员姓名",value:q.name||"",onChange:we=>bt(U.id,"name",we.target.value),className:"text-xs px-2 py-1 border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 w-32"}),((G=U.filters)==null?void 0:G.status)&&n.jsxs("select",{value:J.status||"",onChange:we=>Qr(U.id,"status",we.target.value),className:"text-xs px-2 py-1 border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500",children:[n.jsx("option",{value:"",children:"所有状态"}),U.filters.status.map(we=>n.jsx("option",{value:we,children:we==="valid"?"有效":we==="expired"?"已过期":we==="active"?"可用":"不可用"},we))]}),((je=U.filters)==null?void 0:je.position)&&n.jsxs("select",{value:J.position||"",onChange:we=>Qr(U.id,"position",we.target.value),className:"text-xs px-2 py-1 border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500",children:[n.jsx("option",{value:"",children:"所有职位"}),U.filters.position.map(we=>n.jsx("option",{value:we,children:we},we))]})]}):U.id==="productionEquipment"||U.id==="testingEquipment"||U.id==="companyProducts"?n.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[n.jsx("input",{type:"text",placeholder:"产品名称",value:q.name||"",onChange:we=>bt(U.id,"name",we.target.value),className:"text-xs px-2 py-1 border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 w-28"}),n.jsx("input",{type:"text",placeholder:"产品品牌",value:q.productBrand||"",onChange:we=>bt(U.id,"productBrand",we.target.value),className:"text-xs px-2 py-1 border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 w-24"}),n.jsx("input",{type:"text",placeholder:"产品型号",value:q.productModel||"",onChange:we=>bt(U.id,"productModel",we.target.value),className:"text-xs px-2 py-1 border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 w-24"}),((Fe=U.filters)==null?void 0:Fe.productCategory)&&n.jsxs("select",{value:J.productCategory||"",onChange:we=>Qr(U.id,"productCategory",we.target.value),className:"text-xs px-2 py-1 border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500",children:[n.jsx("option",{value:"",children:"所有分类"}),U.filters.productCategory.map(we=>n.jsx("option",{value:we,children:we},we))]})]}):U.id==="templates"?n.jsx("div",{className:"flex items-center gap-2 flex-wrap",children:n.jsx("input",{type:"text",placeholder:"文件名称",value:q.name||"",onChange:we=>bt(U.id,"name",we.target.value),className:"text-xs px-2 py-1 border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 w-40"})}):U.id==="otherFiles"?n.jsx("div",{className:"flex items-center gap-2 flex-wrap",children:n.jsx("input",{type:"text",placeholder:"文件名称",value:q.name||"",onChange:we=>bt(U.id,"name",we.target.value),className:"text-xs px-2 py-1 border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 w-40"})}):null},R=(U,q)=>q.id==="qualification"?n.jsx("div",{className:"ml-3 flex-1",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"text-sm text-neutral-900",children:U.name}),n.jsxs("div",{className:"flex items-center space-x-3 text-xs text-neutral-600",children:[n.jsxs("span",{children:["证书编号：",U.certNumber]}),n.jsx("span",{className:`px-2 py-0.5 rounded ${U.status==="valid"?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:U.status==="valid"?"有效":"已过期"}),U.rating!=="无"&&n.jsx("span",{className:"px-2 py-0.5 bg-blue-100 text-blue-700 rounded",children:U.rating})]})]})}):q.id==="financial"?n.jsx("div",{className:"ml-3 flex-1",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"text-sm text-neutral-900",children:U.name}),U.year&&n.jsxs("span",{className:"text-xs px-2 py-0.5 bg-neutral-100 text-neutral-700 rounded",children:[U.year,"年"]})]})}):q.id==="performance"?n.jsx("div",{className:"ml-3 flex-1",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"text-sm text-neutral-900",children:U.projectName}),n.jsxs("div",{className:"flex items-center space-x-3 text-xs text-neutral-600",children:[n.jsxs("span",{children:["客户：",U.clientName]}),n.jsxs("span",{children:["合同号：",U.contractNumber]})]})]})}):q.id==="legalPerson"||q.id==="authorizedDelegate"?n.jsx("div",{className:"ml-3 flex-1",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"text-sm text-neutral-900",children:U.name}),n.jsxs("div",{className:"flex items-center space-x-3 text-xs text-neutral-600",children:[n.jsx("span",{children:U.position}),n.jsx("span",{className:`px-2 py-0.5 rounded ${U.status==="active"?"bg-green-100 text-green-700":"bg-neutral-100 text-neutral-700"}`,children:U.status==="active"?"可用":"不可用"})]})]})}):q.id==="otherPersonnel"?n.jsx("div",{className:"ml-3 flex-1",children:n.jsxs("div",{className:"flex flex-col gap-2",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"text-sm text-neutral-900",children:U.name}),n.jsxs("div",{className:"flex items-center space-x-3 text-xs text-neutral-600",children:[n.jsxs("span",{children:["职位：",U.position]}),n.jsx("span",{className:`px-2 py-0.5 rounded ${U.status==="active"?"bg-green-100 text-green-700":"bg-neutral-100 text-neutral-700"}`,children:U.status==="active"?"可用":"不可用"})]})]}),U.selected&&n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"text-xs text-neutral-600 flex-shrink-0",children:"项目职位："}),n.jsx("input",{type:"text",value:U.projectPosition||"",onChange:J=>{P(fe=>fe.map(be=>be.id===q.id?{...be,items:be.items.map(Le=>Le.id===U.id?{...Le,projectPosition:J.target.value}:Le)}:be))},placeholder:"请输入在本项目中的职位",disabled:s,className:"flex-1 px-2 py-1 text-xs border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500 disabled:bg-neutral-50 disabled:cursor-not-allowed"})]})]})}):q.id==="productionEquipment"||q.id==="testingEquipment"||q.id==="companyProducts"?n.jsx("div",{className:"ml-3 flex-1",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"text-sm text-neutral-900",children:U.name}),n.jsxs("div",{className:"flex items-center space-x-3 text-xs text-neutral-600",children:[n.jsx("span",{className:"px-2 py-0.5 bg-purple-100 text-purple-700 rounded",children:U.productCategory}),n.jsxs("span",{children:["品牌：",U.productBrand]}),n.jsxs("span",{children:["型号：",U.productModel]})]})]})}):n.jsx("span",{className:"ml-3 text-sm text-neutral-900",children:U.name}),L=()=>n.jsxs("div",{className:"max-w-2xl mx-auto",children:[n.jsx("div",{className:"mb-4 bg-blue-50 border border-blue-200 rounded-lg p-4",children:n.jsx("p",{className:"text-sm text-blue-800",children:"第五步：选择投标文件格式，系统将使用该格式生成投标文件。"})}),n.jsxs("h3",{className:"text-lg font-medium text-neutral-900 mb-4",children:["选择文件格式 ",n.jsx("span",{className:"text-red-500",children:"*"})]}),j.length===0?n.jsxs("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-6 text-center",children:[n.jsx("p",{className:"text-amber-800",children:"该企业暂无文件格式配置"}),n.jsx("p",{className:"text-sm text-amber-600 mt-2",children:"请前往格式设置页面添加文件格式"})]}):n.jsx("div",{className:"space-y-3",children:j.map(U=>n.jsx("div",{onClick:()=>!s&&F(U),className:`p-4 border-2 rounded-lg transition-all ${s?"cursor-not-allowed":"cursor-pointer hover:border-primary-300"} ${(N==null?void 0:N.id)===U.id?"border-primary-600 bg-primary-50":"border-neutral-300 bg-white"}`,children:n.jsxs("div",{className:"flex items-start justify-between",children:[n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center",children:[n.jsx("h4",{className:"font-medium text-neutral-900",children:U.name}),U.is_default&&n.jsx("span",{className:"ml-2 px-2 py-0.5 text-xs bg-primary-100 text-primary-700 rounded",children:"默认"})]}),n.jsx("div",{className:"mt-2 space-y-1 text-sm text-neutral-600"})]}),(N==null?void 0:N.id)===U.id&&n.jsx(Zn,{className:"w-6 h-6 text-primary-600 flex-shrink-0 ml-3"})]})},U.id))})]}),V=()=>{const U=Dt.filter(Pe=>Pe.name.toLowerCase().includes(ue.toLowerCase())),q=["productionEquipment","testingEquipment","companyProducts"],J=["legalPerson","authorizedDelegate","otherPersonnel"],fe=B==="product",be=B==="personnel",Le=fe?S.find(Pe=>Pe.id===re):be?S.find(Pe=>Pe.id===te):S.find(Pe=>Pe.id===B),G=Le?T(Le):[],je=G.filter(Pe=>Pe.selected).length,Fe=S.filter(Pe=>!q.includes(Pe.id)&&!J.includes(Pe.id)),we=Fe.filter(Pe=>Pe.id!=="templates"&&Pe.id!=="otherFiles"),ct=Fe.find(Pe=>Pe.id==="templates"),xt=Fe.find(Pe=>Pe.id==="otherFiles"),yt=S.filter(Pe=>q.includes(Pe.id)),Wr=yt.reduce((Pe,lt)=>Pe+lt.items.filter(Dr=>Dr.selected).length,0),Sa=yt.reduce((Pe,lt)=>Pe+lt.items.length,0),aa=S.filter(Pe=>J.includes(Pe.id)),Ca=aa.reduce((Pe,lt)=>Pe+lt.items.filter(Dr=>Dr.selected).length,0),Fi=aa.reduce((Pe,lt)=>Pe+lt.items.length,0);return n.jsxs("div",{className:"max-w-4xl mx-auto space-y-6 pb-32",children:[n.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:n.jsx("p",{className:"text-sm text-blue-800",children:"第三步：选择企业知识库，并选择需要使用的企业资料。系统将使用该企业的基础信息、资质、业绩等资料生成投标文件。"})}),n.jsxs("div",{className:"bg-white rounded-lg border border-neutral-200 p-6",children:[n.jsxs("h3",{className:"text-lg font-medium text-neutral-900 mb-4",children:["选择企业知识库 ",n.jsx("span",{className:"text-red-500",children:"*"})]}),b?n.jsxs("div",{className:"px-4 py-3 bg-primary-50 border border-primary-300 rounded-lg flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsx("div",{className:"p-2 bg-white rounded shadow-sm",children:n.jsx(El,{className:"w-5 h-5 text-primary-600"})}),n.jsxs("div",{children:[n.jsx("div",{className:"text-xs text-neutral-500",children:"已选择的企业"}),n.jsx("div",{className:"font-medium text-neutral-900",children:b.name})]})]}),!s&&n.jsx("button",{onClick:ka,className:"px-3 py-1.5 text-sm font-medium text-primary-600 hover:text-primary-700 bg-white hover:bg-primary-50 border border-primary-300 rounded transition-colors",children:"更换企业"})]}):n.jsxs("div",{className:"relative mb-4",ref:ze,children:[n.jsx("input",{type:"text",placeholder:"点击选择企业或输入企业名称搜索...",value:ue,onChange:Pe=>ve(Pe.target.value),onFocus:()=>W(!0),disabled:s,className:"w-full px-4 py-2.5 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 disabled:bg-neutral-50 disabled:cursor-not-allowed text-base"}),xe&&!s&&n.jsx("div",{className:"absolute z-[100] w-full mt-2 bg-white border border-neutral-300 rounded-lg shadow-xl overflow-hidden max-h-[400px]",children:U.length===0?n.jsx("div",{className:"p-4 text-center text-neutral-500",children:"未找到匹配的企业"}):n.jsx("div",{className:"overflow-y-auto",children:U.map(Pe=>n.jsx("div",{onClick:()=>ja(Pe),className:"px-4 py-3 hover:bg-primary-50 cursor-pointer transition-colors border-b border-neutral-100 last:border-b-0",children:n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsx(El,{className:"w-5 h-5 text-primary-600 flex-shrink-0"}),n.jsx("span",{className:"text-sm text-neutral-900",children:Pe.name})]})},Pe.id))})})]})]}),b&&n.jsxs("div",{className:"bg-white rounded-lg border border-neutral-200 p-6 animate-fadeIn",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("h3",{className:"text-lg font-medium text-neutral-900",children:["选择知识库资料 ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsxs("span",{className:"text-xs text-neutral-500 bg-neutral-100 px-3 py-1 rounded-full",children:["为 ",b.name," 选择资料"]})]}),n.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-3 mb-4",children:n.jsx("p",{className:"text-sm text-amber-800",children:"请选择需要使用的企业知识库资料，勾选的资料将作为生成投标文件的数据来源。支持按类型筛选查找。"})}),n.jsx("div",{className:"border-b border-neutral-200 mb-4",children:n.jsxs("div",{className:"flex space-x-1 overflow-x-auto",children:[we.map(Pe=>{const lt=Pe.items.filter(Hr=>Hr.selected).length,Dr=Pe.items.length;return n.jsxs("button",{onClick:()=>ee(Pe.id),className:`px-4 py-2.5 text-sm font-medium whitespace-nowrap border-b-2 transition-colors ${B===Pe.id?"border-primary-600 text-primary-600":"border-transparent text-neutral-600 hover:text-neutral-900 hover:border-neutral-300"}`,children:[Pe.name,lt>0&&n.jsxs("span",{className:`ml-2 px-1.5 py-0.5 text-xs rounded ${B===Pe.id?"bg-primary-100 text-primary-700":"bg-neutral-100 text-neutral-600"}`,children:[lt,"/",Dr]})]},Pe.id)}),aa.length>0&&n.jsxs("button",{onClick:()=>{ee("personnel")},className:`px-4 py-2.5 text-sm font-medium whitespace-nowrap border-b-2 transition-colors ${be?"border-primary-600 text-primary-600":"border-transparent text-neutral-600 hover:text-neutral-900 hover:border-neutral-300"}`,children:["人员信息",Ca>0&&n.jsxs("span",{className:`ml-2 px-1.5 py-0.5 text-xs rounded ${be?"bg-primary-100 text-primary-700":"bg-neutral-100 text-neutral-600"}`,children:[Ca,"/",Fi]})]}),yt.length>0&&n.jsxs("button",{onClick:()=>{ee("product")},className:`px-4 py-2.5 text-sm font-medium whitespace-nowrap border-b-2 transition-colors ${fe?"border-primary-600 text-primary-600":"border-transparent text-neutral-600 hover:text-neutral-900 hover:border-neutral-300"}`,children:["产品信息",Wr>0&&n.jsxs("span",{className:`ml-2 px-1.5 py-0.5 text-xs rounded ${fe?"bg-primary-100 text-primary-700":"bg-neutral-100 text-neutral-600"}`,children:[Wr,"/",Sa]})]}),ct&&n.jsxs("button",{onClick:()=>ee(ct.id),className:`px-4 py-2.5 text-sm font-medium whitespace-nowrap border-b-2 transition-colors ${B===ct.id?"border-primary-600 text-primary-600":"border-transparent text-neutral-600 hover:text-neutral-900 hover:border-neutral-300"}`,children:[ct.name,ct.items.filter(Pe=>Pe.selected).length>0&&n.jsxs("span",{className:`ml-2 px-1.5 py-0.5 text-xs rounded ${B===ct.id?"bg-primary-100 text-primary-700":"bg-neutral-100 text-neutral-600"}`,children:[ct.items.filter(Pe=>Pe.selected).length,"/",ct.items.length]})]},ct.id),xt&&n.jsxs("button",{onClick:()=>ee(xt.id),className:`px-4 py-2.5 text-sm font-medium whitespace-nowrap border-b-2 transition-colors ${B===xt.id?"border-primary-600 text-primary-600":"border-transparent text-neutral-600 hover:text-neutral-900 hover:border-neutral-300"}`,children:[xt.name,xt.items.filter(Pe=>Pe.selected).length>0&&n.jsxs("span",{className:`ml-2 px-1.5 py-0.5 text-xs rounded ${B===xt.id?"bg-primary-100 text-primary-700":"bg-neutral-100 text-neutral-600"}`,children:[xt.items.filter(Pe=>Pe.selected).length,"/",xt.items.length]})]},xt.id)]})}),be&&n.jsxs("div",{className:"mb-4",children:[n.jsx("div",{className:"border-b border-neutral-200",children:n.jsx("div",{className:"flex space-x-2",children:aa.map(Pe=>{const lt=Pe.items.filter(Fn=>Fn.selected).length,Dr=Pe.items.length,Hr={legalPerson:"法人",authorizedDelegate:"授权委托人",otherPersonnel:"其他人员"};return n.jsxs("button",{onClick:()=>H(Pe.id),className:`px-4 py-2 text-sm font-medium transition-colors rounded-t ${te===Pe.id?"bg-primary-600 text-white":"bg-neutral-100 text-neutral-600 hover:bg-neutral-200"}`,children:[Hr[Pe.id],lt>0&&n.jsxs("span",{className:`ml-2 px-1.5 py-0.5 text-xs rounded ${te===Pe.id?"bg-primary-700 text-white":"bg-neutral-200 text-neutral-700"}`,children:[lt,"/",Dr]})]},Pe.id)})})}),te==="authorizedDelegate"&&n.jsx("div",{className:"mt-2 bg-blue-50 border border-blue-200 rounded p-3",children:n.jsxs("p",{className:"text-xs text-blue-800",children:[n.jsx("span",{className:"font-medium",children:"提示："}),"授权委托人可从企业所有人员（除法人外）中选择，选中的人员将作为投标项目的授权委托人。"]})})]}),fe&&n.jsx("div",{className:"mb-4 border-b border-neutral-200",children:n.jsx("div",{className:"flex space-x-2",children:yt.map(Pe=>{const lt=Pe.items.filter(Fn=>Fn.selected).length,Dr=Pe.items.length,Hr={productionEquipment:"生产设备",testingEquipment:"检测设备",companyProducts:"企业产品"};return n.jsxs("button",{onClick:()=>Q(Pe.id),className:`px-4 py-2 text-sm font-medium transition-colors rounded-t ${re===Pe.id?"bg-primary-600 text-white":"bg-neutral-100 text-neutral-600 hover:bg-neutral-200"}`,children:[Hr[Pe.id],lt>0&&n.jsxs("span",{className:`ml-2 px-1.5 py-0.5 text-xs rounded ${re===Pe.id?"bg-primary-700 text-white":"bg-neutral-200 text-neutral-700"}`,children:[lt,"/",Dr]})]},Pe.id)})})}),Le&&n.jsxs("div",{className:"border border-neutral-200 rounded-lg overflow-hidden",children:[n.jsxs("div",{className:"bg-neutral-50 px-4 py-3 border-b border-neutral-200",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("span",{className:"text-sm font-semibold text-neutral-900",children:Le.name}),n.jsxs("span",{className:"text-xs text-neutral-600",children:["(",je,"/",G.length,")"]})]}),!s&&n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("button",{onClick:()=>nr(Le.id,!0),className:"text-xs text-primary-600 hover:text-primary-800",children:"全选"}),n.jsx("span",{className:"text-neutral-300",children:"|"}),n.jsx("button",{onClick:()=>nr(Le.id,!1),className:"text-xs text-neutral-600 hover:text-neutral-800",children:"取消"})]})]}),n.jsx("div",{className:"mt-3",children:z(Le)})]}),n.jsx("div",{className:"p-4 space-y-2 max-h-96 overflow-y-auto",children:G.length===0?n.jsx("p",{className:"text-center text-neutral-500 py-4",children:"暂无符合条件的资料"}):G.map(Pe=>{const lt=Le.id==="qualification"&&Pe.status==="expired",Hr=(Le.id==="legalPerson"||Le.id==="authorizedDelegate"||Le.id==="otherPersonnel")&&Pe.status==="resigned",Fn=s||lt||Hr;return n.jsxs("label",{className:`flex items-center p-3 rounded border border-transparent ${Fn?"cursor-not-allowed bg-neutral-50 opacity-60":"hover:bg-neutral-50 hover:border-neutral-200 cursor-pointer"} ${Pe.selected?"bg-primary-50 border-primary-200":""}`,title:lt?"已过期资质无法选择":Hr?"不可用人员无法选择":"",children:[n.jsx("input",{type:"checkbox",checked:Pe.selected,onChange:()=>zr(Le.id,Pe.id),disabled:Fn,className:"w-4 h-4 text-primary-600 rounded focus:ring-primary-500 disabled:cursor-not-allowed flex-shrink-0"}),R(Pe,Le)]},Pe.id)})})]})]})]})},X=()=>{var q;const U=Qe.filter(J=>J.projectName.toLowerCase().includes(A.toLowerCase())).sort((J,fe)=>new Date(fe.uploadTime).getTime()-new Date(J.uploadTime).getTime());return n.jsxs("div",{className:"max-w-4xl mx-auto space-y-6 pb-32",children:[n.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:n.jsx("p",{className:"text-sm text-blue-800",children:"第二步：选择对应的招标项目，并选择需要生成的投标文件类型。系统将根据该项目解析的文件目录结构生成投标文件。"})}),n.jsxs("div",{className:"bg-white rounded-lg border border-neutral-200 p-6",children:[n.jsxs("h3",{className:"text-lg font-medium text-neutral-900 mb-4",children:["选择招标项目 ",n.jsx("span",{className:"text-red-500",children:"*"})]}),!x&&!t?n.jsxs("div",{className:"relative mb-4",ref:nt,children:[n.jsx("input",{type:"text",placeholder:"点击选择招标项目或输入项目名称搜索...",value:A,onChange:J=>ne(J.target.value),onFocus:()=>ke(!0),disabled:s,className:"w-full px-4 py-2.5 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 disabled:bg-neutral-50 disabled:cursor-not-allowed text-base"}),E&&!s&&n.jsx("div",{className:"absolute z-[100] w-full mt-2 bg-white border border-neutral-300 rounded-lg shadow-xl overflow-hidden max-h-[400px]",children:U.length===0?n.jsx("div",{className:"p-4 text-center text-neutral-500",children:"未找到匹配的项目"}):n.jsx("div",{className:"overflow-y-auto",children:U.map(J=>n.jsx("div",{onClick:()=>Je(J),className:"px-4 py-3 hover:bg-primary-50 cursor-pointer transition-colors border-b border-neutral-100 last:border-b-0",children:n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsx(Rd,{className:"w-5 h-5 text-primary-600 flex-shrink-0"}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("div",{className:"text-sm text-neutral-900 font-medium",children:J.projectName}),n.jsxs("div",{className:"text-xs text-neutral-500 mt-0.5",children:["上传时间：",J.uploadTime]})]})]})},J.id))})})]}):n.jsxs("div",{className:"px-4 py-3 bg-primary-50 border border-primary-300 rounded-lg flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsx("div",{className:"p-2 bg-white rounded shadow-sm",children:n.jsx(Rd,{className:"w-5 h-5 text-primary-600"})}),n.jsxs("div",{children:[n.jsx("div",{className:"text-xs text-neutral-500",children:"已选择的招标项目"}),n.jsx("div",{className:"font-medium text-neutral-900",children:(q=x||t)==null?void 0:q.projectName})]})]}),!s&&!t&&n.jsx("button",{onClick:Bt,className:"px-3 py-1.5 text-sm font-medium text-primary-600 hover:text-primary-700 bg-white hover:bg-primary-50 border border-primary-300 rounded transition-colors",children:"更换项目"})]})]}),(x||t)&&n.jsxs("div",{className:"bg-white rounded-lg border border-neutral-200 p-6",children:[n.jsxs("h3",{className:"text-lg font-medium text-neutral-900 mb-4",children:["选择需要生成的文件类型 ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("label",{className:`flex items-center p-4 border-2 rounded-lg ${s?"cursor-not-allowed bg-neutral-50":"cursor-pointer hover:bg-neutral-50"} transition-colors ${d.includes("commercial")?"border-primary-600 bg-primary-50":"border-neutral-300"}`,children:[n.jsx("input",{type:"checkbox",checked:d.includes("commercial"),onChange:()=>Ce("commercial"),disabled:s,className:"w-5 h-5 text-primary-600 rounded focus:ring-primary-500 disabled:cursor-not-allowed"}),n.jsx("span",{className:"ml-3 font-medium text-neutral-900",children:"商务文件"})]}),n.jsxs("label",{className:`flex items-center p-4 border-2 rounded-lg ${s?"cursor-not-allowed bg-neutral-50":"cursor-pointer hover:bg-neutral-50"} transition-colors ${d.includes("technical")?"border-primary-600 bg-primary-50":"border-neutral-300"}`,children:[n.jsx("input",{type:"checkbox",checked:d.includes("technical"),onChange:()=>Ce("technical"),disabled:s,className:"w-5 h-5 text-primary-600 rounded focus:ring-primary-500 disabled:cursor-not-allowed"}),n.jsx("span",{className:"ml-3 font-medium text-neutral-900",children:"技术文件"})]})]})]})]})},le=()=>_a(),ge=()=>g||s?n.jsxs("div",{className:"max-w-2xl mx-auto text-center",children:[n.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 bg-green-100 rounded-full mb-6",children:n.jsx(Zn,{className:"w-12 h-12 text-green-600"})}),n.jsx("h3",{className:"text-2xl font-semibold text-neutral-900 mb-2",children:s?"投标文件已完成":"生成完成"}),n.jsx("p",{className:"text-neutral-600 mb-8",children:"投标文件已成功生成，可以导出使用。"}),n.jsxs("div",{className:"flex justify-center space-x-4",children:[n.jsxs("button",{onClick:ur,className:"px-6 py-3 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors flex items-center",children:[n.jsx(js,{className:"w-5 h-5 mr-2"}),"导出 Word"]}),n.jsx("button",{onClick:e,className:"px-6 py-3 border border-neutral-300 text-neutral-700 rounded-lg hover:bg-neutral-50 transition-colors",children:"关闭"})]})]}):n.jsxs("div",{className:"max-w-2xl mx-auto",children:[n.jsx("div",{className:"mb-4 bg-blue-50 border border-blue-200 rounded-lg p-4",children:n.jsx("p",{className:"text-sm text-blue-800",children:"第六步：确认所有配置信息，点击开始生成按钮，系统将自动生成投标文件。"})}),n.jsxs("div",{className:"text-center mb-8",children:[n.jsx("h3",{className:"text-xl font-semibold text-neutral-900 mb-2",children:"开始生成投标文件"}),n.jsx("p",{className:"text-neutral-600",children:"确认以下信息无误后，点击开始生成"})]}),n.jsxs("div",{className:"bg-neutral-50 rounded-lg p-6 space-y-4 mb-6",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-sm text-neutral-600",children:"文件名称："}),n.jsx("span",{className:"text-sm font-medium text-neutral-900",children:o})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-sm text-neutral-600",children:"生成文件："}),n.jsxs("span",{className:"text-sm font-medium text-neutral-900",children:[d.includes("commercial")&&"商务文件",d.includes("commercial")&&d.includes("technical")&&"、",d.includes("technical")&&"技术文件"]})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-sm text-neutral-600",children:"招标项目："}),n.jsx("span",{className:"text-sm font-medium text-neutral-900",children:x==null?void 0:x.projectName})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-sm text-neutral-600",children:"企业："}),n.jsx("span",{className:"text-sm font-medium text-neutral-900",children:b==null?void 0:b.name})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-sm text-neutral-600",children:"文件格式："}),n.jsx("span",{className:"text-sm font-medium text-neutral-900",children:N==null?void 0:N.name})]})]}),n.jsxs("div",{className:"bg-white border border-neutral-200 rounded-lg p-6 mb-8",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4 pb-3 border-b border-neutral-200",children:[n.jsx("h4",{className:"text-sm font-semibold text-neutral-900",children:"已选知识库资料"}),n.jsxs("span",{className:"text-sm font-semibold text-primary-600",children:["共 ",S.reduce((U,q)=>U+q.items.filter(J=>J.selected).length,0)," 份"]})]}),(()=>{const U=J=>({company:"公司基础信息",qualification:"资质信息",financial:"财务信息",performance:"业绩信息",legalPerson:"法人信息",authorizedDelegate:"授权委托人信息",otherPersonnel:"其他人员信息",productionEquipment:"生产设备",testingEquipment:"检测设备",companyProducts:"企业产品",templates:"历史投标文件"})[J]||J,q=S.map(J=>({id:J.id,name:U(J.id),count:J.items.filter(fe=>fe.selected).length})).filter(J=>J.count>0);return q.length===0?n.jsx("div",{className:"text-center py-4 text-neutral-500 text-sm",children:"暂未选择任何资料"}):n.jsx("div",{className:"space-y-2",children:q.map(J=>n.jsxs("div",{className:"flex justify-between items-center py-2 px-3 bg-neutral-50 rounded",children:[n.jsx("span",{className:"text-sm text-neutral-700",children:J.name}),n.jsxs("span",{className:"text-sm font-medium text-primary-600",children:[J.count," 份"]})]},J.id))})})()]}),ae?n.jsxs("div",{children:[n.jsx("div",{className:"flex items-center justify-center mb-4",children:n.jsx($u,{className:"w-8 h-8 text-primary-600 animate-spin"})}),n.jsxs("div",{className:"mb-2",children:[n.jsxs("div",{className:"flex justify-between text-sm text-neutral-600 mb-1",children:[n.jsx("span",{children:"正在生成..."}),n.jsxs("span",{children:[O,"%"]})]}),n.jsx("div",{className:"w-full bg-neutral-200 rounded-full h-2",children:n.jsx("div",{className:"bg-primary-600 h-2 rounded-full transition-all duration-300",style:{width:`${O}%`}})})]})]}):n.jsxs("div",{className:"flex justify-center items-center gap-4",children:[n.jsxs("button",{onClick:un,className:"px-6 py-3 border border-neutral-300 text-neutral-700 rounded-lg hover:bg-neutral-50 transition-colors font-medium flex items-center",children:[n.jsx(yi,{className:"w-4 h-4 mr-2"}),"上一步"]}),n.jsx("button",{onClick:Pr,className:"px-8 py-3 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors font-medium",children:"开始生成"})]})]}),ie=U=>{if(!oe)return;const q=J=>J.map(fe=>fe.id===oe.id?{...fe,selectedKnowledgeItems:U}:fe.children.length>0?{...fe,children:q(fe.children)}:fe);Re==="commercial"?m(q(p)):v(q(w)),Ue(!1)},ce=()=>!pe||!oe?null:n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] flex flex-col",children:[n.jsxs("div",{className:"px-6 py-4 border-b border-neutral-200 flex items-center justify-between",children:[n.jsxs("h3",{className:"text-lg font-semibold text-neutral-900",children:['为"',oe.title,'"选择知识库资料']}),n.jsx("button",{onClick:()=>Ue(!1),className:"text-neutral-500 hover:text-neutral-700 transition-colors",children:n.jsx(Ze,{className:"w-5 h-5"})})]}),n.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:S.length===0?n.jsx("div",{className:"text-center py-8 text-neutral-500",children:"请先在步骤3选择企业知识库"}):n.jsx("div",{className:"space-y-4",children:S.map(U=>{const q=T(U);return q.length===0?null:n.jsxs("div",{className:"border border-neutral-200 rounded-lg overflow-hidden",children:[n.jsxs("div",{className:"bg-neutral-50 px-4 py-3 border-b border-neutral-200",children:[n.jsx("div",{className:"flex items-center justify-between mb-2",children:n.jsx("h4",{className:"text-sm font-semibold text-neutral-900",children:U.name})}),n.jsx("div",{className:"mt-2",children:z(U)})]}),n.jsx("div",{className:"p-4 space-y-2 max-h-60 overflow-y-auto",children:q.map(J=>n.jsxs("label",{className:"flex items-start gap-3 p-3 border border-neutral-200 rounded hover:bg-neutral-50 cursor-pointer transition-colors",children:[n.jsx("input",{type:"checkbox",checked:Oe.includes(J.id),onChange:fe=>{const be=fe.target.checked?[...Oe,J.id]:Oe.filter(Le=>Le!==J.id);He(be)},className:"mt-0.5 w-4 h-4 text-primary-600 rounded focus:ring-primary-500"}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("div",{className:"text-sm font-medium text-neutral-900",children:J.name}),(J.certNumber||J.projectName||J.year)&&n.jsxs("div",{className:"text-xs text-neutral-500 mt-1 space-x-2",children:[J.certNumber&&n.jsxs("span",{children:["证书号: ",J.certNumber]}),J.projectName&&n.jsxs("span",{children:["项目: ",J.projectName]}),J.year&&n.jsxs("span",{children:["年份: ",J.year]})]})]})]},J.id))})]},U.id)})})}),n.jsxs("div",{className:"px-6 py-4 border-t border-neutral-200 flex justify-between items-center",children:[n.jsxs("div",{className:"text-sm text-neutral-600",children:["已选择 ",n.jsx("span",{className:"font-semibold text-primary-600",children:Oe.length})," 项资料"]}),n.jsxs("div",{className:"flex gap-3",children:[n.jsx("button",{onClick:()=>Ue(!1),className:"px-4 py-2 border border-neutral-300 text-neutral-700 rounded-lg hover:bg-neutral-50 transition-colors",children:"取消"}),n.jsx("button",{onClick:()=>ie(Oe),className:"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors",children:"确定"})]})]})]})}),de=U=>{if(!oe)return;const q=J=>J.map(fe=>fe.id===oe.id?{...fe,selectedReferenceItems:U}:fe.children.length>0?{...fe,children:q(fe.children)}:fe);Re==="commercial"?m(q(p)):v(q(w)),me(!1)},Se=()=>{if(!Ne||!oe)return null;const U=S.find(J=>J.id==="templates"),q=(U==null?void 0:U.items)||[];return n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] flex flex-col",children:[n.jsxs("div",{className:"px-6 py-4 border-b border-neutral-200 flex items-center justify-between",children:[n.jsxs("h3",{className:"text-lg font-semibold text-neutral-900",children:['为"',oe.title,'"选择参考资料']}),n.jsx("button",{onClick:()=>me(!1),className:"text-neutral-500 hover:text-neutral-700 transition-colors",children:n.jsx(Ze,{className:"w-5 h-5"})})]}),n.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:q.length===0?n.jsx("div",{className:"text-center py-8 text-neutral-500",children:"暂无历史投标文件"}):n.jsx("div",{className:"space-y-2",children:q.map(J=>n.jsxs("label",{className:"flex items-start gap-3 p-3 border border-neutral-200 rounded hover:bg-neutral-50 cursor-pointer transition-colors",children:[n.jsx("input",{type:"checkbox",checked:Z.includes(J.id),onChange:fe=>{const be=fe.target.checked?[...Z,J.id]:Z.filter(Le=>Le!==J.id);Be(be)},className:"mt-0.5 w-4 h-4 text-blue-600 rounded focus:ring-blue-500"}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("div",{className:"text-sm font-medium text-neutral-900",children:J.name}),J.uploadTime&&n.jsxs("div",{className:"text-xs text-neutral-500 mt-1",children:["上传时间: ",J.uploadTime]})]})]},J.id))})}),n.jsxs("div",{className:"px-6 py-4 border-t border-neutral-200 flex justify-between items-center",children:[n.jsxs("div",{className:"text-sm text-neutral-600",children:["已选择 ",n.jsx("span",{className:"font-semibold text-blue-600",children:Z.length})," 项资料"]}),n.jsxs("div",{className:"flex gap-3",children:[n.jsx("button",{onClick:()=>me(!1),className:"px-4 py-2 border border-neutral-300 text-neutral-700 rounded-lg hover:bg-neutral-50 transition-colors",children:"取消"}),n.jsx("button",{onClick:()=>de(Z),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"确定"})]})]})]})})},Ee=()=>{switch(l){case 1:return ar();case 2:return X();case 3:return V();case 4:return le();case 5:return L();case 6:return ge();default:return null}};return n.jsxs("div",{className:"flex flex-col h-full bg-white",children:[n.jsx("div",{className:"border-b border-neutral-200 px-6 py-4 flex-shrink-0",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("h2",{className:"text-xl font-semibold text-neutral-900",children:s?"查看投标文件":i?"编辑投标文件":"投标文件生成"}),n.jsx("button",{onClick:e,className:"text-neutral-600 hover:text-neutral-900 transition-colors",children:n.jsx(Ze,{className:"w-6 h-6"})})]})}),n.jsx("div",{className:"flex-1 overflow-auto",children:n.jsxs("div",{className:"p-8",children:[na(),Ee()]})}),l<6&&n.jsxs("div",{className:"relative z-10 border-t border-neutral-200 bg-white px-6 py-4 flex justify-between flex-shrink-0 shadow-lg",children:[n.jsxs("button",{onClick:un,disabled:l===1,className:"px-6 py-2.5 border border-neutral-300 text-neutral-700 rounded-lg hover:bg-neutral-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center font-medium",children:[n.jsx(yi,{className:"w-4 h-4 mr-2"}),"上一步"]}),n.jsxs("button",{onClick:s?()=>c(Math.min(l+1,6)):Cn,disabled:s?l>=6:!ra(),className:"px-6 py-2.5 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center font-medium",children:["下一步",n.jsx(db,{className:"w-4 h-4 ml-2"})]})]}),ce(),Se()]})},QE=({preSelectedProject:e,canEdit:t=!0,canDelete:r=!0})=>{const[a,s]=M.useState(()=>{const v=localStorage.getItem("generated_documents"),b=localStorage.getItem("generated_documents_version"),y="1.4";return v&&b===y?JSON.parse(v):(localStorage.setItem("generated_documents_version",y),[{id:"1",name:"城市轨道交通信号系统项目投标文件",fileTypes:["commercial","technical"],projectId:"5",projectName:"城市轨道交通信号系统项目",companyName:"北京某某轨道科技有限公司",status:"generating",createdAt:"2025-10-13 11:30:00",generationProgress:72},{id:"2",name:"办公楼智能化系统集成项目投标文件",fileTypes:["commercial","technical"],projectId:"2",projectName:"办公楼智能化系统集成项目",companyName:"深圳某某智能科技有限公司",status:"completed",createdAt:"2025-10-11 16:45:00"},{id:"3",name:"市政道路改造工程项目投标文件",fileTypes:["commercial"],projectId:"1",projectName:"市政道路改造工程项目",companyName:"广州XX建设工程有限公司",status:"draft",createdAt:"2025-10-10 14:20:00"}])}),[i,l]=M.useState(()=>{if(e)return e;const v=localStorage.getItem("preselected_bidding_project");return v?(localStorage.removeItem("preselected_bidding_project"),JSON.parse(v)):null}),[c,o]=M.useState(()=>i?"create":"list"),[u,d]=M.useState(null);M.useEffect(()=>{localStorage.setItem("generated_documents",JSON.stringify(a))},[a]);const f=()=>{o("create")},x=v=>{d(v),o("view")},h=v=>{d(v),o("edit")},p=v=>{s(a.filter(b=>b.id!==v))},m=v=>{alert(`下载文件: ${v.name}`)},w=()=>{o("list"),d(null)};return c==="create"?n.jsx(W0,{onClose:w,preSelectedProject:i,mode:"create"}):c==="edit"?n.jsx(W0,{onClose:w,preSelectedProject:null,mode:"edit",existingDocument:u}):c==="view"?n.jsx(W0,{onClose:w,preSelectedProject:null,mode:"view",existingDocument:u}):n.jsx(JE,{documents:a,onCreateClick:f,onViewDocument:x,onEditDocument:h,onDeleteDocument:p,onDownloadDocument:m})},ZE=[{id:"default-stamp",name:"盖章项检查",description:"检查投标文件中涉及盖章的部分是否全部盖章",isPublic:!0,isDefault:!0}],eT=({onClose:e})=>{const[t,r]=M.useState(ZE),[a,s]=M.useState(""),[i,l]=M.useState(!1),[c,o]=M.useState(!1),[u,d]=M.useState(!1),[f,x]=M.useState(null),[h,p]=M.useState({name:"",description:""}),m=t.filter(j=>j.name.toLowerCase().includes(a.toLowerCase())||j.description.toLowerCase().includes(a.toLowerCase())),w=()=>{p({name:"",description:""}),l(!0)},v=j=>{j.isDefault||(x(j),p({name:j.name,description:j.description}),o(!0))},b=j=>{j.isDefault||(x(j),d(!0))},y=()=>{const j={id:String(Date.now()),name:h.name,description:h.description,isPublic:!0};r([...t,j]),l(!1)},N=()=>{f&&r(t.map(j=>j.id===f.id?{...j,name:h.name,description:h.description}:j)),o(!1),x(null)},F=()=>{f&&r(t.filter(j=>j.id!==f.id)),d(!1),x(null)};return n.jsxs("div",{className:"flex flex-col h-full",children:[n.jsx("div",{className:"flex-1 overflow-auto",children:n.jsxs("div",{className:"bg-white rounded-lg border border-neutral-200",children:[n.jsxs("div",{className:"px-6 py-4 border-b border-neutral-200",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h3",{className:"text-lg font-semibold text-neutral-900",children:"通用检查点管理"}),n.jsx("button",{onClick:e,className:"text-neutral-400 hover:text-neutral-600 transition-colors",children:n.jsx(Ze,{className:"w-5 h-5"})})]}),n.jsxs("div",{className:"flex items-center justify-between gap-4",children:[n.jsxs("div",{className:"flex-1 relative",children:[n.jsx(Tb,{className:"w-4 h-4 text-neutral-400 absolute left-3 top-2.5"}),n.jsx("input",{type:"text",placeholder:"搜索检查点名称、描述或分类...",value:a,onChange:j=>s(j.target.value),className:"w-full pl-10 pr-4 py-2 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("button",{onClick:w,className:"px-4 py-2 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors flex items-center",children:[n.jsx(Ct,{className:"w-4 h-4 mr-1"}),"新增检查点"]})]})]}),n.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[n.jsx("div",{className:"space-y-3",children:m.map(j=>n.jsx("div",{className:"bg-neutral-50 rounded-lg p-4 hover:bg-neutral-100 transition-colors",children:n.jsxs("div",{className:"flex items-start justify-between",children:[n.jsxs("div",{className:"flex-1",children:[n.jsx("h4",{className:"font-medium text-neutral-900 mb-2",children:j.name}),n.jsx("p",{className:"text-sm text-neutral-600",children:j.description})]}),n.jsx("div",{className:"flex items-center space-x-2 ml-4",children:j.isDefault?n.jsx("span",{className:"px-3 py-1 text-xs bg-blue-100 text-blue-700 rounded-full font-medium",children:"默认检查项"}):n.jsxs(n.Fragment,{children:[n.jsxs("button",{onClick:()=>v(j),className:"px-2 py-1 text-xs text-primary-600 hover:text-primary-800 hover:bg-primary-50 rounded transition-colors flex items-center gap-1",children:[n.jsx(Et,{className:"w-3.5 h-3.5"}),"编辑"]}),n.jsxs("button",{onClick:()=>b(j),className:"px-2 py-1 text-xs text-red-600 hover:text-red-800 hover:bg-red-50 rounded transition-colors flex items-center gap-1",children:[n.jsx(qe,{className:"w-3.5 h-3.5"}),"删除"]})]})})]})},j.id))}),m.length===0&&n.jsx("div",{className:"text-center py-12 text-neutral-500",children:n.jsx("p",{children:"没有找到匹配的检查点"})})]}),n.jsx("div",{className:"p-6 border-t border-neutral-200",children:n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsxs("p",{className:"text-sm text-neutral-600",children:["共 ",m.length," 个检查点"]}),n.jsx("button",{onClick:e,className:"px-6 py-2 bg-neutral-100 hover:bg-neutral-200 text-neutral-700 rounded-lg transition-colors",children:"关闭"})]})})]})}),i&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[60]",children:n.jsx("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full mx-4",children:n.jsxs("div",{className:"p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h3",{className:"text-lg font-semibold text-neutral-900",children:"新增检查点"}),n.jsx("button",{onClick:()=>l(!1),className:"text-neutral-400 hover:text-neutral-600 transition-colors",children:n.jsx(Ze,{className:"w-5 h-5"})})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:["检查点名称 ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:h.name,onChange:j=>p({...h,name:j.target.value}),placeholder:"请输入检查点名称",className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:["检查点描述 ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("textarea",{value:h.description,onChange:j=>p({...h,description:j.target.value}),placeholder:"请输入检查点描述",rows:3,className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{className:"flex space-x-3 pt-4",children:[n.jsx("button",{onClick:()=>l(!1),className:"flex-1 bg-neutral-100 hover:bg-neutral-200 text-neutral-700 py-2 rounded-lg transition-colors",children:"取消"}),n.jsx("button",{onClick:y,disabled:!h.name||!h.description,className:"flex-1 bg-primary-600 hover:bg-primary-700 text-white py-2 rounded-lg transition-colors disabled:bg-neutral-300 disabled:cursor-not-allowed",children:"确定"})]})]})]})})}),c&&f&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[60]",children:n.jsx("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full mx-4",children:n.jsxs("div",{className:"p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h3",{className:"text-lg font-semibold text-neutral-900",children:"编辑检查点"}),n.jsx("button",{onClick:()=>o(!1),className:"text-neutral-400 hover:text-neutral-600 transition-colors",children:n.jsx(Ze,{className:"w-5 h-5"})})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:["检查点名称 ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:h.name,onChange:j=>p({...h,name:j.target.value}),className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:["检查点描述 ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("textarea",{value:h.description,onChange:j=>p({...h,description:j.target.value}),rows:3,className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{className:"flex space-x-3 pt-4",children:[n.jsx("button",{onClick:()=>o(!1),className:"flex-1 bg-neutral-100 hover:bg-neutral-200 text-neutral-700 py-2 rounded-lg transition-colors",children:"取消"}),n.jsx("button",{onClick:N,disabled:!h.name||!h.description,className:"flex-1 bg-primary-600 hover:bg-primary-700 text-white py-2 rounded-lg transition-colors disabled:bg-neutral-300 disabled:cursor-not-allowed",children:"保存"})]})]})]})})}),u&&f&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[60]",children:n.jsx("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full mx-4",children:n.jsxs("div",{className:"p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h3",{className:"text-lg font-semibold text-neutral-900",children:"删除检查点"}),n.jsx("button",{onClick:()=>d(!1),className:"text-neutral-400 hover:text-neutral-600 transition-colors",children:n.jsx(Ze,{className:"w-5 h-5"})})]}),n.jsxs("div",{className:"mb-6",children:[n.jsxs("p",{className:"text-neutral-700",children:["确定要删除检查点 ",n.jsxs("span",{className:"font-semibold",children:['"',f.name,'"']})," 吗？"]}),n.jsx("p",{className:"text-sm text-neutral-500 mt-2",children:"此操作不可恢复。"})]}),n.jsxs("div",{className:"flex space-x-3",children:[n.jsx("button",{onClick:()=>d(!1),className:"flex-1 bg-neutral-100 hover:bg-neutral-200 text-neutral-700 py-2 rounded-lg transition-colors",children:"取消"}),n.jsx("button",{onClick:F,className:"flex-1 bg-red-600 hover:bg-red-700 text-white py-2 rounded-lg transition-colors",children:"确认删除"})]})]})})})]})},tT=({checkName:e,totalCheckPoints:t,onComplete:r,onClose:a})=>{const[s,i]=M.useState(0),[l,c]=M.useState(0),[o,u]=M.useState(!1),[d,f]=M.useState(null),x=[{id:0,name:"初始化检查",description:"正在准备检查环境..."},{id:1,name:"文件加载",description:"正在加载投标文件..."},{id:2,name:"解析文档结构",description:"正在解析文档结构和内容..."},{id:3,name:"基础信息检查",description:"正在检查项目基础信息..."},{id:4,name:"资格要求检查",description:"正在核对资格要求符合性..."},{id:5,name:"评审要求检查",description:"正在检查评审标准对应性..."},{id:6,name:"文件完整性检查",description:"正在检查投标文件完整性..."},{id:7,name:"风险项检查",description:"正在识别风险项和废标项..."},{id:8,name:"目录完整性检查",description:"正在核对投标文件目录..."},{id:9,name:"生成检查报告",description:"正在生成详细检查报告..."},{id:10,name:"完成",description:"检查完成"}];M.useEffect(()=>{const p=setInterval(()=>{c(m=>m>=100?(clearInterval(p),100):m+1)},80);return()=>clearInterval(p)},[]),M.useEffect(()=>{const p=Math.floor(l/(100/x.length));p<x.length&&i(p),l===100&&setTimeout(()=>{const m=Math.floor(Math.random()*5)+(t-5),w=t-m,v=Array.from({length:t},(y,N)=>({id:`cp-${N+1}`,name:`检查点 ${N+1}`,status:N<m?"passed":"failed",message:N<m?"检查通过":"检查未通过，请核对相关内容"})),b={passed:m,failed:w,details:v};f(b),u(!0),r(b)},500)},[l,x.length,t,r]);const h=()=>{alert("导出检查报告功能开发中...")};return o&&d?n.jsxs("div",{className:"flex flex-col h-full bg-white",children:[n.jsxs("div",{className:"px-6 py-4 border-b border-neutral-200 flex items-center justify-between",children:[n.jsx("h3",{className:"text-lg font-semibold text-neutral-900",children:"投标文件检查"}),n.jsx("button",{onClick:a,className:"text-neutral-400 hover:text-neutral-600 transition-colors",children:n.jsx(Ze,{className:"w-5 h-5"})})]}),n.jsx("div",{className:"flex-1 overflow-auto p-6",children:n.jsxs("div",{className:"max-w-2xl mx-auto",children:[n.jsxs("div",{className:"text-center mb-8",children:[n.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 rounded-full bg-green-100 mb-6",children:n.jsx(Zn,{className:"w-12 h-12 text-green-600"})}),n.jsx("h3",{className:"text-2xl font-semibold text-neutral-900 mb-2",children:"检查完成"}),n.jsx("p",{className:"text-neutral-600 mb-8",children:"投标文件检查已完成，可以导出检查报告。"}),n.jsxs("div",{className:"flex justify-center space-x-4",children:[n.jsxs("button",{onClick:h,className:"px-6 py-3 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors flex items-center",children:[n.jsx(js,{className:"w-5 h-5 mr-2"}),"导出报告"]}),n.jsx("button",{onClick:a,className:"px-6 py-3 border border-neutral-300 text-neutral-700 rounded-lg hover:bg-neutral-50 transition-colors",children:"关闭"})]})]}),n.jsxs("div",{className:"bg-neutral-50 rounded-lg p-6 space-y-4 mb-8",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-sm text-neutral-600",children:"检查名称："}),n.jsx("span",{className:"text-sm font-medium text-neutral-900",children:e})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-sm text-neutral-600",children:"总检查点："}),n.jsxs("span",{className:"text-sm font-medium text-neutral-900",children:[t," 个"]})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-sm text-neutral-600",children:"通过检查点："}),n.jsxs("span",{className:"text-sm font-medium text-green-600",children:[d.passed," 个"]})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-sm text-neutral-600",children:"失败检查点："}),n.jsxs("span",{className:"text-sm font-medium text-red-600",children:[d.failed," 个"]})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-sm text-neutral-600",children:"通过率："}),n.jsxs("span",{className:"text-sm font-medium text-neutral-900",children:[Math.round(d.passed/t*100),"%"]})]})]}),n.jsxs("div",{className:"bg-neutral-50 rounded-lg p-6",children:[n.jsx("h4",{className:"font-medium text-neutral-900 mb-4",children:"检查详情"}),n.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:d.details.map(p=>n.jsxs("div",{className:`flex items-start p-3 rounded-lg ${p.status==="passed"?"bg-white border border-green-200":"bg-white border border-red-200"}`,children:[n.jsx("div",{className:`flex-shrink-0 w-5 h-5 rounded-full flex items-center justify-center mr-3 mt-0.5 ${p.status==="passed"?"bg-green-100":"bg-red-100"}`,children:p.status==="passed"?n.jsx(Zn,{className:"w-3 h-3 text-green-600"}):n.jsx(Ze,{className:"w-3 h-3 text-red-600"})}),n.jsxs("div",{className:"flex-1",children:[n.jsx("div",{className:"font-medium text-neutral-900 text-sm",children:p.name}),n.jsx("div",{className:`text-xs mt-1 ${p.status==="passed"?"text-green-700":"text-red-700"}`,children:p.message})]})]},p.id))})]})]})})]}):n.jsxs("div",{className:"flex flex-col h-full bg-white",children:[n.jsxs("div",{className:"px-6 py-4 border-b border-neutral-200",children:[n.jsx("h3",{className:"text-lg font-semibold text-neutral-900",children:"正在检查投标文件"}),n.jsx("p",{className:"text-sm text-neutral-600 mt-1",children:e})]}),n.jsx("div",{className:"flex-1 overflow-auto p-6",children:n.jsxs("div",{className:"max-w-2xl mx-auto",children:[n.jsxs("div",{className:"mb-8",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("span",{className:"text-sm font-medium text-neutral-700",children:"检查进度"}),n.jsxs("span",{className:"text-sm font-medium text-primary-600",children:[l,"%"]})]}),n.jsx("div",{className:"w-full bg-neutral-200 rounded-full h-3 overflow-hidden",children:n.jsx("div",{className:"bg-primary-600 h-full rounded-full transition-all duration-300 ease-out",style:{width:`${l}%`}})})]}),n.jsx("div",{className:"space-y-4",children:x.map((p,m)=>{const w=m<s,v=m===s;return n.jsxs("div",{className:`flex items-start p-4 rounded-lg transition-all ${v?"bg-primary-50 border-2 border-primary-200":w?"bg-green-50 border border-green-200":"bg-neutral-50 border border-neutral-200"}`,children:[n.jsx("div",{className:`flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center mr-4 ${v?"bg-primary-600":w?"bg-green-600":"bg-neutral-300"}`,children:w?n.jsx(Zn,{className:"w-5 h-5 text-white"}):v?n.jsx($u,{className:"w-5 h-5 text-white animate-spin"}):n.jsx("span",{className:"text-sm font-medium text-white",children:m+1})}),n.jsxs("div",{className:"flex-1",children:[n.jsx("div",{className:`font-medium mb-1 ${v?"text-primary-900":w?"text-green-900":"text-neutral-600"}`,children:p.name}),n.jsx("div",{className:`text-sm ${v?"text-primary-700":w?"text-green-700":"text-neutral-500"}`,children:v?p.description:w?"已完成":"等待中"})]})]},p.id)})})]})})]})},rT=[{id:"1",name:"某医院信息化建设项目",status:"已完成",createdAt:"2024-01-20"},{id:"2",name:"某市智慧城市建设项目",status:"已完成",createdAt:"2024-01-18"},{id:"3",name:"教育信息化项目",status:"已完成",createdAt:"2024-01-15"},{id:"4",name:"政务系统采购项目",status:"进行中",createdAt:"2024-01-12"}],nT=[{id:"p1",name:"项目基础信息",selected:!0},{id:"p2",name:"资格要求",selected:!0},{id:"p3",name:"评审要求",selected:!0},{id:"p4",name:"投标文件要求（投标文件完整性）",selected:!0},{id:"p5",name:"风险项/废标项",selected:!0},{id:"p6",name:"投标文件目录（目录完整性）",selected:!0}],aT=[{id:"pub1",name:"盖章项检查",description:"检查投标文件中涉及盖章的部分是否全部盖章",selected:!1}],sT=({onClose:e,onComplete:t})=>{const[r,a]=M.useState(1),[s,i]=M.useState(""),[l,c]=M.useState(null),[o,u]=M.useState(null),[d,f]=M.useState(nT),[x,h]=M.useState(aT),[p,m]=M.useState([]),[w,v]=M.useState({name:"",description:""}),[b,y]=M.useState(""),[N,F]=M.useState(!1),[j,k]=M.useState(0),P=rT.filter(g=>g.status==="已完成").filter(g=>g.name.toLowerCase().includes(b.toLowerCase())),D=g=>{var A;const _=(A=g.target.files)==null?void 0:A[0];if(_){if(_.type!=="application/pdf"){alert("仅支持PDF格式文件");return}if(_.size>50*1024*1024){alert("文件大小不能超过50MB");return}u(_)}},K=()=>{if(r===1){if(!s.trim()){alert("请输入检查名称");return}if(!o){alert("请上传要检查的文件");return}}if(r===2){if(!l){alert("请选择招标项目");return}if(d.filter(_=>_.selected).length===0){alert("请至少选择一个检查点");return}}if(r<4)a(r+1);else{const g=[...d.filter(_=>_.selected),...x.filter(_=>_.selected),...p].length;k(g),F(!0)}},C=()=>{r>1&&a(r-1)},Y=g=>{t({name:s,documentName:o==null?void 0:o.name,documentType:"uploaded",totalCheckPoints:g.passed+g.failed,passedCheckPoints:g.passed,failedCheckPoints:g.failed})},B=()=>{e()},ee=g=>{f(d.map(_=>_.id===g?{..._,selected:!_.selected}:_))},re=g=>{h(x.map(_=>_.id===g?{..._,selected:!_.selected}:_))},Q=()=>{if(!w.name.trim()||!w.description.trim()){alert("请填写完整的检查点信息");return}const g={id:`project-${Date.now()}`,name:w.name,description:w.description};m([...p,g]),v({name:"",description:""})},te=g=>{m(p.filter(_=>_.id!==g))},H=()=>n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:["检查名称 ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:s,onChange:g=>i(g.target.value),placeholder:"请输入投标文件检查名称",className:"w-full px-4 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:["上传投标文件 ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsxs("div",{className:"border-2 border-dashed border-neutral-300 rounded-lg p-8 text-center hover:border-primary-500 transition-colors cursor-pointer",onClick:()=>{var g;return(g=document.getElementById("file-upload"))==null?void 0:g.click()},children:[n.jsx(wt,{className:"w-12 h-12 mx-auto text-neutral-400 mb-3"}),n.jsx("p",{className:"text-sm text-neutral-600 mb-1 font-medium",children:"点击上传"}),n.jsx("p",{className:"text-xs text-neutral-500",children:"或拖拽文件到此处（注：盖章项检查需上传pdf）"}),n.jsx("input",{type:"file",accept:".pdf",onChange:D,className:"hidden",id:"file-upload"})]}),o&&n.jsx("div",{className:"mt-4",children:n.jsxs("div",{className:"flex items-center justify-between bg-primary-50 border border-primary-200 px-4 py-3 rounded-lg",children:[n.jsxs("div",{className:"flex items-center space-x-3 flex-1 min-w-0",children:[n.jsx(Pt,{className:"w-5 h-5 text-primary-600 flex-shrink-0"}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("p",{className:"text-sm font-medium text-neutral-900 truncate",children:o.name}),n.jsxs("p",{className:"text-xs text-neutral-600 mt-0.5",children:[(o.size/1024/1024).toFixed(2)," MB"]})]})]}),n.jsx("button",{onClick:g=>{g.stopPropagation(),u(null)},className:"text-red-600 hover:text-red-800 transition-colors ml-3 flex-shrink-0",children:n.jsx(Ze,{className:"w-5 h-5"})})]})})]})]}),ae=()=>n.jsxs("div",{className:"space-y-6",children:[n.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:n.jsx("p",{className:"text-sm text-blue-800",children:'请选择招标项目（仅显示状态为"已完成"的项目），选择后可配置招标要求检查点'})}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:["选择招标项目 ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("div",{className:"mb-3",children:n.jsx("input",{type:"text",placeholder:"搜索招标项目...",value:b,onChange:g=>y(g.target.value),className:"w-full px-4 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})}),n.jsx("div",{className:"max-h-[280px] overflow-y-auto border border-neutral-200 rounded-lg",children:P.length===0?n.jsxs("div",{className:"p-8 text-center text-neutral-500",children:[n.jsx(po,{className:"w-12 h-12 mx-auto mb-3 text-neutral-400"}),n.jsx("p",{children:"暂无已完成的招标项目"})]}):P.map(g=>n.jsx("div",{onClick:()=>c(g),className:`p-4 border-b border-neutral-100 last:border-b-0 cursor-pointer transition-colors ${(l==null?void 0:l.id)===g.id?"bg-primary-50 border-l-4 border-l-primary-500":"hover:bg-neutral-50"}`,children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center flex-1",children:[n.jsx(po,{className:"w-5 h-5 mr-3 text-primary-600"}),n.jsxs("div",{className:"flex-1",children:[n.jsx("div",{className:"font-medium text-neutral-900",children:g.name}),n.jsxs("div",{className:"text-sm text-neutral-600 mt-1",children:["创建时间: ",g.createdAt]})]})]}),n.jsx("span",{className:"text-xs px-2 py-1 rounded bg-green-100 text-green-800",children:g.status})]})},g.id))})]}),l&&n.jsxs("div",{children:[n.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4",children:n.jsx("p",{className:"text-sm text-blue-800",children:"以下为招标要求检查点，默认全部选中，您可以取消不需要的检查点"})}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex items-center justify-between mb-3",children:[n.jsx("h4",{className:"font-medium text-neutral-900",children:"招标要求检查点"}),n.jsxs("span",{className:"text-sm text-neutral-600",children:["已选择 ",d.filter(g=>g.selected).length," / ",d.length]})]}),n.jsx("div",{className:"border border-neutral-200 rounded-lg p-4 max-h-80 overflow-y-auto",children:n.jsx("div",{className:"grid grid-cols-2 gap-2",children:d.map(g=>n.jsxs("label",{className:"flex items-center p-2 bg-neutral-50 rounded hover:bg-neutral-100 cursor-pointer transition-colors",children:[n.jsx("input",{type:"checkbox",checked:g.selected,onChange:()=>ee(g.id),className:"w-4 h-4 text-primary-600 rounded mr-2 flex-shrink-0"}),n.jsx("span",{className:"text-sm text-neutral-900",children:g.name})]},g.id))})})]})]})]}),he=()=>n.jsxs("div",{className:"space-y-6",children:[n.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:n.jsx("p",{className:"text-sm text-green-800",children:"这是可选步骤，您可以添加招标文件解析以外的检查点"})}),n.jsxs("div",{children:[n.jsx("h4",{className:"font-medium text-neutral-900 mb-3",children:"通用检查点选择"}),n.jsx("div",{className:"border border-neutral-200 rounded-lg p-4 max-h-80 overflow-y-auto",children:x.length===0?n.jsxs("div",{className:"text-center text-neutral-500 py-8",children:[n.jsx($x,{className:"w-12 h-12 mx-auto mb-3 text-neutral-400"}),n.jsx("p",{children:"暂无通用检查点"}),n.jsx("p",{className:"text-sm mt-1",children:'请前往"通用检查点管理"添加'})]}):n.jsx("div",{className:"space-y-2",children:x.map(g=>n.jsxs("label",{className:"flex items-start p-3 bg-neutral-50 rounded hover:bg-neutral-100 cursor-pointer transition-colors",children:[n.jsx("input",{type:"checkbox",checked:g.selected,onChange:()=>re(g.id),className:"w-4 h-4 text-primary-600 rounded mt-0.5 mr-3 flex-shrink-0"}),n.jsxs("div",{className:"flex-1",children:[n.jsx("div",{className:"font-medium text-neutral-900",children:g.name}),n.jsx("div",{className:"text-sm text-neutral-600 mt-1",children:g.description})]})]},g.id))})})]}),n.jsxs("div",{children:[n.jsx("h4",{className:"font-medium text-neutral-900 mb-3",children:"针对该项目的检查点"}),n.jsxs("div",{className:"space-y-3 bg-neutral-50 rounded-lg p-4",children:[n.jsx("div",{children:n.jsx("input",{type:"text",placeholder:"检查点名称",value:w.name,onChange:g=>v({...w,name:g.target.value}),className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})}),n.jsx("div",{children:n.jsx("textarea",{placeholder:"检查点描述",value:w.description,onChange:g=>v({...w,description:g.target.value}),rows:2,className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})}),n.jsxs("button",{onClick:Q,className:"w-full px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center justify-center",children:[n.jsx(Ct,{className:"w-4 h-4 mr-1"}),"添加项目检查点"]})]}),p.length>0&&n.jsxs("div",{className:"mt-4 space-y-2",children:[n.jsxs("h5",{className:"text-sm font-medium text-neutral-700",children:["已添加的项目检查点 (",p.length,")"]}),p.map(g=>n.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:n.jsxs("div",{className:"flex items-start justify-between",children:[n.jsxs("div",{className:"flex-1",children:[n.jsx("div",{className:"font-medium text-neutral-900",children:g.name}),n.jsx("div",{className:"text-sm text-neutral-600 mt-1",children:g.description})]}),n.jsx("button",{onClick:()=>te(g.id),className:"text-red-600 hover:text-red-800 ml-2",children:n.jsx(qe,{className:"w-4 h-4"})})]})},g.id))]})]})]}),O=()=>{const g=d.filter(ne=>ne.selected).length,_=x.filter(ne=>ne.selected).length,A=g+_+p.length;return n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"text-center",children:[n.jsx($x,{className:"w-16 h-16 text-primary-600 mx-auto mb-4"}),n.jsx("h3",{className:"text-xl font-semibold text-neutral-900 mb-2",children:"确认检查信息"}),n.jsx("p",{className:"text-neutral-600",children:"请确认以下信息无误后，开始检查"})]}),n.jsxs("div",{className:"bg-neutral-50 rounded-lg p-6 space-y-4",children:[n.jsxs("div",{children:[n.jsx("span",{className:"text-sm text-neutral-600",children:"检查名称："}),n.jsx("p",{className:"font-medium text-neutral-900 mt-1",children:s})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-sm text-neutral-600",children:"上传文件："}),n.jsx("p",{className:"font-medium text-neutral-900 mt-1",children:o==null?void 0:o.name})]}),l&&n.jsxs("div",{children:[n.jsx("span",{className:"text-sm text-neutral-600",children:"关联招标项目："}),n.jsx("p",{className:"font-medium text-neutral-900 mt-1",children:l.name})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-sm text-neutral-600",children:"总检查点数："}),n.jsx("p",{className:"font-medium text-neutral-900 mt-1",children:A})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-sm text-neutral-600",children:"检查点分布："}),n.jsxs("div",{className:"mt-2 space-y-1 text-sm",children:[n.jsxs("p",{className:"text-neutral-700",children:["• 招标要求检查点: ",g," 个"]}),n.jsxs("p",{className:"text-neutral-700",children:["• 通用检查点: ",_," 个"]}),n.jsxs("p",{className:"text-neutral-700",children:["• 项目检查点: ",p.length," 个"]})]})]})]})]})},I=[{number:1,title:"基本信息"},{number:2,title:"招标项目与检查点"},{number:3,title:"新增检查点"},{number:4,title:"确认信息"}];return N?n.jsx(tT,{checkName:s,totalCheckPoints:j,onComplete:Y,onClose:B}):n.jsx("div",{className:"flex flex-col h-full",children:n.jsx("div",{className:"flex-1 overflow-auto",children:n.jsxs("div",{className:"bg-white rounded-lg border border-neutral-200",children:[n.jsxs("div",{className:"px-6 py-4 border-b border-neutral-200",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsx("h3",{className:"text-lg font-semibold text-neutral-900",children:"新建投标文件检查"}),n.jsx("button",{onClick:e,className:"text-neutral-400 hover:text-neutral-600 transition-colors",children:n.jsx(Ze,{className:"w-5 h-5"})})]}),n.jsx("div",{className:"flex items-center justify-between",children:I.map((g,_)=>n.jsxs(mr.Fragment,{children:[n.jsxs("div",{className:"flex flex-col items-center",children:[n.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center font-medium transition-colors ${r>=g.number?"bg-primary-600 text-white":"bg-neutral-200 text-neutral-600"}`,children:g.number}),n.jsx("span",{className:`text-xs mt-2 text-center ${r>=g.number?"text-primary-600 font-medium":"text-neutral-600"}`,children:g.title})]}),_<I.length-1&&n.jsx("div",{className:`flex-1 h-0.5 mx-2 transition-colors ${r>g.number?"bg-primary-600":"bg-neutral-200"}`})]},g.number))})]}),n.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[r===1&&H(),r===2&&ae(),r===3&&he(),r===4&&O()]}),n.jsx("div",{className:"p-6 border-t border-neutral-200",children:n.jsxs("div",{className:"flex justify-between",children:[n.jsxs("button",{onClick:C,disabled:r===1,className:`px-6 py-2 rounded-lg transition-colors flex items-center ${r===1?"bg-neutral-100 text-neutral-400 cursor-not-allowed":"bg-neutral-100 hover:bg-neutral-200 text-neutral-700"}`,children:[n.jsx(pb,{className:"w-4 h-4 mr-1"}),"上一步"]}),n.jsxs("button",{onClick:K,className:"px-6 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors flex items-center",children:[r===4?"开始检查":"下一步",r<4&&n.jsx(Hu,{className:"w-4 h-4 ml-1"})]})]})})]})})})},iT=[{id:"1",name:"某医院信息化建设项目投标文件检查",documentName:"某医院信息化建设项目投标书.pdf",documentType:"generated",status:"not_passed",totalCheckPoints:25,passedCheckPoints:22,failedCheckPoints:3,checkPointDetails:[{name:"封面格式检查",category:"格式规范",status:"passed",description:"封面信息完整，格式符合要求"},{name:"目录完整性检查",category:"格式规范",status:"passed",description:"目录层级清晰，页码准确"},{name:"投标函签字盖章",category:"格式规范",status:"passed",description:"投标函已由法定代表人签字并加盖公章"},{name:"法定代表人授权书",category:"资格文件",status:"passed",description:"授权书格式正确，授权人签字清晰"},{name:"营业执照副本",category:"资格文件",status:"passed",description:"营业执照在有效期内，加盖公章"},{name:"资质证书",category:"资格文件",status:"passed",description:"资质证书齐全有效，满足招标要求"},{name:"ISO质量管理体系认证",category:"资格文件",status:"passed",description:"质量管理体系认证证书有效"},{name:"财务审计报告",category:"资格文件",status:"passed",description:"提供了2023年度完整财务审计报告"},{name:"类似业绩证明",category:"资格文件",status:"passed",description:"提供了3个类似项目业绩，满足要求"},{name:"投标报价表",category:"商务部分",status:"failed",description:"报价表缺少部分必填项，未填写税率"},{name:"报价说明",category:"商务部分",status:"passed",description:"报价说明详细，费用构成清晰"},{name:"投标保证金凭证",category:"商务部分",status:"passed",description:"提供了银行转账凭证，金额正确"},{name:"技术方案完整性",category:"技术部分",status:"passed",description:"技术方案详细完整，逻辑清晰"},{name:"技术参数响应",category:"技术部分",status:"passed",description:"技术参数完全响应招标文件要求"},{name:"实施方案",category:"技术部分",status:"passed",description:"实施方案合理可行，进度安排明确"},{name:"项目组织架构",category:"技术部分",status:"passed",description:"项目组织架构完整，职责分工明确"},{name:"项目经理资格证书",category:"人员资质",status:"passed",description:"项目经理具有一级建造师资格"},{name:"主要技术人员证书",category:"人员资质",status:"failed",description:"缺少1名技术人员的职称证书"},{name:"质量保证措施",category:"技术部分",status:"passed",description:"质量保证措施完善，符合要求"},{name:"安全保障措施",category:"技术部分",status:"passed",description:"安全措施详细，应急预案完整"},{name:"售后服务方案",category:"技术部分",status:"passed",description:"售后服务承诺明确，响应时间合理"},{name:"培训方案",category:"技术部分",status:"passed",description:"培训方案详细，培训内容全面"},{name:"设备清单",category:"技术部分",status:"passed",description:"设备清单完整，品牌型号明确"},{name:"设备制造商授权书",category:"技术部分",status:"failed",description:"缺少主要设备制造商授权书原件"},{name:"投标文件装订",category:"格式规范",status:"passed",description:"投标文件装订规范，便于查阅"}],createdAt:"2024-01-20 14:30:00",completedAt:"2024-01-20 14:35:00"},{id:"2",name:"智慧城市项目标书质量检查",documentName:"智慧城市建设项目技术方案.pdf",documentType:"uploaded",status:"checking",totalCheckPoints:30,passedCheckPoints:0,failedCheckPoints:0,createdAt:"2024-01-18 10:15:00",completedAt:null},{id:"3",name:"教育信息化项目投标文件审核",documentName:"教育信息化建设投标书.pdf",documentType:"generated",status:"pending",totalCheckPoints:28,passedCheckPoints:0,failedCheckPoints:0,createdAt:"2024-01-15 09:00:00",completedAt:null},{id:"4",name:"政务系统采购项目投标文件检查",documentName:"政务系统采购投标文件.pdf",documentType:"uploaded",status:"failed",totalCheckPoints:32,passedCheckPoints:0,failedCheckPoints:0,createdAt:"2024-01-12 16:20:00",completedAt:null},{id:"5",name:"交通运输系统集成项目投标文件检查",documentName:"交通运输系统集成投标书.pdf",documentType:"generated",status:"passed",totalCheckPoints:20,passedCheckPoints:20,failedCheckPoints:0,checkPointDetails:[{name:"封面格式检查",category:"格式规范",status:"passed",description:"封面信息完整，格式符合要求"},{name:"目录完整性检查",category:"格式规范",status:"passed",description:"目录层级清晰，页码准确"},{name:"投标函签字盖章",category:"格式规范",status:"passed",description:"投标函已由法定代表人签字并加盖公章"},{name:"法定代表人授权书",category:"资格文件",status:"passed",description:"授权书格式正确，授权人签字清晰"},{name:"营业执照副本",category:"资格文件",status:"passed",description:"营业执照在有效期内，加盖公章"},{name:"资质证书",category:"资格文件",status:"passed",description:"资质证书齐全有效，满足招标要求"},{name:"财务审计报告",category:"资格文件",status:"passed",description:"提供了2023年度完整财务审计报告"},{name:"类似业绩证明",category:"资格文件",status:"passed",description:"提供了2个类似项目业绩，满足要求"},{name:"投标报价表",category:"商务部分",status:"passed",description:"报价表填写完整，格式规范"},{name:"报价说明",category:"商务部分",status:"passed",description:"报价说明详细，费用构成清晰"},{name:"投标保证金凭证",category:"商务部分",status:"passed",description:"提供了银行保函，金额正确"},{name:"技术方案完整性",category:"技术部分",status:"passed",description:"技术方案详细完整，方案可行"},{name:"技术参数响应",category:"技术部分",status:"passed",description:"技术参数完全响应招标文件要求"},{name:"实施方案",category:"技术部分",status:"passed",description:"实施方案合理，进度安排科学"},{name:"项目经理资格证书",category:"人员资质",status:"passed",description:"项目经理具有PMP资格证书"},{name:"主要技术人员证书",category:"人员资质",status:"passed",description:"技术人员证书齐全，满足要求"},{name:"质量保证措施",category:"技术部分",status:"passed",description:"质量保证措施完善，符合要求"},{name:"售后服务方案",category:"技术部分",status:"passed",description:"售后服务承诺明确，响应时间合理"},{name:"设备清单",category:"技术部分",status:"passed",description:"设备清单完整，品牌型号明确"},{name:"投标文件装订",category:"格式规范",status:"passed",description:"投标文件装订规范，便于查阅"}],createdAt:"2024-01-22 11:00:00",completedAt:"2024-01-22 11:05:00"}],lT=({canEdit:e=!0,canDelete:t=!0})=>{const[r,a]=M.useState(iT),[s,i]=M.useState(!1),[l,c]=M.useState(""),[o,u]=M.useState("all"),[d,f]=M.useState(1),[x,h]=M.useState(10),[p,m]=M.useState(""),[w,v]=M.useState("list"),[b,y]=M.useState(!1),[N,F]=M.useState(null),[j,k]=M.useState(!1),S=()=>{c(""),u("all"),f(1)},P=()=>{f(1)},D=()=>r.filter(g=>{const _=!l||g.name.toLowerCase().includes(l.toLowerCase()),A=o==="all"||g.status===o;return _&&A}).sort((g,_)=>new Date(_.createdAt).getTime()-new Date(g.createdAt).getTime()),K=()=>{const g=D(),_=(d-1)*x,A=_+x;return g.slice(_,A)},C=Math.ceil(D().length/x),Y=g=>({pending:{text:"待检查",color:"bg-yellow-100 text-yellow-800"},checking:{text:"检查中",color:"bg-blue-100 text-blue-800"},passed:{text:"检查通过",color:"bg-green-100 text-green-800"},not_passed:{text:"检查不通过",color:"bg-orange-100 text-orange-800"},failed:{text:"检查失败",color:"bg-red-100 text-red-800"}})[g]||{text:g,color:"bg-gray-100 text-gray-800"},B=(g,_)=>{const ne=[{name:"封面格式检查",category:"格式规范",description:"封面信息完整，格式符合要求"},{name:"目录完整性检查",category:"格式规范",description:"目录层级清晰，页码准确"},{name:"投标函签字盖章",category:"格式规范",description:"投标函已由法定代表人签字并加盖公章"},{name:"法定代表人授权书",category:"资格文件",description:"授权书格式正确，授权人签字清晰"},{name:"营业执照副本",category:"资格文件",description:"营业执照在有效期内，加盖公章"},{name:"资质证书",category:"资格文件",description:"资质证书齐全有效，满足招标要求"},{name:"ISO质量管理体系认证",category:"资格文件",description:"质量管理体系认证证书有效"},{name:"财务审计报告",category:"资格文件",description:"提供了2023年度完整财务审计报告"},{name:"类似业绩证明",category:"资格文件",description:"提供了类似项目业绩，满足要求"},{name:"投标报价表",category:"商务部分",description:"报价表填写完整，格式规范"},{name:"报价说明",category:"商务部分",description:"报价说明详细，费用构成清晰"},{name:"投标保证金凭证",category:"商务部分",description:"提供了投标保证金缴纳凭证"},{name:"技术方案完整性",category:"技术部分",description:"技术方案详细完整，逻辑清晰"},{name:"技术参数响应",category:"技术部分",description:"技术参数完全响应招标文件要求"},{name:"实施方案",category:"技术部分",description:"实施方案合理可行，进度安排明确"},{name:"项目组织架构",category:"技术部分",description:"项目组织架构完整，职责分工明确"},{name:"项目经理资格证书",category:"人员资质",description:"项目经理具有相应资格证书"},{name:"主要技术人员证书",category:"人员资质",description:"技术人员证书齐全，满足要求"},{name:"质量保证措施",category:"技术部分",description:"质量保证措施完善，符合要求"},{name:"安全保障措施",category:"技术部分",description:"安全措施详细，应急预案完整"},{name:"售后服务方案",category:"技术部分",description:"售后服务承诺明确，响应时间合理"},{name:"培训方案",category:"技术部分",description:"培训方案详细，培训内容全面"},{name:"设备清单",category:"技术部分",description:"设备清单完整，品牌型号明确"},{name:"设备制造商授权书",category:"技术部分",description:"提供了设备制造商授权书"},{name:"投标文件装订",category:"格式规范",description:"投标文件装订规范，便于查阅"}].slice(0,g),ue=new Set;for(;ue.size<_;){const ve=Math.floor(Math.random()*g);ue.add(ve)}return ne.map((ve,xe)=>({...ve,status:ue.has(xe)?"failed":"passed",description:ue.has(xe)?ve.description.replace("完整","不完整").replace("齐全","缺失").replace("有效","过期").replace("符合","不符合"):ve.description}))},ee=g=>{F(g),y(!0)},re=()=>{N&&a(r.filter(g=>g.id!==N.id)),y(!1),F(null)},Q=g=>{F(g),k(!0)},te=g=>{v("create")},H=g=>{a(r.map(_=>_.id===g.id?{..._,status:"checking"}:_)),setTimeout(()=>{const _=Math.floor(Math.random()*5)+(g.totalCheckPoints-5),A=g.totalCheckPoints-_,ne=B(g.totalCheckPoints,A);a(r.map(ue=>ue.id===g.id?{...ue,status:A>0?"not_passed":"passed",passedCheckPoints:_,failedCheckPoints:A,checkPointDetails:ne,completedAt:new Date().toLocaleString("zh-CN")}:ue))},3e3)},ae=g=>{h(g),f(1)},he=()=>{const g=parseInt(p);g>=1&&g<=C&&(f(g),m(""))},O=g=>{const _=g.failedCheckPoints||0,A=B(g.totalCheckPoints,_),ne={id:String(Date.now()),name:g.name,documentName:g.documentName,documentType:g.documentType,status:_>0?"not_passed":"passed",totalCheckPoints:g.totalCheckPoints,passedCheckPoints:g.passedCheckPoints||0,failedCheckPoints:_,checkPointDetails:A,createdAt:new Date().toLocaleString("zh-CN"),completedAt:new Date().toLocaleString("zh-CN")};a([ne,...r]),v("list")},I=g=>{const _=`投标文件检查报告

检查名称：${g.name}
文件名称：${g.documentName}
文件来源：${g.documentType==="generated"?"生成文件":"上传文件"}
检查时间：${g.createdAt}
完成时间：${g.completedAt}

检查结果：
总检查点：${g.totalCheckPoints}
通过：${g.passedCheckPoints}
失败：${g.failedCheckPoints}
通过率：${(g.passedCheckPoints/g.totalCheckPoints*100).toFixed(2)}%

详细检查点：
1. 封面格式检查 [通过] - 封面信息完整，格式符合要求
2. 目录完整性检查 [通过] - 目录层级清晰，页码准确
3. 技术方案完整性 [通过] - 技术方案详细完整
4. 报价表格式 [失败] - 报价表缺少部分必填项
5. 资质证书 [通过] - 资质证书齐全有效

生成时间：${new Date().toLocaleString("zh-CN")}
`,A=new Blob([_],{type:"text/plain;charset=utf-8"}),ne=URL.createObjectURL(A),ue=document.createElement("a");ue.href=ne,ue.download=`${g.name}_检查报告.txt`,document.body.appendChild(ue),ue.click(),document.body.removeChild(ue),URL.revokeObjectURL(ne)};return w==="create"?n.jsx(sT,{onClose:()=>v("list"),onComplete:O}):w==="checkpointManager"?n.jsx(eT,{onClose:()=>v("list")}):n.jsxs("div",{className:"flex flex-col h-full",children:[n.jsx("div",{className:"flex-1 overflow-auto",children:n.jsxs("div",{className:"bg-white rounded-lg border border-neutral-200",children:[n.jsxs("div",{className:"px-6 py-4 border-b border-neutral-200",children:[n.jsx("div",{className:"flex items-center justify-between mb-4",children:n.jsxs("div",{children:[n.jsxs("h2",{className:"text-lg font-medium text-neutral-900 flex items-center",children:[n.jsx(yb,{className:"w-5 h-5 mr-2 text-primary-600"}),"投标文件检查"]}),n.jsx("p",{className:"text-sm text-neutral-500 mt-1",children:"管理投标文件检查记录，配置检查点"})]})}),n.jsxs("div",{className:"flex items-center justify-between gap-3",children:[n.jsxs("div",{className:"flex items-center gap-3",children:["检查名称",n.jsx("input",{type:"text",placeholder:"请输入检查名称",value:l,onChange:g=>c(g.target.value),className:"w-64 px-3 py-1.5 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500"}),"状态",n.jsxs("select",{value:o,onChange:g=>u(g.target.value),className:"w-32 px-3 py-1.5 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500",children:[n.jsx("option",{value:"all",children:"全部状态"}),n.jsx("option",{value:"pending",children:"待检查"}),n.jsx("option",{value:"checking",children:"检查中"}),n.jsx("option",{value:"passed",children:"检查通过"}),n.jsx("option",{value:"not_passed",children:"检查不通过"}),n.jsx("option",{value:"failed",children:"检查失败"})]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{onClick:S,className:"px-4 py-1.5 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-50 transition-colors",children:"重置"}),n.jsx("button",{onClick:P,className:"px-4 py-1.5 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors",children:"查询"})]})]})]}),n.jsx("div",{className:"px-6 py-3 border-b border-neutral-200 flex items-center justify-between",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("button",{onClick:()=>v("create"),className:"px-4 py-1.5 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors flex items-center",children:[n.jsx(Ct,{className:"w-4 h-4 mr-1"}),"新增检查"]}),n.jsxs("button",{onClick:()=>v("checkpointManager"),className:"px-4 py-1.5 text-sm bg-green-600 text-white rounded hover:bg-green-700 transition-colors flex items-center",children:[n.jsx(Et,{className:"w-4 h-4 mr-1"}),"通用检查点管理"]})]})}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"w-full",children:[n.jsx("thead",{className:"bg-neutral-50 border-b border-neutral-200",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"序号"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"检查名称"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"文件名称"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"通过/不通过"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"状态"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"创建时间"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"操作"})]})}),n.jsx("tbody",{className:"divide-y divide-neutral-200",children:s?n.jsx("tr",{children:n.jsx("td",{colSpan:7,className:"px-4 py-8 text-center text-neutral-500",children:n.jsxs("div",{className:"flex items-center justify-center",children:[n.jsx(Tl,{className:"w-5 h-5 animate-spin mr-2"}),"加载中..."]})})}):K().length===0?n.jsx("tr",{children:n.jsx("td",{colSpan:7,className:"px-4 py-8 text-center text-neutral-500",children:"暂无数据"})}):K().map((g,_)=>n.jsxs("tr",{className:"hover:bg-neutral-50 transition-colors",children:[n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm text-neutral-900",children:(d-1)*x+_+1}),n.jsx("td",{className:"px-4 py-2.5 text-sm text-neutral-900",children:n.jsx("div",{className:"max-w-xs truncate",title:g.name,children:g.name})}),n.jsx("td",{className:"px-4 py-2.5 text-sm text-neutral-900",children:n.jsx("div",{className:"max-w-xs truncate",title:g.documentName,children:g.documentName})}),n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm",children:g.status==="passed"||g.status==="not_passed"?n.jsxs("span",{children:[n.jsx("span",{className:"text-green-600 font-medium",children:g.passedCheckPoints}),n.jsx("span",{className:"text-neutral-400 mx-1",children:"/"}),n.jsx("span",{className:"text-red-600 font-medium",children:g.failedCheckPoints})]}):n.jsx("span",{className:"text-neutral-400",children:"-"})}),n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded text-xs font-medium ${Y(g.status).color}`,children:Y(g.status).text}),g.status==="checking"&&g.progress!==void 0&&n.jsxs("span",{className:"text-xs text-blue-600 font-medium",children:[g.progress,"%"]})]})}),n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm text-neutral-900",children:g.createdAt}),n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm",children:n.jsxs("div",{className:"flex items-center space-x-2",children:[g.status==="pending"&&n.jsxs("button",{onClick:()=>te(),className:"px-2 py-1 text-xs text-primary-600 hover:text-primary-800 hover:bg-primary-50 rounded transition-colors flex items-center gap-1",children:[n.jsx(Et,{className:"w-3.5 h-3.5"}),"编辑"]}),(g.status==="passed"||g.status==="not_passed")&&n.jsxs(n.Fragment,{children:[n.jsxs("button",{onClick:()=>Q(g),className:"px-2 py-1 text-xs text-blue-600 hover:text-blue-800 hover:bg-blue-50 rounded transition-colors flex items-center gap-1",children:[n.jsx(v1,{className:"w-3.5 h-3.5"}),"查看"]}),n.jsxs("button",{onClick:()=>I(g),className:"px-2 py-1 text-xs text-green-600 hover:text-green-800 hover:bg-green-50 rounded transition-colors flex items-center gap-1",children:[n.jsx(js,{className:"w-3.5 h-3.5"}),"下载"]})]}),g.status==="failed"&&n.jsxs("button",{onClick:()=>H(g),className:"px-2 py-1 text-xs text-orange-600 hover:text-orange-800 hover:bg-orange-50 rounded transition-colors flex items-center gap-1",children:[n.jsx(Tl,{className:"w-3.5 h-3.5"}),"重试"]}),n.jsxs("button",{onClick:()=>ee(g),className:"px-2 py-1 text-xs text-red-600 hover:text-red-800 hover:bg-red-50 rounded transition-colors flex items-center gap-1",children:[n.jsx(qe,{className:"w-3.5 h-3.5"}),"删除"]})]})})]},g.id))})]})})]})}),n.jsxs("div",{className:"bg-white border-t border-neutral-200 px-6 py-3 flex items-center justify-center gap-6",children:[n.jsxs("div",{className:"text-sm text-neutral-700",children:["共 ",D().length," 条"]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("button",{onClick:()=>f(Math.max(1,d-1)),disabled:d===1,className:`px-2 py-1 text-sm rounded transition-colors ${d===1?"bg-neutral-100 text-neutral-400 cursor-not-allowed":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:"<"}),n.jsx("div",{className:"flex items-center space-x-1",children:Array.from({length:Math.min(10,C)},(g,_)=>{let A;return C<=10||d<=5?A=_+1:d>=C-4?A=C-9+_:A=d-4+_,n.jsx("button",{onClick:()=>f(A),className:`px-2.5 py-1 text-sm rounded transition-colors ${d===A?"bg-primary-600 text-white":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:A},A)})}),n.jsx("button",{onClick:()=>f(Math.min(C,d+1)),disabled:d===C,className:`px-2 py-1 text-sm rounded transition-colors ${d===C?"bg-neutral-100 text-neutral-400 cursor-not-allowed":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:">"})]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsxs("select",{value:x,onChange:g=>ae(Number(g.target.value)),className:"px-2 py-1 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500",children:[n.jsx("option",{value:10,children:"10条/页"}),n.jsx("option",{value:20,children:"20条/页"}),n.jsx("option",{value:50,children:"50条/页"})]}),n.jsx("span",{className:"text-sm text-neutral-700",children:"前往"}),n.jsx("input",{type:"number",value:p,onChange:g=>m(g.target.value),placeholder:"页",className:"w-12 px-2 py-1 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500",min:1,max:C}),n.jsx("button",{onClick:he,className:"px-3 py-1 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-50 transition-colors",children:"页"})]})]}),b&&N&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:n.jsx("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full mx-4",children:n.jsxs("div",{className:"p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h3",{className:"text-lg font-semibold text-neutral-900",children:"删除检查记录"}),n.jsx("button",{onClick:()=>y(!1),className:"text-neutral-400 hover:text-neutral-600 transition-colors",children:n.jsx(Ze,{className:"w-5 h-5"})})]}),n.jsxs("div",{className:"mb-6",children:[n.jsxs("p",{className:"text-neutral-700",children:["确定要删除检查记录 ",n.jsxs("span",{className:"font-semibold",children:['"',N.name,'"']})," 吗？"]}),n.jsx("p",{className:"text-sm text-neutral-500 mt-2",children:"此操作不可恢复。"})]}),n.jsxs("div",{className:"flex space-x-3",children:[n.jsx("button",{onClick:()=>y(!1),className:"flex-1 bg-neutral-100 hover:bg-neutral-200 text-neutral-700 py-2 rounded-lg transition-colors",children:"取消"}),n.jsx("button",{onClick:re,className:"flex-1 bg-red-600 hover:bg-red-700 text-white py-2 rounded-lg transition-colors",children:"确认删除"})]})]})})}),j&&N&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:n.jsx("div",{className:"bg-white rounded-xl shadow-xl max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:n.jsxs("div",{className:"p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h3",{className:"text-lg font-semibold text-neutral-900",children:"检查详情"}),n.jsx("button",{onClick:()=>k(!1),className:"text-neutral-400 hover:text-neutral-600 transition-colors",children:n.jsx(Ze,{className:"w-5 h-5"})})]}),n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"bg-neutral-50 rounded-lg p-4",children:[n.jsx("h4",{className:"font-medium text-neutral-900 mb-3",children:"基本信息"}),n.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[n.jsxs("div",{children:[n.jsx("span",{className:"text-neutral-600",children:"检查名称："}),n.jsx("p",{className:"font-medium text-neutral-900 mt-1",children:N.name})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-neutral-600",children:"文件名称："}),n.jsx("p",{className:"font-medium text-neutral-900 mt-1",children:N.documentName})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-neutral-600",children:"文件来源："}),n.jsx("p",{className:"font-medium text-neutral-900 mt-1",children:N.documentType==="generated"?"生成文件":"上传文件"})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-neutral-600",children:"创建时间："}),n.jsx("p",{className:"font-medium text-neutral-900 mt-1",children:N.createdAt})]})]})]}),n.jsxs("div",{className:"bg-green-50 rounded-lg p-4",children:[n.jsx("h4",{className:"font-medium text-green-900 mb-3",children:"检查结果"}),n.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-2xl font-bold text-green-600",children:N.totalCheckPoints}),n.jsx("p",{className:"text-xs text-neutral-600 mt-1",children:"总检查点"})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-2xl font-bold text-green-600",children:N.passedCheckPoints}),n.jsx("p",{className:"text-xs text-neutral-600 mt-1",children:"通过"})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-2xl font-bold text-red-600",children:N.failedCheckPoints}),n.jsx("p",{className:"text-xs text-neutral-600 mt-1",children:"不通过"})]})]})]}),n.jsxs("div",{children:[n.jsx("h4",{className:"font-medium text-neutral-900 mb-3",children:"检查点详情"}),!N.checkPointDetails||N.checkPointDetails.length===0?n.jsxs("div",{className:"text-center py-8 text-neutral-500",children:[n.jsx(Cl,{className:"w-12 h-12 mx-auto mb-2 text-neutral-400"}),n.jsx("p",{children:"暂无检查点详情数据"})]}):n.jsx("div",{className:"space-y-2",children:N.checkPointDetails.map((g,_)=>n.jsx("div",{className:`p-3 rounded-lg border-l-4 ${g.status==="passed"?"bg-green-50 border-green-500":"bg-red-50 border-red-500"}`,children:n.jsxs("div",{className:"flex items-start justify-between",children:[n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[g.status==="passed"?n.jsx(Zn,{className:"w-4 h-4 text-green-600"}):n.jsx(Cl,{className:"w-4 h-4 text-red-600"}),n.jsx("span",{className:"font-medium text-neutral-900",children:g.name}),n.jsx("span",{className:"text-xs px-2 py-0.5 rounded bg-neutral-200 text-neutral-700",children:g.category})]}),n.jsx("p",{className:"text-sm text-neutral-600 ml-6",children:g.description})]}),n.jsx("span",{className:`text-xs font-medium px-2 py-1 rounded ${g.status==="passed"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:g.status==="passed"?"通过":"失败"})]})},_))})]})]}),n.jsxs("div",{className:"flex justify-between mt-6 pt-4 border-t border-neutral-200",children:[n.jsxs("button",{onClick:()=>I(N),className:"px-6 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg transition-colors flex items-center gap-2",children:[n.jsx(js,{className:"w-4 h-4"}),"下载报告"]}),n.jsx("button",{onClick:()=>k(!1),className:"px-6 py-2 bg-neutral-100 hover:bg-neutral-200 text-neutral-700 rounded-lg transition-colors",children:"关闭"})]})]})})})]})},cT=({format:e,onUpdate:t})=>{const[r,a]=mr.useState(!1),[s,i]=mr.useState(null),[l,c]=mr.useState(null),[o,u]=mr.useState(null),[d,f]=mr.useState([{id:1,name:"政府采购标准模板",type:"公文格式",size:"2.1KB",date:"2024-01-15"},{id:2,name:"建筑工程投标模板",type:"工程格式",size:"1.8KB",date:"2024-01-10"},{id:3,name:"软件开发项目模板",type:"技术格式",size:"2.3KB",date:"2024-01-08"}]),x=(F,j)=>{t({...e,[F]:j})},h=F=>{const j=d.find(k=>k.id===F);j&&c(j)},p=()=>{if(l){let F;switch(l.type){case"公文格式":F={fontSize:16,fontFamily:"SimSun",lineHeight:1.5,margin:25,alignment:"left"};break;case"工程格式":F={fontSize:14,fontFamily:"SimHei",lineHeight:1.4,margin:20,alignment:"justify"};break;case"技术格式":F={fontSize:15,fontFamily:"Microsoft YaHei",lineHeight:1.6,margin:30,alignment:"left"};break;default:F={fontSize:14,fontFamily:"SimSun",lineHeight:1.5,margin:25,alignment:"left"}}t(F),c(null)}},m=F=>{const j=d.find(k=>k.id===F);j&&i(j)},w=F=>{const j=d.find(k=>k.id===F);j&&u(j)},v=()=>{o&&(f(d.filter(F=>F.id!==o.id)),u(null))},b=F=>{var k;const j=(k=F.target.files)==null?void 0:k[0];if(j){const S={id:Date.now(),name:j.name.replace(".json",""),type:"自定义格式",size:`${(j.size/1024).toFixed(1)}KB`,date:new Date().toISOString().split("T")[0]};f([...d,S]),a(!1)}},y=()=>{const F=JSON.stringify(e,null,2),j=new Blob([F],{type:"application/json"}),k=URL.createObjectURL(j),S=document.createElement("a");S.href=k,S.download=`format-template-${Date.now()}.json`,document.body.appendChild(S),S.click(),document.body.removeChild(S),URL.revokeObjectURL(k)},N=[{label:"宋体 (SimSun)",value:"SimSun"},{label:"黑体 (SimHei)",value:"SimHei"},{label:"微软雅黑 (Microsoft YaHei)",value:"Microsoft YaHei"},{label:"仿宋 (FangSong)",value:"FangSong"},{label:"楷体 (KaiTi)",value:"KaiTi"}];return n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[n.jsxs("div",{className:"mb-6",children:[n.jsxs("h2",{className:"text-2xl font-bold text-gray-900 flex items-center",children:[n.jsx(Vu,{className:"w-7 h-7 mr-3 text-purple-600"}),"格式设置"]}),n.jsx("p",{className:"text-gray-600 mt-1",children:"调整文档的字体、行距、页边距等格式参数"})]}),n.jsxs("div",{className:"bg-gradient-to-r from-indigo-50 to-purple-50 rounded-lg p-6 mb-8",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[n.jsx(po,{className:"w-5 h-5 mr-2 text-indigo-600"}),"模板管理"]}),n.jsxs("div",{className:"flex space-x-2",children:[n.jsxs("button",{onClick:()=>a(!0),className:"bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-lg flex items-center space-x-2 transition-colors",children:[n.jsx(wt,{className:"w-4 h-4"}),n.jsx("span",{children:"导入模板"})]}),n.jsxs("button",{onClick:y,className:"bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-lg flex items-center space-x-2 transition-colors",children:[n.jsx(js,{className:"w-4 h-4"}),n.jsx("span",{children:"导出当前格式"})]})]})]}),n.jsx("div",{className:"bg-white rounded-lg overflow-hidden",children:n.jsxs("table",{className:"w-full",children:[n.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"模板名称"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"类型"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"大小"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"导入日期"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"操作"})]})}),n.jsx("tbody",{className:"divide-y divide-gray-200",children:d.map(F=>n.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm font-medium text-gray-900",children:F.name}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-500",children:n.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:F.type})}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-500",children:F.size}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-500",children:F.date}),n.jsxs("td",{className:"px-4 py-3 whitespace-nowrap text-sm font-medium space-x-2",children:[n.jsx("button",{onClick:()=>h(F.id),className:"text-indigo-600 hover:text-indigo-900 transition-colors",children:"应用"}),n.jsx("button",{onClick:()=>m(F.id),className:"text-green-600 hover:text-green-900 transition-colors",children:"预览"}),n.jsx("button",{onClick:()=>w(F.id),className:"text-red-600 hover:text-red-900 transition-colors",children:"删除"})]})]},F.id))})]})})]}),n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 rounded-lg p-6",children:[n.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[n.jsx(Fb,{className:"w-5 h-5 mr-2 text-blue-600"}),"字体设置"]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"字体家族"}),n.jsx("select",{value:e.fontFamily,onChange:F=>x("fontFamily",F.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:N.map(F=>n.jsx("option",{value:F.value,children:F.label},F.value))})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["字体大小: ",e.fontSize,"px"]}),n.jsx("input",{type:"range",min:"12",max:"24",value:e.fontSize,onChange:F=>x("fontSize",parseInt(F.target.value)),className:"w-full"}),n.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[n.jsx("span",{children:"12px"}),n.jsx("span",{children:"24px"})]})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["行间距: ",e.lineHeight]}),n.jsx("input",{type:"range",min:"1",max:"3",step:"0.1",value:e.lineHeight,onChange:F=>x("lineHeight",parseFloat(F.target.value)),className:"w-full"}),n.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[n.jsx("span",{children:"1.0"}),n.jsx("span",{children:"3.0"})]})]})]})]}),n.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-emerald-50 rounded-lg p-6",children:[n.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[n.jsx(Eb,{className:"w-5 h-5 mr-2 text-green-600"}),"布局设置"]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"文本对齐"}),n.jsxs("select",{value:e.alignment,onChange:F=>x("alignment",F.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-500 focus:border-green-500",children:[n.jsx("option",{value:"left",children:"左对齐"}),n.jsx("option",{value:"center",children:"居中对齐"}),n.jsx("option",{value:"right",children:"右对齐"}),n.jsx("option",{value:"justify",children:"两端对齐"})]})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["页边距: ",e.margin,"mm"]}),n.jsx("input",{type:"range",min:"15",max:"40",value:e.margin,onChange:F=>x("margin",parseInt(F.target.value)),className:"w-full"}),n.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[n.jsx("span",{children:"15mm"}),n.jsx("span",{children:"40mm"})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"页面大小"}),n.jsxs("select",{className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-500 focus:border-green-500",children:[n.jsx("option",{children:"A4"}),n.jsx("option",{children:"A3"}),n.jsx("option",{children:"B4"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"页面方向"}),n.jsxs("select",{className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-500 focus:border-green-500",children:[n.jsx("option",{children:"纵向"}),n.jsx("option",{children:"横向"})]})]})]})]})]})]}),n.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-pink-50 rounded-lg p-6",children:[n.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[n.jsx(Pt,{className:"w-5 h-5 mr-2 text-purple-600"}),"预览效果"]}),n.jsx("div",{className:"bg-white rounded-lg p-6 shadow-inner border-2 border-dashed border-gray-300 min-h-80",children:n.jsxs("div",{style:{fontSize:`${e.fontSize}px`,fontFamily:e.fontFamily,lineHeight:e.lineHeight,textAlign:e.alignment,margin:`${e.margin}px`},className:"space-y-4",children:[n.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"示例标题"}),n.jsx("p",{className:"text-gray-700",children:"这是一段示例文本，用于预览当前格式设置的效果。通过调整左侧的各项参数， 您可以实时看到文档格式的变化。"}),n.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:"二级标题"}),n.jsx("p",{className:"text-gray-700",children:"系统支持多种字体选择，包括宋体、黑体、微软雅黑等常用字体， 同时可以灵活调整字体大小、行间距和页边距等参数。"}),n.jsxs("ul",{className:"list-disc ml-6 space-y-1",children:[n.jsx("li",{children:"列表项目一"}),n.jsx("li",{children:"列表项目二"}),n.jsx("li",{children:"列表项目三"})]})]})}),n.jsxs("div",{className:"mt-6 space-y-3",children:[n.jsx("button",{onClick:()=>{alert("格式已应用到当前文档，可在文档编辑器中查看效果")},className:"w-full bg-purple-600 hover:bg-purple-700 text-white py-2 rounded-lg transition-colors",children:"应用到当前文档"}),n.jsx("button",{onClick:y,className:"w-full bg-gray-100 hover:bg-gray-200 text-gray-700 py-2 rounded-lg transition-colors",children:"保存为默认格式"}),n.jsx("button",{onClick:()=>a(!0),className:"w-full bg-orange-100 hover:bg-orange-200 text-orange-700 py-2 rounded-lg transition-colors",children:"导入新模板"})]})]})]}),n.jsxs("div",{className:"mt-8 bg-gray-50 rounded-lg p-6",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"快速预设"}),n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[{name:"标准公文格式",desc:"符合国家标准的公文格式",format:{fontSize:16,fontFamily:"SimSun",lineHeight:1.5,margin:25,alignment:"left"}},{name:"技术文档格式",desc:"适合技术方案的现代格式",format:{fontSize:14,fontFamily:"Microsoft YaHei",lineHeight:1.4,margin:20,alignment:"left"}},{name:"简洁商务格式",desc:"简洁专业的商务文档格式",format:{fontSize:15,fontFamily:"SimHei",lineHeight:1.6,margin:30,alignment:"justify"}}].map((F,j)=>n.jsxs("div",{className:"bg-white rounded-lg p-4 border border-gray-200 hover:border-blue-300 transition-colors cursor-pointer",children:[n.jsx("h4",{className:"font-medium text-gray-900 mb-1",children:F.name}),n.jsx("p",{className:"text-sm text-gray-600 mb-3",children:F.desc}),n.jsx("button",{onClick:()=>t(F.format),className:"text-sm bg-blue-100 text-blue-700 px-3 py-1 rounded-full hover:bg-blue-200 transition-colors",children:"应用此格式"})]},j))})]})]}),r&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:n.jsx("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full mx-4",children:n.jsxs("div",{className:"p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"导入格式模板"}),n.jsx("button",{onClick:()=>a(!1),className:"text-gray-400 hover:text-gray-600 transition-colors",children:n.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),n.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center",children:[n.jsx(wt,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),n.jsx("p",{className:"text-gray-600 mb-4",children:"选择格式模板文件"}),n.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"支持 JSON 格式的模板文件"}),n.jsx("input",{type:"file",accept:".json",onChange:b,className:"hidden",id:"template-upload"}),n.jsx("label",{htmlFor:"template-upload",className:"bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-lg cursor-pointer transition-colors inline-block",children:"选择文件"})]}),n.jsxs("div",{className:"mt-4 text-xs text-gray-500",children:[n.jsx("p",{children:"• 模板文件应包含字体、大小、行距等格式信息"}),n.jsx("p",{children:"• 支持从其他系统导出的标准格式模板"}),n.jsx("p",{children:"• 导入后可在模板列表中管理和应用"})]})]})})}),s&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:n.jsx("div",{className:"bg-white rounded-xl shadow-xl max-w-lg w-full mx-4",children:n.jsxs("div",{className:"p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"模板预览"}),n.jsx("button",{onClick:()=>i(null),className:"text-gray-400 hover:text-gray-600 transition-colors",children:n.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[n.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:s.name}),n.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[n.jsxs("div",{children:[n.jsx("span",{className:"text-gray-600",children:"类型:"}),n.jsx("span",{className:"ml-2 font-medium",children:s.type})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-gray-600",children:"大小:"}),n.jsx("span",{className:"ml-2 font-medium",children:s.size})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-gray-600",children:"导入日期:"}),n.jsx("span",{className:"ml-2 font-medium",children:s.date})]})]})]}),n.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[n.jsx("h5",{className:"font-medium text-blue-900 mb-2",children:"格式预览"}),n.jsxs("div",{className:"text-sm text-blue-800 space-y-1",children:[s.type==="公文格式"&&n.jsxs(n.Fragment,{children:[n.jsx("p",{children:"• 字体: 宋体 16px"}),n.jsx("p",{children:"• 行距: 1.5倍"}),n.jsx("p",{children:"• 页边距: 25mm"}),n.jsx("p",{children:"• 对齐: 左对齐"})]}),s.type==="工程格式"&&n.jsxs(n.Fragment,{children:[n.jsx("p",{children:"• 字体: 黑体 14px"}),n.jsx("p",{children:"• 行距: 1.4倍"}),n.jsx("p",{children:"• 页边距: 20mm"}),n.jsx("p",{children:"• 对齐: 两端对齐"})]}),s.type==="技术格式"&&n.jsxs(n.Fragment,{children:[n.jsx("p",{children:"• 字体: 微软雅黑 15px"}),n.jsx("p",{children:"• 行距: 1.6倍"}),n.jsx("p",{children:"• 页边距: 30mm"}),n.jsx("p",{children:"• 对齐: 左对齐"})]})]})]}),n.jsxs("div",{className:"flex space-x-3",children:[n.jsx("button",{onClick:()=>{h(s.id),i(null)},className:"flex-1 bg-blue-600 hover:bg-blue-700 text-white py-2 rounded-lg transition-colors",children:"应用此模板"}),n.jsx("button",{onClick:()=>i(null),className:"flex-1 bg-gray-100 hover:bg-gray-200 text-gray-700 py-2 rounded-lg transition-colors",children:"关闭"})]})]})]})})}),l&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:n.jsx("div",{className:"bg-white rounded-xl shadow-xl max-w-lg w-full mx-4",children:n.jsxs("div",{className:"p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"应用模板"}),n.jsx("button",{onClick:()=>c(null),className:"text-gray-400 hover:text-gray-600 transition-colors",children:n.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[n.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:l.name}),n.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[n.jsxs("div",{children:[n.jsx("span",{className:"text-gray-600",children:"类型:"}),n.jsx("span",{className:"ml-2 font-medium",children:l.type})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-gray-600",children:"大小:"}),n.jsx("span",{className:"ml-2 font-medium",children:l.size})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-gray-600",children:"导入日期:"}),n.jsx("span",{className:"ml-2 font-medium",children:l.date})]})]})]}),n.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[n.jsx("h5",{className:"font-medium text-blue-900 mb-2",children:"将要应用的格式"}),n.jsxs("div",{className:"text-sm text-blue-800 space-y-1",children:[l.type==="公文格式"&&n.jsxs(n.Fragment,{children:[n.jsx("p",{children:"• 字体: 宋体 16px"}),n.jsx("p",{children:"• 行距: 1.5倍"}),n.jsx("p",{children:"• 页边距: 25mm"}),n.jsx("p",{children:"• 对齐: 左对齐"})]}),l.type==="工程格式"&&n.jsxs(n.Fragment,{children:[n.jsx("p",{children:"• 字体: 黑体 14px"}),n.jsx("p",{children:"• 行距: 1.4倍"}),n.jsx("p",{children:"• 页边距: 20mm"}),n.jsx("p",{children:"• 对齐: 两端对齐"})]}),l.type==="技术格式"&&n.jsxs(n.Fragment,{children:[n.jsx("p",{children:"• 字体: 微软雅黑 15px"}),n.jsx("p",{children:"• 行距: 1.6倍"}),n.jsx("p",{children:"• 页边距: 30mm"}),n.jsx("p",{children:"• 对齐: 左对齐"})]})]})]}),n.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-4",children:n.jsxs("div",{className:"flex items-start space-x-3",children:[n.jsx("svg",{className:"w-5 h-5 text-amber-600 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})}),n.jsxs("div",{className:"text-sm text-amber-800",children:[n.jsx("p",{className:"font-medium mb-1",children:"确认应用"}),n.jsx("p",{children:"应用此模板将覆盖当前的格式设置，是否继续？"})]})]})}),n.jsxs("div",{className:"flex space-x-3",children:[n.jsx("button",{onClick:p,className:"flex-1 bg-blue-600 hover:bg-blue-700 text-white py-2 rounded-lg transition-colors",children:"确认应用"}),n.jsx("button",{onClick:()=>c(null),className:"flex-1 bg-gray-100 hover:bg-gray-200 text-gray-700 py-2 rounded-lg transition-colors",children:"取消"})]})]})]})})}),o&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:n.jsx("div",{className:"bg-white rounded-xl shadow-xl max-w-lg w-full mx-4",children:n.jsxs("div",{className:"p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"删除模板"}),n.jsx("button",{onClick:()=>u(null),className:"text-gray-400 hover:text-gray-600 transition-colors",children:n.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[n.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:o.name}),n.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[n.jsxs("div",{children:[n.jsx("span",{className:"text-gray-600",children:"类型:"}),n.jsx("span",{className:"ml-2 font-medium",children:o.type})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-gray-600",children:"大小:"}),n.jsx("span",{className:"ml-2 font-medium",children:o.size})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-gray-600",children:"导入日期:"}),n.jsx("span",{className:"ml-2 font-medium",children:o.date})]})]})]}),n.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:n.jsxs("div",{className:"flex items-start space-x-3",children:[n.jsx("svg",{className:"w-5 h-5 text-red-600 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})}),n.jsxs("div",{className:"text-sm text-red-800",children:[n.jsx("p",{className:"font-medium mb-1",children:"确认删除"}),n.jsx("p",{children:"删除后将无法恢复此模板，是否确定要删除？"})]})]})}),n.jsxs("div",{className:"flex space-x-3",children:[n.jsx("button",{onClick:v,className:"flex-1 bg-red-600 hover:bg-red-700 text-white py-2 rounded-lg transition-colors",children:"确认删除"}),n.jsx("button",{onClick:()=>u(null),className:"flex-1 bg-gray-100 hover:bg-gray-200 text-gray-700 py-2 rounded-lg transition-colors",children:"取消"})]})]})]})})})]})},oT=[{id:"1",username:"管理员",phone:"13800138000",role:"超级管理员",enabled:!0,created_at:"2024-01-01 00:00:00"},{id:"2",username:"项目管理员",phone:"13800138001",role:"项目管理员",enabled:!0,created_at:"2024-01-01 00:00:00"},{id:"3",username:"张三",phone:"13800138002",role:"普通用户",enabled:!0,created_at:"2024-01-01 00:00:00"},{id:"4",username:"李四",phone:"13800138003",role:"普通用户",enabled:!0,created_at:"2024-01-01 00:00:00"},{id:"5",username:"王五",phone:"13800138004",role:"普通用户",enabled:!0,created_at:"2024-01-01 00:00:00"}],dT=({canEdit:e=!0,canDelete:t=!0,viewOwnOnly:r=!1,currentUser:a,dataScope:s})=>{const[i,l]=M.useState(oT),[c,o]=M.useState(!1),[u,d]=M.useState(""),[f,x]=M.useState(""),[h,p]=M.useState("all"),[m,w]=M.useState(1),[v,b]=M.useState(10),[y,N]=M.useState(""),[F,j]=M.useState("list"),[k,S]=M.useState(!1),[P,D]=M.useState(!1),[K,C]=M.useState(null),[Y,B]=M.useState({username:"",phone:"",role:"普通用户",password:"toubiao@123",enabled:!0}),ee=()=>{d(""),x(""),p("all"),w(1)},re=()=>{w(1)},Q=()=>{let E=i;return r&&a&&(E=i.filter(ke=>ke.username===a.username)),E.filter(ke=>{var me;const pe=!u||ke.username.toLowerCase().includes(u.toLowerCase()),Ue=!f||((me=ke.phone)==null?void 0:me.includes(f)),Ne=h==="all"||h==="enabled"&&ke.enabled||h==="disabled"&&!ke.enabled;return pe&&Ue&&Ne}).sort((ke,pe)=>new Date(pe.created_at).getTime()-new Date(ke.created_at).getTime())},te=()=>{const E=Q(),ke=(m-1)*v,pe=ke+v;return E.slice(ke,pe)},H=Math.ceil(Q().length/v),ae=()=>{B({username:"",phone:"",role:"普通用户",password:"toubiao@123",enabled:!0}),j("add")},he=E=>{C(E),B({username:E.username,phone:E.phone,role:E.role,password:"toubiao@123",enabled:E.enabled}),j("edit")},O=E=>{C(E),S(!0)},I=E=>{C(E),D(!0)},g=E=>/^1[3-9]\d{9}$/.test(E),_=async()=>{if(!g(Y.phone)){alert("请输入正确的手机号码（11位数字，以1开头）");return}const E={id:String(i.length+1),username:Y.username,phone:Y.phone,role:Y.role,enabled:Y.enabled,created_at:new Date().toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}).replace(/\//g,"-")};l([...i,E]),j("list")},A=async()=>{K&&l(i.map(E=>E.id===K.id?{...E,username:Y.username,role:Y.role,enabled:Y.enabled}:E)),j("list")},ne=async()=>{K&&l(i.filter(E=>E.id!==K.id)),S(!1)},ue=E=>{l(i.map(ke=>ke.id===E.id?{...ke,enabled:!ke.enabled}:ke))},ve=E=>{b(E),w(1)},xe=()=>{const E=parseInt(y);E>=1&&E<=H&&(w(E),N(""))},W=()=>{const E=F==="edit",ke=E?"编辑用户":"新增用户";return n.jsx("div",{className:"flex flex-col h-full",children:n.jsx("div",{className:"flex-1 overflow-auto",children:n.jsxs("div",{className:"bg-white rounded-lg border border-neutral-200",children:[n.jsxs("div",{className:"px-6 py-4 border-b border-neutral-200 flex items-center justify-between",children:[n.jsx("h3",{className:"text-lg font-semibold text-neutral-900",children:ke}),n.jsx("button",{onClick:()=>j("list"),className:"text-neutral-400 hover:text-neutral-600 transition-colors",children:n.jsx(Ze,{className:"w-5 h-5"})})]}),n.jsxs("div",{className:"p-6 space-y-6 max-w-2xl mx-auto",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:["姓名 ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:Y.username,onChange:pe=>B({...Y,username:pe.target.value}),placeholder:"请输入姓名",className:"w-full px-4 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:["手机号 ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"tel",value:Y.phone,onChange:pe=>B({...Y,phone:pe.target.value}),placeholder:"请输入11位手机号",disabled:E,className:"w-full px-4 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 disabled:bg-neutral-50 disabled:cursor-not-allowed"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:["角色 ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsxs("select",{value:Y.role,onChange:pe=>B({...Y,role:pe.target.value}),className:"w-full px-4 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[n.jsx("option",{value:"超级管理员",children:"超级管理员 - 拥有系统所有权限，可管理所有数据和用户"}),n.jsx("option",{value:"项目管理员",children:"项目管理员 - 可管理本企业范围内的数据和用户"}),n.jsx("option",{value:"普通用户",children:"普通用户 - 只能使用基本业务功能，知识库只读"})]})]}),!E&&n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:"初始密码"}),n.jsx("input",{type:"text",value:Y.password,disabled:!0,className:"w-full px-4 py-2 border border-neutral-300 rounded-lg bg-neutral-50 cursor-not-allowed text-neutral-500"}),n.jsx("p",{className:"text-xs text-neutral-500 mt-1",children:"默认密码为 toubiao@123，用户首次登录后可修改"})]}),n.jsxs("div",{className:"flex items-center",children:[n.jsx("input",{type:"checkbox",id:"enabled",checked:Y.enabled,onChange:pe=>B({...Y,enabled:pe.target.checked}),className:"w-4 h-4 text-primary-600 rounded focus:ring-primary-500"}),n.jsx("label",{htmlFor:"enabled",className:"ml-2 text-sm text-neutral-700",children:"启用账号"})]})]}),n.jsxs("div",{className:"px-6 py-4 border-t border-neutral-200 flex items-center justify-end gap-3",children:[n.jsx("button",{onClick:()=>j("list"),className:"px-6 py-2 border border-neutral-300 text-neutral-700 rounded-lg hover:bg-neutral-50 transition-colors",children:"取消"}),n.jsx("button",{onClick:E?A:_,className:"px-6 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors",children:E?"保存":"新增"})]})]})})})};return F==="add"||F==="edit"?W():n.jsxs("div",{className:"flex flex-col h-full",children:[n.jsx("div",{className:"flex-1 overflow-auto",children:n.jsxs("div",{className:"bg-white rounded-lg border border-neutral-200",children:[n.jsxs("div",{className:"px-6 py-4 border-b border-neutral-200",children:[n.jsx("div",{className:"flex items-center justify-between mb-4",children:n.jsx("h2",{className:"text-lg font-medium text-neutral-900",children:"用户管理"})}),n.jsxs("div",{className:"flex items-center justify-between gap-3",children:[n.jsxs("div",{className:"flex items-center gap-3",children:["用户名",n.jsx("input",{type:"text",placeholder:"请输入用户名",value:u,onChange:E=>d(E.target.value),className:"w-48 px-3 py-1.5 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500"}),"手机号",n.jsx("input",{type:"text",placeholder:"请输入手机号",value:f,onChange:E=>x(E.target.value),className:"w-48 px-3 py-1.5 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500"}),"状态",n.jsxs("select",{value:h,onChange:E=>p(E.target.value),className:"w-32 px-3 py-1.5 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500",children:[n.jsx("option",{value:"all",children:"全部状态"}),n.jsx("option",{value:"enabled",children:"启用"}),n.jsx("option",{value:"disabled",children:"禁用"})]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{onClick:ee,className:"px-4 py-1.5 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-50 transition-colors",children:"重置"}),n.jsx("button",{onClick:re,className:"px-4 py-1.5 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors",children:"查询"})]})]})]}),n.jsx("div",{className:"px-6 py-3 border-b border-neutral-200",children:n.jsxs("button",{onClick:ae,className:"px-4 py-1.5 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors flex items-center",children:[n.jsx(Ct,{className:"w-4 h-4 mr-1"}),"新增用户"]})}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"w-full",children:[n.jsx("thead",{className:"bg-neutral-50 border-b border-neutral-200",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"序号"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"姓名"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"手机号"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"角色"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"状态"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"创建日期"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"操作"})]})}),n.jsx("tbody",{className:"divide-y divide-neutral-200",children:c?n.jsx("tr",{children:n.jsx("td",{colSpan:7,className:"px-4 py-8 text-center text-neutral-500",children:n.jsxs("div",{className:"flex items-center justify-center",children:[n.jsx(Tl,{className:"w-5 h-5 animate-spin mr-2"}),"加载中..."]})})}):te().length===0?n.jsx("tr",{children:n.jsx("td",{colSpan:7,className:"px-4 py-8 text-center text-neutral-500",children:"暂无数据"})}):te().map((E,ke)=>n.jsxs("tr",{className:"hover:bg-neutral-50 transition-colors",children:[n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm text-neutral-900",children:(m-1)*v+ke+1}),n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap",children:n.jsx("div",{className:"text-sm font-medium text-neutral-900",children:E.username})}),n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm text-neutral-900",children:E.phone}),n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm text-neutral-900",children:E.role}),n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap",children:n.jsxs("button",{onClick:()=>ue(E),className:`inline-flex items-center px-3 py-1 rounded-full text-xs font-medium transition-all duration-200 ${E.enabled?"bg-green-100 text-green-800 hover:bg-green-200":"bg-red-100 text-red-800 hover:bg-red-200"}`,children:[n.jsx("span",{className:`w-1.5 h-1.5 rounded-full mr-1.5 ${E.enabled?"bg-green-500":"bg-red-500"}`}),E.enabled?"启用":"禁用"]})}),n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm text-neutral-900",children:E.created_at}),n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm",children:n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsxs("button",{onClick:()=>he(E),className:"px-2 py-1 text-xs text-primary-600 hover:text-primary-800 hover:bg-primary-50 rounded transition-colors flex items-center gap-1",children:[n.jsx(Et,{className:"w-3.5 h-3.5"}),"编辑"]}),n.jsxs("button",{onClick:()=>I(E),className:"px-2 py-1 text-xs text-orange-600 hover:text-orange-800 hover:bg-orange-50 rounded transition-colors flex items-center gap-1",children:[n.jsx(Cb,{className:"w-3.5 h-3.5"}),"重置密码"]}),n.jsxs("button",{onClick:()=>O(E),className:"px-2 py-1 text-xs text-red-600 hover:text-red-800 hover:bg-red-50 rounded transition-colors flex items-center gap-1",children:[n.jsx(qe,{className:"w-3.5 h-3.5"}),"删除"]})]})})]},E.id))})]})})]})}),n.jsxs("div",{className:"bg-white border-t border-neutral-200 px-6 py-3 flex items-center justify-center gap-6",children:[n.jsxs("div",{className:"text-sm text-neutral-700",children:["共 ",Q().length," 条"]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("button",{onClick:()=>w(Math.max(1,m-1)),disabled:m===1,className:`px-2 py-1 text-sm rounded transition-colors ${m===1?"bg-neutral-100 text-neutral-400 cursor-not-allowed":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:"<"}),n.jsx("div",{className:"flex items-center space-x-1",children:Array.from({length:Math.min(10,H)},(E,ke)=>{let pe;return H<=10||m<=5?pe=ke+1:m>=H-4?pe=H-9+ke:pe=m-4+ke,n.jsx("button",{onClick:()=>w(pe),className:`px-2.5 py-1 text-sm rounded transition-colors ${m===pe?"bg-primary-600 text-white":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:pe},pe)})}),H>10&&n.jsxs(n.Fragment,{children:[n.jsx("span",{className:"text-neutral-500",children:"..."}),n.jsx("button",{onClick:()=>w(H),className:`px-2.5 py-1 text-sm rounded transition-colors ${m===H?"bg-primary-600 text-white":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:H})]}),n.jsx("button",{onClick:()=>w(Math.min(H,m+1)),disabled:m===H,className:`px-2 py-1 text-sm rounded transition-colors ${m===H?"bg-neutral-100 text-neutral-400 cursor-not-allowed":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:">"})]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsxs("select",{value:v,onChange:E=>ve(Number(E.target.value)),className:"px-2 py-1 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500",children:[n.jsx("option",{value:10,children:"10条/页"}),n.jsx("option",{value:20,children:"20条/页"}),n.jsx("option",{value:50,children:"50条/页"})]}),n.jsx("span",{className:"text-sm text-neutral-700",children:"前往"}),n.jsx("input",{type:"number",value:y,onChange:E=>N(E.target.value),placeholder:"页",className:"w-12 px-2 py-1 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500",min:1,max:H}),n.jsx("button",{onClick:xe,className:"px-3 py-1 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-50 transition-colors",children:"页"})]})]}),k&&K&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:n.jsx("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full mx-4",children:n.jsxs("div",{className:"p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h3",{className:"text-lg font-semibold text-neutral-900",children:"删除用户"}),n.jsx("button",{onClick:()=>S(!1),className:"text-neutral-400 hover:text-neutral-600 transition-colors",children:n.jsx(Ze,{className:"w-5 h-5"})})]}),n.jsxs("div",{className:"mb-6",children:[n.jsxs("p",{className:"text-neutral-700",children:["确定要删除用户 ",n.jsx("span",{className:"font-semibold",children:K.username})," 吗？"]}),n.jsx("p",{className:"text-sm text-neutral-500 mt-2",children:"此操作不可恢复。"})]}),n.jsxs("div",{className:"flex space-x-3",children:[n.jsx("button",{onClick:()=>S(!1),className:"flex-1 bg-neutral-100 hover:bg-neutral-200 text-neutral-700 py-2 rounded-lg transition-colors",children:"取消"}),n.jsx("button",{onClick:ne,className:"flex-1 bg-red-600 hover:bg-red-700 text-white py-2 rounded-lg transition-colors",children:"确认删除"})]})]})})})]})},uT=[{id:"1",name:"A公司",code:"company_a",contact_person:"张经理",contact_phone:"13800001111",address:"北京市朝阳区",enabled:!0,created_at:"2024-01-01 00:00:00"},{id:"2",name:"A1公司",code:"company_a1",contact_person:"王主管",contact_phone:"13800003333",address:"北京市海淀区",enabled:!0,created_at:"2024-01-02 00:00:00"},{id:"3",name:"A2公司",code:"company_a2",contact_person:"赵主管",contact_phone:"13800004444",address:"北京市西城区",enabled:!1,created_at:"2024-01-03 00:00:00"},{id:"4",name:"B公司",code:"company_b",contact_person:"李经理",contact_phone:"13800002222",address:"上海市浦东新区",enabled:!0,created_at:"2024-01-04 00:00:00"}],Ac=[{id:"1",username:"admin",phone:"13800138000",role:"超级管理员"},{id:"2",username:"company_admin_a",phone:"13800138001",role:"企业管理员"},{id:"3",username:"用户1",phone:"13800138002",role:"普通用户"},{id:"4",username:"用户2",phone:"13800138003",role:"普通用户"},{id:"5",username:"用户3",phone:"13800138004",role:"普通用户"},{id:"6",username:"张三",phone:"13800138005",role:"普通用户"},{id:"7",username:"李四",phone:"13800138006",role:"普通用户"},{id:"8",username:"王五",phone:"13800138007",role:"普通用户"}],fT=({canEdit:e=!0,canDelete:t=!0})=>{const[r,a]=M.useState(uT),[s,i]=M.useState(!1),[l,c]=M.useState(""),[o,u]=M.useState(1),[d,f]=M.useState(10),[x,h]=M.useState(""),[p,m]=M.useState("list"),[w,v]=M.useState(!1),[b,y]=M.useState(null),[N,F]=M.useState(null),[j,k]=M.useState([]),[S,P]=M.useState({}),[D,K]=M.useState({name:"",code:"",contact_person:"",contact_phone:"",address:""}),C=()=>{c(""),u(1)},Y=()=>{u(1)},B=()=>r.filter(oe=>!l||oe.name.toLowerCase().includes(l.toLowerCase())).sort((oe,Ie)=>new Date(oe.created_at).getTime()-new Date(Ie.created_at).getTime()),ee=()=>{const oe=B(),Ie=(o-1)*d,Re=Ie+d;return oe.slice(Ie,Re)},re=Math.ceil(B().length/d),Q=()=>{K({name:"",code:"",contact_person:"",contact_phone:"",address:""}),m("add")},te=oe=>{y(oe),K({name:oe.name,code:oe.code,contact_person:oe.contact_person,contact_phone:oe.contact_phone,address:oe.address}),m("edit")},H=oe=>{y(oe),v(!0)},ae=oe=>{y(oe);const Ie=S[oe.id]||[];k(Ie),m("manageUsers")},he=oe=>{const Ie=Date.now().toString().slice(-6),Re=Math.random().toString(36).substring(2,6);return`company_${Ie}_${Re}`},O=oe=>/^1[3-9]\d{9}$/.test(oe),I=async()=>{if(!D.name){alert("请填写企业名称");return}const oe=he(D.name),Ie={id:String(r.length+1),name:D.name,code:oe,contact_person:D.contact_person,contact_phone:D.contact_phone,address:D.address,created_by:"管理员",enabled:!0,created_at:new Date().toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}).replace(/\//g,"-")};a([...r,Ie]),F(Ie),k([]),m("addUsers")},g=async()=>{if(b){if(D.contact_phone&&!O(D.contact_phone)){alert("请输入正确的手机号码");return}a(r.map(oe=>oe.id===b.id?{...oe,name:D.name,contact_person:D.contact_person,contact_phone:D.contact_phone,address:D.address}:oe))}m("list")},_=async()=>{b&&a(r.filter(oe=>oe.id!==b.id)),v(!1)},A=oe=>{a(r.map(Ie=>Ie.id===oe.id?{...Ie,enabled:!Ie.enabled}:Ie))},ne=oe=>{k(Ie=>Ie.includes(oe)?Ie.filter(Re=>Re!==oe):[...Ie,oe])},ue=()=>{m("list"),F(null),k([])},ve=()=>{m("list"),F(null),k([])},xe=()=>{b&&P({...S,[b.id]:j}),m("list"),y(null),k([])},W=()=>{m("list"),y(null),k([])},E=()=>Ac.filter(oe=>oe.role!=="超级管理员"),ke=oe=>{f(oe),u(1)},pe=()=>{const oe=parseInt(x);oe>=1&&oe<=re&&(u(oe),h(""))},Ue=()=>N?n.jsx("div",{className:"flex flex-col h-full",children:n.jsx("div",{className:"flex-1 overflow-auto",children:n.jsxs("div",{className:"bg-white rounded-lg border border-neutral-200",children:[n.jsxs("div",{className:"px-6 py-4 border-b border-neutral-200",children:[n.jsx("h3",{className:"text-lg font-semibold text-neutral-900",children:"为企业添加人员"}),n.jsxs("p",{className:"text-sm text-neutral-500 mt-1",children:["已创建企业：",n.jsx("span",{className:"font-medium text-neutral-900",children:N.name})]})]}),n.jsxs("div",{className:"p-6",children:[n.jsx("div",{className:"mb-4",children:n.jsx("p",{className:"text-sm text-neutral-700 mb-3",children:"请选择要添加到该企业的用户（可多选）："})}),n.jsx("div",{className:"border border-neutral-200 rounded-lg overflow-hidden",children:n.jsxs("table",{className:"w-full",children:[n.jsx("thead",{className:"bg-neutral-50 border-b border-neutral-200",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600 w-12",children:n.jsx("input",{type:"checkbox",checked:j.length===Ac.length,onChange:oe=>{oe.target.checked?k(Ac.map(Ie=>Ie.id)):k([])},className:"w-4 h-4 text-primary-600 rounded focus:ring-primary-500"})}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"用户名"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"手机号"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"角色"})]})}),n.jsx("tbody",{className:"divide-y divide-neutral-200",children:Ac.map(oe=>n.jsxs("tr",{className:"hover:bg-neutral-50 transition-colors",children:[n.jsx("td",{className:"px-4 py-2.5",children:n.jsx("input",{type:"checkbox",checked:j.includes(oe.id),onChange:()=>ne(oe.id),className:"w-4 h-4 text-primary-600 rounded focus:ring-primary-500"})}),n.jsx("td",{className:"px-4 py-2.5 text-sm text-neutral-900",children:oe.username}),n.jsx("td",{className:"px-4 py-2.5 text-sm text-neutral-900",children:oe.phone}),n.jsx("td",{className:"px-4 py-2.5 text-sm text-neutral-900",children:oe.role})]},oe.id))})]})}),j.length>0&&n.jsx("div",{className:"mt-4 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:n.jsxs("p",{className:"text-sm text-blue-800",children:["已选择 ",n.jsx("span",{className:"font-semibold",children:j.length})," 个用户"]})})]}),n.jsxs("div",{className:"px-6 py-4 border-t border-neutral-200 flex items-center justify-between",children:[n.jsx("button",{onClick:ve,className:"px-6 py-2 border border-neutral-300 text-neutral-700 rounded-lg hover:bg-neutral-50 transition-colors",children:"跳过，稍后添加"}),n.jsxs("button",{onClick:ue,disabled:j.length===0,className:"px-6 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors disabled:bg-neutral-300 disabled:cursor-not-allowed",children:["确认添加 ",j.length>0&&`(${j.length})`]})]})]})})}):null,Ne=()=>{if(!b)return null;const oe=E();return n.jsx("div",{className:"flex flex-col h-full",children:n.jsx("div",{className:"flex-1 overflow-auto",children:n.jsxs("div",{className:"bg-white rounded-lg border border-neutral-200",children:[n.jsxs("div",{className:"px-6 py-4 border-b border-neutral-200",children:[n.jsx("h3",{className:"text-lg font-semibold text-neutral-900",children:"人员授权管理"}),n.jsxs("p",{className:"text-sm text-neutral-500 mt-1",children:["企业：",n.jsx("span",{className:"font-medium text-neutral-900",children:b.name})]})]}),n.jsxs("div",{className:"p-6",children:[n.jsxs("div",{className:"mb-4",children:[n.jsx("p",{className:"text-sm text-neutral-700 mb-2",children:"请选择有权访问该企业的用户（可多选）："}),n.jsx("p",{className:"text-xs text-neutral-500",children:"注意：超级管理员默认可查看所有企业，无需单独授权"})]}),n.jsx("div",{className:"border border-neutral-200 rounded-lg overflow-hidden",children:n.jsxs("table",{className:"w-full",children:[n.jsx("thead",{className:"bg-neutral-50 border-b border-neutral-200",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600 w-12",children:n.jsx("input",{type:"checkbox",checked:j.length===oe.length&&oe.length>0,onChange:Ie=>{Ie.target.checked?k(oe.map(Re=>Re.id)):k([])},className:"w-4 h-4 text-primary-600 rounded focus:ring-primary-500"})}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"用户名"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"手机号"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"角色"})]})}),n.jsx("tbody",{className:"divide-y divide-neutral-200",children:oe.length===0?n.jsx("tr",{children:n.jsx("td",{colSpan:4,className:"px-4 py-8 text-center text-neutral-500",children:"暂无可授权用户"})}):oe.map(Ie=>n.jsxs("tr",{className:"hover:bg-neutral-50 transition-colors",children:[n.jsx("td",{className:"px-4 py-2.5",children:n.jsx("input",{type:"checkbox",checked:j.includes(Ie.id),onChange:()=>ne(Ie.id),className:"w-4 h-4 text-primary-600 rounded focus:ring-primary-500"})}),n.jsx("td",{className:"px-4 py-2.5 text-sm text-neutral-900",children:Ie.username}),n.jsx("td",{className:"px-4 py-2.5 text-sm text-neutral-900",children:Ie.phone}),n.jsx("td",{className:"px-4 py-2.5 text-sm text-neutral-900",children:Ie.role})]},Ie.id))})]})}),j.length>0&&n.jsx("div",{className:"mt-4 p-3 bg-green-50 border border-green-200 rounded-lg",children:n.jsxs("p",{className:"text-sm text-green-800",children:["已选择 ",n.jsx("span",{className:"font-semibold",children:j.length})," 个用户可访问此企业"]})})]}),n.jsxs("div",{className:"px-6 py-4 border-t border-neutral-200 flex items-center justify-end gap-3",children:[n.jsx("button",{onClick:W,className:"px-6 py-2 border border-neutral-300 text-neutral-700 rounded-lg hover:bg-neutral-50 transition-colors",children:"取消"}),n.jsx("button",{onClick:xe,className:"px-6 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors",children:"保存授权"})]})]})})})},me=()=>{const oe=p==="edit",Ie=oe?"编辑企业":"新增企业";return n.jsx("div",{className:"flex flex-col h-full",children:n.jsx("div",{className:"flex-1 overflow-auto",children:n.jsxs("div",{className:"bg-white rounded-lg border border-neutral-200",children:[n.jsxs("div",{className:"px-6 py-4 border-b border-neutral-200 flex items-center justify-between",children:[n.jsx("h3",{className:"text-lg font-semibold text-neutral-900",children:Ie}),n.jsx("button",{onClick:()=>m("list"),className:"text-neutral-400 hover:text-neutral-600 transition-colors",children:n.jsx(Ze,{className:"w-5 h-5"})})]}),n.jsx("div",{className:"p-6 space-y-6 max-w-2xl mx-auto",children:n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:["企业名称 ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:D.name,onChange:Re=>K({...D,name:Re.target.value}),placeholder:"请输入企业名称",className:"w-full px-4 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]})}),n.jsxs("div",{className:"px-6 py-4 border-t border-neutral-200 flex items-center justify-end gap-3",children:[n.jsx("button",{onClick:()=>m("list"),className:"px-6 py-2 border border-neutral-300 text-neutral-700 rounded-lg hover:bg-neutral-50 transition-colors",children:"取消"}),n.jsx("button",{onClick:oe?g:I,className:"px-6 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors",children:oe?"保存":"下一步"})]})]})})})};return p==="add"||p==="edit"?me():p==="addUsers"?Ue():p==="manageUsers"?Ne():n.jsxs("div",{className:"flex flex-col h-full",children:[n.jsx("div",{className:"flex-1 overflow-auto",children:n.jsxs("div",{className:"bg-white rounded-lg border border-neutral-200",children:[n.jsxs("div",{className:"px-6 py-4 border-b border-neutral-200",children:[n.jsx("div",{className:"flex items-center justify-between mb-4",children:n.jsx("h2",{className:"text-lg font-medium text-neutral-900",children:"企业管理"})}),n.jsxs("div",{className:"flex items-center justify-between gap-3",children:[n.jsxs("div",{className:"flex items-center gap-3",children:["企业名称",n.jsx("input",{type:"text",placeholder:"请输入企业名称",value:l,onChange:oe=>c(oe.target.value),className:"w-48 px-3 py-1.5 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{onClick:C,className:"px-4 py-1.5 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-50 transition-colors",children:"重置"}),n.jsx("button",{onClick:Y,className:"px-4 py-1.5 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors",children:"查询"})]})]})]}),n.jsx("div",{className:"px-6 py-3 border-b border-neutral-200",children:n.jsxs("button",{onClick:Q,className:"px-4 py-1.5 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors flex items-center",children:[n.jsx(Ct,{className:"w-4 h-4 mr-1"}),"新增企业"]})}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"w-full",children:[n.jsx("thead",{className:"bg-neutral-50 border-b border-neutral-200",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"序号"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"企业名称"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"状态"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"创建日期"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"操作"})]})}),n.jsx("tbody",{className:"divide-y divide-neutral-200",children:s?n.jsx("tr",{children:n.jsx("td",{colSpan:6,className:"px-4 py-8 text-center text-neutral-500",children:n.jsxs("div",{className:"flex items-center justify-center",children:[n.jsx(Tl,{className:"w-5 h-5 animate-spin mr-2"}),"加载中..."]})})}):ee().length===0?n.jsx("tr",{children:n.jsx("td",{colSpan:6,className:"px-4 py-8 text-center text-neutral-500",children:"暂无数据"})}):ee().map((oe,Ie)=>n.jsxs("tr",{className:"hover:bg-neutral-50 transition-colors",children:[n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm text-neutral-900",children:(o-1)*d+Ie+1}),n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap",children:n.jsx("span",{className:"text-sm font-medium text-neutral-900",children:oe.name})}),n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm text-neutral-900",children:oe.created_by}),n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap",children:n.jsxs("button",{onClick:()=>A(oe),className:`inline-flex items-center px-3 py-1 rounded-full text-xs font-medium transition-all duration-200 ${oe.enabled?"bg-green-100 text-green-800 hover:bg-green-200":"bg-red-100 text-red-800 hover:bg-red-200"}`,children:[n.jsx("span",{className:`w-1.5 h-1.5 rounded-full mr-1.5 ${oe.enabled?"bg-green-500":"bg-red-500"}`}),oe.enabled?"启用":"禁用"]})}),n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm text-neutral-900",children:oe.created_at}),n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm",children:n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsxs("button",{onClick:()=>ae(oe),className:"px-2 py-1 text-xs text-green-600 hover:text-green-800 hover:bg-green-50 rounded transition-colors flex items-center gap-1",children:[n.jsx(Pb,{className:"w-3.5 h-3.5"}),"人员授权"]}),n.jsxs("button",{onClick:()=>te(oe),className:"px-2 py-1 text-xs text-primary-600 hover:text-primary-800 hover:bg-primary-50 rounded transition-colors flex items-center gap-1",children:[n.jsx(Et,{className:"w-3.5 h-3.5"}),"编辑"]}),n.jsxs("button",{onClick:()=>H(oe),className:"px-2 py-1 text-xs text-red-600 hover:text-red-800 hover:bg-red-50 rounded transition-colors flex items-center gap-1",children:[n.jsx(qe,{className:"w-3.5 h-3.5"}),"删除"]})]})})]},oe.id))})]})})]})}),n.jsxs("div",{className:"bg-white border-t border-neutral-200 px-6 py-3 flex items-center justify-center gap-6",children:[n.jsxs("div",{className:"text-sm text-neutral-700",children:["共 ",B().length," 条"]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("button",{onClick:()=>u(Math.max(1,o-1)),disabled:o===1,className:`px-2 py-1 text-sm rounded transition-colors ${o===1?"bg-neutral-100 text-neutral-400 cursor-not-allowed":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:"<"}),n.jsx("div",{className:"flex items-center space-x-1",children:Array.from({length:Math.min(10,re)},(oe,Ie)=>{let Re;return re<=10||o<=5?Re=Ie+1:o>=re-4?Re=re-9+Ie:Re=o-4+Ie,n.jsx("button",{onClick:()=>u(Re),className:`px-2.5 py-1 text-sm rounded transition-colors ${o===Re?"bg-primary-600 text-white":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:Re},Re)})}),re>10&&n.jsxs(n.Fragment,{children:[n.jsx("span",{className:"text-neutral-500",children:"..."}),n.jsx("button",{onClick:()=>u(re),className:`px-2.5 py-1 text-sm rounded transition-colors ${o===re?"bg-primary-600 text-white":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:re})]}),n.jsx("button",{onClick:()=>u(Math.min(re,o+1)),disabled:o===re,className:`px-2 py-1 text-sm rounded transition-colors ${o===re?"bg-neutral-100 text-neutral-400 cursor-not-allowed":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:">"})]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsxs("select",{value:d,onChange:oe=>ke(Number(oe.target.value)),className:"px-2 py-1 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500",children:[n.jsx("option",{value:10,children:"10条/页"}),n.jsx("option",{value:20,children:"20条/页"}),n.jsx("option",{value:50,children:"50条/页"})]}),n.jsx("span",{className:"text-sm text-neutral-700",children:"前往"}),n.jsx("input",{type:"number",value:x,onChange:oe=>h(oe.target.value),placeholder:"页",className:"w-12 px-2 py-1 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500",min:1,max:re}),n.jsx("button",{onClick:pe,className:"px-3 py-1 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-50 transition-colors",children:"页"})]})]}),w&&b&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:n.jsx("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full mx-4",children:n.jsxs("div",{className:"p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h3",{className:"text-lg font-semibold text-neutral-900",children:"删除企业"}),n.jsx("button",{onClick:()=>v(!1),className:"text-neutral-400 hover:text-neutral-600 transition-colors",children:n.jsx(Ze,{className:"w-5 h-5"})})]}),n.jsxs("div",{className:"mb-6",children:[n.jsxs("p",{className:"text-neutral-700",children:["确定要删除企业 ",n.jsx("span",{className:"font-semibold",children:b.name})," 吗？"]}),n.jsx("p",{className:"text-sm text-neutral-500 mt-2",children:"此操作不可恢复。"})]}),n.jsxs("div",{className:"flex space-x-3",children:[n.jsx("button",{onClick:()=>v(!1),className:"flex-1 bg-neutral-100 hover:bg-neutral-200 text-neutral-700 py-2 rounded-lg transition-colors",children:"取消"}),n.jsx("button",{onClick:_,className:"flex-1 bg-red-600 hover:bg-red-700 text-white py-2 rounded-lg transition-colors",children:"确认删除"})]})]})})})]})},Pc={超级管理员:{view:["database","upload","generate","check","settings","users","companies"],edit:["database","upload","generate","check","settings","users","companies"],delete:["upload","generate","check","companies","database"],canDeleteSelf:!1},项目管理员:{view:["database","upload","generate","check","settings","users","companies"],edit:["database","upload","generate","check","users"],delete:["upload","generate","check","database","users"],dataScope:"company",canDeleteSelf:!1},普通用户:{view:["database","upload","generate","check"],edit:["upload","generate","check"],delete:["upload","generate","check"],viewOwnProfileOnly:!0,canDeleteSelf:!1,readOnlyDatabase:!0}};function xT(){const[e,t]=M.useState(!1),[r,a]=M.useState({username:"",role:""}),[s,i]=M.useState("database"),[l,c]=M.useState([]),[o,u]=M.useState({fontSize:14,fontFamily:"SimSun",lineHeight:1.5,margin:25,alignment:"left"});M.useEffect(()=>{const j=localStorage.getItem("currentUser");if(j){const k=JSON.parse(j);a(k),t(!0)}},[]);const d=(j,k)=>{const S={username:j,role:k};a(S),t(!0),localStorage.setItem("currentUser",JSON.stringify(S))},f=()=>{t(!1),a({username:"",role:""}),localStorage.removeItem("currentUser")};mr.useEffect(()=>{const j=()=>{i("generate")};return window.addEventListener("navigate-to-generate",j),()=>{window.removeEventListener("navigate-to-generate",j)}},[]);const x=[{id:"database",label:"企业知识库",icon:gb,roles:["超级管理员","项目管理员","普通用户"]},{id:"upload",label:"招标项目管理",icon:wt,roles:["超级管理员","项目管理员","普通用户"]},{id:"generate",label:"投标文件生成",icon:xb,roles:["超级管理员","项目管理员","普通用户"]},{id:"check",label:"投标文件检查",icon:g1,roles:["超级管理员","项目管理员","普通用户"]},{id:"settings",label:"系统管理",icon:Vu,roles:["超级管理员","项目管理员"],children:[{id:"users",label:"用户管理",icon:b1,roles:["超级管理员","项目管理员"]},{id:"companies",label:"企业管理",icon:El,roles:["超级管理员","项目管理员"]}]}],h=(j,k="view")=>{var P;const S=Pc[r.role];return S&&((P=S[k])==null?void 0:P.includes(j))||!1},p=()=>{const j=Pc[r.role];return j==null?void 0:j.dataScope},m=()=>{const j=Pc[r.role];return(j==null?void 0:j.viewOwnProfileOnly)===!0},w=()=>{const j=Pc[r.role];return(j==null?void 0:j.readOnlyDatabase)===!0},v=j=>j.filter(k=>{if(!k.roles||k.roles.includes(r.role)){if(k.children){const S=v(k.children);return S.length>0?{...k,children:S}:!1}return!0}return!1}).map(k=>k.children?{...k,children:v(k.children)}:k),b=v(x);M.useEffect(()=>{var j;if(e&&!h(s,"view")){const k=((j=b[0])==null?void 0:j.id)||"database";i(k)}},[r.role,e]);const y=j=>{c(k=>k.includes(j)?k.filter(S=>S!==j):[...k,j])},N=()=>{if(!h(s,"view"))return n.jsx("div",{className:"flex items-center justify-center h-full",children:n.jsxs("div",{className:"text-center",children:[n.jsx(Shield,{className:"w-16 h-16 mx-auto mb-4 text-neutral-400"}),n.jsx("h3",{className:"text-lg font-semibold text-neutral-900 mb-2",children:"权限不足"}),n.jsx("p",{className:"text-neutral-600",children:"您没有权限访问该功能模块"})]})});const j=h(s,"edit"),k=h(s,"delete"),S=p(),P=m(),D=w();switch(s){case"database":return n.jsx(VE,{canEdit:j,canDelete:k,dataScope:S,readOnly:D,currentUser:r});case"upload":return n.jsx(nh,{canEdit:j,canDelete:k,dataScope:S});case"generate":return n.jsx(QE,{canEdit:j,canDelete:k,dataScope:S});case"check":return n.jsx(lT,{canEdit:j,canDelete:k,dataScope:S});case"settings":return n.jsx(cT,{format:o,onUpdate:u});case"users":return n.jsx(dT,{canEdit:j,canDelete:k,viewOwnOnly:P,currentUser:r,dataScope:S});case"companies":return n.jsx(fT,{canEdit:j,canDelete:k,dataScope:S});default:return n.jsx(nh,{canEdit:j,canDelete:k,dataScope:S})}},F=(j,k=0)=>{const S=j.icon,P=j.children&&j.children.length>0,D=l.includes(j.id),K=s===j.id,C=k>0;return n.jsxs("div",{children:[n.jsxs("button",{onClick:()=>{P?y(j.id):i(j.id)},className:`w-full flex items-center justify-between px-3 py-2.5 text-sm text-left rounded-lg transition-all duration-150 ${C?"pl-9":""} ${K&&!P?"bg-primary-50 text-primary-700 font-medium":"text-neutral-600 hover:bg-neutral-50 hover:text-neutral-900"}`,children:[n.jsxs("div",{className:"flex items-center",children:[!C&&n.jsx(S,{className:`w-4.5 h-4.5 mr-2.5 ${K&&!P?"text-primary-600":"text-neutral-400"}`}),j.label]}),P&&(D?n.jsx(hb,{className:"w-4 h-4 text-neutral-400"}):n.jsx(Hu,{className:"w-4 h-4 text-neutral-400"}))]}),P&&D&&n.jsx("div",{className:"mt-1 space-y-1",children:j.children.map(Y=>F(Y,k+1))})]},j.id)};return e?n.jsxs("div",{className:"h-screen w-screen overflow-hidden bg-neutral-50 flex flex-col",children:[n.jsx(Ib,{username:r.username,role:r.role,onLogout:f}),n.jsxs("div",{className:"flex flex-1 overflow-hidden",children:[n.jsx("div",{className:"w-64 bg-white border-r border-neutral-200 overflow-y-auto flex-shrink-0",children:n.jsx("div",{className:"py-6 px-3",children:n.jsx("nav",{className:"space-y-1",children:b.map(j=>F(j))})})}),n.jsx("div",{className:"flex-1 overflow-hidden",children:n.jsx("div",{className:"h-full overflow-y-auto",children:n.jsx("div",{className:"p-6 max-w-full",children:N()})})})]})]}):n.jsx(Db,{onLogin:d})}p1(document.getElementById("root")).render(n.jsx(M.StrictMode,{children:n.jsx(xT,{})}));
