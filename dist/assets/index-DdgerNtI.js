(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))a(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&a(l)}).observe(document,{childList:!0,subtree:!0});function r(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(s){if(s.ep)return;s.ep=!0;const i=r(s);fetch(s.href,i)}})();function Dv(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var sh={exports:{}},Ao={},ih={exports:{}},it={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Hl=Symbol.for("react.element"),Iv=Symbol.for("react.portal"),Mv=Symbol.for("react.fragment"),Rv=Symbol.for("react.strict_mode"),Ov=Symbol.for("react.profiler"),Lv=Symbol.for("react.provider"),Bv=Symbol.for("react.context"),Uv=Symbol.for("react.forward_ref"),zv=Symbol.for("react.suspense"),Wv=Symbol.for("react.memo"),Hv=Symbol.for("react.lazy"),Rf=Symbol.iterator;function $v(e){return e===null||typeof e!="object"?null:(e=Rf&&e[Rf]||e["@@iterator"],typeof e=="function"?e:null)}var lh={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},ch=Object.assign,oh={};function ji(e,t,r){this.props=e,this.context=t,this.refs=oh,this.updater=r||lh}ji.prototype.isReactComponent={};ji.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};ji.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function dh(){}dh.prototype=ji.prototype;function qd(e,t,r){this.props=e,this.context=t,this.refs=oh,this.updater=r||lh}var Jd=qd.prototype=new dh;Jd.constructor=qd;ch(Jd,ji.prototype);Jd.isPureReactComponent=!0;var Of=Array.isArray,uh=Object.prototype.hasOwnProperty,Qd={current:null},fh={key:!0,ref:!0,__self:!0,__source:!0};function xh(e,t,r){var a,s={},i=null,l=null;if(t!=null)for(a in t.ref!==void 0&&(l=t.ref),t.key!==void 0&&(i=""+t.key),t)uh.call(t,a)&&!fh.hasOwnProperty(a)&&(s[a]=t[a]);var c=arguments.length-2;if(c===1)s.children=r;else if(1<c){for(var o=Array(c),u=0;u<c;u++)o[u]=arguments[u+2];s.children=o}if(e&&e.defaultProps)for(a in c=e.defaultProps,c)s[a]===void 0&&(s[a]=c[a]);return{$$typeof:Hl,type:e,key:i,ref:l,props:s,_owner:Qd.current}}function Vv(e,t){return{$$typeof:Hl,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Zd(e){return typeof e=="object"&&e!==null&&e.$$typeof===Hl}function Gv(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var Lf=/\/+/g;function r0(e,t){return typeof e=="object"&&e!==null&&e.key!=null?Gv(""+e.key):t.toString(36)}function Ic(e,t,r,a,s){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var l=!1;if(e===null)l=!0;else switch(i){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case Hl:case Iv:l=!0}}if(l)return l=e,s=s(l),e=a===""?"."+r0(l,0):a,Of(s)?(r="",e!=null&&(r=e.replace(Lf,"$&/")+"/"),Ic(s,t,r,"",function(u){return u})):s!=null&&(Zd(s)&&(s=Vv(s,r+(!s.key||l&&l.key===s.key?"":(""+s.key).replace(Lf,"$&/")+"/")+e)),t.push(s)),1;if(l=0,a=a===""?".":a+":",Of(e))for(var c=0;c<e.length;c++){i=e[c];var o=a+r0(i,c);l+=Ic(i,t,r,o,s)}else if(o=$v(e),typeof o=="function")for(e=o.call(e),c=0;!(i=e.next()).done;)i=i.value,o=a+r0(i,c++),l+=Ic(i,t,r,o,s);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function nc(e,t,r){if(e==null)return e;var a=[],s=0;return Ic(e,a,"","",function(i){return t.call(r,i,s++)}),a}function Xv(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Gr={current:null},Mc={transition:null},Kv={ReactCurrentDispatcher:Gr,ReactCurrentBatchConfig:Mc,ReactCurrentOwner:Qd};function mh(){throw Error("act(...) is not supported in production builds of React.")}it.Children={map:nc,forEach:function(e,t,r){nc(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return nc(e,function(){t++}),t},toArray:function(e){return nc(e,function(t){return t})||[]},only:function(e){if(!Zd(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};it.Component=ji;it.Fragment=Mv;it.Profiler=Ov;it.PureComponent=qd;it.StrictMode=Rv;it.Suspense=zv;it.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Kv;it.act=mh;it.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var a=ch({},e.props),s=e.key,i=e.ref,l=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,l=Qd.current),t.key!==void 0&&(s=""+t.key),e.type&&e.type.defaultProps)var c=e.type.defaultProps;for(o in t)uh.call(t,o)&&!fh.hasOwnProperty(o)&&(a[o]=t[o]===void 0&&c!==void 0?c[o]:t[o])}var o=arguments.length-2;if(o===1)a.children=r;else if(1<o){c=Array(o);for(var u=0;u<o;u++)c[u]=arguments[u+2];a.children=c}return{$$typeof:Hl,type:e.type,key:s,ref:i,props:a,_owner:l}};it.createContext=function(e){return e={$$typeof:Bv,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:Lv,_context:e},e.Consumer=e};it.createElement=xh;it.createFactory=function(e){var t=xh.bind(null,e);return t.type=e,t};it.createRef=function(){return{current:null}};it.forwardRef=function(e){return{$$typeof:Uv,render:e}};it.isValidElement=Zd;it.lazy=function(e){return{$$typeof:Hv,_payload:{_status:-1,_result:e},_init:Xv}};it.memo=function(e,t){return{$$typeof:Wv,type:e,compare:t===void 0?null:t}};it.startTransition=function(e){var t=Mc.transition;Mc.transition={};try{e()}finally{Mc.transition=t}};it.unstable_act=mh;it.useCallback=function(e,t){return Gr.current.useCallback(e,t)};it.useContext=function(e){return Gr.current.useContext(e)};it.useDebugValue=function(){};it.useDeferredValue=function(e){return Gr.current.useDeferredValue(e)};it.useEffect=function(e,t){return Gr.current.useEffect(e,t)};it.useId=function(){return Gr.current.useId()};it.useImperativeHandle=function(e,t,r){return Gr.current.useImperativeHandle(e,t,r)};it.useInsertionEffect=function(e,t){return Gr.current.useInsertionEffect(e,t)};it.useLayoutEffect=function(e,t){return Gr.current.useLayoutEffect(e,t)};it.useMemo=function(e,t){return Gr.current.useMemo(e,t)};it.useReducer=function(e,t,r){return Gr.current.useReducer(e,t,r)};it.useRef=function(e){return Gr.current.useRef(e)};it.useState=function(e){return Gr.current.useState(e)};it.useSyncExternalStore=function(e,t,r){return Gr.current.useSyncExternalStore(e,t,r)};it.useTransition=function(){return Gr.current.useTransition()};it.version="18.3.1";ih.exports=it;var M=ih.exports;const br=Dv(M);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Yv=M,qv=Symbol.for("react.element"),Jv=Symbol.for("react.fragment"),Qv=Object.prototype.hasOwnProperty,Zv=Yv.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,e2={key:!0,ref:!0,__self:!0,__source:!0};function hh(e,t,r){var a,s={},i=null,l=null;r!==void 0&&(i=""+r),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(l=t.ref);for(a in t)Qv.call(t,a)&&!e2.hasOwnProperty(a)&&(s[a]=t[a]);if(e&&e.defaultProps)for(a in t=e.defaultProps,t)s[a]===void 0&&(s[a]=t[a]);return{$$typeof:qv,type:e,key:i,ref:l,props:s,_owner:Zv.current}}Ao.Fragment=Jv;Ao.jsx=hh;Ao.jsxs=hh;sh.exports=Ao;var n=sh.exports,ph={exports:{}},vn={},gh={exports:{}},vh={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(Z,z){var ne=Z.length;Z.push(z);e:for(;0<ne;){var xe=ne-1>>>1,O=Z[xe];if(0<s(O,z))Z[xe]=z,Z[ne]=O,ne=xe;else break e}}function r(Z){return Z.length===0?null:Z[0]}function a(Z){if(Z.length===0)return null;var z=Z[0],ne=Z.pop();if(ne!==z){Z[0]=ne;e:for(var xe=0,O=Z.length,R=O>>>1;xe<R;){var g=2*(xe+1)-1,S=Z[g],F=g+1,ae=Z[F];if(0>s(S,ne))F<O&&0>s(ae,S)?(Z[xe]=ae,Z[F]=ne,xe=F):(Z[xe]=S,Z[g]=ne,xe=g);else if(F<O&&0>s(ae,ne))Z[xe]=ae,Z[F]=ne,xe=F;else break e}}return z}function s(Z,z){var ne=Z.sortIndex-z.sortIndex;return ne!==0?ne:Z.id-z.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var l=Date,c=l.now();e.unstable_now=function(){return l.now()-c}}var o=[],u=[],d=1,f=null,x=3,h=!1,p=!1,m=!1,w=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function y(Z){for(var z=r(u);z!==null;){if(z.callback===null)a(u);else if(z.startTime<=Z)a(u),z.sortIndex=z.expirationTime,t(o,z);else break;z=r(u)}}function N(Z){if(m=!1,y(Z),!p)if(r(o)!==null)p=!0,re(A);else{var z=r(u);z!==null&&Q(N,z.startTime-Z)}}function A(Z,z){p=!1,m&&(m=!1,v(j),j=-1),h=!0;var ne=x;try{for(y(z),f=r(o);f!==null&&(!(f.expirationTime>z)||Z&&!K());){var xe=f.callback;if(typeof xe=="function"){f.callback=null,x=f.priorityLevel;var O=xe(f.expirationTime<=z);z=e.unstable_now(),typeof O=="function"?f.callback=O:f===r(o)&&a(o),y(z)}else a(o);f=r(o)}if(f!==null)var R=!0;else{var g=r(u);g!==null&&Q(N,g.startTime-z),R=!1}return R}finally{f=null,x=ne,h=!1}}var k=!1,_=null,j=-1,P=5,D=-1;function K(){return!(e.unstable_now()-D<P)}function E(){if(_!==null){var Z=e.unstable_now();D=Z;var z=!0;try{z=_(!0,Z)}finally{z?Y():(k=!1,_=null)}}else k=!1}var Y;if(typeof b=="function")Y=function(){b(E)};else if(typeof MessageChannel<"u"){var B=new MessageChannel,te=B.port2;B.port1.onmessage=E,Y=function(){te.postMessage(null)}}else Y=function(){w(E,0)};function re(Z){_=Z,k||(k=!0,Y())}function Q(Z,z){j=w(function(){Z(e.unstable_now())},z)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(Z){Z.callback=null},e.unstable_continueExecution=function(){p||h||(p=!0,re(A))},e.unstable_forceFrameRate=function(Z){0>Z||125<Z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):P=0<Z?Math.floor(1e3/Z):5},e.unstable_getCurrentPriorityLevel=function(){return x},e.unstable_getFirstCallbackNode=function(){return r(o)},e.unstable_next=function(Z){switch(x){case 1:case 2:case 3:var z=3;break;default:z=x}var ne=x;x=z;try{return Z()}finally{x=ne}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(Z,z){switch(Z){case 1:case 2:case 3:case 4:case 5:break;default:Z=3}var ne=x;x=Z;try{return z()}finally{x=ne}},e.unstable_scheduleCallback=function(Z,z,ne){var xe=e.unstable_now();switch(typeof ne=="object"&&ne!==null?(ne=ne.delay,ne=typeof ne=="number"&&0<ne?xe+ne:xe):ne=xe,Z){case 1:var O=-1;break;case 2:O=250;break;case 5:O=1073741823;break;case 4:O=1e4;break;default:O=5e3}return O=ne+O,Z={id:d++,callback:z,priorityLevel:Z,startTime:ne,expirationTime:O,sortIndex:-1},ne>xe?(Z.sortIndex=ne,t(u,Z),r(o)===null&&Z===r(u)&&(m?(v(j),j=-1):m=!0,Q(N,ne-xe))):(Z.sortIndex=O,t(o,Z),p||h||(p=!0,re(A))),Z},e.unstable_shouldYield=K,e.unstable_wrapCallback=function(Z){var z=x;return function(){var ne=x;x=z;try{return Z.apply(this,arguments)}finally{x=ne}}}})(vh);gh.exports=vh;var t2=gh.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var r2=M,pn=t2;function Ee(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var yh=new Set,dl={};function Fs(e,t){fi(e,t),fi(e+"Capture",t)}function fi(e,t){for(dl[e]=t,e=0;e<t.length;e++)yh.add(t[e])}var ga=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),$0=Object.prototype.hasOwnProperty,n2=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Bf={},Uf={};function a2(e){return $0.call(Uf,e)?!0:$0.call(Bf,e)?!1:n2.test(e)?Uf[e]=!0:(Bf[e]=!0,!1)}function s2(e,t,r,a){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return a?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function i2(e,t,r,a){if(t===null||typeof t>"u"||s2(e,t,r,a))return!0;if(a)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Xr(e,t,r,a,s,i,l){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=a,this.attributeNamespace=s,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=l}var kr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){kr[e]=new Xr(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];kr[t]=new Xr(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){kr[e]=new Xr(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){kr[e]=new Xr(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){kr[e]=new Xr(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){kr[e]=new Xr(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){kr[e]=new Xr(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){kr[e]=new Xr(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){kr[e]=new Xr(e,5,!1,e.toLowerCase(),null,!1,!1)});var eu=/[\-:]([a-z])/g;function tu(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(eu,tu);kr[t]=new Xr(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(eu,tu);kr[t]=new Xr(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(eu,tu);kr[t]=new Xr(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){kr[e]=new Xr(e,1,!1,e.toLowerCase(),null,!1,!1)});kr.xlinkHref=new Xr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){kr[e]=new Xr(e,1,!1,e.toLowerCase(),null,!0,!0)});function ru(e,t,r,a){var s=kr.hasOwnProperty(t)?kr[t]:null;(s!==null?s.type!==0:a||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(i2(t,r,s,a)&&(r=null),a||s===null?a2(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):s.mustUseProperty?e[s.propertyName]=r===null?s.type===3?!1:"":r:(t=s.attributeName,a=s.attributeNamespace,r===null?e.removeAttribute(t):(s=s.type,r=s===3||s===4&&r===!0?"":""+r,a?e.setAttributeNS(a,t,r):e.setAttribute(t,r))))}var Na=r2.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ac=Symbol.for("react.element"),Hs=Symbol.for("react.portal"),$s=Symbol.for("react.fragment"),nu=Symbol.for("react.strict_mode"),V0=Symbol.for("react.profiler"),bh=Symbol.for("react.provider"),wh=Symbol.for("react.context"),au=Symbol.for("react.forward_ref"),G0=Symbol.for("react.suspense"),X0=Symbol.for("react.suspense_list"),su=Symbol.for("react.memo"),Fa=Symbol.for("react.lazy"),Nh=Symbol.for("react.offscreen"),zf=Symbol.iterator;function Ai(e){return e===null||typeof e!="object"?null:(e=zf&&e[zf]||e["@@iterator"],typeof e=="function"?e:null)}var Vt=Object.assign,n0;function Ui(e){if(n0===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);n0=t&&t[1]||""}return`
`+n0+e}var a0=!1;function s0(e,t){if(!e||a0)return"";a0=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var a=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){a=u}e.call(t.prototype)}else{try{throw Error()}catch(u){a=u}e()}}catch(u){if(u&&a&&typeof u.stack=="string"){for(var s=u.stack.split(`
`),i=a.stack.split(`
`),l=s.length-1,c=i.length-1;1<=l&&0<=c&&s[l]!==i[c];)c--;for(;1<=l&&0<=c;l--,c--)if(s[l]!==i[c]){if(l!==1||c!==1)do if(l--,c--,0>c||s[l]!==i[c]){var o=`
`+s[l].replace(" at new "," at ");return e.displayName&&o.includes("<anonymous>")&&(o=o.replace("<anonymous>",e.displayName)),o}while(1<=l&&0<=c);break}}}finally{a0=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?Ui(e):""}function l2(e){switch(e.tag){case 5:return Ui(e.type);case 16:return Ui("Lazy");case 13:return Ui("Suspense");case 19:return Ui("SuspenseList");case 0:case 2:case 15:return e=s0(e.type,!1),e;case 11:return e=s0(e.type.render,!1),e;case 1:return e=s0(e.type,!0),e;default:return""}}function K0(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case $s:return"Fragment";case Hs:return"Portal";case V0:return"Profiler";case nu:return"StrictMode";case G0:return"Suspense";case X0:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case wh:return(e.displayName||"Context")+".Consumer";case bh:return(e._context.displayName||"Context")+".Provider";case au:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case su:return t=e.displayName||null,t!==null?t:K0(e.type)||"Memo";case Fa:t=e._payload,e=e._init;try{return K0(e(t))}catch{}}return null}function c2(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return K0(t);case 8:return t===nu?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Xa(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function jh(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function o2(e){var t=jh(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),a=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var s=r.get,i=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(l){a=""+l,i.call(this,l)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return a},setValue:function(l){a=""+l},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function sc(e){e._valueTracker||(e._valueTracker=o2(e))}function kh(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),a="";return e&&(a=jh(e)?e.checked?"true":"false":e.value),e=a,e!==r?(t.setValue(e),!0):!1}function Gc(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Y0(e,t){var r=t.checked;return Vt({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function Wf(e,t){var r=t.defaultValue==null?"":t.defaultValue,a=t.checked!=null?t.checked:t.defaultChecked;r=Xa(t.value!=null?t.value:r),e._wrapperState={initialChecked:a,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function _h(e,t){t=t.checked,t!=null&&ru(e,"checked",t,!1)}function q0(e,t){_h(e,t);var r=Xa(t.value),a=t.type;if(r!=null)a==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(a==="submit"||a==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?J0(e,t.type,r):t.hasOwnProperty("defaultValue")&&J0(e,t.type,Xa(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Hf(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var a=t.type;if(!(a!=="submit"&&a!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function J0(e,t,r){(t!=="number"||Gc(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var zi=Array.isArray;function ri(e,t,r,a){if(e=e.options,t){t={};for(var s=0;s<r.length;s++)t["$"+r[s]]=!0;for(r=0;r<e.length;r++)s=t.hasOwnProperty("$"+e[r].value),e[r].selected!==s&&(e[r].selected=s),s&&a&&(e[r].defaultSelected=!0)}else{for(r=""+Xa(r),t=null,s=0;s<e.length;s++){if(e[s].value===r){e[s].selected=!0,a&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function Q0(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Ee(91));return Vt({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function $f(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(Ee(92));if(zi(r)){if(1<r.length)throw Error(Ee(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:Xa(r)}}function Sh(e,t){var r=Xa(t.value),a=Xa(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),a!=null&&(e.defaultValue=""+a)}function Vf(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function Ch(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Z0(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Ch(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var ic,Eh=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,a,s){MSApp.execUnsafeLocalFunction(function(){return e(t,r,a,s)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(ic=ic||document.createElement("div"),ic.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ic.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function ul(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var Xi={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},d2=["Webkit","ms","Moz","O"];Object.keys(Xi).forEach(function(e){d2.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Xi[t]=Xi[e]})});function Th(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||Xi.hasOwnProperty(e)&&Xi[e]?(""+t).trim():t+"px"}function Fh(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var a=r.indexOf("--")===0,s=Th(r,t[r],a);r==="float"&&(r="cssFloat"),a?e.setProperty(r,s):e[r]=s}}var u2=Vt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ed(e,t){if(t){if(u2[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Ee(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Ee(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(Ee(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Ee(62))}}function td(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var rd=null;function iu(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var nd=null,ni=null,ai=null;function Gf(e){if(e=Gl(e)){if(typeof nd!="function")throw Error(Ee(280));var t=e.stateNode;t&&(t=Ro(t),nd(e.stateNode,e.type,t))}}function Ah(e){ni?ai?ai.push(e):ai=[e]:ni=e}function Ph(){if(ni){var e=ni,t=ai;if(ai=ni=null,Gf(e),t)for(e=0;e<t.length;e++)Gf(t[e])}}function Dh(e,t){return e(t)}function Ih(){}var i0=!1;function Mh(e,t,r){if(i0)return e(t,r);i0=!0;try{return Dh(e,t,r)}finally{i0=!1,(ni!==null||ai!==null)&&(Ih(),Ph())}}function fl(e,t){var r=e.stateNode;if(r===null)return null;var a=Ro(r);if(a===null)return null;r=a[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(a=!a.disabled)||(e=e.type,a=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!a;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(Ee(231,t,typeof r));return r}var ad=!1;if(ga)try{var Pi={};Object.defineProperty(Pi,"passive",{get:function(){ad=!0}}),window.addEventListener("test",Pi,Pi),window.removeEventListener("test",Pi,Pi)}catch{ad=!1}function f2(e,t,r,a,s,i,l,c,o){var u=Array.prototype.slice.call(arguments,3);try{t.apply(r,u)}catch(d){this.onError(d)}}var Ki=!1,Xc=null,Kc=!1,sd=null,x2={onError:function(e){Ki=!0,Xc=e}};function m2(e,t,r,a,s,i,l,c,o){Ki=!1,Xc=null,f2.apply(x2,arguments)}function h2(e,t,r,a,s,i,l,c,o){if(m2.apply(this,arguments),Ki){if(Ki){var u=Xc;Ki=!1,Xc=null}else throw Error(Ee(198));Kc||(Kc=!0,sd=u)}}function As(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function Rh(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Xf(e){if(As(e)!==e)throw Error(Ee(188))}function p2(e){var t=e.alternate;if(!t){if(t=As(e),t===null)throw Error(Ee(188));return t!==e?null:e}for(var r=e,a=t;;){var s=r.return;if(s===null)break;var i=s.alternate;if(i===null){if(a=s.return,a!==null){r=a;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===r)return Xf(s),e;if(i===a)return Xf(s),t;i=i.sibling}throw Error(Ee(188))}if(r.return!==a.return)r=s,a=i;else{for(var l=!1,c=s.child;c;){if(c===r){l=!0,r=s,a=i;break}if(c===a){l=!0,a=s,r=i;break}c=c.sibling}if(!l){for(c=i.child;c;){if(c===r){l=!0,r=i,a=s;break}if(c===a){l=!0,a=i,r=s;break}c=c.sibling}if(!l)throw Error(Ee(189))}}if(r.alternate!==a)throw Error(Ee(190))}if(r.tag!==3)throw Error(Ee(188));return r.stateNode.current===r?e:t}function Oh(e){return e=p2(e),e!==null?Lh(e):null}function Lh(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=Lh(e);if(t!==null)return t;e=e.sibling}return null}var Bh=pn.unstable_scheduleCallback,Kf=pn.unstable_cancelCallback,g2=pn.unstable_shouldYield,v2=pn.unstable_requestPaint,Qt=pn.unstable_now,y2=pn.unstable_getCurrentPriorityLevel,lu=pn.unstable_ImmediatePriority,Uh=pn.unstable_UserBlockingPriority,Yc=pn.unstable_NormalPriority,b2=pn.unstable_LowPriority,zh=pn.unstable_IdlePriority,Po=null,ra=null;function w2(e){if(ra&&typeof ra.onCommitFiberRoot=="function")try{ra.onCommitFiberRoot(Po,e,void 0,(e.current.flags&128)===128)}catch{}}var Hn=Math.clz32?Math.clz32:k2,N2=Math.log,j2=Math.LN2;function k2(e){return e>>>=0,e===0?32:31-(N2(e)/j2|0)|0}var lc=64,cc=4194304;function Wi(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function qc(e,t){var r=e.pendingLanes;if(r===0)return 0;var a=0,s=e.suspendedLanes,i=e.pingedLanes,l=r&268435455;if(l!==0){var c=l&~s;c!==0?a=Wi(c):(i&=l,i!==0&&(a=Wi(i)))}else l=r&~s,l!==0?a=Wi(l):i!==0&&(a=Wi(i));if(a===0)return 0;if(t!==0&&t!==a&&!(t&s)&&(s=a&-a,i=t&-t,s>=i||s===16&&(i&4194240)!==0))return t;if(a&4&&(a|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=a;0<t;)r=31-Hn(t),s=1<<r,a|=e[r],t&=~s;return a}function _2(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function S2(e,t){for(var r=e.suspendedLanes,a=e.pingedLanes,s=e.expirationTimes,i=e.pendingLanes;0<i;){var l=31-Hn(i),c=1<<l,o=s[l];o===-1?(!(c&r)||c&a)&&(s[l]=_2(c,t)):o<=t&&(e.expiredLanes|=c),i&=~c}}function id(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Wh(){var e=lc;return lc<<=1,!(lc&4194240)&&(lc=64),e}function l0(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function $l(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Hn(t),e[t]=r}function C2(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var a=e.eventTimes;for(e=e.expirationTimes;0<r;){var s=31-Hn(r),i=1<<s;t[s]=0,a[s]=-1,e[s]=-1,r&=~i}}function cu(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var a=31-Hn(r),s=1<<a;s&t|e[a]&t&&(e[a]|=t),r&=~s}}var Nt=0;function Hh(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var $h,ou,Vh,Gh,Xh,ld=!1,oc=[],Ba=null,Ua=null,za=null,xl=new Map,ml=new Map,Pa=[],E2="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Yf(e,t){switch(e){case"focusin":case"focusout":Ba=null;break;case"dragenter":case"dragleave":Ua=null;break;case"mouseover":case"mouseout":za=null;break;case"pointerover":case"pointerout":xl.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":ml.delete(t.pointerId)}}function Di(e,t,r,a,s,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:r,eventSystemFlags:a,nativeEvent:i,targetContainers:[s]},t!==null&&(t=Gl(t),t!==null&&ou(t)),e):(e.eventSystemFlags|=a,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function T2(e,t,r,a,s){switch(t){case"focusin":return Ba=Di(Ba,e,t,r,a,s),!0;case"dragenter":return Ua=Di(Ua,e,t,r,a,s),!0;case"mouseover":return za=Di(za,e,t,r,a,s),!0;case"pointerover":var i=s.pointerId;return xl.set(i,Di(xl.get(i)||null,e,t,r,a,s)),!0;case"gotpointercapture":return i=s.pointerId,ml.set(i,Di(ml.get(i)||null,e,t,r,a,s)),!0}return!1}function Kh(e){var t=cs(e.target);if(t!==null){var r=As(t);if(r!==null){if(t=r.tag,t===13){if(t=Rh(r),t!==null){e.blockedOn=t,Xh(e.priority,function(){Vh(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Rc(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=cd(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var a=new r.constructor(r.type,r);rd=a,r.target.dispatchEvent(a),rd=null}else return t=Gl(r),t!==null&&ou(t),e.blockedOn=r,!1;t.shift()}return!0}function qf(e,t,r){Rc(e)&&r.delete(t)}function F2(){ld=!1,Ba!==null&&Rc(Ba)&&(Ba=null),Ua!==null&&Rc(Ua)&&(Ua=null),za!==null&&Rc(za)&&(za=null),xl.forEach(qf),ml.forEach(qf)}function Ii(e,t){e.blockedOn===t&&(e.blockedOn=null,ld||(ld=!0,pn.unstable_scheduleCallback(pn.unstable_NormalPriority,F2)))}function hl(e){function t(s){return Ii(s,e)}if(0<oc.length){Ii(oc[0],e);for(var r=1;r<oc.length;r++){var a=oc[r];a.blockedOn===e&&(a.blockedOn=null)}}for(Ba!==null&&Ii(Ba,e),Ua!==null&&Ii(Ua,e),za!==null&&Ii(za,e),xl.forEach(t),ml.forEach(t),r=0;r<Pa.length;r++)a=Pa[r],a.blockedOn===e&&(a.blockedOn=null);for(;0<Pa.length&&(r=Pa[0],r.blockedOn===null);)Kh(r),r.blockedOn===null&&Pa.shift()}var si=Na.ReactCurrentBatchConfig,Jc=!0;function A2(e,t,r,a){var s=Nt,i=si.transition;si.transition=null;try{Nt=1,du(e,t,r,a)}finally{Nt=s,si.transition=i}}function P2(e,t,r,a){var s=Nt,i=si.transition;si.transition=null;try{Nt=4,du(e,t,r,a)}finally{Nt=s,si.transition=i}}function du(e,t,r,a){if(Jc){var s=cd(e,t,r,a);if(s===null)g0(e,t,a,Qc,r),Yf(e,a);else if(T2(s,e,t,r,a))a.stopPropagation();else if(Yf(e,a),t&4&&-1<E2.indexOf(e)){for(;s!==null;){var i=Gl(s);if(i!==null&&$h(i),i=cd(e,t,r,a),i===null&&g0(e,t,a,Qc,r),i===s)break;s=i}s!==null&&a.stopPropagation()}else g0(e,t,a,null,r)}}var Qc=null;function cd(e,t,r,a){if(Qc=null,e=iu(a),e=cs(e),e!==null)if(t=As(e),t===null)e=null;else if(r=t.tag,r===13){if(e=Rh(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Qc=e,null}function Yh(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(y2()){case lu:return 1;case Uh:return 4;case Yc:case b2:return 16;case zh:return 536870912;default:return 16}default:return 16}}var Ma=null,uu=null,Oc=null;function qh(){if(Oc)return Oc;var e,t=uu,r=t.length,a,s="value"in Ma?Ma.value:Ma.textContent,i=s.length;for(e=0;e<r&&t[e]===s[e];e++);var l=r-e;for(a=1;a<=l&&t[r-a]===s[i-a];a++);return Oc=s.slice(e,1<a?1-a:void 0)}function Lc(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function dc(){return!0}function Jf(){return!1}function yn(e){function t(r,a,s,i,l){this._reactName=r,this._targetInst=s,this.type=a,this.nativeEvent=i,this.target=l,this.currentTarget=null;for(var c in e)e.hasOwnProperty(c)&&(r=e[c],this[c]=r?r(i):i[c]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?dc:Jf,this.isPropagationStopped=Jf,this}return Vt(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=dc)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=dc)},persist:function(){},isPersistent:dc}),t}var ki={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},fu=yn(ki),Vl=Vt({},ki,{view:0,detail:0}),D2=yn(Vl),c0,o0,Mi,Do=Vt({},Vl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:xu,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Mi&&(Mi&&e.type==="mousemove"?(c0=e.screenX-Mi.screenX,o0=e.screenY-Mi.screenY):o0=c0=0,Mi=e),c0)},movementY:function(e){return"movementY"in e?e.movementY:o0}}),Qf=yn(Do),I2=Vt({},Do,{dataTransfer:0}),M2=yn(I2),R2=Vt({},Vl,{relatedTarget:0}),d0=yn(R2),O2=Vt({},ki,{animationName:0,elapsedTime:0,pseudoElement:0}),L2=yn(O2),B2=Vt({},ki,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),U2=yn(B2),z2=Vt({},ki,{data:0}),Zf=yn(z2),W2={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},H2={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},$2={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function V2(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=$2[e])?!!t[e]:!1}function xu(){return V2}var G2=Vt({},Vl,{key:function(e){if(e.key){var t=W2[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Lc(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?H2[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:xu,charCode:function(e){return e.type==="keypress"?Lc(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Lc(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),X2=yn(G2),K2=Vt({},Do,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ex=yn(K2),Y2=Vt({},Vl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:xu}),q2=yn(Y2),J2=Vt({},ki,{propertyName:0,elapsedTime:0,pseudoElement:0}),Q2=yn(J2),Z2=Vt({},Do,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),ey=yn(Z2),ty=[9,13,27,32],mu=ga&&"CompositionEvent"in window,Yi=null;ga&&"documentMode"in document&&(Yi=document.documentMode);var ry=ga&&"TextEvent"in window&&!Yi,Jh=ga&&(!mu||Yi&&8<Yi&&11>=Yi),tx=" ",rx=!1;function Qh(e,t){switch(e){case"keyup":return ty.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Zh(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Vs=!1;function ny(e,t){switch(e){case"compositionend":return Zh(t);case"keypress":return t.which!==32?null:(rx=!0,tx);case"textInput":return e=t.data,e===tx&&rx?null:e;default:return null}}function ay(e,t){if(Vs)return e==="compositionend"||!mu&&Qh(e,t)?(e=qh(),Oc=uu=Ma=null,Vs=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Jh&&t.locale!=="ko"?null:t.data;default:return null}}var sy={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function nx(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!sy[e.type]:t==="textarea"}function ep(e,t,r,a){Ah(a),t=Zc(t,"onChange"),0<t.length&&(r=new fu("onChange","change",null,r,a),e.push({event:r,listeners:t}))}var qi=null,pl=null;function iy(e){up(e,0)}function Io(e){var t=Ks(e);if(kh(t))return e}function ly(e,t){if(e==="change")return t}var tp=!1;if(ga){var u0;if(ga){var f0="oninput"in document;if(!f0){var ax=document.createElement("div");ax.setAttribute("oninput","return;"),f0=typeof ax.oninput=="function"}u0=f0}else u0=!1;tp=u0&&(!document.documentMode||9<document.documentMode)}function sx(){qi&&(qi.detachEvent("onpropertychange",rp),pl=qi=null)}function rp(e){if(e.propertyName==="value"&&Io(pl)){var t=[];ep(t,pl,e,iu(e)),Mh(iy,t)}}function cy(e,t,r){e==="focusin"?(sx(),qi=t,pl=r,qi.attachEvent("onpropertychange",rp)):e==="focusout"&&sx()}function oy(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Io(pl)}function dy(e,t){if(e==="click")return Io(t)}function uy(e,t){if(e==="input"||e==="change")return Io(t)}function fy(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Xn=typeof Object.is=="function"?Object.is:fy;function gl(e,t){if(Xn(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),a=Object.keys(t);if(r.length!==a.length)return!1;for(a=0;a<r.length;a++){var s=r[a];if(!$0.call(t,s)||!Xn(e[s],t[s]))return!1}return!0}function ix(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function lx(e,t){var r=ix(e);e=0;for(var a;r;){if(r.nodeType===3){if(a=e+r.textContent.length,e<=t&&a>=t)return{node:r,offset:t-e};e=a}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=ix(r)}}function np(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?np(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function ap(){for(var e=window,t=Gc();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=Gc(e.document)}return t}function hu(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function xy(e){var t=ap(),r=e.focusedElem,a=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&np(r.ownerDocument.documentElement,r)){if(a!==null&&hu(r)){if(t=a.start,e=a.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var s=r.textContent.length,i=Math.min(a.start,s);a=a.end===void 0?i:Math.min(a.end,s),!e.extend&&i>a&&(s=a,a=i,i=s),s=lx(r,i);var l=lx(r,a);s&&l&&(e.rangeCount!==1||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==l.node||e.focusOffset!==l.offset)&&(t=t.createRange(),t.setStart(s.node,s.offset),e.removeAllRanges(),i>a?(e.addRange(t),e.extend(l.node,l.offset)):(t.setEnd(l.node,l.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var my=ga&&"documentMode"in document&&11>=document.documentMode,Gs=null,od=null,Ji=null,dd=!1;function cx(e,t,r){var a=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;dd||Gs==null||Gs!==Gc(a)||(a=Gs,"selectionStart"in a&&hu(a)?a={start:a.selectionStart,end:a.selectionEnd}:(a=(a.ownerDocument&&a.ownerDocument.defaultView||window).getSelection(),a={anchorNode:a.anchorNode,anchorOffset:a.anchorOffset,focusNode:a.focusNode,focusOffset:a.focusOffset}),Ji&&gl(Ji,a)||(Ji=a,a=Zc(od,"onSelect"),0<a.length&&(t=new fu("onSelect","select",null,t,r),e.push({event:t,listeners:a}),t.target=Gs)))}function uc(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Xs={animationend:uc("Animation","AnimationEnd"),animationiteration:uc("Animation","AnimationIteration"),animationstart:uc("Animation","AnimationStart"),transitionend:uc("Transition","TransitionEnd")},x0={},sp={};ga&&(sp=document.createElement("div").style,"AnimationEvent"in window||(delete Xs.animationend.animation,delete Xs.animationiteration.animation,delete Xs.animationstart.animation),"TransitionEvent"in window||delete Xs.transitionend.transition);function Mo(e){if(x0[e])return x0[e];if(!Xs[e])return e;var t=Xs[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in sp)return x0[e]=t[r];return e}var ip=Mo("animationend"),lp=Mo("animationiteration"),cp=Mo("animationstart"),op=Mo("transitionend"),dp=new Map,ox="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Za(e,t){dp.set(e,t),Fs(t,[e])}for(var m0=0;m0<ox.length;m0++){var h0=ox[m0],hy=h0.toLowerCase(),py=h0[0].toUpperCase()+h0.slice(1);Za(hy,"on"+py)}Za(ip,"onAnimationEnd");Za(lp,"onAnimationIteration");Za(cp,"onAnimationStart");Za("dblclick","onDoubleClick");Za("focusin","onFocus");Za("focusout","onBlur");Za(op,"onTransitionEnd");fi("onMouseEnter",["mouseout","mouseover"]);fi("onMouseLeave",["mouseout","mouseover"]);fi("onPointerEnter",["pointerout","pointerover"]);fi("onPointerLeave",["pointerout","pointerover"]);Fs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Fs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Fs("onBeforeInput",["compositionend","keypress","textInput","paste"]);Fs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Fs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Fs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Hi="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),gy=new Set("cancel close invalid load scroll toggle".split(" ").concat(Hi));function dx(e,t,r){var a=e.type||"unknown-event";e.currentTarget=r,h2(a,t,void 0,e),e.currentTarget=null}function up(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var a=e[r],s=a.event;a=a.listeners;e:{var i=void 0;if(t)for(var l=a.length-1;0<=l;l--){var c=a[l],o=c.instance,u=c.currentTarget;if(c=c.listener,o!==i&&s.isPropagationStopped())break e;dx(s,c,u),i=o}else for(l=0;l<a.length;l++){if(c=a[l],o=c.instance,u=c.currentTarget,c=c.listener,o!==i&&s.isPropagationStopped())break e;dx(s,c,u),i=o}}}if(Kc)throw e=sd,Kc=!1,sd=null,e}function Tt(e,t){var r=t[hd];r===void 0&&(r=t[hd]=new Set);var a=e+"__bubble";r.has(a)||(fp(t,e,2,!1),r.add(a))}function p0(e,t,r){var a=0;t&&(a|=4),fp(r,e,a,t)}var fc="_reactListening"+Math.random().toString(36).slice(2);function vl(e){if(!e[fc]){e[fc]=!0,yh.forEach(function(r){r!=="selectionchange"&&(gy.has(r)||p0(r,!1,e),p0(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[fc]||(t[fc]=!0,p0("selectionchange",!1,t))}}function fp(e,t,r,a){switch(Yh(t)){case 1:var s=A2;break;case 4:s=P2;break;default:s=du}r=s.bind(null,t,r,e),s=void 0,!ad||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),a?s!==void 0?e.addEventListener(t,r,{capture:!0,passive:s}):e.addEventListener(t,r,!0):s!==void 0?e.addEventListener(t,r,{passive:s}):e.addEventListener(t,r,!1)}function g0(e,t,r,a,s){var i=a;if(!(t&1)&&!(t&2)&&a!==null)e:for(;;){if(a===null)return;var l=a.tag;if(l===3||l===4){var c=a.stateNode.containerInfo;if(c===s||c.nodeType===8&&c.parentNode===s)break;if(l===4)for(l=a.return;l!==null;){var o=l.tag;if((o===3||o===4)&&(o=l.stateNode.containerInfo,o===s||o.nodeType===8&&o.parentNode===s))return;l=l.return}for(;c!==null;){if(l=cs(c),l===null)return;if(o=l.tag,o===5||o===6){a=i=l;continue e}c=c.parentNode}}a=a.return}Mh(function(){var u=i,d=iu(r),f=[];e:{var x=dp.get(e);if(x!==void 0){var h=fu,p=e;switch(e){case"keypress":if(Lc(r)===0)break e;case"keydown":case"keyup":h=X2;break;case"focusin":p="focus",h=d0;break;case"focusout":p="blur",h=d0;break;case"beforeblur":case"afterblur":h=d0;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=Qf;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=M2;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=q2;break;case ip:case lp:case cp:h=L2;break;case op:h=Q2;break;case"scroll":h=D2;break;case"wheel":h=ey;break;case"copy":case"cut":case"paste":h=U2;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=ex}var m=(t&4)!==0,w=!m&&e==="scroll",v=m?x!==null?x+"Capture":null:x;m=[];for(var b=u,y;b!==null;){y=b;var N=y.stateNode;if(y.tag===5&&N!==null&&(y=N,v!==null&&(N=fl(b,v),N!=null&&m.push(yl(b,N,y)))),w)break;b=b.return}0<m.length&&(x=new h(x,p,null,r,d),f.push({event:x,listeners:m}))}}if(!(t&7)){e:{if(x=e==="mouseover"||e==="pointerover",h=e==="mouseout"||e==="pointerout",x&&r!==rd&&(p=r.relatedTarget||r.fromElement)&&(cs(p)||p[va]))break e;if((h||x)&&(x=d.window===d?d:(x=d.ownerDocument)?x.defaultView||x.parentWindow:window,h?(p=r.relatedTarget||r.toElement,h=u,p=p?cs(p):null,p!==null&&(w=As(p),p!==w||p.tag!==5&&p.tag!==6)&&(p=null)):(h=null,p=u),h!==p)){if(m=Qf,N="onMouseLeave",v="onMouseEnter",b="mouse",(e==="pointerout"||e==="pointerover")&&(m=ex,N="onPointerLeave",v="onPointerEnter",b="pointer"),w=h==null?x:Ks(h),y=p==null?x:Ks(p),x=new m(N,b+"leave",h,r,d),x.target=w,x.relatedTarget=y,N=null,cs(d)===u&&(m=new m(v,b+"enter",p,r,d),m.target=y,m.relatedTarget=w,N=m),w=N,h&&p)t:{for(m=h,v=p,b=0,y=m;y;y=Ls(y))b++;for(y=0,N=v;N;N=Ls(N))y++;for(;0<b-y;)m=Ls(m),b--;for(;0<y-b;)v=Ls(v),y--;for(;b--;){if(m===v||v!==null&&m===v.alternate)break t;m=Ls(m),v=Ls(v)}m=null}else m=null;h!==null&&ux(f,x,h,m,!1),p!==null&&w!==null&&ux(f,w,p,m,!0)}}e:{if(x=u?Ks(u):window,h=x.nodeName&&x.nodeName.toLowerCase(),h==="select"||h==="input"&&x.type==="file")var A=ly;else if(nx(x))if(tp)A=uy;else{A=oy;var k=cy}else(h=x.nodeName)&&h.toLowerCase()==="input"&&(x.type==="checkbox"||x.type==="radio")&&(A=dy);if(A&&(A=A(e,u))){ep(f,A,r,d);break e}k&&k(e,x,u),e==="focusout"&&(k=x._wrapperState)&&k.controlled&&x.type==="number"&&J0(x,"number",x.value)}switch(k=u?Ks(u):window,e){case"focusin":(nx(k)||k.contentEditable==="true")&&(Gs=k,od=u,Ji=null);break;case"focusout":Ji=od=Gs=null;break;case"mousedown":dd=!0;break;case"contextmenu":case"mouseup":case"dragend":dd=!1,cx(f,r,d);break;case"selectionchange":if(my)break;case"keydown":case"keyup":cx(f,r,d)}var _;if(mu)e:{switch(e){case"compositionstart":var j="onCompositionStart";break e;case"compositionend":j="onCompositionEnd";break e;case"compositionupdate":j="onCompositionUpdate";break e}j=void 0}else Vs?Qh(e,r)&&(j="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(j="onCompositionStart");j&&(Jh&&r.locale!=="ko"&&(Vs||j!=="onCompositionStart"?j==="onCompositionEnd"&&Vs&&(_=qh()):(Ma=d,uu="value"in Ma?Ma.value:Ma.textContent,Vs=!0)),k=Zc(u,j),0<k.length&&(j=new Zf(j,e,null,r,d),f.push({event:j,listeners:k}),_?j.data=_:(_=Zh(r),_!==null&&(j.data=_)))),(_=ry?ny(e,r):ay(e,r))&&(u=Zc(u,"onBeforeInput"),0<u.length&&(d=new Zf("onBeforeInput","beforeinput",null,r,d),f.push({event:d,listeners:u}),d.data=_))}up(f,t)})}function yl(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Zc(e,t){for(var r=t+"Capture",a=[];e!==null;){var s=e,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=fl(e,r),i!=null&&a.unshift(yl(e,i,s)),i=fl(e,t),i!=null&&a.push(yl(e,i,s))),e=e.return}return a}function Ls(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function ux(e,t,r,a,s){for(var i=t._reactName,l=[];r!==null&&r!==a;){var c=r,o=c.alternate,u=c.stateNode;if(o!==null&&o===a)break;c.tag===5&&u!==null&&(c=u,s?(o=fl(r,i),o!=null&&l.unshift(yl(r,o,c))):s||(o=fl(r,i),o!=null&&l.push(yl(r,o,c)))),r=r.return}l.length!==0&&e.push({event:t,listeners:l})}var vy=/\r\n?/g,yy=/\u0000|\uFFFD/g;function fx(e){return(typeof e=="string"?e:""+e).replace(vy,`
`).replace(yy,"")}function xc(e,t,r){if(t=fx(t),fx(e)!==t&&r)throw Error(Ee(425))}function eo(){}var ud=null,fd=null;function xd(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var md=typeof setTimeout=="function"?setTimeout:void 0,by=typeof clearTimeout=="function"?clearTimeout:void 0,xx=typeof Promise=="function"?Promise:void 0,wy=typeof queueMicrotask=="function"?queueMicrotask:typeof xx<"u"?function(e){return xx.resolve(null).then(e).catch(Ny)}:md;function Ny(e){setTimeout(function(){throw e})}function v0(e,t){var r=t,a=0;do{var s=r.nextSibling;if(e.removeChild(r),s&&s.nodeType===8)if(r=s.data,r==="/$"){if(a===0){e.removeChild(s),hl(t);return}a--}else r!=="$"&&r!=="$?"&&r!=="$!"||a++;r=s}while(r);hl(t)}function Wa(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function mx(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var _i=Math.random().toString(36).slice(2),ea="__reactFiber$"+_i,bl="__reactProps$"+_i,va="__reactContainer$"+_i,hd="__reactEvents$"+_i,jy="__reactListeners$"+_i,ky="__reactHandles$"+_i;function cs(e){var t=e[ea];if(t)return t;for(var r=e.parentNode;r;){if(t=r[va]||r[ea]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=mx(e);e!==null;){if(r=e[ea])return r;e=mx(e)}return t}e=r,r=e.parentNode}return null}function Gl(e){return e=e[ea]||e[va],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Ks(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Ee(33))}function Ro(e){return e[bl]||null}var pd=[],Ys=-1;function es(e){return{current:e}}function At(e){0>Ys||(e.current=pd[Ys],pd[Ys]=null,Ys--)}function Ct(e,t){Ys++,pd[Ys]=e.current,e.current=t}var Ka={},Rr=es(Ka),Zr=es(!1),vs=Ka;function xi(e,t){var r=e.type.contextTypes;if(!r)return Ka;var a=e.stateNode;if(a&&a.__reactInternalMemoizedUnmaskedChildContext===t)return a.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in r)s[i]=t[i];return a&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function en(e){return e=e.childContextTypes,e!=null}function to(){At(Zr),At(Rr)}function hx(e,t,r){if(Rr.current!==Ka)throw Error(Ee(168));Ct(Rr,t),Ct(Zr,r)}function xp(e,t,r){var a=e.stateNode;if(t=t.childContextTypes,typeof a.getChildContext!="function")return r;a=a.getChildContext();for(var s in a)if(!(s in t))throw Error(Ee(108,c2(e)||"Unknown",s));return Vt({},r,a)}function ro(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ka,vs=Rr.current,Ct(Rr,e),Ct(Zr,Zr.current),!0}function px(e,t,r){var a=e.stateNode;if(!a)throw Error(Ee(169));r?(e=xp(e,t,vs),a.__reactInternalMemoizedMergedChildContext=e,At(Zr),At(Rr),Ct(Rr,e)):At(Zr),Ct(Zr,r)}var oa=null,Oo=!1,y0=!1;function mp(e){oa===null?oa=[e]:oa.push(e)}function _y(e){Oo=!0,mp(e)}function ts(){if(!y0&&oa!==null){y0=!0;var e=0,t=Nt;try{var r=oa;for(Nt=1;e<r.length;e++){var a=r[e];do a=a(!0);while(a!==null)}oa=null,Oo=!1}catch(s){throw oa!==null&&(oa=oa.slice(e+1)),Bh(lu,ts),s}finally{Nt=t,y0=!1}}return null}var qs=[],Js=0,no=null,ao=0,Sn=[],Cn=0,ys=null,da=1,ua="";function ss(e,t){qs[Js++]=ao,qs[Js++]=no,no=e,ao=t}function hp(e,t,r){Sn[Cn++]=da,Sn[Cn++]=ua,Sn[Cn++]=ys,ys=e;var a=da;e=ua;var s=32-Hn(a)-1;a&=~(1<<s),r+=1;var i=32-Hn(t)+s;if(30<i){var l=s-s%5;i=(a&(1<<l)-1).toString(32),a>>=l,s-=l,da=1<<32-Hn(t)+s|r<<s|a,ua=i+e}else da=1<<i|r<<s|a,ua=e}function pu(e){e.return!==null&&(ss(e,1),hp(e,1,0))}function gu(e){for(;e===no;)no=qs[--Js],qs[Js]=null,ao=qs[--Js],qs[Js]=null;for(;e===ys;)ys=Sn[--Cn],Sn[Cn]=null,ua=Sn[--Cn],Sn[Cn]=null,da=Sn[--Cn],Sn[Cn]=null}var hn=null,mn=null,Ot=!1,Un=null;function pp(e,t){var r=En(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function gx(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,hn=e,mn=Wa(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,hn=e,mn=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=ys!==null?{id:da,overflow:ua}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=En(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,hn=e,mn=null,!0):!1;default:return!1}}function gd(e){return(e.mode&1)!==0&&(e.flags&128)===0}function vd(e){if(Ot){var t=mn;if(t){var r=t;if(!gx(e,t)){if(gd(e))throw Error(Ee(418));t=Wa(r.nextSibling);var a=hn;t&&gx(e,t)?pp(a,r):(e.flags=e.flags&-4097|2,Ot=!1,hn=e)}}else{if(gd(e))throw Error(Ee(418));e.flags=e.flags&-4097|2,Ot=!1,hn=e}}}function vx(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;hn=e}function mc(e){if(e!==hn)return!1;if(!Ot)return vx(e),Ot=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!xd(e.type,e.memoizedProps)),t&&(t=mn)){if(gd(e))throw gp(),Error(Ee(418));for(;t;)pp(e,t),t=Wa(t.nextSibling)}if(vx(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Ee(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){mn=Wa(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}mn=null}}else mn=hn?Wa(e.stateNode.nextSibling):null;return!0}function gp(){for(var e=mn;e;)e=Wa(e.nextSibling)}function mi(){mn=hn=null,Ot=!1}function vu(e){Un===null?Un=[e]:Un.push(e)}var Sy=Na.ReactCurrentBatchConfig;function Ri(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Ee(309));var a=r.stateNode}if(!a)throw Error(Ee(147,e));var s=a,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(l){var c=s.refs;l===null?delete c[i]:c[i]=l},t._stringRef=i,t)}if(typeof e!="string")throw Error(Ee(284));if(!r._owner)throw Error(Ee(290,e))}return e}function hc(e,t){throw e=Object.prototype.toString.call(t),Error(Ee(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function yx(e){var t=e._init;return t(e._payload)}function vp(e){function t(v,b){if(e){var y=v.deletions;y===null?(v.deletions=[b],v.flags|=16):y.push(b)}}function r(v,b){if(!e)return null;for(;b!==null;)t(v,b),b=b.sibling;return null}function a(v,b){for(v=new Map;b!==null;)b.key!==null?v.set(b.key,b):v.set(b.index,b),b=b.sibling;return v}function s(v,b){return v=Ga(v,b),v.index=0,v.sibling=null,v}function i(v,b,y){return v.index=y,e?(y=v.alternate,y!==null?(y=y.index,y<b?(v.flags|=2,b):y):(v.flags|=2,b)):(v.flags|=1048576,b)}function l(v){return e&&v.alternate===null&&(v.flags|=2),v}function c(v,b,y,N){return b===null||b.tag!==6?(b=S0(y,v.mode,N),b.return=v,b):(b=s(b,y),b.return=v,b)}function o(v,b,y,N){var A=y.type;return A===$s?d(v,b,y.props.children,N,y.key):b!==null&&(b.elementType===A||typeof A=="object"&&A!==null&&A.$$typeof===Fa&&yx(A)===b.type)?(N=s(b,y.props),N.ref=Ri(v,b,y),N.return=v,N):(N=Vc(y.type,y.key,y.props,null,v.mode,N),N.ref=Ri(v,b,y),N.return=v,N)}function u(v,b,y,N){return b===null||b.tag!==4||b.stateNode.containerInfo!==y.containerInfo||b.stateNode.implementation!==y.implementation?(b=C0(y,v.mode,N),b.return=v,b):(b=s(b,y.children||[]),b.return=v,b)}function d(v,b,y,N,A){return b===null||b.tag!==7?(b=xs(y,v.mode,N,A),b.return=v,b):(b=s(b,y),b.return=v,b)}function f(v,b,y){if(typeof b=="string"&&b!==""||typeof b=="number")return b=S0(""+b,v.mode,y),b.return=v,b;if(typeof b=="object"&&b!==null){switch(b.$$typeof){case ac:return y=Vc(b.type,b.key,b.props,null,v.mode,y),y.ref=Ri(v,null,b),y.return=v,y;case Hs:return b=C0(b,v.mode,y),b.return=v,b;case Fa:var N=b._init;return f(v,N(b._payload),y)}if(zi(b)||Ai(b))return b=xs(b,v.mode,y,null),b.return=v,b;hc(v,b)}return null}function x(v,b,y,N){var A=b!==null?b.key:null;if(typeof y=="string"&&y!==""||typeof y=="number")return A!==null?null:c(v,b,""+y,N);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case ac:return y.key===A?o(v,b,y,N):null;case Hs:return y.key===A?u(v,b,y,N):null;case Fa:return A=y._init,x(v,b,A(y._payload),N)}if(zi(y)||Ai(y))return A!==null?null:d(v,b,y,N,null);hc(v,y)}return null}function h(v,b,y,N,A){if(typeof N=="string"&&N!==""||typeof N=="number")return v=v.get(y)||null,c(b,v,""+N,A);if(typeof N=="object"&&N!==null){switch(N.$$typeof){case ac:return v=v.get(N.key===null?y:N.key)||null,o(b,v,N,A);case Hs:return v=v.get(N.key===null?y:N.key)||null,u(b,v,N,A);case Fa:var k=N._init;return h(v,b,y,k(N._payload),A)}if(zi(N)||Ai(N))return v=v.get(y)||null,d(b,v,N,A,null);hc(b,N)}return null}function p(v,b,y,N){for(var A=null,k=null,_=b,j=b=0,P=null;_!==null&&j<y.length;j++){_.index>j?(P=_,_=null):P=_.sibling;var D=x(v,_,y[j],N);if(D===null){_===null&&(_=P);break}e&&_&&D.alternate===null&&t(v,_),b=i(D,b,j),k===null?A=D:k.sibling=D,k=D,_=P}if(j===y.length)return r(v,_),Ot&&ss(v,j),A;if(_===null){for(;j<y.length;j++)_=f(v,y[j],N),_!==null&&(b=i(_,b,j),k===null?A=_:k.sibling=_,k=_);return Ot&&ss(v,j),A}for(_=a(v,_);j<y.length;j++)P=h(_,v,j,y[j],N),P!==null&&(e&&P.alternate!==null&&_.delete(P.key===null?j:P.key),b=i(P,b,j),k===null?A=P:k.sibling=P,k=P);return e&&_.forEach(function(K){return t(v,K)}),Ot&&ss(v,j),A}function m(v,b,y,N){var A=Ai(y);if(typeof A!="function")throw Error(Ee(150));if(y=A.call(y),y==null)throw Error(Ee(151));for(var k=A=null,_=b,j=b=0,P=null,D=y.next();_!==null&&!D.done;j++,D=y.next()){_.index>j?(P=_,_=null):P=_.sibling;var K=x(v,_,D.value,N);if(K===null){_===null&&(_=P);break}e&&_&&K.alternate===null&&t(v,_),b=i(K,b,j),k===null?A=K:k.sibling=K,k=K,_=P}if(D.done)return r(v,_),Ot&&ss(v,j),A;if(_===null){for(;!D.done;j++,D=y.next())D=f(v,D.value,N),D!==null&&(b=i(D,b,j),k===null?A=D:k.sibling=D,k=D);return Ot&&ss(v,j),A}for(_=a(v,_);!D.done;j++,D=y.next())D=h(_,v,j,D.value,N),D!==null&&(e&&D.alternate!==null&&_.delete(D.key===null?j:D.key),b=i(D,b,j),k===null?A=D:k.sibling=D,k=D);return e&&_.forEach(function(E){return t(v,E)}),Ot&&ss(v,j),A}function w(v,b,y,N){if(typeof y=="object"&&y!==null&&y.type===$s&&y.key===null&&(y=y.props.children),typeof y=="object"&&y!==null){switch(y.$$typeof){case ac:e:{for(var A=y.key,k=b;k!==null;){if(k.key===A){if(A=y.type,A===$s){if(k.tag===7){r(v,k.sibling),b=s(k,y.props.children),b.return=v,v=b;break e}}else if(k.elementType===A||typeof A=="object"&&A!==null&&A.$$typeof===Fa&&yx(A)===k.type){r(v,k.sibling),b=s(k,y.props),b.ref=Ri(v,k,y),b.return=v,v=b;break e}r(v,k);break}else t(v,k);k=k.sibling}y.type===$s?(b=xs(y.props.children,v.mode,N,y.key),b.return=v,v=b):(N=Vc(y.type,y.key,y.props,null,v.mode,N),N.ref=Ri(v,b,y),N.return=v,v=N)}return l(v);case Hs:e:{for(k=y.key;b!==null;){if(b.key===k)if(b.tag===4&&b.stateNode.containerInfo===y.containerInfo&&b.stateNode.implementation===y.implementation){r(v,b.sibling),b=s(b,y.children||[]),b.return=v,v=b;break e}else{r(v,b);break}else t(v,b);b=b.sibling}b=C0(y,v.mode,N),b.return=v,v=b}return l(v);case Fa:return k=y._init,w(v,b,k(y._payload),N)}if(zi(y))return p(v,b,y,N);if(Ai(y))return m(v,b,y,N);hc(v,y)}return typeof y=="string"&&y!==""||typeof y=="number"?(y=""+y,b!==null&&b.tag===6?(r(v,b.sibling),b=s(b,y),b.return=v,v=b):(r(v,b),b=S0(y,v.mode,N),b.return=v,v=b),l(v)):r(v,b)}return w}var hi=vp(!0),yp=vp(!1),so=es(null),io=null,Qs=null,yu=null;function bu(){yu=Qs=io=null}function wu(e){var t=so.current;At(so),e._currentValue=t}function yd(e,t,r){for(;e!==null;){var a=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,a!==null&&(a.childLanes|=t)):a!==null&&(a.childLanes&t)!==t&&(a.childLanes|=t),e===r)break;e=e.return}}function ii(e,t){io=e,yu=Qs=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Qr=!0),e.firstContext=null)}function An(e){var t=e._currentValue;if(yu!==e)if(e={context:e,memoizedValue:t,next:null},Qs===null){if(io===null)throw Error(Ee(308));Qs=e,io.dependencies={lanes:0,firstContext:e}}else Qs=Qs.next=e;return t}var os=null;function Nu(e){os===null?os=[e]:os.push(e)}function bp(e,t,r,a){var s=t.interleaved;return s===null?(r.next=r,Nu(t)):(r.next=s.next,s.next=r),t.interleaved=r,ya(e,a)}function ya(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Aa=!1;function ju(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function wp(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function xa(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Ha(e,t,r){var a=e.updateQueue;if(a===null)return null;if(a=a.shared,ft&2){var s=a.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),a.pending=t,ya(e,r)}return s=a.interleaved,s===null?(t.next=t,Nu(a)):(t.next=s.next,s.next=t),a.interleaved=t,ya(e,r)}function Bc(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var a=t.lanes;a&=e.pendingLanes,r|=a,t.lanes=r,cu(e,r)}}function bx(e,t){var r=e.updateQueue,a=e.alternate;if(a!==null&&(a=a.updateQueue,r===a)){var s=null,i=null;if(r=r.firstBaseUpdate,r!==null){do{var l={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};i===null?s=i=l:i=i.next=l,r=r.next}while(r!==null);i===null?s=i=t:i=i.next=t}else s=i=t;r={baseState:a.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:a.shared,effects:a.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function lo(e,t,r,a){var s=e.updateQueue;Aa=!1;var i=s.firstBaseUpdate,l=s.lastBaseUpdate,c=s.shared.pending;if(c!==null){s.shared.pending=null;var o=c,u=o.next;o.next=null,l===null?i=u:l.next=u,l=o;var d=e.alternate;d!==null&&(d=d.updateQueue,c=d.lastBaseUpdate,c!==l&&(c===null?d.firstBaseUpdate=u:c.next=u,d.lastBaseUpdate=o))}if(i!==null){var f=s.baseState;l=0,d=u=o=null,c=i;do{var x=c.lane,h=c.eventTime;if((a&x)===x){d!==null&&(d=d.next={eventTime:h,lane:0,tag:c.tag,payload:c.payload,callback:c.callback,next:null});e:{var p=e,m=c;switch(x=t,h=r,m.tag){case 1:if(p=m.payload,typeof p=="function"){f=p.call(h,f,x);break e}f=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=m.payload,x=typeof p=="function"?p.call(h,f,x):p,x==null)break e;f=Vt({},f,x);break e;case 2:Aa=!0}}c.callback!==null&&c.lane!==0&&(e.flags|=64,x=s.effects,x===null?s.effects=[c]:x.push(c))}else h={eventTime:h,lane:x,tag:c.tag,payload:c.payload,callback:c.callback,next:null},d===null?(u=d=h,o=f):d=d.next=h,l|=x;if(c=c.next,c===null){if(c=s.shared.pending,c===null)break;x=c,c=x.next,x.next=null,s.lastBaseUpdate=x,s.shared.pending=null}}while(!0);if(d===null&&(o=f),s.baseState=o,s.firstBaseUpdate=u,s.lastBaseUpdate=d,t=s.shared.interleaved,t!==null){s=t;do l|=s.lane,s=s.next;while(s!==t)}else i===null&&(s.shared.lanes=0);ws|=l,e.lanes=l,e.memoizedState=f}}function wx(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var a=e[t],s=a.callback;if(s!==null){if(a.callback=null,a=r,typeof s!="function")throw Error(Ee(191,s));s.call(a)}}}var Xl={},na=es(Xl),wl=es(Xl),Nl=es(Xl);function ds(e){if(e===Xl)throw Error(Ee(174));return e}function ku(e,t){switch(Ct(Nl,t),Ct(wl,e),Ct(na,Xl),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Z0(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Z0(t,e)}At(na),Ct(na,t)}function pi(){At(na),At(wl),At(Nl)}function Np(e){ds(Nl.current);var t=ds(na.current),r=Z0(t,e.type);t!==r&&(Ct(wl,e),Ct(na,r))}function _u(e){wl.current===e&&(At(na),At(wl))}var zt=es(0);function co(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var b0=[];function Su(){for(var e=0;e<b0.length;e++)b0[e]._workInProgressVersionPrimary=null;b0.length=0}var Uc=Na.ReactCurrentDispatcher,w0=Na.ReactCurrentBatchConfig,bs=0,$t=null,lr=null,xr=null,oo=!1,Qi=!1,jl=0,Cy=0;function Cr(){throw Error(Ee(321))}function Cu(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Xn(e[r],t[r]))return!1;return!0}function Eu(e,t,r,a,s,i){if(bs=i,$t=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Uc.current=e===null||e.memoizedState===null?Ay:Py,e=r(a,s),Qi){i=0;do{if(Qi=!1,jl=0,25<=i)throw Error(Ee(301));i+=1,xr=lr=null,t.updateQueue=null,Uc.current=Dy,e=r(a,s)}while(Qi)}if(Uc.current=uo,t=lr!==null&&lr.next!==null,bs=0,xr=lr=$t=null,oo=!1,t)throw Error(Ee(300));return e}function Tu(){var e=jl!==0;return jl=0,e}function Zn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return xr===null?$t.memoizedState=xr=e:xr=xr.next=e,xr}function Pn(){if(lr===null){var e=$t.alternate;e=e!==null?e.memoizedState:null}else e=lr.next;var t=xr===null?$t.memoizedState:xr.next;if(t!==null)xr=t,lr=e;else{if(e===null)throw Error(Ee(310));lr=e,e={memoizedState:lr.memoizedState,baseState:lr.baseState,baseQueue:lr.baseQueue,queue:lr.queue,next:null},xr===null?$t.memoizedState=xr=e:xr=xr.next=e}return xr}function kl(e,t){return typeof t=="function"?t(e):t}function N0(e){var t=Pn(),r=t.queue;if(r===null)throw Error(Ee(311));r.lastRenderedReducer=e;var a=lr,s=a.baseQueue,i=r.pending;if(i!==null){if(s!==null){var l=s.next;s.next=i.next,i.next=l}a.baseQueue=s=i,r.pending=null}if(s!==null){i=s.next,a=a.baseState;var c=l=null,o=null,u=i;do{var d=u.lane;if((bs&d)===d)o!==null&&(o=o.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),a=u.hasEagerState?u.eagerState:e(a,u.action);else{var f={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};o===null?(c=o=f,l=a):o=o.next=f,$t.lanes|=d,ws|=d}u=u.next}while(u!==null&&u!==i);o===null?l=a:o.next=c,Xn(a,t.memoizedState)||(Qr=!0),t.memoizedState=a,t.baseState=l,t.baseQueue=o,r.lastRenderedState=a}if(e=r.interleaved,e!==null){s=e;do i=s.lane,$t.lanes|=i,ws|=i,s=s.next;while(s!==e)}else s===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function j0(e){var t=Pn(),r=t.queue;if(r===null)throw Error(Ee(311));r.lastRenderedReducer=e;var a=r.dispatch,s=r.pending,i=t.memoizedState;if(s!==null){r.pending=null;var l=s=s.next;do i=e(i,l.action),l=l.next;while(l!==s);Xn(i,t.memoizedState)||(Qr=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),r.lastRenderedState=i}return[i,a]}function jp(){}function kp(e,t){var r=$t,a=Pn(),s=t(),i=!Xn(a.memoizedState,s);if(i&&(a.memoizedState=s,Qr=!0),a=a.queue,Fu(Cp.bind(null,r,a,e),[e]),a.getSnapshot!==t||i||xr!==null&&xr.memoizedState.tag&1){if(r.flags|=2048,_l(9,Sp.bind(null,r,a,s,t),void 0,null),pr===null)throw Error(Ee(349));bs&30||_p(r,t,s)}return s}function _p(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=$t.updateQueue,t===null?(t={lastEffect:null,stores:null},$t.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function Sp(e,t,r,a){t.value=r,t.getSnapshot=a,Ep(t)&&Tp(e)}function Cp(e,t,r){return r(function(){Ep(t)&&Tp(e)})}function Ep(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Xn(e,r)}catch{return!0}}function Tp(e){var t=ya(e,1);t!==null&&$n(t,e,1,-1)}function Nx(e){var t=Zn();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:kl,lastRenderedState:e},t.queue=e,e=e.dispatch=Fy.bind(null,$t,e),[t.memoizedState,e]}function _l(e,t,r,a){return e={tag:e,create:t,destroy:r,deps:a,next:null},t=$t.updateQueue,t===null?(t={lastEffect:null,stores:null},$t.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(a=r.next,r.next=e,e.next=a,t.lastEffect=e)),e}function Fp(){return Pn().memoizedState}function zc(e,t,r,a){var s=Zn();$t.flags|=e,s.memoizedState=_l(1|t,r,void 0,a===void 0?null:a)}function Lo(e,t,r,a){var s=Pn();a=a===void 0?null:a;var i=void 0;if(lr!==null){var l=lr.memoizedState;if(i=l.destroy,a!==null&&Cu(a,l.deps)){s.memoizedState=_l(t,r,i,a);return}}$t.flags|=e,s.memoizedState=_l(1|t,r,i,a)}function jx(e,t){return zc(8390656,8,e,t)}function Fu(e,t){return Lo(2048,8,e,t)}function Ap(e,t){return Lo(4,2,e,t)}function Pp(e,t){return Lo(4,4,e,t)}function Dp(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Ip(e,t,r){return r=r!=null?r.concat([e]):null,Lo(4,4,Dp.bind(null,t,e),r)}function Au(){}function Mp(e,t){var r=Pn();t=t===void 0?null:t;var a=r.memoizedState;return a!==null&&t!==null&&Cu(t,a[1])?a[0]:(r.memoizedState=[e,t],e)}function Rp(e,t){var r=Pn();t=t===void 0?null:t;var a=r.memoizedState;return a!==null&&t!==null&&Cu(t,a[1])?a[0]:(e=e(),r.memoizedState=[e,t],e)}function Op(e,t,r){return bs&21?(Xn(r,t)||(r=Wh(),$t.lanes|=r,ws|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Qr=!0),e.memoizedState=r)}function Ey(e,t){var r=Nt;Nt=r!==0&&4>r?r:4,e(!0);var a=w0.transition;w0.transition={};try{e(!1),t()}finally{Nt=r,w0.transition=a}}function Lp(){return Pn().memoizedState}function Ty(e,t,r){var a=Va(e);if(r={lane:a,action:r,hasEagerState:!1,eagerState:null,next:null},Bp(e))Up(t,r);else if(r=bp(e,t,r,a),r!==null){var s=$r();$n(r,e,a,s),zp(r,t,a)}}function Fy(e,t,r){var a=Va(e),s={lane:a,action:r,hasEagerState:!1,eagerState:null,next:null};if(Bp(e))Up(t,s);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var l=t.lastRenderedState,c=i(l,r);if(s.hasEagerState=!0,s.eagerState=c,Xn(c,l)){var o=t.interleaved;o===null?(s.next=s,Nu(t)):(s.next=o.next,o.next=s),t.interleaved=s;return}}catch{}finally{}r=bp(e,t,s,a),r!==null&&(s=$r(),$n(r,e,a,s),zp(r,t,a))}}function Bp(e){var t=e.alternate;return e===$t||t!==null&&t===$t}function Up(e,t){Qi=oo=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function zp(e,t,r){if(r&4194240){var a=t.lanes;a&=e.pendingLanes,r|=a,t.lanes=r,cu(e,r)}}var uo={readContext:An,useCallback:Cr,useContext:Cr,useEffect:Cr,useImperativeHandle:Cr,useInsertionEffect:Cr,useLayoutEffect:Cr,useMemo:Cr,useReducer:Cr,useRef:Cr,useState:Cr,useDebugValue:Cr,useDeferredValue:Cr,useTransition:Cr,useMutableSource:Cr,useSyncExternalStore:Cr,useId:Cr,unstable_isNewReconciler:!1},Ay={readContext:An,useCallback:function(e,t){return Zn().memoizedState=[e,t===void 0?null:t],e},useContext:An,useEffect:jx,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,zc(4194308,4,Dp.bind(null,t,e),r)},useLayoutEffect:function(e,t){return zc(4194308,4,e,t)},useInsertionEffect:function(e,t){return zc(4,2,e,t)},useMemo:function(e,t){var r=Zn();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var a=Zn();return t=r!==void 0?r(t):t,a.memoizedState=a.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},a.queue=e,e=e.dispatch=Ty.bind(null,$t,e),[a.memoizedState,e]},useRef:function(e){var t=Zn();return e={current:e},t.memoizedState=e},useState:Nx,useDebugValue:Au,useDeferredValue:function(e){return Zn().memoizedState=e},useTransition:function(){var e=Nx(!1),t=e[0];return e=Ey.bind(null,e[1]),Zn().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var a=$t,s=Zn();if(Ot){if(r===void 0)throw Error(Ee(407));r=r()}else{if(r=t(),pr===null)throw Error(Ee(349));bs&30||_p(a,t,r)}s.memoizedState=r;var i={value:r,getSnapshot:t};return s.queue=i,jx(Cp.bind(null,a,i,e),[e]),a.flags|=2048,_l(9,Sp.bind(null,a,i,r,t),void 0,null),r},useId:function(){var e=Zn(),t=pr.identifierPrefix;if(Ot){var r=ua,a=da;r=(a&~(1<<32-Hn(a)-1)).toString(32)+r,t=":"+t+"R"+r,r=jl++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=Cy++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Py={readContext:An,useCallback:Mp,useContext:An,useEffect:Fu,useImperativeHandle:Ip,useInsertionEffect:Ap,useLayoutEffect:Pp,useMemo:Rp,useReducer:N0,useRef:Fp,useState:function(){return N0(kl)},useDebugValue:Au,useDeferredValue:function(e){var t=Pn();return Op(t,lr.memoizedState,e)},useTransition:function(){var e=N0(kl)[0],t=Pn().memoizedState;return[e,t]},useMutableSource:jp,useSyncExternalStore:kp,useId:Lp,unstable_isNewReconciler:!1},Dy={readContext:An,useCallback:Mp,useContext:An,useEffect:Fu,useImperativeHandle:Ip,useInsertionEffect:Ap,useLayoutEffect:Pp,useMemo:Rp,useReducer:j0,useRef:Fp,useState:function(){return j0(kl)},useDebugValue:Au,useDeferredValue:function(e){var t=Pn();return lr===null?t.memoizedState=e:Op(t,lr.memoizedState,e)},useTransition:function(){var e=j0(kl)[0],t=Pn().memoizedState;return[e,t]},useMutableSource:jp,useSyncExternalStore:kp,useId:Lp,unstable_isNewReconciler:!1};function Ln(e,t){if(e&&e.defaultProps){t=Vt({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function bd(e,t,r,a){t=e.memoizedState,r=r(a,t),r=r==null?t:Vt({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var Bo={isMounted:function(e){return(e=e._reactInternals)?As(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var a=$r(),s=Va(e),i=xa(a,s);i.payload=t,r!=null&&(i.callback=r),t=Ha(e,i,s),t!==null&&($n(t,e,s,a),Bc(t,e,s))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var a=$r(),s=Va(e),i=xa(a,s);i.tag=1,i.payload=t,r!=null&&(i.callback=r),t=Ha(e,i,s),t!==null&&($n(t,e,s,a),Bc(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=$r(),a=Va(e),s=xa(r,a);s.tag=2,t!=null&&(s.callback=t),t=Ha(e,s,a),t!==null&&($n(t,e,a,r),Bc(t,e,a))}};function kx(e,t,r,a,s,i,l){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(a,i,l):t.prototype&&t.prototype.isPureReactComponent?!gl(r,a)||!gl(s,i):!0}function Wp(e,t,r){var a=!1,s=Ka,i=t.contextType;return typeof i=="object"&&i!==null?i=An(i):(s=en(t)?vs:Rr.current,a=t.contextTypes,i=(a=a!=null)?xi(e,s):Ka),t=new t(r,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Bo,e.stateNode=t,t._reactInternals=e,a&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=i),t}function _x(e,t,r,a){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,a),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,a),t.state!==e&&Bo.enqueueReplaceState(t,t.state,null)}function wd(e,t,r,a){var s=e.stateNode;s.props=r,s.state=e.memoizedState,s.refs={},ju(e);var i=t.contextType;typeof i=="object"&&i!==null?s.context=An(i):(i=en(t)?vs:Rr.current,s.context=xi(e,i)),s.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(bd(e,t,i,r),s.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(t=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),t!==s.state&&Bo.enqueueReplaceState(s,s.state,null),lo(e,r,s,a),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308)}function gi(e,t){try{var r="",a=t;do r+=l2(a),a=a.return;while(a);var s=r}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:s,digest:null}}function k0(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function Nd(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var Iy=typeof WeakMap=="function"?WeakMap:Map;function Hp(e,t,r){r=xa(-1,r),r.tag=3,r.payload={element:null};var a=t.value;return r.callback=function(){xo||(xo=!0,Pd=a),Nd(e,t)},r}function $p(e,t,r){r=xa(-1,r),r.tag=3;var a=e.type.getDerivedStateFromError;if(typeof a=="function"){var s=t.value;r.payload=function(){return a(s)},r.callback=function(){Nd(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(r.callback=function(){Nd(e,t),typeof a!="function"&&($a===null?$a=new Set([this]):$a.add(this));var l=t.stack;this.componentDidCatch(t.value,{componentStack:l!==null?l:""})}),r}function Sx(e,t,r){var a=e.pingCache;if(a===null){a=e.pingCache=new Iy;var s=new Set;a.set(t,s)}else s=a.get(t),s===void 0&&(s=new Set,a.set(t,s));s.has(r)||(s.add(r),e=Ky.bind(null,e,t,r),t.then(e,e))}function Cx(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Ex(e,t,r,a,s){return e.mode&1?(e.flags|=65536,e.lanes=s,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=xa(-1,1),t.tag=2,Ha(r,t,1))),r.lanes|=1),e)}var My=Na.ReactCurrentOwner,Qr=!1;function zr(e,t,r,a){t.child=e===null?yp(t,null,r,a):hi(t,e.child,r,a)}function Tx(e,t,r,a,s){r=r.render;var i=t.ref;return ii(t,s),a=Eu(e,t,r,a,i,s),r=Tu(),e!==null&&!Qr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,ba(e,t,s)):(Ot&&r&&pu(t),t.flags|=1,zr(e,t,a,s),t.child)}function Fx(e,t,r,a,s){if(e===null){var i=r.type;return typeof i=="function"&&!Bu(i)&&i.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=i,Vp(e,t,i,a,s)):(e=Vc(r.type,null,a,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&s)){var l=i.memoizedProps;if(r=r.compare,r=r!==null?r:gl,r(l,a)&&e.ref===t.ref)return ba(e,t,s)}return t.flags|=1,e=Ga(i,a),e.ref=t.ref,e.return=t,t.child=e}function Vp(e,t,r,a,s){if(e!==null){var i=e.memoizedProps;if(gl(i,a)&&e.ref===t.ref)if(Qr=!1,t.pendingProps=a=i,(e.lanes&s)!==0)e.flags&131072&&(Qr=!0);else return t.lanes=e.lanes,ba(e,t,s)}return jd(e,t,r,a,s)}function Gp(e,t,r){var a=t.pendingProps,s=a.children,i=e!==null?e.memoizedState:null;if(a.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ct(ei,on),on|=r;else{if(!(r&1073741824))return e=i!==null?i.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ct(ei,on),on|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},a=i!==null?i.baseLanes:r,Ct(ei,on),on|=a}else i!==null?(a=i.baseLanes|r,t.memoizedState=null):a=r,Ct(ei,on),on|=a;return zr(e,t,s,r),t.child}function Xp(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function jd(e,t,r,a,s){var i=en(r)?vs:Rr.current;return i=xi(t,i),ii(t,s),r=Eu(e,t,r,a,i,s),a=Tu(),e!==null&&!Qr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,ba(e,t,s)):(Ot&&a&&pu(t),t.flags|=1,zr(e,t,r,s),t.child)}function Ax(e,t,r,a,s){if(en(r)){var i=!0;ro(t)}else i=!1;if(ii(t,s),t.stateNode===null)Wc(e,t),Wp(t,r,a),wd(t,r,a,s),a=!0;else if(e===null){var l=t.stateNode,c=t.memoizedProps;l.props=c;var o=l.context,u=r.contextType;typeof u=="object"&&u!==null?u=An(u):(u=en(r)?vs:Rr.current,u=xi(t,u));var d=r.getDerivedStateFromProps,f=typeof d=="function"||typeof l.getSnapshotBeforeUpdate=="function";f||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(c!==a||o!==u)&&_x(t,l,a,u),Aa=!1;var x=t.memoizedState;l.state=x,lo(t,a,l,s),o=t.memoizedState,c!==a||x!==o||Zr.current||Aa?(typeof d=="function"&&(bd(t,r,d,a),o=t.memoizedState),(c=Aa||kx(t,r,c,a,x,o,u))?(f||typeof l.UNSAFE_componentWillMount!="function"&&typeof l.componentWillMount!="function"||(typeof l.componentWillMount=="function"&&l.componentWillMount(),typeof l.UNSAFE_componentWillMount=="function"&&l.UNSAFE_componentWillMount()),typeof l.componentDidMount=="function"&&(t.flags|=4194308)):(typeof l.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=a,t.memoizedState=o),l.props=a,l.state=o,l.context=u,a=c):(typeof l.componentDidMount=="function"&&(t.flags|=4194308),a=!1)}else{l=t.stateNode,wp(e,t),c=t.memoizedProps,u=t.type===t.elementType?c:Ln(t.type,c),l.props=u,f=t.pendingProps,x=l.context,o=r.contextType,typeof o=="object"&&o!==null?o=An(o):(o=en(r)?vs:Rr.current,o=xi(t,o));var h=r.getDerivedStateFromProps;(d=typeof h=="function"||typeof l.getSnapshotBeforeUpdate=="function")||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(c!==f||x!==o)&&_x(t,l,a,o),Aa=!1,x=t.memoizedState,l.state=x,lo(t,a,l,s);var p=t.memoizedState;c!==f||x!==p||Zr.current||Aa?(typeof h=="function"&&(bd(t,r,h,a),p=t.memoizedState),(u=Aa||kx(t,r,u,a,x,p,o)||!1)?(d||typeof l.UNSAFE_componentWillUpdate!="function"&&typeof l.componentWillUpdate!="function"||(typeof l.componentWillUpdate=="function"&&l.componentWillUpdate(a,p,o),typeof l.UNSAFE_componentWillUpdate=="function"&&l.UNSAFE_componentWillUpdate(a,p,o)),typeof l.componentDidUpdate=="function"&&(t.flags|=4),typeof l.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof l.componentDidUpdate!="function"||c===e.memoizedProps&&x===e.memoizedState||(t.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||c===e.memoizedProps&&x===e.memoizedState||(t.flags|=1024),t.memoizedProps=a,t.memoizedState=p),l.props=a,l.state=p,l.context=o,a=u):(typeof l.componentDidUpdate!="function"||c===e.memoizedProps&&x===e.memoizedState||(t.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||c===e.memoizedProps&&x===e.memoizedState||(t.flags|=1024),a=!1)}return kd(e,t,r,a,i,s)}function kd(e,t,r,a,s,i){Xp(e,t);var l=(t.flags&128)!==0;if(!a&&!l)return s&&px(t,r,!1),ba(e,t,i);a=t.stateNode,My.current=t;var c=l&&typeof r.getDerivedStateFromError!="function"?null:a.render();return t.flags|=1,e!==null&&l?(t.child=hi(t,e.child,null,i),t.child=hi(t,null,c,i)):zr(e,t,c,i),t.memoizedState=a.state,s&&px(t,r,!0),t.child}function Kp(e){var t=e.stateNode;t.pendingContext?hx(e,t.pendingContext,t.pendingContext!==t.context):t.context&&hx(e,t.context,!1),ku(e,t.containerInfo)}function Px(e,t,r,a,s){return mi(),vu(s),t.flags|=256,zr(e,t,r,a),t.child}var _d={dehydrated:null,treeContext:null,retryLane:0};function Sd(e){return{baseLanes:e,cachePool:null,transitions:null}}function Yp(e,t,r){var a=t.pendingProps,s=zt.current,i=!1,l=(t.flags&128)!==0,c;if((c=l)||(c=e!==null&&e.memoizedState===null?!1:(s&2)!==0),c?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(s|=1),Ct(zt,s&1),e===null)return vd(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(l=a.children,e=a.fallback,i?(a=t.mode,i=t.child,l={mode:"hidden",children:l},!(a&1)&&i!==null?(i.childLanes=0,i.pendingProps=l):i=Wo(l,a,0,null),e=xs(e,a,r,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=Sd(r),t.memoizedState=_d,e):Pu(t,l));if(s=e.memoizedState,s!==null&&(c=s.dehydrated,c!==null))return Ry(e,t,l,a,c,s,r);if(i){i=a.fallback,l=t.mode,s=e.child,c=s.sibling;var o={mode:"hidden",children:a.children};return!(l&1)&&t.child!==s?(a=t.child,a.childLanes=0,a.pendingProps=o,t.deletions=null):(a=Ga(s,o),a.subtreeFlags=s.subtreeFlags&14680064),c!==null?i=Ga(c,i):(i=xs(i,l,r,null),i.flags|=2),i.return=t,a.return=t,a.sibling=i,t.child=a,a=i,i=t.child,l=e.child.memoizedState,l=l===null?Sd(r):{baseLanes:l.baseLanes|r,cachePool:null,transitions:l.transitions},i.memoizedState=l,i.childLanes=e.childLanes&~r,t.memoizedState=_d,a}return i=e.child,e=i.sibling,a=Ga(i,{mode:"visible",children:a.children}),!(t.mode&1)&&(a.lanes=r),a.return=t,a.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=a,t.memoizedState=null,a}function Pu(e,t){return t=Wo({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function pc(e,t,r,a){return a!==null&&vu(a),hi(t,e.child,null,r),e=Pu(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Ry(e,t,r,a,s,i,l){if(r)return t.flags&256?(t.flags&=-257,a=k0(Error(Ee(422))),pc(e,t,l,a)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=a.fallback,s=t.mode,a=Wo({mode:"visible",children:a.children},s,0,null),i=xs(i,s,l,null),i.flags|=2,a.return=t,i.return=t,a.sibling=i,t.child=a,t.mode&1&&hi(t,e.child,null,l),t.child.memoizedState=Sd(l),t.memoizedState=_d,i);if(!(t.mode&1))return pc(e,t,l,null);if(s.data==="$!"){if(a=s.nextSibling&&s.nextSibling.dataset,a)var c=a.dgst;return a=c,i=Error(Ee(419)),a=k0(i,a,void 0),pc(e,t,l,a)}if(c=(l&e.childLanes)!==0,Qr||c){if(a=pr,a!==null){switch(l&-l){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(a.suspendedLanes|l)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,ya(e,s),$n(a,e,s,-1))}return Lu(),a=k0(Error(Ee(421))),pc(e,t,l,a)}return s.data==="$?"?(t.flags|=128,t.child=e.child,t=Yy.bind(null,e),s._reactRetry=t,null):(e=i.treeContext,mn=Wa(s.nextSibling),hn=t,Ot=!0,Un=null,e!==null&&(Sn[Cn++]=da,Sn[Cn++]=ua,Sn[Cn++]=ys,da=e.id,ua=e.overflow,ys=t),t=Pu(t,a.children),t.flags|=4096,t)}function Dx(e,t,r){e.lanes|=t;var a=e.alternate;a!==null&&(a.lanes|=t),yd(e.return,t,r)}function _0(e,t,r,a,s){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:a,tail:r,tailMode:s}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=a,i.tail=r,i.tailMode=s)}function qp(e,t,r){var a=t.pendingProps,s=a.revealOrder,i=a.tail;if(zr(e,t,a.children,r),a=zt.current,a&2)a=a&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Dx(e,r,t);else if(e.tag===19)Dx(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}a&=1}if(Ct(zt,a),!(t.mode&1))t.memoizedState=null;else switch(s){case"forwards":for(r=t.child,s=null;r!==null;)e=r.alternate,e!==null&&co(e)===null&&(s=r),r=r.sibling;r=s,r===null?(s=t.child,t.child=null):(s=r.sibling,r.sibling=null),_0(t,!1,s,r,i);break;case"backwards":for(r=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&co(e)===null){t.child=s;break}e=s.sibling,s.sibling=r,r=s,s=e}_0(t,!0,r,null,i);break;case"together":_0(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Wc(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function ba(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),ws|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(Ee(153));if(t.child!==null){for(e=t.child,r=Ga(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=Ga(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function Oy(e,t,r){switch(t.tag){case 3:Kp(t),mi();break;case 5:Np(t);break;case 1:en(t.type)&&ro(t);break;case 4:ku(t,t.stateNode.containerInfo);break;case 10:var a=t.type._context,s=t.memoizedProps.value;Ct(so,a._currentValue),a._currentValue=s;break;case 13:if(a=t.memoizedState,a!==null)return a.dehydrated!==null?(Ct(zt,zt.current&1),t.flags|=128,null):r&t.child.childLanes?Yp(e,t,r):(Ct(zt,zt.current&1),e=ba(e,t,r),e!==null?e.sibling:null);Ct(zt,zt.current&1);break;case 19:if(a=(r&t.childLanes)!==0,e.flags&128){if(a)return qp(e,t,r);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Ct(zt,zt.current),a)break;return null;case 22:case 23:return t.lanes=0,Gp(e,t,r)}return ba(e,t,r)}var Jp,Cd,Qp,Zp;Jp=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Cd=function(){};Qp=function(e,t,r,a){var s=e.memoizedProps;if(s!==a){e=t.stateNode,ds(na.current);var i=null;switch(r){case"input":s=Y0(e,s),a=Y0(e,a),i=[];break;case"select":s=Vt({},s,{value:void 0}),a=Vt({},a,{value:void 0}),i=[];break;case"textarea":s=Q0(e,s),a=Q0(e,a),i=[];break;default:typeof s.onClick!="function"&&typeof a.onClick=="function"&&(e.onclick=eo)}ed(r,a);var l;r=null;for(u in s)if(!a.hasOwnProperty(u)&&s.hasOwnProperty(u)&&s[u]!=null)if(u==="style"){var c=s[u];for(l in c)c.hasOwnProperty(l)&&(r||(r={}),r[l]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(dl.hasOwnProperty(u)?i||(i=[]):(i=i||[]).push(u,null));for(u in a){var o=a[u];if(c=s!=null?s[u]:void 0,a.hasOwnProperty(u)&&o!==c&&(o!=null||c!=null))if(u==="style")if(c){for(l in c)!c.hasOwnProperty(l)||o&&o.hasOwnProperty(l)||(r||(r={}),r[l]="");for(l in o)o.hasOwnProperty(l)&&c[l]!==o[l]&&(r||(r={}),r[l]=o[l])}else r||(i||(i=[]),i.push(u,r)),r=o;else u==="dangerouslySetInnerHTML"?(o=o?o.__html:void 0,c=c?c.__html:void 0,o!=null&&c!==o&&(i=i||[]).push(u,o)):u==="children"?typeof o!="string"&&typeof o!="number"||(i=i||[]).push(u,""+o):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(dl.hasOwnProperty(u)?(o!=null&&u==="onScroll"&&Tt("scroll",e),i||c===o||(i=[])):(i=i||[]).push(u,o))}r&&(i=i||[]).push("style",r);var u=i;(t.updateQueue=u)&&(t.flags|=4)}};Zp=function(e,t,r,a){r!==a&&(t.flags|=4)};function Oi(e,t){if(!Ot)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var a=null;r!==null;)r.alternate!==null&&(a=r),r=r.sibling;a===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:a.sibling=null}}function Er(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,a=0;if(t)for(var s=e.child;s!==null;)r|=s.lanes|s.childLanes,a|=s.subtreeFlags&14680064,a|=s.flags&14680064,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)r|=s.lanes|s.childLanes,a|=s.subtreeFlags,a|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=a,e.childLanes=r,t}function Ly(e,t,r){var a=t.pendingProps;switch(gu(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Er(t),null;case 1:return en(t.type)&&to(),Er(t),null;case 3:return a=t.stateNode,pi(),At(Zr),At(Rr),Su(),a.pendingContext&&(a.context=a.pendingContext,a.pendingContext=null),(e===null||e.child===null)&&(mc(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Un!==null&&(Md(Un),Un=null))),Cd(e,t),Er(t),null;case 5:_u(t);var s=ds(Nl.current);if(r=t.type,e!==null&&t.stateNode!=null)Qp(e,t,r,a,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!a){if(t.stateNode===null)throw Error(Ee(166));return Er(t),null}if(e=ds(na.current),mc(t)){a=t.stateNode,r=t.type;var i=t.memoizedProps;switch(a[ea]=t,a[bl]=i,e=(t.mode&1)!==0,r){case"dialog":Tt("cancel",a),Tt("close",a);break;case"iframe":case"object":case"embed":Tt("load",a);break;case"video":case"audio":for(s=0;s<Hi.length;s++)Tt(Hi[s],a);break;case"source":Tt("error",a);break;case"img":case"image":case"link":Tt("error",a),Tt("load",a);break;case"details":Tt("toggle",a);break;case"input":Wf(a,i),Tt("invalid",a);break;case"select":a._wrapperState={wasMultiple:!!i.multiple},Tt("invalid",a);break;case"textarea":$f(a,i),Tt("invalid",a)}ed(r,i),s=null;for(var l in i)if(i.hasOwnProperty(l)){var c=i[l];l==="children"?typeof c=="string"?a.textContent!==c&&(i.suppressHydrationWarning!==!0&&xc(a.textContent,c,e),s=["children",c]):typeof c=="number"&&a.textContent!==""+c&&(i.suppressHydrationWarning!==!0&&xc(a.textContent,c,e),s=["children",""+c]):dl.hasOwnProperty(l)&&c!=null&&l==="onScroll"&&Tt("scroll",a)}switch(r){case"input":sc(a),Hf(a,i,!0);break;case"textarea":sc(a),Vf(a);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(a.onclick=eo)}a=s,t.updateQueue=a,a!==null&&(t.flags|=4)}else{l=s.nodeType===9?s:s.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Ch(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=l.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof a.is=="string"?e=l.createElement(r,{is:a.is}):(e=l.createElement(r),r==="select"&&(l=e,a.multiple?l.multiple=!0:a.size&&(l.size=a.size))):e=l.createElementNS(e,r),e[ea]=t,e[bl]=a,Jp(e,t,!1,!1),t.stateNode=e;e:{switch(l=td(r,a),r){case"dialog":Tt("cancel",e),Tt("close",e),s=a;break;case"iframe":case"object":case"embed":Tt("load",e),s=a;break;case"video":case"audio":for(s=0;s<Hi.length;s++)Tt(Hi[s],e);s=a;break;case"source":Tt("error",e),s=a;break;case"img":case"image":case"link":Tt("error",e),Tt("load",e),s=a;break;case"details":Tt("toggle",e),s=a;break;case"input":Wf(e,a),s=Y0(e,a),Tt("invalid",e);break;case"option":s=a;break;case"select":e._wrapperState={wasMultiple:!!a.multiple},s=Vt({},a,{value:void 0}),Tt("invalid",e);break;case"textarea":$f(e,a),s=Q0(e,a),Tt("invalid",e);break;default:s=a}ed(r,s),c=s;for(i in c)if(c.hasOwnProperty(i)){var o=c[i];i==="style"?Fh(e,o):i==="dangerouslySetInnerHTML"?(o=o?o.__html:void 0,o!=null&&Eh(e,o)):i==="children"?typeof o=="string"?(r!=="textarea"||o!=="")&&ul(e,o):typeof o=="number"&&ul(e,""+o):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(dl.hasOwnProperty(i)?o!=null&&i==="onScroll"&&Tt("scroll",e):o!=null&&ru(e,i,o,l))}switch(r){case"input":sc(e),Hf(e,a,!1);break;case"textarea":sc(e),Vf(e);break;case"option":a.value!=null&&e.setAttribute("value",""+Xa(a.value));break;case"select":e.multiple=!!a.multiple,i=a.value,i!=null?ri(e,!!a.multiple,i,!1):a.defaultValue!=null&&ri(e,!!a.multiple,a.defaultValue,!0);break;default:typeof s.onClick=="function"&&(e.onclick=eo)}switch(r){case"button":case"input":case"select":case"textarea":a=!!a.autoFocus;break e;case"img":a=!0;break e;default:a=!1}}a&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Er(t),null;case 6:if(e&&t.stateNode!=null)Zp(e,t,e.memoizedProps,a);else{if(typeof a!="string"&&t.stateNode===null)throw Error(Ee(166));if(r=ds(Nl.current),ds(na.current),mc(t)){if(a=t.stateNode,r=t.memoizedProps,a[ea]=t,(i=a.nodeValue!==r)&&(e=hn,e!==null))switch(e.tag){case 3:xc(a.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&xc(a.nodeValue,r,(e.mode&1)!==0)}i&&(t.flags|=4)}else a=(r.nodeType===9?r:r.ownerDocument).createTextNode(a),a[ea]=t,t.stateNode=a}return Er(t),null;case 13:if(At(zt),a=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Ot&&mn!==null&&t.mode&1&&!(t.flags&128))gp(),mi(),t.flags|=98560,i=!1;else if(i=mc(t),a!==null&&a.dehydrated!==null){if(e===null){if(!i)throw Error(Ee(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(Ee(317));i[ea]=t}else mi(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Er(t),i=!1}else Un!==null&&(Md(Un),Un=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(a=a!==null,a!==(e!==null&&e.memoizedState!==null)&&a&&(t.child.flags|=8192,t.mode&1&&(e===null||zt.current&1?or===0&&(or=3):Lu())),t.updateQueue!==null&&(t.flags|=4),Er(t),null);case 4:return pi(),Cd(e,t),e===null&&vl(t.stateNode.containerInfo),Er(t),null;case 10:return wu(t.type._context),Er(t),null;case 17:return en(t.type)&&to(),Er(t),null;case 19:if(At(zt),i=t.memoizedState,i===null)return Er(t),null;if(a=(t.flags&128)!==0,l=i.rendering,l===null)if(a)Oi(i,!1);else{if(or!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(l=co(e),l!==null){for(t.flags|=128,Oi(i,!1),a=l.updateQueue,a!==null&&(t.updateQueue=a,t.flags|=4),t.subtreeFlags=0,a=r,r=t.child;r!==null;)i=r,e=a,i.flags&=14680066,l=i.alternate,l===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=l.childLanes,i.lanes=l.lanes,i.child=l.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=l.memoizedProps,i.memoizedState=l.memoizedState,i.updateQueue=l.updateQueue,i.type=l.type,e=l.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return Ct(zt,zt.current&1|2),t.child}e=e.sibling}i.tail!==null&&Qt()>vi&&(t.flags|=128,a=!0,Oi(i,!1),t.lanes=4194304)}else{if(!a)if(e=co(l),e!==null){if(t.flags|=128,a=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Oi(i,!0),i.tail===null&&i.tailMode==="hidden"&&!l.alternate&&!Ot)return Er(t),null}else 2*Qt()-i.renderingStartTime>vi&&r!==1073741824&&(t.flags|=128,a=!0,Oi(i,!1),t.lanes=4194304);i.isBackwards?(l.sibling=t.child,t.child=l):(r=i.last,r!==null?r.sibling=l:t.child=l,i.last=l)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=Qt(),t.sibling=null,r=zt.current,Ct(zt,a?r&1|2:r&1),t):(Er(t),null);case 22:case 23:return Ou(),a=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==a&&(t.flags|=8192),a&&t.mode&1?on&1073741824&&(Er(t),t.subtreeFlags&6&&(t.flags|=8192)):Er(t),null;case 24:return null;case 25:return null}throw Error(Ee(156,t.tag))}function By(e,t){switch(gu(t),t.tag){case 1:return en(t.type)&&to(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return pi(),At(Zr),At(Rr),Su(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return _u(t),null;case 13:if(At(zt),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Ee(340));mi()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return At(zt),null;case 4:return pi(),null;case 10:return wu(t.type._context),null;case 22:case 23:return Ou(),null;case 24:return null;default:return null}}var gc=!1,Pr=!1,Uy=typeof WeakSet=="function"?WeakSet:Set,Ue=null;function Zs(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(a){Gt(e,t,a)}else r.current=null}function Ed(e,t,r){try{r()}catch(a){Gt(e,t,a)}}var Ix=!1;function zy(e,t){if(ud=Jc,e=ap(),hu(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var a=r.getSelection&&r.getSelection();if(a&&a.rangeCount!==0){r=a.anchorNode;var s=a.anchorOffset,i=a.focusNode;a=a.focusOffset;try{r.nodeType,i.nodeType}catch{r=null;break e}var l=0,c=-1,o=-1,u=0,d=0,f=e,x=null;t:for(;;){for(var h;f!==r||s!==0&&f.nodeType!==3||(c=l+s),f!==i||a!==0&&f.nodeType!==3||(o=l+a),f.nodeType===3&&(l+=f.nodeValue.length),(h=f.firstChild)!==null;)x=f,f=h;for(;;){if(f===e)break t;if(x===r&&++u===s&&(c=l),x===i&&++d===a&&(o=l),(h=f.nextSibling)!==null)break;f=x,x=f.parentNode}f=h}r=c===-1||o===-1?null:{start:c,end:o}}else r=null}r=r||{start:0,end:0}}else r=null;for(fd={focusedElem:e,selectionRange:r},Jc=!1,Ue=t;Ue!==null;)if(t=Ue,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Ue=e;else for(;Ue!==null;){t=Ue;try{var p=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var m=p.memoizedProps,w=p.memoizedState,v=t.stateNode,b=v.getSnapshotBeforeUpdate(t.elementType===t.type?m:Ln(t.type,m),w);v.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var y=t.stateNode.containerInfo;y.nodeType===1?y.textContent="":y.nodeType===9&&y.documentElement&&y.removeChild(y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Ee(163))}}catch(N){Gt(t,t.return,N)}if(e=t.sibling,e!==null){e.return=t.return,Ue=e;break}Ue=t.return}return p=Ix,Ix=!1,p}function Zi(e,t,r){var a=t.updateQueue;if(a=a!==null?a.lastEffect:null,a!==null){var s=a=a.next;do{if((s.tag&e)===e){var i=s.destroy;s.destroy=void 0,i!==void 0&&Ed(t,r,i)}s=s.next}while(s!==a)}}function Uo(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var a=r.create;r.destroy=a()}r=r.next}while(r!==t)}}function Td(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function e1(e){var t=e.alternate;t!==null&&(e.alternate=null,e1(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[ea],delete t[bl],delete t[hd],delete t[jy],delete t[ky])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function t1(e){return e.tag===5||e.tag===3||e.tag===4}function Mx(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||t1(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Fd(e,t,r){var a=e.tag;if(a===5||a===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=eo));else if(a!==4&&(e=e.child,e!==null))for(Fd(e,t,r),e=e.sibling;e!==null;)Fd(e,t,r),e=e.sibling}function Ad(e,t,r){var a=e.tag;if(a===5||a===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(a!==4&&(e=e.child,e!==null))for(Ad(e,t,r),e=e.sibling;e!==null;)Ad(e,t,r),e=e.sibling}var yr=null,Bn=!1;function Ea(e,t,r){for(r=r.child;r!==null;)r1(e,t,r),r=r.sibling}function r1(e,t,r){if(ra&&typeof ra.onCommitFiberUnmount=="function")try{ra.onCommitFiberUnmount(Po,r)}catch{}switch(r.tag){case 5:Pr||Zs(r,t);case 6:var a=yr,s=Bn;yr=null,Ea(e,t,r),yr=a,Bn=s,yr!==null&&(Bn?(e=yr,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):yr.removeChild(r.stateNode));break;case 18:yr!==null&&(Bn?(e=yr,r=r.stateNode,e.nodeType===8?v0(e.parentNode,r):e.nodeType===1&&v0(e,r),hl(e)):v0(yr,r.stateNode));break;case 4:a=yr,s=Bn,yr=r.stateNode.containerInfo,Bn=!0,Ea(e,t,r),yr=a,Bn=s;break;case 0:case 11:case 14:case 15:if(!Pr&&(a=r.updateQueue,a!==null&&(a=a.lastEffect,a!==null))){s=a=a.next;do{var i=s,l=i.destroy;i=i.tag,l!==void 0&&(i&2||i&4)&&Ed(r,t,l),s=s.next}while(s!==a)}Ea(e,t,r);break;case 1:if(!Pr&&(Zs(r,t),a=r.stateNode,typeof a.componentWillUnmount=="function"))try{a.props=r.memoizedProps,a.state=r.memoizedState,a.componentWillUnmount()}catch(c){Gt(r,t,c)}Ea(e,t,r);break;case 21:Ea(e,t,r);break;case 22:r.mode&1?(Pr=(a=Pr)||r.memoizedState!==null,Ea(e,t,r),Pr=a):Ea(e,t,r);break;default:Ea(e,t,r)}}function Rx(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new Uy),t.forEach(function(a){var s=qy.bind(null,e,a);r.has(a)||(r.add(a),a.then(s,s))})}}function Rn(e,t){var r=t.deletions;if(r!==null)for(var a=0;a<r.length;a++){var s=r[a];try{var i=e,l=t,c=l;e:for(;c!==null;){switch(c.tag){case 5:yr=c.stateNode,Bn=!1;break e;case 3:yr=c.stateNode.containerInfo,Bn=!0;break e;case 4:yr=c.stateNode.containerInfo,Bn=!0;break e}c=c.return}if(yr===null)throw Error(Ee(160));r1(i,l,s),yr=null,Bn=!1;var o=s.alternate;o!==null&&(o.return=null),s.return=null}catch(u){Gt(s,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)n1(t,e),t=t.sibling}function n1(e,t){var r=e.alternate,a=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Rn(t,e),Yn(e),a&4){try{Zi(3,e,e.return),Uo(3,e)}catch(m){Gt(e,e.return,m)}try{Zi(5,e,e.return)}catch(m){Gt(e,e.return,m)}}break;case 1:Rn(t,e),Yn(e),a&512&&r!==null&&Zs(r,r.return);break;case 5:if(Rn(t,e),Yn(e),a&512&&r!==null&&Zs(r,r.return),e.flags&32){var s=e.stateNode;try{ul(s,"")}catch(m){Gt(e,e.return,m)}}if(a&4&&(s=e.stateNode,s!=null)){var i=e.memoizedProps,l=r!==null?r.memoizedProps:i,c=e.type,o=e.updateQueue;if(e.updateQueue=null,o!==null)try{c==="input"&&i.type==="radio"&&i.name!=null&&_h(s,i),td(c,l);var u=td(c,i);for(l=0;l<o.length;l+=2){var d=o[l],f=o[l+1];d==="style"?Fh(s,f):d==="dangerouslySetInnerHTML"?Eh(s,f):d==="children"?ul(s,f):ru(s,d,f,u)}switch(c){case"input":q0(s,i);break;case"textarea":Sh(s,i);break;case"select":var x=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var h=i.value;h!=null?ri(s,!!i.multiple,h,!1):x!==!!i.multiple&&(i.defaultValue!=null?ri(s,!!i.multiple,i.defaultValue,!0):ri(s,!!i.multiple,i.multiple?[]:"",!1))}s[bl]=i}catch(m){Gt(e,e.return,m)}}break;case 6:if(Rn(t,e),Yn(e),a&4){if(e.stateNode===null)throw Error(Ee(162));s=e.stateNode,i=e.memoizedProps;try{s.nodeValue=i}catch(m){Gt(e,e.return,m)}}break;case 3:if(Rn(t,e),Yn(e),a&4&&r!==null&&r.memoizedState.isDehydrated)try{hl(t.containerInfo)}catch(m){Gt(e,e.return,m)}break;case 4:Rn(t,e),Yn(e);break;case 13:Rn(t,e),Yn(e),s=e.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(Mu=Qt())),a&4&&Rx(e);break;case 22:if(d=r!==null&&r.memoizedState!==null,e.mode&1?(Pr=(u=Pr)||d,Rn(t,e),Pr=u):Rn(t,e),Yn(e),a&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!d&&e.mode&1)for(Ue=e,d=e.child;d!==null;){for(f=Ue=d;Ue!==null;){switch(x=Ue,h=x.child,x.tag){case 0:case 11:case 14:case 15:Zi(4,x,x.return);break;case 1:Zs(x,x.return);var p=x.stateNode;if(typeof p.componentWillUnmount=="function"){a=x,r=x.return;try{t=a,p.props=t.memoizedProps,p.state=t.memoizedState,p.componentWillUnmount()}catch(m){Gt(a,r,m)}}break;case 5:Zs(x,x.return);break;case 22:if(x.memoizedState!==null){Lx(f);continue}}h!==null?(h.return=x,Ue=h):Lx(f)}d=d.sibling}e:for(d=null,f=e;;){if(f.tag===5){if(d===null){d=f;try{s=f.stateNode,u?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(c=f.stateNode,o=f.memoizedProps.style,l=o!=null&&o.hasOwnProperty("display")?o.display:null,c.style.display=Th("display",l))}catch(m){Gt(e,e.return,m)}}}else if(f.tag===6){if(d===null)try{f.stateNode.nodeValue=u?"":f.memoizedProps}catch(m){Gt(e,e.return,m)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===e)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;f.sibling===null;){if(f.return===null||f.return===e)break e;d===f&&(d=null),f=f.return}d===f&&(d=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:Rn(t,e),Yn(e),a&4&&Rx(e);break;case 21:break;default:Rn(t,e),Yn(e)}}function Yn(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(t1(r)){var a=r;break e}r=r.return}throw Error(Ee(160))}switch(a.tag){case 5:var s=a.stateNode;a.flags&32&&(ul(s,""),a.flags&=-33);var i=Mx(e);Ad(e,i,s);break;case 3:case 4:var l=a.stateNode.containerInfo,c=Mx(e);Fd(e,c,l);break;default:throw Error(Ee(161))}}catch(o){Gt(e,e.return,o)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Wy(e,t,r){Ue=e,a1(e)}function a1(e,t,r){for(var a=(e.mode&1)!==0;Ue!==null;){var s=Ue,i=s.child;if(s.tag===22&&a){var l=s.memoizedState!==null||gc;if(!l){var c=s.alternate,o=c!==null&&c.memoizedState!==null||Pr;c=gc;var u=Pr;if(gc=l,(Pr=o)&&!u)for(Ue=s;Ue!==null;)l=Ue,o=l.child,l.tag===22&&l.memoizedState!==null?Bx(s):o!==null?(o.return=l,Ue=o):Bx(s);for(;i!==null;)Ue=i,a1(i),i=i.sibling;Ue=s,gc=c,Pr=u}Ox(e)}else s.subtreeFlags&8772&&i!==null?(i.return=s,Ue=i):Ox(e)}}function Ox(e){for(;Ue!==null;){var t=Ue;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Pr||Uo(5,t);break;case 1:var a=t.stateNode;if(t.flags&4&&!Pr)if(r===null)a.componentDidMount();else{var s=t.elementType===t.type?r.memoizedProps:Ln(t.type,r.memoizedProps);a.componentDidUpdate(s,r.memoizedState,a.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&wx(t,i,a);break;case 3:var l=t.updateQueue;if(l!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}wx(t,l,r)}break;case 5:var c=t.stateNode;if(r===null&&t.flags&4){r=c;var o=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":o.autoFocus&&r.focus();break;case"img":o.src&&(r.src=o.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var f=d.dehydrated;f!==null&&hl(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Ee(163))}Pr||t.flags&512&&Td(t)}catch(x){Gt(t,t.return,x)}}if(t===e){Ue=null;break}if(r=t.sibling,r!==null){r.return=t.return,Ue=r;break}Ue=t.return}}function Lx(e){for(;Ue!==null;){var t=Ue;if(t===e){Ue=null;break}var r=t.sibling;if(r!==null){r.return=t.return,Ue=r;break}Ue=t.return}}function Bx(e){for(;Ue!==null;){var t=Ue;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{Uo(4,t)}catch(o){Gt(t,r,o)}break;case 1:var a=t.stateNode;if(typeof a.componentDidMount=="function"){var s=t.return;try{a.componentDidMount()}catch(o){Gt(t,s,o)}}var i=t.return;try{Td(t)}catch(o){Gt(t,i,o)}break;case 5:var l=t.return;try{Td(t)}catch(o){Gt(t,l,o)}}}catch(o){Gt(t,t.return,o)}if(t===e){Ue=null;break}var c=t.sibling;if(c!==null){c.return=t.return,Ue=c;break}Ue=t.return}}var Hy=Math.ceil,fo=Na.ReactCurrentDispatcher,Du=Na.ReactCurrentOwner,Tn=Na.ReactCurrentBatchConfig,ft=0,pr=null,sr=null,jr=0,on=0,ei=es(0),or=0,Sl=null,ws=0,zo=0,Iu=0,el=null,Jr=null,Mu=0,vi=1/0,ca=null,xo=!1,Pd=null,$a=null,vc=!1,Ra=null,mo=0,tl=0,Dd=null,Hc=-1,$c=0;function $r(){return ft&6?Qt():Hc!==-1?Hc:Hc=Qt()}function Va(e){return e.mode&1?ft&2&&jr!==0?jr&-jr:Sy.transition!==null?($c===0&&($c=Wh()),$c):(e=Nt,e!==0||(e=window.event,e=e===void 0?16:Yh(e.type)),e):1}function $n(e,t,r,a){if(50<tl)throw tl=0,Dd=null,Error(Ee(185));$l(e,r,a),(!(ft&2)||e!==pr)&&(e===pr&&(!(ft&2)&&(zo|=r),or===4&&Da(e,jr)),tn(e,a),r===1&&ft===0&&!(t.mode&1)&&(vi=Qt()+500,Oo&&ts()))}function tn(e,t){var r=e.callbackNode;S2(e,t);var a=qc(e,e===pr?jr:0);if(a===0)r!==null&&Kf(r),e.callbackNode=null,e.callbackPriority=0;else if(t=a&-a,e.callbackPriority!==t){if(r!=null&&Kf(r),t===1)e.tag===0?_y(Ux.bind(null,e)):mp(Ux.bind(null,e)),wy(function(){!(ft&6)&&ts()}),r=null;else{switch(Hh(a)){case 1:r=lu;break;case 4:r=Uh;break;case 16:r=Yc;break;case 536870912:r=zh;break;default:r=Yc}r=f1(r,s1.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function s1(e,t){if(Hc=-1,$c=0,ft&6)throw Error(Ee(327));var r=e.callbackNode;if(li()&&e.callbackNode!==r)return null;var a=qc(e,e===pr?jr:0);if(a===0)return null;if(a&30||a&e.expiredLanes||t)t=ho(e,a);else{t=a;var s=ft;ft|=2;var i=l1();(pr!==e||jr!==t)&&(ca=null,vi=Qt()+500,fs(e,t));do try{Gy();break}catch(c){i1(e,c)}while(!0);bu(),fo.current=i,ft=s,sr!==null?t=0:(pr=null,jr=0,t=or)}if(t!==0){if(t===2&&(s=id(e),s!==0&&(a=s,t=Id(e,s))),t===1)throw r=Sl,fs(e,0),Da(e,a),tn(e,Qt()),r;if(t===6)Da(e,a);else{if(s=e.current.alternate,!(a&30)&&!$y(s)&&(t=ho(e,a),t===2&&(i=id(e),i!==0&&(a=i,t=Id(e,i))),t===1))throw r=Sl,fs(e,0),Da(e,a),tn(e,Qt()),r;switch(e.finishedWork=s,e.finishedLanes=a,t){case 0:case 1:throw Error(Ee(345));case 2:is(e,Jr,ca);break;case 3:if(Da(e,a),(a&130023424)===a&&(t=Mu+500-Qt(),10<t)){if(qc(e,0)!==0)break;if(s=e.suspendedLanes,(s&a)!==a){$r(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=md(is.bind(null,e,Jr,ca),t);break}is(e,Jr,ca);break;case 4:if(Da(e,a),(a&4194240)===a)break;for(t=e.eventTimes,s=-1;0<a;){var l=31-Hn(a);i=1<<l,l=t[l],l>s&&(s=l),a&=~i}if(a=s,a=Qt()-a,a=(120>a?120:480>a?480:1080>a?1080:1920>a?1920:3e3>a?3e3:4320>a?4320:1960*Hy(a/1960))-a,10<a){e.timeoutHandle=md(is.bind(null,e,Jr,ca),a);break}is(e,Jr,ca);break;case 5:is(e,Jr,ca);break;default:throw Error(Ee(329))}}}return tn(e,Qt()),e.callbackNode===r?s1.bind(null,e):null}function Id(e,t){var r=el;return e.current.memoizedState.isDehydrated&&(fs(e,t).flags|=256),e=ho(e,t),e!==2&&(t=Jr,Jr=r,t!==null&&Md(t)),e}function Md(e){Jr===null?Jr=e:Jr.push.apply(Jr,e)}function $y(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var a=0;a<r.length;a++){var s=r[a],i=s.getSnapshot;s=s.value;try{if(!Xn(i(),s))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Da(e,t){for(t&=~Iu,t&=~zo,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Hn(t),a=1<<r;e[r]=-1,t&=~a}}function Ux(e){if(ft&6)throw Error(Ee(327));li();var t=qc(e,0);if(!(t&1))return tn(e,Qt()),null;var r=ho(e,t);if(e.tag!==0&&r===2){var a=id(e);a!==0&&(t=a,r=Id(e,a))}if(r===1)throw r=Sl,fs(e,0),Da(e,t),tn(e,Qt()),r;if(r===6)throw Error(Ee(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,is(e,Jr,ca),tn(e,Qt()),null}function Ru(e,t){var r=ft;ft|=1;try{return e(t)}finally{ft=r,ft===0&&(vi=Qt()+500,Oo&&ts())}}function Ns(e){Ra!==null&&Ra.tag===0&&!(ft&6)&&li();var t=ft;ft|=1;var r=Tn.transition,a=Nt;try{if(Tn.transition=null,Nt=1,e)return e()}finally{Nt=a,Tn.transition=r,ft=t,!(ft&6)&&ts()}}function Ou(){on=ei.current,At(ei)}function fs(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,by(r)),sr!==null)for(r=sr.return;r!==null;){var a=r;switch(gu(a),a.tag){case 1:a=a.type.childContextTypes,a!=null&&to();break;case 3:pi(),At(Zr),At(Rr),Su();break;case 5:_u(a);break;case 4:pi();break;case 13:At(zt);break;case 19:At(zt);break;case 10:wu(a.type._context);break;case 22:case 23:Ou()}r=r.return}if(pr=e,sr=e=Ga(e.current,null),jr=on=t,or=0,Sl=null,Iu=zo=ws=0,Jr=el=null,os!==null){for(t=0;t<os.length;t++)if(r=os[t],a=r.interleaved,a!==null){r.interleaved=null;var s=a.next,i=r.pending;if(i!==null){var l=i.next;i.next=s,a.next=l}r.pending=a}os=null}return e}function i1(e,t){do{var r=sr;try{if(bu(),Uc.current=uo,oo){for(var a=$t.memoizedState;a!==null;){var s=a.queue;s!==null&&(s.pending=null),a=a.next}oo=!1}if(bs=0,xr=lr=$t=null,Qi=!1,jl=0,Du.current=null,r===null||r.return===null){or=1,Sl=t,sr=null;break}e:{var i=e,l=r.return,c=r,o=t;if(t=jr,c.flags|=32768,o!==null&&typeof o=="object"&&typeof o.then=="function"){var u=o,d=c,f=d.tag;if(!(d.mode&1)&&(f===0||f===11||f===15)){var x=d.alternate;x?(d.updateQueue=x.updateQueue,d.memoizedState=x.memoizedState,d.lanes=x.lanes):(d.updateQueue=null,d.memoizedState=null)}var h=Cx(l);if(h!==null){h.flags&=-257,Ex(h,l,c,i,t),h.mode&1&&Sx(i,u,t),t=h,o=u;var p=t.updateQueue;if(p===null){var m=new Set;m.add(o),t.updateQueue=m}else p.add(o);break e}else{if(!(t&1)){Sx(i,u,t),Lu();break e}o=Error(Ee(426))}}else if(Ot&&c.mode&1){var w=Cx(l);if(w!==null){!(w.flags&65536)&&(w.flags|=256),Ex(w,l,c,i,t),vu(gi(o,c));break e}}i=o=gi(o,c),or!==4&&(or=2),el===null?el=[i]:el.push(i),i=l;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var v=Hp(i,o,t);bx(i,v);break e;case 1:c=o;var b=i.type,y=i.stateNode;if(!(i.flags&128)&&(typeof b.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&($a===null||!$a.has(y)))){i.flags|=65536,t&=-t,i.lanes|=t;var N=$p(i,c,t);bx(i,N);break e}}i=i.return}while(i!==null)}o1(r)}catch(A){t=A,sr===r&&r!==null&&(sr=r=r.return);continue}break}while(!0)}function l1(){var e=fo.current;return fo.current=uo,e===null?uo:e}function Lu(){(or===0||or===3||or===2)&&(or=4),pr===null||!(ws&268435455)&&!(zo&268435455)||Da(pr,jr)}function ho(e,t){var r=ft;ft|=2;var a=l1();(pr!==e||jr!==t)&&(ca=null,fs(e,t));do try{Vy();break}catch(s){i1(e,s)}while(!0);if(bu(),ft=r,fo.current=a,sr!==null)throw Error(Ee(261));return pr=null,jr=0,or}function Vy(){for(;sr!==null;)c1(sr)}function Gy(){for(;sr!==null&&!g2();)c1(sr)}function c1(e){var t=u1(e.alternate,e,on);e.memoizedProps=e.pendingProps,t===null?o1(e):sr=t,Du.current=null}function o1(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=By(r,t),r!==null){r.flags&=32767,sr=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{or=6,sr=null;return}}else if(r=Ly(r,t,on),r!==null){sr=r;return}if(t=t.sibling,t!==null){sr=t;return}sr=t=e}while(t!==null);or===0&&(or=5)}function is(e,t,r){var a=Nt,s=Tn.transition;try{Tn.transition=null,Nt=1,Xy(e,t,r,a)}finally{Tn.transition=s,Nt=a}return null}function Xy(e,t,r,a){do li();while(Ra!==null);if(ft&6)throw Error(Ee(327));r=e.finishedWork;var s=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(Ee(177));e.callbackNode=null,e.callbackPriority=0;var i=r.lanes|r.childLanes;if(C2(e,i),e===pr&&(sr=pr=null,jr=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||vc||(vc=!0,f1(Yc,function(){return li(),null})),i=(r.flags&15990)!==0,r.subtreeFlags&15990||i){i=Tn.transition,Tn.transition=null;var l=Nt;Nt=1;var c=ft;ft|=4,Du.current=null,zy(e,r),n1(r,e),xy(fd),Jc=!!ud,fd=ud=null,e.current=r,Wy(r),v2(),ft=c,Nt=l,Tn.transition=i}else e.current=r;if(vc&&(vc=!1,Ra=e,mo=s),i=e.pendingLanes,i===0&&($a=null),w2(r.stateNode),tn(e,Qt()),t!==null)for(a=e.onRecoverableError,r=0;r<t.length;r++)s=t[r],a(s.value,{componentStack:s.stack,digest:s.digest});if(xo)throw xo=!1,e=Pd,Pd=null,e;return mo&1&&e.tag!==0&&li(),i=e.pendingLanes,i&1?e===Dd?tl++:(tl=0,Dd=e):tl=0,ts(),null}function li(){if(Ra!==null){var e=Hh(mo),t=Tn.transition,r=Nt;try{if(Tn.transition=null,Nt=16>e?16:e,Ra===null)var a=!1;else{if(e=Ra,Ra=null,mo=0,ft&6)throw Error(Ee(331));var s=ft;for(ft|=4,Ue=e.current;Ue!==null;){var i=Ue,l=i.child;if(Ue.flags&16){var c=i.deletions;if(c!==null){for(var o=0;o<c.length;o++){var u=c[o];for(Ue=u;Ue!==null;){var d=Ue;switch(d.tag){case 0:case 11:case 15:Zi(8,d,i)}var f=d.child;if(f!==null)f.return=d,Ue=f;else for(;Ue!==null;){d=Ue;var x=d.sibling,h=d.return;if(e1(d),d===u){Ue=null;break}if(x!==null){x.return=h,Ue=x;break}Ue=h}}}var p=i.alternate;if(p!==null){var m=p.child;if(m!==null){p.child=null;do{var w=m.sibling;m.sibling=null,m=w}while(m!==null)}}Ue=i}}if(i.subtreeFlags&2064&&l!==null)l.return=i,Ue=l;else e:for(;Ue!==null;){if(i=Ue,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Zi(9,i,i.return)}var v=i.sibling;if(v!==null){v.return=i.return,Ue=v;break e}Ue=i.return}}var b=e.current;for(Ue=b;Ue!==null;){l=Ue;var y=l.child;if(l.subtreeFlags&2064&&y!==null)y.return=l,Ue=y;else e:for(l=b;Ue!==null;){if(c=Ue,c.flags&2048)try{switch(c.tag){case 0:case 11:case 15:Uo(9,c)}}catch(A){Gt(c,c.return,A)}if(c===l){Ue=null;break e}var N=c.sibling;if(N!==null){N.return=c.return,Ue=N;break e}Ue=c.return}}if(ft=s,ts(),ra&&typeof ra.onPostCommitFiberRoot=="function")try{ra.onPostCommitFiberRoot(Po,e)}catch{}a=!0}return a}finally{Nt=r,Tn.transition=t}}return!1}function zx(e,t,r){t=gi(r,t),t=Hp(e,t,1),e=Ha(e,t,1),t=$r(),e!==null&&($l(e,1,t),tn(e,t))}function Gt(e,t,r){if(e.tag===3)zx(e,e,r);else for(;t!==null;){if(t.tag===3){zx(t,e,r);break}else if(t.tag===1){var a=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof a.componentDidCatch=="function"&&($a===null||!$a.has(a))){e=gi(r,e),e=$p(t,e,1),t=Ha(t,e,1),e=$r(),t!==null&&($l(t,1,e),tn(t,e));break}}t=t.return}}function Ky(e,t,r){var a=e.pingCache;a!==null&&a.delete(t),t=$r(),e.pingedLanes|=e.suspendedLanes&r,pr===e&&(jr&r)===r&&(or===4||or===3&&(jr&130023424)===jr&&500>Qt()-Mu?fs(e,0):Iu|=r),tn(e,t)}function d1(e,t){t===0&&(e.mode&1?(t=cc,cc<<=1,!(cc&130023424)&&(cc=4194304)):t=1);var r=$r();e=ya(e,t),e!==null&&($l(e,t,r),tn(e,r))}function Yy(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),d1(e,r)}function qy(e,t){var r=0;switch(e.tag){case 13:var a=e.stateNode,s=e.memoizedState;s!==null&&(r=s.retryLane);break;case 19:a=e.stateNode;break;default:throw Error(Ee(314))}a!==null&&a.delete(t),d1(e,r)}var u1;u1=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||Zr.current)Qr=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return Qr=!1,Oy(e,t,r);Qr=!!(e.flags&131072)}else Qr=!1,Ot&&t.flags&1048576&&hp(t,ao,t.index);switch(t.lanes=0,t.tag){case 2:var a=t.type;Wc(e,t),e=t.pendingProps;var s=xi(t,Rr.current);ii(t,r),s=Eu(null,t,a,e,s,r);var i=Tu();return t.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,en(a)?(i=!0,ro(t)):i=!1,t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,ju(t),s.updater=Bo,t.stateNode=s,s._reactInternals=t,wd(t,a,e,r),t=kd(null,t,a,!0,i,r)):(t.tag=0,Ot&&i&&pu(t),zr(null,t,s,r),t=t.child),t;case 16:a=t.elementType;e:{switch(Wc(e,t),e=t.pendingProps,s=a._init,a=s(a._payload),t.type=a,s=t.tag=Qy(a),e=Ln(a,e),s){case 0:t=jd(null,t,a,e,r);break e;case 1:t=Ax(null,t,a,e,r);break e;case 11:t=Tx(null,t,a,e,r);break e;case 14:t=Fx(null,t,a,Ln(a.type,e),r);break e}throw Error(Ee(306,a,""))}return t;case 0:return a=t.type,s=t.pendingProps,s=t.elementType===a?s:Ln(a,s),jd(e,t,a,s,r);case 1:return a=t.type,s=t.pendingProps,s=t.elementType===a?s:Ln(a,s),Ax(e,t,a,s,r);case 3:e:{if(Kp(t),e===null)throw Error(Ee(387));a=t.pendingProps,i=t.memoizedState,s=i.element,wp(e,t),lo(t,a,null,r);var l=t.memoizedState;if(a=l.element,i.isDehydrated)if(i={element:a,isDehydrated:!1,cache:l.cache,pendingSuspenseBoundaries:l.pendingSuspenseBoundaries,transitions:l.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){s=gi(Error(Ee(423)),t),t=Px(e,t,a,r,s);break e}else if(a!==s){s=gi(Error(Ee(424)),t),t=Px(e,t,a,r,s);break e}else for(mn=Wa(t.stateNode.containerInfo.firstChild),hn=t,Ot=!0,Un=null,r=yp(t,null,a,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(mi(),a===s){t=ba(e,t,r);break e}zr(e,t,a,r)}t=t.child}return t;case 5:return Np(t),e===null&&vd(t),a=t.type,s=t.pendingProps,i=e!==null?e.memoizedProps:null,l=s.children,xd(a,s)?l=null:i!==null&&xd(a,i)&&(t.flags|=32),Xp(e,t),zr(e,t,l,r),t.child;case 6:return e===null&&vd(t),null;case 13:return Yp(e,t,r);case 4:return ku(t,t.stateNode.containerInfo),a=t.pendingProps,e===null?t.child=hi(t,null,a,r):zr(e,t,a,r),t.child;case 11:return a=t.type,s=t.pendingProps,s=t.elementType===a?s:Ln(a,s),Tx(e,t,a,s,r);case 7:return zr(e,t,t.pendingProps,r),t.child;case 8:return zr(e,t,t.pendingProps.children,r),t.child;case 12:return zr(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(a=t.type._context,s=t.pendingProps,i=t.memoizedProps,l=s.value,Ct(so,a._currentValue),a._currentValue=l,i!==null)if(Xn(i.value,l)){if(i.children===s.children&&!Zr.current){t=ba(e,t,r);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var c=i.dependencies;if(c!==null){l=i.child;for(var o=c.firstContext;o!==null;){if(o.context===a){if(i.tag===1){o=xa(-1,r&-r),o.tag=2;var u=i.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?o.next=o:(o.next=d.next,d.next=o),u.pending=o}}i.lanes|=r,o=i.alternate,o!==null&&(o.lanes|=r),yd(i.return,r,t),c.lanes|=r;break}o=o.next}}else if(i.tag===10)l=i.type===t.type?null:i.child;else if(i.tag===18){if(l=i.return,l===null)throw Error(Ee(341));l.lanes|=r,c=l.alternate,c!==null&&(c.lanes|=r),yd(l,r,t),l=i.sibling}else l=i.child;if(l!==null)l.return=i;else for(l=i;l!==null;){if(l===t){l=null;break}if(i=l.sibling,i!==null){i.return=l.return,l=i;break}l=l.return}i=l}zr(e,t,s.children,r),t=t.child}return t;case 9:return s=t.type,a=t.pendingProps.children,ii(t,r),s=An(s),a=a(s),t.flags|=1,zr(e,t,a,r),t.child;case 14:return a=t.type,s=Ln(a,t.pendingProps),s=Ln(a.type,s),Fx(e,t,a,s,r);case 15:return Vp(e,t,t.type,t.pendingProps,r);case 17:return a=t.type,s=t.pendingProps,s=t.elementType===a?s:Ln(a,s),Wc(e,t),t.tag=1,en(a)?(e=!0,ro(t)):e=!1,ii(t,r),Wp(t,a,s),wd(t,a,s,r),kd(null,t,a,!0,e,r);case 19:return qp(e,t,r);case 22:return Gp(e,t,r)}throw Error(Ee(156,t.tag))};function f1(e,t){return Bh(e,t)}function Jy(e,t,r,a){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=a,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function En(e,t,r,a){return new Jy(e,t,r,a)}function Bu(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Qy(e){if(typeof e=="function")return Bu(e)?1:0;if(e!=null){if(e=e.$$typeof,e===au)return 11;if(e===su)return 14}return 2}function Ga(e,t){var r=e.alternate;return r===null?(r=En(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Vc(e,t,r,a,s,i){var l=2;if(a=e,typeof e=="function")Bu(e)&&(l=1);else if(typeof e=="string")l=5;else e:switch(e){case $s:return xs(r.children,s,i,t);case nu:l=8,s|=8;break;case V0:return e=En(12,r,t,s|2),e.elementType=V0,e.lanes=i,e;case G0:return e=En(13,r,t,s),e.elementType=G0,e.lanes=i,e;case X0:return e=En(19,r,t,s),e.elementType=X0,e.lanes=i,e;case Nh:return Wo(r,s,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case bh:l=10;break e;case wh:l=9;break e;case au:l=11;break e;case su:l=14;break e;case Fa:l=16,a=null;break e}throw Error(Ee(130,e==null?e:typeof e,""))}return t=En(l,r,t,s),t.elementType=e,t.type=a,t.lanes=i,t}function xs(e,t,r,a){return e=En(7,e,a,t),e.lanes=r,e}function Wo(e,t,r,a){return e=En(22,e,a,t),e.elementType=Nh,e.lanes=r,e.stateNode={isHidden:!1},e}function S0(e,t,r){return e=En(6,e,null,t),e.lanes=r,e}function C0(e,t,r){return t=En(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Zy(e,t,r,a,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=l0(0),this.expirationTimes=l0(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=l0(0),this.identifierPrefix=a,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Uu(e,t,r,a,s,i,l,c,o){return e=new Zy(e,t,r,c,o),t===1?(t=1,i===!0&&(t|=8)):t=0,i=En(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:a,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},ju(i),e}function eb(e,t,r){var a=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Hs,key:a==null?null:""+a,children:e,containerInfo:t,implementation:r}}function x1(e){if(!e)return Ka;e=e._reactInternals;e:{if(As(e)!==e||e.tag!==1)throw Error(Ee(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(en(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Ee(171))}if(e.tag===1){var r=e.type;if(en(r))return xp(e,r,t)}return t}function m1(e,t,r,a,s,i,l,c,o){return e=Uu(r,a,!0,e,s,i,l,c,o),e.context=x1(null),r=e.current,a=$r(),s=Va(r),i=xa(a,s),i.callback=t??null,Ha(r,i,s),e.current.lanes=s,$l(e,s,a),tn(e,a),e}function Ho(e,t,r,a){var s=t.current,i=$r(),l=Va(s);return r=x1(r),t.context===null?t.context=r:t.pendingContext=r,t=xa(i,l),t.payload={element:e},a=a===void 0?null:a,a!==null&&(t.callback=a),e=Ha(s,t,l),e!==null&&($n(e,s,l,i),Bc(e,s,l)),l}function po(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Wx(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function zu(e,t){Wx(e,t),(e=e.alternate)&&Wx(e,t)}function tb(){return null}var h1=typeof reportError=="function"?reportError:function(e){console.error(e)};function Wu(e){this._internalRoot=e}$o.prototype.render=Wu.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Ee(409));Ho(e,t,null,null)};$o.prototype.unmount=Wu.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Ns(function(){Ho(null,e,null,null)}),t[va]=null}};function $o(e){this._internalRoot=e}$o.prototype.unstable_scheduleHydration=function(e){if(e){var t=Gh();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Pa.length&&t!==0&&t<Pa[r].priority;r++);Pa.splice(r,0,e),r===0&&Kh(e)}};function Hu(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Vo(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Hx(){}function rb(e,t,r,a,s){if(s){if(typeof a=="function"){var i=a;a=function(){var u=po(l);i.call(u)}}var l=m1(t,a,e,0,null,!1,!1,"",Hx);return e._reactRootContainer=l,e[va]=l.current,vl(e.nodeType===8?e.parentNode:e),Ns(),l}for(;s=e.lastChild;)e.removeChild(s);if(typeof a=="function"){var c=a;a=function(){var u=po(o);c.call(u)}}var o=Uu(e,0,!1,null,null,!1,!1,"",Hx);return e._reactRootContainer=o,e[va]=o.current,vl(e.nodeType===8?e.parentNode:e),Ns(function(){Ho(t,o,r,a)}),o}function Go(e,t,r,a,s){var i=r._reactRootContainer;if(i){var l=i;if(typeof s=="function"){var c=s;s=function(){var o=po(l);c.call(o)}}Ho(t,l,e,s)}else l=rb(r,t,e,s,a);return po(l)}$h=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=Wi(t.pendingLanes);r!==0&&(cu(t,r|1),tn(t,Qt()),!(ft&6)&&(vi=Qt()+500,ts()))}break;case 13:Ns(function(){var a=ya(e,1);if(a!==null){var s=$r();$n(a,e,1,s)}}),zu(e,1)}};ou=function(e){if(e.tag===13){var t=ya(e,134217728);if(t!==null){var r=$r();$n(t,e,134217728,r)}zu(e,134217728)}};Vh=function(e){if(e.tag===13){var t=Va(e),r=ya(e,t);if(r!==null){var a=$r();$n(r,e,t,a)}zu(e,t)}};Gh=function(){return Nt};Xh=function(e,t){var r=Nt;try{return Nt=e,t()}finally{Nt=r}};nd=function(e,t,r){switch(t){case"input":if(q0(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var a=r[t];if(a!==e&&a.form===e.form){var s=Ro(a);if(!s)throw Error(Ee(90));kh(a),q0(a,s)}}}break;case"textarea":Sh(e,r);break;case"select":t=r.value,t!=null&&ri(e,!!r.multiple,t,!1)}};Dh=Ru;Ih=Ns;var nb={usingClientEntryPoint:!1,Events:[Gl,Ks,Ro,Ah,Ph,Ru]},Li={findFiberByHostInstance:cs,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},ab={bundleType:Li.bundleType,version:Li.version,rendererPackageName:Li.rendererPackageName,rendererConfig:Li.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Na.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Oh(e),e===null?null:e.stateNode},findFiberByHostInstance:Li.findFiberByHostInstance||tb,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var yc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!yc.isDisabled&&yc.supportsFiber)try{Po=yc.inject(ab),ra=yc}catch{}}vn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=nb;vn.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Hu(t))throw Error(Ee(200));return eb(e,t,null,r)};vn.createRoot=function(e,t){if(!Hu(e))throw Error(Ee(299));var r=!1,a="",s=h1;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(a=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),t=Uu(e,1,!1,null,null,r,!1,a,s),e[va]=t.current,vl(e.nodeType===8?e.parentNode:e),new Wu(t)};vn.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Ee(188)):(e=Object.keys(e).join(","),Error(Ee(268,e)));return e=Oh(t),e=e===null?null:e.stateNode,e};vn.flushSync=function(e){return Ns(e)};vn.hydrate=function(e,t,r){if(!Vo(t))throw Error(Ee(200));return Go(null,e,t,!0,r)};vn.hydrateRoot=function(e,t,r){if(!Hu(e))throw Error(Ee(405));var a=r!=null&&r.hydratedSources||null,s=!1,i="",l=h1;if(r!=null&&(r.unstable_strictMode===!0&&(s=!0),r.identifierPrefix!==void 0&&(i=r.identifierPrefix),r.onRecoverableError!==void 0&&(l=r.onRecoverableError)),t=m1(t,null,e,1,r??null,s,!1,i,l),e[va]=t.current,vl(e),a)for(e=0;e<a.length;e++)r=a[e],s=r._getVersion,s=s(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,s]:t.mutableSourceEagerHydrationData.push(r,s);return new $o(t)};vn.render=function(e,t,r){if(!Vo(t))throw Error(Ee(200));return Go(null,e,t,!1,r)};vn.unmountComponentAtNode=function(e){if(!Vo(e))throw Error(Ee(40));return e._reactRootContainer?(Ns(function(){Go(null,null,e,!1,function(){e._reactRootContainer=null,e[va]=null})}),!0):!1};vn.unstable_batchedUpdates=Ru;vn.unstable_renderSubtreeIntoContainer=function(e,t,r,a){if(!Vo(r))throw Error(Ee(200));if(e==null||e._reactInternals===void 0)throw Error(Ee(38));return Go(e,t,r,!1,a)};vn.version="18.3.1-next-f1338f8080-20240426";function p1(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(p1)}catch(e){console.error(e)}}p1(),ph.exports=vn;var sb=ph.exports,g1,$x=sb;g1=$x.createRoot,$x.hydrateRoot;/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var ib={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lb=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),Ve=(e,t)=>{const r=M.forwardRef(({color:a="currentColor",size:s=24,strokeWidth:i=2,absoluteStrokeWidth:l,className:c="",children:o,...u},d)=>M.createElement("svg",{ref:d,...ib,width:s,height:s,stroke:a,strokeWidth:l?Number(i)*24/Number(s):i,className:["lucide",`lucide-${lb(e)}`,c].join(" "),...u},[...t.map(([f,x])=>M.createElement(f,x)),...Array.isArray(o)?o:[o]]));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cl=Ve("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kn=Ve("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cb=Ve("AlignCenter",[["line",{x1:"21",x2:"3",y1:"6",y2:"6",key:"1fp77t"}],["line",{x1:"17",x2:"7",y1:"12",y2:"12",key:"rsh8ii"}],["line",{x1:"19",x2:"5",y1:"18",y2:"18",key:"1t0tuv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ob=Ve("AlignLeft",[["line",{x1:"21",x2:"3",y1:"6",y2:"6",key:"1fp77t"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}],["line",{x1:"17",x2:"3",y1:"18",y2:"18",key:"1awlsn"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const db=Ve("AlignRight",[["line",{x1:"21",x2:"3",y1:"6",y2:"6",key:"1fp77t"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}],["line",{x1:"21",x2:"7",y1:"18",y2:"18",key:"1g9eri"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yi=Ve("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ub=Ve("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v1=Ve("Award",[["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}],["path",{d:"M15.477 12.89 17 22l-5-3-5 3 1.523-9.11",key:"em7aur"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E0=Ve("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fb=Ve("Bold",[["path",{d:"M14 12a4 4 0 0 0 0-8H6v8",key:"v2sylx"}],["path",{d:"M15 20a4 4 0 0 0 0-8H6v8Z",key:"1ef5ya"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xb=Ve("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mb=Ve("Brain",[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z",key:"ep3f8r"}],["path",{d:"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4",key:"1p4c4q"}],["path",{d:"M17.599 6.5a3 3 0 0 0 .399-1.375",key:"tmeiqw"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M19.938 10.5a4 4 0 0 1 .585.396",key:"1qfode"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M19.967 17.484A4 4 0 0 1 18 18",key:"159ez6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const El=Ve("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aa=Ve("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vx=Ve("CheckSquare",[["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}],["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11",key:"1jnkn4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $u=Ve("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hb=Ve("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pb=Ve("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kl=Ve("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rd=Ve("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gb=Ve("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vb=Ve("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const js=Ve("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y1=Ve("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yb=Ve("FileCheck",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gx=Ve("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lt=Ve("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const go=Ve("FolderOpen",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Od=Ve("FolderTree",[["path",{d:"M20 10a1 1 0 0 0 1-1V6a1 1 0 0 0-1-1h-2.5a1 1 0 0 1-.8-.4l-.9-1.2A1 1 0 0 0 15 3h-2a1 1 0 0 0-1 1v5a1 1 0 0 0 1 1Z",key:"hod4my"}],["path",{d:"M20 21a1 1 0 0 0 1-1v-3a1 1 0 0 0-1-1h-2.9a1 1 0 0 1-.88-.55l-.42-.85a1 1 0 0 0-.92-.6H13a1 1 0 0 0-1 1v5a1 1 0 0 0 1 1Z",key:"w4yl2u"}],["path",{d:"M3 5a2 2 0 0 0 2 2h3",key:"f2jnh7"}],["path",{d:"M3 3v13a2 2 0 0 0 2 2h3",key:"k8epm1"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bb=Ve("Italic",[["line",{x1:"19",x2:"10",y1:"4",y2:"4",key:"15jd3p"}],["line",{x1:"14",x2:"5",y1:"20",y2:"20",key:"bu0au3"}],["line",{x1:"15",x2:"9",y1:"4",y2:"20",key:"uljnxc"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wb=Ve("Key",[["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["path",{d:"m15.5 7.5 3 3L22 7l-3-3",key:"1rn1fs"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nb=Ve("ListOrdered",[["line",{x1:"10",x2:"21",y1:"6",y2:"6",key:"76qw6h"}],["line",{x1:"10",x2:"21",y1:"12",y2:"12",key:"16nom4"}],["line",{x1:"10",x2:"21",y1:"18",y2:"18",key:"u3jurt"}],["path",{d:"M4 6h1v4",key:"cnovpq"}],["path",{d:"M4 10h2",key:"16xx2s"}],["path",{d:"M6 18H4c0-1 2-2 2-3s-1-1.5-2-1",key:"m9a95d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jb=Ve("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vu=Ve("Loader",[["line",{x1:"12",x2:"12",y1:"2",y2:"6",key:"gza1u7"}],["line",{x1:"12",x2:"12",y1:"18",y2:"22",key:"1qhbu9"}],["line",{x1:"4.93",x2:"7.76",y1:"4.93",y2:"7.76",key:"xae44r"}],["line",{x1:"16.24",x2:"19.07",y1:"16.24",y2:"19.07",key:"bxnmvf"}],["line",{x1:"2",x2:"6",y1:"12",y2:"12",key:"89khin"}],["line",{x1:"18",x2:"22",y1:"12",y2:"12",key:"pb8tfm"}],["line",{x1:"4.93",x2:"7.76",y1:"19.07",y2:"16.24",key:"1uxjnu"}],["line",{x1:"16.24",x2:"19.07",y1:"7.76",y2:"4.93",key:"6duxfx"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kb=Ve("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _b=Ve("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sb=Ve("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pt=Ve("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tl=Ve("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cb=Ve("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Eb=Ve("Ruler",[["path",{d:"M21.3 15.3a2.4 2.4 0 0 1 0 3.4l-2.6 2.6a2.4 2.4 0 0 1-3.4 0L2.7 8.7a2.41 2.41 0 0 1 0-3.4l2.6-2.6a2.41 2.41 0 0 1 3.4 0Z",key:"icamh8"}],["path",{d:"m14.5 12.5 2-2",key:"inckbg"}],["path",{d:"m11.5 9.5 2-2",key:"fmmyf7"}],["path",{d:"m8.5 6.5 2-2",key:"vc6u1g"}],["path",{d:"m17.5 15.5 2-2",key:"wo5hmg"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xx=Ve("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tb=Ve("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gu=Ve("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dt=Ve("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a2.121 2.121 0 1 1 3 3L12 15l-4 1 1-4Z",key:"1lpok0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qe=Ve("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fb=Ve("Type",[["polyline",{points:"4 7 4 4 20 4 20 7",key:"1nosan"}],["line",{x1:"9",x2:"15",y1:"20",y2:"20",key:"swin9y"}],["line",{x1:"12",x2:"12",y1:"4",y2:"20",key:"1tx1rr"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ab=Ve("Underline",[["path",{d:"M6 4v6a6 6 0 0 0 12 0V4",key:"9kb039"}],["line",{x1:"4",x2:"20",y1:"20",y2:"20",key:"nun2al"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const St=Ve("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pb=Ve("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b1=Ve("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w1=Ve("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qe=Ve("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),Db=({onLogin:e})=>{const[t,r]=M.useState(""),[a,s]=M.useState(""),[i,l]=M.useState(""),[c,o]=M.useState(!1),u=[{username:"admin",password:"admin123",role:"",displayName:""},{username:"project_admin",password:"project123",role:"",displayName:""},{username:"user",password:"user123",role:"",displayName:""}],d=x=>{x.preventDefault(),l(""),o(!0),setTimeout(()=>{const h=u.find(p=>p.username===t&&p.password===a);h?e(h.username,h.role):l(""),o(!1)},500)},f=x=>{r(x.username),s(x.password),l("")};return n.jsx("div",{className:"min-h-screen bg-gradient-to-br from-primary-50 via-blue-50 to-neutral-50 flex items-center justify-center p-4",children:n.jsxs("div",{className:"w-full max-w-6xl grid grid-cols-1 lg:grid-cols-2 gap-8",children:[n.jsxs("div",{className:"hidden lg:flex flex-col justify-center space-y-6 text-white",children:[n.jsxs("div",{className:"space-y-4",children:[n.jsx("h1",{className:"text-4xl font-bold text-neutral-800",children:"AIV1.0"}),n.jsx("p",{className:"text-lg text-neutral-600 leading-relaxed",children:" "})]}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsx("div",{className:"w-10 h-10 bg-primary-600 rounded-lg flex items-center justify-center flex-shrink-0",children:n.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-semibold text-neutral-800",children:""}),n.jsx("p",{className:"text-sm text-neutral-600",children:""})]})]}),n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsx("div",{className:"w-10 h-10 bg-primary-600 rounded-lg flex items-center justify-center flex-shrink-0",children:n.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-semibold text-neutral-800",children:""}),n.jsx("p",{className:"text-sm text-neutral-600",children:""})]})]}),n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsx("div",{className:"w-10 h-10 bg-primary-600 rounded-lg flex items-center justify-center flex-shrink-0",children:n.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-semibold text-neutral-800",children:""}),n.jsx("p",{className:"text-sm text-neutral-600",children:""})]})]})]})]}),n.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8 space-y-6",children:[n.jsxs("div",{className:"text-center",children:[n.jsx("h2",{className:"text-2xl font-bold text-neutral-900",children:""}),n.jsx("p",{className:"text-sm text-neutral-600 mt-1",children:""})]}),n.jsxs("form",{onSubmit:d,className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:""}),n.jsxs("div",{className:"relative",children:[n.jsx(b1,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-neutral-400"}),n.jsx("input",{type:"text",value:t,onChange:x=>r(x.target.value),placeholder:"",className:"w-full pl-10 pr-4 py-2.5 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-colors",required:!0})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:""}),n.jsxs("div",{className:"relative",children:[n.jsx(kb,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-neutral-400"}),n.jsx("input",{type:"password",value:a,onChange:x=>s(x.target.value),placeholder:"",className:"w-full pl-10 pr-4 py-2.5 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-colors",required:!0})]})]}),i&&n.jsxs("div",{className:"flex items-center space-x-2 text-red-600 bg-red-50 px-3 py-2 rounded-lg",children:[n.jsx(Cl,{className:"w-4 h-4 flex-shrink-0"}),n.jsx("span",{className:"text-sm",children:i})]}),n.jsx("button",{type:"submit",disabled:c,className:"w-full bg-primary-600 text-white py-2.5 rounded-lg font-medium hover:bg-primary-700 focus:ring-4 focus:ring-primary-200 transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:c?"...":""})]}),n.jsxs("div",{className:"relative",children:[n.jsx("div",{className:"absolute inset-0 flex items-center",children:n.jsx("div",{className:"w-full border-t border-neutral-200"})}),n.jsx("div",{className:"relative flex justify-center text-sm",children:n.jsx("span",{className:"px-2 bg-white text-neutral-500",children:""})})]}),n.jsx("div",{className:"space-y-2",children:u.map((x,h)=>n.jsxs("button",{type:"button",onClick:()=>f(x),className:"w-full flex items-center justify-between px-4 py-3 border border-neutral-200 rounded-lg hover:border-primary-300 hover:bg-primary-50 transition-colors group",children:[n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsx("div",{className:`w-2 h-2 rounded-full ${h===0?"bg-red-500":h===1?"bg-blue-500":"bg-green-500"}`}),n.jsxs("div",{className:"text-left",children:[n.jsx("div",{className:"font-medium text-neutral-900 text-sm",children:x.displayName}),n.jsxs("div",{className:"text-xs text-neutral-500",children:[x.username," / ",x.password]})]})]}),n.jsx("div",{className:"text-xs text-neutral-400 group-hover:text-primary-600 transition-colors",children:""})]},h))}),n.jsx("div",{className:"pt-4 border-t border-neutral-200",children:n.jsx("p",{className:"text-xs text-neutral-500 text-center",children:""})})]})]})})},Ib=({username:e="",role:t="",onLogout:r})=>{const[a,s]=M.useState(!1),[i,l]=M.useState(!1),[c,o]=M.useState(!1),[u,d]=M.useState(!1),[f,x]=M.useState(!1),[h,p]=M.useState(null),[m,w]=M.useState(1),[v,b]=M.useState(10),[y,N]=M.useState(""),[A,k]=M.useState(""),[_,j]=M.useState(""),[P,D]=M.useState(""),K=[{id:1,type:"warning",title:"",message:"7",time:"2",detail:"ZZ20230100120241031"},{id:2,type:"warning",title:"",message:"3",time:"5",detail:`
BID2024001
50,000
20241027

`}],E=()=>{confirm("")?(s(!1),r&&r()):s(!1)},Y=()=>{if(!A||!_||!P){alert("");return}if(_!==P){alert("");return}if(_.length<6){alert("6");return}alert(""),o(!1),k(""),j(""),D("")},B=()=>{l(!1),x(!0)},te=R=>{p(R),l(!1),d(!0)},re=Math.ceil(K.length/v),Q=(m-1)*v,Z=Q+v,z=K.slice(Q,Z),ne=R=>{b(R),w(1)},xe=()=>{const R=parseInt(y);R>=1&&R<=re&&(w(R),N(""))},O=R=>{switch(R){case"warning":return"bg-orange-500";case"success":return"bg-green-500";case"info":return"bg-blue-500";default:return"bg-neutral-500"}};return n.jsxs("nav",{className:"h-16 flex-shrink-0 bg-white border-b border-neutral-200 z-50",children:[n.jsx("div",{className:"h-full px-6 flex items-center",children:n.jsxs("div",{className:"flex items-center justify-between w-full",children:[n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsx("div",{className:"bg-primary-600 p-1.5 rounded-lg",children:n.jsx(Lt,{className:"w-5 h-5 text-white"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-lg font-semibold text-neutral-900",children:"AI v1.0"}),n.jsx("p",{className:"text-xs text-neutral-500",children:""})]})]}),n.jsxs("div",{className:"flex items-center space-x-4",children:[n.jsxs("div",{className:"relative",children:[n.jsxs("button",{onClick:()=>{l(!i),s(!1)},className:"relative p-2 rounded-lg hover:bg-neutral-100 transition-colors",children:[n.jsx(E0,{className:"w-5 h-5 text-neutral-600"}),K.length>0&&n.jsx("span",{className:"absolute top-1 right-1 w-2 h-2 bg-red-500 rounded-full"})]}),i&&n.jsxs("div",{className:"absolute right-0 mt-2 w-80 bg-white rounded-xl shadow-xl border border-neutral-200 z-50",children:[n.jsx("div",{className:"px-4 py-3 border-b border-neutral-200",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("h3",{className:"text-sm font-semibold text-neutral-900",children:""}),n.jsx("span",{className:"text-xs px-2 py-0.5 bg-red-100 text-red-600 rounded-full font-medium",children:K.length})]})}),n.jsx("div",{className:"max-h-80 overflow-y-auto",children:K.length===0?n.jsxs("div",{className:"py-12 px-4 text-center",children:[n.jsx(E0,{className:"w-10 h-10 mx-auto mb-2 text-neutral-300"}),n.jsx("p",{className:"text-sm text-neutral-500",children:""})]}):K.map(R=>n.jsx("div",{onClick:()=>te(R),className:"px-4 py-3 border-b border-neutral-100 hover:bg-neutral-50 transition-all duration-150 last:border-b-0 cursor-pointer",children:n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx("div",{className:`flex-shrink-0 w-2 h-2 rounded-full mt-1.5 ${O(R.type)}`}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("p",{className:"font-medium text-neutral-900 text-sm leading-snug",children:R.title}),n.jsx("p",{className:"text-xs text-neutral-600 mt-1 leading-relaxed",children:R.message}),n.jsx("p",{className:"text-xs text-neutral-400 mt-1.5",children:R.time})]})]})},R.id))}),n.jsx("div",{className:"px-4 py-2.5 border-t border-neutral-200 bg-neutral-50 rounded-b-xl",children:n.jsx("button",{onClick:B,className:"w-full text-xs text-primary-600 hover:text-primary-700 font-medium transition-colors",children:""})})]})]}),n.jsxs("div",{className:"relative",children:[n.jsxs("button",{onClick:()=>{s(!a),l(!1)},className:"flex items-center space-x-3 hover:bg-neutral-50 rounded-lg p-2 transition-colors",children:[n.jsxs("div",{className:"text-right",children:[n.jsx("p",{className:"text-sm font-medium text-neutral-700",children:e}),n.jsx("p",{className:"text-xs text-neutral-500",children:t})]}),n.jsx("div",{className:"bg-neutral-100 p-2 rounded-full",children:n.jsx(b1,{className:"w-4.5 h-4.5 text-neutral-600"})})]}),a&&n.jsxs("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border border-neutral-200 z-50",children:[n.jsxs("button",{onClick:()=>{o(!0),s(!1)},className:"w-full flex items-center px-4 py-3 text-sm text-neutral-700 hover:bg-neutral-50 transition-colors",children:[n.jsx(wb,{className:"w-4 h-4 mr-3 text-neutral-600"}),""]}),n.jsxs("button",{onClick:E,className:"w-full flex items-center px-4 py-3 text-sm text-red-600 hover:bg-red-50 transition-colors border-t border-neutral-100",children:[n.jsx(_b,{className:"w-4 h-4 mr-3"}),""]})]})]})]})]})}),u&&h&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-lg mx-4",children:[n.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-neutral-200",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:`w-3 h-3 rounded-full ${O(h.type)}`}),n.jsx("h3",{className:"text-lg font-semibold text-neutral-900",children:h.title})]}),n.jsx("button",{onClick:()=>{d(!1),p(null)},className:"text-neutral-400 hover:text-neutral-600 transition-colors",children:n.jsx(Qe,{className:"w-5 h-5"})})]}),n.jsxs("div",{className:"px-6 py-5",children:[n.jsx("p",{className:"text-sm text-neutral-600 leading-relaxed whitespace-pre-line",children:h.detail}),n.jsx("div",{className:"mt-4 pt-4 border-t border-neutral-200",children:n.jsx("p",{className:"text-xs text-neutral-400",children:h.time})})]}),n.jsx("div",{className:"flex justify-end gap-3 px-6 py-4 border-t border-neutral-200 bg-neutral-50 rounded-b-xl",children:n.jsx("button",{onClick:()=>{d(!1),p(null)},className:"px-4 py-2 text-sm bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors",children:""})})]})}),f&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-4xl mx-4 max-h-[90vh] flex flex-col",children:[n.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-neutral-200",children:[n.jsx("h3",{className:"text-lg font-semibold text-neutral-900",children:""}),n.jsx("button",{onClick:()=>{x(!1),w(1)},className:"text-neutral-400 hover:text-neutral-600 transition-colors",children:n.jsx(Qe,{className:"w-5 h-5"})})]}),n.jsx("div",{className:"px-6 py-3 border-b border-neutral-200 bg-neutral-50",children:n.jsxs("div",{className:"grid grid-cols-12 gap-4 text-sm font-medium text-neutral-600",children:[n.jsx("div",{className:"col-span-1 text-center",children:""}),n.jsx("div",{className:"col-span-4",children:""}),n.jsx("div",{className:"col-span-5",children:""}),n.jsx("div",{className:"col-span-2 text-center",children:""})]})}),n.jsx("div",{className:"flex-1 overflow-y-auto",children:z.length===0?n.jsxs("div",{className:"py-12 text-center text-neutral-500",children:[n.jsx(E0,{className:"w-10 h-10 mx-auto mb-2 text-neutral-300"}),n.jsx("p",{className:"text-sm",children:""})]}):n.jsx("div",{children:z.map((R,g)=>n.jsx("div",{onClick:()=>{x(!1),te(R)},className:`px-6 py-4 hover:bg-primary-50 transition-all duration-150 cursor-pointer ${g!==z.length-1?"border-b border-neutral-100":""}`,children:n.jsxs("div",{className:"grid grid-cols-12 gap-4 text-sm items-center",children:[n.jsx("div",{className:"col-span-1 flex justify-center",children:n.jsx("span",{className:"text-neutral-900",children:Q+g+1})}),n.jsx("div",{className:"col-span-4",children:n.jsx("p",{className:"font-medium text-neutral-900 truncate",children:R.title})}),n.jsx("div",{className:"col-span-5",children:n.jsx("p",{className:"text-neutral-600 truncate",children:R.message})}),n.jsx("div",{className:"col-span-2 text-center",children:n.jsx("span",{className:"text-xs text-neutral-400",children:R.time})})]})},R.id))})}),n.jsxs("div",{className:"bg-white border-t border-neutral-200 px-6 py-3 flex items-center justify-center gap-6 rounded-b-xl",children:[n.jsxs("div",{className:"text-sm text-neutral-700",children:[" ",K.length," "]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("button",{onClick:()=>w(Math.max(1,m-1)),disabled:m===1,className:`px-2 py-1 text-sm rounded transition-colors ${m===1?"bg-neutral-100 text-neutral-400 cursor-not-allowed":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:"<"}),n.jsx("div",{className:"flex items-center space-x-1",children:Array.from({length:Math.min(10,re)},(R,g)=>{let S;return re<=10||m<=5?S=g+1:m>=re-4?S=re-9+g:S=m-4+g,n.jsx("button",{onClick:()=>w(S),className:`px-2.5 py-1 text-sm rounded transition-colors ${m===S?"bg-primary-600 text-white":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:S},S)})}),re>10&&n.jsxs(n.Fragment,{children:[n.jsx("span",{className:"text-neutral-500",children:"..."}),n.jsx("button",{onClick:()=>w(re),className:`px-2.5 py-1 text-sm rounded transition-colors ${m===re?"bg-primary-600 text-white":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:re})]}),n.jsx("button",{onClick:()=>w(Math.min(re,m+1)),disabled:m===re,className:`px-2 py-1 text-sm rounded transition-colors ${m===re?"bg-neutral-100 text-neutral-400 cursor-not-allowed":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:">"})]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsxs("select",{value:v,onChange:R=>ne(Number(R.target.value)),className:"px-2 py-1 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500",children:[n.jsx("option",{value:10,children:"10/"}),n.jsx("option",{value:20,children:"20/"}),n.jsx("option",{value:50,children:"50/"})]}),n.jsx("span",{className:"text-sm text-neutral-700",children:""}),n.jsx("input",{type:"number",value:y,onChange:R=>N(R.target.value),placeholder:"",className:"w-12 px-2 py-1 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500",min:1,max:re}),n.jsx("button",{onClick:xe,className:"px-3 py-1 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-50 transition-colors",children:""})]})]})]})}),c&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md",children:[n.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-neutral-200",children:[n.jsx("h3",{className:"text-lg font-semibold text-neutral-900",children:""}),n.jsx("button",{onClick:()=>{o(!1),k(""),j(""),D("")},className:"text-neutral-400 hover:text-neutral-600 transition-colors",children:n.jsx(Qe,{className:"w-5 h-5"})})]}),n.jsxs("div",{className:"p-6 space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:""}),n.jsx("input",{type:"password",value:A,onChange:R=>k(R.target.value),placeholder:"",className:"w-full px-4 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:""}),n.jsx("input",{type:"password",value:_,onChange:R=>j(R.target.value),placeholder:"6",className:"w-full px-4 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:""}),n.jsx("input",{type:"password",value:P,onChange:R=>D(R.target.value),placeholder:"",className:"w-full px-4 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]})]}),n.jsxs("div",{className:"flex justify-end space-x-3 p-6 border-t border-neutral-200",children:[n.jsx("button",{onClick:()=>{o(!1),k(""),j(""),D("")},className:"px-4 py-2 text-sm text-neutral-700 hover:bg-neutral-100 rounded-lg transition-colors",children:""}),n.jsx("button",{onClick:Y,className:"px-4 py-2 text-sm bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors",children:""})]})]})})]})},Kx=({companyId:e,readOnly:t=!1})=>{const[r,a]=M.useState(()=>{const E=localStorage.getItem(`company_license_${e}`);return E?JSON.parse(E):{companyName:"",creditCode:"91110000XXXXXXXXXX",legalPerson:"",registeredCapital:"1000",establishDate:"2020-01-15",registeredAddress:"1",validUntil:"2025-01-15",validFrom:"2020-01-15",businessScope:"",isPermanent:!1,attachments:[]}}),[s,i]=M.useState(()=>{const E=localStorage.getItem(`company_bank_${e}`);return E?JSON.parse(E):null}),[l,c]=M.useState(()=>{const E=localStorage.getItem(`company_intro_${e}`);return E?JSON.parse(E):null}),[o,u]=M.useState(!1),[d,f]=M.useState(!1),[x,h]=M.useState(!1),[p,m]=M.useState(null),[w,v]=M.useState(null),[b,y]=M.useState(null);M.useEffect(()=>{r&&localStorage.setItem(`company_license_${e}`,JSON.stringify(r))},[r,e]),M.useEffect(()=>{s&&localStorage.setItem(`company_bank_${e}`,JSON.stringify(s))},[s,e]),M.useEffect(()=>{l&&localStorage.setItem(`company_intro_${e}`,JSON.stringify(l))},[l,e]);const N=E=>{const Y=new Date;return new Date(E)<Y},A=E=>new Promise((Y,B)=>{const te=new FileReader;te.onload=re=>{var Q;return Y((Q=re.target)==null?void 0:Q.result)},te.onerror=B,te.readAsDataURL(E)}),k=()=>{m(r||{companyName:"",creditCode:"",legalPerson:"",registeredCapital:"",establishDate:"",registeredAddress:"",validUntil:"",validFrom:"",businessScope:"",isPermanent:!1,attachments:[]}),u(!0)},_=()=>{p&&(a(p),u(!1))},j=()=>{v(s||{companyName:"",bankName:"",accountNumber:"",attachments:[]}),f(!0)},P=()=>{w&&(i(w),f(!1))},D=()=>{y(l||{introduction:"",orgChartAttachments:[]}),h(!0)},K=()=>{b&&(c(b),h(!1))};return n.jsxs("div",{className:"flex flex-col h-full",children:[t&&n.jsx("div",{className:"px-6 py-3 bg-yellow-50 border-b border-yellow-200 rounded-lg mb-4",children:n.jsxs("p",{className:"text-sm text-yellow-800",children:[n.jsx(Kn,{className:"w-4 h-4 inline mr-2"})," - "]})}),n.jsx("div",{className:"flex-1 overflow-auto",children:n.jsxs("div",{className:"bg-white rounded-lg border border-neutral-200",children:[n.jsx("div",{className:"px-6 py-4 border-b border-neutral-200",children:n.jsx("h2",{className:"text-lg font-medium text-neutral-900",children:""})}),n.jsx("div",{className:"px-6 pt-4",children:n.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:n.jsx("p",{className:"text-sm text-blue-700",children:""})})}),n.jsxs("div",{className:"p-6 space-y-6",children:[n.jsxs("div",{className:"bg-neutral-50 rounded-lg border border-neutral-200",children:[n.jsxs("div",{className:"px-6 py-4 border-b border-neutral-200 flex items-center justify-between bg-white rounded-t-lg",children:[n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx(Lt,{className:"w-5 h-5 text-primary-600"}),n.jsx("h3",{className:"text-base font-medium text-neutral-900",children:""})]}),!t&&n.jsxs("button",{onClick:k,className:"flex items-center space-x-1 text-primary-600 hover:text-primary-800 text-sm transition-colors",children:[n.jsx(Dt,{className:"w-4 h-4"}),n.jsx("span",{children:r?"":""})]})]}),r?n.jsxs("div",{className:"p-6 space-y-4 bg-white rounded-b-lg",children:[!r.isPermanent&&N(r.validUntil)&&n.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 flex items-start space-x-3",children:[n.jsx(Kn,{className:"w-5 h-5 text-red-600 flex-shrink-0 mt-0.5"}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm font-medium text-red-800",children:""}),n.jsx("p",{className:"text-sm text-red-600 mt-1",children:""})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-x-8 gap-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-neutral-600 mb-1.5",children:""}),n.jsx("p",{className:"text-sm text-neutral-900",children:r.companyName})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-neutral-600 mb-1.5",children:""}),n.jsx("p",{className:"text-sm text-neutral-900",children:r.creditCode})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-neutral-600 mb-1.5",children:""}),n.jsx("p",{className:"text-sm text-neutral-900",children:r.legalPerson})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-neutral-600 mb-1.5",children:""}),n.jsx("p",{className:"text-sm text-neutral-900",children:r.registeredCapital})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-neutral-600 mb-1.5",children:""}),n.jsx("p",{className:"text-sm text-neutral-900",children:r.establishDate})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-600 mb-1.5",children:["",!r.isPermanent&&N(r.validUntil)&&n.jsx("span",{className:"ml-2 text-red-600",children:"()"})]}),n.jsx("p",{className:`text-sm ${!r.isPermanent&&N(r.validUntil)?"text-red-600 font-medium":"text-neutral-900"}`,children:r.isPermanent?"":`${r.validFrom?r.validFrom+"  ":""}${r.validUntil}`})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsx("label",{className:"block text-sm font-medium text-neutral-600 mb-1.5",children:""}),n.jsx("p",{className:"text-sm text-neutral-900",children:r.registeredAddress})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsx("label",{className:"block text-sm font-medium text-neutral-600 mb-1.5",children:""}),n.jsx("p",{className:"text-sm text-neutral-900 leading-relaxed",children:r.businessScope})]}),r.attachments&&r.attachments.length>0&&n.jsxs("div",{className:"col-span-2",children:[n.jsx("label",{className:"block text-sm font-medium text-neutral-600 mb-2",children:""}),n.jsx("div",{className:"flex flex-wrap gap-4",children:r.attachments.map(E=>n.jsxs("div",{className:"relative group",children:[n.jsx("div",{className:"w-40 rounded-lg border border-neutral-200 shadow-sm bg-white overflow-hidden hover:shadow-md transition-shadow",children:n.jsx("img",{src:E.url,alt:E.name,className:"w-full h-32 object-contain p-2"})}),n.jsx("p",{className:"text-xs text-neutral-500 mt-1.5 truncate max-w-[10rem]",children:E.name})]},E.id))})]})]})]}):n.jsxs("div",{className:"p-8 text-center text-neutral-500 bg-white rounded-b-lg",children:[n.jsx(Lt,{className:"w-12 h-12 mx-auto text-neutral-300 mb-2"}),n.jsx("p",{className:"text-sm",children:""}),!t&&n.jsx("p",{className:"text-xs text-neutral-400 mt-1",children:""})]})]}),n.jsxs("div",{className:"bg-neutral-50 rounded-lg border border-neutral-200",children:[n.jsxs("div",{className:"px-6 py-4 border-b border-neutral-200 flex items-center justify-between bg-white rounded-t-lg",children:[n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx(Lt,{className:"w-5 h-5 text-primary-600"}),n.jsx("h3",{className:"text-base font-medium text-neutral-900",children:""})]}),!t&&n.jsxs("button",{onClick:j,className:"flex items-center space-x-1 text-primary-600 hover:text-primary-800 text-sm transition-colors",children:[n.jsx(Dt,{className:"w-4 h-4"}),n.jsx("span",{children:s?"":""})]})]}),s?n.jsx("div",{className:"p-6 space-y-4 bg-white rounded-b-lg",children:n.jsxs("div",{className:"grid grid-cols-2 gap-x-8 gap-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-neutral-600 mb-1.5",children:""}),n.jsx("p",{className:"text-sm text-neutral-900",children:s.companyName})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-neutral-600 mb-1.5",children:""}),n.jsx("p",{className:"text-sm text-neutral-900",children:s.bankName})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsx("label",{className:"block text-sm font-medium text-neutral-600 mb-1.5",children:""}),n.jsx("p",{className:"text-sm text-neutral-900 font-mono",children:s.accountNumber})]}),s.attachments&&s.attachments.length>0&&n.jsxs("div",{className:"col-span-2",children:[n.jsx("label",{className:"block text-sm font-medium text-neutral-600 mb-2",children:""}),n.jsx("div",{className:"flex flex-wrap gap-4",children:s.attachments.map(E=>n.jsxs("div",{className:"relative group",children:[n.jsx("div",{className:"w-40 rounded-lg border border-neutral-200 shadow-sm bg-white overflow-hidden hover:shadow-md transition-shadow",children:n.jsx("img",{src:E.url,alt:E.name,className:"w-full h-32 object-contain p-2"})}),n.jsx("p",{className:"text-xs text-neutral-500 mt-1.5 truncate max-w-[10rem]",children:E.name})]},E.id))})]})]})}):n.jsxs("div",{className:"p-8 text-center text-neutral-500 bg-white rounded-b-lg",children:[n.jsx(Lt,{className:"w-12 h-12 mx-auto text-neutral-300 mb-2"}),n.jsx("p",{className:"text-sm",children:""}),!t&&n.jsx("p",{className:"text-xs text-neutral-400 mt-1",children:""})]})]}),n.jsxs("div",{className:"bg-neutral-50 rounded-lg border border-neutral-200",children:[n.jsxs("div",{className:"px-6 py-4 border-b border-neutral-200 flex items-center justify-between bg-white rounded-t-lg",children:[n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx(Lt,{className:"w-5 h-5 text-primary-600"}),n.jsx("h3",{className:"text-base font-medium text-neutral-900",children:""})]}),!t&&n.jsxs("button",{onClick:D,className:"flex items-center space-x-1 text-primary-600 hover:text-primary-800 text-sm transition-colors",children:[n.jsx(Dt,{className:"w-4 h-4"}),n.jsx("span",{children:l?"":""})]})]}),l?n.jsxs("div",{className:"p-6 space-y-4 bg-white rounded-b-lg",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-neutral-600 mb-2",children:""}),n.jsx("p",{className:"text-sm text-neutral-900 whitespace-pre-wrap leading-relaxed",children:l.introduction})]}),l.orgChartAttachments&&l.orgChartAttachments.length>0&&n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-neutral-600 mb-2",children:""}),n.jsx("div",{className:"flex flex-wrap gap-4",children:l.orgChartAttachments.map(E=>n.jsxs("div",{className:"relative group",children:[n.jsx("div",{className:"w-40 rounded-lg border border-neutral-200 shadow-sm bg-white overflow-hidden hover:shadow-md transition-shadow",children:n.jsx("img",{src:E.url,alt:E.name,className:"w-full h-32 object-contain p-2"})}),n.jsx("p",{className:"text-xs text-neutral-500 mt-1.5 truncate max-w-[10rem]",children:E.name})]},E.id))})]})]}):n.jsxs("div",{className:"p-8 text-center text-neutral-500 bg-white rounded-b-lg",children:[n.jsx(Lt,{className:"w-12 h-12 mx-auto text-neutral-300 mb-2"}),n.jsx("p",{className:"text-sm",children:""}),!t&&n.jsx("p",{className:"text-xs text-neutral-400 mt-1",children:""})]})]})]})]})}),o&&p&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[n.jsxs("div",{className:"px-6 py-4 border-b border-neutral-200 flex items-center justify-between sticky top-0 bg-white z-10",children:[n.jsx("h3",{className:"text-lg font-medium text-neutral-900",children:r?"":""}),n.jsx("button",{onClick:()=>u(!1),className:"text-neutral-400 hover:text-neutral-600 transition-colors",children:n.jsx(Qe,{className:"w-5 h-5"})})]}),n.jsx("div",{className:"p-6 space-y-4",children:n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:p.companyName,onChange:E=>m({...p,companyName:E.target.value}),className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:p.creditCode,onChange:E=>m({...p,creditCode:E.target.value}),className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:p.legalPerson,onChange:E=>m({...p,legalPerson:E.target.value}),className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:p.registeredCapital,onChange:E=>m({...p,registeredCapital:E.target.value}),className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"date",value:p.establishDate,onChange:E=>m({...p,establishDate:E.target.value}),className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsxs("div",{className:"flex items-center space-x-4 mb-2",children:[n.jsxs("label",{className:"flex items-center",children:[n.jsx("input",{type:"radio",checked:!p.isPermanent,onChange:()=>m({...p,isPermanent:!1}),className:"mr-2"}),n.jsx("span",{className:"text-sm text-neutral-700",children:""})]}),n.jsxs("label",{className:"flex items-center",children:[n.jsx("input",{type:"radio",checked:p.isPermanent,onChange:()=>m({...p,isPermanent:!0,validUntil:"",validFrom:""}),className:"mr-2"}),n.jsx("span",{className:"text-sm text-neutral-700",children:""})]})]}),p.isPermanent?n.jsx("div",{className:"w-full px-3 py-2 border border-neutral-300 rounded-lg bg-neutral-50 text-neutral-500",children:""}):n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-neutral-600 mb-1",children:""}),n.jsx("input",{type:"date",value:p.validFrom||"",onChange:E=>m({...p,validFrom:E.target.value}),className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-xs text-neutral-600 mb-1",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"date",value:p.validUntil,onChange:E=>m({...p,validUntil:E.target.value}),className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]})]})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:p.registeredAddress,onChange:E=>m({...p,registeredAddress:E.target.value}),className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("textarea",{value:p.businessScope,onChange:E=>m({...p,businessScope:E.target.value}),rows:3,className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),p.attachments&&p.attachments.length>0&&n.jsx("div",{className:"mb-3",children:n.jsx("div",{className:"grid grid-cols-3 gap-3 relative",children:p.attachments.map((E,Y)=>n.jsxs("div",{className:"relative group",children:[n.jsx("img",{src:E.url,alt:E.name,className:"w-full h-32 object-cover rounded-lg border border-neutral-200"}),n.jsx("button",{onClick:()=>{m({...p,attachments:p.attachments.filter(B=>B.id!==E.id)})},className:"absolute top-1 right-1 bg-red-500 text-white rounded-full p-1 opacity-0 group-hover:opacity-100 transition-opacity hover:bg-red-600",children:n.jsx(qe,{className:"w-3 h-3"})}),n.jsx("p",{className:"text-xs text-neutral-600 mt-1 truncate",children:E.name})]},E.id))})}),n.jsxs("div",{className:"border-2 border-dashed border-neutral-300 rounded-lg p-4 text-center hover:border-primary-500 transition-colors cursor-pointer",onClick:()=>{var E;return(E=document.getElementById("license-upload"))==null?void 0:E.click()},children:[n.jsx(St,{className:"w-6 h-6 mx-auto text-neutral-400 mb-1"}),n.jsx("p",{className:"text-xs text-neutral-600",children:""}),n.jsx("p",{className:"text-xs text-neutral-500 mt-0.5",children:"JPGPNGJPEG"})]}),n.jsx("input",{id:"license-upload",type:"file",className:"hidden",accept:".jpg,.jpeg,.png",multiple:!0,onChange:async E=>{const Y=Array.from(E.target.files||[]);if(Y.length===0)return;const B=!p.attachments||p.attachments.length===0;for(const te of Y){if(te.size>50*1024*1024){alert(` ${te.name} 50MB`);continue}try{const re=await A(te),Q={id:`${Date.now()}-${Math.random()}`,url:re,name:te.name};m(Z=>({...Z,attachments:[...Z.attachments||[],Q]}))}catch(re){console.error(":",re),alert(` ${te.name} `)}}B&&Y.length>0&&m(te=>({...te,companyName:"",creditCode:"91110108MA01ABCD12",legalPerson:"",registeredCapital:"5000",establishDate:"2021-03-20",registeredAddress:"88",validUntil:"2031-03-20",isPermanent:!1,businessScope:""})),E.target.value=""}})]})]})}),n.jsxs("div",{className:"px-6 py-4 bg-neutral-50 flex justify-end gap-2 rounded-b-lg sticky bottom-0",children:[n.jsx("button",{onClick:()=>u(!1),className:"px-4 py-2 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-100 transition-colors",children:""}),n.jsx("button",{onClick:_,className:"px-4 py-2 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors",children:""})]})]})}),d&&w&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-lg w-full",children:[n.jsxs("div",{className:"px-6 py-4 border-b border-neutral-200 flex items-center justify-between",children:[n.jsx("h3",{className:"text-lg font-medium text-neutral-900",children:s?"":""}),n.jsx("button",{onClick:()=>f(!1),className:"text-neutral-400 hover:text-neutral-600 transition-colors",children:n.jsx(Qe,{className:"w-5 h-5"})})]}),n.jsxs("div",{className:"p-6 space-y-4",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:w.companyName,onChange:E=>v({...w,companyName:E.target.value}),className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:w.bankName,onChange:E=>v({...w,bankName:E.target.value}),className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:w.accountNumber,onChange:E=>v({...w,accountNumber:E.target.value}),className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),w.attachments&&w.attachments.length>0&&n.jsx("div",{className:"mb-3",children:n.jsx("div",{className:"grid grid-cols-3 gap-3 relative",children:w.attachments.map((E,Y)=>n.jsxs("div",{className:"relative group",children:[n.jsx("img",{src:E.url,alt:E.name,className:"w-full h-32 object-cover rounded-lg border border-neutral-200"}),n.jsx("button",{onClick:()=>{v({...w,attachments:w.attachments.filter(B=>B.id!==E.id)})},className:"absolute top-1 right-1 bg-red-500 text-white rounded-full p-1 opacity-0 group-hover:opacity-100 transition-opacity hover:bg-red-600",children:n.jsx(qe,{className:"w-3 h-3"})}),n.jsx("p",{className:"text-xs text-neutral-600 mt-1 truncate",children:E.name})]},E.id))})}),n.jsxs("div",{className:"border-2 border-dashed border-neutral-300 rounded-lg p-4 text-center hover:border-primary-500 transition-colors cursor-pointer",onClick:()=>{var E;return(E=document.getElementById("bank-upload"))==null?void 0:E.click()},children:[n.jsx(St,{className:"w-6 h-6 mx-auto text-neutral-400 mb-1"}),n.jsx("p",{className:"text-xs text-neutral-600",children:""}),n.jsx("p",{className:"text-xs text-neutral-500 mt-0.5",children:"JPGPNGJPEG"})]}),n.jsx("input",{id:"bank-upload",type:"file",className:"hidden",accept:".jpg,.jpeg,.png",multiple:!0,onChange:async E=>{const Y=Array.from(E.target.files||[]);if(Y.length===0)return;const B=!w.attachments||w.attachments.length===0;for(const te of Y){if(te.size>50*1024*1024){alert(` ${te.name} 50MB`);continue}try{const re=await A(te),Q={id:`${Date.now()}-${Math.random()}`,url:re,name:te.name};v(Z=>({...Z,attachments:[...Z.attachments||[],Q]}))}catch(re){console.error(":",re),alert(` ${te.name} `)}}B&&Y.length>0&&v(te=>({...te,companyName:"",bankName:"",accountNumber:"0200 1234 5678 9012 345"})),E.target.value=""}})]})]}),n.jsxs("div",{className:"px-6 py-4 bg-neutral-50 flex justify-end gap-2 rounded-b-lg",children:[n.jsx("button",{onClick:()=>f(!1),className:"px-4 py-2 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-100 transition-colors",children:""}),n.jsx("button",{onClick:P,className:"px-4 py-2 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors",children:""})]})]})}),x&&b&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-lg w-full",children:[n.jsxs("div",{className:"px-6 py-4 border-b border-neutral-200 flex items-center justify-between",children:[n.jsx("h3",{className:"text-lg font-medium text-neutral-900",children:l?"":""}),n.jsx("button",{onClick:()=>h(!1),className:"text-neutral-400 hover:text-neutral-600 transition-colors",children:n.jsx(Qe,{className:"w-5 h-5"})})]}),n.jsxs("div",{className:"p-6 space-y-4",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("textarea",{value:b.introduction,onChange:E=>y({...b,introduction:E.target.value}),rows:6,placeholder:"...",className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:""}),b.orgChartAttachments&&b.orgChartAttachments.length>0&&n.jsx("div",{className:"grid grid-cols-3 gap-3 mb-3",children:b.orgChartAttachments.map(E=>n.jsxs("div",{className:"relative group",children:[n.jsx("img",{src:E.url,alt:E.name,className:"w-full h-32 object-cover rounded-lg border border-neutral-200"}),n.jsx("button",{onClick:()=>{y({...b,orgChartAttachments:b.orgChartAttachments.filter(Y=>Y.id!==E.id)})},className:"absolute top-1 right-1 bg-red-500 text-white rounded-full p-1 opacity-0 group-hover:opacity-100 transition-opacity hover:bg-red-600",children:n.jsx(qe,{className:"w-3 h-3"})}),n.jsx("p",{className:"text-xs text-neutral-600 mt-1 truncate",children:E.name})]},E.id))}),n.jsxs("div",{className:"border-2 border-dashed border-neutral-300 rounded-lg p-4 text-center hover:border-primary-500 transition-colors cursor-pointer",onClick:()=>{var E;return(E=document.getElementById("org-chart-upload"))==null?void 0:E.click()},children:[n.jsx(St,{className:"w-6 h-6 mx-auto text-neutral-400 mb-1"}),n.jsx("p",{className:"text-xs text-neutral-600",children:""}),n.jsx("p",{className:"text-xs text-neutral-500 mt-0.5",children:"JPGPNGJPEG"})]}),n.jsx("input",{id:"org-chart-upload",type:"file",className:"hidden",accept:".jpg,.jpeg,.png",multiple:!0,onChange:async E=>{const Y=Array.from(E.target.files||[]);if(Y.length!==0){for(const B of Y){if(B.size>50*1024*1024){alert(` ${B.name} 50MB`);continue}try{const te=await A(B),re={id:`${Date.now()}-${Math.random()}`,url:te,name:B.name};y(Q=>({...Q,orgChartAttachments:[...Q.orgChartAttachments||[],re]}))}catch(te){console.error(":",te),alert(` ${B.name} `)}}E.target.value=""}}})]})]}),n.jsxs("div",{className:"px-6 py-4 bg-neutral-50 flex justify-end gap-2 rounded-b-lg",children:[n.jsx("button",{onClick:()=>h(!1),className:"px-4 py-2 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-100 transition-colors",children:""}),n.jsx("button",{onClick:K,className:"px-4 py-2 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors",children:""})]})]})})]})},Mb=({companyId:e,readOnly:t=!1})=>{const[r,a]=M.useState(()=>{const F=localStorage.getItem(`qualifications_${e}`);return F?JSON.parse(F):[{id:"1",name:"ISO9001",certNumber:"ISO9001-2024-001",certScope:"",certOrganization:"",rating:"",validFrom:"2024-01-01",validUntil:"2025-12-31",isPermanent:!1,attachments:[{id:"1",url:"https://via.placeholder.com/400x300/4F46E5/FFFFFF?text=ISO9001",name:"ISO9001.pdf"}],createdAt:new Date().toISOString()}]});M.useEffect(()=>{localStorage.setItem(`qualifications_${e}`,JSON.stringify(r))},[r,e]);const[s,i]=M.useState(""),[l,c]=M.useState(""),[o,u]=M.useState("all"),[d,f]=M.useState("all"),[x,h]=M.useState(1),[p,m]=M.useState(10),[w,v]=M.useState(""),[b,y]=M.useState(!1),[N,A]=M.useState(!1),[k,_]=M.useState(!1),[j,P]=M.useState(null),[D,K]=M.useState(null),E=F=>{const ae=new Date;return new Date(F)<ae},Y=()=>{i(""),c(""),u("all"),f("all"),h(1)},B=()=>{console.log("Searching:",s,l,o,d)},te=()=>{K({id:"",name:"",certNumber:"",certScope:"",certOrganization:"",rating:"",validFrom:"",validUntil:"",isPermanent:!1,attachments:[]}),y(!0)},re=F=>{K({...F,isPermanent:F.isPermanent||!1}),A(!0)},Q=F=>{P(F),_(!0)},Z=()=>{if(D){const F={...D,id:String(Date.now()),createdAt:new Date().toISOString()};a([...r,F]),y(!1)}},z=()=>{D&&(a(r.map(F=>F.id===D.id?D:F)),A(!1))},ne=()=>{j&&(a(r.filter(F=>F.id!==j.id)),_(!1))},xe=r.filter(F=>{const ae=!s||F.name.toLowerCase().includes(s.toLowerCase()),ue=!l||F.certNumber.toLowerCase().includes(l.toLowerCase()),ve=o==="all"||F.rating===o,me=d==="all"||d==="valid"&&!E(F.validUntil)||d==="expired"&&E(F.validUntil);return ae&&ue&&ve&&me}).sort((F,ae)=>{const ue=F.createdAt?new Date(F.createdAt).getTime():0;return(ae.createdAt?new Date(ae.createdAt).getTime():0)-ue}),O=()=>{const F=(x-1)*p,ae=F+p;return xe.slice(F,ae)},R=Math.ceil(xe.length/p),g=F=>{m(F),h(1)},S=()=>{const F=parseInt(w);F>=1&&F<=R&&(h(F),v(""))};return n.jsxs("div",{className:"flex flex-col h-full",children:[t&&n.jsx("div",{className:"px-6 py-3 bg-yellow-50 border-b border-yellow-200",children:n.jsxs("p",{className:"text-sm text-yellow-800",children:[n.jsx(Kn,{className:"w-4 h-4 inline mr-2"})," - "]})}),n.jsx("div",{className:"flex-1 overflow-auto",children:n.jsxs("div",{className:"bg-white rounded-lg border border-neutral-200",children:[n.jsxs("div",{className:"px-6 py-4 border-b border-neutral-200",children:[n.jsx("div",{className:"flex items-center justify-between mb-4",children:n.jsx("h2",{className:"text-lg font-medium text-neutral-900",children:""})}),n.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4",children:n.jsx("p",{className:"text-sm text-blue-700",children:"ISO"})}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex items-center gap-3 flex-wrap",children:["",n.jsx("input",{type:"text",placeholder:"",value:s,onChange:F=>i(F.target.value),className:"w-40 px-3 py-1.5 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500"}),"",n.jsx("input",{type:"text",placeholder:"",value:l,onChange:F=>c(F.target.value),className:"w-40 px-3 py-1.5 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500"}),"",n.jsx("input",{type:"text",placeholder:"",value:l,onChange:F=>c(F.target.value),className:"w-40 px-3 py-1.5 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500"}),"",n.jsxs("select",{value:d,onChange:F=>f(F.target.value),className:"px-3 py-1.5 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500",children:[n.jsx("option",{value:"all",children:""}),n.jsx("option",{value:"valid",children:""}),n.jsx("option",{value:"expired",children:""})]})]}),n.jsxs("div",{className:"flex justify-end gap-2",children:[n.jsx("button",{onClick:Y,className:"px-4 py-1.5 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-50 transition-colors",children:""}),n.jsx("button",{onClick:B,className:"px-4 py-1.5 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors",children:""})]})]})]}),!t&&n.jsx("div",{className:"px-6 py-3 border-b border-neutral-200",children:n.jsxs("button",{onClick:te,className:"px-4 py-1.5 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors flex items-center",children:[n.jsx(Pt,{className:"w-4 h-4 mr-1"}),""]})}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"w-full",children:[n.jsx("thead",{className:"bg-neutral-50 border-b border-neutral-200",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""})]})}),n.jsx("tbody",{className:"divide-y divide-neutral-200",children:O().length===0?n.jsx("tr",{children:n.jsx("td",{colSpan:9,className:"px-4 py-8 text-center text-neutral-500",children:""})}):O().map((F,ae)=>n.jsxs("tr",{className:"hover:bg-neutral-50 transition-colors",children:[n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm text-neutral-900",children:(x-1)*p+ae+1}),n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm text-neutral-900",children:n.jsx("div",{className:"max-w-xs truncate",title:F.name,children:F.name})}),n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm text-neutral-900",children:F.certNumber}),n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm text-neutral-900",children:F.rating||""}),n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm text-neutral-900",children:n.jsx("div",{className:"max-w-xs truncate",title:F.certScope,children:F.certScope})}),n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm text-neutral-900",children:n.jsx("div",{className:"max-w-xs truncate",title:F.certOrganization,children:F.certOrganization})}),n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm text-neutral-900",children:n.jsx("span",{className:E(F.validUntil)?"text-red-600 font-medium":"",children:F.validUntil})}),n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap",children:E(F.validUntil)?n.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-red-100 text-red-800",children:""}):n.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-green-100 text-green-800",children:""})}),n.jsxs("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm",children:[!t&&n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsxs("button",{onClick:()=>re(F),className:"px-2 py-1 text-xs text-primary-600 hover:text-primary-800 hover:bg-primary-50 rounded transition-colors flex items-center gap-1",children:[n.jsx(Rd,{className:"w-3.5 h-3.5"}),""]}),n.jsxs("button",{onClick:()=>Q(F),className:"px-2 py-1 text-xs text-red-600 hover:text-red-800 hover:bg-red-50 rounded transition-colors flex items-center gap-1",children:[n.jsx(qe,{className:"w-3.5 h-3.5"}),""]})]}),t&&n.jsx("span",{className:"text-xs text-neutral-400",children:""})]})]},F.id))})]})}),n.jsxs("div",{className:"bg-white border-t border-neutral-200 px-6 py-3 flex items-center justify-center gap-6",children:[n.jsxs("div",{className:"text-sm text-neutral-700",children:[" ",xe.length," "]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("button",{onClick:()=>h(Math.max(1,x-1)),disabled:x===1,className:`px-2 py-1 text-sm rounded transition-colors ${x===1?"bg-neutral-100 text-neutral-400 cursor-not-allowed":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:"<"}),n.jsx("div",{className:"flex items-center space-x-1",children:Array.from({length:Math.min(10,R)},(F,ae)=>{let ue;return R<=10||x<=5?ue=ae+1:x>=R-4?ue=R-9+ae:ue=x-4+ae,n.jsx("button",{onClick:()=>h(ue),className:`px-2.5 py-1 text-sm rounded transition-colors ${x===ue?"bg-primary-600 text-white":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:ue},ue)})}),R>10&&n.jsxs(n.Fragment,{children:[n.jsx("span",{className:"text-neutral-500",children:"..."}),n.jsx("button",{onClick:()=>h(R),className:`px-2.5 py-1 text-sm rounded transition-colors ${x===R?"bg-primary-600 text-white":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:R})]}),n.jsx("button",{onClick:()=>h(Math.min(R,x+1)),disabled:x===R,className:`px-2 py-1 text-sm rounded transition-colors ${x===R?"bg-neutral-100 text-neutral-400 cursor-not-allowed":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:">"})]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsxs("select",{value:p,onChange:F=>g(Number(F.target.value)),className:"px-2 py-1 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500",children:[n.jsx("option",{value:10,children:"10/"}),n.jsx("option",{value:20,children:"20/"}),n.jsx("option",{value:50,children:"50/"})]}),n.jsx("span",{className:"text-sm text-neutral-700",children:""}),n.jsx("input",{type:"number",value:w,onChange:F=>v(F.target.value),placeholder:"",className:"w-12 px-2 py-1 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500",min:1,max:R}),n.jsx("button",{onClick:S,className:"px-3 py-1 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-50 transition-colors",children:""})]})]})]})}),b&&D&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[n.jsxs("div",{className:"px-6 py-4 border-b border-neutral-200 flex items-center justify-between sticky top-0 bg-white",children:[n.jsx("h3",{className:"text-lg font-medium text-neutral-900",children:""}),n.jsx("button",{onClick:()=>y(!1),className:"text-neutral-400 hover:text-neutral-600 transition-colors",children:n.jsx(Qe,{className:"w-5 h-5"})})]}),n.jsx("div",{className:"p-6 space-y-4",children:n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:D.name,onChange:F=>K({...D,name:F.target.value}),placeholder:"",className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:D.certNumber,onChange:F=>K({...D,certNumber:F.target.value}),placeholder:"",className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("textarea",{value:D.certScope,onChange:F=>K({...D,certScope:F.target.value}),placeholder:"",rows:2,className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:D.certOrganization,onChange:F=>K({...D,certOrganization:F.target.value}),placeholder:"",className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:""}),n.jsxs("select",{value:D.rating,onChange:F=>K({...D,rating:F.target.value}),className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[n.jsx("option",{value:"",children:""}),n.jsx("option",{value:"",children:""}),n.jsx("option",{value:"",children:""}),n.jsx("option",{value:"",children:""}),n.jsx("option",{value:"",children:""}),n.jsx("option",{value:"",children:""}),n.jsx("option",{value:"",children:""}),n.jsx("option",{value:"",children:""}),n.jsx("option",{value:"",children:""}),n.jsx("option",{value:"",children:""}),n.jsx("option",{value:"AAA",children:"AAA"}),n.jsx("option",{value:"AAAA",children:"AAAA"}),n.jsx("option",{value:"AAAAA",children:"AAAAA"}),n.jsx("option",{value:"CS1",children:"CS1"}),n.jsx("option",{value:"CS2",children:"CS2"}),n.jsx("option",{value:"CS3",children:"CS3"}),n.jsx("option",{value:"CS4",children:"CS4"}),n.jsx("option",{value:"CS5",children:"CS5"}),n.jsx("option",{value:"",children:""}),n.jsx("option",{value:"",children:""}),n.jsx("option",{value:"",children:""}),n.jsx("option",{value:"",children:""}),n.jsx("option",{value:"",children:""}),n.jsx("option",{value:"",children:""}),n.jsx("option",{value:"",children:""}),n.jsx("option",{value:"",children:""}),n.jsx("option",{value:"",children:""}),n.jsx("option",{value:"",children:""}),n.jsx("option",{value:"",children:""}),n.jsx("option",{value:"",children:""})]})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsxs("div",{className:"flex items-center space-x-4 mb-2",children:[n.jsxs("label",{className:"flex items-center",children:[n.jsx("input",{type:"radio",checked:!D.isPermanent,onChange:()=>K({...D,isPermanent:!1}),className:"mr-2"}),n.jsx("span",{className:"text-sm text-neutral-700",children:""})]}),n.jsxs("label",{className:"flex items-center",children:[n.jsx("input",{type:"radio",checked:D.isPermanent,onChange:()=>K({...D,isPermanent:!0,validUntil:"",validFrom:""}),className:"mr-2"}),n.jsx("span",{className:"text-sm text-neutral-700",children:""})]})]}),D.isPermanent?n.jsx("div",{className:"w-full px-3 py-2 border border-neutral-300 rounded-lg bg-neutral-50 text-neutral-500",children:""}):n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-neutral-600 mb-1",children:""}),n.jsx("input",{type:"date",value:D.validFrom||"",onChange:F=>K({...D,validFrom:F.target.value}),className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-xs text-neutral-600 mb-1",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"date",value:D.validUntil,onChange:F=>K({...D,validUntil:F.target.value}),className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]})]})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),D.attachments&&D.attachments.length>0&&n.jsx("div",{className:"mb-3",children:n.jsx("div",{className:"grid grid-cols-3 gap-3 relative",children:D.attachments.map((F,ae)=>n.jsxs("div",{className:"relative group",children:[n.jsx("img",{src:F.url,alt:F.name,className:"w-full h-32 object-cover rounded-lg border border-neutral-200"}),n.jsx("button",{onClick:()=>{K({...D,attachments:D.attachments.filter(ue=>ue.id!==F.id)})},className:"absolute top-1 right-1 bg-red-500 text-white rounded-full p-1 opacity-0 group-hover:opacity-100 transition-opacity hover:bg-red-600",children:n.jsx(qe,{className:"w-3 h-3"})}),n.jsx("p",{className:"text-xs text-neutral-600 mt-1 truncate",children:F.name})]},F.id))})}),n.jsxs("div",{className:"border-2 border-dashed border-neutral-300 rounded-lg p-4 text-center hover:border-primary-500 transition-colors cursor-pointer",onClick:()=>{var F;return(F=document.getElementById("qualification-upload-add"))==null?void 0:F.click()},children:[n.jsx(St,{className:"w-6 h-6 mx-auto text-neutral-400 mb-1"}),n.jsx("p",{className:"text-xs text-neutral-600",children:""}),n.jsx("p",{className:"text-xs text-neutral-500 mt-0.5",children:"JPGPNGJPEG"}),n.jsx("input",{id:"qualification-upload-add",type:"file",className:"hidden",accept:".jpg,.jpeg,.png",multiple:!0,onChange:F=>{const ae=Array.from(F.target.files||[]),ue=D.attachments.length===0,ve=ae.map(me=>({id:String(Date.now()+Math.random()),name:me.name,url:URL.createObjectURL(me)}));K(me=>({...me,attachments:[...me.attachments,...ve]})),ue&&ae.length>0&&K(me=>({...me,name:"ISO9001",certNumber:"ISO9001-2024-001",certScope:"",certOrganization:"",rating:"",validFrom:"2024-01-01",validUntil:"2025-12-31",isPermanent:!1}))}})]})]})]})}),n.jsxs("div",{className:"px-6 py-4 bg-neutral-50 flex justify-end gap-2 rounded-b-lg sticky bottom-0",children:[n.jsx("button",{onClick:()=>y(!1),className:"px-4 py-2 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-100 transition-colors",children:""}),n.jsx("button",{onClick:Z,className:"px-4 py-2 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors",children:""})]})]})}),N&&D&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[n.jsxs("div",{className:"px-6 py-4 border-b border-neutral-200 flex items-center justify-between sticky top-0 bg-white",children:[n.jsx("h3",{className:"text-lg font-medium text-neutral-900",children:""}),n.jsx("button",{onClick:()=>A(!1),className:"text-neutral-400 hover:text-neutral-600 transition-colors",children:n.jsx(Qe,{className:"w-5 h-5"})})]}),n.jsx("div",{className:"p-6 space-y-4",children:n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:D.name,onChange:F=>K({...D,name:F.target.value}),placeholder:"",className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:D.certNumber,onChange:F=>K({...D,certNumber:F.target.value}),placeholder:"",className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("textarea",{value:D.certScope,onChange:F=>K({...D,certScope:F.target.value}),placeholder:"",rows:2,className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:D.certOrganization,onChange:F=>K({...D,certOrganization:F.target.value}),placeholder:"",className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:""}),n.jsx("input",{type:"text",value:D.rating,onChange:F=>K({...D,rating:F.target.value}),placeholder:"",className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsxs("div",{className:"flex items-center space-x-4 mb-2",children:[n.jsxs("label",{className:"flex items-center",children:[n.jsx("input",{type:"radio",checked:!D.isPermanent,onChange:()=>K({...D,isPermanent:!1}),className:"mr-2"}),n.jsx("span",{className:"text-sm text-neutral-700",children:""})]}),n.jsxs("label",{className:"flex items-center",children:[n.jsx("input",{type:"radio",checked:D.isPermanent,onChange:()=>K({...D,isPermanent:!0,validUntil:"",validFrom:""}),className:"mr-2"}),n.jsx("span",{className:"text-sm text-neutral-700",children:""})]})]}),D.isPermanent?n.jsx("div",{className:"w-full px-3 py-2 border border-neutral-300 rounded-lg bg-neutral-50 text-neutral-500",children:""}):n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-neutral-600 mb-1",children:""}),n.jsx("input",{type:"date",value:D.validFrom||"",onChange:F=>K({...D,validFrom:F.target.value}),className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-xs text-neutral-600 mb-1",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"date",value:D.validUntil,onChange:F=>K({...D,validUntil:F.target.value}),className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]})]})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),D.attachments&&D.attachments.length>0&&n.jsx("div",{className:"mb-3",children:n.jsx("div",{className:"grid grid-cols-3 gap-3 relative",children:D.attachments.map((F,ae)=>n.jsxs("div",{className:"relative group",children:[F.url?n.jsx("img",{src:F.url,alt:F.name,className:"w-full h-32 object-cover rounded-lg border border-neutral-200"}):n.jsx("div",{className:"w-full h-32 flex items-center justify-center bg-neutral-100 rounded-lg border border-neutral-200",children:n.jsx("span",{className:"text-xs text-neutral-500",children:F.name})}),n.jsx("button",{onClick:()=>{K({...D,attachments:D.attachments.filter((ue,ve)=>ve!==ae)})},className:"absolute top-1 right-1 bg-red-500 text-white rounded-full p-1 opacity-0 group-hover:opacity-100 transition-opacity hover:bg-red-600",children:n.jsx(qe,{className:"w-3 h-3"})}),n.jsx("p",{className:"text-xs text-neutral-600 mt-1 truncate",children:F.name})]},F.id||ae))})}),n.jsxs("div",{className:"border-2 border-dashed border-neutral-300 rounded-lg p-4 text-center hover:border-primary-500 transition-colors cursor-pointer",onClick:()=>{var F;return(F=document.getElementById("qualification-upload-edit"))==null?void 0:F.click()},children:[n.jsx(St,{className:"w-6 h-6 mx-auto text-neutral-400 mb-1"}),n.jsx("p",{className:"text-xs text-neutral-600",children:""}),n.jsx("p",{className:"text-xs text-neutral-500 mt-0.5",children:"JPGPNG"}),n.jsx("input",{id:"qualification-upload-edit",type:"file",className:"hidden",accept:".jpg,.jpeg,.png",multiple:!0,onChange:F=>{const ae=Array.from(F.target.files||[]),ue=D.attachments.length===0,ve=ae.map(me=>({id:String(Date.now()+Math.random()),name:me.name,url:URL.createObjectURL(me)}));K(me=>({...me,attachments:[...me.attachments,...ve]})),ue&&ae.length>0&&K(me=>({...me,name:"ISO9001",certNumber:"ISO9001-2024-001",certScope:"",certOrganization:"",rating:"",validFrom:"2024-01-01",validUntil:"2025-12-31",isPermanent:!1}))}})]})]})]})}),n.jsxs("div",{className:"px-6 py-4 bg-neutral-50 flex justify-end gap-2 rounded-b-lg sticky bottom-0",children:[n.jsx("button",{onClick:()=>A(!1),className:"px-4 py-2 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-100 transition-colors",children:""}),n.jsx("button",{onClick:z,className:"px-4 py-2 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors",children:""})]})]})}),k&&j&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4",children:[n.jsx("div",{className:"px-6 py-4 border-b border-neutral-200",children:n.jsx("h3",{className:"text-lg font-medium text-neutral-900",children:""})}),n.jsx("div",{className:"p-6",children:n.jsxs("p",{className:"text-neutral-600",children:[" ",n.jsxs("span",{className:"font-medium",children:['"',j.name,'"']})," "]})}),n.jsxs("div",{className:"px-6 py-4 bg-neutral-50 flex justify-end gap-2 rounded-b-lg",children:[n.jsx("button",{onClick:()=>_(!1),className:"px-4 py-2 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-100 transition-colors",children:""}),n.jsx("button",{onClick:ne,className:"px-4 py-2 text-sm bg-red-600 text-white rounded hover:bg-red-700 transition-colors",children:""})]})]})})]})},Rb=({companyId:e,readOnly:t=!1})=>{const[r,a]=M.useState(()=>{const g=localStorage.getItem(`financial_${e}`);return g?JSON.parse(g):[{id:"1",reportName:"2024",year:"2024",attachments:[{url:"",name:"2024.pdf",size:2048576}],createdAt:new Date().toISOString()}]});M.useEffect(()=>{localStorage.setItem(`financial_${e}`,JSON.stringify(r))},[r,e]);const[s,i]=M.useState(""),[l,c]=M.useState(1),[o,u]=M.useState(10),[d,f]=M.useState(""),[x,h]=M.useState(!1),[p,m]=M.useState(!1),[w,v]=M.useState(!1),[b,y]=M.useState(null),[N,A]=M.useState(null),k=50*1024*1024,_=g=>{if(g===0)return"0 B";const S=1024,F=["B","KB","MB","GB"],ae=Math.floor(Math.log(g)/Math.log(S));return Math.round(g/Math.pow(S,ae)*100)/100+" "+F[ae]},j=()=>{i(""),c(1)},P=()=>{console.log("Searching:",s)},D=()=>{A({id:"",reportName:"",year:new Date().getFullYear().toString(),attachments:[]}),h(!0)},K=g=>{A({...g}),m(!0)},E=g=>{y(g),v(!0)},Y=()=>{if(N){const g={...N,id:String(Date.now()),createdAt:new Date().toISOString()};a([...r,g]),h(!1)}},B=()=>{N&&(a(r.map(g=>g.id===N.id?N:g)),m(!1))},te=()=>{b&&(a(r.filter(g=>g.id!==b.id)),v(!1))},re=g=>{if(N){if(g.size>k){alert(` "${g.name}" 50MB`);return}const S={url:"",name:g.name,size:g.size};A({...N,attachments:[...N.attachments,S]})}},Q=g=>{if(N){const S=N.attachments.filter((F,ae)=>ae!==g);A({...N,attachments:S})}},Z=r.filter(g=>!s||g.year===s).sort((g,S)=>{const F=g.year?parseInt(g.year):0;return(S.year?parseInt(S.year):0)-F}),z=()=>{const g=(l-1)*o,S=g+o;return Z.slice(g,S)},ne=Math.ceil(Z.length/o),xe=g=>{u(g),c(1)},O=()=>{const g=parseInt(d);g>=1&&g<=ne&&(c(g),f(""))},R=()=>{const g=new Date().getFullYear(),S=[];for(let F=g;F>=g-20;F--)S.push(F);return S};return n.jsxs("div",{className:"flex flex-col h-full",children:[t&&n.jsx("div",{className:"px-6 py-3 bg-yellow-50 border-b border-yellow-200",children:n.jsxs("p",{className:"text-sm text-yellow-800",children:[n.jsx(Kn,{className:"w-4 h-4 inline mr-2"})," - "]})}),n.jsx("div",{className:"flex-1 overflow-auto",children:n.jsxs("div",{className:"bg-white rounded-lg border border-neutral-200",children:[n.jsxs("div",{className:"px-6 py-4 border-b border-neutral-200",children:[n.jsx("div",{className:"flex items-center justify-between mb-4",children:n.jsx("h2",{className:"text-lg font-medium text-neutral-900",children:""})}),n.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4",children:n.jsx("p",{className:"text-sm text-blue-700",children:""})}),n.jsxs("div",{className:"flex items-center justify-between gap-3",children:[n.jsxs("div",{className:"flex items-center gap-3",children:["",n.jsxs("select",{value:s,onChange:g=>i(g.target.value),className:"w-40 px-3 py-1.5 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500",children:[n.jsx("option",{value:"",children:""}),R().map(g=>n.jsxs("option",{value:g,children:[g,""]},g))]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{onClick:j,className:"px-4 py-1.5 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-50 transition-colors",children:""}),n.jsx("button",{onClick:P,className:"px-4 py-1.5 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors",children:""})]})]})]}),!t&&n.jsx("div",{className:"px-6 py-3 border-b border-neutral-200",children:n.jsxs("button",{onClick:D,className:"px-4 py-1.5 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors flex items-center",children:[n.jsx(Pt,{className:"w-4 h-4 mr-1"}),""]})}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"w-full",children:[n.jsx("thead",{className:"bg-neutral-50 border-b border-neutral-200",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""})]})}),n.jsx("tbody",{className:"divide-y divide-neutral-200",children:z().length===0?n.jsx("tr",{children:n.jsx("td",{colSpan:5,className:"px-4 py-8 text-center text-neutral-500",children:""})}):z().map((g,S)=>n.jsxs("tr",{className:"hover:bg-neutral-50 transition-colors",children:[n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm text-neutral-900",children:(l-1)*o+S+1}),n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm text-neutral-900",children:n.jsx("div",{className:"max-w-xs truncate",title:g.reportName,children:g.reportName})}),n.jsxs("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm text-neutral-900",children:[g.year,""]}),n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm text-neutral-900",children:n.jsx("div",{className:"max-w-xs truncate",children:g.attachments.map((F,ae)=>n.jsxs("div",{className:"text-primary-600 hover:text-primary-800 cursor-pointer truncate",title:`${F.name} (${_(F.size)})`,children:[F.name," (",_(F.size),")"]},ae))})}),n.jsxs("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm",children:[!t&&n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsxs("button",{onClick:()=>K(g),className:"px-2 py-1 text-xs text-primary-600 hover:text-primary-800 hover:bg-primary-50 rounded transition-colors flex items-center gap-1",children:[n.jsx(Dt,{className:"w-3.5 h-3.5"}),""]}),n.jsxs("button",{onClick:()=>E(g),className:"px-2 py-1 text-xs text-red-600 hover:text-red-800 hover:bg-red-50 rounded transition-colors flex items-center gap-1",children:[n.jsx(qe,{className:"w-3.5 h-3.5"}),""]})]}),t&&n.jsx("span",{className:"text-xs text-neutral-400",children:""})]})]},g.id))})]})}),n.jsxs("div",{className:"bg-white border-t border-neutral-200 px-6 py-3 flex items-center justify-center gap-6",children:[n.jsxs("div",{className:"text-sm text-neutral-700",children:[" ",Z.length," "]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("button",{onClick:()=>c(Math.max(1,l-1)),disabled:l===1,className:`px-2 py-1 text-sm rounded transition-colors ${l===1?"bg-neutral-100 text-neutral-400 cursor-not-allowed":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:"<"}),n.jsx("div",{className:"flex items-center space-x-1",children:Array.from({length:Math.min(10,ne)},(g,S)=>{let F;return ne<=10||l<=5?F=S+1:l>=ne-4?F=ne-9+S:F=l-4+S,n.jsx("button",{onClick:()=>c(F),className:`px-2.5 py-1 text-sm rounded transition-colors ${l===F?"bg-primary-600 text-white":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:F},F)})}),ne>10&&n.jsxs(n.Fragment,{children:[n.jsx("span",{className:"text-neutral-500",children:"..."}),n.jsx("button",{onClick:()=>c(ne),className:`px-2.5 py-1 text-sm rounded transition-colors ${l===ne?"bg-primary-600 text-white":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:ne})]}),n.jsx("button",{onClick:()=>c(Math.min(ne,l+1)),disabled:l===ne,className:`px-2 py-1 text-sm rounded transition-colors ${l===ne?"bg-neutral-100 text-neutral-400 cursor-not-allowed":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:">"})]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsxs("select",{value:o,onChange:g=>xe(Number(g.target.value)),className:"px-2 py-1 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500",children:[n.jsx("option",{value:10,children:"10/"}),n.jsx("option",{value:20,children:"20/"}),n.jsx("option",{value:50,children:"50/"})]}),n.jsx("span",{className:"text-sm text-neutral-700",children:""}),n.jsx("input",{type:"number",value:d,onChange:g=>f(g.target.value),placeholder:"",className:"w-12 px-2 py-1 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500",min:1,max:ne}),n.jsx("button",{onClick:O,className:"px-3 py-1 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-50 transition-colors",children:""})]})]})]})}),x&&N&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[n.jsxs("div",{className:"px-6 py-4 border-b border-neutral-200 flex items-center justify-between sticky top-0 bg-white",children:[n.jsx("h3",{className:"text-lg font-medium text-neutral-900",children:""}),n.jsx("button",{onClick:()=>h(!1),className:"text-neutral-400 hover:text-neutral-600 transition-colors",children:n.jsx(Qe,{className:"w-5 h-5"})})]}),n.jsxs("div",{className:"p-6 space-y-4",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:N.reportName,onChange:g=>A({...N,reportName:g.target.value}),placeholder:"",className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("select",{value:N.year,onChange:g=>A({...N,year:g.target.value}),className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:R().map(g=>n.jsxs("option",{value:g,children:[g,""]},g))})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})," ",n.jsx("span",{className:"text-neutral-500 text-xs",children:"()"})]}),n.jsxs("div",{className:"border-2 border-dashed border-neutral-300 rounded-lg p-6 text-center hover:border-primary-500 transition-colors cursor-pointer",onClick:()=>{var g;return(g=document.getElementById("financial-upload-add"))==null?void 0:g.click()},children:[n.jsx(St,{className:"w-8 h-8 mx-auto text-neutral-400 mb-2"}),n.jsx("p",{className:"text-sm text-neutral-600",children:""}),n.jsx("p",{className:"text-xs text-neutral-500 mt-1",children:"PDF "}),n.jsx("input",{id:"financial-upload-add",type:"file",className:"hidden",accept:".jpg,.jpeg,.png,.pdf",multiple:!0,onChange:g=>{Array.from(g.target.files||[]).forEach(F=>{re({name:F.name,size:F.size})})}})]}),N.attachments.length>0&&n.jsxs("div",{className:"mt-3 space-y-2",children:[n.jsx("p",{className:"text-sm font-medium text-neutral-700",children:""}),N.attachments.map((g,S)=>n.jsxs("div",{className:"flex items-center justify-between bg-neutral-50 px-3 py-2 rounded",children:[n.jsxs("div",{className:"flex items-center space-x-2 flex-1 min-w-0",children:[n.jsx(Lt,{className:"w-4 h-4 text-neutral-400 flex-shrink-0"}),n.jsx("span",{className:"text-sm text-neutral-900 truncate",children:g.name}),n.jsxs("span",{className:"text-xs text-neutral-500 flex-shrink-0",children:["(",_(g.size),")"]})]}),n.jsx("button",{onClick:()=>Q(S),className:"text-red-600 hover:text-red-800 text-sm ml-2 flex-shrink-0",children:n.jsx(qe,{className:"w-4 h-4"})})]},S))]})]})]}),n.jsxs("div",{className:"px-6 py-4 bg-neutral-50 flex justify-end gap-2 rounded-b-lg sticky bottom-0",children:[n.jsx("button",{onClick:()=>h(!1),className:"px-4 py-2 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-100 transition-colors",children:""}),n.jsx("button",{onClick:Y,className:"px-4 py-2 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors",children:""})]})]})}),p&&N&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[n.jsxs("div",{className:"px-6 py-4 border-b border-neutral-200 flex items-center justify-between sticky top-0 bg-white",children:[n.jsx("h3",{className:"text-lg font-medium text-neutral-900",children:""}),n.jsx("button",{onClick:()=>m(!1),className:"text-neutral-400 hover:text-neutral-600 transition-colors",children:n.jsx(Qe,{className:"w-5 h-5"})})]}),n.jsxs("div",{className:"p-6 space-y-4",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:N.reportName,onChange:g=>A({...N,reportName:g.target.value}),placeholder:"",className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("select",{value:N.year,onChange:g=>A({...N,year:g.target.value}),className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:R().map(g=>n.jsxs("option",{value:g,children:[g,""]},g))})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:[" ",n.jsx("span",{className:"text-neutral-500 text-xs",children:"()"})]}),n.jsxs("div",{className:"border-2 border-dashed border-neutral-300 rounded-lg p-6 text-center hover:border-primary-500 transition-colors cursor-pointer",onClick:()=>{var g;return(g=document.getElementById("financial-upload-edit"))==null?void 0:g.click()},children:[n.jsx(St,{className:"w-8 h-8 mx-auto text-neutral-400 mb-2"}),n.jsx("p",{className:"text-sm text-neutral-600",children:""}),n.jsx("p",{className:"text-xs text-neutral-500 mt-1",children:" JPGPNGJPEGPDF "}),n.jsx("input",{id:"financial-upload-edit",type:"file",className:"hidden",accept:".jpg,.jpeg,.png,.pdf",multiple:!0,onChange:g=>{Array.from(g.target.files||[]).forEach(F=>{re({name:F.name,size:F.size})})}})]}),N.attachments.length>0&&n.jsxs("div",{className:"mt-3 space-y-2",children:[n.jsx("p",{className:"text-sm font-medium text-neutral-700",children:""}),N.attachments.map((g,S)=>n.jsxs("div",{className:"flex items-center justify-between bg-neutral-50 px-3 py-2 rounded",children:[n.jsxs("div",{className:"flex items-center space-x-2 flex-1 min-w-0",children:[n.jsx(Lt,{className:"w-4 h-4 text-neutral-400 flex-shrink-0"}),n.jsx("span",{className:"text-sm text-neutral-900 truncate",children:g.name}),n.jsxs("span",{className:"text-xs text-neutral-500 flex-shrink-0",children:["(",_(g.size),")"]})]}),n.jsx("button",{onClick:()=>Q(S),className:"text-red-600 hover:text-red-800 text-sm ml-2 flex-shrink-0",children:n.jsx(qe,{className:"w-4 h-4"})})]},S))]})]})]}),n.jsxs("div",{className:"px-6 py-4 bg-neutral-50 flex justify-end gap-2 rounded-b-lg sticky bottom-0",children:[n.jsx("button",{onClick:()=>m(!1),className:"px-4 py-2 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-100 transition-colors",children:""}),n.jsx("button",{onClick:B,className:"px-4 py-2 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors",children:""})]})]})}),w&&b&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4",children:[n.jsx("div",{className:"px-6 py-4 border-b border-neutral-200",children:n.jsx("h3",{className:"text-lg font-medium text-neutral-900",children:""})}),n.jsx("div",{className:"p-6",children:n.jsxs("p",{className:"text-neutral-600",children:[" ",n.jsxs("span",{className:"font-medium",children:['"',b.reportName,'"']})," "]})}),n.jsxs("div",{className:"px-6 py-4 bg-neutral-50 flex justify-end gap-2 rounded-b-lg",children:[n.jsx("button",{onClick:()=>v(!1),className:"px-4 py-2 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-100 transition-colors",children:""}),n.jsx("button",{onClick:te,className:"px-4 py-2 text-sm bg-red-600 text-white rounded hover:bg-red-700 transition-colors",children:""})]})]})})]})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var vo={};vo.version="0.18.5";var N1=1252,Ob=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Xu={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Ku=function(e){Ob.indexOf(e)!=-1&&(N1=Xu[0]=e)};function Lb(){Ku(1252)}var zn=function(e){Ku(e)};function Yu(){zn(1200),Lb()}function Yx(e){for(var t=[],r=0,a=e.length;r<a;++r)t[r]=e.charCodeAt(r);return t}function Bb(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function j1(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var $i=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?Bb(e.slice(2)):t==254&&r==255?j1(e.slice(2)):t==65279?e.slice(1):e},bc=function(t){return String.fromCharCode(t)},qx=function(t){return String.fromCharCode(t)},Ia,Oa="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Fl(e){for(var t="",r=0,a=0,s=0,i=0,l=0,c=0,o=0,u=0;u<e.length;)r=e.charCodeAt(u++),i=r>>2,a=e.charCodeAt(u++),l=(r&3)<<4|a>>4,s=e.charCodeAt(u++),c=(a&15)<<2|s>>6,o=s&63,isNaN(a)?c=o=64:isNaN(s)&&(o=64),t+=Oa.charAt(i)+Oa.charAt(l)+Oa.charAt(c)+Oa.charAt(o);return t}function gn(e){var t="",r=0,a=0,s=0,i=0,l=0,c=0,o=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<e.length;)i=Oa.indexOf(e.charAt(u++)),l=Oa.indexOf(e.charAt(u++)),r=i<<2|l>>4,t+=String.fromCharCode(r),c=Oa.indexOf(e.charAt(u++)),a=(l&15)<<4|c>>2,c!==64&&(t+=String.fromCharCode(a)),o=Oa.indexOf(e.charAt(u++)),s=(c&3)<<6|o,o!==64&&(t+=String.fromCharCode(s));return t}var at=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),ja=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function Ya(e){return at?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function Jx(e){return at?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var fn=function(t){return at?ja(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Xo(e){if(typeof ArrayBuffer>"u")return fn(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),a=0;a!=e.length;++a)r[a]=e.charCodeAt(a)&255;return t}function rs(e){if(Array.isArray(e))return e.map(function(a){return String.fromCharCode(a)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function Ub(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function qu(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return qu(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var mr=at?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:ja(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var a=new Uint8Array(r),s=0;for(t=0,r=0;t<e.length;r+=s,++t)if(s=e[t].length,e[t]instanceof Uint8Array)a.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";a.set(new Uint8Array(e[t]),r)}return a}return[].concat.apply([],e.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function zb(e){for(var t=[],r=0,a=e.length+250,s=Ya(e.length+255),i=0;i<e.length;++i){var l=e.charCodeAt(i);if(l<128)s[r++]=l;else if(l<2048)s[r++]=192|l>>6&31,s[r++]=128|l&63;else if(l>=55296&&l<57344){l=(l&1023)+64;var c=e.charCodeAt(++i)&1023;s[r++]=240|l>>8&7,s[r++]=128|l>>2&63,s[r++]=128|c>>6&15|(l&3)<<4,s[r++]=128|c&63}else s[r++]=224|l>>12&15,s[r++]=128|l>>6&63,s[r++]=128|l&63;r>a&&(t.push(s.slice(0,r)),r=0,s=Ya(65535),a=65530)}return t.push(s.slice(0,r)),mr(t)}var Vr=/\u0000/g,Vi=/[\u0001-\u0006]/g;function ci(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Wn(e,t){var r=""+e;return r.length>=t?r:Xt("0",t-r.length)+r}function Ju(e,t){var r=""+e;return r.length>=t?r:Xt(" ",t-r.length)+r}function yo(e,t){var r=""+e;return r.length>=t?r:r+Xt(" ",t-r.length)}function Wb(e,t){var r=""+Math.round(e);return r.length>=t?r:Xt("0",t-r.length)+r}function Hb(e,t){var r=""+e;return r.length>=t?r:Xt("0",t-r.length)+r}var Qx=Math.pow(2,32);function Bs(e,t){if(e>Qx||e<-Qx)return Wb(e,t);var r=Math.round(e);return Hb(r,t)}function bo(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var Zx=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],T0=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function $b(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var Xe={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},em={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Vb={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function wo(e,t,r){for(var a=e<0?-1:1,s=e*a,i=0,l=1,c=0,o=1,u=0,d=0,f=Math.floor(s);u<t&&(f=Math.floor(s),c=f*l+i,d=f*u+o,!(s-f<5e-8));)s=1/(s-f),i=l,l=c,o=u,u=d;if(d>t&&(u>t?(d=o,c=i):(d=u,c=l)),!r)return[0,a*c,d];var x=Math.floor(a*c/d);return[x,a*c-x*d,d]}function us(e,t,r){if(e>2958465||e<0)return null;var a=e|0,s=Math.floor(86400*(e-a)),i=0,l=[],c={D:a,T:s,u:86400*(e-a)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(c.u)<1e-6&&(c.u=0),t&&t.date1904&&(a+=1462),c.u>.9999&&(c.u=0,++s==86400&&(c.T=s=0,++a,++c.D)),a===60)l=r?[1317,10,29]:[1900,2,29],i=3;else if(a===0)l=r?[1317,8,29]:[1900,1,0],i=6;else{a>60&&--a;var o=new Date(1900,0,1);o.setDate(o.getDate()+a-1),l=[o.getFullYear(),o.getMonth()+1,o.getDate()],i=o.getDay(),a<60&&(i=(i+6)%7),r&&(i=Jb(o,l))}return c.y=l[0],c.m=l[1],c.d=l[2],c.S=s%60,s=Math.floor(s/60),c.M=s%60,s=Math.floor(s/60),c.H=s,c.q=i,c}var k1=new Date(1899,11,31,0,0,0),Gb=k1.getTime(),Xb=new Date(1900,2,1,0,0,0);function _1(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=Xb&&(r+=24*60*60*1e3),(r-(Gb+(e.getTimezoneOffset()-k1.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Qu(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Kb(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Yb(e){var t=e<0?12:11,r=Qu(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function qb(e){var t=Qu(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function Al(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=Yb(e):t===10?r=e.toFixed(10).substr(0,12):r=qb(e),Qu(Kb(r.toUpperCase()))}function ks(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Al(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Dn(14,_1(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function Jb(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function Qb(e,t,r,a){var s="",i=0,l=0,c=r.y,o,u=0;switch(e){case 98:c=r.y+543;case 121:switch(t.length){case 1:case 2:o=c%100,u=2;break;default:o=c%1e4,u=4;break}break;case 109:switch(t.length){case 1:case 2:o=r.m,u=t.length;break;case 3:return T0[r.m-1][1];case 5:return T0[r.m-1][0];default:return T0[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:o=r.d,u=t.length;break;case 3:return Zx[r.q][0];default:return Zx[r.q][1]}break;case 104:switch(t.length){case 1:case 2:o=1+(r.H+11)%12,u=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:o=r.H,u=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:o=r.M,u=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Wn(r.S,t.length):(a>=2?l=a===3?1e3:100:l=a===1?10:1,i=Math.round(l*(r.S+r.u)),i>=60*l&&(i=0),t==="s"?i===0?"0":""+i/l:(s=Wn(i,2+a),t==="ss"?s.substr(0,2):"."+s.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":o=r.D*24+r.H;break;case"[m]":case"[mm]":o=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":o=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}u=t.length===3?1:2;break;case 101:o=c,u=1;break}var d=u>0?Wn(o,u):"";return d}function La(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,a=e.substr(0,r);r!=e.length;r+=t)a+=(a.length>0?",":"")+e.substr(r,t);return a}var S1=/%/g;function Zb(e,t,r){var a=t.replace(S1,""),s=t.length-a.length;return ma(e,a,r*Math.pow(10,2*s))+Xt("%",s)}function ew(e,t,r){for(var a=t.length-1;t.charCodeAt(a-1)===44;)--a;return ma(e,t.substr(0,a),r/Math.pow(10,3*(t.length-a)))}function C1(e,t){var r,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+C1(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%s;if(i<0&&(i+=s),r=(t/Math.pow(10,i)).toPrecision(a+1+(s+i)%s),r.indexOf("e")===-1){var l=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(l-r.length+i):r+="E+"+(l-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,s)+"."+r.substr(2+s),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,o,u,d){return o+u+d.substr(0,(s+i)%s)+"."+d.substr(i)+"E"})}else r=t.toExponential(a);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var E1=/# (\?+)( ?)\/( ?)(\d+)/;function tw(e,t,r){var a=parseInt(e[4],10),s=Math.round(t*a),i=Math.floor(s/a),l=s-i*a,c=a;return r+(i===0?"":""+i)+" "+(l===0?Xt(" ",e[1].length+1+e[4].length):Ju(l,e[1].length)+e[2]+"/"+e[3]+Wn(c,e[4].length))}function rw(e,t,r){return r+(t===0?"":""+t)+Xt(" ",e[1].length+2+e[4].length)}var T1=/^#*0*\.([0#]+)/,F1=/\).*[0#]/,A1=/\(###\) ###\\?-####/;function Wr(e){for(var t="",r,a=0;a!=e.length;++a)switch(r=e.charCodeAt(a)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function tm(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function rm(e,t){var r=e-Math.floor(e),a=Math.pow(10,t);return t<(""+Math.round(r*a)).length?0:Math.round(r*a)}function nw(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function aw(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function wn(e,t,r){if(e.charCodeAt(0)===40&&!t.match(F1)){var a=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?wn("n",a,r):"("+wn("n",a,-r)+")"}if(t.charCodeAt(t.length-1)===44)return ew(e,t,r);if(t.indexOf("%")!==-1)return Zb(e,t,r);if(t.indexOf("E")!==-1)return C1(t,r);if(t.charCodeAt(0)===36)return"$"+wn(e,t.substr(t.charAt(1)==" "?2:1),r);var s,i,l,c,o=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+Bs(o,t.length);if(t.match(/^[#?]+$/))return s=Bs(r,0),s==="0"&&(s=""),s.length>t.length?s:Wr(t.substr(0,t.length-s.length))+s;if(i=t.match(E1))return tw(i,o,u);if(t.match(/^#+0+$/))return u+Bs(o,t.length-t.indexOf("0"));if(i=t.match(T1))return s=tm(r,i[1].length).replace(/^([^\.]+)$/,"$1."+Wr(i[1])).replace(/\.$/,"."+Wr(i[1])).replace(/\.(\d*)$/,function(p,m){return"."+m+Xt("0",Wr(i[1]).length-m.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return u+tm(o,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return u+La(Bs(o,0));if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+wn(e,t,-r):La(""+(Math.floor(r)+nw(r,i[1].length)))+"."+Wn(rm(r,i[1].length),i[1].length);if(i=t.match(/^#,#*,#0/))return wn(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=ci(wn(e,t.replace(/[\\-]/g,""),r)),l=0,ci(ci(t.replace(/\\/g,"")).replace(/[0#]/g,function(p){return l<s.length?s.charAt(l++):p==="0"?"0":""}));if(t.match(A1))return s=wn(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var d="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(i[4].length,7),c=wo(o,Math.pow(10,l)-1,!1),s=""+u,d=ma("n",i[1],c[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),s+=d+i[2]+"/"+i[3],d=yo(c[2],l),d.length<i[4].length&&(d=Wr(i[4].substr(i[4].length-d.length))+d),s+=d,s;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(i[1].length,i[4].length),7),c=wo(o,Math.pow(10,l)-1,!0),u+(c[0]||(c[1]?"":"0"))+" "+(c[1]?Ju(c[1],l)+i[2]+"/"+i[3]+yo(c[2],l):Xt(" ",2*l+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return s=Bs(r,0),t.length<=s.length?s:Wr(t.substr(0,t.length-s.length))+s;if(i=t.match(/^([#0?]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),l=s.indexOf(".");var f=t.indexOf(".")-l,x=t.length-s.length-f;return Wr(t.substr(0,f)+s+t.substr(t.length-x))}if(i=t.match(/^00,000\.([#0]*0)$/))return l=rm(r,i[1].length),r<0?"-"+wn(e,t,-r):La(aw(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(p){return"00,"+(p.length<3?Wn(0,3-p.length):"")+p})+"."+Wn(l,i[1].length);switch(t){case"###,##0.00":return wn(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var h=La(Bs(o,0));return h!=="0"?u+h:"";case"###,###.00":return wn(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return wn(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function sw(e,t,r){for(var a=t.length-1;t.charCodeAt(a-1)===44;)--a;return ma(e,t.substr(0,a),r/Math.pow(10,3*(t.length-a)))}function iw(e,t,r){var a=t.replace(S1,""),s=t.length-a.length;return ma(e,a,r*Math.pow(10,2*s))+Xt("%",s)}function P1(e,t){var r,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+P1(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%s;if(i<0&&(i+=s),r=(t/Math.pow(10,i)).toPrecision(a+1+(s+i)%s),!r.match(/[Ee]/)){var l=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(l-r.length+i):r+="E+"+(l-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,o,u,d){return o+u+d.substr(0,(s+i)%s)+"."+d.substr(i)+"E"})}else r=t.toExponential(a);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Jn(e,t,r){if(e.charCodeAt(0)===40&&!t.match(F1)){var a=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Jn("n",a,r):"("+Jn("n",a,-r)+")"}if(t.charCodeAt(t.length-1)===44)return sw(e,t,r);if(t.indexOf("%")!==-1)return iw(e,t,r);if(t.indexOf("E")!==-1)return P1(t,r);if(t.charCodeAt(0)===36)return"$"+Jn(e,t.substr(t.charAt(1)==" "?2:1),r);var s,i,l,c,o=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+Wn(o,t.length);if(t.match(/^[#?]+$/))return s=""+r,r===0&&(s=""),s.length>t.length?s:Wr(t.substr(0,t.length-s.length))+s;if(i=t.match(E1))return rw(i,o,u);if(t.match(/^#+0+$/))return u+Wn(o,t.length-t.indexOf("0"));if(i=t.match(T1))return s=(""+r).replace(/^([^\.]+)$/,"$1."+Wr(i[1])).replace(/\.$/,"."+Wr(i[1])),s=s.replace(/\.(\d*)$/,function(p,m){return"."+m+Xt("0",Wr(i[1]).length-m.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return u+(""+o).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return u+La(""+o);if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Jn(e,t,-r):La(""+r)+"."+Xt("0",i[1].length);if(i=t.match(/^#,#*,#0/))return Jn(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=ci(Jn(e,t.replace(/[\\-]/g,""),r)),l=0,ci(ci(t.replace(/\\/g,"")).replace(/[0#]/g,function(p){return l<s.length?s.charAt(l++):p==="0"?"0":""}));if(t.match(A1))return s=Jn(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var d="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(i[4].length,7),c=wo(o,Math.pow(10,l)-1,!1),s=""+u,d=ma("n",i[1],c[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),s+=d+i[2]+"/"+i[3],d=yo(c[2],l),d.length<i[4].length&&(d=Wr(i[4].substr(i[4].length-d.length))+d),s+=d,s;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(i[1].length,i[4].length),7),c=wo(o,Math.pow(10,l)-1,!0),u+(c[0]||(c[1]?"":"0"))+" "+(c[1]?Ju(c[1],l)+i[2]+"/"+i[3]+yo(c[2],l):Xt(" ",2*l+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return s=""+r,t.length<=s.length?s:Wr(t.substr(0,t.length-s.length))+s;if(i=t.match(/^([#0]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),l=s.indexOf(".");var f=t.indexOf(".")-l,x=t.length-s.length-f;return Wr(t.substr(0,f)+s+t.substr(t.length-x))}if(i=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Jn(e,t,-r):La(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(p){return"00,"+(p.length<3?Wn(0,3-p.length):"")+p})+"."+Wn(0,i[1].length);switch(t){case"###,###":case"##,###":case"#,###":var h=La(""+o);return h!=="0"?u+h:"";default:if(t.match(/\.[0#?]*$/))return Jn(e,t.slice(0,t.lastIndexOf(".")),r)+Wr(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function ma(e,t,r){return(r|0)===r?Jn(e,t,r):wn(e,t,r)}function lw(e){for(var t=[],r=!1,a=0,s=0;a<e.length;++a)switch(e.charCodeAt(a)){case 34:r=!r;break;case 95:case 42:case 92:++a;break;case 59:t[t.length]=e.substr(s,a-s),s=a+1}if(t[t.length]=e.substr(s),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var D1=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Si(e){for(var t=0,r="",a="";t<e.length;)switch(r=e.charAt(t)){case"G":bo(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(a=r;e.charAt(t++)!=="]"&&t<e.length;)a+=e.charAt(t);if(a.match(D1))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function cw(e,t,r,a){for(var s=[],i="",l=0,c="",o="t",u,d,f,x="H";l<e.length;)switch(c=e.charAt(l)){case"G":if(!bo(e,l))throw new Error("unrecognized character "+c+" in "+e);s[s.length]={t:"G",v:"General"},l+=7;break;case'"':for(i="";(f=e.charCodeAt(++l))!==34&&l<e.length;)i+=String.fromCharCode(f);s[s.length]={t:"t",v:i},++l;break;case"\\":var h=e.charAt(++l),p=h==="("||h===")"?h:"t";s[s.length]={t:p,v:h},++l;break;case"_":s[s.length]={t:"t",v:" "},l+=2;break;case"@":s[s.length]={t:"T",v:t},++l;break;case"B":case"b":if(e.charAt(l+1)==="1"||e.charAt(l+1)==="2"){if(u==null&&(u=us(t,r,e.charAt(l+1)==="2"),u==null))return"";s[s.length]={t:"X",v:e.substr(l,2)},o=c,l+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":c=c.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||u==null&&(u=us(t,r),u==null))return"";for(i=c;++l<e.length&&e.charAt(l).toLowerCase()===c;)i+=c;c==="m"&&o.toLowerCase()==="h"&&(c="M"),c==="h"&&(c=x),s[s.length]={t:c,v:i},o=c;break;case"A":case"a":case"":var m={t:c,v:c};if(u==null&&(u=us(t,r)),e.substr(l,3).toUpperCase()==="A/P"?(u!=null&&(m.v=u.H>=12?"P":"A"),m.t="T",x="h",l+=3):e.substr(l,5).toUpperCase()==="AM/PM"?(u!=null&&(m.v=u.H>=12?"PM":"AM"),m.t="T",l+=5,x="h"):e.substr(l,5).toUpperCase()==="/"?(u!=null&&(m.v=u.H>=12?"":""),m.t="T",l+=5,x="h"):(m.t="t",++l),u==null&&m.t==="T")return"";s[s.length]=m,o=c;break;case"[":for(i=c;e.charAt(l++)!=="]"&&l<e.length;)i+=e.charAt(l);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(D1)){if(u==null&&(u=us(t,r),u==null))return"";s[s.length]={t:"Z",v:i.toLowerCase()},o=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",Si(e)||(s[s.length]={t:"t",v:i}));break;case".":if(u!=null){for(i=c;++l<e.length&&(c=e.charAt(l))==="0";)i+=c;s[s.length]={t:"s",v:i};break}case"0":case"#":for(i=c;++l<e.length&&"0#?.,E+-%".indexOf(c=e.charAt(l))>-1;)i+=c;s[s.length]={t:"n",v:i};break;case"?":for(i=c;e.charAt(++l)===c;)i+=c;s[s.length]={t:c,v:i},o=c;break;case"*":++l,(e.charAt(l)==" "||e.charAt(l)=="*")&&++l;break;case"(":case")":s[s.length]={t:a===1?"t":c,v:c},++l;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=c;l<e.length&&"0123456789".indexOf(e.charAt(++l))>-1;)i+=e.charAt(l);s[s.length]={t:"D",v:i};break;case" ":s[s.length]={t:c,v:c},++l;break;case"$":s[s.length]={t:"t",v:"$"},++l;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(c)===-1)throw new Error("unrecognized character "+c+" in "+e);s[s.length]={t:"t",v:c},++l;break}var w=0,v=0,b;for(l=s.length-1,o="t";l>=0;--l)switch(s[l].t){case"h":case"H":s[l].t=x,o="h",w<1&&(w=1);break;case"s":(b=s[l].v.match(/\.0+$/))&&(v=Math.max(v,b[0].length-1)),w<3&&(w=3);case"d":case"y":case"M":case"e":o=s[l].t;break;case"m":o==="s"&&(s[l].t="M",w<2&&(w=2));break;case"X":break;case"Z":w<1&&s[l].v.match(/[Hh]/)&&(w=1),w<2&&s[l].v.match(/[Mm]/)&&(w=2),w<3&&s[l].v.match(/[Ss]/)&&(w=3)}switch(w){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var y="",N;for(l=0;l<s.length;++l)switch(s[l].t){case"t":case"T":case" ":case"D":break;case"X":s[l].v="",s[l].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[l].v=Qb(s[l].t.charCodeAt(0),s[l].v,u,v),s[l].t="t";break;case"n":case"?":for(N=l+1;s[N]!=null&&((c=s[N].t)==="?"||c==="D"||(c===" "||c==="t")&&s[N+1]!=null&&(s[N+1].t==="?"||s[N+1].t==="t"&&s[N+1].v==="/")||s[l].t==="("&&(c===" "||c==="n"||c===")")||c==="t"&&(s[N].v==="/"||s[N].v===" "&&s[N+1]!=null&&s[N+1].t=="?"));)s[l].v+=s[N].v,s[N]={v:"",t:";"},++N;y+=s[l].v,l=N-1;break;case"G":s[l].t="t",s[l].v=ks(t,r);break}var A="",k,_;if(y.length>0){y.charCodeAt(0)==40?(k=t<0&&y.charCodeAt(0)===45?-t:t,_=ma("n",y,k)):(k=t<0&&a>1?-t:t,_=ma("n",y,k),k<0&&s[0]&&s[0].t=="t"&&(_=_.substr(1),s[0].v="-"+s[0].v)),N=_.length-1;var j=s.length;for(l=0;l<s.length;++l)if(s[l]!=null&&s[l].t!="t"&&s[l].v.indexOf(".")>-1){j=l;break}var P=s.length;if(j===s.length&&_.indexOf("E")===-1){for(l=s.length-1;l>=0;--l)s[l]==null||"n?".indexOf(s[l].t)===-1||(N>=s[l].v.length-1?(N-=s[l].v.length,s[l].v=_.substr(N+1,s[l].v.length)):N<0?s[l].v="":(s[l].v=_.substr(0,N+1),N=-1),s[l].t="t",P=l);N>=0&&P<s.length&&(s[P].v=_.substr(0,N+1)+s[P].v)}else if(j!==s.length&&_.indexOf("E")===-1){for(N=_.indexOf(".")-1,l=j;l>=0;--l)if(!(s[l]==null||"n?".indexOf(s[l].t)===-1)){for(d=s[l].v.indexOf(".")>-1&&l===j?s[l].v.indexOf(".")-1:s[l].v.length-1,A=s[l].v.substr(d+1);d>=0;--d)N>=0&&(s[l].v.charAt(d)==="0"||s[l].v.charAt(d)==="#")&&(A=_.charAt(N--)+A);s[l].v=A,s[l].t="t",P=l}for(N>=0&&P<s.length&&(s[P].v=_.substr(0,N+1)+s[P].v),N=_.indexOf(".")+1,l=j;l<s.length;++l)if(!(s[l]==null||"n?(".indexOf(s[l].t)===-1&&l!==j)){for(d=s[l].v.indexOf(".")>-1&&l===j?s[l].v.indexOf(".")+1:0,A=s[l].v.substr(0,d);d<s[l].v.length;++d)N<_.length&&(A+=_.charAt(N++));s[l].v=A,s[l].t="t",P=l}}}for(l=0;l<s.length;++l)s[l]!=null&&"n?".indexOf(s[l].t)>-1&&(k=a>1&&t<0&&l>0&&s[l-1].v==="-"?-t:t,s[l].v=ma(s[l].t,s[l].v,k),s[l].t="t");var D="";for(l=0;l!==s.length;++l)s[l]!=null&&(D+=s[l].v);return D}var nm=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function am(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function ow(e,t){var r=lw(e),a=r.length,s=r[a-1].indexOf("@");if(a<4&&s>-1&&--a,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||s>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=s>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=s>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=s>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[a,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var l=r[0].match(nm),c=r[1].match(nm);return am(t,l)?[a,r[0]]:am(t,c)?[a,r[1]]:[a,r[l!=null&&c!=null?2:1]]}return[a,i]}function Dn(e,t,r){r==null&&(r={});var a="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?a=r.dateNF:a=e;break;case"number":e==14&&r.dateNF?a=r.dateNF:a=(r.table!=null?r.table:Xe)[e],a==null&&(a=r.table&&r.table[em[e]]||Xe[em[e]]),a==null&&(a=Vb[e]||"General");break}if(bo(a,0))return ks(t,r);t instanceof Date&&(t=_1(t,r.date1904));var s=ow(a,t);if(bo(s[1]))return ks(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return cw(s[1],t,r,s[0])}function ha(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(Xe[r]==null){t<0&&(t=r);continue}if(Xe[r]==e){t=r;break}}t<0&&(t=391)}return Xe[t]=e,t}function Ko(e){for(var t=0;t!=392;++t)e[t]!==void 0&&ha(e[t],t)}function Ci(){Xe=$b()}var dw={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},I1=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function uw(e){var t=typeof e=="number"?Xe[e]:e;return t=t.replace(I1,"(\\d+)"),new RegExp("^"+t+"$")}function fw(e,t,r){var a=-1,s=-1,i=-1,l=-1,c=-1,o=-1;(t.match(I1)||[]).forEach(function(f,x){var h=parseInt(r[x+1],10);switch(f.toLowerCase().charAt(0)){case"y":a=h;break;case"d":i=h;break;case"h":l=h;break;case"s":o=h;break;case"m":l>=0?c=h:s=h;break}}),o>=0&&c==-1&&s>=0&&(c=s,s=-1);var u=(""+(a>=0?a:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var d=("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2);return l==-1&&c==-1&&o==-1?u:a==-1&&s==-1&&i==-1?d:u+"T"+d}var xw=function(){var e={};e.version="1.2.0";function t(){for(var _=0,j=new Array(256),P=0;P!=256;++P)_=P,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,j[P]=_;return typeof Int32Array<"u"?new Int32Array(j):j}var r=t();function a(_){var j=0,P=0,D=0,K=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(D=0;D!=256;++D)K[D]=_[D];for(D=0;D!=256;++D)for(P=_[D],j=256+D;j<4096;j+=256)P=K[j]=P>>>8^_[P&255];var E=[];for(D=1;D!=16;++D)E[D-1]=typeof Int32Array<"u"?K.subarray(D*256,D*256+256):K.slice(D*256,D*256+256);return E}var s=a(r),i=s[0],l=s[1],c=s[2],o=s[3],u=s[4],d=s[5],f=s[6],x=s[7],h=s[8],p=s[9],m=s[10],w=s[11],v=s[12],b=s[13],y=s[14];function N(_,j){for(var P=j^-1,D=0,K=_.length;D<K;)P=P>>>8^r[(P^_.charCodeAt(D++))&255];return~P}function A(_,j){for(var P=j^-1,D=_.length-15,K=0;K<D;)P=y[_[K++]^P&255]^b[_[K++]^P>>8&255]^v[_[K++]^P>>16&255]^w[_[K++]^P>>>24]^m[_[K++]]^p[_[K++]]^h[_[K++]]^x[_[K++]]^f[_[K++]]^d[_[K++]]^u[_[K++]]^o[_[K++]]^c[_[K++]]^l[_[K++]]^i[_[K++]]^r[_[K++]];for(D+=15;K<D;)P=P>>>8^r[(P^_[K++])&255];return~P}function k(_,j){for(var P=j^-1,D=0,K=_.length,E=0,Y=0;D<K;)E=_.charCodeAt(D++),E<128?P=P>>>8^r[(P^E)&255]:E<2048?(P=P>>>8^r[(P^(192|E>>6&31))&255],P=P>>>8^r[(P^(128|E&63))&255]):E>=55296&&E<57344?(E=(E&1023)+64,Y=_.charCodeAt(D++)&1023,P=P>>>8^r[(P^(240|E>>8&7))&255],P=P>>>8^r[(P^(128|E>>2&63))&255],P=P>>>8^r[(P^(128|Y>>6&15|(E&3)<<4))&255],P=P>>>8^r[(P^(128|Y&63))&255]):(P=P>>>8^r[(P^(224|E>>12&15))&255],P=P>>>8^r[(P^(128|E>>6&63))&255],P=P>>>8^r[(P^(128|E&63))&255]);return~P}return e.table=r,e.bstr=N,e.buf=A,e.str=k,e}(),$e=function(){var t={};t.version="1.2.1";function r(C,U){for(var I=C.split("/"),L=U.split("/"),V=0,X=0,le=Math.min(I.length,L.length);V<le;++V){if(X=I[V].length-L[V].length)return X;if(I[V]!=L[V])return I[V]<L[V]?-1:1}return I.length-L.length}function a(C){if(C.charAt(C.length-1)=="/")return C.slice(0,-1).indexOf("/")===-1?C:a(C.slice(0,-1));var U=C.lastIndexOf("/");return U===-1?C:C.slice(0,U+1)}function s(C){if(C.charAt(C.length-1)=="/")return s(C.slice(0,-1));var U=C.lastIndexOf("/");return U===-1?C:C.slice(U+1)}function i(C,U){typeof U=="string"&&(U=new Date(U));var I=U.getHours();I=I<<6|U.getMinutes(),I=I<<5|U.getSeconds()>>>1,C.write_shift(2,I);var L=U.getFullYear()-1980;L=L<<4|U.getMonth()+1,L=L<<5|U.getDate(),C.write_shift(2,L)}function l(C){var U=C.read_shift(2)&65535,I=C.read_shift(2)&65535,L=new Date,V=I&31;I>>>=5;var X=I&15;I>>>=4,L.setMilliseconds(0),L.setFullYear(I+1980),L.setMonth(X-1),L.setDate(V);var le=U&31;U>>>=5;var ge=U&63;return U>>>=6,L.setHours(U),L.setMinutes(ge),L.setSeconds(le<<1),L}function c(C){wr(C,0);for(var U={},I=0;C.l<=C.length-4;){var L=C.read_shift(2),V=C.read_shift(2),X=C.l+V,le={};switch(L){case 21589:I=C.read_shift(1),I&1&&(le.mtime=C.read_shift(4)),V>5&&(I&2&&(le.atime=C.read_shift(4)),I&4&&(le.ctime=C.read_shift(4))),le.mtime&&(le.mt=new Date(le.mtime*1e3));break}C.l=X,U[L]=le}return U}var o;function u(){return o||(o={})}function d(C,U){if(C[0]==80&&C[1]==75)return an(C,U);if((C[0]|32)==109&&(C[1]|32)==105)return qt(C,U);if(C.length<512)throw new Error("CFB file size "+C.length+" < 512");var I=3,L=512,V=0,X=0,le=0,ge=0,ie=0,ce=[],de=C.slice(0,512);wr(de,0);var _e=f(de);switch(I=_e[0],I){case 3:L=512;break;case 4:L=4096;break;case 0:if(_e[1]==0)return an(C,U);default:throw new Error("Major Version: Expected 3 or 4 saw "+I)}L!==512&&(de=C.slice(0,L),wr(de,28));var Ce=C.slice(0,L);x(de,I);var W=de.read_shift(4,"i");if(I===3&&W!==0)throw new Error("# Directory Sectors: Expected 0 saw "+W);de.l+=4,le=de.read_shift(4,"i"),de.l+=4,de.chk("00100000","Mini Stream Cutoff Size: "),ge=de.read_shift(4,"i"),V=de.read_shift(4,"i"),ie=de.read_shift(4,"i"),X=de.read_shift(4,"i");for(var q=-1,J=0;J<109&&(q=de.read_shift(4,"i"),!(q<0));++J)ce[J]=q;var fe=h(C,L);w(ie,X,fe,L,ce);var be=b(fe,le,ce,L);be[le].name="!Directory",V>0&&ge!==Y&&(be[ge].name="!MiniFAT"),be[ce[0]].name="!FAT",be.fat_addrs=ce,be.ssz=L;var Re={},G=[],Ne=[],Te=[];y(le,be,fe,G,V,Re,Ne,ge),p(Ne,Te,G),G.shift();var we={FileIndex:Ne,FullPaths:Te};return U&&U.raw&&(we.raw={header:Ce,sectors:fe}),we}function f(C){if(C[C.l]==80&&C[C.l+1]==75)return[0,0];C.chk(B,"Header Signature: "),C.l+=16;var U=C.read_shift(2,"u");return[C.read_shift(2,"u"),U]}function x(C,U){var I=9;switch(C.l+=2,I=C.read_shift(2)){case 9:if(U!=3)throw new Error("Sector Shift: Expected 9 saw "+I);break;case 12:if(U!=4)throw new Error("Sector Shift: Expected 12 saw "+I);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+I)}C.chk("0600","Mini Sector Shift: "),C.chk("000000000000","Reserved: ")}function h(C,U){for(var I=Math.ceil(C.length/U)-1,L=[],V=1;V<I;++V)L[V-1]=C.slice(V*U,(V+1)*U);return L[I-1]=C.slice(I*U),L}function p(C,U,I){for(var L=0,V=0,X=0,le=0,ge=0,ie=I.length,ce=[],de=[];L<ie;++L)ce[L]=de[L]=L,U[L]=I[L];for(;ge<de.length;++ge)L=de[ge],V=C[L].L,X=C[L].R,le=C[L].C,ce[L]===L&&(V!==-1&&ce[V]!==V&&(ce[L]=ce[V]),X!==-1&&ce[X]!==X&&(ce[L]=ce[X])),le!==-1&&(ce[le]=L),V!==-1&&L!=ce[L]&&(ce[V]=ce[L],de.lastIndexOf(V)<ge&&de.push(V)),X!==-1&&L!=ce[L]&&(ce[X]=ce[L],de.lastIndexOf(X)<ge&&de.push(X));for(L=1;L<ie;++L)ce[L]===L&&(X!==-1&&ce[X]!==X?ce[L]=ce[X]:V!==-1&&ce[V]!==V&&(ce[L]=ce[V]));for(L=1;L<ie;++L)if(C[L].type!==0){if(ge=L,ge!=ce[ge])do ge=ce[ge],U[L]=U[ge]+"/"+U[L];while(ge!==0&&ce[ge]!==-1&&ge!=ce[ge]);ce[L]=-1}for(U[0]+="/",L=1;L<ie;++L)C[L].type!==2&&(U[L]+="/")}function m(C,U,I){for(var L=C.start,V=C.size,X=[],le=L;I&&V>0&&le>=0;)X.push(U.slice(le*E,le*E+E)),V-=E,le=ls(I,le*4);return X.length===0?ye(0):mr(X).slice(0,C.size)}function w(C,U,I,L,V){var X=Y;if(C===Y){if(U!==0)throw new Error("DIFAT chain shorter than expected")}else if(C!==-1){var le=I[C],ge=(L>>>2)-1;if(!le)return;for(var ie=0;ie<ge&&(X=ls(le,ie*4))!==Y;++ie)V.push(X);w(ls(le,L-4),U-1,I,L,V)}}function v(C,U,I,L,V){var X=[],le=[];V||(V=[]);var ge=L-1,ie=0,ce=0;for(ie=U;ie>=0;){V[ie]=!0,X[X.length]=ie,le.push(C[ie]);var de=I[Math.floor(ie*4/L)];if(ce=ie*4&ge,L<4+ce)throw new Error("FAT boundary crossed: "+ie+" 4 "+L);if(!C[de])break;ie=ls(C[de],ce)}return{nodes:X,data:pm([le])}}function b(C,U,I,L){var V=C.length,X=[],le=[],ge=[],ie=[],ce=L-1,de=0,_e=0,Ce=0,W=0;for(de=0;de<V;++de)if(ge=[],Ce=de+U,Ce>=V&&(Ce-=V),!le[Ce]){ie=[];var q=[];for(_e=Ce;_e>=0;){q[_e]=!0,le[_e]=!0,ge[ge.length]=_e,ie.push(C[_e]);var J=I[Math.floor(_e*4/L)];if(W=_e*4&ce,L<4+W)throw new Error("FAT boundary crossed: "+_e+" 4 "+L);if(!C[J]||(_e=ls(C[J],W),q[_e]))break}X[Ce]={nodes:ge,data:pm([ie])}}return X}function y(C,U,I,L,V,X,le,ge){for(var ie=0,ce=L.length?2:0,de=U[C].data,_e=0,Ce=0,W;_e<de.length;_e+=128){var q=de.slice(_e,_e+128);wr(q,64),Ce=q.read_shift(2),W=sf(q,0,Ce-ce),L.push(W);var J={name:W,type:q.read_shift(1),color:q.read_shift(1),L:q.read_shift(4,"i"),R:q.read_shift(4,"i"),C:q.read_shift(4,"i"),clsid:q.read_shift(16),state:q.read_shift(4,"i"),start:0,size:0},fe=q.read_shift(2)+q.read_shift(2)+q.read_shift(2)+q.read_shift(2);fe!==0&&(J.ct=N(q,q.l-8));var be=q.read_shift(2)+q.read_shift(2)+q.read_shift(2)+q.read_shift(2);be!==0&&(J.mt=N(q,q.l-8)),J.start=q.read_shift(4,"i"),J.size=q.read_shift(4,"i"),J.size<0&&J.start<0&&(J.size=J.type=0,J.start=Y,J.name=""),J.type===5?(ie=J.start,V>0&&ie!==Y&&(U[ie].name="!StreamData")):J.size>=4096?(J.storage="fat",U[J.start]===void 0&&(U[J.start]=v(I,J.start,U.fat_addrs,U.ssz)),U[J.start].name=J.name,J.content=U[J.start].data.slice(0,J.size)):(J.storage="minifat",J.size<0?J.size=0:ie!==Y&&J.start!==Y&&U[ie]&&(J.content=m(J,U[ie].data,(U[ge]||{}).data))),J.content&&wr(J.content,0),X[W]=J,le.push(J)}}function N(C,U){return new Date((un(C,U+4)/1e7*Math.pow(2,32)+un(C,U)/1e7-11644473600)*1e3)}function A(C,U){return u(),d(o.readFileSync(C),U)}function k(C,U){var I=U&&U.type;switch(I||at&&Buffer.isBuffer(C)&&(I="buffer"),I||"base64"){case"file":return A(C,U);case"base64":return d(fn(gn(C)),U);case"binary":return d(fn(C),U)}return d(C,U)}function _(C,U){var I=U||{},L=I.root||"Root Entry";if(C.FullPaths||(C.FullPaths=[]),C.FileIndex||(C.FileIndex=[]),C.FullPaths.length!==C.FileIndex.length)throw new Error("inconsistent CFB structure");C.FullPaths.length===0&&(C.FullPaths[0]=L+"/",C.FileIndex[0]={name:L,type:5}),I.CLSID&&(C.FileIndex[0].clsid=I.CLSID),j(C)}function j(C){var U="Sh33tJ5";if(!$e.find(C,"/"+U)){var I=ye(4);I[0]=55,I[1]=I[3]=50,I[2]=54,C.FileIndex.push({name:U,type:2,content:I,size:4,L:69,R:69,C:69}),C.FullPaths.push(C.FullPaths[0]+U),P(C)}}function P(C,U){_(C);for(var I=!1,L=!1,V=C.FullPaths.length-1;V>=0;--V){var X=C.FileIndex[V];switch(X.type){case 0:L?I=!0:(C.FileIndex.pop(),C.FullPaths.pop());break;case 1:case 2:case 5:L=!0,isNaN(X.R*X.L*X.C)&&(I=!0),X.R>-1&&X.L>-1&&X.R==X.L&&(I=!0);break;default:I=!0;break}}if(!(!I&&!U)){var le=new Date(1987,1,19),ge=0,ie=Object.create?Object.create(null):{},ce=[];for(V=0;V<C.FullPaths.length;++V)ie[C.FullPaths[V]]=!0,C.FileIndex[V].type!==0&&ce.push([C.FullPaths[V],C.FileIndex[V]]);for(V=0;V<ce.length;++V){var de=a(ce[V][0]);L=ie[de],L||(ce.push([de,{name:s(de).replace("/",""),type:1,clsid:re,ct:le,mt:le,content:null}]),ie[de]=!0)}for(ce.sort(function(W,q){return r(W[0],q[0])}),C.FullPaths=[],C.FileIndex=[],V=0;V<ce.length;++V)C.FullPaths[V]=ce[V][0],C.FileIndex[V]=ce[V][1];for(V=0;V<ce.length;++V){var _e=C.FileIndex[V],Ce=C.FullPaths[V];if(_e.name=s(Ce).replace("/",""),_e.L=_e.R=_e.C=-(_e.color=1),_e.size=_e.content?_e.content.length:0,_e.start=0,_e.clsid=_e.clsid||re,V===0)_e.C=ce.length>1?1:-1,_e.size=0,_e.type=5;else if(Ce.slice(-1)=="/"){for(ge=V+1;ge<ce.length&&a(C.FullPaths[ge])!=Ce;++ge);for(_e.C=ge>=ce.length?-1:ge,ge=V+1;ge<ce.length&&a(C.FullPaths[ge])!=a(Ce);++ge);_e.R=ge>=ce.length?-1:ge,_e.type=1}else a(C.FullPaths[V+1]||"")==a(Ce)&&(_e.R=V+1),_e.type=2}}}function D(C,U){var I=U||{};if(I.fileType=="mad")return tr(C,I);switch(P(C),I.fileType){case"zip":return gr(C,I)}var L=function(W){for(var q=0,J=0,fe=0;fe<W.FileIndex.length;++fe){var be=W.FileIndex[fe];if(be.content){var Re=be.content.length;Re>0&&(Re<4096?q+=Re+63>>6:J+=Re+511>>9)}}for(var G=W.FullPaths.length+3>>2,Ne=q+7>>3,Te=q+127>>7,we=Ne+J+G+Te,ut=we+127>>7,vt=ut<=109?0:Math.ceil((ut-109)/127);we+ut+vt+127>>7>ut;)vt=++ut<=109?0:Math.ceil((ut-109)/127);var _t=[1,vt,ut,Te,G,J,q,0];return W.FileIndex[0].size=q<<6,_t[7]=(W.FileIndex[0].start=_t[0]+_t[1]+_t[2]+_t[3]+_t[4]+_t[5])+(_t[6]+7>>3),_t}(C),V=ye(L[7]<<9),X=0,le=0;{for(X=0;X<8;++X)V.write_shift(1,te[X]);for(X=0;X<8;++X)V.write_shift(2,0);for(V.write_shift(2,62),V.write_shift(2,3),V.write_shift(2,65534),V.write_shift(2,9),V.write_shift(2,6),X=0;X<3;++X)V.write_shift(2,0);for(V.write_shift(4,0),V.write_shift(4,L[2]),V.write_shift(4,L[0]+L[1]+L[2]+L[3]-1),V.write_shift(4,0),V.write_shift(4,4096),V.write_shift(4,L[3]?L[0]+L[1]+L[2]-1:Y),V.write_shift(4,L[3]),V.write_shift(-4,L[1]?L[0]-1:Y),V.write_shift(4,L[1]),X=0;X<109;++X)V.write_shift(-4,X<L[2]?L[1]+X:-1)}if(L[1])for(le=0;le<L[1];++le){for(;X<236+le*127;++X)V.write_shift(-4,X<L[2]?L[1]+X:-1);V.write_shift(-4,le===L[1]-1?Y:le+1)}var ge=function(W){for(le+=W;X<le-1;++X)V.write_shift(-4,X+1);W&&(++X,V.write_shift(-4,Y))};for(le=X=0,le+=L[1];X<le;++X)V.write_shift(-4,Q.DIFSECT);for(le+=L[2];X<le;++X)V.write_shift(-4,Q.FATSECT);ge(L[3]),ge(L[4]);for(var ie=0,ce=0,de=C.FileIndex[0];ie<C.FileIndex.length;++ie)de=C.FileIndex[ie],de.content&&(ce=de.content.length,!(ce<4096)&&(de.start=le,ge(ce+511>>9)));for(ge(L[6]+7>>3);V.l&511;)V.write_shift(-4,Q.ENDOFCHAIN);for(le=X=0,ie=0;ie<C.FileIndex.length;++ie)de=C.FileIndex[ie],de.content&&(ce=de.content.length,!(!ce||ce>=4096)&&(de.start=le,ge(ce+63>>6)));for(;V.l&511;)V.write_shift(-4,Q.ENDOFCHAIN);for(X=0;X<L[4]<<2;++X){var _e=C.FullPaths[X];if(!_e||_e.length===0){for(ie=0;ie<17;++ie)V.write_shift(4,0);for(ie=0;ie<3;++ie)V.write_shift(4,-1);for(ie=0;ie<12;++ie)V.write_shift(4,0);continue}de=C.FileIndex[X],X===0&&(de.start=de.size?de.start-1:Y);var Ce=X===0&&I.root||de.name;if(ce=2*(Ce.length+1),V.write_shift(64,Ce,"utf16le"),V.write_shift(2,ce),V.write_shift(1,de.type),V.write_shift(1,de.color),V.write_shift(-4,de.L),V.write_shift(-4,de.R),V.write_shift(-4,de.C),de.clsid)V.write_shift(16,de.clsid,"hex");else for(ie=0;ie<4;++ie)V.write_shift(4,0);V.write_shift(4,de.state||0),V.write_shift(4,0),V.write_shift(4,0),V.write_shift(4,0),V.write_shift(4,0),V.write_shift(4,de.start),V.write_shift(4,de.size),V.write_shift(4,0)}for(X=1;X<C.FileIndex.length;++X)if(de=C.FileIndex[X],de.size>=4096)if(V.l=de.start+1<<9,at&&Buffer.isBuffer(de.content))de.content.copy(V,V.l,0,de.size),V.l+=de.size+511&-512;else{for(ie=0;ie<de.size;++ie)V.write_shift(1,de.content[ie]);for(;ie&511;++ie)V.write_shift(1,0)}for(X=1;X<C.FileIndex.length;++X)if(de=C.FileIndex[X],de.size>0&&de.size<4096)if(at&&Buffer.isBuffer(de.content))de.content.copy(V,V.l,0,de.size),V.l+=de.size+63&-64;else{for(ie=0;ie<de.size;++ie)V.write_shift(1,de.content[ie]);for(;ie&63;++ie)V.write_shift(1,0)}if(at)V.l=V.length;else for(;V.l<V.length;)V.write_shift(1,0);return V}function K(C,U){var I=C.FullPaths.map(function(ie){return ie.toUpperCase()}),L=I.map(function(ie){var ce=ie.split("/");return ce[ce.length-(ie.slice(-1)=="/"?2:1)]}),V=!1;U.charCodeAt(0)===47?(V=!0,U=I[0].slice(0,-1)+U):V=U.indexOf("/")!==-1;var X=U.toUpperCase(),le=V===!0?I.indexOf(X):L.indexOf(X);if(le!==-1)return C.FileIndex[le];var ge=!X.match(Vi);for(X=X.replace(Vr,""),ge&&(X=X.replace(Vi,"!")),le=0;le<I.length;++le)if((ge?I[le].replace(Vi,"!"):I[le]).replace(Vr,"")==X||(ge?L[le].replace(Vi,"!"):L[le]).replace(Vr,"")==X)return C.FileIndex[le];return null}var E=64,Y=-2,B="d0cf11e0a1b11ae1",te=[208,207,17,224,161,177,26,225],re="00000000000000000000000000000000",Q={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:Y,FREESECT:-1,HEADER_SIGNATURE:B,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:re,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Z(C,U,I){u();var L=D(C,I);o.writeFileSync(U,L)}function z(C){for(var U=new Array(C.length),I=0;I<C.length;++I)U[I]=String.fromCharCode(C[I]);return U.join("")}function ne(C,U){var I=D(C,U);switch(U&&U.type||"buffer"){case"file":return u(),o.writeFileSync(U.filename,I),I;case"binary":return typeof I=="string"?I:z(I);case"base64":return Fl(typeof I=="string"?I:z(I));case"buffer":if(at)return Buffer.isBuffer(I)?I:ja(I);case"array":return typeof I=="string"?fn(I):I}return I}var xe;function O(C){try{var U=C.InflateRaw,I=new U;if(I._processChunk(new Uint8Array([3,0]),I._finishFlushFlag),I.bytesRead)xe=C;else throw new Error("zlib does not expose bytesRead")}catch(L){console.error("cannot use native zlib: "+(L.message||L))}}function R(C,U){if(!xe)return kt(C,U);var I=xe.InflateRaw,L=new I,V=L._processChunk(C.slice(C.l),L._finishFlushFlag);return C.l+=L.bytesRead,V}function g(C){return xe?xe.deflateRawSync(C):Ge(C)}var S=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],F=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ae=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ue(C){var U=(C<<1|C<<11)&139536|(C<<5|C<<15)&558144;return(U>>16|U>>8|U)&255}for(var ve=typeof Uint8Array<"u",me=ve?new Uint8Array(256):[],H=0;H<256;++H)me[H]=ue(H);function T(C,U){var I=me[C&255];return U<=8?I>>>8-U:(I=I<<8|me[C>>8&255],U<=16?I>>>16-U:(I=I<<8|me[C>>16&255],I>>>24-U))}function je(C,U){var I=U&7,L=U>>>3;return(C[L]|(I<=6?0:C[L+1]<<8))>>>I&3}function pe(C,U){var I=U&7,L=U>>>3;return(C[L]|(I<=5?0:C[L+1]<<8))>>>I&7}function Le(C,U){var I=U&7,L=U>>>3;return(C[L]|(I<=4?0:C[L+1]<<8))>>>I&15}function Se(C,U){var I=U&7,L=U>>>3;return(C[L]|(I<=3?0:C[L+1]<<8))>>>I&31}function he(C,U){var I=U&7,L=U>>>3;return(C[L]|(I<=1?0:C[L+1]<<8))>>>I&127}function oe(C,U,I){var L=U&7,V=U>>>3,X=(1<<I)-1,le=C[V]>>>L;return I<8-L||(le|=C[V+1]<<8-L,I<16-L)||(le|=C[V+2]<<16-L,I<24-L)||(le|=C[V+3]<<24-L),le&X}function De(C,U,I){var L=U&7,V=U>>>3;return L<=5?C[V]|=(I&7)<<L:(C[V]|=I<<L&255,C[V+1]=(I&7)>>8-L),U+3}function Me(C,U,I){var L=U&7,V=U>>>3;return I=(I&1)<<L,C[V]|=I,U+1}function Ie(C,U,I){var L=U&7,V=U>>>3;return I<<=L,C[V]|=I&255,I>>>=8,C[V+1]=I,U+8}function Oe(C,U,I){var L=U&7,V=U>>>3;return I<<=L,C[V]|=I&255,I>>>=8,C[V+1]=I&255,C[V+2]=I>>>8,U+16}function He(C,U){var I=C.length,L=2*I>U?2*I:U+5,V=0;if(I>=U)return C;if(at){var X=Jx(L);if(C.copy)C.copy(X);else for(;V<C.length;++V)X[V]=C[V];return X}else if(ve){var le=new Uint8Array(L);if(le.set)le.set(C);else for(;V<I;++V)le[V]=C[V];return le}return C.length=L,C}function Ze(C){for(var U=new Array(C),I=0;I<C;++I)U[I]=0;return U}function pt(C,U,I){var L=1,V=0,X=0,le=0,ge=0,ie=C.length,ce=ve?new Uint16Array(32):Ze(32);for(X=0;X<32;++X)ce[X]=0;for(X=ie;X<I;++X)C[X]=0;ie=C.length;var de=ve?new Uint16Array(ie):Ze(ie);for(X=0;X<ie;++X)ce[V=C[X]]++,L<V&&(L=V),de[X]=0;for(ce[0]=0,X=1;X<=L;++X)ce[X+16]=ge=ge+ce[X-1]<<1;for(X=0;X<ie;++X)ge=C[X],ge!=0&&(de[X]=ce[ge+16]++);var _e=0;for(X=0;X<ie;++X)if(_e=C[X],_e!=0)for(ge=T(de[X],L)>>L-_e,le=(1<<L+4-_e)-1;le>=0;--le)U[ge|le<<_e]=_e&15|X<<4;return L}var Bt=ve?new Uint16Array(512):Ze(512),nt=ve?new Uint16Array(32):Ze(32);if(!ve){for(var gt=0;gt<512;++gt)Bt[gt]=0;for(gt=0;gt<32;++gt)nt[gt]=0}(function(){for(var C=[],U=0;U<32;U++)C.push(5);pt(C,nt,32);var I=[];for(U=0;U<=143;U++)I.push(8);for(;U<=255;U++)I.push(9);for(;U<=279;U++)I.push(7);for(;U<=287;U++)I.push(8);pt(I,Bt,288)})();var Ut=function(){for(var U=ve?new Uint8Array(32768):[],I=0,L=0;I<ae.length-1;++I)for(;L<ae[I+1];++L)U[L]=I;for(;L<32768;++L)U[L]=29;var V=ve?new Uint8Array(259):[];for(I=0,L=0;I<F.length-1;++I)for(;L<F[I+1];++L)V[L]=I;function X(ge,ie){for(var ce=0;ce<ge.length;){var de=Math.min(65535,ge.length-ce),_e=ce+de==ge.length;for(ie.write_shift(1,+_e),ie.write_shift(2,de),ie.write_shift(2,~de&65535);de-- >0;)ie[ie.l++]=ge[ce++]}return ie.l}function le(ge,ie){for(var ce=0,de=0,_e=ve?new Uint16Array(32768):[];de<ge.length;){var Ce=Math.min(65535,ge.length-de);if(Ce<10){for(ce=De(ie,ce,+(de+Ce==ge.length)),ce&7&&(ce+=8-(ce&7)),ie.l=ce/8|0,ie.write_shift(2,Ce),ie.write_shift(2,~Ce&65535);Ce-- >0;)ie[ie.l++]=ge[de++];ce=ie.l*8;continue}ce=De(ie,ce,+(de+Ce==ge.length)+2);for(var W=0;Ce-- >0;){var q=ge[de];W=(W<<5^q)&32767;var J=-1,fe=0;if((J=_e[W])&&(J|=de&-32768,J>de&&(J-=32768),J<de))for(;ge[J+fe]==ge[de+fe]&&fe<250;)++fe;if(fe>2){q=V[fe],q<=22?ce=Ie(ie,ce,me[q+1]>>1)-1:(Ie(ie,ce,3),ce+=5,Ie(ie,ce,me[q-23]>>5),ce+=3);var be=q<8?0:q-4>>2;be>0&&(Oe(ie,ce,fe-F[q]),ce+=be),q=U[de-J],ce=Ie(ie,ce,me[q]>>3),ce-=3;var Re=q<4?0:q-2>>1;Re>0&&(Oe(ie,ce,de-J-ae[q]),ce+=Re);for(var G=0;G<fe;++G)_e[W]=de&32767,W=(W<<5^ge[de])&32767,++de;Ce-=fe-1}else q<=143?q=q+48:ce=Me(ie,ce,1),ce=Ie(ie,ce,me[q]),_e[W]=de&32767,++de}ce=Ie(ie,ce,0)-1}return ie.l=(ce+7)/8|0,ie.l}return function(ie,ce){return ie.length<8?X(ie,ce):le(ie,ce)}}();function Ge(C){var U=ye(50+Math.floor(C.length*1.1)),I=Ut(C,U);return U.slice(0,I)}var dt=ve?new Uint16Array(32768):Ze(32768),rt=ve?new Uint16Array(32768):Ze(32768),ot=ve?new Uint16Array(128):Ze(128),ir=1,se=1;function ze(C,U){var I=Se(C,U)+257;U+=5;var L=Se(C,U)+1;U+=5;var V=Le(C,U)+4;U+=4;for(var X=0,le=ve?new Uint8Array(19):Ze(19),ge=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ie=1,ce=ve?new Uint8Array(8):Ze(8),de=ve?new Uint8Array(8):Ze(8),_e=le.length,Ce=0;Ce<V;++Ce)le[S[Ce]]=X=pe(C,U),ie<X&&(ie=X),ce[X]++,U+=3;var W=0;for(ce[0]=0,Ce=1;Ce<=ie;++Ce)de[Ce]=W=W+ce[Ce-1]<<1;for(Ce=0;Ce<_e;++Ce)(W=le[Ce])!=0&&(ge[Ce]=de[W]++);var q=0;for(Ce=0;Ce<_e;++Ce)if(q=le[Ce],q!=0){W=me[ge[Ce]]>>8-q;for(var J=(1<<7-q)-1;J>=0;--J)ot[W|J<<q]=q&7|Ce<<3}var fe=[];for(ie=1;fe.length<I+L;)switch(W=ot[he(C,U)],U+=W&7,W>>>=3){case 16:for(X=3+je(C,U),U+=2,W=fe[fe.length-1];X-- >0;)fe.push(W);break;case 17:for(X=3+pe(C,U),U+=3;X-- >0;)fe.push(0);break;case 18:for(X=11+he(C,U),U+=7;X-- >0;)fe.push(0);break;default:fe.push(W),ie<W&&(ie=W);break}var be=fe.slice(0,I),Re=fe.slice(I);for(Ce=I;Ce<286;++Ce)be[Ce]=0;for(Ce=L;Ce<30;++Ce)Re[Ce]=0;return ir=pt(be,dt,286),se=pt(Re,rt,30),U}function Be(C,U){if(C[0]==3&&!(C[1]&3))return[Ya(U),2];for(var I=0,L=0,V=Jx(U||1<<18),X=0,le=V.length>>>0,ge=0,ie=0;!(L&1);){if(L=pe(C,I),I+=3,L>>>1)L>>1==1?(ge=9,ie=5):(I=ze(C,I),ge=ir,ie=se);else{I&7&&(I+=8-(I&7));var ce=C[I>>>3]|C[(I>>>3)+1]<<8;if(I+=32,ce>0)for(!U&&le<X+ce&&(V=He(V,X+ce),le=V.length);ce-- >0;)V[X++]=C[I>>>3],I+=8;continue}for(;;){!U&&le<X+32767&&(V=He(V,X+32767),le=V.length);var de=oe(C,I,ge),_e=L>>>1==1?Bt[de]:dt[de];if(I+=_e&15,_e>>>=4,!(_e>>>8&255))V[X++]=_e;else{if(_e==256)break;_e-=257;var Ce=_e<8?0:_e-4>>2;Ce>5&&(Ce=0);var W=X+F[_e];Ce>0&&(W+=oe(C,I,Ce),I+=Ce),de=oe(C,I,ie),_e=L>>>1==1?nt[de]:rt[de],I+=_e&15,_e>>>=4;var q=_e<4?0:_e-2>>1,J=ae[_e];for(q>0&&(J+=oe(C,I,q),I+=q),!U&&le<W&&(V=He(V,W+100),le=V.length);X<W;)V[X]=V[X-J],++X}}}return U?[V,I+7>>>3]:[V.slice(0,X),I+7>>>3]}function kt(C,U){var I=C.slice(C.l||0),L=Be(I,U);return C.l+=L[1],L[0]}function _r(C,U){if(C)typeof console<"u"&&console.error(U);else throw new Error(U)}function an(C,U){var I=C;wr(I,0);var L=[],V=[],X={FileIndex:L,FullPaths:V};_(X,{root:U.root});for(var le=I.length-4;(I[le]!=80||I[le+1]!=75||I[le+2]!=5||I[le+3]!=6)&&le>=0;)--le;I.l=le+4,I.l+=4;var ge=I.read_shift(2);I.l+=6;var ie=I.read_shift(4);for(I.l=ie,le=0;le<ge;++le){I.l+=20;var ce=I.read_shift(4),de=I.read_shift(4),_e=I.read_shift(2),Ce=I.read_shift(2),W=I.read_shift(2);I.l+=8;var q=I.read_shift(4),J=c(I.slice(I.l+_e,I.l+_e+Ce));I.l+=_e+Ce+W;var fe=I.l;I.l=q+4,sn(I,ce,de,X,J),I.l=fe}return X}function sn(C,U,I,L,V){C.l+=2;var X=C.read_shift(2),le=C.read_shift(2),ge=l(C);if(X&8257)throw new Error("Unsupported ZIP encryption");for(var ie=C.read_shift(4),ce=C.read_shift(4),de=C.read_shift(4),_e=C.read_shift(2),Ce=C.read_shift(2),W="",q=0;q<_e;++q)W+=String.fromCharCode(C[C.l++]);if(Ce){var J=c(C.slice(C.l,C.l+Ce));(J[21589]||{}).mt&&(ge=J[21589].mt),((V||{})[21589]||{}).mt&&(ge=V[21589].mt)}C.l+=Ce;var fe=C.slice(C.l,C.l+ce);switch(le){case 8:fe=R(C,de);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+le)}var be=!1;X&8&&(ie=C.read_shift(4),ie==134695760&&(ie=C.read_shift(4),be=!0),ce=C.read_shift(4),de=C.read_shift(4)),ce!=U&&_r(be,"Bad compressed size: "+U+" != "+ce),de!=I&&_r(be,"Bad uncompressed size: "+I+" != "+de),Et(L,W,fe,{unsafe:!0,mt:ge})}function gr(C,U){var I=U||{},L=[],V=[],X=ye(1),le=I.compression?8:0,ge=0,ie=0,ce=0,de=0,_e=0,Ce=C.FullPaths[0],W=Ce,q=C.FileIndex[0],J=[],fe=0;for(ie=1;ie<C.FullPaths.length;++ie)if(W=C.FullPaths[ie].slice(Ce.length),q=C.FileIndex[ie],!(!q.size||!q.content||W=="Sh33tJ5")){var be=de,Re=ye(W.length);for(ce=0;ce<W.length;++ce)Re.write_shift(1,W.charCodeAt(ce)&127);Re=Re.slice(0,Re.l),J[_e]=xw.buf(q.content,0);var G=q.content;le==8&&(G=g(G)),X=ye(30),X.write_shift(4,67324752),X.write_shift(2,20),X.write_shift(2,ge),X.write_shift(2,le),q.mt?i(X,q.mt):X.write_shift(4,0),X.write_shift(-4,J[_e]),X.write_shift(4,G.length),X.write_shift(4,q.content.length),X.write_shift(2,Re.length),X.write_shift(2,0),de+=X.length,L.push(X),de+=Re.length,L.push(Re),de+=G.length,L.push(G),X=ye(46),X.write_shift(4,33639248),X.write_shift(2,0),X.write_shift(2,20),X.write_shift(2,ge),X.write_shift(2,le),X.write_shift(4,0),X.write_shift(-4,J[_e]),X.write_shift(4,G.length),X.write_shift(4,q.content.length),X.write_shift(2,Re.length),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(4,0),X.write_shift(4,be),fe+=X.l,V.push(X),fe+=Re.length,V.push(Re),++_e}return X=ye(22),X.write_shift(4,101010256),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(2,_e),X.write_shift(2,_e),X.write_shift(4,fe),X.write_shift(4,de),X.write_shift(2,0),mr([mr(L),mr(V),X])}var Br={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function ln(C,U){if(C.ctype)return C.ctype;var I=C.name||"",L=I.match(/\.([^\.]+)$/);return L&&Br[L[1]]||U&&(L=(I=U).match(/[\.\\]([^\.\\])+$/),L&&Br[L[1]])?Br[L[1]]:"application/octet-stream"}function cn(C){for(var U=Fl(C),I=[],L=0;L<U.length;L+=76)I.push(U.slice(L,L+76));return I.join(`\r
`)+`\r
`}function ee(C){var U=C.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ce){var de=ce.charCodeAt(0).toString(16).toUpperCase();return"="+(de.length==1?"0"+de:de)});U=U.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),U.charAt(0)==`
`&&(U="=0D"+U.slice(1)),U=U.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var I=[],L=U.split(`\r
`),V=0;V<L.length;++V){var X=L[V];if(X.length==0){I.push("");continue}for(var le=0;le<X.length;){var ge=76,ie=X.slice(le,le+ge);ie.charAt(ge-1)=="="?ge--:ie.charAt(ge-2)=="="?ge-=2:ie.charAt(ge-3)=="="&&(ge-=3),ie=X.slice(le,le+ge),le+=ge,le<X.length&&(ie+="="),I.push(ie)}}return I.join(`\r
`)}function We(C){for(var U=[],I=0;I<C.length;++I){for(var L=C[I];I<=C.length&&L.charAt(L.length-1)=="=";)L=L.slice(0,L.length-1)+C[++I];U.push(L)}for(var V=0;V<U.length;++V)U[V]=U[V].replace(/[=][0-9A-Fa-f]{2}/g,function(X){return String.fromCharCode(parseInt(X.slice(1),16))});return fn(U.join(`\r
`))}function Je(C,U,I){for(var L="",V="",X="",le,ge=0;ge<10;++ge){var ie=U[ge];if(!ie||ie.match(/^\s*$/))break;var ce=ie.match(/^(.*?):\s*([^\s].*)$/);if(ce)switch(ce[1].toLowerCase()){case"content-location":L=ce[2].trim();break;case"content-type":X=ce[2].trim();break;case"content-transfer-encoding":V=ce[2].trim();break}}switch(++ge,V.toLowerCase()){case"base64":le=fn(gn(U.slice(ge).join("")));break;case"quoted-printable":le=We(U.slice(ge));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+V)}var de=Et(C,L.slice(I.length),le,{unsafe:!0});X&&(de.ctype=X)}function qt(C,U){if(z(C.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var I=U&&U.root||"",L=(at&&Buffer.isBuffer(C)?C.toString("binary"):z(C)).split(`\r
`),V=0,X="";for(V=0;V<L.length;++V)if(X=L[V],!!/^Content-Location:/i.test(X)&&(X=X.slice(X.indexOf("file")),I||(I=X.slice(0,X.lastIndexOf("/")+1)),X.slice(0,I.length)!=I))for(;I.length>0&&(I=I.slice(0,I.length-1),I=I.slice(0,I.lastIndexOf("/")+1),X.slice(0,I.length)!=I););var le=(L[1]||"").match(/boundary="(.*?)"/);if(!le)throw new Error("MAD cannot find boundary");var ge="--"+(le[1]||""),ie=[],ce=[],de={FileIndex:ie,FullPaths:ce};_(de);var _e,Ce=0;for(V=0;V<L.length;++V){var W=L[V];W!==ge&&W!==ge+"--"||(Ce++&&Je(de,L.slice(_e,V),I),_e=V)}return de}function tr(C,U){var I=U||{},L=I.boundary||"SheetJS";L="------="+L;for(var V=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+L.slice(2)+'"',"","",""],X=C.FullPaths[0],le=X,ge=C.FileIndex[0],ie=1;ie<C.FullPaths.length;++ie)if(le=C.FullPaths[ie].slice(X.length),ge=C.FileIndex[ie],!(!ge.size||!ge.content||le=="Sh33tJ5")){le=le.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(fe){return"_x"+fe.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(fe){return"_u"+fe.charCodeAt(0).toString(16)+"_"});for(var ce=ge.content,de=at&&Buffer.isBuffer(ce)?ce.toString("binary"):z(ce),_e=0,Ce=Math.min(1024,de.length),W=0,q=0;q<=Ce;++q)(W=de.charCodeAt(q))>=32&&W<128&&++_e;var J=_e>=Ce*4/5;V.push(L),V.push("Content-Location: "+(I.root||"file:///C:/SheetJS/")+le),V.push("Content-Transfer-Encoding: "+(J?"quoted-printable":"base64")),V.push("Content-Type: "+ln(ge,le)),V.push(""),V.push(J?ee(de):cn(de))}return V.push(L+`--\r
`),V.join(`\r
`)}function Sr(C){var U={};return _(U,C),U}function Et(C,U,I,L){var V=L&&L.unsafe;V||_(C);var X=!V&&$e.find(C,U);if(!X){var le=C.FullPaths[0];U.slice(0,le.length)==le?le=U:(le.slice(-1)!="/"&&(le+="/"),le=(le+U).replace("//","/")),X={name:s(U),type:2},C.FileIndex.push(X),C.FullPaths.push(le),V||$e.utils.cfb_gc(C)}return X.content=I,X.size=I?I.length:0,L&&(L.CLSID&&(X.clsid=L.CLSID),L.mt&&(X.mt=L.mt),L.ct&&(X.ct=L.ct)),X}function Rt(C,U){_(C);var I=$e.find(C,U);if(I){for(var L=0;L<C.FileIndex.length;++L)if(C.FileIndex[L]==I)return C.FileIndex.splice(L,1),C.FullPaths.splice(L,1),!0}return!1}function ur(C,U,I){_(C);var L=$e.find(C,U);if(L){for(var V=0;V<C.FileIndex.length;++V)if(C.FileIndex[V]==L)return C.FileIndex[V].name=s(I),C.FullPaths[V]=I,!0}return!1}function lt(C){P(C,!0)}return t.find=K,t.read=k,t.parse=d,t.write=ne,t.writeFile=Z,t.utils={cfb_new:Sr,cfb_add:Et,cfb_del:Rt,cfb_mov:ur,cfb_gc:lt,ReadShift:rl,CheckField:rg,prep_blob:wr,bconcat:mr,use_zlib:O,_deflateRaw:Ge,_inflateRaw:kt,consts:Q},t}();function mw(e){return typeof e=="string"?Xo(e):Array.isArray(e)?Ub(e):e}function Yl(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=Xo(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var a=r=="utf8"?ta(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(a,e);if(typeof Blob<"u"){var s=new Blob([mw(a)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(s,e);if(typeof saveAs<"u")return saveAs(s,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(s);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:e,saveAs:!0});var l=document.createElement("a");if(l.download!=null)return l.download=e,l.href=i,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var c=File(e);return c.open("w"),c.encoding="binary",Array.isArray(t)&&(t=rs(t)),c.write(t),c.close(),t}catch(o){if(!o.message||!o.message.match(/onstruct/))throw o}throw new Error("cannot save file "+e)}function hw(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(a){if(!a.message||!a.message.match(/onstruct/))throw a}throw new Error("Cannot access file "+e)}function Yt(e){for(var t=Object.keys(e),r=[],a=0;a<t.length;++a)Object.prototype.hasOwnProperty.call(e,t[a])&&r.push(t[a]);return r}function sm(e,t){for(var r=[],a=Yt(e),s=0;s!==a.length;++s)r[e[a[s]][t]]==null&&(r[e[a[s]][t]]=a[s]);return r}function Yo(e){for(var t=[],r=Yt(e),a=0;a!==r.length;++a)t[e[r[a]]]=r[a];return t}function qo(e){for(var t=[],r=Yt(e),a=0;a!==r.length;++a)t[e[r[a]]]=parseInt(r[a],10);return t}function pw(e){for(var t=[],r=Yt(e),a=0;a!==r.length;++a)t[e[r[a]]]==null&&(t[e[r[a]]]=[]),t[e[r[a]]].push(r[a]);return t}var No=new Date(1899,11,30,0,0,0);function dr(e,t){var r=e.getTime(),a=No.getTime()+(e.getTimezoneOffset()-No.getTimezoneOffset())*6e4;return(r-a)/(24*60*60*1e3)}var M1=new Date,gw=No.getTime()+(M1.getTimezoneOffset()-No.getTimezoneOffset())*6e4,im=M1.getTimezoneOffset();function Jo(e){var t=new Date;return t.setTime(e*24*60*60*1e3+gw),t.getTimezoneOffset()!==im&&t.setTime(t.getTime()+(t.getTimezoneOffset()-im)*6e4),t}function vw(e){var t=0,r=0,a=!1,s=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var i=1;i!=s.length;++i)if(s[i]){switch(r=1,i>3&&(a=!0),s[i].slice(s[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[i].slice(s[i].length-1));case"D":r*=24;case"H":r*=60;case"M":if(a)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(s[i],10)}return t}var lm=new Date("2017-02-19T19:06:09.000Z"),R1=isNaN(lm.getFullYear())?new Date("2/19/17"):lm,yw=R1.getFullYear()==2017;function It(e,t){var r=new Date(e);if(yw)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(R1.getFullYear()==1917&&!isNaN(r.getFullYear())){var a=r.getFullYear();return e.indexOf(""+a)>-1||r.setFullYear(r.getFullYear()+100),r}var s=e.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return e.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function _s(e,t){if(at&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return ta(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return ta(j1(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return ta(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return ta(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(i){return r[i]||i})}catch{}for(var a=[],s=0;s!=e.length;++s)a.push(String.fromCharCode(e[s]));return a.join("")}function Mt(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Mt(e[r]));return t}function Xt(e,t){for(var r="";r.length<t;)r+=e;return r}function Vn(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,a=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(a))||(a=a.replace(/[(](.*)[)]/,function(s,i){return r=-r,i}),!isNaN(t=Number(a)))?t/r:t}var bw=["january","february","march","april","may","june","july","august","september","october","november","december"];function bi(e){var t=new Date(e),r=new Date(NaN),a=t.getYear(),s=t.getMonth(),i=t.getDate();if(isNaN(i))return r;var l=e.toLowerCase();if(l.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(l=l.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),l.length>3&&bw.indexOf(l)==-1)return r}else if(l.match(/[a-z]/))return r;return a<0||a>8099?r:(s>0||i>1)&&a!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var ww=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,a,s){if(e||typeof a=="string")return r.split(a);for(var i=r.split(a),l=[i[0]],c=1;c<i.length;++c)l.push(s),l.push(i[c]);return l}}();function O1(e){return e?e.content&&e.type?_s(e.content,!0):e.data?$i(e.data):e.asNodeBuffer&&at?$i(e.asNodeBuffer().toString("binary")):e.asBinary?$i(e.asBinary()):e._data&&e._data.getContent?$i(_s(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function L1(e){if(!e)return null;if(e.data)return Yx(e.data);if(e.asNodeBuffer&&at)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?Yx(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function Nw(e){return e&&e.name.slice(-4)===".bin"?L1(e):O1(e)}function kn(e,t){for(var r=e.FullPaths||Yt(e.files),a=t.toLowerCase().replace(/[\/]/g,"\\"),s=a.replace(/\\/g,"/"),i=0;i<r.length;++i){var l=r[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(a==l||s==l)return e.files?e.files[r[i]]:e.FileIndex[i]}return null}function Zu(e,t){var r=kn(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function nr(e,t,r){if(!r)return Nw(Zu(e,t));if(!t)return null;try{return nr(e,t)}catch{return null}}function xn(e,t,r){if(!r)return O1(Zu(e,t));if(!t)return null;try{return xn(e,t)}catch{return null}}function jw(e,t,r){return L1(Zu(e,t))}function cm(e){for(var t=e.FullPaths||Yt(e.files),r=[],a=0;a<t.length;++a)t[a].slice(-1)!="/"&&r.push(t[a].replace(/^Root Entry[\/]/,""));return r.sort()}function tt(e,t,r){if(e.FullPaths){if(typeof r=="string"){var a;return at?a=ja(r):a=zb(r),$e.utils.cfb_add(e,t,a)}$e.utils.cfb_add(e,t,r)}else e.file(t,r)}function ef(){return $e.utils.cfb_new()}function B1(e,t){switch(t.type){case"base64":return $e.read(e,{type:"base64"});case"binary":return $e.read(e,{type:"binary"});case"buffer":case"array":return $e.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function Gi(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var a=e.split("/");a.length!==0;){var s=a.shift();s===".."?r.pop():s!=="."&&r.push(s)}return r.join("/")}var er=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,kw=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,om=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,_w=/<[^>]*>/g,Lr=er.match(om)?om:_w,Sw=/<\w*:/,Cw=/<(\/?)\w+:/;function Ye(e,t,r){for(var a={},s=0,i=0;s!==e.length&&!((i=e.charCodeAt(s))===32||i===10||i===13);++s);if(t||(a[0]=e.slice(0,s)),s===e.length)return a;var l=e.match(kw),c=0,o="",u=0,d="",f="",x=1;if(l)for(u=0;u!=l.length;++u){for(f=l[u],i=0;i!=f.length&&f.charCodeAt(i)!==61;++i);for(d=f.slice(0,i).trim();f.charCodeAt(i+1)==32;)++i;for(x=(s=f.charCodeAt(i+1))==34||s==39?1:0,o=f.slice(i+1+x,f.length-x),c=0;c!=d.length&&d.charCodeAt(c)!==58;++c);if(c===d.length)d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),a[d]=o,a[d.toLowerCase()]=o;else{var h=(c===5&&d.slice(0,5)==="xmlns"?"xmlns":"")+d.slice(c+1);if(a[h]&&d.slice(c-3,c)=="ext")continue;a[h]=o,a[h.toLowerCase()]=o}}return a}function sa(e){return e.replace(Cw,"<$1")}var U1={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},tf=Yo(U1),xt=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(a){var s=a+"",i=s.indexOf("<![CDATA[");if(i==-1)return s.replace(e,function(c,o){return U1[c]||String.fromCharCode(parseInt(o,c.indexOf("x")>-1?16:10))||c}).replace(t,function(c,o){return String.fromCharCode(parseInt(o,16))});var l=s.indexOf("]]>");return r(s.slice(0,i))+s.slice(i+9,l)+r(s.slice(l+3))}}(),rf=/[&<>'"]/g,Ew=/[\u0000-\u0008\u000b-\u001f]/g;function wt(e){var t=e+"";return t.replace(rf,function(r){return tf[r]}).replace(Ew,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function dm(e){return wt(e).replace(/ /g,"_x0020_")}var z1=/[\u0000-\u001f]/g;function nf(e){var t=e+"";return t.replace(rf,function(r){return tf[r]}).replace(/\n/g,"<br/>").replace(z1,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function Tw(e){var t=e+"";return t.replace(rf,function(r){return tf[r]}).replace(z1,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var um=function(){var e=/&#(\d+);/g;function t(r,a){return String.fromCharCode(parseInt(a,10))}return function(a){return a.replace(e,t)}}();function Fw(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function Ft(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function F0(e){for(var t="",r=0,a=0,s=0,i=0,l=0,c=0;r<e.length;){if(a=e.charCodeAt(r++),a<128){t+=String.fromCharCode(a);continue}if(s=e.charCodeAt(r++),a>191&&a<224){l=(a&31)<<6,l|=s&63,t+=String.fromCharCode(l);continue}if(i=e.charCodeAt(r++),a<240){t+=String.fromCharCode((a&15)<<12|(s&63)<<6|i&63);continue}l=e.charCodeAt(r++),c=((a&7)<<18|(s&63)<<12|(i&63)<<6|l&63)-65536,t+=String.fromCharCode(55296+(c>>>10&1023)),t+=String.fromCharCode(56320+(c&1023))}return t}function fm(e){var t=Ya(2*e.length),r,a,s=1,i=0,l=0,c;for(a=0;a<e.length;a+=s)s=1,(c=e.charCodeAt(a))<128?r=c:c<224?(r=(c&31)*64+(e.charCodeAt(a+1)&63),s=2):c<240?(r=(c&15)*4096+(e.charCodeAt(a+1)&63)*64+(e.charCodeAt(a+2)&63),s=3):(s=4,r=(c&7)*262144+(e.charCodeAt(a+1)&63)*4096+(e.charCodeAt(a+2)&63)*64+(e.charCodeAt(a+3)&63),r-=65536,l=55296+(r>>>10&1023),r=56320+(r&1023)),l!==0&&(t[i++]=l&255,t[i++]=l>>>8,l=0),t[i++]=r%256,t[i++]=r>>>8;return t.slice(0,i).toString("ucs2")}function xm(e){return ja(e,"binary").toString("utf8")}var wc="foo bar baz",jt=at&&(xm(wc)==F0(wc)&&xm||fm(wc)==F0(wc)&&fm)||F0,ta=at?function(e){return ja(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,a=0,s=0;r<e.length;)switch(a=e.charCodeAt(r++),!0){case a<128:t.push(String.fromCharCode(a));break;case a<2048:t.push(String.fromCharCode(192+(a>>6))),t.push(String.fromCharCode(128+(a&63)));break;case(a>=55296&&a<57344):a-=55296,s=e.charCodeAt(r++)-56320+(a<<10),t.push(String.fromCharCode(240+(s>>18&7))),t.push(String.fromCharCode(144+(s>>12&63))),t.push(String.fromCharCode(128+(s>>6&63))),t.push(String.fromCharCode(128+(s&63)));break;default:t.push(String.fromCharCode(224+(a>>12))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)))}return t.join("")},Pl=function(){var e={};return function(r,a){var s=r+"|"+(a||"");return e[s]?e[s]:e[s]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",a||"")}}(),W1=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var a=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<e.length;++s)a=a.replace(e[s][0],e[s][1]);return a}}(),Aw=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),Pw=/<\/?(?:vt:)?variant>/g,Dw=/<(?:vt:)([^>]*)>([\s\S]*)</;function mm(e,t){var r=Ye(e),a=e.match(Aw(r.baseType))||[],s=[];if(a.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+a.length+" != "+r.size);return s}return a.forEach(function(i){var l=i.replace(Pw,"").match(Dw);l&&s.push({v:jt(l[2]),t:l[1]})}),s}var H1=/(^\s|\s$|\n)/;function Nr(e,t){return"<"+e+(t.match(H1)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function Dl(e){return Yt(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Fe(e,t,r){return"<"+e+(r!=null?Dl(r):"")+(t!=null?(t.match(H1)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Ld(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function Iw(e,t){switch(typeof e){case"string":var r=Fe("vt:lpwstr",wt(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Fe((e|0)==e?"vt:i4":"vt:r8",wt(String(e)));case"boolean":return Fe("vt:bool",e?"true":"false")}if(e instanceof Date)return Fe("vt:filetime",Ld(e));throw new Error("Unable to serialize "+e)}function af(e){if(at&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return jt(rs(qu(e)));throw new Error("Bad input format: expected Buffer or string")}var Il=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,cr={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Ps=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],dn={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function Mw(e,t){for(var r=1-2*(e[t+7]>>>7),a=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),s=e[t+6]&15,i=5;i>=0;--i)s=s*256+e[t+i];return a==2047?s==0?r*(1/0):NaN:(a==0?a=-1022:(a-=1023,s+=Math.pow(2,52)),r*Math.pow(2,a-52)*s)}function Rw(e,t,r){var a=(t<0||1/t==-1/0?1:0)<<7,s=0,i=0,l=a?-t:t;isFinite(l)?l==0?s=i=0:(s=Math.floor(Math.log(l)/Math.LN2),i=l*Math.pow(2,52-s),s<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?s=-1022:(i-=Math.pow(2,52),s+=1023)):(s=2047,i=isNaN(t)?26985:0);for(var c=0;c<=5;++c,i/=256)e[r+c]=i&255;e[r+6]=(s&15)<<4|i&15,e[r+7]=s>>4|a}var hm=function(e){for(var t=[],r=10240,a=0;a<e[0].length;++a)if(e[0][a])for(var s=0,i=e[0][a].length;s<i;s+=r)t.push.apply(t,e[0][a].slice(s,s+r));return t},pm=at?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:ja(t)})):hm(e)}:hm,gm=function(e,t,r){for(var a=[],s=t;s<r;s+=2)a.push(String.fromCharCode(fa(e,s)));return a.join("").replace(Vr,"")},sf=at?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Vr,""):gm(e,t,r)}:gm,vm=function(e,t,r){for(var a=[],s=t;s<t+r;++s)a.push(("0"+e[s].toString(16)).slice(-2));return a.join("")},$1=at?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):vm(e,t,r)}:vm,ym=function(e,t,r){for(var a=[],s=t;s<r;s++)a.push(String.fromCharCode(Ws(e,s)));return a.join("")},ql=at?function(t,r,a){return Buffer.isBuffer(t)?t.toString("utf8",r,a):ym(t,r,a)}:ym,V1=function(e,t){var r=un(e,t);return r>0?ql(e,t+4,t+4+r-1):""},G1=V1,X1=function(e,t){var r=un(e,t);return r>0?ql(e,t+4,t+4+r-1):""},K1=X1,Y1=function(e,t){var r=2*un(e,t);return r>0?ql(e,t+4,t+4+r-1):""},q1=Y1,J1=function(t,r){var a=un(t,r);return a>0?sf(t,r+4,r+4+a):""},Q1=J1,Z1=function(e,t){var r=un(e,t);return r>0?ql(e,t+4,t+4+r):""},eg=Z1,tg=function(e,t){return Mw(e,t)},jo=tg,lf=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};at&&(G1=function(t,r){if(!Buffer.isBuffer(t))return V1(t,r);var a=t.readUInt32LE(r);return a>0?t.toString("utf8",r+4,r+4+a-1):""},K1=function(t,r){if(!Buffer.isBuffer(t))return X1(t,r);var a=t.readUInt32LE(r);return a>0?t.toString("utf8",r+4,r+4+a-1):""},q1=function(t,r){if(!Buffer.isBuffer(t))return Y1(t,r);var a=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+a-1)},Q1=function(t,r){if(!Buffer.isBuffer(t))return J1(t,r);var a=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+a)},eg=function(t,r){if(!Buffer.isBuffer(t))return Z1(t,r);var a=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+a)},jo=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):tg(t,r)},lf=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Ws=function(e,t){return e[t]},fa=function(e,t){return e[t+1]*256+e[t]},Ow=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},un=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},ls=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},Lw=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function rl(e,t){var r="",a,s,i=[],l,c,o,u;switch(t){case"dbcs":if(u=this.l,at&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(o=0;o<e;++o)r+=String.fromCharCode(fa(this,u)),u+=2;e*=2;break;case"utf8":r=ql(this,this.l,this.l+e);break;case"utf16le":e*=2,r=sf(this,this.l,this.l+e);break;case"wstr":return rl.call(this,e,"dbcs");case"lpstr-ansi":r=G1(this,this.l),e=4+un(this,this.l);break;case"lpstr-cp":r=K1(this,this.l),e=4+un(this,this.l);break;case"lpwstr":r=q1(this,this.l),e=4+2*un(this,this.l);break;case"lpp4":e=4+un(this,this.l),r=Q1(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+un(this,this.l),r=eg(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(l=Ws(this,this.l+e++))!==0;)i.push(bc(l));r=i.join("");break;case"_wstr":for(e=0,r="";(l=fa(this,this.l+e))!==0;)i.push(bc(l)),e+=2;e+=2,r=i.join("");break;case"dbcs-cont":for(r="",u=this.l,o=0;o<e;++o){if(this.lens&&this.lens.indexOf(u)!==-1)return l=Ws(this,u),this.l=u+1,c=rl.call(this,e-o,l?"dbcs-cont":"sbcs-cont"),i.join("")+c;i.push(bc(fa(this,u))),u+=2}r=i.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",u=this.l,o=0;o!=e;++o){if(this.lens&&this.lens.indexOf(u)!==-1)return l=Ws(this,u),this.l=u+1,c=rl.call(this,e-o,l?"dbcs-cont":"sbcs-cont"),i.join("")+c;i.push(bc(Ws(this,u))),u+=1}r=i.join("");break;default:switch(e){case 1:return a=Ws(this,this.l),this.l++,a;case 2:return a=(t==="i"?Ow:fa)(this,this.l),this.l+=2,a;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(a=(e>0?ls:Lw)(this,this.l),this.l+=4,a):(s=un(this,this.l),this.l+=4,s);case 8:case-8:if(t==="f")return e==8?s=jo(this,this.l):s=jo([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;e=8;case 16:r=$1(this,this.l,e);break}}return this.l+=e,r}var Bw=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},Uw=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},zw=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function Ww(e,t,r){var a=0,s=0;if(r==="dbcs"){for(s=0;s!=t.length;++s)zw(this,t.charCodeAt(s),this.l+2*s);a=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=t.length;++s)this[this.l+s]=t.charCodeAt(s)&255;a=t.length}else if(r==="hex"){for(;s<e;++s)this[this.l++]=parseInt(t.slice(2*s,2*s+2),16)||0;return this}else if(r==="utf16le"){var i=Math.min(this.l+e,this.length);for(s=0;s<Math.min(t.length,e);++s){var l=t.charCodeAt(s);this[this.l++]=l&255,this[this.l++]=l>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(e){case 1:a=1,this[this.l]=t&255;break;case 2:a=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:a=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:a=4,Bw(this,t,this.l);break;case 8:if(a=8,r==="f"){Rw(this,t,this.l);break}case 16:break;case-4:a=4,Uw(this,t,this.l);break}return this.l+=a,this}function rg(e,t){var r=$1(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function wr(e,t){e.l=t,e.read_shift=rl,e.chk=rg,e.write_shift=Ww}function Or(e,t){e.l+=t}function ye(e){var t=Ya(e);return wr(t,0),t}function ka(e,t,r){if(e){var a,s,i;wr(e,e.l||0);for(var l=e.length,c=0,o=0;e.l<l;){c=e.read_shift(1),c&128&&(c=(c&127)+((e.read_shift(1)&127)<<7));var u=Ul[c]||Ul[65535];for(a=e.read_shift(1),i=a&127,s=1;s<4&&a&128;++s)i+=((a=e.read_shift(1))&127)<<7*s;o=e.l+i;var d=u.f&&u.f(e,i,r);if(e.l=o,t(d,u,c))return}}}function rn(){var e=[],t=at?256:2048,r=function(u){var d=ye(u);return wr(d,0),d},a=r(t),s=function(){a&&(a.length>a.l&&(a=a.slice(0,a.l),a.l=a.length),a.length>0&&e.push(a),a=null)},i=function(u){return a&&u<a.length-a.l?a:(s(),a=r(Math.max(u+1,t)))},l=function(){return s(),mr(e)},c=function(u){s(),a=u,a.l==null&&(a.l=a.length),i(t)};return{next:i,push:c,end:l,_bufs:e}}function ke(e,t,r,a){var s=+t,i;if(!isNaN(s)){a||(a=Ul[s].p||(r||[]).length||0),i=1+(s>=128?1:0)+1,a>=128&&++i,a>=16384&&++i,a>=2097152&&++i;var l=e.next(i);s<=127?l.write_shift(1,s):(l.write_shift(1,(s&127)+128),l.write_shift(1,s>>7));for(var c=0;c!=4;++c)if(a>=128)l.write_shift(1,(a&127)+128),a>>=7;else{l.write_shift(1,a);break}a>0&&lf(r)&&e.push(r)}}function nl(e,t,r){var a=Mt(e);if(t.s?(a.cRel&&(a.c+=t.s.c),a.rRel&&(a.r+=t.s.r)):(a.cRel&&(a.c+=t.c),a.rRel&&(a.r+=t.r)),!r||r.biff<12){for(;a.c>=256;)a.c-=256;for(;a.r>=65536;)a.r-=65536}return a}function bm(e,t,r){var a=Mt(e);return a.s=nl(a.s,t.s,r),a.e=nl(a.e,t.s,r),a}function al(e,t){if(e.cRel&&e.c<0)for(e=Mt(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Mt(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Ke(e);return!e.cRel&&e.cRel!=null&&(r=Vw(r)),!e.rRel&&e.rRel!=null&&(r=Hw(r)),r}function A0(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Wt(e.s.c)+":"+(e.e.cRel?"":"$")+Wt(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Zt(e.s.r)+":"+(e.e.rRel?"":"$")+Zt(e.e.r):al(e.s,t.biff)+":"+al(e.e,t.biff)}function cf(e){return parseInt($w(e),10)-1}function Zt(e){return""+(e+1)}function Hw(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function $w(e){return e.replace(/\$(\d+)$/,"$1")}function of(e){for(var t=Gw(e),r=0,a=0;a!==t.length;++a)r=26*r+t.charCodeAt(a)-64;return r-1}function Wt(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function Vw(e){return e.replace(/^([A-Z])/,"$$$1")}function Gw(e){return e.replace(/^\$([A-Z])/,"$1")}function Xw(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Ht(e){for(var t=0,r=0,a=0;a<e.length;++a){var s=e.charCodeAt(a);s>=48&&s<=57?t=10*t+(s-48):s>=65&&s<=90&&(r=26*r+(s-64))}return{c:r-1,r:t-1}}function Ke(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function nn(e){var t=e.indexOf(":");return t==-1?{s:Ht(e),e:Ht(e)}:{s:Ht(e.slice(0,t)),e:Ht(e.slice(t+1))}}function et(e,t){return typeof t>"u"||typeof t=="number"?et(e.s,e.e):(typeof e!="string"&&(e=Ke(e)),typeof t!="string"&&(t=Ke(t)),e==t?e:e+":"+t)}function mt(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,a=0,s=0,i=e.length;for(r=0;a<i&&!((s=e.charCodeAt(a)-64)<1||s>26);++a)r=26*r+s;for(t.s.c=--r,r=0;a<i&&!((s=e.charCodeAt(a)-48)<0||s>9);++a)r=10*r+s;if(t.s.r=--r,a===i||s!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++a,r=0;a!=i&&!((s=e.charCodeAt(a)-64)<1||s>26);++a)r=26*r+s;for(t.e.c=--r,r=0;a!=i&&!((s=e.charCodeAt(a)-48)<0||s>9);++a)r=10*r+s;return t.e.r=--r,t}function wm(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Dn(e.z,r?dr(t):t)}catch{}try{return e.w=Dn((e.XF||{}).numFmtId||(r?14:0),r?dr(t):t)}catch{return""+t}}function wa(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?_a[e.v]||e.v:t==null?wm(e,e.v):wm(e,t))}function ns(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",a={};return a[r]=e,{SheetNames:[r],Sheets:a}}function ng(e,t,r){var a=r||{},s=e?Array.isArray(e):a.dense,i=e||(s?[]:{}),l=0,c=0;if(i&&a.origin!=null){if(typeof a.origin=="number")l=a.origin;else{var o=typeof a.origin=="string"?Ht(a.origin):a.origin;l=o.r,c=o.c}i["!ref"]||(i["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var d=mt(i["!ref"]);u.s.c=d.s.c,u.s.r=d.s.r,u.e.c=Math.max(u.e.c,d.e.c),u.e.r=Math.max(u.e.r,d.e.r),l==-1&&(u.e.r=l=d.e.r+1)}for(var f=0;f!=t.length;++f)if(t[f]){if(!Array.isArray(t[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var x=0;x!=t[f].length;++x)if(!(typeof t[f][x]>"u")){var h={v:t[f][x]},p=l+f,m=c+x;if(u.s.r>p&&(u.s.r=p),u.s.c>m&&(u.s.c=m),u.e.r<p&&(u.e.r=p),u.e.c<m&&(u.e.c=m),t[f][x]&&typeof t[f][x]=="object"&&!Array.isArray(t[f][x])&&!(t[f][x]instanceof Date))h=t[f][x];else if(Array.isArray(h.v)&&(h.f=t[f][x][1],h.v=h.v[0]),h.v===null)if(h.f)h.t="n";else if(a.nullError)h.t="e",h.v=0;else if(a.sheetStubs)h.t="z";else continue;else typeof h.v=="number"?h.t="n":typeof h.v=="boolean"?h.t="b":h.v instanceof Date?(h.z=a.dateNF||Xe[14],a.cellDates?(h.t="d",h.w=Dn(h.z,dr(h.v))):(h.t="n",h.v=dr(h.v),h.w=Dn(h.z,h.v))):h.t="s";if(s)i[p]||(i[p]=[]),i[p][m]&&i[p][m].z&&(h.z=i[p][m].z),i[p][m]=h;else{var w=Ke({c:m,r:p});i[w]&&i[w].z&&(h.z=i[w].z),i[w]=h}}}return u.s.c<1e7&&(i["!ref"]=et(u)),i}function Ei(e,t){return ng(null,e,t)}function Kw(e){return e.read_shift(4,"i")}function Gn(e,t){return t||(t=ye(4)),t.write_shift(4,e),t}function Mr(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function hr(e,t){var r=!1;return t==null&&(r=!0,t=ye(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function Yw(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function qw(e,t){return t||(t=ye(4)),t.write_shift(2,0),t.write_shift(2,0),t}function df(e,t){var r=e.l,a=e.read_shift(1),s=Mr(e),i=[],l={t:s,h:s};if(a&1){for(var c=e.read_shift(4),o=0;o!=c;++o)i.push(Yw(e));l.r=i}else l.r=[{ich:0,ifnt:0}];return e.l=r+t,l}function Jw(e,t){var r=!1;return t==null&&(r=!0,t=ye(15+4*e.t.length)),t.write_shift(1,0),hr(e.t,t),r?t.slice(0,t.l):t}var Qw=df;function Zw(e,t){var r=!1;return t==null&&(r=!0,t=ye(23+4*e.t.length)),t.write_shift(1,1),hr(e.t,t),t.write_shift(4,1),qw({ich:0,ifnt:0},t),r?t.slice(0,t.l):t}function In(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Ds(e,t){return t==null&&(t=ye(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function Is(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function Ms(e,t){return t==null&&(t=ye(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var eN=Mr,ag=hr;function uf(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function ko(e,t){var r=!1;return t==null&&(r=!0,t=ye(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var tN=Mr,Bd=uf,ff=ko;function xf(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,a=t[0]&2;e.l+=4;var s=a===0?jo([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):ls(t,0)>>2;return r?s/100:s}function sg(e,t){t==null&&(t=ye(4));var r=0,a=0,s=e*100;if(e==(e|0)&&e>=-(1<<29)&&e<1<<29?a=1:s==(s|0)&&s>=-(1<<29)&&s<1<<29&&(a=1,r=1),a)t.write_shift(-4,((r?s:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function ig(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function rN(e,t){return t||(t=ye(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var Rs=ig,Ti=rN;function Ir(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Ss(e,t){return(t||ye(8)).write_shift(8,e,"f")}function nN(e){var t={},r=e.read_shift(1),a=r>>>1,s=e.read_shift(1),i=e.read_shift(2,"i"),l=e.read_shift(1),c=e.read_shift(1),o=e.read_shift(1);switch(e.l++,a){case 0:t.auto=1;break;case 1:t.index=s;var u=ms[s];u&&(t.rgb=Rl(u));break;case 2:t.rgb=Rl([l,c,o]);break;case 3:t.theme=s;break}return i!=0&&(t.tint=i>0?i/32767:i/32768),t}function _o(e,t){if(t||(t=ye(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var a=e.rgb||"FFFFFF";typeof a=="number"&&(a=("000000"+a.toString(16)).slice(-6)),t.write_shift(1,parseInt(a.slice(0,2),16)),t.write_shift(1,parseInt(a.slice(2,4),16)),t.write_shift(1,parseInt(a.slice(4,6),16)),t.write_shift(1,255)}return t}function aN(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function sN(e,t){t||(t=ye(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function lg(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},a=e.read_shift(4);switch(a){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(a>400)throw new Error("Unsupported Clipboard: "+a.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function iN(e){return lg(e,1)}function lN(e){return lg(e,2)}var mf=2,qr=3,Nc=11,Nm=12,So=19,jc=64,cN=65,oN=71,dN=4108,uN=4126,fr=80,cg=81,fN=[fr,cg],Ud={1:{n:"CodePage",t:mf},2:{n:"Category",t:fr},3:{n:"PresentationFormat",t:fr},4:{n:"ByteCount",t:qr},5:{n:"LineCount",t:qr},6:{n:"ParagraphCount",t:qr},7:{n:"SlideCount",t:qr},8:{n:"NoteCount",t:qr},9:{n:"HiddenCount",t:qr},10:{n:"MultimediaClipCount",t:qr},11:{n:"ScaleCrop",t:Nc},12:{n:"HeadingPairs",t:dN},13:{n:"TitlesOfParts",t:uN},14:{n:"Manager",t:fr},15:{n:"Company",t:fr},16:{n:"LinksUpToDate",t:Nc},17:{n:"CharacterCount",t:qr},19:{n:"SharedDoc",t:Nc},22:{n:"HyperlinksChanged",t:Nc},23:{n:"AppVersion",t:qr,p:"version"},24:{n:"DigSig",t:cN},26:{n:"ContentType",t:fr},27:{n:"ContentStatus",t:fr},28:{n:"Language",t:fr},29:{n:"Version",t:fr},255:{},2147483648:{n:"Locale",t:So},2147483651:{n:"Behavior",t:So},1919054434:{}},zd={1:{n:"CodePage",t:mf},2:{n:"Title",t:fr},3:{n:"Subject",t:fr},4:{n:"Author",t:fr},5:{n:"Keywords",t:fr},6:{n:"Comments",t:fr},7:{n:"Template",t:fr},8:{n:"LastAuthor",t:fr},9:{n:"RevNumber",t:fr},10:{n:"EditTime",t:jc},11:{n:"LastPrinted",t:jc},12:{n:"CreatedDate",t:jc},13:{n:"ModifiedDate",t:jc},14:{n:"PageCount",t:qr},15:{n:"WordCount",t:qr},16:{n:"CharCount",t:qr},17:{n:"Thumbnail",t:oN},18:{n:"Application",t:fr},19:{n:"DocSecurity",t:qr},255:{},2147483648:{n:"Locale",t:So},2147483651:{n:"Behavior",t:So},1919054434:{}},jm={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},xN=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function mN(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var hN=mN([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),ms=Mt(hN),_a={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},og={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Wd={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},kc={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function hf(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function pN(e){var t=hf();if(!e||!e.match)return t;var r={};if((e.match(Lr)||[]).forEach(function(a){var s=Ye(a);switch(s[0].replace(Sw,"<")){case"<?xml":break;case"<Types":t.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[s.Extension]=s.ContentType;break;case"<Override":t[Wd[s.ContentType]]!==void 0&&t[Wd[s.ContentType]].push(s.PartName);break}}),t.xmlns!==cr.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function dg(e,t){var r=pw(Wd),a=[],s;a[a.length]=er,a[a.length]=Fe("Types",null,{xmlns:cr.CT,"xmlns:xsd":cr.xsd,"xmlns:xsi":cr.xsi}),a=a.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(o){return Fe("Default",null,{Extension:o[0],ContentType:o[1]})}));var i=function(o){e[o]&&e[o].length>0&&(s=e[o][0],a[a.length]=Fe("Override",null,{PartName:(s[0]=="/"?"":"/")+s,ContentType:kc[o][t.bookType]||kc[o].xlsx}))},l=function(o){(e[o]||[]).forEach(function(u){a[a.length]=Fe("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:kc[o][t.bookType]||kc[o].xlsx})})},c=function(o){(e[o]||[]).forEach(function(u){a[a.length]=Fe("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:r[o][0]})})};return i("workbooks"),l("sheets"),l("charts"),c("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(c),c("vba"),c("comments"),c("threadedcomments"),c("drawings"),l("metadata"),c("people"),a.length>2&&(a[a.length]="</Types>",a[1]=a[1].replace("/>",">")),a.join("")}var st={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Ml(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function sl(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var a={};return(e.match(Lr)||[]).forEach(function(s){var i=Ye(s);if(i[0]==="<Relationship"){var l={};l.Type=i.Type,l.Target=i.Target,l.Id=i.Id,i.TargetMode&&(l.TargetMode=i.TargetMode);var c=i.TargetMode==="External"?i.Target:Gi(i.Target,t);r[c]=l,a[i.Id]=l}}),r["!id"]=a,r}function oi(e){var t=[er,Fe("Relationships",null,{xmlns:cr.RELS})];return Yt(e["!id"]).forEach(function(r){t[t.length]=Fe("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function bt(e,t,r,a,s,i){if(s||(s={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,s.Id="rId"+t,s.Type=a,s.Target=r,[st.HLINK,st.XPATH,st.XMISS].indexOf(s.Type)>-1&&(s.TargetMode="External"),e["!id"][s.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][s.Id]=s,e[("/"+s.Target).replace("//","/")]=s,t}var gN="application/vnd.oasis.opendocument.spreadsheet";function vN(e,t){for(var r=af(e),a,s;a=Il.exec(r);)switch(a[3]){case"manifest":break;case"file-entry":if(s=Ye(a[0],!1),s.path=="/"&&s.type!==gN)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw a}}function yN(e){var t=[er];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function km(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function bN(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function wN(e){var t=[er];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(km(e[r][0],e[r][1])),t.push(bN("",e[r][0]));return t.push(km("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function ug(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+vo.version+"</meta:generator></office:meta></office:document-meta>"}var Fn=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],NN=function(){for(var e=new Array(Fn.length),t=0;t<Fn.length;++t){var r=Fn[t],a="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+a+"[^>]*>([\\s\\S]*?)</"+a+">")}return e}();function fg(e){var t={};e=jt(e);for(var r=0;r<Fn.length;++r){var a=Fn[r],s=e.match(NN[r]);s!=null&&s.length>0&&(t[a[1]]=xt(s[1])),a[2]==="date"&&t[a[1]]&&(t[a[1]]=It(t[a[1]]))}return t}function P0(e,t,r,a,s){s[e]!=null||t==null||t===""||(s[e]=t,t=wt(t),a[a.length]=r?Fe(e,t,r):Nr(e,t))}function xg(e,t){var r=t||{},a=[er,Fe("cp:coreProperties",null,{"xmlns:cp":cr.CORE_PROPS,"xmlns:dc":cr.dc,"xmlns:dcterms":cr.dcterms,"xmlns:dcmitype":cr.dcmitype,"xmlns:xsi":cr.xsi})],s={};if(!e&&!r.Props)return a.join("");e&&(e.CreatedDate!=null&&P0("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:Ld(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},a,s),e.ModifiedDate!=null&&P0("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:Ld(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},a,s));for(var i=0;i!=Fn.length;++i){var l=Fn[i],c=r.Props&&r.Props[l[1]]!=null?r.Props[l[1]]:e?e[l[1]]:null;c===!0?c="1":c===!1?c="0":typeof c=="number"&&(c=String(c)),c!=null&&P0(l[0],c,null,a,s)}return a.length>2&&(a[a.length]="</cp:coreProperties>",a[1]=a[1].replace("/>",">")),a.join("")}var hs=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],mg=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function hg(e,t,r,a){var s=[];if(typeof e=="string")s=mm(e,a);else for(var i=0;i<e.length;++i)s=s.concat(e[i].map(function(d){return{v:d}}));var l=typeof t=="string"?mm(t,a).map(function(d){return d.v}):t,c=0,o=0;if(l.length>0)for(var u=0;u!==s.length;u+=2){switch(o=+s[u+1].v,s[u].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=o,r.SheetNames=l.slice(c,c+o);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=o,r.DefinedNames=l.slice(c,c+o);break;case"Charts":case"Diagramme":r.Chartsheets=o,r.ChartNames=l.slice(c,c+o);break}c+=o}}function jN(e,t,r){var a={};return t||(t={}),e=jt(e),hs.forEach(function(s){var i=(e.match(Pl(s[0]))||[])[1];switch(s[2]){case"string":i&&(t[s[1]]=xt(i));break;case"bool":t[s[1]]=i==="true";break;case"raw":var l=e.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));l&&l.length>0&&(a[s[1]]=l[1]);break}}),a.HeadingPairs&&a.TitlesOfParts&&hg(a.HeadingPairs,a.TitlesOfParts,t,r),t}function pg(e){var t=[],r=Fe;return e||(e={}),e.Application="SheetJS",t[t.length]=er,t[t.length]=Fe("Properties",null,{xmlns:cr.EXT_PROPS,"xmlns:vt":cr.vt}),hs.forEach(function(a){if(e[a[1]]!==void 0){var s;switch(a[2]){case"string":s=wt(String(e[a[1]]));break;case"bool":s=e[a[1]]?"true":"false";break}s!==void 0&&(t[t.length]=r(a[0],s))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(a){return"<vt:lpstr>"+wt(a)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var kN=/<[^>]+>[^<]*/g;function _N(e,t){var r={},a="",s=e.match(kN);if(s)for(var i=0;i!=s.length;++i){var l=s[i],c=Ye(l);switch(c[0]){case"<?xml":break;case"<Properties":break;case"<property":a=xt(c.name);break;case"</property>":a=null;break;default:if(l.indexOf("<vt:")===0){var o=l.split(">"),u=o[0].slice(4),d=o[1];switch(u){case"lpstr":case"bstr":case"lpwstr":r[a]=xt(d);break;case"bool":r[a]=Ft(d);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[a]=parseInt(d,10);break;case"r4":case"r8":case"decimal":r[a]=parseFloat(d);break;case"filetime":case"date":r[a]=It(d);break;case"cy":case"error":r[a]=xt(d);break;default:if(u.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",l,u,o)}}else if(l.slice(0,2)!=="</"){if(t.WTF)throw new Error(l)}}}return r}function gg(e){var t=[er,Fe("Properties",null,{xmlns:cr.CUST_PROPS,"xmlns:vt":cr.vt})];if(!e)return t.join("");var r=1;return Yt(e).forEach(function(s){++r,t[t.length]=Fe("property",Iw(e[s]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:wt(s)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Hd={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},D0;function SN(e,t,r){D0||(D0=Yo(Hd)),t=D0[t]||t,e[t]=r}function CN(e,t){var r=[];return Yt(Hd).map(function(a){for(var s=0;s<Fn.length;++s)if(Fn[s][1]==a)return Fn[s];for(s=0;s<hs.length;++s)if(hs[s][1]==a)return hs[s];throw a}).forEach(function(a){if(e[a[1]]!=null){var s=t&&t.Props&&t.Props[a[1]]!=null?t.Props[a[1]]:e[a[1]];switch(a[2]){case"date":s=new Date(s).toISOString().replace(/\.\d*Z/,"Z");break}typeof s=="number"?s=String(s):s===!0||s===!1?s=s?"1":"0":s instanceof Date&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"")),r.push(Nr(Hd[a[1]]||a[1],s))}}),Fe("DocumentProperties",r.join(""),{xmlns:dn.o})}function EN(e,t){var r=["Worksheets","SheetNames"],a="CustomDocumentProperties",s=[];return e&&Yt(e).forEach(function(i){if(Object.prototype.hasOwnProperty.call(e,i)){for(var l=0;l<Fn.length;++l)if(i==Fn[l][1])return;for(l=0;l<hs.length;++l)if(i==hs[l][1])return;for(l=0;l<r.length;++l)if(i==r[l])return;var c=e[i],o="string";typeof c=="number"?(o="float",c=String(c)):c===!0||c===!1?(o="boolean",c=c?"1":"0"):c=String(c),s.push(Fe(dm(i),c,{"dt:dt":o}))}}),t&&Yt(t).forEach(function(i){if(Object.prototype.hasOwnProperty.call(t,i)&&!(e&&Object.prototype.hasOwnProperty.call(e,i))){var l=t[i],c="string";typeof l=="number"?(c="float",l=String(l)):l===!0||l===!1?(c="boolean",l=l?"1":"0"):l instanceof Date?(c="dateTime.tz",l=l.toISOString()):l=String(l),s.push(Fe(dm(i),l,{"dt:dt":c}))}}),"<"+a+' xmlns="'+dn.o+'">'+s.join("")+"</"+a+">"}function pf(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function TN(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,a=r%Math.pow(2,32),s=(r-a)/Math.pow(2,32);a*=1e7,s*=1e7;var i=a/Math.pow(2,32)|0;i>0&&(a=a%Math.pow(2,32),s+=i);var l=ye(8);return l.write_shift(4,a),l.write_shift(4,s),l}function vg(e,t,r){var a=e.l,s=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-a&3;)++e.l;return s}function yg(e,t,r){var a=e.read_shift(0,"lpwstr");return a}function bg(e,t,r){return t===31?yg(e):vg(e,t,r)}function $d(e,t,r){return bg(e,t,r===!1?0:4)}function FN(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return bg(e,t,0)}function AN(e){for(var t=e.read_shift(4),r=[],a=0;a!=t;++a){var s=e.l;r[a]=e.read_shift(0,"lpwstr").replace(Vr,""),e.l-s&2&&(e.l+=2)}return r}function PN(e){for(var t=e.read_shift(4),r=[],a=0;a!=t;++a)r[a]=e.read_shift(0,"lpstr-cp").replace(Vr,"");return r}function DN(e){var t=e.l,r=Co(e,cg);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var a=Co(e,qr);return[r,a]}function IN(e){for(var t=e.read_shift(4),r=[],a=0;a<t/2;++a)r.push(DN(e));return r}function _m(e,t){for(var r=e.read_shift(4),a={},s=0;s!=r;++s){var i=e.read_shift(4),l=e.read_shift(4);a[i]=e.read_shift(l,t===1200?"utf16le":"utf8").replace(Vr,"").replace(Vi,"!"),t===1200&&l%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),a}function wg(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function MN(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function Co(e,t,r){var a=e.read_shift(2),s,i=r||{};if(e.l+=2,t!==Nm&&a!==t&&fN.indexOf(t)===-1&&!((t&65534)==4126&&(a&65534)==4126))throw new Error("Expected type "+t+" saw "+a);switch(t===Nm?a:t){case 2:return s=e.read_shift(2,"i"),i.raw||(e.l+=2),s;case 3:return s=e.read_shift(4,"i"),s;case 11:return e.read_shift(4)!==0;case 19:return s=e.read_shift(4),s;case 30:return vg(e,a,4).replace(Vr,"");case 31:return yg(e);case 64:return pf(e);case 65:return wg(e);case 71:return MN(e);case 80:return $d(e,a,!i.raw).replace(Vr,"");case 81:return FN(e,a).replace(Vr,"");case 4108:return IN(e);case 4126:case 4127:return a==4127?AN(e):PN(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+a)}}function Sm(e,t){var r=ye(4),a=ye(4);switch(r.write_shift(4,e==80?31:e),e){case 3:a.write_shift(-4,t);break;case 5:a=ye(8),a.write_shift(8,t,"f");break;case 11:a.write_shift(4,t?1:0);break;case 64:a=TN(t);break;case 31:case 80:for(a=ye(4+2*(t.length+1)+(t.length%2?0:2)),a.write_shift(4,t.length+1),a.write_shift(0,t,"dbcs");a.l!=a.length;)a.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return mr([r,a])}function Cm(e,t){var r=e.l,a=e.read_shift(4),s=e.read_shift(4),i=[],l=0,c=0,o=-1,u={};for(l=0;l!=s;++l){var d=e.read_shift(4),f=e.read_shift(4);i[l]=[d,f+r]}i.sort(function(b,y){return b[1]-y[1]});var x={};for(l=0;l!=s;++l){if(e.l!==i[l][1]){var h=!0;if(l>0&&t)switch(t[i[l-1][0]].t){case 2:e.l+2===i[l][1]&&(e.l+=2,h=!1);break;case 80:e.l<=i[l][1]&&(e.l=i[l][1],h=!1);break;case 4108:e.l<=i[l][1]&&(e.l=i[l][1],h=!1);break}if((!t||l==0)&&e.l<=i[l][1]&&(h=!1,e.l=i[l][1]),h)throw new Error("Read Error: Expected address "+i[l][1]+" at "+e.l+" :"+l)}if(t){var p=t[i[l][0]];if(x[p.n]=Co(e,p.t,{raw:!0}),p.p==="version"&&(x[p.n]=String(x[p.n]>>16)+"."+("0000"+String(x[p.n]&65535)).slice(-4)),p.n=="CodePage")switch(x[p.n]){case 0:x[p.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:zn(c=x[p.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+x[p.n])}}else if(i[l][0]===1){if(c=x.CodePage=Co(e,mf),zn(c),o!==-1){var m=e.l;e.l=i[o][1],u=_m(e,c),e.l=m}}else if(i[l][0]===0){if(c===0){o=l,e.l=i[l+1][1];continue}u=_m(e,c)}else{var w=u[i[l][0]],v;switch(e[e.l]){case 65:e.l+=4,v=wg(e);break;case 30:e.l+=4,v=$d(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,v=$d(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,v=e.read_shift(4,"i");break;case 19:e.l+=4,v=e.read_shift(4);break;case 5:e.l+=4,v=e.read_shift(8,"f");break;case 11:e.l+=4,v=Jt(e,4);break;case 64:e.l+=4,v=It(pf(e));break;default:throw new Error("unparsed value: "+e[e.l])}x[w]=v}}return e.l=r+a,x}var Ng=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function RN(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function Em(e,t,r){var a=ye(8),s=[],i=[],l=8,c=0,o=ye(8),u=ye(8);if(o.write_shift(4,2),o.write_shift(4,1200),u.write_shift(4,1),i.push(o),s.push(u),l+=8+o.length,!t){u=ye(8),u.write_shift(4,0),s.unshift(u);var d=[ye(4)];for(d[0].write_shift(4,e.length),c=0;c<e.length;++c){var f=e[c][0];for(o=ye(8+2*(f.length+1)+(f.length%2?0:2)),o.write_shift(4,c+2),o.write_shift(4,f.length+1),o.write_shift(0,f,"dbcs");o.l!=o.length;)o.write_shift(1,0);d.push(o)}o=mr(d),i.unshift(o),l+=8+o.length}for(c=0;c<e.length;++c)if(!(t&&!t[e[c][0]])&&!(Ng.indexOf(e[c][0])>-1||mg.indexOf(e[c][0])>-1)&&e[c][1]!=null){var x=e[c][1],h=0;if(t){h=+t[e[c][0]];var p=r[h];if(p.p=="version"&&typeof x=="string"){var m=x.split(".");x=(+m[0]<<16)+(+m[1]||0)}o=Sm(p.t,x)}else{var w=RN(x);w==-1&&(w=31,x=String(x)),o=Sm(w,x)}i.push(o),u=ye(8),u.write_shift(4,t?h:2+c),s.push(u),l+=8+o.length}var v=8*(i.length+1);for(c=0;c<i.length;++c)s[c].write_shift(4,v),v+=i[c].length;return a.write_shift(4,l),a.write_shift(4,i.length),mr([a].concat(s).concat(i))}function Tm(e,t,r){var a=e.content;if(!a)return{};wr(a,0);var s,i,l,c,o=0;a.chk("feff","Byte Order: "),a.read_shift(2);var u=a.read_shift(4),d=a.read_shift(16);if(d!==$e.utils.consts.HEADER_CLSID&&d!==r)throw new Error("Bad PropertySet CLSID "+d);if(s=a.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(i=a.read_shift(16),c=a.read_shift(4),s===1&&c!==a.l)throw new Error("Length mismatch: "+c+" !== "+a.l);s===2&&(l=a.read_shift(16),o=a.read_shift(4));var f=Cm(a,t),x={SystemIdentifier:u};for(var h in f)x[h]=f[h];if(x.FMTID=i,s===1)return x;if(o-a.l==2&&(a.l+=2),a.l!==o)throw new Error("Length mismatch 2: "+a.l+" !== "+o);var p;try{p=Cm(a,null)}catch{}for(h in p)x[h]=p[h];return x.FMTID=[i,l],x}function Fm(e,t,r,a,s,i){var l=ye(s?68:48),c=[l];l.write_shift(2,65534),l.write_shift(2,0),l.write_shift(4,842412599),l.write_shift(16,$e.utils.consts.HEADER_CLSID,"hex"),l.write_shift(4,s?2:1),l.write_shift(16,t,"hex"),l.write_shift(4,s?68:48);var o=Em(e,r,a);if(c.push(o),s){var u=Em(s,null,null);l.write_shift(16,i,"hex"),l.write_shift(4,68+o.length),c.push(u)}return mr(c)}function Ta(e,t){return e.read_shift(t),null}function ON(e,t){t||(t=ye(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function LN(e,t,r){for(var a=[],s=e.l+t;e.l<s;)a.push(r(e,s-e.l));if(s!==e.l)throw new Error("Slurp error");return a}function Jt(e,t){return e.read_shift(t)===1}function Hr(e,t){return t||(t=ye(2)),t.write_shift(2,+!!e),t}function ar(e){return e.read_shift(2,"u")}function _n(e,t){return t||(t=ye(2)),t.write_shift(2,e),t}function jg(e,t){return LN(e,t,ar)}function BN(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function kg(e,t,r){return r||(r=ye(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function Jl(e,t,r){var a=e.read_shift(r&&r.biff>=12?2:1),s="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var i=e.read_shift(1);i&&(s="dbcs-cont")}else r.biff==12&&(s="wstr");r.biff>=2&&r.biff<=5&&(s="cpstr");var l=a?e.read_shift(a,s):"";return l}function UN(e){var t=e.read_shift(2),r=e.read_shift(1),a=r&4,s=r&8,i=1+(r&1),l=0,c,o={};s&&(l=e.read_shift(2)),a&&(c=e.read_shift(4));var u=i==2?"dbcs-cont":"sbcs-cont",d=t===0?"":e.read_shift(t,u);return s&&(e.l+=4*l),a&&(e.l+=c),o.t=d,s||(o.raw="<t>"+o.t+"</t>",o.r=o.t),o}function zN(e){var t=e.t||"",r=ye(3);r.write_shift(2,t.length),r.write_shift(1,1);var a=ye(2*t.length);a.write_shift(2*t.length,t,"utf16le");var s=[r,a];return mr(s)}function Cs(e,t,r){var a;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var s=e.read_shift(1);return s===0?a=e.read_shift(t,"sbcs-cont"):a=e.read_shift(t,"dbcs-cont"),a}function Ql(e,t,r){var a=e.read_shift(r&&r.biff==2?1:2);return a===0?(e.l++,""):Cs(e,a,r)}function Os(e,t,r){if(r.biff>5)return Ql(e,t,r);var a=e.read_shift(1);return a===0?(e.l++,""):e.read_shift(a,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function _g(e,t,r){return r||(r=ye(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function WN(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function HN(e){var t=e.read_shift(4),r=e.l,a=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(a=!0),e.l=r);var s=e.read_shift((a?t-24:t)>>1,"utf16le").replace(Vr,"");return a&&(e.l+=24),s}function $N(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var a=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=e.read_shift(4);if(s===0)return r+a.replace(/\\/g,"/");var i=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var l=e.read_shift(i>>1,"utf16le").replace(Vr,"");return r+l}function VN(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return HN(e);case"0303000000000000c000000000000046":return $N(e);default:throw new Error("Unsupported Moniker "+r)}}function _c(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(Vr,""):"";return r}function Am(e,t){t||(t=ye(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function GN(e,t){var r=e.l+t,a=e.read_shift(4);if(a!==2)throw new Error("Unrecognized streamVersion: "+a);var s=e.read_shift(2);e.l+=2;var i,l,c,o,u="",d,f;s&16&&(i=_c(e,r-e.l)),s&128&&(l=_c(e,r-e.l)),(s&257)===257&&(c=_c(e,r-e.l)),(s&257)===1&&(o=VN(e,r-e.l)),s&8&&(u=_c(e,r-e.l)),s&32&&(d=e.read_shift(16)),s&64&&(f=pf(e)),e.l=r;var x=l||c||o||"";x&&u&&(x+="#"+u),x||(x="#"+u),s&2&&x.charAt(0)=="/"&&x.charAt(1)!="/"&&(x="file://"+x);var h={Target:x};return d&&(h.guid=d),f&&(h.time=f),i&&(h.Tooltip=i),h}function XN(e){var t=ye(512),r=0,a=e.Target;a.slice(0,7)=="file://"&&(a=a.slice(7));var s=a.indexOf("#"),i=s>-1?31:23;switch(a.charAt(0)){case"#":i=28;break;case".":i&=-3;break}t.write_shift(4,2),t.write_shift(4,i);var l=[8,6815827,6619237,4849780,83];for(r=0;r<l.length;++r)t.write_shift(4,l[r]);if(i==28)a=a.slice(1),Am(a,t);else if(i&2){for(l="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<l.length;++r)t.write_shift(1,parseInt(l[r],16));var c=s>-1?a.slice(0,s):a;for(t.write_shift(4,2*(c.length+1)),r=0;r<c.length;++r)t.write_shift(2,c.charCodeAt(r));t.write_shift(2,0),i&8&&Am(s>-1?a.slice(s+1):"",t)}else{for(l="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<l.length;++r)t.write_shift(1,parseInt(l[r],16));for(var o=0;a.slice(o*3,o*3+3)=="../"||a.slice(o*3,o*3+3)=="..\\";)++o;for(t.write_shift(2,o),t.write_shift(4,a.length-3*o+1),r=0;r<a.length-3*o;++r)t.write_shift(1,a.charCodeAt(r+3*o)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function Sg(e){var t=e.read_shift(1),r=e.read_shift(1),a=e.read_shift(1),s=e.read_shift(1);return[t,r,a,s]}function Cg(e,t){var r=Sg(e);return r[3]=0,r}function ia(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2);return{r:t,c:r,ixfe:a}}function Es(e,t,r,a){return a||(a=ye(6)),a.write_shift(2,e),a.write_shift(2,t),a.write_shift(2,r||0),a}function KN(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function YN(e,t,r){return t===0?"":Os(e,t,r)}function qN(e,t,r){var a=r.biff>8?4:2,s=e.read_shift(a),i=e.read_shift(a,"i"),l=e.read_shift(a,"i");return[s,i,l]}function Eg(e){var t=e.read_shift(2),r=xf(e);return[t,r]}function JN(e,t,r){e.l+=4,t-=4;var a=e.l+t,s=Jl(e,t,r),i=e.read_shift(2);if(a-=e.l,i!==a)throw new Error("Malformed AddinUdf: padding = "+a+" != "+i);return e.l+=i,s}function Qo(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2);return{s:{c:a,r:t},e:{c:s,r}}}function Tg(e,t){return t||(t=ye(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function Fg(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(1),s=e.read_shift(1);return{s:{c:a,r:t},e:{c:s,r}}}var QN=Fg;function Ag(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2);return e.l+=12,[r,t,a]}function ZN(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function ej(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function Tr(e){e.l+=2,e.l+=e.read_shift(2)}var tj={0:Tr,4:Tr,5:Tr,6:Tr,7:ej,8:Tr,9:Tr,10:Tr,11:Tr,12:Tr,13:ZN,14:Tr,15:Tr,16:Tr,17:Tr,18:Tr,19:Tr,20:Tr,21:Ag};function rj(e,t){for(var r=e.l+t,a=[];e.l<r;){var s=e.read_shift(2);e.l-=2;try{a.push(tj[s](e,r-e.l))}catch{return e.l=r,a}}return e.l!=r&&(e.l=r),a}function Sc(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function gf(e,t,r){var a=1536,s=16;switch(r.bookType){case"biff8":break;case"biff5":a=1280,s=8;break;case"biff4":a=4,s=6;break;case"biff3":a=3,s=6;break;case"biff2":a=2,s=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var i=ye(s);return i.write_shift(2,a),i.write_shift(2,t),s>4&&i.write_shift(2,29282),s>6&&i.write_shift(2,1997),s>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function nj(e,t){return t===0||e.read_shift(2),1200}function aj(e,t,r){if(r.enc)return e.l+=t,"";var a=e.l,s=Os(e,0,r);return e.read_shift(t+a-e.l),s}function sj(e,t){var r=!t||t.biff==8,a=ye(r?112:54);for(a.write_shift(t.biff==8?2:1,7),r&&a.write_shift(1,0),a.write_shift(4,859007059),a.write_shift(4,5458548|(r?0:536870912));a.l<a.length;)a.write_shift(1,r?0:32);return a}function ij(e,t,r){var a=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:a&16,fBelow:a&64,fRight:a&128}}function lj(e,t,r){var a=e.read_shift(4),s=e.read_shift(1)&3,i=e.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule";break}var l=Jl(e,0,r);return l.length===0&&(l="Sheet1"),{pos:a,hs:s,dt:i,name:l}}function cj(e,t){var r=!t||t.biff>=8?2:1,a=ye(8+r*e.name.length);a.write_shift(4,e.pos),a.write_shift(1,e.hs||0),a.write_shift(1,e.dt),a.write_shift(1,e.name.length),t.biff>=8&&a.write_shift(1,1),a.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var s=a.slice(0,a.l);return s.l=a.l,s}function oj(e,t){for(var r=e.l+t,a=e.read_shift(4),s=e.read_shift(4),i=[],l=0;l!=s&&e.l<r;++l)i.push(UN(e));return i.Count=a,i.Unique=s,i}function dj(e,t){var r=ye(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var a=[],s=0;s<e.length;++s)a[s]=zN(e[s]);var i=mr([r].concat(a));return i.parts=[r.length].concat(a.map(function(l){return l.length})),i}function uj(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function fj(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var a=e.read_shift(1);return e.l+=3,a&7&&(t.level=a&7),a&32&&(t.hidden=!0),a&64&&(t.hpt=r/20),t}function xj(e){var t=KN(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function mj(e){return e.read_shift(2),e.read_shift(4)}function Pm(e,t,r){var a=0;r&&r.biff==2||(a=e.read_shift(2));var s=e.read_shift(2);r&&r.biff==2&&(a=1-(s>>15),s&=32767);var i={Unsynced:a&1,DyZero:(a&2)>>1,ExAsc:(a&4)>>2,ExDsc:(a&8)>>3};return[i,s]}function hj(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2),o=e.read_shift(2),u=e.read_shift(2);return{Pos:[t,r],Dim:[a,s],Flags:i,CurTab:l,FirstTab:c,Selected:o,TabRatio:u}}function pj(){var e=ye(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function gj(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var a=e.read_shift(2);return{RTL:a&64}}function vj(e){var t=ye(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function yj(){}function bj(e,t,r){var a={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return a.name=Jl(e,0,r),a}function wj(e,t){var r=e.name||"Arial",a=t&&t.biff==5,s=a?15+r.length:16+2*r.length,i=ye(s);return i.write_shift(2,(e.sz||12)*20),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,r.length),a||i.write_shift(1,1),i.write_shift((a?1:2)*r.length,r,a?"sbcs":"utf16le"),i}function Nj(e){var t=ia(e);return t.isst=e.read_shift(4),t}function jj(e,t,r,a){var s=ye(10);return Es(e,t,a,s),s.write_shift(4,r),s}function kj(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var a=e.l+t,s=ia(e);r.biff==2&&e.l++;var i=Ql(e,a-e.l,r);return s.val=i,s}function _j(e,t,r,a,s){var i=!s||s.biff==8,l=ye(8+ +i+(1+i)*r.length);return Es(e,t,a,l),l.write_shift(2,r.length),i&&l.write_shift(1,1),l.write_shift((1+i)*r.length,r,i?"utf16le":"sbcs"),l}function Sj(e,t,r){var a=e.read_shift(2),s=Os(e,0,r);return[a,s]}function Cj(e,t,r,a){var s=r&&r.biff==5;a||(a=ye(s?3+t.length:5+2*t.length)),a.write_shift(2,e),a.write_shift(s?1:2,t.length),s||a.write_shift(1,1),a.write_shift((s?1:2)*t.length,t,s?"sbcs":"utf16le");var i=a.length>a.l?a.slice(0,a.l):a;return i.l==null&&(i.l=i.length),i}var Ej=Os;function Dm(e,t,r){var a=e.l+t,s=r.biff==8||!r.biff?4:2,i=e.read_shift(s),l=e.read_shift(s),c=e.read_shift(2),o=e.read_shift(2);return e.l=a,{s:{r:i,c},e:{r:l,c:o}}}function Tj(e,t){var r=t.biff==8||!t.biff?4:2,a=ye(2*r+6);return a.write_shift(r,e.s.r),a.write_shift(r,e.e.r+1),a.write_shift(2,e.s.c),a.write_shift(2,e.e.c+1),a.write_shift(2,0),a}function Fj(e){var t=e.read_shift(2),r=e.read_shift(2),a=Eg(e);return{r:t,c:r,ixfe:a[0],rknum:a[1]}}function Aj(e,t){for(var r=e.l+t-2,a=e.read_shift(2),s=e.read_shift(2),i=[];e.l<r;)i.push(Eg(e));if(e.l!==r)throw new Error("MulRK read error");var l=e.read_shift(2);if(i.length!=l-s+1)throw new Error("MulRK length mismatch");return{r:a,c:s,C:l,rkrec:i}}function Pj(e,t){for(var r=e.l+t-2,a=e.read_shift(2),s=e.read_shift(2),i=[];e.l<r;)i.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var l=e.read_shift(2);if(i.length!=l-s+1)throw new Error("MulBlank length mismatch");return{r:a,c:s,C:l,ixfe:i}}function Dj(e,t,r,a){var s={},i=e.read_shift(4),l=e.read_shift(4),c=e.read_shift(4),o=e.read_shift(2);return s.patternType=xN[c>>26],a.cellStyles&&(s.alc=i&7,s.fWrap=i>>3&1,s.alcV=i>>4&7,s.fJustLast=i>>7&1,s.trot=i>>8&255,s.cIndent=i>>16&15,s.fShrinkToFit=i>>20&1,s.iReadOrder=i>>22&2,s.fAtrNum=i>>26&1,s.fAtrFnt=i>>27&1,s.fAtrAlc=i>>28&1,s.fAtrBdr=i>>29&1,s.fAtrPat=i>>30&1,s.fAtrProt=i>>31&1,s.dgLeft=l&15,s.dgRight=l>>4&15,s.dgTop=l>>8&15,s.dgBottom=l>>12&15,s.icvLeft=l>>16&127,s.icvRight=l>>23&127,s.grbitDiag=l>>30&3,s.icvTop=c&127,s.icvBottom=c>>7&127,s.icvDiag=c>>14&127,s.dgDiag=c>>21&15,s.icvFore=o&127,s.icvBack=o>>7&127,s.fsxButton=o>>14&1),s}function Ij(e,t,r){var a={};return a.ifnt=e.read_shift(2),a.numFmtId=e.read_shift(2),a.flags=e.read_shift(2),a.fStyle=a.flags>>2&1,t-=6,a.data=Dj(e,t,a.fStyle,r),a}function Im(e,t,r,a){var s=r&&r.biff==5;a||(a=ye(s?16:20)),a.write_shift(2,0),e.style?(a.write_shift(2,e.numFmtId||0),a.write_shift(2,65524)):(a.write_shift(2,e.numFmtId||0),a.write_shift(2,t<<4));var i=0;return e.numFmtId>0&&s&&(i|=1024),a.write_shift(4,i),a.write_shift(4,0),s||a.write_shift(4,0),a.write_shift(2,0),a}function Mj(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function Rj(e){var t=ye(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function Mm(e,t,r){var a=ia(e);(r.biff==2||t==9)&&++e.l;var s=BN(e);return a.val=s,a.t=s===!0||s===!1?"b":"e",a}function Oj(e,t,r,a,s,i){var l=ye(8);return Es(e,t,a,l),kg(r,i,l),l}function Lj(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var a=ia(e),s=Ir(e);return a.val=s,a}function Bj(e,t,r,a){var s=ye(14);return Es(e,t,a,s),Ss(r,s),s}var Rm=YN;function Uj(e,t,r){var a=e.l+t,s=e.read_shift(2),i=e.read_shift(2);if(r.sbcch=i,i==1025||i==14849)return[i,s];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var l=Cs(e,i),c=[];a>e.l;)c.push(Ql(e));return[i,s,l,c]}function Om(e,t,r){var a=e.read_shift(2),s,i={fBuiltIn:a&1,fWantAdvise:a>>>1&1,fWantPict:a>>>2&1,fOle:a>>>3&1,fOleLink:a>>>4&1,cf:a>>>5&1023,fIcon:a>>>15&1};return r.sbcch===14849&&(s=JN(e,t-2,r)),i.body=s||e.read_shift(t-2),typeof s=="string"&&(i.Name=s),i}var zj=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function Lm(e,t,r){var a=e.l+t,s=e.read_shift(2),i=e.read_shift(1),l=e.read_shift(1),c=e.read_shift(r&&r.biff==2?1:2),o=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),o=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var u=Cs(e,l,r);s&32&&(u=zj[u.charCodeAt(0)]);var d=a-e.l;r&&r.biff==2&&--d;var f=a==e.l||c===0||!(d>0)?[]:r_(e,d,r,c);return{chKey:i,Name:u,itab:o,rgce:f}}function Pg(e,t,r){if(r.biff<8)return Wj(e,t,r);for(var a=[],s=e.l+t,i=e.read_shift(r.biff>8?4:2);i--!==0;)a.push(qN(e,r.biff>8?12:6,r));if(e.l!=s)throw new Error("Bad ExternSheet: "+e.l+" != "+s);return a}function Wj(e,t,r){e[e.l+1]==3&&e[e.l]++;var a=Jl(e,t,r);return a.charCodeAt(0)==3?a.slice(1):a}function Hj(e,t,r){if(r.biff<8){e.l+=t;return}var a=e.read_shift(2),s=e.read_shift(2),i=Cs(e,a,r),l=Cs(e,s,r);return[i,l]}function $j(e,t,r){var a=Fg(e);e.l++;var s=e.read_shift(1);return t-=8,[n_(e,t,r),s,a]}function Bm(e,t,r){var a=QN(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[a,e_(e,t,r)]}function Vj(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,a=e.read_shift(4);return[t,r,a]}function Gj(e,t,r){if(!(r.biff<8)){var a=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),l=e.read_shift(2),c=Os(e,0,r);return r.biff<8&&e.read_shift(1),[{r:a,c:s},c,l,i]}}function Xj(e,t,r){return Gj(e,t,r)}function Kj(e,t){for(var r=[],a=e.read_shift(2);a--;)r.push(Qo(e));return r}function Yj(e){var t=ye(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)Tg(e[r],t);return t}function qj(e,t,r){if(r&&r.biff<8)return Qj(e,t,r);var a=Ag(e),s=rj(e,t-22,a[1]);return{cmo:a,ft:s}}var Jj={8:function(e,t){var r=e.l+t;e.l+=10;var a=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var s=e.read_shift(1);return e.l+=s,e.l=r,{fmt:a}}};function Qj(e,t,r){e.l+=4;var a=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var l=[];return l.push((Jj[a]||Or)(e,t,r)),{cmo:[s,a,i],ft:l}}function Zj(e,t,r){var a=e.l,s="";try{e.l+=4;var i=(r.lastobj||{cmo:[0,0]}).cmo[1],l;[0,5,7,11,12,14].indexOf(i)==-1?e.l+=6:l=WN(e,6,r);var c=e.read_shift(2);e.read_shift(2),ar(e,2);var o=e.read_shift(2);e.l+=o;for(var u=1;u<e.lens.length-1;++u){if(e.l-a!=e.lens[u])throw new Error("TxO: bad continue record");var d=e[e.l],f=Cs(e,e.lens[u+1]-e.lens[u]-1);if(s+=f,s.length>=(d?c:2*c))break}if(s.length!==c&&s.length!==c*2)throw new Error("cchText: "+c+" != "+s.length);return e.l=a+t,{t:s}}catch{return e.l=a+t,{t:s}}}function e4(e,t){var r=Qo(e);e.l+=16;var a=GN(e,t-24);return[r,a]}function t4(e){var t=ye(24),r=Ht(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var a="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<16;++s)t.write_shift(1,parseInt(a[s],16));return mr([t,XN(e[1])])}function r4(e,t){e.read_shift(2);var r=Qo(e),a=e.read_shift((t-10)/2,"dbcs-cont");return a=a.replace(Vr,""),[r,a]}function n4(e){var t=e[1].Tooltip,r=ye(10+2*(t.length+1));r.write_shift(2,2048);var a=Ht(e[0]);r.write_shift(2,a.r),r.write_shift(2,a.r),r.write_shift(2,a.c),r.write_shift(2,a.c);for(var s=0;s<t.length;++s)r.write_shift(2,t.charCodeAt(s));return r.write_shift(2,0),r}function a4(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=jm[r]||r,r=e.read_shift(2),t[1]=jm[r]||r,t}function s4(e){return e||(e=ye(4)),e.write_shift(2,1),e.write_shift(2,1),e}function i4(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(Cg(e));return r}function l4(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(Cg(e));return r}function c4(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function Dg(e,t,r){if(!r.cellStyles)return Or(e,t);var a=r&&r.biff>=12?4:2,s=e.read_shift(a),i=e.read_shift(a),l=e.read_shift(a),c=e.read_shift(a),o=e.read_shift(2);a==2&&(e.l+=2);var u={s,e:i,w:l,ixfe:c,flags:o};return(r.biff>=5||!r.biff)&&(u.level=o>>8&7),u}function o4(e,t){var r=ye(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var a=0;return e.hidden&&(a|=1),r.write_shift(1,a),a=e.level||0,r.write_shift(1,a),r.write_shift(2,0),r}function d4(e,t){var r={};return t<32||(e.l+=16,r.header=Ir(e),r.footer=Ir(e),e.l+=2),r}function u4(e,t,r){var a={area:!1};if(r.biff!=5)return e.l+=t,a;var s=e.read_shift(1);return e.l+=3,s&16&&(a.area=!0),a}function f4(e){for(var t=ye(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var x4=ia,m4=jg,h4=Ql;function p4(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(4),s={fmt:t,env:r,len:a,data:e.slice(e.l,e.l+a)};return e.l+=a,s}function g4(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var a=ia(e);++e.l;var s=Os(e,t-7,r);return a.t="str",a.val=s,a}function v4(e){var t=ia(e);++e.l;var r=Ir(e);return t.t="n",t.val=r,t}function y4(e,t,r){var a=ye(15);return rc(a,e,t),a.write_shift(8,r,"f"),a}function b4(e){var t=ia(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function w4(e,t,r){var a=ye(9);return rc(a,e,t),a.write_shift(2,r),a}function N4(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function j4(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function k4(e,t,r){var a=e.l+t,s=ia(e),i=e.read_shift(2),l=Cs(e,i,r);return e.l=a,s.t="str",s.val=l,s}var _4=[2,3,48,49,131,139,140,245],Vd=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Yo({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(c,o){var u=[],d=Ya(1);switch(o.type){case"base64":d=fn(gn(c));break;case"binary":d=fn(c);break;case"buffer":case"array":d=c;break}wr(d,0);var f=d.read_shift(1),x=!!(f&136),h=!1,p=!1;switch(f){case 2:break;case 3:break;case 48:h=!0,x=!0;break;case 49:h=!0,x=!0;break;case 131:break;case 139:break;case 140:p=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var m=0,w=521;f==2&&(m=d.read_shift(2)),d.l+=3,f!=2&&(m=d.read_shift(4)),m>1048576&&(m=1e6),f!=2&&(w=d.read_shift(2));var v=d.read_shift(2),b=o.codepage||1252;f!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(b=e[d[d.l]]),d.l+=1,d.l+=2),p&&(d.l+=36);for(var y=[],N={},A=Math.min(d.length,f==2?521:w-10-(h?264:0)),k=p?32:11;d.l<A&&d[d.l]!=13;)switch(N={},N.name=Ia.utils.decode(b,d.slice(d.l,d.l+k)).replace(/[\u0000\r\n].*$/g,""),d.l+=k,N.type=String.fromCharCode(d.read_shift(1)),f!=2&&!p&&(N.offset=d.read_shift(4)),N.len=d.read_shift(1),f==2&&(N.offset=d.read_shift(2)),N.dec=d.read_shift(1),N.name.length&&y.push(N),f!=2&&(d.l+=p?13:14),N.type){case"B":(!h||N.len!=8)&&o.WTF&&console.log("Skipping "+N.name+":"+N.type);break;case"G":case"P":o.WTF&&console.log("Skipping "+N.name+":"+N.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+N.type)}if(d[d.l]!==13&&(d.l=w-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=w;var _=0,j=0;for(u[0]=[],j=0;j!=y.length;++j)u[0][j]=y[j].name;for(;m-- >0;){if(d[d.l]===42){d.l+=v;continue}for(++d.l,u[++_]=[],j=0,j=0;j!=y.length;++j){var P=d.slice(d.l,d.l+y[j].len);d.l+=y[j].len,wr(P,0);var D=Ia.utils.decode(b,P);switch(y[j].type){case"C":D.trim().length&&(u[_][j]=D.replace(/\s+$/,""));break;case"D":D.length===8?u[_][j]=new Date(+D.slice(0,4),+D.slice(4,6)-1,+D.slice(6,8)):u[_][j]=D;break;case"F":u[_][j]=parseFloat(D.trim());break;case"+":case"I":u[_][j]=p?P.read_shift(-4,"i")^2147483648:P.read_shift(4,"i");break;case"L":switch(D.trim().toUpperCase()){case"Y":case"T":u[_][j]=!0;break;case"N":case"F":u[_][j]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+D+"|")}break;case"M":if(!x)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));u[_][j]="##MEMO##"+(p?parseInt(D.trim(),10):P.read_shift(4));break;case"N":D=D.replace(/\u0000/g,"").trim(),D&&D!="."&&(u[_][j]=+D||0);break;case"@":u[_][j]=new Date(P.read_shift(-8,"f")-621356832e5);break;case"T":u[_][j]=new Date((P.read_shift(4)-2440588)*864e5+P.read_shift(4));break;case"Y":u[_][j]=P.read_shift(4,"i")/1e4+P.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[_][j]=-P.read_shift(-8,"f");break;case"B":if(h&&y[j].len==8){u[_][j]=P.read_shift(8,"f");break}case"G":case"P":P.l+=y[j].len;break;case"0":if(y[j].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+y[j].type)}}}if(f!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return o&&o.sheetRows&&(u=u.slice(0,o.sheetRows)),o.DBF=y,u}function a(c,o){var u=o||{};u.dateNF||(u.dateNF="yyyymmdd");var d=Ei(r(c,u),u);return d["!cols"]=u.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete u.DBF,d}function s(c,o){try{return ns(a(c,o),o)}catch(u){if(o&&o.WTF)throw u}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function l(c,o){var u=o||{};if(+u.codepage>=0&&zn(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var d=rn(),f=Fo(c,{header:1,raw:!0,cellDates:!0}),x=f[0],h=f.slice(1),p=c["!cols"]||[],m=0,w=0,v=0,b=1;for(m=0;m<x.length;++m){if(((p[m]||{}).DBF||{}).name){x[m]=p[m].DBF.name,++v;continue}if(x[m]!=null){if(++v,typeof x[m]=="number"&&(x[m]=x[m].toString(10)),typeof x[m]!="string")throw new Error("DBF Invalid column name "+x[m]+" |"+typeof x[m]+"|");if(x.indexOf(x[m])!==m){for(w=0;w<1024;++w)if(x.indexOf(x[m]+"_"+w)==-1){x[m]+="_"+w;break}}}}var y=mt(c["!ref"]),N=[],A=[],k=[];for(m=0;m<=y.e.c-y.s.c;++m){var _="",j="",P=0,D=[];for(w=0;w<h.length;++w)h[w][m]!=null&&D.push(h[w][m]);if(D.length==0||x[m]==null){N[m]="?";continue}for(w=0;w<D.length;++w){switch(typeof D[w]){case"number":j="B";break;case"string":j="C";break;case"boolean":j="L";break;case"object":j=D[w]instanceof Date?"D":"C";break;default:j="C"}P=Math.max(P,String(D[w]).length),_=_&&_!=j?"C":j}P>250&&(P=250),j=((p[m]||{}).DBF||{}).type,j=="C"&&p[m].DBF.len>P&&(P=p[m].DBF.len),_=="B"&&j=="N"&&(_="N",k[m]=p[m].DBF.dec,P=p[m].DBF.len),A[m]=_=="C"||j=="N"?P:i[_]||0,b+=A[m],N[m]=_}var K=d.next(32);for(K.write_shift(4,318902576),K.write_shift(4,h.length),K.write_shift(2,296+32*v),K.write_shift(2,b),m=0;m<4;++m)K.write_shift(4,0);for(K.write_shift(4,0|(+t[N1]||3)<<8),m=0,w=0;m<x.length;++m)if(x[m]!=null){var E=d.next(32),Y=(x[m].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);E.write_shift(1,Y,"sbcs"),E.write_shift(1,N[m]=="?"?"C":N[m],"sbcs"),E.write_shift(4,w),E.write_shift(1,A[m]||i[N[m]]||0),E.write_shift(1,k[m]||0),E.write_shift(1,2),E.write_shift(4,0),E.write_shift(1,0),E.write_shift(4,0),E.write_shift(4,0),w+=A[m]||i[N[m]]||0}var B=d.next(264);for(B.write_shift(4,13),m=0;m<65;++m)B.write_shift(4,0);for(m=0;m<h.length;++m){var te=d.next(b);for(te.write_shift(1,0),w=0;w<x.length;++w)if(x[w]!=null)switch(N[w]){case"L":te.write_shift(1,h[m][w]==null?63:h[m][w]?84:70);break;case"B":te.write_shift(8,h[m][w]||0,"f");break;case"N":var re="0";for(typeof h[m][w]=="number"&&(re=h[m][w].toFixed(k[w]||0)),v=0;v<A[w]-re.length;++v)te.write_shift(1,32);te.write_shift(1,re,"sbcs");break;case"D":h[m][w]?(te.write_shift(4,("0000"+h[m][w].getFullYear()).slice(-4),"sbcs"),te.write_shift(2,("00"+(h[m][w].getMonth()+1)).slice(-2),"sbcs"),te.write_shift(2,("00"+h[m][w].getDate()).slice(-2),"sbcs")):te.write_shift(8,"00000000","sbcs");break;case"C":var Q=String(h[m][w]!=null?h[m][w]:"").slice(0,A[w]);for(te.write_shift(1,Q,"sbcs"),v=0;v<A[w]-Q.length;++v)te.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:s,to_sheet:a,from_sheet:l}}(),Ig=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Yt(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(x,h){var p=e[h];return typeof p=="number"?qx(p):p},a=function(x,h,p){var m=h.charCodeAt(0)-32<<4|p.charCodeAt(0)-48;return m==59?x:qx(m)};e["|"]=254;function s(x,h){switch(h.type){case"base64":return i(gn(x),h);case"binary":return i(x,h);case"buffer":return i(at&&Buffer.isBuffer(x)?x.toString("binary"):rs(x),h);case"array":return i(_s(x),h)}throw new Error("Unrecognized type "+h.type)}function i(x,h){var p=x.split(/[\n\r]+/),m=-1,w=-1,v=0,b=0,y=[],N=[],A=null,k={},_=[],j=[],P=[],D=0,K;for(+h.codepage>=0&&zn(+h.codepage);v!==p.length;++v){D=0;var E=p[v].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,a).replace(t,r),Y=E.replace(/;;/g,"\0").split(";").map(function(S){return S.replace(/\u0000/g,";")}),B=Y[0],te;if(E.length>0)switch(B){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":Y[1].charAt(0)=="P"&&N.push(E.slice(3).replace(/;;/g,";"));break;case"C":var re=!1,Q=!1,Z=!1,z=!1,ne=-1,xe=-1;for(b=1;b<Y.length;++b)switch(Y[b].charAt(0)){case"A":break;case"X":w=parseInt(Y[b].slice(1))-1,Q=!0;break;case"Y":for(m=parseInt(Y[b].slice(1))-1,Q||(w=0),K=y.length;K<=m;++K)y[K]=[];break;case"K":te=Y[b].slice(1),te.charAt(0)==='"'?te=te.slice(1,te.length-1):te==="TRUE"?te=!0:te==="FALSE"?te=!1:isNaN(Vn(te))?isNaN(bi(te).getDate())||(te=It(te)):(te=Vn(te),A!==null&&Si(A)&&(te=Jo(te))),re=!0;break;case"E":z=!0;var O=di(Y[b].slice(1),{r:m,c:w});y[m][w]=[y[m][w],O];break;case"S":Z=!0,y[m][w]=[y[m][w],"S5S"];break;case"G":break;case"R":ne=parseInt(Y[b].slice(1))-1;break;case"C":xe=parseInt(Y[b].slice(1))-1;break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+E)}if(re&&(y[m][w]&&y[m][w].length==2?y[m][w][0]=te:y[m][w]=te,A=null),Z){if(z)throw new Error("SYLK shared formula cannot have own formula");var R=ne>-1&&y[ne][xe];if(!R||!R[1])throw new Error("SYLK shared formula cannot find base");y[m][w][1]=Qg(R[1],{r:m-ne,c:w-xe})}break;case"F":var g=0;for(b=1;b<Y.length;++b)switch(Y[b].charAt(0)){case"X":w=parseInt(Y[b].slice(1))-1,++g;break;case"Y":for(m=parseInt(Y[b].slice(1))-1,K=y.length;K<=m;++K)y[K]=[];break;case"M":D=parseInt(Y[b].slice(1))/20;break;case"F":break;case"G":break;case"P":A=N[parseInt(Y[b].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(P=Y[b].slice(1).split(" "),K=parseInt(P[0],10);K<=parseInt(P[1],10);++K)D=parseInt(P[2],10),j[K-1]=D===0?{hidden:!0}:{wch:D},qa(j[K-1]);break;case"C":w=parseInt(Y[b].slice(1))-1,j[w]||(j[w]={});break;case"R":m=parseInt(Y[b].slice(1))-1,_[m]||(_[m]={}),D>0?(_[m].hpt=D,_[m].hpx=Ni(D)):D===0&&(_[m].hidden=!0);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+E)}g<1&&(A=null);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+E)}}return _.length>0&&(k["!rows"]=_),j.length>0&&(k["!cols"]=j),h&&h.sheetRows&&(y=y.slice(0,h.sheetRows)),[y,k]}function l(x,h){var p=s(x,h),m=p[0],w=p[1],v=Ei(m,h);return Yt(w).forEach(function(b){v[b]=w[b]}),v}function c(x,h){return ns(l(x,h),h)}function o(x,h,p,m){var w="C;Y"+(p+1)+";X"+(m+1)+";K";switch(x.t){case"n":w+=x.v||0,x.f&&!x.F&&(w+=";E"+jf(x.f,{r:p,c:m}));break;case"b":w+=x.v?"TRUE":"FALSE";break;case"e":w+=x.w||x.v;break;case"d":w+='"'+(x.w||x.v)+'"';break;case"s":w+='"'+x.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return w}function u(x,h){h.forEach(function(p,m){var w="F;W"+(m+1)+" "+(m+1)+" ";p.hidden?w+="0":(typeof p.width=="number"&&!p.wpx&&(p.wpx=Ol(p.width)),typeof p.wpx=="number"&&!p.wch&&(p.wch=Ll(p.wpx)),typeof p.wch=="number"&&(w+=Math.round(p.wch))),w.charAt(w.length-1)!=" "&&x.push(w)})}function d(x,h){h.forEach(function(p,m){var w="F;";p.hidden?w+="M0;":p.hpt?w+="M"+20*p.hpt+";":p.hpx&&(w+="M"+20*Bl(p.hpx)+";"),w.length>2&&x.push(w+"R"+(m+1))})}function f(x,h){var p=["ID;PWXL;N;E"],m=[],w=mt(x["!ref"]),v,b=Array.isArray(x),y=`\r
`;p.push("P;PGeneral"),p.push("F;P0;DG0G8;M255"),x["!cols"]&&u(p,x["!cols"]),x["!rows"]&&d(p,x["!rows"]),p.push("B;Y"+(w.e.r-w.s.r+1)+";X"+(w.e.c-w.s.c+1)+";D"+[w.s.c,w.s.r,w.e.c,w.e.r].join(" "));for(var N=w.s.r;N<=w.e.r;++N)for(var A=w.s.c;A<=w.e.c;++A){var k=Ke({r:N,c:A});v=b?(x[N]||[])[A]:x[k],!(!v||v.v==null&&(!v.f||v.F))&&m.push(o(v,x,N,A))}return p.join(y)+y+m.join(y)+y+"E"+y}return{to_workbook:c,to_sheet:l,from_sheet:f}}(),Mg=function(){function e(i,l){switch(l.type){case"base64":return t(gn(i),l);case"binary":return t(i,l);case"buffer":return t(at&&Buffer.isBuffer(i)?i.toString("binary"):rs(i),l);case"array":return t(_s(i),l)}throw new Error("Unrecognized type "+l.type)}function t(i,l){for(var c=i.split(`
`),o=-1,u=-1,d=0,f=[];d!==c.length;++d){if(c[d].trim()==="BOT"){f[++o]=[],u=0;continue}if(!(o<0)){var x=c[d].trim().split(","),h=x[0],p=x[1];++d;for(var m=c[d]||"";(m.match(/["]/g)||[]).length&1&&d<c.length-1;)m+=`
`+c[++d];switch(m=m.trim(),+h){case-1:if(m==="BOT"){f[++o]=[],u=0;continue}else if(m!=="EOD")throw new Error("Unrecognized DIF special command "+m);break;case 0:m==="TRUE"?f[o][u]=!0:m==="FALSE"?f[o][u]=!1:isNaN(Vn(p))?isNaN(bi(p).getDate())?f[o][u]=p:f[o][u]=It(p):f[o][u]=Vn(p),++u;break;case 1:m=m.slice(1,m.length-1),m=m.replace(/""/g,'"'),m&&m.match(/^=".*"$/)&&(m=m.slice(2,-1)),f[o][u++]=m!==""?m:null;break}if(m==="EOD")break}}return l&&l.sheetRows&&(f=f.slice(0,l.sheetRows)),f}function r(i,l){return Ei(e(i,l),l)}function a(i,l){return ns(r(i,l),l)}var s=function(){var i=function(o,u,d,f,x){o.push(u),o.push(d+","+f),o.push('"'+x.replace(/"/g,'""')+'"')},l=function(o,u,d,f){o.push(u+","+d),o.push(u==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(o){var u=[],d=mt(o["!ref"]),f,x=Array.isArray(o);i(u,"TABLE",0,1,"sheetjs"),i(u,"VECTORS",0,d.e.r-d.s.r+1,""),i(u,"TUPLES",0,d.e.c-d.s.c+1,""),i(u,"DATA",0,0,"");for(var h=d.s.r;h<=d.e.r;++h){l(u,-1,0,"BOT");for(var p=d.s.c;p<=d.e.c;++p){var m=Ke({r:h,c:p});if(f=x?(o[h]||[])[p]:o[m],!f){l(u,1,0,"");continue}switch(f.t){case"n":var w=f.w;!w&&f.v!=null&&(w=f.v),w==null?f.f&&!f.F?l(u,1,0,"="+f.f):l(u,1,0,""):l(u,0,w,"V");break;case"b":l(u,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":l(u,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=Dn(f.z||Xe[14],dr(It(f.v)))),l(u,0,f.w,"V");break;default:l(u,1,0,"")}}}l(u,-1,0,"EOD");var v=`\r
`,b=u.join(v);return b}}();return{to_workbook:a,to_sheet:r,from_sheet:s}}(),Rg=function(){function e(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(f,x){for(var h=f.split(`
`),p=-1,m=-1,w=0,v=[];w!==h.length;++w){var b=h[w].trim().split(":");if(b[0]==="cell"){var y=Ht(b[1]);if(v.length<=y.r)for(p=v.length;p<=y.r;++p)v[p]||(v[p]=[]);switch(p=y.r,m=y.c,b[2]){case"t":v[p][m]=e(b[3]);break;case"v":v[p][m]=+b[3];break;case"vtf":var N=b[b.length-1];case"vtc":switch(b[3]){case"nl":v[p][m]=!!+b[4];break;default:v[p][m]=+b[4];break}b[2]=="vtf"&&(v[p][m]=[v[p][m],N])}}}return x&&x.sheetRows&&(v=v.slice(0,x.sheetRows)),v}function a(f,x){return Ei(r(f,x),x)}function s(f,x){return ns(a(f,x),x)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),l=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,c=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),o="--SocialCalcSpreadsheetControlSave--";function u(f){if(!f||!f["!ref"])return"";for(var x=[],h=[],p,m="",w=nn(f["!ref"]),v=Array.isArray(f),b=w.s.r;b<=w.e.r;++b)for(var y=w.s.c;y<=w.e.c;++y)if(m=Ke({r:b,c:y}),p=v?(f[b]||[])[y]:f[m],!(!p||p.v==null||p.t==="z")){switch(h=["cell",m,"t"],p.t){case"s":case"str":h.push(t(p.v));break;case"n":p.f?(h[2]="vtf",h[3]="n",h[4]=p.v,h[5]=t(p.f)):(h[2]="v",h[3]=p.v);break;case"b":h[2]="vt"+(p.f?"f":"c"),h[3]="nl",h[4]=p.v?"1":"0",h[5]=t(p.f||(p.v?"TRUE":"FALSE"));break;case"d":var N=dr(It(p.v));h[2]="vtc",h[3]="nd",h[4]=""+N,h[5]=p.w||Dn(p.z||Xe[14],N);break;case"e":continue}x.push(h.join(":"))}return x.push("sheet:c:"+(w.e.c-w.s.c+1)+":r:"+(w.e.r-w.s.r+1)+":tvf:1"),x.push("valueformat:1:text-wiki"),x.join(`
`)}function d(f){return[i,l,c,l,u(f),o].join(`
`)}return{to_workbook:s,to_sheet:a,from_sheet:d}}(),wi=function(){function e(d,f,x,h,p){p.raw?f[x][h]=d:d===""||(d==="TRUE"?f[x][h]=!0:d==="FALSE"?f[x][h]=!1:isNaN(Vn(d))?isNaN(bi(d).getDate())?f[x][h]=d:f[x][h]=It(d):f[x][h]=Vn(d))}function t(d,f){var x=f||{},h=[];if(!d||d.length===0)return h;for(var p=d.split(/[\r\n]/),m=p.length-1;m>=0&&p[m].length===0;)--m;for(var w=10,v=0,b=0;b<=m;++b)v=p[b].indexOf(" "),v==-1?v=p[b].length:v++,w=Math.max(w,v);for(b=0;b<=m;++b){h[b]=[];var y=0;for(e(p[b].slice(0,w).trim(),h,b,y,x),y=1;y<=(p[b].length-w)/10+1;++y)e(p[b].slice(w+(y-1)*10,w+y*10).trim(),h,b,y,x)}return x.sheetRows&&(h=h.slice(0,x.sheetRows)),h}var r={44:",",9:"	",59:";",124:"|"},a={44:3,9:2,59:1,124:0};function s(d){for(var f={},x=!1,h=0,p=0;h<d.length;++h)(p=d.charCodeAt(h))==34?x=!x:!x&&p in r&&(f[p]=(f[p]||0)+1);p=[];for(h in f)Object.prototype.hasOwnProperty.call(f,h)&&p.push([f[h],h]);if(!p.length){f=a;for(h in f)Object.prototype.hasOwnProperty.call(f,h)&&p.push([f[h],h])}return p.sort(function(m,w){return m[0]-w[0]||a[m[1]]-a[w[1]]}),r[p.pop()[1]]||44}function i(d,f){var x=f||{},h="",p=x.dense?[]:{},m={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(h=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(h=d.charAt(4),d=d.slice(6)):h=s(d.slice(0,1024)):x&&x.FS?h=x.FS:h=s(d.slice(0,1024));var w=0,v=0,b=0,y=0,N=0,A=h.charCodeAt(0),k=!1,_=0,j=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var P=x.dateNF!=null?uw(x.dateNF):null;function D(){var K=d.slice(y,N),E={};if(K.charAt(0)=='"'&&K.charAt(K.length-1)=='"'&&(K=K.slice(1,-1).replace(/""/g,'"')),K.length===0)E.t="z";else if(x.raw)E.t="s",E.v=K;else if(K.trim().length===0)E.t="s",E.v=K;else if(K.charCodeAt(0)==61)K.charCodeAt(1)==34&&K.charCodeAt(K.length-1)==34?(E.t="s",E.v=K.slice(2,-1).replace(/""/g,'"')):U5(K)?(E.t="n",E.f=K.slice(1)):(E.t="s",E.v=K);else if(K=="TRUE")E.t="b",E.v=!0;else if(K=="FALSE")E.t="b",E.v=!1;else if(!isNaN(b=Vn(K)))E.t="n",x.cellText!==!1&&(E.w=K),E.v=b;else if(!isNaN(bi(K).getDate())||P&&K.match(P)){E.z=x.dateNF||Xe[14];var Y=0;P&&K.match(P)&&(K=fw(K,x.dateNF,K.match(P)||[]),Y=1),x.cellDates?(E.t="d",E.v=It(K,Y)):(E.t="n",E.v=dr(It(K,Y))),x.cellText!==!1&&(E.w=Dn(E.z,E.v instanceof Date?dr(E.v):E.v)),x.cellNF||delete E.z}else E.t="s",E.v=K;if(E.t=="z"||(x.dense?(p[w]||(p[w]=[]),p[w][v]=E):p[Ke({c:v,r:w})]=E),y=N+1,j=d.charCodeAt(y),m.e.c<v&&(m.e.c=v),m.e.r<w&&(m.e.r=w),_==A)++v;else if(v=0,++w,x.sheetRows&&x.sheetRows<=w)return!0}e:for(;N<d.length;++N)switch(_=d.charCodeAt(N)){case 34:j===34&&(k=!k);break;case A:case 10:case 13:if(!k&&D())break e;break}return N-y>0&&D(),p["!ref"]=et(m),p}function l(d,f){return!(f&&f.PRN)||f.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?i(d,f):Ei(t(d,f),f)}function c(d,f){var x="",h=f.type=="string"?[0,0,0,0]:Af(d,f);switch(f.type){case"base64":x=gn(d);break;case"binary":x=d;break;case"buffer":f.codepage==65001?x=d.toString("utf8"):f.codepage&&typeof Ia<"u"?x=Ia.utils.decode(f.codepage,d):x=at&&Buffer.isBuffer(d)?d.toString("binary"):rs(d);break;case"array":x=_s(d);break;case"string":x=d;break;default:throw new Error("Unrecognized type "+f.type)}return h[0]==239&&h[1]==187&&h[2]==191?x=jt(x.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?x=jt(x):f.type=="binary"&&typeof Ia<"u"&&f.codepage&&(x=Ia.utils.decode(f.codepage,Ia.utils.encode(28591,x))),x.slice(0,19)=="socialcalc:version:"?Rg.to_sheet(f.type=="string"?x:jt(x),f):l(x,f)}function o(d,f){return ns(c(d,f),f)}function u(d){for(var f=[],x=mt(d["!ref"]),h,p=Array.isArray(d),m=x.s.r;m<=x.e.r;++m){for(var w=[],v=x.s.c;v<=x.e.c;++v){var b=Ke({r:m,c:v});if(h=p?(d[m]||[])[v]:d[b],!h||h.v==null){w.push("          ");continue}for(var y=(h.w||(wa(h),h.w)||"").slice(0,10);y.length<10;)y+=" ";w.push(y+(v===0?" ":""))}f.push(w.join(""))}return f.join(`
`)}return{to_workbook:o,to_sheet:c,from_sheet:u}}();function S4(e,t){var r=t||{},a=!!r.WTF;r.WTF=!0;try{var s=Ig.to_workbook(e,r);return r.WTF=a,s}catch(i){if(r.WTF=a,!i.message.match(/SYLK bad record ID/)&&a)throw i;return wi.to_workbook(e,t)}}var ps=function(){function e(O,R,g){if(O){wr(O,O.l||0);for(var S=g.Enum||ne;O.l<O.length;){var F=O.read_shift(2),ae=S[F]||S[65535],ue=O.read_shift(2),ve=O.l+ue,me=ae.f&&ae.f(O,ue,g);if(O.l=ve,R(me,ae,F))return}}}function t(O,R){switch(R.type){case"base64":return r(fn(gn(O)),R);case"binary":return r(fn(O),R);case"buffer":case"array":return r(O,R)}throw"Unsupported type "+R.type}function r(O,R){if(!O)return O;var g=R||{},S=g.dense?[]:{},F="Sheet1",ae="",ue=0,ve={},me=[],H=[],T={s:{r:0,c:0},e:{r:0,c:0}},je=g.sheetRows||0;if(O[2]==0&&(O[3]==8||O[3]==9)&&O.length>=16&&O[14]==5&&O[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(O[2]==2)g.Enum=ne,e(O,function(he,oe,De){switch(De){case 0:g.vers=he,he>=4096&&(g.qpro=!0);break;case 6:T=he;break;case 204:he&&(ae=he);break;case 222:ae=he;break;case 15:case 51:g.qpro||(he[1].v=he[1].v.slice(1));case 13:case 14:case 16:De==14&&(he[2]&112)==112&&(he[2]&15)>1&&(he[2]&15)<15&&(he[1].z=g.dateNF||Xe[14],g.cellDates&&(he[1].t="d",he[1].v=Jo(he[1].v))),g.qpro&&he[3]>ue&&(S["!ref"]=et(T),ve[F]=S,me.push(F),S=g.dense?[]:{},T={s:{r:0,c:0},e:{r:0,c:0}},ue=he[3],F=ae||"Sheet"+(ue+1),ae="");var Me=g.dense?(S[he[0].r]||[])[he[0].c]:S[Ke(he[0])];if(Me){Me.t=he[1].t,Me.v=he[1].v,he[1].z!=null&&(Me.z=he[1].z),he[1].f!=null&&(Me.f=he[1].f);break}g.dense?(S[he[0].r]||(S[he[0].r]=[]),S[he[0].r][he[0].c]=he[1]):S[Ke(he[0])]=he[1];break}},g);else if(O[2]==26||O[2]==14)g.Enum=xe,O[2]==14&&(g.qpro=!0,O.l=0),e(O,function(he,oe,De){switch(De){case 204:F=he;break;case 22:he[1].v=he[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(he[3]>ue&&(S["!ref"]=et(T),ve[F]=S,me.push(F),S=g.dense?[]:{},T={s:{r:0,c:0},e:{r:0,c:0}},ue=he[3],F="Sheet"+(ue+1)),je>0&&he[0].r>=je)break;g.dense?(S[he[0].r]||(S[he[0].r]=[]),S[he[0].r][he[0].c]=he[1]):S[Ke(he[0])]=he[1],T.e.c<he[0].c&&(T.e.c=he[0].c),T.e.r<he[0].r&&(T.e.r=he[0].r);break;case 27:he[14e3]&&(H[he[14e3][0]]=he[14e3][1]);break;case 1537:H[he[0]]=he[1],he[0]==ue&&(F=he[1]);break}},g);else throw new Error("Unrecognized LOTUS BOF "+O[2]);if(S["!ref"]=et(T),ve[ae||F]=S,me.push(ae||F),!H.length)return{SheetNames:me,Sheets:ve};for(var pe={},Le=[],Se=0;Se<H.length;++Se)ve[me[Se]]?(Le.push(H[Se]||me[Se]),pe[H[Se]]=ve[H[Se]]||ve[me[Se]]):(Le.push(H[Se]),pe[H[Se]]={"!ref":"A1"});return{SheetNames:Le,Sheets:pe}}function a(O,R){var g=R||{};if(+g.codepage>=0&&zn(+g.codepage),g.type=="string")throw new Error("Cannot write WK1 to JS string");var S=rn(),F=mt(O["!ref"]),ae=Array.isArray(O),ue=[];Pe(S,0,i(1030)),Pe(S,6,o(F));for(var ve=Math.min(F.e.r,8191),me=F.s.r;me<=ve;++me)for(var H=Zt(me),T=F.s.c;T<=F.e.c;++T){me===F.s.r&&(ue[T]=Wt(T));var je=ue[T]+H,pe=ae?(O[me]||[])[T]:O[je];if(!(!pe||pe.t=="z"))if(pe.t=="n")(pe.v|0)==pe.v&&pe.v>=-32768&&pe.v<=32767?Pe(S,13,h(me,T,pe.v)):Pe(S,14,m(me,T,pe.v));else{var Le=wa(pe);Pe(S,15,f(me,T,Le.slice(0,239)))}}return Pe(S,1),S.end()}function s(O,R){var g=R||{};if(+g.codepage>=0&&zn(+g.codepage),g.type=="string")throw new Error("Cannot write WK3 to JS string");var S=rn();Pe(S,0,l(O));for(var F=0,ae=0;F<O.SheetNames.length;++F)(O.Sheets[O.SheetNames[F]]||{})["!ref"]&&Pe(S,27,z(O.SheetNames[F],ae++));var ue=0;for(F=0;F<O.SheetNames.length;++F){var ve=O.Sheets[O.SheetNames[F]];if(!(!ve||!ve["!ref"])){for(var me=mt(ve["!ref"]),H=Array.isArray(ve),T=[],je=Math.min(me.e.r,8191),pe=me.s.r;pe<=je;++pe)for(var Le=Zt(pe),Se=me.s.c;Se<=me.e.c;++Se){pe===me.s.r&&(T[Se]=Wt(Se));var he=T[Se]+Le,oe=H?(ve[pe]||[])[Se]:ve[he];if(!(!oe||oe.t=="z"))if(oe.t=="n")Pe(S,23,D(pe,Se,ue,oe.v));else{var De=wa(oe);Pe(S,22,_(pe,Se,ue,De.slice(0,239)))}}++ue}}return Pe(S,1),S.end()}function i(O){var R=ye(2);return R.write_shift(2,O),R}function l(O){var R=ye(26);R.write_shift(2,4096),R.write_shift(2,4),R.write_shift(4,0);for(var g=0,S=0,F=0,ae=0;ae<O.SheetNames.length;++ae){var ue=O.SheetNames[ae],ve=O.Sheets[ue];if(!(!ve||!ve["!ref"])){++F;var me=nn(ve["!ref"]);g<me.e.r&&(g=me.e.r),S<me.e.c&&(S=me.e.c)}}return g>8191&&(g=8191),R.write_shift(2,g),R.write_shift(1,F),R.write_shift(1,S),R.write_shift(2,0),R.write_shift(2,0),R.write_shift(1,1),R.write_shift(1,2),R.write_shift(4,0),R.write_shift(4,0),R}function c(O,R,g){var S={s:{c:0,r:0},e:{c:0,r:0}};return R==8&&g.qpro?(S.s.c=O.read_shift(1),O.l++,S.s.r=O.read_shift(2),S.e.c=O.read_shift(1),O.l++,S.e.r=O.read_shift(2),S):(S.s.c=O.read_shift(2),S.s.r=O.read_shift(2),R==12&&g.qpro&&(O.l+=2),S.e.c=O.read_shift(2),S.e.r=O.read_shift(2),R==12&&g.qpro&&(O.l+=2),S.s.c==65535&&(S.s.c=S.e.c=S.s.r=S.e.r=0),S)}function o(O){var R=ye(8);return R.write_shift(2,O.s.c),R.write_shift(2,O.s.r),R.write_shift(2,O.e.c),R.write_shift(2,O.e.r),R}function u(O,R,g){var S=[{c:0,r:0},{t:"n",v:0},0,0];return g.qpro&&g.vers!=20768?(S[0].c=O.read_shift(1),S[3]=O.read_shift(1),S[0].r=O.read_shift(2),O.l+=2):(S[2]=O.read_shift(1),S[0].c=O.read_shift(2),S[0].r=O.read_shift(2)),S}function d(O,R,g){var S=O.l+R,F=u(O,R,g);if(F[1].t="s",g.vers==20768){O.l++;var ae=O.read_shift(1);return F[1].v=O.read_shift(ae,"utf8"),F}return g.qpro&&O.l++,F[1].v=O.read_shift(S-O.l,"cstr"),F}function f(O,R,g){var S=ye(7+g.length);S.write_shift(1,255),S.write_shift(2,R),S.write_shift(2,O),S.write_shift(1,39);for(var F=0;F<S.length;++F){var ae=g.charCodeAt(F);S.write_shift(1,ae>=128?95:ae)}return S.write_shift(1,0),S}function x(O,R,g){var S=u(O,R,g);return S[1].v=O.read_shift(2,"i"),S}function h(O,R,g){var S=ye(7);return S.write_shift(1,255),S.write_shift(2,R),S.write_shift(2,O),S.write_shift(2,g,"i"),S}function p(O,R,g){var S=u(O,R,g);return S[1].v=O.read_shift(8,"f"),S}function m(O,R,g){var S=ye(13);return S.write_shift(1,255),S.write_shift(2,R),S.write_shift(2,O),S.write_shift(8,g,"f"),S}function w(O,R,g){var S=O.l+R,F=u(O,R,g);if(F[1].v=O.read_shift(8,"f"),g.qpro)O.l=S;else{var ae=O.read_shift(2);N(O.slice(O.l,O.l+ae),F),O.l+=ae}return F}function v(O,R,g){var S=R&32768;return R&=-32769,R=(S?O:0)+(R>=8192?R-16384:R),(S?"":"$")+(g?Wt(R):Zt(R))}var b={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},y=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function N(O,R){wr(O,0);for(var g=[],S=0,F="",ae="",ue="",ve="";O.l<O.length;){var me=O[O.l++];switch(me){case 0:g.push(O.read_shift(8,"f"));break;case 1:ae=v(R[0].c,O.read_shift(2),!0),F=v(R[0].r,O.read_shift(2),!1),g.push(ae+F);break;case 2:{var H=v(R[0].c,O.read_shift(2),!0),T=v(R[0].r,O.read_shift(2),!1);ae=v(R[0].c,O.read_shift(2),!0),F=v(R[0].r,O.read_shift(2),!1),g.push(H+T+":"+ae+F)}break;case 3:if(O.l<O.length){console.error("WK1 premature formula end");return}break;case 4:g.push("("+g.pop()+")");break;case 5:g.push(O.read_shift(2));break;case 6:{for(var je="";me=O[O.l++];)je+=String.fromCharCode(me);g.push('"'+je.replace(/"/g,'""')+'"')}break;case 8:g.push("-"+g.pop());break;case 23:g.push("+"+g.pop());break;case 22:g.push("NOT("+g.pop()+")");break;case 20:case 21:ve=g.pop(),ue=g.pop(),g.push(["AND","OR"][me-20]+"("+ue+","+ve+")");break;default:if(me<32&&y[me])ve=g.pop(),ue=g.pop(),g.push(ue+y[me]+ve);else if(b[me]){if(S=b[me][1],S==69&&(S=O[O.l++]),S>g.length){console.error("WK1 bad formula parse 0x"+me.toString(16)+":|"+g.join("|")+"|");return}var pe=g.slice(-S);g.length-=S,g.push(b[me][0]+"("+pe.join(",")+")")}else return me<=7?console.error("WK1 invalid opcode "+me.toString(16)):me<=24?console.error("WK1 unsupported op "+me.toString(16)):me<=30?console.error("WK1 invalid opcode "+me.toString(16)):me<=115?console.error("WK1 unsupported function opcode "+me.toString(16)):console.error("WK1 unrecognized opcode "+me.toString(16))}}g.length==1?R[1].f=""+g[0]:console.error("WK1 bad formula parse |"+g.join("|")+"|")}function A(O){var R=[{c:0,r:0},{t:"n",v:0},0];return R[0].r=O.read_shift(2),R[3]=O[O.l++],R[0].c=O[O.l++],R}function k(O,R){var g=A(O);return g[1].t="s",g[1].v=O.read_shift(R-4,"cstr"),g}function _(O,R,g,S){var F=ye(6+S.length);F.write_shift(2,O),F.write_shift(1,g),F.write_shift(1,R),F.write_shift(1,39);for(var ae=0;ae<S.length;++ae){var ue=S.charCodeAt(ae);F.write_shift(1,ue>=128?95:ue)}return F.write_shift(1,0),F}function j(O,R){var g=A(O);g[1].v=O.read_shift(2);var S=g[1].v>>1;if(g[1].v&1)switch(S&7){case 0:S=(S>>3)*5e3;break;case 1:S=(S>>3)*500;break;case 2:S=(S>>3)/20;break;case 3:S=(S>>3)/200;break;case 4:S=(S>>3)/2e3;break;case 5:S=(S>>3)/2e4;break;case 6:S=(S>>3)/16;break;case 7:S=(S>>3)/64;break}return g[1].v=S,g}function P(O,R){var g=A(O),S=O.read_shift(4),F=O.read_shift(4),ae=O.read_shift(2);if(ae==65535)return S===0&&F===3221225472?(g[1].t="e",g[1].v=15):S===0&&F===3489660928?(g[1].t="e",g[1].v=42):g[1].v=0,g;var ue=ae&32768;return ae=(ae&32767)-16446,g[1].v=(1-ue*2)*(F*Math.pow(2,ae+32)+S*Math.pow(2,ae)),g}function D(O,R,g,S){var F=ye(14);if(F.write_shift(2,O),F.write_shift(1,g),F.write_shift(1,R),S==0)return F.write_shift(4,0),F.write_shift(4,0),F.write_shift(2,65535),F;var ae=0,ue=0,ve=0,me=0;return S<0&&(ae=1,S=-S),ue=Math.log2(S)|0,S/=Math.pow(2,ue-31),me=S>>>0,me&2147483648||(S/=2,++ue,me=S>>>0),S-=me,me|=2147483648,me>>>=0,S*=Math.pow(2,32),ve=S>>>0,F.write_shift(4,ve),F.write_shift(4,me),ue+=16383+(ae?32768:0),F.write_shift(2,ue),F}function K(O,R){var g=P(O);return O.l+=R-14,g}function E(O,R){var g=A(O),S=O.read_shift(4);return g[1].v=S>>6,g}function Y(O,R){var g=A(O),S=O.read_shift(8,"f");return g[1].v=S,g}function B(O,R){var g=Y(O);return O.l+=R-10,g}function te(O,R){return O[O.l+R-1]==0?O.read_shift(R,"cstr"):""}function re(O,R){var g=O[O.l++];g>R-1&&(g=R-1);for(var S="";S.length<g;)S+=String.fromCharCode(O[O.l++]);return S}function Q(O,R,g){if(!(!g.qpro||R<21)){var S=O.read_shift(1);O.l+=17,O.l+=1,O.l+=2;var F=O.read_shift(R-21,"cstr");return[S,F]}}function Z(O,R){for(var g={},S=O.l+R;O.l<S;){var F=O.read_shift(2);if(F==14e3){for(g[F]=[0,""],g[F][0]=O.read_shift(2);O[O.l];)g[F][1]+=String.fromCharCode(O[O.l]),O.l++;O.l++}}return g}function z(O,R){var g=ye(5+O.length);g.write_shift(2,14e3),g.write_shift(2,R);for(var S=0;S<O.length;++S){var F=O.charCodeAt(S);g[g.l++]=F>127?95:F}return g[g.l++]=0,g}var ne={0:{n:"BOF",f:ar},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:c},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:x},14:{n:"NUMBER",f:p},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:w},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:te},222:{n:"SHEETNAMELP",f:re},65535:{n:""}},xe={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:k},23:{n:"NUMBER17",f:P},24:{n:"NUMBER18",f:j},25:{n:"FORMULA19",f:K},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Z},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:E},38:{n:"??"},39:{n:"NUMBER27",f:Y},40:{n:"FORMULA28",f:B},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:te},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Q},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:a,book_to_wk3:s,to_workbook:t}}();function C4(e){var t={},r=e.match(Lr),a=0,s=!1;if(r)for(;a!=r.length;++a){var i=Ye(r[a]);switch(i[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(i.val=="1")break;t.cp=Xu[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=i.val;break;case"<sz":t.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(i.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(i.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":i.rgb&&(t.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(i[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+i[0])}}return t}var E4=function(){var e=Pl("t"),t=Pl("rPr");function r(i){var l=i.match(e);if(!l)return{t:"s",v:""};var c={t:"s",v:xt(l[1])},o=i.match(t);return o&&(c.s=C4(o[1])),c}var a=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(l){return l.replace(a,"").split(s).map(r).filter(function(c){return c.v})}}(),T4=function(){var t=/(\r\n|\n)/g;function r(s,i,l){var c=[];s.u&&c.push("text-decoration: underline;"),s.uval&&c.push("text-underline-style:"+s.uval+";"),s.sz&&c.push("font-size:"+s.sz+"pt;"),s.outline&&c.push("text-effect: outline;"),s.shadow&&c.push("text-shadow: auto;"),i.push('<span style="'+c.join("")+'">'),s.b&&(i.push("<b>"),l.push("</b>")),s.i&&(i.push("<i>"),l.push("</i>")),s.strike&&(i.push("<s>"),l.push("</s>"));var o=s.valign||"";return o=="superscript"||o=="super"?o="sup":o=="subscript"&&(o="sub"),o!=""&&(i.push("<"+o+">"),l.push("</"+o+">")),l.push("</span>"),s}function a(s){var i=[[],s.v,[]];return s.v?(s.s&&r(s.s,i[0],i[2]),i[0].join("")+i[1].replace(t,"<br/>")+i[2].join("")):""}return function(i){return i.map(a).join("")}}(),F4=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,A4=/<(?:\w+:)?r>/,P4=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function vf(e,t){var r=t?t.cellHTML:!0,a={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(a.t=xt(jt(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),a.r=jt(e),r&&(a.h=nf(a.t))):e.match(A4)&&(a.r=jt(e),a.t=xt(jt((e.replace(P4,"").match(F4)||[]).join("").replace(Lr,""))),r&&(a.h=T4(E4(a.r)))),a):{t:""}}var D4=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,I4=/<(?:\w+:)?(?:si|sstItem)>/g,M4=/<\/(?:\w+:)?(?:si|sstItem)>/;function R4(e,t){var r=[],a="";if(!e)return r;var s=e.match(D4);if(s){a=s[2].replace(I4,"").split(M4);for(var i=0;i!=a.length;++i){var l=vf(a[i].trim(),t);l!=null&&(r[r.length]=l)}s=Ye(s[1]),r.Count=s.count,r.Unique=s.uniqueCount}return r}var O4=/^\s|\s$|[\t\n\r]/;function Og(e,t){if(!t.bookSST)return"";var r=[er];r[r.length]=Fe("sst",null,{xmlns:Ps[0],count:e.Count,uniqueCount:e.Unique});for(var a=0;a!=e.length;++a)if(e[a]!=null){var s=e[a],i="<si>";s.r?i+=s.r:(i+="<t",s.t||(s.t=""),s.t.match(O4)&&(i+=' xml:space="preserve"'),i+=">"+wt(s.t)+"</t>"),i+="</si>",r[r.length]=i}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function L4(e){return[e.read_shift(4),e.read_shift(4)]}function B4(e,t){var r=[],a=!1;return ka(e,function(i,l,c){switch(c){case 159:r.Count=i[0],r.Unique=i[1];break;case 19:r.push(i);break;case 160:return!0;case 35:a=!0;break;case 36:a=!1;break;default:if(l.T,!a||t.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}),r}function U4(e,t){return t||(t=ye(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var z4=Jw;function W4(e){var t=rn();ke(t,159,U4(e));for(var r=0;r<e.length;++r)ke(t,19,z4(e[r]));return ke(t,160),t.end()}function Lg(e){for(var t=[],r=e.split(""),a=0;a<r.length;++a)t[a]=r[a].charCodeAt(0);return t}function pa(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function H4(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=pa(e,4),t.U=pa(e,4),t.W=pa(e,4),t}function $4(e){for(var t=e.read_shift(4),r=e.l+t-4,a={},s=e.read_shift(4),i=[];s-- >0;)i.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(a.name=e.read_shift(0,"lpp4"),a.comps=i,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return a}function V4(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push($4(e));return t}function G4(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function X4(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=pa(e,4),t.U=pa(e,4),t.W=pa(e,4),t}function K4(e){var t=X4(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function Bg(e,t){var r=e.l+t,a={};a.Flags=e.read_shift(4)&63,e.l+=4,a.AlgID=e.read_shift(4);var s=!1;switch(a.AlgID){case 26126:case 26127:case 26128:s=a.Flags==36;break;case 26625:s=a.Flags==4;break;case 0:s=a.Flags==16||a.Flags==4||a.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+a.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return a.AlgIDHash=e.read_shift(4),a.KeySize=e.read_shift(4),a.ProviderType=e.read_shift(4),e.l+=8,a.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,a}function Ug(e,t){var r={},a=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,a),e.l=a,r}function Y4(e){var t=pa(e);switch(t.Minor){case 2:return[t.Minor,q4(e)];case 3:return[t.Minor,J4()];case 4:return[t.Minor,Q4(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function q4(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),a=Bg(e,r),s=Ug(e,e.length-e.l);return{t:"Std",h:a,v:s}}function J4(){throw new Error("File is password-protected: ECMA-376 Extensible")}function Q4(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),a={};return r.replace(Lr,function(i){var l=Ye(i);switch(sa(l[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(c){a[c]=l[c]});break;case"<dataIntegrity":a.encryptedHmacKey=l.encryptedHmacKey,a.encryptedHmacValue=l.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":a.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":a.uri=l.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":a.encs.push(l);break;default:throw l[0]}}),a}function Z4(e,t){var r={},a=r.EncryptionVersionInfo=pa(e,4);if(t-=4,a.Minor!=2)throw new Error("unrecognized minor version code: "+a.Minor);if(a.Major>4||a.Major<2)throw new Error("unrecognized major version code: "+a.Major);r.Flags=e.read_shift(4),t-=4;var s=e.read_shift(4);return t-=4,r.EncryptionHeader=Bg(e,s),t-=s,r.EncryptionVerifier=Ug(e,t),r}function ek(e){var t={},r=t.EncryptionVersionInfo=pa(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function yf(e){var t=0,r,a=Lg(e),s=a.length+1,i,l,c,o,u;for(r=Ya(s),r[0]=a.length,i=1;i!=s;++i)r[i]=a[i-1];for(i=s-1;i>=0;--i)l=r[i],c=t&16384?1:0,o=t<<1&32767,u=c|o,t=u^l;return t^52811}var zg=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],a=function(l){return(l/2|l*128)&255},s=function(l,c){return a(l^c)},i=function(l){for(var c=t[l.length-1],o=104,u=l.length-1;u>=0;--u)for(var d=l[u],f=0;f!=7;++f)d&64&&(c^=r[o]),d*=2,--o;return c};return function(l){for(var c=Lg(l),o=i(c),u=c.length,d=Ya(16),f=0;f!=16;++f)d[f]=0;var x,h,p;for((u&1)===1&&(x=o>>8,d[u]=s(e[0],x),--u,x=o&255,h=c[c.length-1],d[u]=s(h,x));u>0;)--u,x=o>>8,d[u]=s(c[u],x),--u,x=o&255,d[u]=s(c[u],x);for(u=15,p=15-c.length;p>0;)x=o>>8,d[u]=s(e[p],x),--u,--p,x=o&255,d[u]=s(c[u],x),--u,--p;return d}}(),tk=function(e,t,r,a,s){s||(s=t),a||(a=zg(e));var i,l;for(i=0;i!=t.length;++i)l=t[i],l^=a[r],l=(l>>5|l<<3)&255,s[i]=l,++r;return[s,r,a]},rk=function(e){var t=0,r=zg(e);return function(a){var s=tk("",a,t,r);return t=s[1],s[0]}};function nk(e,t,r,a){var s={key:ar(e),verificationBytes:ar(e)};return r.password&&(s.verifier=yf(r.password)),a.valid=s.verificationBytes===s.verifier,a.valid&&(a.insitu=rk(r.password)),s}function ak(e,t,r){var a=r||{};return a.Info=e.read_shift(2),e.l-=2,a.Info===1?a.Data=ek(e):a.Data=Z4(e,t),a}function sk(e,t,r){var a={Type:r.biff>=8?e.read_shift(2):0};return a.Type?ak(e,t-2,a):nk(e,r.biff>=8?t:t-2,r,a),a}var Wg=function(){function e(s,i){switch(i.type){case"base64":return t(gn(s),i);case"binary":return t(s,i);case"buffer":return t(at&&Buffer.isBuffer(s)?s.toString("binary"):rs(s),i);case"array":return t(_s(s),i)}throw new Error("Unrecognized type "+i.type)}function t(s,i){var l=i||{},c=l.dense?[]:{},o=s.match(/\\trowd.*?\\row\b/g);if(!o.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:o.length-1}};return o.forEach(function(d,f){Array.isArray(c)&&(c[f]=[]);for(var x=/\\\w+\b/g,h=0,p,m=-1;p=x.exec(d);){switch(p[0]){case"\\cell":var w=d.slice(h,x.lastIndex-p[0].length);if(w[0]==" "&&(w=w.slice(1)),++m,w.length){var v={v:w,t:"s"};Array.isArray(c)?c[f][m]=v:c[Ke({r:f,c:m})]=v}break}h=x.lastIndex}m>u.e.c&&(u.e.c=m)}),c["!ref"]=et(u),c}function r(s,i){return ns(e(s,i),i)}function a(s){for(var i=["{\\rtf1\\ansi"],l=mt(s["!ref"]),c,o=Array.isArray(s),u=l.s.r;u<=l.e.r;++u){i.push("\\trowd\\trautofit1");for(var d=l.s.c;d<=l.e.c;++d)i.push("\\cellx"+(d+1));for(i.push("\\pard\\intbl"),d=l.s.c;d<=l.e.c;++d){var f=Ke({r:u,c:d});c=o?(s[u]||[])[d]:s[f],!(!c||c.v==null&&(!c.f||c.F))&&(i.push(" "+(c.w||(wa(c),c.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:a}}();function ik(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function Rl(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function lk(e){var t=e[0]/255,r=e[1]/255,a=e[2]/255,s=Math.max(t,r,a),i=Math.min(t,r,a),l=s-i;if(l===0)return[0,0,t];var c=0,o=0,u=s+i;switch(o=l/(u>1?2-u:u),s){case t:c=((r-a)/l+6)%6;break;case r:c=(a-t)/l+2;break;case a:c=(t-r)/l+4;break}return[c/6,o,u/2]}function ck(e){var t=e[0],r=e[1],a=e[2],s=r*2*(a<.5?a:1-a),i=a-s/2,l=[i,i,i],c=6*t,o;if(r!==0)switch(c|0){case 0:case 6:o=s*c,l[0]+=s,l[1]+=o;break;case 1:o=s*(2-c),l[0]+=o,l[1]+=s;break;case 2:o=s*(c-2),l[1]+=s,l[2]+=o;break;case 3:o=s*(4-c),l[1]+=o,l[2]+=s;break;case 4:o=s*(c-4),l[2]+=s,l[0]+=o;break;case 5:o=s*(6-c),l[2]+=o,l[0]+=s;break}for(var u=0;u!=3;++u)l[u]=Math.round(l[u]*255);return l}function Eo(e,t){if(t===0)return e;var r=lk(ik(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),Rl(ck(r))}var Hg=6,ok=15,dk=1,Dr=Hg;function Ol(e){return Math.floor((e+Math.round(128/Dr)/256)*Dr)}function Ll(e){return Math.floor((e-5)/Dr*100+.5)/100}function To(e){return Math.round((e*Dr+5)/Dr*256)/256}function I0(e){return To(Ll(Ol(e)))}function bf(e){var t=Math.abs(e-I0(e)),r=Dr;if(t>.005)for(Dr=dk;Dr<ok;++Dr)Math.abs(e-I0(e))<=t&&(t=Math.abs(e-I0(e)),r=Dr);Dr=r}function qa(e){e.width?(e.wpx=Ol(e.width),e.wch=Ll(e.wpx),e.MDW=Dr):e.wpx?(e.wch=Ll(e.wpx),e.width=To(e.wch),e.MDW=Dr):typeof e.wch=="number"&&(e.width=To(e.wch),e.wpx=Ol(e.width),e.MDW=Dr),e.customWidth&&delete e.customWidth}var uk=96,$g=uk;function Bl(e){return e*96/$g}function Ni(e){return e*$g/96}var fk={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function xk(e,t,r,a){t.Borders=[];var s={},i=!1;(e[0].match(Lr)||[]).forEach(function(l){var c=Ye(l);switch(sa(c[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},c.diagonalUp&&(s.diagonalUp=Ft(c.diagonalUp)),c.diagonalDown&&(s.diagonalDown=Ft(c.diagonalDown)),t.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(a&&a.WTF&&!i)throw new Error("unrecognized "+c[0]+" in borders")}})}function mk(e,t,r,a){t.Fills=[];var s={},i=!1;(e[0].match(Lr)||[]).forEach(function(l){var c=Ye(l);switch(sa(c[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},t.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":c.patternType&&(s.patternType=c.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),c.indexed&&(s.bgColor.indexed=parseInt(c.indexed,10)),c.theme&&(s.bgColor.theme=parseInt(c.theme,10)),c.tint&&(s.bgColor.tint=parseFloat(c.tint)),c.rgb&&(s.bgColor.rgb=c.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),c.theme&&(s.fgColor.theme=parseInt(c.theme,10)),c.tint&&(s.fgColor.tint=parseFloat(c.tint)),c.rgb!=null&&(s.fgColor.rgb=c.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(a&&a.WTF&&!i)throw new Error("unrecognized "+c[0]+" in fills")}})}function hk(e,t,r,a){t.Fonts=[];var s={},i=!1;(e[0].match(Lr)||[]).forEach(function(l){var c=Ye(l);switch(sa(c[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(s),s={};break;case"<name":c.val&&(s.name=jt(c.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=c.val?Ft(c.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=c.val?Ft(c.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(c.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=c.val?Ft(c.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=c.val?Ft(c.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=c.val?Ft(c.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=c.val?Ft(c.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=c.val?Ft(c.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":c.val&&(s.sz=+c.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":c.val&&(s.vertAlign=c.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":c.val&&(s.family=parseInt(c.val,10));break;case"<family/>":case"</family>":break;case"<scheme":c.val&&(s.scheme=c.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(c.val=="1")break;c.codepage=Xu[parseInt(c.val,10)];break;case"<color":if(s.color||(s.color={}),c.auto&&(s.color.auto=Ft(c.auto)),c.rgb)s.color.rgb=c.rgb.slice(-6);else if(c.indexed){s.color.index=parseInt(c.indexed,10);var o=ms[s.color.index];s.color.index==81&&(o=ms[1]),o||(o=ms[1]),s.color.rgb=o[0].toString(16)+o[1].toString(16)+o[2].toString(16)}else c.theme&&(s.color.theme=parseInt(c.theme,10),c.tint&&(s.color.tint=parseFloat(c.tint)),c.theme&&r.themeElements&&r.themeElements.clrScheme&&(s.color.rgb=Eo(r.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(a&&a.WTF&&!i)throw new Error("unrecognized "+c[0]+" in fonts")}})}function pk(e,t,r){t.NumberFmt=[];for(var a=Yt(Xe),s=0;s<a.length;++s)t.NumberFmt[a[s]]=Xe[a[s]];var i=e[0].match(Lr);if(i)for(s=0;s<i.length;++s){var l=Ye(i[s]);switch(sa(l[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var c=xt(jt(l.formatCode)),o=parseInt(l.numFmtId,10);if(t.NumberFmt[o]=c,o>0){if(o>392){for(o=392;o>60&&t.NumberFmt[o]!=null;--o);t.NumberFmt[o]=c}ha(c,o)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+l[0]+" in numFmts")}}}function gk(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var a=r[0];a<=r[1];++a)e[a]!=null&&(t[t.length]=Fe("numFmt",null,{numFmtId:a,formatCode:wt(e[a])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Fe("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var Cc=["numFmtId","fillId","fontId","borderId","xfId"],Ec=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function vk(e,t,r){t.CellXf=[];var a,s=!1;(e[0].match(Lr)||[]).forEach(function(i){var l=Ye(i),c=0;switch(sa(l[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(a=l,delete a[0],c=0;c<Cc.length;++c)a[Cc[c]]&&(a[Cc[c]]=parseInt(a[Cc[c]],10));for(c=0;c<Ec.length;++c)a[Ec[c]]&&(a[Ec[c]]=Ft(a[Ec[c]]));if(t.NumberFmt&&a.numFmtId>392){for(c=392;c>60;--c)if(t.NumberFmt[a.numFmtId]==t.NumberFmt[c]){a.numFmtId=c;break}}t.CellXf.push(a);break;case"</xf>":break;case"<alignment":case"<alignment/>":var o={};l.vertical&&(o.vertical=l.vertical),l.horizontal&&(o.horizontal=l.horizontal),l.textRotation!=null&&(o.textRotation=l.textRotation),l.indent&&(o.indent=l.indent),l.wrapText&&(o.wrapText=Ft(l.wrapText)),a.alignment=o;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+l[0]+" in cellXfs")}})}function yk(e){var t=[];return t[t.length]=Fe("cellXfs",null),e.forEach(function(r){t[t.length]=Fe("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Fe("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var bk=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,a=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(c,o,u){var d={};if(!c)return d;c=c.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var f;return(f=c.match(t))&&pk(f,d,u),(f=c.match(s))&&hk(f,d,o,u),(f=c.match(a))&&mk(f,d,o,u),(f=c.match(i))&&xk(f,d,o,u),(f=c.match(r))&&vk(f,d,u),d}}();function Vg(e,t){var r=[er,Fe("styleSheet",null,{xmlns:Ps[0],"xmlns:vt":cr.vt})],a;return e.SSF&&(a=gk(e.SSF))!=null&&(r[r.length]=a),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(a=yk(t.cellXfs))&&(r[r.length]=a),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function wk(e,t){var r=e.read_shift(2),a=Mr(e);return[r,a]}function Nk(e,t,r){r||(r=ye(6+4*t.length)),r.write_shift(2,e),hr(t,r);var a=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),a}function jk(e,t,r){var a={};a.sz=e.read_shift(2)/20;var s=aN(e);s.fItalic&&(a.italic=1),s.fCondense&&(a.condense=1),s.fExtend&&(a.extend=1),s.fShadow&&(a.shadow=1),s.fOutline&&(a.outline=1),s.fStrikeout&&(a.strike=1);var i=e.read_shift(2);switch(i===700&&(a.bold=1),e.read_shift(2)){case 1:a.vertAlign="superscript";break;case 2:a.vertAlign="subscript";break}var l=e.read_shift(1);l!=0&&(a.underline=l);var c=e.read_shift(1);c>0&&(a.family=c);var o=e.read_shift(1);switch(o>0&&(a.charset=o),e.l++,a.color=nN(e),e.read_shift(1)){case 1:a.scheme="major";break;case 2:a.scheme="minor";break}return a.name=Mr(e),a}function kk(e,t){t||(t=ye(25+4*32)),t.write_shift(2,e.sz*20),sN(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),_o(e.color,t);var a=0;return e.scheme=="major"&&(a=1),e.scheme=="minor"&&(a=2),t.write_shift(1,a),hr(e.name,t),t.length>t.l?t.slice(0,t.l):t}var _k=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],M0,Sk=Or;function Um(e,t){t||(t=ye(4*3+8*7+16*1)),M0||(M0=Yo(_k));var r=M0[e.patternType];r==null&&(r=40),t.write_shift(4,r);var a=0;if(r!=40)for(_o({auto:1},t),_o({auto:1},t);a<12;++a)t.write_shift(4,0);else{for(;a<4;++a)t.write_shift(4,0);for(;a<12;++a)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function Ck(e,t){var r=e.l+t,a=e.read_shift(2),s=e.read_shift(2);return e.l=r,{ixfe:a,numFmtId:s}}function Gg(e,t,r){r||(r=ye(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var a=0;return r.write_shift(1,a),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Bi(e,t){return t||(t=ye(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var Ek=Or;function Tk(e,t){return t||(t=ye(51)),t.write_shift(1,0),Bi(null,t),Bi(null,t),Bi(null,t),Bi(null,t),Bi(null,t),t.length>t.l?t.slice(0,t.l):t}function Fk(e,t){return t||(t=ye(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,+e.builtinId),t.write_shift(1,0),ko(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function Ak(e,t,r){var a=ye(2052);return a.write_shift(4,e),ko(t,a),ko(r,a),a.length>a.l?a.slice(0,a.l):a}function Pk(e,t,r){var a={};a.NumberFmt=[];for(var s in Xe)a.NumberFmt[s]=Xe[s];a.CellXf=[],a.Fonts=[];var i=[],l=!1;return ka(e,function(o,u,d){switch(d){case 44:a.NumberFmt[o[0]]=o[1],ha(o[1],o[0]);break;case 43:a.Fonts.push(o),o.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(o.color.rgb=Eo(t.themeElements.clrScheme[o.color.theme].rgb,o.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:i[i.length-1]==617&&a.CellXf.push(o);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:i.push(d),l=!0;break;case 38:i.pop(),l=!1;break;default:if(u.T>0)i.push(d);else if(u.T<0)i.pop();else if(!l||r.WTF&&i[i.length-1]!=37)throw new Error("Unexpected record 0x"+d.toString(16))}}),a}function Dk(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var s=a[0];s<=a[1];++s)t[s]!=null&&++r}),r!=0&&(ke(e,615,Gn(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var s=a[0];s<=a[1];++s)t[s]!=null&&ke(e,44,Nk(s,t[s]))}),ke(e,616))}}function Ik(e){var t=1;ke(e,611,Gn(t)),ke(e,43,kk({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),ke(e,612)}function Mk(e){var t=2;ke(e,603,Gn(t)),ke(e,45,Um({patternType:"none"})),ke(e,45,Um({patternType:"gray125"})),ke(e,604)}function Rk(e){var t=1;ke(e,613,Gn(t)),ke(e,46,Tk()),ke(e,614)}function Ok(e){var t=1;ke(e,626,Gn(t)),ke(e,47,Gg({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),ke(e,627)}function Lk(e,t){ke(e,617,Gn(t.length)),t.forEach(function(r){ke(e,47,Gg(r,0))}),ke(e,618)}function Bk(e){var t=1;ke(e,619,Gn(t)),ke(e,48,Fk({xfId:0,builtinId:0,name:"Normal"})),ke(e,620)}function Uk(e){var t=0;ke(e,505,Gn(t)),ke(e,506)}function zk(e){var t=0;ke(e,508,Ak(t,"TableStyleMedium9","PivotStyleMedium4")),ke(e,509)}function Wk(e,t){var r=rn();return ke(r,278),Dk(r,e.SSF),Ik(r),Mk(r),Rk(r),Ok(r),Lk(r,t.cellXfs),Bk(r),Uk(r),zk(r),ke(r,279),r.end()}var Hk=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function $k(e,t,r){t.themeElements.clrScheme=[];var a={};(e[0].match(Lr)||[]).forEach(function(s){var i=Ye(s);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":a.rgb=i.val;break;case"<a:sysClr":a.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":i[0].charAt(1)==="/"?(t.themeElements.clrScheme[Hk.indexOf(i[0])]=a,a={}):a.name=i[0].slice(3,i[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function Vk(){}function Gk(){}var Xk=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,Kk=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,Yk=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function qk(e,t,r){t.themeElements={};var a;[["clrScheme",Xk,$k],["fontScheme",Kk,Vk],["fmtScheme",Yk,Gk]].forEach(function(s){if(!(a=e.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](a,t,r)})}var Jk=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function Xg(e,t){(!e||e.length===0)&&(e=wf());var r,a={};if(!(r=e.match(Jk)))throw new Error("themeElements not found in theme");return qk(r[0],a,t),a.raw=e,a}function wf(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[er];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function Qk(e,t,r){var a=e.l+t,s=e.read_shift(4);if(s!==124226){if(!r.cellStyles){e.l=a;return}var i=e.slice(e.l);e.l=a;var l;try{l=B1(i,{type:"array"})}catch{return}var c=xn(l,"theme/theme/theme1.xml",!0);if(c)return Xg(c,r)}}function Zk(e){return e.read_shift(4)}function e5(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=t5(e,4);break;case 2:t.xclrValue=Sg(e);break;case 3:t.xclrValue=Zk(e);break;case 4:e.l+=4;break}return e.l+=8,t}function t5(e,t){return Or(e,t)}function r5(e,t){return Or(e,t)}function n5(e){var t=e.read_shift(2),r=e.read_shift(2)-4,a=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:a[1]=e5(e);break;case 6:a[1]=r5(e,r);break;case 14:case 15:a[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return a}function a5(e,t){var r=e.l+t;e.l+=2;var a=e.read_shift(2);e.l+=2;for(var s=e.read_shift(2),i=[];s-- >0;)i.push(n5(e,r-e.l));return{ixfe:a,ext:i}}function s5(e,t){t.forEach(function(r){switch(r[0]){}})}function i5(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Mr(e)}}function l5(e){var t=ye(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),hr(e.name,t),t.slice(0,t.l)}function c5(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function o5(e){var t=ye(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function d5(e,t){var r=ye(8+2*t.length);return r.write_shift(4,e),hr(t,r),r.slice(0,r.l)}function u5(e){return e.l+=4,e.read_shift(4)!=0}function f5(e,t){var r=ye(8);return r.write_shift(4,e),r.write_shift(4,1),r}function x5(e,t,r){var a={Types:[],Cell:[],Value:[]},s=r||{},i=[],l=!1,c=2;return ka(e,function(o,u,d){switch(d){case 335:a.Types.push({name:o.name});break;case 51:o.forEach(function(f){c==1?a.Cell.push({type:a.Types[f[0]-1].name,index:f[1]}):c==0&&a.Value.push({type:a.Types[f[0]-1].name,index:f[1]})});break;case 337:c=o?1:0;break;case 338:c=2;break;case 35:i.push(d),l=!0;break;case 36:i.pop(),l=!1;break;default:if(!u.T){if(!l||s.WTF&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}}),a}function m5(){var e=rn();return ke(e,332),ke(e,334,Gn(1)),ke(e,335,l5({name:"XLDAPR",version:12e4,flags:3496657072})),ke(e,336),ke(e,339,d5(1,"XLDAPR")),ke(e,52),ke(e,35,Gn(514)),ke(e,4096,Gn(0)),ke(e,4097,_n(1)),ke(e,36),ke(e,53),ke(e,340),ke(e,337,f5(1)),ke(e,51,o5([[1,0]])),ke(e,338),ke(e,333),e.end()}function h5(e,t,r){var a={Types:[],Cell:[],Value:[]};if(!e)return a;var s=!1,i=2,l;return e.replace(Lr,function(c){var o=Ye(c);switch(sa(o[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":a.Types.push({name:o.name});break;case"</metadataType>":break;case"<futureMetadata":for(var u=0;u<a.Types.length;++u)a.Types[u].name==o.name&&(l=a.Types[u]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":i==1?a.Cell.push({type:a.Types[o.t-1].name,index:+o.v}):i==0&&a.Value.push({type:a.Types[o.t-1].name,index:+o.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!l)break;l.offsets||(l.offsets=[]),l.offsets.push(+o.i);break;default:if(!s&&r.WTF)throw new Error("unrecognized "+o[0]+" in metadata")}return c}),a}function Kg(){var e=[er];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function p5(e){var t=[];if(!e)return t;var r=1;return(e.match(Lr)||[]).forEach(function(a){var s=Ye(a);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?r=s.i:s.i=r,t.push(s);break}}),t}function g5(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Ke(r);var a=e.read_shift(1);return a&2&&(t.l="1"),a&8&&(t.a="1"),t}function v5(e,t,r){var a=[];return ka(e,function(i,l,c){switch(c){case 63:a.push(i);break;default:if(!l.T)throw new Error("Unexpected record 0x"+c.toString(16))}}),a}function y5(e,t,r,a){if(!e)return e;var s=a||{},i=!1;ka(e,function(c,o,u){switch(u){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(!o.T){if(!i||s.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}},s)}function b5(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var ti=1024;function Yg(e,t){for(var r=[21600,21600],a=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),s=[Fe("xml",null,{"xmlns:v":dn.v,"xmlns:o":dn.o,"xmlns:x":dn.x,"xmlns:mv":dn.mv}).replace(/\/>/,">"),Fe("o:shapelayout",Fe("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Fe("v:shapetype",[Fe("v:stroke",null,{joinstyle:"miter"}),Fe("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:a})];ti<e*1e3;)ti+=1e3;return t.forEach(function(i){var l=Ht(i[0]),c={color2:"#BEFF82",type:"gradient"};c.type=="gradient"&&(c.angle="-180");var o=c.type=="gradient"?Fe("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=Fe("v:fill",o,c),d={on:"t",obscured:"t"};++ti,s=s.concat(["<v:shape"+Dl({id:"_x0000_s"+ti,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(i[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,Fe("v:shadow",null,d),Fe("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Nr("x:Anchor",[l.c+1,0,l.r+1,0,l.c+3,20,l.r+5,20].join(",")),Nr("x:AutoFill","False"),Nr("x:Row",String(l.r)),Nr("x:Column",String(l.c)),i[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),s.push("</xml>"),s.join("")}function zm(e,t,r,a){var s=Array.isArray(e),i;t.forEach(function(l){var c=Ht(l.ref);if(s?(e[c.r]||(e[c.r]=[]),i=e[c.r][c.c]):i=e[l.ref],!i){i={t:"z"},s?e[c.r][c.c]=i:e[l.ref]=i;var o=mt(e["!ref"]||"BDWGO1000001:A1");o.s.r>c.r&&(o.s.r=c.r),o.e.r<c.r&&(o.e.r=c.r),o.s.c>c.c&&(o.s.c=c.c),o.e.c<c.c&&(o.e.c=c.c);var u=et(o);u!==e["!ref"]&&(e["!ref"]=u)}i.c||(i.c=[]);var d={a:l.author,t:l.t,r:l.r,T:r};l.h&&(d.h=l.h);for(var f=i.c.length-1;f>=0;--f){if(!r&&i.c[f].T)return;r&&!i.c[f].T&&i.c.splice(f,1)}if(r&&a){for(f=0;f<a.length;++f)if(d.a==a[f].id){d.a=a[f].name||d.a;break}}i.c.push(d)})}function w5(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],a=[],s=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(l){if(!(l===""||l.trim()==="")){var c=l.match(/<(?:\w+:)?author[^>]*>(.*)/);c&&r.push(c[1])}});var i=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(l){if(!(l===""||l.trim()==="")){var c=l.match(/<(?:\w+:)?comment[^>]*>/);if(c){var o=Ye(c[0]),u={author:o.authorId&&r[o.authorId]||"sheetjsghost",ref:o.ref,guid:o.guid},d=Ht(o.ref);if(!(t.sheetRows&&t.sheetRows<=d.r)){var f=l.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),x=!!f&&!!f[1]&&vf(f[1])||{r:"",t:"",h:""};u.r=x.r,x.r=="<t></t>"&&(x.t=x.h=""),u.t=(x.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(u.h=x.h),a.push(u)}}}}),a}function qg(e){var t=[er,Fe("comments",null,{xmlns:Ps[0]})],r=[];return t.push("<authors>"),e.forEach(function(a){a[1].forEach(function(s){var i=wt(s.a);r.indexOf(i)==-1&&(r.push(i),t.push("<author>"+i+"</author>")),s.T&&s.ID&&r.indexOf("tc="+s.ID)==-1&&(r.push("tc="+s.ID),t.push("<author>tc="+s.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(a){var s=0,i=[];if(a[1][0]&&a[1][0].T&&a[1][0].ID?s=r.indexOf("tc="+a[1][0].ID):a[1].forEach(function(o){o.a&&(s=r.indexOf(wt(o.a))),i.push(o.t||"")}),t.push('<comment ref="'+a[0]+'" authorId="'+s+'"><text>'),i.length<=1)t.push(Nr("t",wt(i[0]||"")));else{for(var l=`Comment:
    `+i[0]+`
`,c=1;c<i.length;++c)l+=`Reply:
    `+i[c]+`
`;t.push(Nr("t",wt(l)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function N5(e,t){var r=[],a=!1,s={},i=0;return e.replace(Lr,function(c,o){var u=Ye(c);switch(sa(u[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:u.personId,guid:u.id,ref:u.ref,T:1};break;case"</threadedComment>":s.t!=null&&r.push(s);break;case"<text>":case"<text":i=o+c.length;break;case"</text>":s.t=e.slice(i,o).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":a=!0;break;case"</mentions>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&t.WTF)throw new Error("unrecognized "+u[0]+" in threaded comments")}return c}),r}function j5(e,t,r){var a=[er,Fe("ThreadedComments",null,{xmlns:cr.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(s){var i="";(s[1]||[]).forEach(function(l,c){if(!l.T){delete l.ID;return}l.a&&t.indexOf(l.a)==-1&&t.push(l.a);var o={ref:s[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};c==0?i=o.id:o.parentId=i,l.ID=o.id,l.a&&(o.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(l.a)).slice(-12)+"}"),a.push(Fe("threadedComment",Nr("text",l.t||""),o))})}),a.push("</ThreadedComments>"),a.join("")}function k5(e,t){var r=[],a=!1;return e.replace(Lr,function(i){var l=Ye(i);switch(sa(l[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:l.displayname,id:l.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&t.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return i}),r}function _5(e){var t=[er,Fe("personList",null,{xmlns:cr.TCMNT,"xmlns:x":Ps[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,a){t.push(Fe("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+a).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function S5(e){var t={};t.iauthor=e.read_shift(4);var r=Rs(e);return t.rfx=r.s,t.ref=Ke(r.s),e.l+=16,t}function C5(e,t){return t==null&&(t=ye(36)),t.write_shift(4,e[1].iauthor),Ti(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var E5=Mr;function T5(e){return hr(e.slice(0,54))}function F5(e,t){var r=[],a=[],s={},i=!1;return ka(e,function(c,o,u){switch(u){case 632:a.push(c);break;case 635:s=c;break;case 637:s.t=c.t,s.h=c.h,s.r=c.r;break;case 636:if(s.author=a[s.iauthor],delete s.iauthor,t.sheetRows&&s.rfx&&t.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,r.push(s);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!o.T){if(!i||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}),r}function A5(e){var t=rn(),r=[];return ke(t,628),ke(t,630),e.forEach(function(a){a[1].forEach(function(s){r.indexOf(s.a)>-1||(r.push(s.a.slice(0,54)),ke(t,632,T5(s.a)))})}),ke(t,631),ke(t,633),e.forEach(function(a){a[1].forEach(function(s){s.iauthor=r.indexOf(s.a);var i={s:Ht(a[0]),e:Ht(a[0])};ke(t,635,C5([i,s])),s.t&&s.t.length>0&&ke(t,637,Zw(s)),ke(t,636),delete s.iauthor})}),ke(t,634),ke(t,629),t.end()}var P5="application/vnd.ms-office.vbaProject";function D5(e){var t=$e.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,a){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var s=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");$e.utils.cfb_add(t,s,e.FileIndex[a].content)}}),$e.write(t)}function I5(e,t){t.FullPaths.forEach(function(r,a){if(a!=0){var s=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");s.slice(-1)!=="/"&&$e.utils.cfb_add(e,s,t.FileIndex[a].content)}})}var Jg=["xlsb","xlsm","xlam","biff8","xla"];function M5(){return{"!type":"dialog"}}function R5(){return{"!type":"dialog"}}function O5(){return{"!type":"macro"}}function L5(){return{"!type":"macro"}}var di=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(a,s,i,l){var c=!1,o=!1;i.length==0?o=!0:i.charAt(0)=="["&&(o=!0,i=i.slice(1,-1)),l.length==0?c=!0:l.charAt(0)=="["&&(c=!0,l=l.slice(1,-1));var u=i.length>0?parseInt(i,10)|0:0,d=l.length>0?parseInt(l,10)|0:0;return c?d+=t.c:--d,o?u+=t.r:--u,s+(c?"":"$")+Wt(d)+(o?"":"$")+Zt(u)}return function(s,i){return t=i,s.replace(e,r)}}(),Nf=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,jf=function(){return function(t,r){return t.replace(Nf,function(a,s,i,l,c,o){var u=of(l)-(i?0:r.c),d=cf(o)-(c?0:r.r),f=d==0?"":c?d+1:"["+d+"]",x=u==0?"":i?u+1:"["+u+"]";return s+"R"+f+"C"+x})}}();function Qg(e,t){return e.replace(Nf,function(r,a,s,i,l,c){return a+(s=="$"?s+i:Wt(of(i)+t.c))+(l=="$"?l+c:Zt(cf(c)+t.r))})}function B5(e,t,r){var a=nn(t),s=a.s,i=Ht(r),l={r:i.r-s.r,c:i.c-s.c};return Qg(e,l)}function U5(e){return e.length!=1}function Wm(e){return e.replace(/_xlfn\./g,"")}function rr(e){e.l+=1}function Ja(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function Zg(e,t,r){var a=2;if(r){if(r.biff>=2&&r.biff<=5)return ev(e);r.biff==12&&(a=4)}var s=e.read_shift(a),i=e.read_shift(a),l=Ja(e),c=Ja(e);return{s:{r:s,c:l[0],cRel:l[1],rRel:l[2]},e:{r:i,c:c[0],cRel:c[1],rRel:c[2]}}}function ev(e){var t=Ja(e),r=Ja(e),a=e.read_shift(1),s=e.read_shift(1);return{s:{r:t[0],c:a,cRel:t[1],rRel:t[2]},e:{r:r[0],c:s,cRel:r[1],rRel:r[2]}}}function z5(e,t,r){if(r.biff<8)return ev(e);var a=e.read_shift(r.biff==12?4:2),s=e.read_shift(r.biff==12?4:2),i=Ja(e),l=Ja(e);return{s:{r:a,c:i[0],cRel:i[1],rRel:i[2]},e:{r:s,c:l[0],cRel:l[1],rRel:l[2]}}}function tv(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return W5(e);var a=e.read_shift(r&&r.biff==12?4:2),s=Ja(e);return{r:a,c:s[0],cRel:s[1],rRel:s[2]}}function W5(e){var t=Ja(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function H5(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function $5(e,t,r){var a=r&&r.biff?r.biff:8;if(a>=2&&a<=5)return V5(e);var s=e.read_shift(a>=12?4:2),i=e.read_shift(2),l=(i&16384)>>14,c=(i&32768)>>15;if(i&=16383,c==1)for(;s>524287;)s-=1048576;if(l==1)for(;i>8191;)i=i-16384;return{r:s,c:i,cRel:l,rRel:c}}function V5(e){var t=e.read_shift(2),r=e.read_shift(1),a=(t&32768)>>15,s=(t&16384)>>14;return t&=16383,a==1&&t>=8192&&(t=t-16384),s==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:s,rRel:a}}function G5(e,t,r){var a=(e[e.l++]&96)>>5,s=Zg(e,r.biff>=2&&r.biff<=5?6:8,r);return[a,s]}function X5(e,t,r){var a=(e[e.l++]&96)>>5,s=e.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}var l=Zg(e,i,r);return[a,s,l]}function K5(e,t,r){var a=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[a]}function Y5(e,t,r){var a=(e[e.l++]&96)>>5,s=e.read_shift(2),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}return e.l+=i,[a,s]}function q5(e,t,r){var a=(e[e.l++]&96)>>5,s=z5(e,t-1,r);return[a,s]}function J5(e,t,r){var a=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[a]}function Hm(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function Q5(e,t,r){e.l+=2;for(var a=e.read_shift(r&&r.biff==2?1:2),s=[],i=0;i<=a;++i)s.push(e.read_shift(r&&r.biff==2?1:2));return s}function Z5(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(r&&r.biff==2?1:2)]}function e3(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(r&&r.biff==2?1:2)]}function t3(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function r3(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[a]}function rv(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function n3(e){return e.read_shift(2),rv(e)}function a3(e){return e.read_shift(2),rv(e)}function s3(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var s=tv(e,0,r);return[a,s]}function i3(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var s=$5(e,0,r);return[a,s]}function l3(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var i=tv(e,0,r);return[a,s,i]}function c3(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(r&&r.biff<=3?1:2);return[u_[s],sv[s],a]}function o3(e,t,r){var a=e[e.l++],s=e.read_shift(1),i=r&&r.biff<=3?[a==88?-1:0,e.read_shift(1)]:d3(e);return[s,(i[0]===0?sv:d_)[i[1]]]}function d3(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function u3(e,t,r){e.l+=r&&r.biff==2?3:4}function f3(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var a=e.read_shift(2),s=e.read_shift(r&&r.biff==2?1:2);return[a,s]}function x3(e){return e.l++,_a[e.read_shift(1)]}function m3(e){return e.l++,e.read_shift(2)}function h3(e){return e.l++,e.read_shift(1)!==0}function p3(e){return e.l++,Ir(e)}function g3(e,t,r){return e.l++,Jl(e,t-1,r)}function v3(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Jt(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=_a[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Ir(e);break;case 2:r[1]=Os(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function y3(e,t,r){for(var a=e.read_shift(r.biff==12?4:2),s=[],i=0;i!=a;++i)s.push((r.biff==12?Rs:Qo)(e));return s}function b3(e,t,r){var a=0,s=0;r.biff==12?(a=e.read_shift(4),s=e.read_shift(4)):(s=1+e.read_shift(1),a=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--a,--s==0&&(s=256));for(var i=0,l=[];i!=a&&(l[i]=[]);++i)for(var c=0;c!=s;++c)l[i][c]=v3(e,r.biff);return l}function w3(e,t,r){var a=e.read_shift(1)>>>5&3,s=!r||r.biff>=8?4:2,i=e.read_shift(s);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[a,0,i]}function N3(e,t,r){if(r.biff==5)return j3(e);var a=e.read_shift(1)>>>5&3,s=e.read_shift(2),i=e.read_shift(4);return[a,s,i]}function j3(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var a=e.read_shift(2);return e.l+=12,[t,r,a]}function k3(e,t,r){var a=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var s=e.read_shift(r&&r.biff==2?1:2);return[a,s]}function _3(e,t,r){var a=e.read_shift(1)>>>5&3,s=e.read_shift(r&&r.biff==2?1:2);return[a,s]}function S3(e,t,r){var a=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[a]}function C3(e,t,r){var a=(e[e.l++]&96)>>5,s=e.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return e.l+=i,[a,s]}var E3=Or,T3=Or,F3=Or;function Zl(e,t,r){return e.l+=2,[H5(e)]}function kf(e){return e.l+=6,[]}var A3=Zl,P3=kf,D3=kf,I3=Zl;function nv(e){return e.l+=2,[ar(e),e.read_shift(2)&1]}var M3=Zl,R3=nv,O3=kf,L3=Zl,B3=Zl,U3=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function z3(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(4),s=e.read_shift(2),i=e.read_shift(2),l=U3[r>>2&31];return{ixti:t,coltype:r&3,rt:l,idx:a,c:s,C:i}}function W3(e){return e.l+=2,[e.read_shift(4)]}function H3(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function $3(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function V3(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function G3(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function X3(e){return e.l+=4,[0,0]}var $m={1:{n:"PtgExp",f:f3},2:{n:"PtgTbl",f:F3},3:{n:"PtgAdd",f:rr},4:{n:"PtgSub",f:rr},5:{n:"PtgMul",f:rr},6:{n:"PtgDiv",f:rr},7:{n:"PtgPower",f:rr},8:{n:"PtgConcat",f:rr},9:{n:"PtgLt",f:rr},10:{n:"PtgLe",f:rr},11:{n:"PtgEq",f:rr},12:{n:"PtgGe",f:rr},13:{n:"PtgGt",f:rr},14:{n:"PtgNe",f:rr},15:{n:"PtgIsect",f:rr},16:{n:"PtgUnion",f:rr},17:{n:"PtgRange",f:rr},18:{n:"PtgUplus",f:rr},19:{n:"PtgUminus",f:rr},20:{n:"PtgPercent",f:rr},21:{n:"PtgParen",f:rr},22:{n:"PtgMissArg",f:rr},23:{n:"PtgStr",f:g3},26:{n:"PtgSheet",f:H3},27:{n:"PtgEndSheet",f:$3},28:{n:"PtgErr",f:x3},29:{n:"PtgBool",f:h3},30:{n:"PtgInt",f:m3},31:{n:"PtgNum",f:p3},32:{n:"PtgArray",f:J5},33:{n:"PtgFunc",f:c3},34:{n:"PtgFuncVar",f:o3},35:{n:"PtgName",f:w3},36:{n:"PtgRef",f:s3},37:{n:"PtgArea",f:G5},38:{n:"PtgMemArea",f:k3},39:{n:"PtgMemErr",f:E3},40:{n:"PtgMemNoMem",f:T3},41:{n:"PtgMemFunc",f:_3},42:{n:"PtgRefErr",f:S3},43:{n:"PtgAreaErr",f:K5},44:{n:"PtgRefN",f:i3},45:{n:"PtgAreaN",f:q5},46:{n:"PtgMemAreaN",f:V3},47:{n:"PtgMemNoMemN",f:G3},57:{n:"PtgNameX",f:N3},58:{n:"PtgRef3d",f:l3},59:{n:"PtgArea3d",f:X5},60:{n:"PtgRefErr3d",f:C3},61:{n:"PtgAreaErr3d",f:Y5},255:{}},K3={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Y3={1:{n:"PtgElfLel",f:nv},2:{n:"PtgElfRw",f:L3},3:{n:"PtgElfCol",f:A3},6:{n:"PtgElfRwV",f:B3},7:{n:"PtgElfColV",f:I3},10:{n:"PtgElfRadical",f:M3},11:{n:"PtgElfRadicalS",f:O3},13:{n:"PtgElfColS",f:P3},15:{n:"PtgElfColSV",f:D3},16:{n:"PtgElfRadicalLel",f:R3},25:{n:"PtgList",f:z3},29:{n:"PtgSxName",f:W3},255:{}},q3={0:{n:"PtgAttrNoop",f:X3},1:{n:"PtgAttrSemi",f:r3},2:{n:"PtgAttrIf",f:e3},4:{n:"PtgAttrChoose",f:Q5},8:{n:"PtgAttrGoto",f:Z5},16:{n:"PtgAttrSum",f:u3},32:{n:"PtgAttrBaxcel",f:Hm},33:{n:"PtgAttrBaxcel",f:Hm},64:{n:"PtgAttrSpace",f:n3},65:{n:"PtgAttrSpaceSemi",f:a3},128:{n:"PtgAttrIfError",f:t3},255:{}};function ec(e,t,r,a){if(a.biff<8)return Or(e,t);for(var s=e.l+t,i=[],l=0;l!==r.length;++l)switch(r[l][0]){case"PtgArray":r[l][1]=b3(e,0,a),i.push(r[l][1]);break;case"PtgMemArea":r[l][2]=y3(e,r[l][1],a),i.push(r[l][2]);break;case"PtgExp":a&&a.biff==12&&(r[l][1][1]=e.read_shift(4),i.push(r[l][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[l][0]}return t=s-e.l,t!==0&&i.push(Or(e,t)),i}function tc(e,t,r){for(var a=e.l+t,s,i,l=[];a!=e.l;)t=a-e.l,i=e[e.l],s=$m[i]||$m[K3[i]],(i===24||i===25)&&(s=(i===24?Y3:q3)[e[e.l+1]]),!s||!s.f?Or(e,t):l.push([s.n,s.f(e,t,r)]);return l}function J3(e){for(var t=[],r=0;r<e.length;++r){for(var a=e[r],s=[],i=0;i<a.length;++i){var l=a[i];if(l)switch(l[0]){case 2:s.push('"'+l[1].replace(/"/g,'""')+'"');break;default:s.push(l[1])}else s.push("")}t.push(s.join(","))}return t.join(";")}var Q3={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function Z3(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function av(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var a=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!a)return"SH33TJSERR1";var s="";if(r.biff>8)switch(e[a[0]][0]){case 357:return s=a[1]==-1?"#REF":e.SheetNames[a[1]],a[1]==a[2]?s:s+":"+e.SheetNames[a[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[a[0]][0];case 355:default:return"SH33TJSSRC"+e[a[0]][0]}switch(e[a[0]][0][0]){case 1025:return s=a[1]==-1?"#REF":e.SheetNames[a[1]]||"SH33TJSERR3",a[1]==a[2]?s:s+":"+e.SheetNames[a[2]];case 14849:return e[a[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return e[a[0]][0][3]?(s=a[1]==-1?"#REF":e[a[0]][0][3][a[1]]||"SH33TJSERR4",a[1]==a[2]?s:s+":"+e[a[0]][0][3][a[2]]):"SH33TJSERR2"}}function Vm(e,t,r){var a=av(e,t,r);return a=="#REF"?a:Z3(a,r)}function Ar(e,t,r,a,s){var i=s&&s.biff||8,l={s:{c:0,r:0},e:{c:0,r:0}},c=[],o,u,d,f=0,x=0,h,p="";if(!e[0]||!e[0][0])return"";for(var m=-1,w="",v=0,b=e[0].length;v<b;++v){var y=e[0][v];switch(y[0]){case"PtgUminus":c.push("-"+c.pop());break;case"PtgUplus":c.push("+"+c.pop());break;case"PtgPercent":c.push(c.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(o=c.pop(),u=c.pop(),m>=0){switch(e[0][m][1][0]){case 0:w=Xt(" ",e[0][m][1][1]);break;case 1:w=Xt("\r",e[0][m][1][1]);break;default:if(w="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}u=u+w,m=-1}c.push(u+Q3[y[0]]+o);break;case"PtgIsect":o=c.pop(),u=c.pop(),c.push(u+" "+o);break;case"PtgUnion":o=c.pop(),u=c.pop(),c.push(u+","+o);break;case"PtgRange":o=c.pop(),u=c.pop(),c.push(u+":"+o);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=nl(y[1][1],l,s),c.push(al(d,i));break;case"PtgRefN":d=r?nl(y[1][1],r,s):y[1][1],c.push(al(d,i));break;case"PtgRef3d":f=y[1][1],d=nl(y[1][2],l,s),p=Vm(a,f,s),c.push(p+"!"+al(d,i));break;case"PtgFunc":case"PtgFuncVar":var N=y[1][0],A=y[1][1];N||(N=0),N&=127;var k=N==0?[]:c.slice(-N);c.length-=N,A==="User"&&(A=k.shift()),c.push(A+"("+k.join(",")+")");break;case"PtgBool":c.push(y[1]?"TRUE":"FALSE");break;case"PtgInt":c.push(y[1]);break;case"PtgNum":c.push(String(y[1]));break;case"PtgStr":c.push('"'+y[1].replace(/"/g,'""')+'"');break;case"PtgErr":c.push(y[1]);break;case"PtgAreaN":h=bm(y[1][1],r?{s:r}:l,s),c.push(A0(h,s));break;case"PtgArea":h=bm(y[1][1],l,s),c.push(A0(h,s));break;case"PtgArea3d":f=y[1][1],h=y[1][2],p=Vm(a,f,s),c.push(p+"!"+A0(h,s));break;case"PtgAttrSum":c.push("SUM("+c.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":x=y[1][2];var _=(a.names||[])[x-1]||(a[0]||[])[x],j=_?_.Name:"SH33TJSNAME"+String(x);j&&j.slice(0,6)=="_xlfn."&&!s.xlfn&&(j=j.slice(6)),c.push(j);break;case"PtgNameX":var P=y[1][1];x=y[1][2];var D;if(s.biff<=5)P<0&&(P=-P),a[P]&&(D=a[P][x]);else{var K="";if(((a[P]||[])[0]||[])[0]==14849||(((a[P]||[])[0]||[])[0]==1025?a[P][x]&&a[P][x].itab>0&&(K=a.SheetNames[a[P][x].itab-1]+"!"):K=a.SheetNames[x-1]+"!"),a[P]&&a[P][x])K+=a[P][x].Name;else if(a[0]&&a[0][x])K+=a[0][x].Name;else{var E=(av(a,P,s)||"").split(";;");E[x-1]?K=E[x-1]:K+="SH33TJSERRX"}c.push(K);break}D||(D={Name:"SH33TJSERRY"}),c.push(D.Name);break;case"PtgParen":var Y="(",B=")";if(m>=0){switch(w="",e[0][m][1][0]){case 2:Y=Xt(" ",e[0][m][1][1])+Y;break;case 3:Y=Xt("\r",e[0][m][1][1])+Y;break;case 4:B=Xt(" ",e[0][m][1][1])+B;break;case 5:B=Xt("\r",e[0][m][1][1])+B;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}m=-1}c.push(Y+c.pop()+B);break;case"PtgRefErr":c.push("#REF!");break;case"PtgRefErr3d":c.push("#REF!");break;case"PtgExp":d={c:y[1][1],r:y[1][0]};var te={c:r.c,r:r.r};if(a.sharedf[Ke(d)]){var re=a.sharedf[Ke(d)];c.push(Ar(re,l,te,a,s))}else{var Q=!1;for(o=0;o!=a.arrayf.length;++o)if(u=a.arrayf[o],!(d.c<u[0].s.c||d.c>u[0].e.c)&&!(d.r<u[0].s.r||d.r>u[0].e.r)){c.push(Ar(u[1],l,te,a,s)),Q=!0;break}Q||c.push(y[1])}break;case"PtgArray":c.push("{"+J3(y[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":m=v;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":c.push("");break;case"PtgAreaErr":c.push("#REF!");break;case"PtgAreaErr3d":c.push("#REF!");break;case"PtgList":c.push("Table"+y[1].idx+"[#"+y[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(y));default:throw new Error("Unrecognized Formula Token: "+String(y))}var Z=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&m>=0&&Z.indexOf(e[0][v][0])==-1){y=e[0][m];var z=!0;switch(y[1][0]){case 4:z=!1;case 0:w=Xt(" ",y[1][1]);break;case 5:z=!1;case 1:w=Xt("\r",y[1][1]);break;default:if(w="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+y[1][0])}c.push((z?w:"")+c.pop()+(z?"":w)),m=-1}}if(c.length>1&&s.WTF)throw new Error("bad formula stack");return c[0]}function e_(e,t,r){var a=e.l+t,s=r.biff==2?1:2,i,l=e.read_shift(s);if(l==65535)return[[],Or(e,t-2)];var c=tc(e,l,r);return t!==l+s&&(i=ec(e,t-l-s,c,r)),e.l=a,[c,i]}function t_(e,t,r){var a=e.l+t,s=r.biff==2?1:2,i,l=e.read_shift(s);if(l==65535)return[[],Or(e,t-2)];var c=tc(e,l,r);return t!==l+s&&(i=ec(e,t-l-s,c,r)),e.l=a,[c,i]}function r_(e,t,r,a){var s=e.l+t,i=tc(e,a,r),l;return s!==e.l&&(l=ec(e,s-e.l,i,r)),[i,l]}function n_(e,t,r){var a=e.l+t,s,i=e.read_shift(2),l=tc(e,i,r);return i==65535?[[],Or(e,t-2)]:(t!==i+2&&(s=ec(e,a-i-2,l,r)),[l,s])}function a_(e){var t;if(fa(e,e.l+6)!==65535)return[Ir(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function s_(e){if(e==null){var t=ye(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return Ss(e);return Ss(0)}function R0(e,t,r){var a=e.l+t,s=ia(e);r.biff==2&&++e.l;var i=a_(e),l=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var c=t_(e,a-e.l,r);return{cell:s,val:i[0],formula:c,shared:l>>3&1,tt:i[1]}}function i_(e,t,r,a,s){var i=Es(t,r,s),l=s_(e.v),c=ye(6),o=33;c.write_shift(2,o),c.write_shift(4,0);for(var u=ye(e.bf.length),d=0;d<e.bf.length;++d)u[d]=e.bf[d];var f=mr([i,l,c,u]);return f}function Zo(e,t,r){var a=e.read_shift(4),s=tc(e,a,r),i=e.read_shift(4),l=i>0?ec(e,i,s,r):null;return[s,l]}var l_=Zo,e0=Zo,c_=Zo,o_=Zo,d_={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},sv={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},u_={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Gm(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function f_(e){var t="of:="+e.replace(Nf,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function O0(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function x_(e){return e.replace(/\./,"!")}var il={},ui={},ll=typeof Map<"u";function _f(e,t,r){var a=0,s=e.length;if(r){if(ll?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var i=ll?r.get(t):r[t];a<i.length;++a)if(e[i[a]].t===t)return e.Count++,i[a]}}else for(;a<s;++a)if(e[a].t===t)return e.Count++,a;return e[s]={t},e.Count++,e.Unique++,r&&(ll?(r.has(t)||r.set(t,[]),r.get(t).push(s)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(s))),s}function t0(e,t){var r={min:e+1,max:e+1},a=-1;return t.MDW&&(Dr=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?a=Ll(t.wpx):t.wch!=null&&(a=t.wch),a>-1?(r.width=To(a),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function gs(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function as(e,t,r){var a=r.revssf[t.z!=null?t.z:"General"],s=60,i=e.length;if(a==null&&r.ssf){for(;s<392;++s)if(r.ssf[s]==null){ha(t.z,s),r.ssf[s]=t.z,r.revssf[t.z]=a=s;break}}for(s=0;s!=i;++s)if(e[s].numFmtId===a)return s;return e[i]={numFmtId:a,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function iv(e,t,r,a,s,i){try{a.cellNF&&(e.z=Xe[t])}catch(c){if(a.WTF)throw c}if(!(e.t==="z"&&!a.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=It(e.v)),(!a||a.cellText!==!1)&&e.t!=="z")try{if(Xe[t]==null&&ha(dw[t]||"General",t),e.t==="e")e.w=e.w||_a[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Al(e.v);else if(e.t==="d"){var l=dr(e.v);(l|0)===l?e.w=l.toString(10):e.w=Al(l)}else{if(e.v===void 0)return"";e.w=ks(e.v,ui)}else e.t==="d"?e.w=Dn(t,dr(e.v),ui):e.w=Dn(t,e.v,ui)}catch(c){if(a.WTF)throw c}if(a.cellStyles&&r!=null)try{e.s=i.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Eo(s.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),a.WTF&&(e.s.fgColor.raw_rgb=s.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Eo(s.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),a.WTF&&(e.s.bgColor.raw_rgb=s.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(c){if(a.WTF&&i.Fills)throw c}}}function m_(e,t,r){if(e&&e["!ref"]){var a=mt(e["!ref"]);if(a.e.c<a.s.c||a.e.r<a.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function h_(e,t){var r=mt(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=et(r))}var p_=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,g_=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,v_=/<(?:\w:)?hyperlink [^>]*>/mg,y_=/"(\w*:\w*)"/,b_=/<(?:\w:)?col\b[^>]*[\/]?>/g,w_=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,N_=/<(?:\w:)?pageMargins[^>]*\/>/g,lv=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,j_=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,k_=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function __(e,t,r,a,s,i,l){if(!e)return e;a||(a={"!id":{}});var c=t.dense?[]:{},o={s:{r:2e6,c:2e6},e:{r:0,c:0}},u="",d="",f=e.match(g_);f?(u=e.slice(0,f.index),d=e.slice(f.index+f[0].length)):u=d=e;var x=u.match(lv);x?Sf(x[0],c,s,r):(x=u.match(j_))&&C_(x[0],x[1]||"",c,s,r);var h=(u.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(h>0){var p=u.slice(h,h+50).match(y_);p&&h_(c,p[1])}var m=u.match(k_);m&&m[1]&&U_(m[1],s);var w=[];if(t.cellStyles){var v=u.match(b_);v&&M_(w,v)}f&&H_(f[1],c,t,o,i,l);var b=d.match(w_);b&&(c["!autofilter"]=O_(b[0]));var y=[],N=d.match(p_);if(N)for(h=0;h!=N.length;++h)y[h]=mt(N[h].slice(N[h].indexOf('"')+1));var A=d.match(v_);A&&P_(c,A,a);var k=d.match(N_);if(k&&(c["!margins"]=D_(Ye(k[0]))),!c["!ref"]&&o.e.c>=o.s.c&&o.e.r>=o.s.r&&(c["!ref"]=et(o)),t.sheetRows>0&&c["!ref"]){var _=mt(c["!ref"]);t.sheetRows<=+_.e.r&&(_.e.r=t.sheetRows-1,_.e.r>o.e.r&&(_.e.r=o.e.r),_.e.r<_.s.r&&(_.s.r=_.e.r),_.e.c>o.e.c&&(_.e.c=o.e.c),_.e.c<_.s.c&&(_.s.c=_.e.c),c["!fullref"]=c["!ref"],c["!ref"]=et(_))}return w.length>0&&(c["!cols"]=w),y.length>0&&(c["!merges"]=y),c}function S_(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+et(e[r])+'"/>';return t+"</mergeCells>"}function Sf(e,t,r,a){var s=Ye(e);r.Sheets[a]||(r.Sheets[a]={}),s.codeName&&(r.Sheets[a].CodeName=xt(jt(s.codeName)))}function C_(e,t,r,a,s){Sf(e.slice(0,e.indexOf(">")),r,a,s)}function E_(e,t,r,a,s){var i=!1,l={},c=null;if(a.bookType!=="xlsx"&&t.vbaraw){var o=t.SheetNames[r];try{t.Workbook&&(o=t.Workbook.Sheets[r].CodeName||o)}catch{}i=!0,l.codeName=ta(wt(o))}if(e&&e["!outline"]){var u={summaryBelow:1,summaryRight:1};e["!outline"].above&&(u.summaryBelow=0),e["!outline"].left&&(u.summaryRight=0),c=(c||"")+Fe("outlinePr",null,u)}!i&&!c||(s[s.length]=Fe("sheetPr",c,l))}var T_=["objects","scenarios","selectLockedCells","selectUnlockedCells"],F_=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function A_(e){var t={sheet:1};return T_.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),F_.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=yf(e.password).toString(16).toUpperCase()),Fe("sheetProtection",null,t)}function P_(e,t,r){for(var a=Array.isArray(e),s=0;s!=t.length;++s){var i=Ye(jt(t[s]),!0);if(!i.ref)return;var l=((r||{})["!id"]||[])[i.id];l?(i.Target=l.Target,i.location&&(i.Target+="#"+xt(i.location))):(i.Target="#"+xt(i.location),l={Target:i.Target,TargetMode:"Internal"}),i.Rel=l,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var c=mt(i.ref),o=c.s.r;o<=c.e.r;++o)for(var u=c.s.c;u<=c.e.c;++u){var d=Ke({c:u,r:o});a?(e[o]||(e[o]=[]),e[o][u]||(e[o][u]={t:"z",v:void 0}),e[o][u].l=i):(e[d]||(e[d]={t:"z",v:void 0}),e[d].l=i)}}}function D_(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function I_(e){return gs(e),Fe("pageMargins",null,e)}function M_(e,t){for(var r=!1,a=0;a!=t.length;++a){var s=Ye(t[a],!0);s.hidden&&(s.hidden=Ft(s.hidden));var i=parseInt(s.min,10)-1,l=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!r&&s.width&&(r=!0,bf(s.width)),qa(s);i<=l;)e[i++]=Mt(s)}}function R_(e,t){for(var r=["<cols>"],a,s=0;s!=t.length;++s)(a=t[s])&&(r[r.length]=Fe("col",null,t0(s,a)));return r[r.length]="</cols>",r.join("")}function O_(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function L_(e,t,r,a){var s=typeof e.ref=="string"?e.ref:et(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,l=nn(s);l.s.r==l.e.r&&(l.e.r=nn(t["!ref"]).e.r,s=et(l));for(var c=0;c<i.length;++c){var o=i[c];if(o.Name=="_xlnm._FilterDatabase"&&o.Sheet==a){o.Ref="'"+r.SheetNames[a]+"'!"+s;break}}return c==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+r.SheetNames[a]+"'!"+s}),Fe("autoFilter",null,{ref:s})}var B_=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function U_(e,t){t.Views||(t.Views=[{}]),(e.match(B_)||[]).forEach(function(r,a){var s=Ye(r);t.Views[a]||(t.Views[a]={}),+s.zoomScale&&(t.Views[a].zoom=+s.zoomScale),Ft(s.rightToLeft)&&(t.Views[a].RTL=!0)})}function z_(e,t,r,a){var s={workbookViewId:"0"};return(((a||{}).Workbook||{}).Views||[])[0]&&(s.rightToLeft=a.Workbook.Views[0].RTL?"1":"0"),Fe("sheetViews",Fe("sheetView",null,s),{})}function W_(e,t,r,a){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var s="",i=e.t,l=e.v;if(e.t!=="z")switch(e.t){case"b":s=e.v?"1":"0";break;case"n":s=""+e.v;break;case"e":s=_a[e.v];break;case"d":a&&a.cellDates?s=It(e.v,-1).toISOString():(e=Mt(e),e.t="n",s=""+(e.v=dr(It(e.v)))),typeof e.z>"u"&&(e.z=Xe[14]);break;default:s=e.v;break}var c=Nr("v",wt(s)),o={r:t},u=as(a.cellXfs,e,a);switch(u!==0&&(o.s=u),e.t){case"n":break;case"d":o.t="d";break;case"b":o.t="b";break;case"e":o.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(a&&a.bookSST){c=Nr("v",""+_f(a.Strings,e.v,a.revStrings)),o.t="s";break}o.t="str";break}if(e.t!=i&&(e.t=i,e.v=l),typeof e.f=="string"&&e.f){var d=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;c=Fe("f",wt(e.f),d)+(e.v!=null?c:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(o.cm=1),Fe("c",c,o)}var H_=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,a=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,i=Pl("v"),l=Pl("f");return function(o,u,d,f,x,h){for(var p=0,m="",w=[],v=[],b=0,y=0,N=0,A="",k,_,j=0,P=0,D,K,E=0,Y=0,B=Array.isArray(h.CellXf),te,re=[],Q=[],Z=Array.isArray(u),z=[],ne={},xe=!1,O=!!d.sheetStubs,R=o.split(t),g=0,S=R.length;g!=S;++g){m=R[g].trim();var F=m.length;if(F!==0){var ae=0;e:for(p=0;p<F;++p)switch(m[p]){case">":if(m[p-1]!="/"){++p;break e}if(d&&d.cellStyles){if(_=Ye(m.slice(ae,p),!0),j=_.r!=null?parseInt(_.r,10):j+1,P=-1,d.sheetRows&&d.sheetRows<j)continue;ne={},xe=!1,_.ht&&(xe=!0,ne.hpt=parseFloat(_.ht),ne.hpx=Ni(ne.hpt)),_.hidden=="1"&&(xe=!0,ne.hidden=!0),_.outlineLevel!=null&&(xe=!0,ne.level=+_.outlineLevel),xe&&(z[j-1]=ne)}break;case"<":ae=p;break}if(ae>=p)break;if(_=Ye(m.slice(ae,p),!0),j=_.r!=null?parseInt(_.r,10):j+1,P=-1,!(d.sheetRows&&d.sheetRows<j)){f.s.r>j-1&&(f.s.r=j-1),f.e.r<j-1&&(f.e.r=j-1),d&&d.cellStyles&&(ne={},xe=!1,_.ht&&(xe=!0,ne.hpt=parseFloat(_.ht),ne.hpx=Ni(ne.hpt)),_.hidden=="1"&&(xe=!0,ne.hidden=!0),_.outlineLevel!=null&&(xe=!0,ne.level=+_.outlineLevel),xe&&(z[j-1]=ne)),w=m.slice(p).split(e);for(var ue=0;ue!=w.length&&w[ue].trim().charAt(0)=="<";++ue);for(w=w.slice(ue),p=0;p!=w.length;++p)if(m=w[p].trim(),m.length!==0){if(v=m.match(r),b=p,y=0,N=0,m="<c "+(m.slice(0,1)=="<"?">":"")+m,v!=null&&v.length===2){for(b=0,A=v[1],y=0;y!=A.length&&!((N=A.charCodeAt(y)-64)<1||N>26);++y)b=26*b+N;--b,P=b}else++P;for(y=0;y!=m.length&&m.charCodeAt(y)!==62;++y);if(++y,_=Ye(m.slice(0,y),!0),_.r||(_.r=Ke({r:j-1,c:P})),A=m.slice(y),k={t:""},(v=A.match(i))!=null&&v[1]!==""&&(k.v=xt(v[1])),d.cellFormula){if((v=A.match(l))!=null&&v[1]!==""){if(k.f=xt(jt(v[1])).replace(/\r\n/g,`
`),d.xlfn||(k.f=Wm(k.f)),v[0].indexOf('t="array"')>-1)k.F=(A.match(s)||[])[1],k.F.indexOf(":")>-1&&re.push([mt(k.F),k.F]);else if(v[0].indexOf('t="shared"')>-1){K=Ye(v[0]);var ve=xt(jt(v[1]));d.xlfn||(ve=Wm(ve)),Q[parseInt(K.si,10)]=[K,ve,_.r]}}else(v=A.match(/<f[^>]*\/>/))&&(K=Ye(v[0]),Q[K.si]&&(k.f=B5(Q[K.si][1],Q[K.si][2],_.r)));var me=Ht(_.r);for(y=0;y<re.length;++y)me.r>=re[y][0].s.r&&me.r<=re[y][0].e.r&&me.c>=re[y][0].s.c&&me.c<=re[y][0].e.c&&(k.F=re[y][1])}if(_.t==null&&k.v===void 0)if(k.f||k.F)k.v=0,k.t="n";else if(O)k.t="z";else continue;else k.t=_.t||"n";switch(f.s.c>P&&(f.s.c=P),f.e.c<P&&(f.e.c=P),k.t){case"n":if(k.v==""||k.v==null){if(!O)continue;k.t="z"}else k.v=parseFloat(k.v);break;case"s":if(typeof k.v>"u"){if(!O)continue;k.t="z"}else D=il[parseInt(k.v,10)],k.v=D.t,k.r=D.r,d.cellHTML&&(k.h=D.h);break;case"str":k.t="s",k.v=k.v!=null?jt(k.v):"",d.cellHTML&&(k.h=nf(k.v));break;case"inlineStr":v=A.match(a),k.t="s",v!=null&&(D=vf(v[1]))?(k.v=D.t,d.cellHTML&&(k.h=D.h)):k.v="";break;case"b":k.v=Ft(k.v);break;case"d":d.cellDates?k.v=It(k.v,1):(k.v=dr(It(k.v,1)),k.t="n");break;case"e":(!d||d.cellText!==!1)&&(k.w=k.v),k.v=og[k.v];break}if(E=Y=0,te=null,B&&_.s!==void 0&&(te=h.CellXf[_.s],te!=null&&(te.numFmtId!=null&&(E=te.numFmtId),d.cellStyles&&te.fillId!=null&&(Y=te.fillId))),iv(k,E,Y,d,x,h),d.cellDates&&B&&k.t=="n"&&Si(Xe[E])&&(k.t="d",k.v=Jo(k.v)),_.cm&&d.xlmeta){var H=(d.xlmeta.Cell||[])[+_.cm-1];H&&H.type=="XLDAPR"&&(k.D=!0)}if(Z){var T=Ht(_.r);u[T.r]||(u[T.r]=[]),u[T.r][T.c]=k}else u[_.r]=k}}}}z.length>0&&(u["!rows"]=z)}}();function $_(e,t,r,a){var s=[],i=[],l=mt(e["!ref"]),c="",o,u="",d=[],f=0,x=0,h=e["!rows"],p=Array.isArray(e),m={r:u},w,v=-1;for(x=l.s.c;x<=l.e.c;++x)d[x]=Wt(x);for(f=l.s.r;f<=l.e.r;++f){for(i=[],u=Zt(f),x=l.s.c;x<=l.e.c;++x){o=d[x]+u;var b=p?(e[f]||[])[x]:e[o];b!==void 0&&(c=W_(b,o,e,t))!=null&&i.push(c)}(i.length>0||h&&h[f])&&(m={r:u},h&&h[f]&&(w=h[f],w.hidden&&(m.hidden=1),v=-1,w.hpx?v=Bl(w.hpx):w.hpt&&(v=w.hpt),v>-1&&(m.ht=v,m.customHeight=1),w.level&&(m.outlineLevel=w.level)),s[s.length]=Fe("row",i.join(""),m))}if(h)for(;f<h.length;++f)h&&h[f]&&(m={r:f+1},w=h[f],w.hidden&&(m.hidden=1),v=-1,w.hpx?v=Bl(w.hpx):w.hpt&&(v=w.hpt),v>-1&&(m.ht=v,m.customHeight=1),w.level&&(m.outlineLevel=w.level),s[s.length]=Fe("row","",m));return s.join("")}function cv(e,t,r,a){var s=[er,Fe("worksheet",null,{xmlns:Ps[0],"xmlns:r":cr.r})],i=r.SheetNames[e],l=0,c="",o=r.Sheets[i];o==null&&(o={});var u=o["!ref"]||"A1",d=mt(u);if(d.e.c>16383||d.e.r>1048575){if(t.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),u=et(d)}a||(a={}),o["!comments"]=[];var f=[];E_(o,r,e,t,s),s[s.length]=Fe("dimension",null,{ref:u}),s[s.length]=z_(o,t,e,r),t.sheetFormat&&(s[s.length]=Fe("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),o["!cols"]!=null&&o["!cols"].length>0&&(s[s.length]=R_(o,o["!cols"])),s[l=s.length]="<sheetData/>",o["!links"]=[],o["!ref"]!=null&&(c=$_(o,t),c.length>0&&(s[s.length]=c)),s.length>l+1&&(s[s.length]="</sheetData>",s[l]=s[l].replace("/>",">")),o["!protect"]&&(s[s.length]=A_(o["!protect"])),o["!autofilter"]!=null&&(s[s.length]=L_(o["!autofilter"],o,r,e)),o["!merges"]!=null&&o["!merges"].length>0&&(s[s.length]=S_(o["!merges"]));var x=-1,h,p=-1;return o["!links"].length>0&&(s[s.length]="<hyperlinks>",o["!links"].forEach(function(m){m[1].Target&&(h={ref:m[0]},m[1].Target.charAt(0)!="#"&&(p=bt(a,-1,wt(m[1].Target).replace(/#.*$/,""),st.HLINK),h["r:id"]="rId"+p),(x=m[1].Target.indexOf("#"))>-1&&(h.location=wt(m[1].Target.slice(x+1))),m[1].Tooltip&&(h.tooltip=wt(m[1].Tooltip)),s[s.length]=Fe("hyperlink",null,h))}),s[s.length]="</hyperlinks>"),delete o["!links"],o["!margins"]!=null&&(s[s.length]=I_(o["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(s[s.length]=Nr("ignoredErrors",Fe("ignoredError",null,{numberStoredAsText:1,sqref:u}))),f.length>0&&(p=bt(a,-1,"../drawings/drawing"+(e+1)+".xml",st.DRAW),s[s.length]=Fe("drawing",null,{"r:id":"rId"+p}),o["!drawing"]=f),o["!comments"].length>0&&(p=bt(a,-1,"../drawings/vmlDrawing"+(e+1)+".vml",st.VML),s[s.length]=Fe("legacyDrawing",null,{"r:id":"rId"+p}),o["!legacy"]=p),s.length>1&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function V_(e,t){var r={},a=e.l+t;r.r=e.read_shift(4),e.l+=4;var s=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=a,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=s/20),r}function G_(e,t,r){var a=ye(145),s=(r["!rows"]||[])[e]||{};a.write_shift(4,e),a.write_shift(4,0);var i=320;s.hpx?i=Bl(s.hpx)*20:s.hpt&&(i=s.hpt*20),a.write_shift(2,i),a.write_shift(1,0);var l=0;s.level&&(l|=s.level),s.hidden&&(l|=16),(s.hpx||s.hpt)&&(l|=32),a.write_shift(1,l),a.write_shift(1,0);var c=0,o=a.l;a.l+=4;for(var u={r:e,c:0},d=0;d<16;++d)if(!(t.s.c>d+1<<10||t.e.c<d<<10)){for(var f=-1,x=-1,h=d<<10;h<d+1<<10;++h){u.c=h;var p=Array.isArray(r)?(r[u.r]||[])[u.c]:r[Ke(u)];p&&(f<0&&(f=h),x=h)}f<0||(++c,a.write_shift(4,f),a.write_shift(4,x))}var m=a.l;return a.l=o,a.write_shift(4,c),a.l=m,a.length>a.l?a.slice(0,a.l):a}function X_(e,t,r,a){var s=G_(a,r,t);(s.length>17||(t["!rows"]||[])[a])&&ke(e,0,s)}var K_=Rs,Y_=Ti;function q_(){}function J_(e,t){var r={},a=e[e.l];return++e.l,r.above=!(a&64),r.left=!(a&128),e.l+=18,r.name=eN(e),r}function Q_(e,t,r){r==null&&(r=ye(84+4*e.length));var a=192;t&&(t.above&&(a&=-65),t.left&&(a&=-129)),r.write_shift(1,a);for(var s=1;s<3;++s)r.write_shift(1,0);return _o({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),ag(e,r),r.slice(0,r.l)}function Z_(e){var t=In(e);return[t]}function eS(e,t,r){return r==null&&(r=ye(8)),Ds(t,r)}function tS(e){var t=Is(e);return[t]}function rS(e,t,r){return r==null&&(r=ye(4)),Ms(t,r)}function nS(e){var t=In(e),r=e.read_shift(1);return[t,r,"b"]}function aS(e,t,r){return r==null&&(r=ye(9)),Ds(t,r),r.write_shift(1,e.v?1:0),r}function sS(e){var t=Is(e),r=e.read_shift(1);return[t,r,"b"]}function iS(e,t,r){return r==null&&(r=ye(5)),Ms(t,r),r.write_shift(1,e.v?1:0),r}function lS(e){var t=In(e),r=e.read_shift(1);return[t,r,"e"]}function cS(e,t,r){return r==null&&(r=ye(9)),Ds(t,r),r.write_shift(1,e.v),r}function oS(e){var t=Is(e),r=e.read_shift(1);return[t,r,"e"]}function dS(e,t,r){return r==null&&(r=ye(8)),Ms(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function uS(e){var t=In(e),r=e.read_shift(4);return[t,r,"s"]}function fS(e,t,r){return r==null&&(r=ye(12)),Ds(t,r),r.write_shift(4,t.v),r}function xS(e){var t=Is(e),r=e.read_shift(4);return[t,r,"s"]}function mS(e,t,r){return r==null&&(r=ye(8)),Ms(t,r),r.write_shift(4,t.v),r}function hS(e){var t=In(e),r=Ir(e);return[t,r,"n"]}function pS(e,t,r){return r==null&&(r=ye(16)),Ds(t,r),Ss(e.v,r),r}function ov(e){var t=Is(e),r=Ir(e);return[t,r,"n"]}function gS(e,t,r){return r==null&&(r=ye(12)),Ms(t,r),Ss(e.v,r),r}function vS(e){var t=In(e),r=xf(e);return[t,r,"n"]}function yS(e,t,r){return r==null&&(r=ye(12)),Ds(t,r),sg(e.v,r),r}function bS(e){var t=Is(e),r=xf(e);return[t,r,"n"]}function wS(e,t,r){return r==null&&(r=ye(8)),Ms(t,r),sg(e.v,r),r}function NS(e){var t=In(e),r=df(e);return[t,r,"is"]}function jS(e){var t=In(e),r=Mr(e);return[t,r,"str"]}function kS(e,t,r){return r==null&&(r=ye(12+4*e.v.length)),Ds(t,r),hr(e.v,r),r.length>r.l?r.slice(0,r.l):r}function _S(e){var t=Is(e),r=Mr(e);return[t,r,"str"]}function SS(e,t,r){return r==null&&(r=ye(8+4*e.v.length)),Ms(t,r),hr(e.v,r),r.length>r.l?r.slice(0,r.l):r}function CS(e,t,r){var a=e.l+t,s=In(e);s.r=r["!row"];var i=e.read_shift(1),l=[s,i,"b"];if(r.cellFormula){e.l+=2;var c=e0(e,a-e.l,r);l[3]=Ar(c,null,s,r.supbooks,r)}else e.l=a;return l}function ES(e,t,r){var a=e.l+t,s=In(e);s.r=r["!row"];var i=e.read_shift(1),l=[s,i,"e"];if(r.cellFormula){e.l+=2;var c=e0(e,a-e.l,r);l[3]=Ar(c,null,s,r.supbooks,r)}else e.l=a;return l}function TS(e,t,r){var a=e.l+t,s=In(e);s.r=r["!row"];var i=Ir(e),l=[s,i,"n"];if(r.cellFormula){e.l+=2;var c=e0(e,a-e.l,r);l[3]=Ar(c,null,s,r.supbooks,r)}else e.l=a;return l}function FS(e,t,r){var a=e.l+t,s=In(e);s.r=r["!row"];var i=Mr(e),l=[s,i,"str"];if(r.cellFormula){e.l+=2;var c=e0(e,a-e.l,r);l[3]=Ar(c,null,s,r.supbooks,r)}else e.l=a;return l}var AS=Rs,PS=Ti;function DS(e,t){return t==null&&(t=ye(4)),t.write_shift(4,e),t}function IS(e,t){var r=e.l+t,a=Rs(e),s=uf(e),i=Mr(e),l=Mr(e),c=Mr(e);e.l=r;var o={rfx:a,relId:s,loc:i,display:c};return l&&(o.Tooltip=l),o}function MS(e,t){var r=ye(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Ti({s:Ht(e[0]),e:Ht(e[0])},r),ff("rId"+t,r);var a=e[1].Target.indexOf("#"),s=a==-1?"":e[1].Target.slice(a+1);return hr(s||"",r),hr(e[1].Tooltip||"",r),hr("",r),r.slice(0,r.l)}function RS(){}function OS(e,t,r){var a=e.l+t,s=ig(e),i=e.read_shift(1),l=[s];if(l[2]=i,r.cellFormula){var c=l_(e,a-e.l,r);l[1]=c}else e.l=a;return l}function LS(e,t,r){var a=e.l+t,s=Rs(e),i=[s];if(r.cellFormula){var l=o_(e,a-e.l,r);i[1]=l,e.l=a}else e.l=a;return i}function BS(e,t,r){r==null&&(r=ye(18));var a=t0(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(a.width||10)*256),r.write_shift(4,0);var s=0;return t.hidden&&(s|=1),typeof a.width=="number"&&(s|=2),t.level&&(s|=t.level<<8),r.write_shift(2,s),r}var dv=["left","right","top","bottom","header","footer"];function US(e){var t={};return dv.forEach(function(r){t[r]=Ir(e)}),t}function zS(e,t){return t==null&&(t=ye(6*8)),gs(e),dv.forEach(function(r){Ss(e[r],t)}),t}function WS(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function HS(e,t,r){r==null&&(r=ye(30));var a=924;return(((t||{}).Views||[])[0]||{}).RTL&&(a|=32),r.write_shift(2,a),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function $S(e){var t=ye(24);return t.write_shift(4,4),t.write_shift(4,1),Ti(e,t),t}function VS(e,t){return t==null&&(t=ye(16*4+2)),t.write_shift(2,e.password?yf(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function GS(){}function XS(){}function KS(e,t,r,a,s,i,l){if(!e)return e;var c=t||{};a||(a={"!id":{}});var o=c.dense?[]:{},u,d={s:{r:2e6,c:2e6},e:{r:0,c:0}},f=!1,x=!1,h,p,m,w,v,b,y,N,A,k=[];c.biff=12,c["!row"]=0;var _=0,j=!1,P=[],D={},K=c.supbooks||s.supbooks||[[]];if(K.sharedf=D,K.arrayf=P,K.SheetNames=s.SheetNames||s.Sheets.map(function(Z){return Z.name}),!c.supbooks&&(c.supbooks=K,s.Names))for(var E=0;E<s.Names.length;++E)K[0][E+1]=s.Names[E];var Y=[],B=[],te=!1;Ul[16]={n:"BrtShortReal",f:ov};var re;if(ka(e,function(z,ne,xe){if(!x)switch(xe){case 148:u=z;break;case 0:h=z,c.sheetRows&&c.sheetRows<=h.r&&(x=!0),N=Zt(w=h.r),c["!row"]=h.r,(z.hidden||z.hpt||z.level!=null)&&(z.hpt&&(z.hpx=Ni(z.hpt)),B[z.r]=z);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(p={t:z[2]},z[2]){case"n":p.v=z[1];break;case"s":y=il[z[1]],p.v=y.t,p.r=y.r;break;case"b":p.v=!!z[1];break;case"e":p.v=z[1],c.cellText!==!1&&(p.w=_a[p.v]);break;case"str":p.t="s",p.v=z[1];break;case"is":p.t="s",p.v=z[1].t;break}if((m=l.CellXf[z[0].iStyleRef])&&iv(p,m.numFmtId,null,c,i,l),v=z[0].c==-1?v+1:z[0].c,c.dense?(o[w]||(o[w]=[]),o[w][v]=p):o[Wt(v)+N]=p,c.cellFormula){for(j=!1,_=0;_<P.length;++_){var O=P[_];h.r>=O[0].s.r&&h.r<=O[0].e.r&&v>=O[0].s.c&&v<=O[0].e.c&&(p.F=et(O[0]),j=!0)}!j&&z.length>3&&(p.f=z[3])}if(d.s.r>h.r&&(d.s.r=h.r),d.s.c>v&&(d.s.c=v),d.e.r<h.r&&(d.e.r=h.r),d.e.c<v&&(d.e.c=v),c.cellDates&&m&&p.t=="n"&&Si(Xe[m.numFmtId])){var R=us(p.v);R&&(p.t="d",p.v=new Date(R.y,R.m-1,R.d,R.H,R.M,R.S,R.u))}re&&(re.type=="XLDAPR"&&(p.D=!0),re=void 0);break;case 1:case 12:if(!c.sheetStubs||f)break;p={t:"z",v:void 0},v=z[0].c==-1?v+1:z[0].c,c.dense?(o[w]||(o[w]=[]),o[w][v]=p):o[Wt(v)+N]=p,d.s.r>h.r&&(d.s.r=h.r),d.s.c>v&&(d.s.c=v),d.e.r<h.r&&(d.e.r=h.r),d.e.c<v&&(d.e.c=v),re&&(re.type=="XLDAPR"&&(p.D=!0),re=void 0);break;case 176:k.push(z);break;case 49:re=((c.xlmeta||{}).Cell||[])[z-1];break;case 494:var g=a["!id"][z.relId];for(g?(z.Target=g.Target,z.loc&&(z.Target+="#"+z.loc),z.Rel=g):z.relId==""&&(z.Target="#"+z.loc),w=z.rfx.s.r;w<=z.rfx.e.r;++w)for(v=z.rfx.s.c;v<=z.rfx.e.c;++v)c.dense?(o[w]||(o[w]=[]),o[w][v]||(o[w][v]={t:"z",v:void 0}),o[w][v].l=z):(b=Ke({c:v,r:w}),o[b]||(o[b]={t:"z",v:void 0}),o[b].l=z);break;case 426:if(!c.cellFormula)break;P.push(z),A=c.dense?o[w][v]:o[Wt(v)+N],A.f=Ar(z[1],d,{r:h.r,c:v},K,c),A.F=et(z[0]);break;case 427:if(!c.cellFormula)break;D[Ke(z[0].s)]=z[1],A=c.dense?o[w][v]:o[Wt(v)+N],A.f=Ar(z[1],d,{r:h.r,c:v},K,c);break;case 60:if(!c.cellStyles)break;for(;z.e>=z.s;)Y[z.e--]={width:z.w/256,hidden:!!(z.flags&1),level:z.level},te||(te=!0,bf(z.w/256)),qa(Y[z.e+1]);break;case 161:o["!autofilter"]={ref:et(z)};break;case 476:o["!margins"]=z;break;case 147:s.Sheets[r]||(s.Sheets[r]={}),z.name&&(s.Sheets[r].CodeName=z.name),(z.above||z.left)&&(o["!outline"]={above:z.above,left:z.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),z.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:f=!0;break;case 36:f=!1;break;case 37:f=!0;break;case 38:f=!1;break;default:if(!ne.T){if(!f||c.WTF)throw new Error("Unexpected record 0x"+xe.toString(16))}}},c),delete c.supbooks,delete c["!row"],!o["!ref"]&&(d.s.r<2e6||u&&(u.e.r>0||u.e.c>0||u.s.r>0||u.s.c>0))&&(o["!ref"]=et(u||d)),c.sheetRows&&o["!ref"]){var Q=mt(o["!ref"]);c.sheetRows<=+Q.e.r&&(Q.e.r=c.sheetRows-1,Q.e.r>d.e.r&&(Q.e.r=d.e.r),Q.e.r<Q.s.r&&(Q.s.r=Q.e.r),Q.e.c>d.e.c&&(Q.e.c=d.e.c),Q.e.c<Q.s.c&&(Q.s.c=Q.e.c),o["!fullref"]=o["!ref"],o["!ref"]=et(Q))}return k.length>0&&(o["!merges"]=k),Y.length>0&&(o["!cols"]=Y),B.length>0&&(o["!rows"]=B),o}function YS(e,t,r,a,s,i,l){if(t.v===void 0)return!1;var c="";switch(t.t){case"b":c=t.v?"1":"0";break;case"d":t=Mt(t),t.z=t.z||Xe[14],t.v=dr(It(t.v)),t.t="n";break;case"n":case"e":c=""+t.v;break;default:c=t.v;break}var o={r,c:a};switch(o.s=as(s.cellXfs,t,s),t.l&&i["!links"].push([Ke(o),t.l]),t.c&&i["!comments"].push([Ke(o),t.c]),t.t){case"s":case"str":return s.bookSST?(c=_f(s.Strings,t.v,s.revStrings),o.t="s",o.v=c,l?ke(e,18,mS(t,o)):ke(e,7,fS(t,o))):(o.t="str",l?ke(e,17,SS(t,o)):ke(e,6,kS(t,o))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?l?ke(e,13,wS(t,o)):ke(e,2,yS(t,o)):l?ke(e,16,gS(t,o)):ke(e,5,pS(t,o)),!0;case"b":return o.t="b",l?ke(e,15,iS(t,o)):ke(e,4,aS(t,o)),!0;case"e":return o.t="e",l?ke(e,14,dS(t,o)):ke(e,3,cS(t,o)),!0}return l?ke(e,12,rS(t,o)):ke(e,1,eS(t,o)),!0}function qS(e,t,r,a){var s=mt(t["!ref"]||"A1"),i,l="",c=[];ke(e,145);var o=Array.isArray(t),u=s.e.r;t["!rows"]&&(u=Math.max(s.e.r,t["!rows"].length-1));for(var d=s.s.r;d<=u;++d){l=Zt(d),X_(e,t,s,d);var f=!1;if(d<=s.e.r)for(var x=s.s.c;x<=s.e.c;++x){d===s.s.r&&(c[x]=Wt(x)),i=c[x]+l;var h=o?(t[d]||[])[x]:t[i];if(!h){f=!1;continue}f=YS(e,h,d,x,a,t,f)}}ke(e,146)}function JS(e,t){!t||!t["!merges"]||(ke(e,177,DS(t["!merges"].length)),t["!merges"].forEach(function(r){ke(e,176,PS(r))}),ke(e,178))}function QS(e,t){!t||!t["!cols"]||(ke(e,390),t["!cols"].forEach(function(r,a){r&&ke(e,60,BS(a,r))}),ke(e,391))}function ZS(e,t){!t||!t["!ref"]||(ke(e,648),ke(e,649,$S(mt(t["!ref"]))),ke(e,650))}function eC(e,t,r){t["!links"].forEach(function(a){if(a[1].Target){var s=bt(r,-1,a[1].Target.replace(/#.*$/,""),st.HLINK);ke(e,494,MS(a,s))}}),delete t["!links"]}function tC(e,t,r,a){if(t["!comments"].length>0){var s=bt(a,-1,"../drawings/vmlDrawing"+(r+1)+".vml",st.VML);ke(e,551,ff("rId"+s)),t["!legacy"]=s}}function rC(e,t,r,a){if(t["!autofilter"]){var s=t["!autofilter"],i=typeof s.ref=="string"?s.ref:et(s.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var l=r.Workbook.Names,c=nn(i);c.s.r==c.e.r&&(c.e.r=nn(t["!ref"]).e.r,i=et(c));for(var o=0;o<l.length;++o){var u=l[o];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==a){u.Ref="'"+r.SheetNames[a]+"'!"+i;break}}o==l.length&&l.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+r.SheetNames[a]+"'!"+i}),ke(e,161,Ti(mt(i))),ke(e,162)}}function nC(e,t,r){ke(e,133),ke(e,137,HS(t,r)),ke(e,138),ke(e,134)}function aC(e,t){t["!protect"]&&ke(e,535,VS(t["!protect"]))}function sC(e,t,r,a){var s=rn(),i=r.SheetNames[e],l=r.Sheets[i]||{},c=i;try{r&&r.Workbook&&(c=r.Workbook.Sheets[e].CodeName||c)}catch{}var o=mt(l["!ref"]||"A1");if(o.e.c>16383||o.e.r>1048575){if(t.WTF)throw new Error("Range "+(l["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");o.e.c=Math.min(o.e.c,16383),o.e.r=Math.min(o.e.c,1048575)}return l["!links"]=[],l["!comments"]=[],ke(s,129),(r.vbaraw||l["!outline"])&&ke(s,147,Q_(c,l["!outline"])),ke(s,148,Y_(o)),nC(s,l,r.Workbook),QS(s,l),qS(s,l,e,t),aC(s,l),rC(s,l,r,e),JS(s,l),eC(s,l,a),l["!margins"]&&ke(s,476,zS(l["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&ZS(s,l),tC(s,l,e,a),ke(s,130),s.end()}function iC(e){var t=[],r=e.match(/^<c:numCache>/),a;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(i){var l=i.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);l&&(t[+l[1]]=r?+l[2]:l[2])});var s=xt((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(i){a=i.replace(/<.*?>/g,"")}),[t,s,a]}function lC(e,t,r,a,s,i){var l=i||{"!type":"chart"};if(!e)return i;var c=0,o=0,u="A",d={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(f){var x=iC(f);d.s.r=d.s.c=0,d.e.c=c,u=Wt(c),x[0].forEach(function(h,p){l[u+Zt(p)]={t:"n",v:h,z:x[1]},o=p}),d.e.r<o&&(d.e.r=o),++c}),c>0&&(l["!ref"]=et(d)),l}function cC(e,t,r,a,s){if(!e)return e;a||(a={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},l,c=e.match(lv);return c&&Sf(c[0],i,s,r),(l=e.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=l[1]),a["!id"][i["!rel"]]&&(i["!drawel"]=a["!id"][i["!rel"]]),i}function oC(e,t){e.l+=10;var r=Mr(e);return{name:r}}function dC(e,t,r,a,s){if(!e)return e;a||(a={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},l=!1;return ka(e,function(o,u,d){switch(d){case 550:i["!rel"]=o;break;case 651:s.Sheets[r]||(s.Sheets[r]={}),o.name&&(s.Sheets[r].CodeName=o.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:break;case 38:break;default:if(!(u.T>0)){if(!(u.T<0)){if(!l||t.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}},t),a["!id"][i["!rel"]]&&(i["!drawel"]=a["!id"][i["!rel"]]),i}var Cf=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],uC=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],fC=[],xC=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Xm(e,t){for(var r=0;r!=e.length;++r)for(var a=e[r],s=0;s!=t.length;++s){var i=t[s];if(a[i[0]]==null)a[i[0]]=i[1];else switch(i[2]){case"bool":typeof a[i[0]]=="string"&&(a[i[0]]=Ft(a[i[0]]));break;case"int":typeof a[i[0]]=="string"&&(a[i[0]]=parseInt(a[i[0]],10));break}}}function Km(e,t){for(var r=0;r!=t.length;++r){var a=t[r];if(e[a[0]]==null)e[a[0]]=a[1];else switch(a[2]){case"bool":typeof e[a[0]]=="string"&&(e[a[0]]=Ft(e[a[0]]));break;case"int":typeof e[a[0]]=="string"&&(e[a[0]]=parseInt(e[a[0]],10));break}}}function uv(e){Km(e.WBProps,Cf),Km(e.CalcPr,xC),Xm(e.WBView,uC),Xm(e.Sheets,fC),ui.date1904=Ft(e.WBProps.date1904)}function mC(e){return!e.Workbook||!e.Workbook.WBProps?"false":Ft(e.Workbook.WBProps.date1904)?"true":"false"}var hC="][*?/\\".split("");function fv(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return hC.forEach(function(a){if(e.indexOf(a)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function pC(e,t,r){e.forEach(function(a,s){fv(a);for(var i=0;i<s;++i)if(a==e[i])throw new Error("Duplicate Sheet Name: "+a);if(r){var l=t&&t[s]&&t[s].CodeName||a;if(l.charCodeAt(0)==95&&l.length>22)throw new Error("Bad Code Name: Worksheet"+l)}})}function gC(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];pC(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)m_(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var vC=/<\w+:workbook/;function yC(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},a=!1,s="xmlns",i={},l=0;if(e.replace(Lr,function(o,u){var d=Ye(o);switch(sa(d[0])){case"<?xml":break;case"<workbook":o.match(vC)&&(s="xmlns"+o.match(/<(\w+):/)[1]),r.xmlns=d[s];break;case"</workbook>":break;case"<fileVersion":delete d[0],r.AppVersion=d;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Cf.forEach(function(f){if(d[f[0]]!=null)switch(f[2]){case"bool":r.WBProps[f[0]]=Ft(d[f[0]]);break;case"int":r.WBProps[f[0]]=parseInt(d[f[0]],10);break;default:r.WBProps[f[0]]=d[f[0]]}}),d.codeName&&(r.WBProps.CodeName=jt(d.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete d[0],r.WBView.push(d);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(d.state){case"hidden":d.Hidden=1;break;case"veryHidden":d.Hidden=2;break;default:d.Hidden=0}delete d.state,d.name=xt(jt(d.name)),delete d[0],r.Sheets.push(d);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":a=!0;break;case"</definedNames>":a=!1;break;case"<definedName":i={},i.Name=jt(d.name),d.comment&&(i.Comment=d.comment),d.localSheetId&&(i.Sheet=+d.localSheetId),Ft(d.hidden||"0")&&(i.Hidden=!0),l=u+o.length;break;case"</definedName>":i.Ref=xt(jt(e.slice(l,u))),r.Names.push(i);break;case"<definedName/>":break;case"<calcPr":delete d[0],r.CalcPr=d;break;case"<calcPr/>":delete d[0],r.CalcPr=d;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":a=!0;break;case"</AlternateContent>":a=!1;break;case"<revisionPtr":break;default:if(!a&&t.WTF)throw new Error("unrecognized "+d[0]+" in workbook")}return o}),Ps.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return uv(r),r}function xv(e){var t=[er];t[t.length]=Fe("workbook",null,{xmlns:Ps[0],"xmlns:r":cr.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,a={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(Cf.forEach(function(c){e.Workbook.WBProps[c[0]]!=null&&e.Workbook.WBProps[c[0]]!=c[1]&&(a[c[0]]=e.Workbook.WBProps[c[0]])}),e.Workbook.WBProps.CodeName&&(a.codeName=e.Workbook.WBProps.CodeName,delete a.CodeName)),t[t.length]=Fe("workbookPr",null,a);var s=e.Workbook&&e.Workbook.Sheets||[],i=0;if(s&&s[0]&&s[0].Hidden){for(t[t.length]="<bookViews>",i=0;i!=e.SheetNames.length&&!(!s[i]||!s[i].Hidden);++i);i==e.SheetNames.length&&(i=0),t[t.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",i=0;i!=e.SheetNames.length;++i){var l={name:wt(e.SheetNames[i].slice(0,31))};if(l.sheetId=""+(i+1),l["r:id"]="rId"+(i+1),s[i])switch(s[i].Hidden){case 1:l.state="hidden";break;case 2:l.state="veryHidden";break}t[t.length]=Fe("sheet",null,l)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(c){var o={name:c.Name};c.Comment&&(o.comment=c.Comment),c.Sheet!=null&&(o.localSheetId=""+c.Sheet),c.Hidden&&(o.hidden="1"),c.Ref&&(t[t.length]=Fe("definedName",wt(c.Ref),o))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function bC(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Bd(e),r.name=Mr(e),r}function wC(e,t){return t||(t=ye(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),ff(e.strRelID,t),hr(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function NC(e,t){var r={},a=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var s=t>8?Mr(e):"";return s.length>0&&(r.CodeName=s),r.autoCompressPictures=!!(a&65536),r.backupFile=!!(a&64),r.checkCompatibility=!!(a&4096),r.date1904=!!(a&1),r.filterPrivacy=!!(a&8),r.hidePivotFieldList=!!(a&1024),r.promptedSolutions=!!(a&16),r.publishItems=!!(a&2048),r.refreshAllConnections=!!(a&262144),r.saveExternalLinkValues=!!(a&128),r.showBorderUnselectedTables=!!(a&4),r.showInkAnnotation=!!(a&32),r.showObjects=["all","placeholders","none"][a>>13&3],r.showPivotChartFilter=!!(a&32768),r.updateLinks=["userSet","never","always"][a>>8&3],r}function jC(e,t){t||(t=ye(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),ag(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function kC(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function _C(e,t,r){var a=e.l+t;e.l+=4,e.l+=1;var s=e.read_shift(4),i=tN(e),l=c_(e,0,r),c=uf(e);e.l=a;var o={Name:i,Ptg:l};return s<268435455&&(o.Sheet=s),c&&(o.Comment=c),o}function SC(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},a=[],s=!1;t||(t={}),t.biff=12;var i=[],l=[[]];return l.SheetNames=[],l.XTI=[],Ul[16]={n:"BrtFRTArchID$",f:kC},ka(e,function(o,u,d){switch(d){case 156:l.SheetNames.push(o.name),r.Sheets.push(o);break;case 153:r.WBProps=o;break;case 39:o.Sheet!=null&&(t.SID=o.Sheet),o.Ref=Ar(o.Ptg,null,null,l,t),delete t.SID,delete o.Ptg,i.push(o);break;case 1036:break;case 357:case 358:case 355:case 667:l[0].length?l.push([d,o]):l[0]=[d,o],l[l.length-1].XTI=[];break;case 362:l.length===0&&(l[0]=[],l[0].XTI=[]),l[l.length-1].XTI=l[l.length-1].XTI.concat(o),l.XTI=l.XTI.concat(o);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:a.push(d),s=!0;break;case 36:a.pop(),s=!1;break;case 37:a.push(d),s=!0;break;case 38:a.pop(),s=!1;break;case 16:break;default:if(!u.T){if(!s||t.WTF&&a[a.length-1]!=37&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}},t),uv(r),r.Names=i,r.supbooks=l,r}function CC(e,t){ke(e,143);for(var r=0;r!=t.SheetNames.length;++r){var a=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,s={Hidden:a,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};ke(e,156,wC(s))}ke(e,144)}function EC(e,t){t||(t=ye(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return hr("SheetJS",t),hr(vo.version,t),hr(vo.version,t),hr("7262",t),t.length>t.l?t.slice(0,t.l):t}function TC(e,t){t||(t=ye(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function FC(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,a=0,s=-1,i=-1;a<r.length;++a)!r[a]||!r[a].Hidden&&s==-1?s=a:r[a].Hidden==1&&i==-1&&(i=a);i>s||(ke(e,135),ke(e,158,TC(s)),ke(e,136))}}function AC(e,t){var r=rn();return ke(r,131),ke(r,128,EC()),ke(r,153,jC(e.Workbook&&e.Workbook.WBProps||null)),FC(r,e),CC(r,e),ke(r,132),r.end()}function PC(e,t,r){return t.slice(-4)===".bin"?SC(e,r):yC(e,r)}function DC(e,t,r,a,s,i,l,c){return t.slice(-4)===".bin"?KS(e,a,r,s,i,l,c):__(e,a,r,s,i,l,c)}function IC(e,t,r,a,s,i,l,c){return t.slice(-4)===".bin"?dC(e,a,r,s,i):cC(e,a,r,s,i)}function MC(e,t,r,a,s,i,l,c){return t.slice(-4)===".bin"?O5():L5()}function RC(e,t,r,a,s,i,l,c){return t.slice(-4)===".bin"?M5():R5()}function OC(e,t,r,a){return t.slice(-4)===".bin"?Pk(e,r,a):bk(e,r,a)}function LC(e,t,r){return Xg(e,r)}function BC(e,t,r){return t.slice(-4)===".bin"?B4(e,r):R4(e,r)}function UC(e,t,r){return t.slice(-4)===".bin"?F5(e,r):w5(e,r)}function zC(e,t,r){return t.slice(-4)===".bin"?v5(e):p5(e)}function WC(e,t,r,a){return r.slice(-4)===".bin"?y5(e,t,r,a):void 0}function HC(e,t,r){return t.slice(-4)===".bin"?x5(e,t,r):h5(e,t,r)}function $C(e,t,r){return(t.slice(-4)===".bin"?AC:xv)(e)}function VC(e,t,r,a,s){return(t.slice(-4)===".bin"?sC:cv)(e,r,a,s)}function GC(e,t,r){return(t.slice(-4)===".bin"?Wk:Vg)(e,r)}function XC(e,t,r){return(t.slice(-4)===".bin"?W4:Og)(e,r)}function KC(e,t,r){return(t.slice(-4)===".bin"?A5:qg)(e)}function YC(e){return(e.slice(-4)===".bin"?m5:Kg)()}var mv=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,hv=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function On(e,t){var r=e.split(/\s+/),a=[];if(a[0]=r[0],r.length===1)return a;var s=e.match(mv),i,l,c,o;if(s)for(o=0;o!=s.length;++o)i=s[o].match(hv),(l=i[1].indexOf(":"))===-1?a[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?c="xmlns"+i[1].slice(6):c=i[1].slice(l+1),a[c]=i[2].slice(1,i[2].length-1));return a}function qC(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var a=e.match(mv),s,i,l,c;if(a)for(c=0;c!=a.length;++c)s=a[c].match(hv),(i=s[1].indexOf(":"))===-1?r[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?l="xmlns"+s[1].slice(6):l=s[1].slice(i+1),r[l]=s[2].slice(1,s[2].length-1));return r}var cl;function JC(e,t){var r=cl[e]||xt(e);return r==="General"?ks(t):Dn(r,t)}function QC(e,t,r,a){var s=a;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=Ft(a);break;case"i2":case"int":s=parseInt(a,10);break;case"r4":case"float":s=parseFloat(a);break;case"date":case"dateTime.tz":s=It(a);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[xt(t)]=s}function ZC(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||_a[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Al(e.v):e.w=ks(e.v):e.w=JC(t||"General",e.v)}catch(i){if(r.WTF)throw i}try{var a=cl[t]||t||"General";if(r.cellNF&&(e.z=a),r.cellDates&&e.t=="n"&&Si(a)){var s=us(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(i){if(r.WTF)throw i}}}function e6(e,t,r){if(r.cellStyles&&t.Interior){var a=t.Interior;a.Pattern&&(a.patternType=fk[a.Pattern]||a.Pattern)}e[t.ID]=t}function t6(e,t,r,a,s,i,l,c,o,u){var d="General",f=a.StyleID,x={};u=u||{};var h=[],p=0;for(f===void 0&&c&&(f=c.StyleID),f===void 0&&l&&(f=l.StyleID);i[f]!==void 0&&(i[f].nf&&(d=i[f].nf),i[f].Interior&&h.push(i[f].Interior),!!i[f].Parent);)f=i[f].Parent;switch(r.Type){case"Boolean":a.t="b",a.v=Ft(e);break;case"String":a.t="s",a.r=um(xt(e)),a.v=e.indexOf("<")>-1?xt(t||e).replace(/<.*?>/g,""):a.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),a.v=(It(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),a.v!==a.v?a.v=xt(e):a.v<60&&(a.v=a.v-1),(!d||d=="General")&&(d="yyyy-mm-dd");case"Number":a.v===void 0&&(a.v=+e),a.t||(a.t="n");break;case"Error":a.t="e",a.v=og[e],u.cellText!==!1&&(a.w=e);break;default:e==""&&t==""?a.t="z":(a.t="s",a.v=um(t||e));break}if(ZC(a,d,u),u.cellFormula!==!1)if(a.Formula){var m=xt(a.Formula);m.charCodeAt(0)==61&&(m=m.slice(1)),a.f=di(m,s),delete a.Formula,a.ArrayRange=="RC"?a.F=di("RC:RC",s):a.ArrayRange&&(a.F=di(a.ArrayRange,s),o.push([mt(a.F),a.F]))}else for(p=0;p<o.length;++p)s.r>=o[p][0].s.r&&s.r<=o[p][0].e.r&&s.c>=o[p][0].s.c&&s.c<=o[p][0].e.c&&(a.F=o[p][1]);u.cellStyles&&(h.forEach(function(w){!x.patternType&&w.patternType&&(x.patternType=w.patternType)}),a.s=x),a.StyleID!==void 0&&(a.ixfe=a.StyleID)}function r6(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function L0(e,t){var r=t||{};Ci();var a=$i(af(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(a=jt(a));var s=a.slice(0,1024).toLowerCase(),i=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var l=Mt(r);return l.type="string",wi.to_workbook(a,l)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(oe){s.indexOf("<"+oe)>=0&&(i=!0)}),i)return z6(a,r);cl={"General Number":"General","General Date":Xe[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Xe[15],"Short Date":Xe[14],"Long Time":Xe[19],"Medium Time":Xe[18],"Short Time":Xe[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Xe[2],Standard:Xe[4],Percent:Xe[10],Scientific:Xe[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var c,o=[],u,d={},f=[],x=r.dense?[]:{},h="",p={},m={},w=On('<Data ss:Type="String">'),v=0,b=0,y=0,N={s:{r:2e6,c:2e6},e:{r:0,c:0}},A={},k={},_="",j=0,P=[],D={},K={},E=0,Y=[],B=[],te={},re=[],Q,Z=!1,z=[],ne=[],xe={},O=0,R=0,g={Sheets:[],WBProps:{date1904:!1}},S={};Il.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"");for(var F="";c=Il.exec(a);)switch(c[3]=(F=c[3]).toLowerCase()){case"data":if(F=="data"){if(c[1]==="/"){if((u=o.pop())[0]!==c[3])throw new Error("Bad state: "+u.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&o.push([c[3],!0]);break}if(o[o.length-1][1])break;c[1]==="/"?t6(a.slice(v,c.index),_,w,o[o.length-1][0]=="comment"?te:p,{c:b,r:y},A,re[b],m,z,r):(_="",w=On(c[0]),v=c.index+c[0].length);break;case"cell":if(c[1]==="/")if(B.length>0&&(p.c=B),(!r.sheetRows||r.sheetRows>y)&&p.v!==void 0&&(r.dense?(x[y]||(x[y]=[]),x[y][b]=p):x[Wt(b)+Zt(y)]=p),p.HRef&&(p.l={Target:xt(p.HRef)},p.HRefScreenTip&&(p.l.Tooltip=p.HRefScreenTip),delete p.HRef,delete p.HRefScreenTip),(p.MergeAcross||p.MergeDown)&&(O=b+(parseInt(p.MergeAcross,10)|0),R=y+(parseInt(p.MergeDown,10)|0),P.push({s:{c:b,r:y},e:{c:O,r:R}})),!r.sheetStubs)p.MergeAcross?b=O+1:++b;else if(p.MergeAcross||p.MergeDown){for(var ae=b;ae<=O;++ae)for(var ue=y;ue<=R;++ue)(ae>b||ue>y)&&(r.dense?(x[ue]||(x[ue]=[]),x[ue][ae]={t:"z"}):x[Wt(ae)+Zt(ue)]={t:"z"});b=O+1}else++b;else p=qC(c[0]),p.Index&&(b=+p.Index-1),b<N.s.c&&(N.s.c=b),b>N.e.c&&(N.e.c=b),c[0].slice(-2)==="/>"&&++b,B=[];break;case"row":c[1]==="/"||c[0].slice(-2)==="/>"?(y<N.s.r&&(N.s.r=y),y>N.e.r&&(N.e.r=y),c[0].slice(-2)==="/>"&&(m=On(c[0]),m.Index&&(y=+m.Index-1)),b=0,++y):(m=On(c[0]),m.Index&&(y=+m.Index-1),xe={},(m.AutoFitHeight=="0"||m.Height)&&(xe.hpx=parseInt(m.Height,10),xe.hpt=Bl(xe.hpx),ne[y]=xe),m.Hidden=="1"&&(xe.hidden=!0,ne[y]=xe));break;case"worksheet":if(c[1]==="/"){if((u=o.pop())[0]!==c[3])throw new Error("Bad state: "+u.join("|"));f.push(h),N.s.r<=N.e.r&&N.s.c<=N.e.c&&(x["!ref"]=et(N),r.sheetRows&&r.sheetRows<=N.e.r&&(x["!fullref"]=x["!ref"],N.e.r=r.sheetRows-1,x["!ref"]=et(N))),P.length&&(x["!merges"]=P),re.length>0&&(x["!cols"]=re),ne.length>0&&(x["!rows"]=ne),d[h]=x}else N={s:{r:2e6,c:2e6},e:{r:0,c:0}},y=b=0,o.push([c[3],!1]),u=On(c[0]),h=xt(u.Name),x=r.dense?[]:{},P=[],z=[],ne=[],S={name:h,Hidden:0},g.Sheets.push(S);break;case"table":if(c[1]==="/"){if((u=o.pop())[0]!==c[3])throw new Error("Bad state: "+u.join("|"))}else{if(c[0].slice(-2)=="/>")break;o.push([c[3],!1]),re=[],Z=!1}break;case"style":c[1]==="/"?e6(A,k,r):k=On(c[0]);break;case"numberformat":k.nf=xt(On(c[0]).Format||"General"),cl[k.nf]&&(k.nf=cl[k.nf]);for(var ve=0;ve!=392&&Xe[ve]!=k.nf;++ve);if(ve==392){for(ve=57;ve!=392;++ve)if(Xe[ve]==null){ha(k.nf,ve);break}}break;case"column":if(o[o.length-1][0]!=="table")break;if(Q=On(c[0]),Q.Hidden&&(Q.hidden=!0,delete Q.Hidden),Q.Width&&(Q.wpx=parseInt(Q.Width,10)),!Z&&Q.wpx>10){Z=!0,Dr=Hg;for(var me=0;me<re.length;++me)re[me]&&qa(re[me])}Z&&qa(Q),re[Q.Index-1||re.length]=Q;for(var H=0;H<+Q.Span;++H)re[re.length]=Mt(Q);break;case"namedrange":if(c[1]==="/")break;g.Names||(g.Names=[]);var T=Ye(c[0]),je={Name:T.Name,Ref:di(T.RefersTo.slice(1),{r:0,c:0})};g.Sheets.length>0&&(je.Sheet=g.Sheets.length-1),g.Names.push(je);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(c[0].slice(-2)==="/>")break;c[1]==="/"?_+=a.slice(j,c.index):j=c.index+c[0].length;break;case"interior":if(!r.cellStyles)break;k.Interior=On(c[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(c[0].slice(-2)==="/>")break;c[1]==="/"?SN(D,F,a.slice(E,c.index)):E=c.index+c[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(c[1]==="/"){if((u=o.pop())[0]!==c[3])throw new Error("Bad state: "+u.join("|"))}else o.push([c[3],!1]);break;case"comment":if(c[1]==="/"){if((u=o.pop())[0]!==c[3])throw new Error("Bad state: "+u.join("|"));r6(te),B.push(te)}else o.push([c[3],!1]),u=On(c[0]),te={a:u.Author};break;case"autofilter":if(c[1]==="/"){if((u=o.pop())[0]!==c[3])throw new Error("Bad state: "+u.join("|"))}else if(c[0].charAt(c[0].length-2)!=="/"){var pe=On(c[0]);x["!autofilter"]={ref:di(pe.Range).replace(/\$/g,"")},o.push([c[3],!0])}break;case"name":break;case"datavalidation":if(c[1]==="/"){if((u=o.pop())[0]!==c[3])throw new Error("Bad state: "+u.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&o.push([c[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(c[1]==="/"){if((u=o.pop())[0]!==c[3])throw new Error("Bad state: "+u.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&o.push([c[3],!0]);break;case"null":break;default:if(o.length==0&&c[3]=="document"||o.length==0&&c[3]=="uof")return Zm(a,r);var Le=!0;switch(o[o.length-1][0]){case"officedocumentsettings":switch(c[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Le=!1}break;case"componentoptions":switch(c[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Le=!1}break;case"excelworkbook":switch(c[3]){case"date1904":g.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Le=!1}break;case"workbookoptions":switch(c[3]){case"owcversion":break;case"height":break;case"width":break;default:Le=!1}break;case"worksheetoptions":switch(c[3]){case"visible":if(c[0].slice(-2)!=="/>")if(c[1]==="/")switch(a.slice(E,c.index)){case"SheetHidden":S.Hidden=1;break;case"SheetVeryHidden":S.Hidden=2;break}else E=c.index+c[0].length;break;case"header":x["!margins"]||gs(x["!margins"]={},"xlml"),isNaN(+Ye(c[0]).Margin)||(x["!margins"].header=+Ye(c[0]).Margin);break;case"footer":x["!margins"]||gs(x["!margins"]={},"xlml"),isNaN(+Ye(c[0]).Margin)||(x["!margins"].footer=+Ye(c[0]).Margin);break;case"pagemargins":var Se=Ye(c[0]);x["!margins"]||gs(x["!margins"]={},"xlml"),isNaN(+Se.Top)||(x["!margins"].top=+Se.Top),isNaN(+Se.Left)||(x["!margins"].left=+Se.Left),isNaN(+Se.Right)||(x["!margins"].right=+Se.Right),isNaN(+Se.Bottom)||(x["!margins"].bottom=+Se.Bottom);break;case"displayrighttoleft":g.Views||(g.Views=[]),g.Views[0]||(g.Views[0]={}),g.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":x["!outline"]||(x["!outline"]={}),x["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":x["!outline"]||(x["!outline"]={}),x["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Le=!1}break;case"pivottable":case"pivotcache":switch(c[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Le=!1}break;case"pagebreaks":switch(c[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Le=!1}break;case"autofilter":switch(c[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Le=!1}break;case"querytable":switch(c[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Le=!1}break;case"datavalidation":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Le=!1}break;case"sorting":case"conditionalformatting":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Le=!1}break;case"mapinfo":case"schema":case"data":switch(c[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Le=!1}break;case"smarttags":break;default:Le=!1;break}if(Le||c[3].match(/!\[CDATA/))break;if(!o[o.length-1][1])throw"Unrecognized tag: "+c[3]+"|"+o.join("|");if(o[o.length-1][0]==="customdocumentproperties"){if(c[0].slice(-2)==="/>")break;c[1]==="/"?QC(K,F,Y,a.slice(E,c.index)):(Y=c,E=c.index+c[0].length);break}if(r.WTF)throw"Unrecognized tag: "+c[3]+"|"+o.join("|")}var he={};return!r.bookSheets&&!r.bookProps&&(he.Sheets=d),he.SheetNames=f,he.Workbook=g,he.SSF=Mt(Xe),he.Props=D,he.Custprops=K,he}function Gd(e,t){switch(Tf(t=t||{}),t.type||"base64"){case"base64":return L0(gn(e),t);case"binary":case"buffer":case"file":return L0(e,t);case"array":return L0(rs(e),t)}}function n6(e,t){var r=[];return e.Props&&r.push(CN(e.Props,t)),e.Custprops&&r.push(EN(e.Props,e.Custprops)),r.join("")}function a6(){return""}function s6(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(a,s){var i=[];i.push(Fe("NumberFormat",null,{"ss:Format":wt(Xe[a.numFmtId])}));var l={"ss:ID":"s"+(21+s)};r.push(Fe("Style",i.join(""),l))}),Fe("Styles",r.join(""))}function pv(e){return Fe("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+jf(e.Ref,{r:0,c:0})})}function i6(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],a=0;a<t.length;++a){var s=t[a];s.Sheet==null&&(s.Name.match(/^_xlfn\./)||r.push(pv(s)))}return Fe("Names",r.join(""))}function l6(e,t,r,a){if(!e||!((a||{}).Workbook||{}).Names)return"";for(var s=a.Workbook.Names,i=[],l=0;l<s.length;++l){var c=s[l];c.Sheet==r&&(c.Name.match(/^_xlfn\./)||i.push(pv(c)))}return i.join("")}function c6(e,t,r,a){if(!e)return"";var s=[];if(e["!margins"]&&(s.push("<PageSetup>"),e["!margins"].header&&s.push(Fe("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&s.push(Fe("Footer",null,{"x:Margin":e["!margins"].footer})),s.push(Fe("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),s.push("</PageSetup>")),a&&a.Workbook&&a.Workbook.Sheets&&a.Workbook.Sheets[r])if(a.Workbook.Sheets[r].Hidden)s.push(Fe("Visible",a.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<r&&!(a.Workbook.Sheets[i]&&!a.Workbook.Sheets[i].Hidden);++i);i==r&&s.push("<Selected/>")}return((((a||{}).Workbook||{}).Views||[])[0]||{}).RTL&&s.push("<DisplayRightToLeft/>"),e["!protect"]&&(s.push(Nr("ProtectContents","True")),e["!protect"].objects&&s.push(Nr("ProtectObjects","True")),e["!protect"].scenarios&&s.push(Nr("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?s.push(Nr("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&s.push(Nr("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(l){e["!protect"][l[0]]&&s.push("<"+l[1]+"/>")})),s.length==0?"":Fe("WorksheetOptions",s.join(""),{xmlns:dn.x})}function o6(e){return e.map(function(t){var r=Fw(t.t||""),a=Fe("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Fe("Comment",a,{"ss:Author":t.a})}).join("")}function d6(e,t,r,a,s,i,l){if(!e||e.v==null&&e.f==null)return"";var c={};if(e.f&&(c["ss:Formula"]="="+wt(jf(e.f,l))),e.F&&e.F.slice(0,t.length)==t){var o=Ht(e.F.slice(t.length+1));c["ss:ArrayRange"]="RC:R"+(o.r==l.r?"":"["+(o.r-l.r)+"]")+"C"+(o.c==l.c?"":"["+(o.c-l.c)+"]")}if(e.l&&e.l.Target&&(c["ss:HRef"]=wt(e.l.Target),e.l.Tooltip&&(c["x:HRefScreenTip"]=wt(e.l.Tooltip))),r["!merges"])for(var u=r["!merges"],d=0;d!=u.length;++d)u[d].s.c!=l.c||u[d].s.r!=l.r||(u[d].e.c>u[d].s.c&&(c["ss:MergeAcross"]=u[d].e.c-u[d].s.c),u[d].e.r>u[d].s.r&&(c["ss:MergeDown"]=u[d].e.r-u[d].s.r));var f="",x="";switch(e.t){case"z":if(!a.sheetStubs)return"";break;case"n":f="Number",x=String(e.v);break;case"b":f="Boolean",x=e.v?"1":"0";break;case"e":f="Error",x=_a[e.v];break;case"d":f="DateTime",x=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||Xe[14]);break;case"s":f="String",x=Tw(e.v||"");break}var h=as(a.cellXfs,e,a);c["ss:StyleID"]="s"+(21+h),c["ss:Index"]=l.c+1;var p=e.v!=null?x:"",m=e.t=="z"?"":'<Data ss:Type="'+f+'">'+p+"</Data>";return(e.c||[]).length>0&&(m+=o6(e.c)),Fe("Cell",m,c)}function u6(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=Ni(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function f6(e,t,r,a){if(!e["!ref"])return"";var s=mt(e["!ref"]),i=e["!merges"]||[],l=0,c=[];e["!cols"]&&e["!cols"].forEach(function(w,v){qa(w);var b=!!w.width,y=t0(v,w),N={"ss:Index":v+1};b&&(N["ss:Width"]=Ol(y.width)),w.hidden&&(N["ss:Hidden"]="1"),c.push(Fe("Column",null,N))});for(var o=Array.isArray(e),u=s.s.r;u<=s.e.r;++u){for(var d=[u6(u,(e["!rows"]||[])[u])],f=s.s.c;f<=s.e.c;++f){var x=!1;for(l=0;l!=i.length;++l)if(!(i[l].s.c>f)&&!(i[l].s.r>u)&&!(i[l].e.c<f)&&!(i[l].e.r<u)){(i[l].s.c!=f||i[l].s.r!=u)&&(x=!0);break}if(!x){var h={r:u,c:f},p=Ke(h),m=o?(e[u]||[])[f]:e[p];d.push(d6(m,p,e,t,r,a,h))}}d.push("</Row>"),d.length>2&&c.push(d.join(""))}return c.join("")}function x6(e,t,r){var a=[],s=r.SheetNames[e],i=r.Sheets[s],l=i?l6(i,t,e,r):"";return l.length>0&&a.push("<Names>"+l+"</Names>"),l=i?f6(i,t,e,r):"",l.length>0&&a.push("<Table>"+l+"</Table>"),a.push(c6(i,t,e,r)),a.join("")}function m6(e,t){t||(t={}),e.SSF||(e.SSF=Mt(Xe)),e.SSF&&(Ci(),Ko(e.SSF),t.revssf=qo(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],as(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(n6(e,t)),r.push(a6()),r.push(""),r.push("");for(var a=0;a<e.SheetNames.length;++a)r.push(Fe("Worksheet",x6(a,t,e),{"ss:Name":wt(e.SheetNames[a])}));return r[2]=s6(e,t),r[3]=i6(e),er+Fe("Workbook",r.join(""),{xmlns:dn.ss,"xmlns:o":dn.o,"xmlns:x":dn.x,"xmlns:ss":dn.ss,"xmlns:dt":dn.dt,"xmlns:html":dn.html})}function h6(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=iN(r),r.length-r.l<=4)return t;var a=r.read_shift(4);if(a==0||a>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(a=r.read_shift(4),a!==1907505652)||(t.UnicodeClipboardFormat=lN(r),a=r.read_shift(4),a==0||a>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var p6=[60,1084,2066,2165,2175];function g6(e,t,r,a,s){var i=a,l=[],c=r.slice(r.l,r.l+i);if(s&&s.enc&&s.enc.insitu&&c.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(c)}l.push(c),r.l+=i;for(var o=fa(r,r.l),u=Xd[o],d=0;u!=null&&p6.indexOf(o)>-1;)i=fa(r,r.l+2),d=r.l+4,o==2066?d+=4:(o==2165||o==2175)&&(d+=12),c=r.slice(d,r.l+4+i),l.push(c),r.l+=4+i,u=Xd[o=fa(r,r.l)];var f=mr(l);wr(f,0);var x=0;f.lens=[];for(var h=0;h<l.length;++h)f.lens.push(x),x+=l[h].length;if(f.length<a)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+f.length+" < "+a;return t.f(f,f.length,s)}function qn(e,t,r){if(e.t!=="z"&&e.XF){var a=0;try{a=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=Xe[a])}catch(i){if(t.WTF)throw i}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||_a[e.v]:a===0||a=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Al(e.v):e.w=ks(e.v):e.w=Dn(a,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(i){if(t.WTF)throw i}if(t.cellDates&&a&&e.t=="n"&&Si(Xe[a]||String(a))){var s=us(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function Tc(e,t,r){return{v:e,ixfe:t,t:r}}function v6(e,t){var r={opts:{}},a={},s=t.dense?[]:{},i={},l={},c=null,o=[],u="",d={},f,x="",h,p,m,w,v={},b=[],y,N,A=[],k=[],_={Sheets:[],WBProps:{date1904:!1},Views:[{}]},j={},P=function(Ge){return Ge<8?ms[Ge]:Ge<64&&k[Ge-8]||ms[Ge]},D=function(Ge,dt,rt){var ot=dt.XF.data;if(!(!ot||!ot.patternType||!rt||!rt.cellStyles)){dt.s={},dt.s.patternType=ot.patternType;var ir;(ir=Rl(P(ot.icvFore)))&&(dt.s.fgColor={rgb:ir}),(ir=Rl(P(ot.icvBack)))&&(dt.s.bgColor={rgb:ir})}},K=function(Ge,dt,rt){if(!(xe>1)&&!(rt.sheetRows&&Ge.r>=rt.sheetRows)){if(rt.cellStyles&&dt.XF&&dt.XF.data&&D(Ge,dt,rt),delete dt.ixfe,delete dt.XF,f=Ge,x=Ke(Ge),(!l||!l.s||!l.e)&&(l={s:{r:0,c:0},e:{r:0,c:0}}),Ge.r<l.s.r&&(l.s.r=Ge.r),Ge.c<l.s.c&&(l.s.c=Ge.c),Ge.r+1>l.e.r&&(l.e.r=Ge.r+1),Ge.c+1>l.e.c&&(l.e.c=Ge.c+1),rt.cellFormula&&dt.f){for(var ot=0;ot<b.length;++ot)if(!(b[ot][0].s.c>Ge.c||b[ot][0].s.r>Ge.r)&&!(b[ot][0].e.c<Ge.c||b[ot][0].e.r<Ge.r)){dt.F=et(b[ot][0]),(b[ot][0].s.c!=Ge.c||b[ot][0].s.r!=Ge.r)&&delete dt.f,dt.f&&(dt.f=""+Ar(b[ot][1],l,Ge,z,E));break}}rt.dense?(s[Ge.r]||(s[Ge.r]=[]),s[Ge.r][Ge.c]=dt):s[x]=dt}},E={enc:!1,sbcch:0,snames:[],sharedf:v,arrayf:b,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(E.password=t.password);var Y,B=[],te=[],re=[],Q=[],Z=!1,z=[];z.SheetNames=E.snames,z.sharedf=E.sharedf,z.arrayf=E.arrayf,z.names=[],z.XTI=[];var ne=0,xe=0,O=0,R=[],g=[],S;E.codepage=1200,zn(1200);for(var F=!1;e.l<e.length-1;){var ae=e.l,ue=e.read_shift(2);if(ue===0&&ne===10)break;var ve=e.l===e.length?0:e.read_shift(2),me=Xd[ue];if(me&&me.f){if(t.bookSheets&&ne===133&&ue!==133)break;if(ne=ue,me.r===2||me.r==12){var H=e.read_shift(2);if(ve-=2,!E.enc&&H!==ue&&((H&255)<<8|H>>8)!==ue)throw new Error("rt mismatch: "+H+"!="+ue);me.r==12&&(e.l+=10,ve-=10)}var T={};if(ue===10?T=me.f(e,ve,E):T=g6(ue,me,e,ve,E),xe==0&&[9,521,1033,2057].indexOf(ne)===-1)continue;switch(ue){case 34:r.opts.Date1904=_.WBProps.date1904=T;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(E.enc||(e.l=0),E.enc=T,!t.password)throw new Error("File is password-protected");if(T.valid==null)throw new Error("Encryption scheme unsupported");if(!T.valid)throw new Error("Password is incorrect");break;case 92:E.lastuser=T;break;case 66:var je=Number(T);switch(je){case 21010:je=1200;break;case 32768:je=1e4;break;case 32769:je=1252;break}zn(E.codepage=je),F=!0;break;case 317:E.rrtabid=T;break;case 25:E.winlocked=T;break;case 439:r.opts.RefreshAll=T;break;case 12:r.opts.CalcCount=T;break;case 16:r.opts.CalcDelta=T;break;case 17:r.opts.CalcIter=T;break;case 13:r.opts.CalcMode=T;break;case 14:r.opts.CalcPrecision=T;break;case 95:r.opts.CalcSaveRecalc=T;break;case 15:E.CalcRefMode=T;break;case 2211:r.opts.FullCalc=T;break;case 129:T.fDialog&&(s["!type"]="dialog"),T.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),T.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:A.push(T);break;case 430:z.push([T]),z[z.length-1].XTI=[];break;case 35:case 547:z[z.length-1].push(T);break;case 24:case 536:S={Name:T.Name,Ref:Ar(T.rgce,l,null,z,E)},T.itab>0&&(S.Sheet=T.itab-1),z.names.push(S),z[0]||(z[0]=[],z[0].XTI=[]),z[z.length-1].push(T),T.Name=="_xlnm._FilterDatabase"&&T.itab>0&&T.rgce&&T.rgce[0]&&T.rgce[0][0]&&T.rgce[0][0][0]=="PtgArea3d"&&(g[T.itab-1]={ref:et(T.rgce[0][0][1][2])});break;case 22:E.ExternCount=T;break;case 23:z.length==0&&(z[0]=[],z[0].XTI=[]),z[z.length-1].XTI=z[z.length-1].XTI.concat(T),z.XTI=z.XTI.concat(T);break;case 2196:if(E.biff<8)break;S!=null&&(S.Comment=T[1]);break;case 18:s["!protect"]=T;break;case 19:T!==0&&E.WTF&&console.error("Password verifier: "+T);break;case 133:i[T.pos]=T,E.snames.push(T.name);break;case 10:{if(--xe)break;if(l.e){if(l.e.r>0&&l.e.c>0){if(l.e.r--,l.e.c--,s["!ref"]=et(l),t.sheetRows&&t.sheetRows<=l.e.r){var pe=l.e.r;l.e.r=t.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=et(l),l.e.r=pe}l.e.r++,l.e.c++}B.length>0&&(s["!merges"]=B),te.length>0&&(s["!objects"]=te),re.length>0&&(s["!cols"]=re),Q.length>0&&(s["!rows"]=Q),_.Sheets.push(j)}u===""?d=s:a[u]=s,s=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(E.biff===8&&(E.biff={9:2,521:3,1033:4}[ue]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[T.BIFFVer]||8),E.biffguess=T.BIFFVer==0,T.BIFFVer==0&&T.dt==4096&&(E.biff=5,F=!0,zn(E.codepage=28591)),E.biff==8&&T.BIFFVer==0&&T.dt==16&&(E.biff=2),xe++)break;if(s=t.dense?[]:{},E.biff<8&&!F&&(F=!0,zn(E.codepage=t.codepage||1252)),E.biff<5||T.BIFFVer==0&&T.dt==4096){u===""&&(u="Sheet1"),l={s:{r:0,c:0},e:{r:0,c:0}};var Le={pos:e.l-ve,name:u};i[Le.pos]=Le,E.snames.push(u)}else u=(i[ae]||{name:""}).name;T.dt==32&&(s["!type"]="chart"),T.dt==64&&(s["!type"]="macro"),B=[],te=[],E.arrayf=b=[],re=[],Q=[],Z=!1,j={Hidden:(i[ae]||{hs:0}).hs,name:u}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(t.dense?(s[T.r]||[])[T.c]:s[Ke({c:T.c,r:T.r})])&&++T.c,y={ixfe:T.ixfe,XF:A[T.ixfe]||{},v:T.val,t:"n"},O>0&&(y.z=R[y.ixfe>>8&63]),qn(y,t,r.opts.Date1904),K({c:T.c,r:T.r},y,t);break;case 5:case 517:y={ixfe:T.ixfe,XF:A[T.ixfe],v:T.val,t:T.t},O>0&&(y.z=R[y.ixfe>>8&63]),qn(y,t,r.opts.Date1904),K({c:T.c,r:T.r},y,t);break;case 638:y={ixfe:T.ixfe,XF:A[T.ixfe],v:T.rknum,t:"n"},O>0&&(y.z=R[y.ixfe>>8&63]),qn(y,t,r.opts.Date1904),K({c:T.c,r:T.r},y,t);break;case 189:for(var Se=T.c;Se<=T.C;++Se){var he=T.rkrec[Se-T.c][0];y={ixfe:he,XF:A[he],v:T.rkrec[Se-T.c][1],t:"n"},O>0&&(y.z=R[y.ixfe>>8&63]),qn(y,t,r.opts.Date1904),K({c:Se,r:T.r},y,t)}break;case 6:case 518:case 1030:{if(T.val=="String"){c=T;break}if(y=Tc(T.val,T.cell.ixfe,T.tt),y.XF=A[y.ixfe],t.cellFormula){var oe=T.formula;if(oe&&oe[0]&&oe[0][0]&&oe[0][0][0]=="PtgExp"){var De=oe[0][0][1][0],Me=oe[0][0][1][1],Ie=Ke({r:De,c:Me});v[Ie]?y.f=""+Ar(T.formula,l,T.cell,z,E):y.F=((t.dense?(s[De]||[])[Me]:s[Ie])||{}).F}else y.f=""+Ar(T.formula,l,T.cell,z,E)}O>0&&(y.z=R[y.ixfe>>8&63]),qn(y,t,r.opts.Date1904),K(T.cell,y,t),c=T}break;case 7:case 519:if(c)c.val=T,y=Tc(T,c.cell.ixfe,"s"),y.XF=A[y.ixfe],t.cellFormula&&(y.f=""+Ar(c.formula,l,c.cell,z,E)),O>0&&(y.z=R[y.ixfe>>8&63]),qn(y,t,r.opts.Date1904),K(c.cell,y,t),c=null;else throw new Error("String record expects Formula");break;case 33:case 545:{b.push(T);var Oe=Ke(T[0].s);if(h=t.dense?(s[T[0].s.r]||[])[T[0].s.c]:s[Oe],t.cellFormula&&h){if(!c||!Oe||!h)break;h.f=""+Ar(T[1],l,T[0],z,E),h.F=et(T[0])}}break;case 1212:{if(!t.cellFormula)break;if(x){if(!c)break;v[Ke(c.cell)]=T[0],h=t.dense?(s[c.cell.r]||[])[c.cell.c]:s[Ke(c.cell)],(h||{}).f=""+Ar(T[0],l,f,z,E)}}break;case 253:y=Tc(o[T.isst].t,T.ixfe,"s"),o[T.isst].h&&(y.h=o[T.isst].h),y.XF=A[y.ixfe],O>0&&(y.z=R[y.ixfe>>8&63]),qn(y,t,r.opts.Date1904),K({c:T.c,r:T.r},y,t);break;case 513:t.sheetStubs&&(y={ixfe:T.ixfe,XF:A[T.ixfe],t:"z"},O>0&&(y.z=R[y.ixfe>>8&63]),qn(y,t,r.opts.Date1904),K({c:T.c,r:T.r},y,t));break;case 190:if(t.sheetStubs)for(var He=T.c;He<=T.C;++He){var Ze=T.ixfe[He-T.c];y={ixfe:Ze,XF:A[Ze],t:"z"},O>0&&(y.z=R[y.ixfe>>8&63]),qn(y,t,r.opts.Date1904),K({c:He,r:T.r},y,t)}break;case 214:case 516:case 4:y=Tc(T.val,T.ixfe,"s"),y.XF=A[y.ixfe],O>0&&(y.z=R[y.ixfe>>8&63]),qn(y,t,r.opts.Date1904),K({c:T.c,r:T.r},y,t);break;case 0:case 512:xe===1&&(l=T);break;case 252:o=T;break;case 1054:if(E.biff==4){R[O++]=T[1];for(var pt=0;pt<O+163&&Xe[pt]!=T[1];++pt);pt>=163&&ha(T[1],O+163)}else ha(T[1],T[0]);break;case 30:{R[O++]=T;for(var Bt=0;Bt<O+163&&Xe[Bt]!=T;++Bt);Bt>=163&&ha(T,O+163)}break;case 229:B=B.concat(T);break;case 93:te[T.cmo[0]]=E.lastobj=T;break;case 438:E.lastobj.TxO=T;break;case 127:E.lastobj.ImData=T;break;case 440:for(w=T[0].s.r;w<=T[0].e.r;++w)for(m=T[0].s.c;m<=T[0].e.c;++m)h=t.dense?(s[w]||[])[m]:s[Ke({c:m,r:w})],h&&(h.l=T[1]);break;case 2048:for(w=T[0].s.r;w<=T[0].e.r;++w)for(m=T[0].s.c;m<=T[0].e.c;++m)h=t.dense?(s[w]||[])[m]:s[Ke({c:m,r:w})],h&&h.l&&(h.l.Tooltip=T[1]);break;case 28:{if(E.biff<=5&&E.biff>=2)break;h=t.dense?(s[T[0].r]||[])[T[0].c]:s[Ke(T[0])];var nt=te[T[2]];h||(t.dense?(s[T[0].r]||(s[T[0].r]=[]),h=s[T[0].r][T[0].c]={t:"z"}):h=s[Ke(T[0])]={t:"z"},l.e.r=Math.max(l.e.r,T[0].r),l.s.r=Math.min(l.s.r,T[0].r),l.e.c=Math.max(l.e.c,T[0].c),l.s.c=Math.min(l.s.c,T[0].c)),h.c||(h.c=[]),p={a:T[1],t:nt.TxO.t},h.c.push(p)}break;case 2173:s5(A[T.ixfe],T.ext);break;case 125:{if(!E.cellStyles)break;for(;T.e>=T.s;)re[T.e--]={width:T.w/256,level:T.level||0,hidden:!!(T.flags&1)},Z||(Z=!0,bf(T.w/256)),qa(re[T.e+1])}break;case 520:{var gt={};T.level!=null&&(Q[T.r]=gt,gt.level=T.level),T.hidden&&(Q[T.r]=gt,gt.hidden=!0),T.hpt&&(Q[T.r]=gt,gt.hpt=T.hpt,gt.hpx=Ni(T.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||gs(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ue]]=T;break;case 161:s["!margins"]||gs(s["!margins"]={}),s["!margins"].header=T.header,s["!margins"].footer=T.footer;break;case 574:T.RTL&&(_.Views[0].RTL=!0);break;case 146:k=T;break;case 2198:Y=T;break;case 140:N=T;break;case 442:u?j.CodeName=T||j.name:_.WBProps.CodeName=T||"ThisWorkbook";break}}else me||console.error("Missing Info for XLS Record 0x"+ue.toString(16)),e.l+=ve}return r.SheetNames=Yt(i).sort(function(Ut,Ge){return Number(Ut)-Number(Ge)}).map(function(Ut){return i[Ut].name}),t.bookSheets||(r.Sheets=a),!r.SheetNames.length&&d["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=d)):r.Preamble=d,r.Sheets&&g.forEach(function(Ut,Ge){r.Sheets[r.SheetNames[Ge]]["!autofilter"]=Ut}),r.Strings=o,r.SSF=Mt(Xe),E.enc&&(r.Encryption=E.enc),Y&&(r.Themes=Y),r.Metadata={},N!==void 0&&(r.Metadata.Country=N),z.names.length>0&&(_.Names=z.names),r.Workbook=_,r}var ol={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function y6(e,t,r){var a=$e.find(e,"/!DocumentSummaryInformation");if(a&&a.size>0)try{var s=Tm(a,Ud,ol.DSI);for(var i in s)t[i]=s[i]}catch(u){if(r.WTF)throw u}var l=$e.find(e,"/!SummaryInformation");if(l&&l.size>0)try{var c=Tm(l,zd,ol.SI);for(var o in c)t[o]==null&&(t[o]=c[o])}catch(u){if(r.WTF)throw u}t.HeadingPairs&&t.TitlesOfParts&&(hg(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function b6(e,t){var r=[],a=[],s=[],i=0,l,c=sm(Ud,"n"),o=sm(zd,"n");if(e.Props)for(l=Yt(e.Props),i=0;i<l.length;++i)(Object.prototype.hasOwnProperty.call(c,l[i])?r:Object.prototype.hasOwnProperty.call(o,l[i])?a:s).push([l[i],e.Props[l[i]]]);if(e.Custprops)for(l=Yt(e.Custprops),i=0;i<l.length;++i)Object.prototype.hasOwnProperty.call(e.Props||{},l[i])||(Object.prototype.hasOwnProperty.call(c,l[i])?r:Object.prototype.hasOwnProperty.call(o,l[i])?a:s).push([l[i],e.Custprops[l[i]]]);var u=[];for(i=0;i<s.length;++i)Ng.indexOf(s[i][0])>-1||mg.indexOf(s[i][0])>-1||s[i][1]!=null&&u.push(s[i]);a.length&&$e.utils.cfb_add(t,"/SummaryInformation",Fm(a,ol.SI,o,zd)),(r.length||u.length)&&$e.utils.cfb_add(t,"/DocumentSummaryInformation",Fm(r,ol.DSI,c,Ud,u.length?u:null,ol.UDI))}function gv(e,t){t||(t={}),Tf(t),Yu(),t.codepage&&Ku(t.codepage);var r,a;if(e.FullPaths){if($e.find(e,"/encryption"))throw new Error("File is password-protected");r=$e.find(e,"!CompObj"),a=$e.find(e,"/Workbook")||$e.find(e,"/Book")}else{switch(t.type){case"base64":e=fn(gn(e));break;case"binary":e=fn(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}wr(e,0),a={content:e}}var s,i;if(r&&h6(r),t.bookProps&&!t.bookSheets)s={};else{var l=at?"buffer":"array";if(a&&a.content)s=v6(a.content,t);else if((i=$e.find(e,"PerfectOffice_MAIN"))&&i.content)s=ps.to_workbook(i.content,(t.type=l,t));else if((i=$e.find(e,"NativeContent_MAIN"))&&i.content)s=ps.to_workbook(i.content,(t.type=l,t));else throw(i=$e.find(e,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&$e.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=D5(e))}var c={};return e.FullPaths&&y6(e,c,t),s.Props=s.Custprops=c,t.bookFiles&&(s.cfb=e),s}function w6(e,t){var r=t||{},a=$e.utils.cfb_new({root:"R"}),s="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":s="/Workbook",r.biff=8;break;case"biff5":s="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return $e.utils.cfb_add(a,s,vv(e,r)),r.biff==8&&(e.Props||e.Custprops)&&b6(e,a),r.biff==8&&e.vbaraw&&I5(a,$e.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),a}var Ul={0:{f:V_},1:{f:Z_},2:{f:vS},3:{f:lS},4:{f:nS},5:{f:hS},6:{f:jS},7:{f:uS},8:{f:FS},9:{f:TS},10:{f:CS},11:{f:ES},12:{f:tS},13:{f:bS},14:{f:oS},15:{f:sS},16:{f:ov},17:{f:_S},18:{f:xS},19:{f:df},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:_C},40:{},42:{},43:{f:jk},44:{f:wk},45:{f:Sk},46:{f:Ek},47:{f:Ck},48:{},49:{f:Kw},50:{},51:{f:c5},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Dg},62:{f:NS},63:{f:g5},64:{f:GS},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Or,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:WS},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:J_},148:{f:K_,p:16},151:{f:RS},152:{},153:{f:NC},154:{},155:{},156:{f:bC},157:{},158:{},159:{T:1,f:L4},160:{T:-1},161:{T:1,f:Rs},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:AS},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:i5},336:{T:-1},337:{f:u5,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Bd},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Pg},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:OS},427:{f:LS},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:US},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:q_},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:IS},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Bd},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:E5},633:{T:1},634:{T:-1},635:{T:1,f:S5},636:{T:-1},637:{f:Qw},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:oC},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:XS},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Xd={6:{f:R0},10:{f:Ta},12:{f:ar},13:{f:ar},14:{f:Jt},15:{f:Jt},16:{f:Ir},17:{f:Jt},18:{f:Jt},19:{f:ar},20:{f:Rm},21:{f:Rm},23:{f:Pg},24:{f:Lm},25:{f:Jt},26:{},27:{},28:{f:Xj},29:{},34:{f:Jt},35:{f:Om},38:{f:Ir},39:{f:Ir},40:{f:Ir},41:{f:Ir},42:{f:Jt},43:{f:Jt},47:{f:sk},49:{f:bj},51:{f:ar},60:{},61:{f:hj},64:{f:Jt},65:{f:yj},66:{f:ar},77:{},80:{},81:{},82:{},85:{f:ar},89:{},90:{},91:{},92:{f:aj},93:{f:qj},94:{},95:{f:Jt},96:{},97:{},99:{f:Jt},125:{f:Dg},128:{f:Mj},129:{f:ij},130:{f:ar},131:{f:Jt},132:{f:Jt},133:{f:lj},134:{},140:{f:a4},141:{f:ar},144:{},146:{f:l4},151:{},152:{},153:{},154:{},155:{},156:{f:ar},157:{},158:{},160:{f:m4},161:{f:d4},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:Aj},190:{f:Pj},193:{f:Ta},197:{},198:{},199:{},200:{},201:{},202:{f:Jt},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:ar},220:{},221:{f:Jt},222:{},224:{f:Ij},225:{f:nj},226:{f:Ta},227:{},229:{f:Kj},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:oj},253:{f:Nj},255:{f:uj},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:jg},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Jt},353:{f:Ta},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:Uj},431:{f:Jt},432:{},433:{},434:{},437:{},438:{f:Zj},439:{f:Jt},440:{f:e4},441:{},442:{f:Ql},443:{},444:{f:ar},445:{},446:{},448:{f:Ta},449:{f:mj,r:2},450:{f:Ta},512:{f:Dm},513:{f:x4},515:{f:Lj},516:{f:kj},517:{f:Mm},519:{f:h4},520:{f:fj},523:{},545:{f:Bm},549:{f:Pm},566:{},574:{f:gj},638:{f:Fj},659:{},1048:{},1054:{f:Sj},1084:{},1212:{f:$j},2048:{f:r4},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Sc},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Ta},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:c4,r:12},2173:{f:a5,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Jt,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:Hj,r:12},2197:{},2198:{f:Qk,r:12},2199:{},2200:{},2201:{},2202:{f:Vj,r:12},2203:{f:Ta},2204:{},2205:{},2206:{},2207:{},2211:{f:xj},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:ar},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:u4},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:i4},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:Dm},1:{},2:{f:b4},3:{f:v4},4:{f:g4},5:{f:Mm},7:{f:N4},8:{},9:{f:Sc},11:{},22:{f:ar},30:{f:Ej},31:{},32:{},33:{f:Bm},36:{},37:{f:Pm},50:{f:j4},62:{},52:{},67:{},68:{f:ar},69:{},86:{},126:{},127:{f:p4},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:k4},223:{},234:{},354:{},421:{},518:{f:R0},521:{f:Sc},536:{f:Lm},547:{f:Om},561:{},579:{},1030:{f:R0},1033:{f:Sc},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Pe(e,t,r,a){var s=t;if(!isNaN(s)){var i=a||(r||[]).length||0,l=e.next(4);l.write_shift(2,s),l.write_shift(2,i),i>0&&lf(r)&&e.push(r)}}function N6(e,t,r,a){var s=(r||[]).length||0;if(s<=8224)return Pe(e,t,r,s);var i=t;if(!isNaN(i)){for(var l=r.parts||[],c=0,o=0,u=0;u+(l[c]||8224)<=8224;)u+=l[c]||8224,c++;var d=e.next(4);for(d.write_shift(2,i),d.write_shift(2,u),e.push(r.slice(o,o+u)),o+=u;o<s;){for(d=e.next(4),d.write_shift(2,60),u=0;u+(l[c]||8224)<=8224;)u+=l[c]||8224,c++;d.write_shift(2,u),e.push(r.slice(o,o+u)),o+=u}}}function rc(e,t,r){return e||(e=ye(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function j6(e,t,r,a){var s=ye(9);return rc(s,e,t),kg(r,a||"b",s),s}function k6(e,t,r){var a=ye(8+2*r.length);return rc(a,e,t),a.write_shift(1,r.length),a.write_shift(r.length,r,"sbcs"),a.l<a.length?a.slice(0,a.l):a}function _6(e,t,r,a){if(t.v!=null)switch(t.t){case"d":case"n":var s=t.t=="d"?dr(It(t.v)):t.v;s==(s|0)&&s>=0&&s<65536?Pe(e,2,w4(r,a,s)):Pe(e,3,y4(r,a,s));return;case"b":case"e":Pe(e,5,j6(r,a,t.v,t.t));return;case"s":case"str":Pe(e,4,k6(r,a,(t.v||"").slice(0,255)));return}Pe(e,1,rc(null,r,a))}function S6(e,t,r,a){var s=Array.isArray(t),i=mt(t["!ref"]||"A1"),l,c="",o=[];if(i.e.c>255||i.e.r>16383){if(a.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),l=et(i)}for(var u=i.s.r;u<=i.e.r;++u){c=Zt(u);for(var d=i.s.c;d<=i.e.c;++d){u===i.s.r&&(o[d]=Wt(d)),l=o[d]+c;var f=s?(t[u]||[])[d]:t[l];f&&_6(e,f,u,d)}}}function C6(e,t){for(var r=t||{},a=rn(),s=0,i=0;i<e.SheetNames.length;++i)e.SheetNames[i]==r.sheet&&(s=i);if(s==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Pe(a,r.biff==4?1033:r.biff==3?521:9,gf(e,16,r)),S6(a,e.Sheets[e.SheetNames[s]],s,r),Pe(a,10),a.end()}function E6(e,t,r){Pe(e,49,wj({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},r))}function T6(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var s=a[0];s<=a[1];++s)t[s]!=null&&Pe(e,1054,Cj(s,t[s],r))})}function F6(e,t){var r=ye(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Pe(e,2151,r),r=ye(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),Tg(mt(t["!ref"]||"A1"),r),r.write_shift(4,4),Pe(e,2152,r)}function A6(e,t){for(var r=0;r<16;++r)Pe(e,224,Im({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(a){Pe(e,224,Im(a,0,t))})}function P6(e,t){for(var r=0;r<t["!links"].length;++r){var a=t["!links"][r];Pe(e,440,t4(a)),a[1].Tooltip&&Pe(e,2048,n4(a))}delete t["!links"]}function D6(e,t){if(t){var r=0;t.forEach(function(a,s){++r<=256&&a&&Pe(e,125,o4(t0(s,a),s))})}}function I6(e,t,r,a,s){var i=16+as(s.cellXfs,t,s);if(t.v==null&&!t.bf){Pe(e,513,Es(r,a,i));return}if(t.bf)Pe(e,6,i_(t,r,a,s,i));else switch(t.t){case"d":case"n":var l=t.t=="d"?dr(It(t.v)):t.v;Pe(e,515,Bj(r,a,l,i));break;case"b":case"e":Pe(e,517,Oj(r,a,t.v,i,s,t.t));break;case"s":case"str":if(s.bookSST){var c=_f(s.Strings,t.v,s.revStrings);Pe(e,253,jj(r,a,c,i))}else Pe(e,516,_j(r,a,(t.v||"").slice(0,255),i,s));break;default:Pe(e,513,Es(r,a,i))}}function M6(e,t,r){var a=rn(),s=r.SheetNames[e],i=r.Sheets[s]||{},l=(r||{}).Workbook||{},c=(l.Sheets||[])[e]||{},o=Array.isArray(i),u=t.biff==8,d,f="",x=[],h=mt(i["!ref"]||"A1"),p=u?65536:16384;if(h.e.c>255||h.e.r>=p){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");h.e.c=Math.min(h.e.c,255),h.e.r=Math.min(h.e.c,p-1)}Pe(a,2057,gf(r,16,t)),Pe(a,13,_n(1)),Pe(a,12,_n(100)),Pe(a,15,Hr(!0)),Pe(a,17,Hr(!1)),Pe(a,16,Ss(.001)),Pe(a,95,Hr(!0)),Pe(a,42,Hr(!1)),Pe(a,43,Hr(!1)),Pe(a,130,_n(1)),Pe(a,128,Rj()),Pe(a,131,Hr(!1)),Pe(a,132,Hr(!1)),u&&D6(a,i["!cols"]),Pe(a,512,Tj(h,t)),u&&(i["!links"]=[]);for(var m=h.s.r;m<=h.e.r;++m){f=Zt(m);for(var w=h.s.c;w<=h.e.c;++w){m===h.s.r&&(x[w]=Wt(w)),d=x[w]+f;var v=o?(i[m]||[])[w]:i[d];v&&(I6(a,v,m,w,t),u&&v.l&&i["!links"].push([d,v.l]))}}var b=c.CodeName||c.name||s;return u&&Pe(a,574,vj((l.Views||[])[0])),u&&(i["!merges"]||[]).length&&Pe(a,229,Yj(i["!merges"])),u&&P6(a,i),Pe(a,442,_g(b)),u&&F6(a,i),Pe(a,10),a.end()}function R6(e,t,r){var a=rn(),s=(e||{}).Workbook||{},i=s.Sheets||[],l=s.WBProps||{},c=r.biff==8,o=r.biff==5;if(Pe(a,2057,gf(e,5,r)),r.bookType=="xla"&&Pe(a,135),Pe(a,225,c?_n(1200):null),Pe(a,193,ON(2)),o&&Pe(a,191),o&&Pe(a,192),Pe(a,226),Pe(a,92,sj("SheetJS",r)),Pe(a,66,_n(c?1200:1252)),c&&Pe(a,353,_n(0)),c&&Pe(a,448),Pe(a,317,f4(e.SheetNames.length)),c&&e.vbaraw&&Pe(a,211),c&&e.vbaraw){var u=l.CodeName||"ThisWorkbook";Pe(a,442,_g(u))}Pe(a,156,_n(17)),Pe(a,25,Hr(!1)),Pe(a,18,Hr(!1)),Pe(a,19,_n(0)),c&&Pe(a,431,Hr(!1)),c&&Pe(a,444,_n(0)),Pe(a,61,pj()),Pe(a,64,Hr(!1)),Pe(a,141,_n(0)),Pe(a,34,Hr(mC(e)=="true")),Pe(a,14,Hr(!0)),c&&Pe(a,439,Hr(!1)),Pe(a,218,_n(0)),E6(a,e,r),T6(a,e.SSF,r),A6(a,r),c&&Pe(a,352,Hr(!1));var d=a.end(),f=rn();c&&Pe(f,140,s4()),c&&r.Strings&&N6(f,252,dj(r.Strings)),Pe(f,10);var x=f.end(),h=rn(),p=0,m=0;for(m=0;m<e.SheetNames.length;++m)p+=(c?12:11)+(c?2:1)*e.SheetNames[m].length;var w=d.length+p+x.length;for(m=0;m<e.SheetNames.length;++m){var v=i[m]||{};Pe(h,133,cj({pos:w,hs:v.Hidden||0,dt:0,name:e.SheetNames[m]},r)),w+=t[m].length}var b=h.end();if(p!=b.length)throw new Error("BS8 "+p+" != "+b.length);var y=[];return d.length&&y.push(d),b.length&&y.push(b),x.length&&y.push(x),mr(y)}function O6(e,t){var r=t||{},a=[];e&&!e.SSF&&(e.SSF=Mt(Xe)),e&&e.SSF&&(Ci(),Ko(e.SSF),r.revssf=qo(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Ff(r),r.cellXfs=[],as(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var s=0;s<e.SheetNames.length;++s)a[a.length]=M6(s,r,e);return a.unshift(R6(e,a,r)),mr(a)}function vv(e,t){for(var r=0;r<=e.SheetNames.length;++r){var a=e.Sheets[e.SheetNames[r]];if(!(!a||!a["!ref"])){var s=nn(a["!ref"]);s.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var i=t||{};switch(i.biff||2){case 8:case 5:return O6(e,t);case 4:case 3:case 2:return C6(e,t)}throw new Error("invalid type "+i.bookType+" for BIFF")}function Ym(e,t){var r=t||{},a=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var s=e.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var i=e.match(/<\/table/i),l=s.index,c=i&&i.index||e.length,o=ww(e.slice(l,c),/(:?<tr[^>]*>)/i,"<tr>"),u=-1,d=0,f=0,x=0,h={s:{r:1e7,c:1e7},e:{r:0,c:0}},p=[];for(l=0;l<o.length;++l){var m=o[l].trim(),w=m.slice(0,3).toLowerCase();if(w=="<tr"){if(++u,r.sheetRows&&r.sheetRows<=u){--u;break}d=0;continue}if(!(w!="<td"&&w!="<th")){var v=m.split(/<\/t[dh]>/i);for(c=0;c<v.length;++c){var b=v[c].trim();if(b.match(/<t[dh]/i)){for(var y=b,N=0;y.charAt(0)=="<"&&(N=y.indexOf(">"))>-1;)y=y.slice(N+1);for(var A=0;A<p.length;++A){var k=p[A];k.s.c==d&&k.s.r<u&&u<=k.e.r&&(d=k.e.c+1,A=-1)}var _=Ye(b.slice(0,b.indexOf(">")));x=_.colspan?+_.colspan:1,((f=+_.rowspan)>1||x>1)&&p.push({s:{r:u,c:d},e:{r:u+(f||1)-1,c:d+x-1}});var j=_.t||_["data-t"]||"";if(!y.length){d+=x;continue}if(y=W1(y),h.s.r>u&&(h.s.r=u),h.e.r<u&&(h.e.r=u),h.s.c>d&&(h.s.c=d),h.e.c<d&&(h.e.c=d),!y.length){d+=x;continue}var P={t:"s",v:y};r.raw||!y.trim().length||j=="s"||(y==="TRUE"?P={t:"b",v:!0}:y==="FALSE"?P={t:"b",v:!1}:isNaN(Vn(y))?isNaN(bi(y).getDate())||(P={t:"d",v:It(y)},r.cellDates||(P={t:"n",v:dr(P.v)}),P.z=r.dateNF||Xe[14]):P={t:"n",v:Vn(y)}),r.dense?(a[u]||(a[u]=[]),a[u][d]=P):a[Ke({r:u,c:d})]=P,d+=x}}}}return a["!ref"]=et(h),p.length&&(a["!merges"]=p),a}function L6(e,t,r,a){for(var s=e["!merges"]||[],i=[],l=t.s.c;l<=t.e.c;++l){for(var c=0,o=0,u=0;u<s.length;++u)if(!(s[u].s.r>r||s[u].s.c>l)&&!(s[u].e.r<r||s[u].e.c<l)){if(s[u].s.r<r||s[u].s.c<l){c=-1;break}c=s[u].e.r-s[u].s.r+1,o=s[u].e.c-s[u].s.c+1;break}if(!(c<0)){var d=Ke({r,c:l}),f=a.dense?(e[r]||[])[l]:e[d],x=f&&f.v!=null&&(f.h||nf(f.w||(wa(f),f.w)||""))||"",h={};c>1&&(h.rowspan=c),o>1&&(h.colspan=o),a.editable?x='<span contenteditable="true">'+x+"</span>":f&&(h["data-t"]=f&&f.t||"z",f.v!=null&&(h["data-v"]=f.v),f.z!=null&&(h["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(x='<a href="'+f.l.Target+'">'+x+"</a>")),h.id=(a.id||"sjs")+"-"+d,i.push(Fe("td",x,h))}}var p="<tr>";return p+i.join("")+"</tr>"}var B6='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',U6="</body></html>";function z6(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return ns(Ym(r[0],t),t);var a=Df();return r.forEach(function(s,i){If(a,Ym(s,t),"Sheet"+(i+1))}),a}function W6(e,t,r){var a=[];return a.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function yv(e,t){var r=t||{},a=r.header!=null?r.header:B6,s=r.footer!=null?r.footer:U6,i=[a],l=nn(e["!ref"]);r.dense=Array.isArray(e),i.push(W6(e,l,r));for(var c=l.s.r;c<=l.e.r;++c)i.push(L6(e,l,c,r));return i.push("</table>"+s),i.join("")}function bv(e,t,r){var a=r||{},s=0,i=0;if(a.origin!=null)if(typeof a.origin=="number")s=a.origin;else{var l=typeof a.origin=="string"?Ht(a.origin):a.origin;s=l.r,i=l.c}var c=t.getElementsByTagName("tr"),o=Math.min(a.sheetRows||1e7,c.length),u={s:{r:0,c:0},e:{r:s,c:i}};if(e["!ref"]){var d=nn(e["!ref"]);u.s.r=Math.min(u.s.r,d.s.r),u.s.c=Math.min(u.s.c,d.s.c),u.e.r=Math.max(u.e.r,d.e.r),u.e.c=Math.max(u.e.c,d.e.c),s==-1&&(u.e.r=s=d.e.r+1)}var f=[],x=0,h=e["!rows"]||(e["!rows"]=[]),p=0,m=0,w=0,v=0,b=0,y=0;for(e["!cols"]||(e["!cols"]=[]);p<c.length&&m<o;++p){var N=c[p];if(qm(N)){if(a.display)continue;h[m]={hidden:!0}}var A=N.children;for(w=v=0;w<A.length;++w){var k=A[w];if(!(a.display&&qm(k))){var _=k.hasAttribute("data-v")?k.getAttribute("data-v"):k.hasAttribute("v")?k.getAttribute("v"):W1(k.innerHTML),j=k.getAttribute("data-z")||k.getAttribute("z");for(x=0;x<f.length;++x){var P=f[x];P.s.c==v+i&&P.s.r<m+s&&m+s<=P.e.r&&(v=P.e.c+1-i,x=-1)}y=+k.getAttribute("colspan")||1,((b=+k.getAttribute("rowspan")||1)>1||y>1)&&f.push({s:{r:m+s,c:v+i},e:{r:m+s+(b||1)-1,c:v+i+(y||1)-1}});var D={t:"s",v:_},K=k.getAttribute("data-t")||k.getAttribute("t")||"";_!=null&&(_.length==0?D.t=K||"z":a.raw||_.trim().length==0||K=="s"||(_==="TRUE"?D={t:"b",v:!0}:_==="FALSE"?D={t:"b",v:!1}:isNaN(Vn(_))?isNaN(bi(_).getDate())||(D={t:"d",v:It(_)},a.cellDates||(D={t:"n",v:dr(D.v)}),D.z=a.dateNF||Xe[14]):D={t:"n",v:Vn(_)})),D.z===void 0&&j!=null&&(D.z=j);var E="",Y=k.getElementsByTagName("A");if(Y&&Y.length)for(var B=0;B<Y.length&&!(Y[B].hasAttribute("href")&&(E=Y[B].getAttribute("href"),E.charAt(0)!="#"));++B);E&&E.charAt(0)!="#"&&(D.l={Target:E}),a.dense?(e[m+s]||(e[m+s]=[]),e[m+s][v+i]=D):e[Ke({c:v+i,r:m+s})]=D,u.e.c<v+i&&(u.e.c=v+i),v+=y}}++m}return f.length&&(e["!merges"]=(e["!merges"]||[]).concat(f)),u.e.r=Math.max(u.e.r,m-1+s),e["!ref"]=et(u),m>=o&&(e["!fullref"]=et((u.e.r=c.length-p+m-1+s,u))),e}function wv(e,t){var r=t||{},a=r.dense?[]:{};return bv(a,e,t)}function H6(e,t){return ns(wv(e,t),t)}function qm(e){var t="",r=$6(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function $6(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function V6(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(a,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=xt(t.replace(/<[^>]*>/g,""));return[r]}var Jm={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function Nv(e,t){var r=t||{},a=af(e),s=[],i,l,c={name:""},o="",u=0,d,f,x={},h=[],p=r.dense?[]:{},m,w,v={value:""},b="",y=0,N=[],A=-1,k=-1,_={s:{r:1e6,c:1e7},e:{r:0,c:0}},j=0,P={},D=[],K={},E=0,Y=0,B=[],te=1,re=1,Q=[],Z={Names:[]},z={},ne=["",""],xe=[],O={},R="",g=0,S=!1,F=!1,ae=0;for(Il.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");m=Il.exec(a);)switch(m[3]=m[3].replace(/_.*$/,"")){case"table":case"":m[1]==="/"?(_.e.c>=_.s.c&&_.e.r>=_.s.r?p["!ref"]=et(_):p["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=_.e.r&&(p["!fullref"]=p["!ref"],_.e.r=r.sheetRows-1,p["!ref"]=et(_)),D.length&&(p["!merges"]=D),B.length&&(p["!rows"]=B),d.name=d.||d.name,typeof JSON<"u"&&JSON.stringify(d),h.push(d.name),x[d.name]=p,F=!1):m[0].charAt(m[0].length-2)!=="/"&&(d=Ye(m[0],!1),A=k=-1,_.s.r=_.s.c=1e7,_.e.r=_.e.c=0,p=r.dense?[]:{},D=[],B=[],F=!0);break;case"table-row-group":m[1]==="/"?--j:++j;break;case"table-row":case"":if(m[1]==="/"){A+=te,te=1;break}if(f=Ye(m[0],!1),f.?A=f.-1:A==-1&&(A=0),te=+f["number-rows-repeated"]||1,te<10)for(ae=0;ae<te;++ae)j>0&&(B[A+ae]={level:j});k=-1;break;case"covered-table-cell":m[1]!=="/"&&++k,r.sheetStubs&&(r.dense?(p[A]||(p[A]=[]),p[A][k]={t:"z"}):p[Ke({r:A,c:k})]={t:"z"}),b="",N=[];break;case"table-cell":case"":if(m[0].charAt(m[0].length-2)==="/")++k,v=Ye(m[0],!1),re=parseInt(v["number-columns-repeated"]||"1",10),w={t:"z",v:null},v.formula&&r.cellFormula!=!1&&(w.f=Gm(xt(v.formula))),(v.||v["value-type"])=="string"&&(w.t="s",w.v=xt(v["string-value"]||""),r.dense?(p[A]||(p[A]=[]),p[A][k]=w):p[Ke({r:A,c:k})]=w),k+=re-1;else if(m[1]!=="/"){++k,b="",y=0,N=[],re=1;var ue=te?A+te-1:A;if(k>_.e.c&&(_.e.c=k),k<_.s.c&&(_.s.c=k),A<_.s.r&&(_.s.r=A),ue>_.e.r&&(_.e.r=ue),v=Ye(m[0],!1),xe=[],O={},w={t:v.||v["value-type"],v:null},r.cellFormula)if(v.formula&&(v.formula=xt(v.formula)),v["number-matrix-columns-spanned"]&&v["number-matrix-rows-spanned"]&&(E=parseInt(v["number-matrix-rows-spanned"],10)||0,Y=parseInt(v["number-matrix-columns-spanned"],10)||0,K={s:{r:A,c:k},e:{r:A+E-1,c:k+Y-1}},w.F=et(K),Q.push([K,w.F])),v.formula)w.f=Gm(v.formula);else for(ae=0;ae<Q.length;++ae)A>=Q[ae][0].s.r&&A<=Q[ae][0].e.r&&k>=Q[ae][0].s.c&&k<=Q[ae][0].e.c&&(w.F=Q[ae][1]);switch((v["number-columns-spanned"]||v["number-rows-spanned"])&&(E=parseInt(v["number-rows-spanned"],10)||0,Y=parseInt(v["number-columns-spanned"],10)||0,K={s:{r:A,c:k},e:{r:A+E-1,c:k+Y-1}},D.push(K)),v["number-columns-repeated"]&&(re=parseInt(v["number-columns-repeated"],10)),w.t){case"boolean":w.t="b",w.v=Ft(v["boolean-value"]);break;case"float":w.t="n",w.v=parseFloat(v.value);break;case"percentage":w.t="n",w.v=parseFloat(v.value);break;case"currency":w.t="n",w.v=parseFloat(v.value);break;case"date":w.t="d",w.v=It(v["date-value"]),r.cellDates||(w.t="n",w.v=dr(w.v)),w.z="m/d/yy";break;case"time":w.t="n",w.v=vw(v["time-value"])/86400,r.cellDates&&(w.t="d",w.v=Jo(w.v)),w.z="HH:MM:SS";break;case"number":w.t="n",w.v=parseFloat(v.);break;default:if(w.t==="string"||w.t==="text"||!w.t)w.t="s",v["string-value"]!=null&&(b=xt(v["string-value"]),N=[]);else throw new Error("Unsupported value type "+w.t)}}else{if(S=!1,w.t==="s"&&(w.v=b||"",N.length&&(w.R=N),S=y==0),z.Target&&(w.l=z),xe.length>0&&(w.c=xe,xe=[]),b&&r.cellText!==!1&&(w.w=b),S&&(w.t="z",delete w.v),(!S||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=A))for(var ve=0;ve<te;++ve){if(re=parseInt(v["number-columns-repeated"]||"1",10),r.dense)for(p[A+ve]||(p[A+ve]=[]),p[A+ve][k]=ve==0?w:Mt(w);--re>0;)p[A+ve][k+re]=Mt(w);else for(p[Ke({r:A+ve,c:k})]=w;--re>0;)p[Ke({r:A+ve,c:k+re})]=Mt(w);_.e.c<=k&&(_.e.c=k)}re=parseInt(v["number-columns-repeated"]||"1",10),k+=re-1,re=0,w={},b="",N=[]}z={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(m[1]==="/"){if((i=s.pop())[0]!==m[3])throw"Bad state: "+i}else m[0].charAt(m[0].length-2)!=="/"&&s.push([m[3],!0]);break;case"annotation":if(m[1]==="/"){if((i=s.pop())[0]!==m[3])throw"Bad state: "+i;O.t=b,N.length&&(O.R=N),O.a=R,xe.push(O)}else m[0].charAt(m[0].length-2)!=="/"&&s.push([m[3],!1]);R="",g=0,b="",y=0,N=[];break;case"creator":m[1]==="/"?R=a.slice(g,m.index):g=m.index+m[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(m[1]==="/"){if((i=s.pop())[0]!==m[3])throw"Bad state: "+i}else m[0].charAt(m[0].length-2)!=="/"&&s.push([m[3],!1]);b="",y=0,N=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(m[1]==="/"){if(P[c.name]=o,(i=s.pop())[0]!==m[3])throw"Bad state: "+i}else m[0].charAt(m[0].length-2)!=="/"&&(o="",c=Ye(m[0],!1),s.push([m[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":l=Ye(m[0],!1),o+=Jm[m[3]][l.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":l=Ye(m[0],!1),o+=Jm[m[3]][l.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(m[0].slice(-2)==="/>")break;if(m[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":o+=a.slice(u,m.index);break}else u=m.index+m[0].length;break;case"named-range":l=Ye(m[0],!1),ne=O0(l["cell-range-address"]);var me={Name:l.name,Ref:ne[0]+"!"+ne[1]};F&&(me.Sheet=h.length),Z.Names.push(me);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(m[1]==="/"&&(!v||!v["string-value"])){var H=V6(a.slice(y,m.index));b=(b.length>0?b+`
`:"")+H[0]}else Ye(m[0],!1),y=m.index+m[0].length;break;case"s":break;case"database-range":if(m[1]==="/")break;try{ne=O0(Ye(m[0])["target-range-address"]),x[ne[0]]["!autofilter"]={ref:ne[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(m[1]!=="/"){if(z=Ye(m[0],!1),!z.href)break;z.Target=xt(z.href),delete z.href,z.Target.charAt(0)=="#"&&z.Target.indexOf(".")>-1?(ne=O0(z.Target.slice(1)),z.Target="#"+ne[0]+"!"+ne[1]):z.Target.match(/^\.\.[\\\/]/)&&(z.Target=z.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(m[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(m)}}var T={Sheets:x,SheetNames:h,Workbook:Z};return r.bookSheets&&delete T.Sheets,T}function Qm(e,t){t=t||{},kn(e,"META-INF/manifest.xml")&&vN(nr(e,"META-INF/manifest.xml"),t);var r=xn(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var a=Nv(jt(r),t);return kn(e,"meta.xml")&&(a.Props=fg(nr(e,"meta.xml"))),a}function Zm(e,t){return Nv(e,t)}var G6=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+Dl({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return er+t}}(),eh=function(){var e=function(i){return wt(i).replace(/  +/g,function(l){return'<text:s text:c="'+l.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,a=function(i,l,c){var o=[];o.push('      <table:table table:name="'+wt(l.SheetNames[c])+`" table:style-name="ta1">
`);var u=0,d=0,f=nn(i["!ref"]||"A1"),x=i["!merges"]||[],h=0,p=Array.isArray(i);if(i["!cols"])for(d=0;d<=f.e.c;++d)o.push("        <table:table-column"+(i["!cols"][d]?' table:style-name="co'+i["!cols"][d].ods+'"':"")+`></table:table-column>
`);var m="",w=i["!rows"]||[];for(u=0;u<f.s.r;++u)m=w[u]?' table:style-name="ro'+w[u].ods+'"':"",o.push("        <table:table-row"+m+`></table:table-row>
`);for(;u<=f.e.r;++u){for(m=w[u]?' table:style-name="ro'+w[u].ods+'"':"",o.push("        <table:table-row"+m+`>
`),d=0;d<f.s.c;++d)o.push(t);for(;d<=f.e.c;++d){var v=!1,b={},y="";for(h=0;h!=x.length;++h)if(!(x[h].s.c>d)&&!(x[h].s.r>u)&&!(x[h].e.c<d)&&!(x[h].e.r<u)){(x[h].s.c!=d||x[h].s.r!=u)&&(v=!0),b["table:number-columns-spanned"]=x[h].e.c-x[h].s.c+1,b["table:number-rows-spanned"]=x[h].e.r-x[h].s.r+1;break}if(v){o.push(r);continue}var N=Ke({r:u,c:d}),A=p?(i[u]||[])[d]:i[N];if(A&&A.f&&(b["table:formula"]=wt(f_(A.f)),A.F&&A.F.slice(0,N.length)==N)){var k=nn(A.F);b["table:number-matrix-columns-spanned"]=k.e.c-k.s.c+1,b["table:number-matrix-rows-spanned"]=k.e.r-k.s.r+1}if(!A){o.push(t);continue}switch(A.t){case"b":y=A.v?"TRUE":"FALSE",b["office:value-type"]="boolean",b["office:boolean-value"]=A.v?"true":"false";break;case"n":y=A.w||String(A.v||0),b["office:value-type"]="float",b["office:value"]=A.v||0;break;case"s":case"str":y=A.v==null?"":A.v,b["office:value-type"]="string";break;case"d":y=A.w||It(A.v).toISOString(),b["office:value-type"]="date",b["office:date-value"]=It(A.v).toISOString(),b["table:style-name"]="ce1";break;default:o.push(t);continue}var _=e(y);if(A.l&&A.l.Target){var j=A.l.Target;j=j.charAt(0)=="#"?"#"+x_(j.slice(1)):j,j.charAt(0)!="#"&&!j.match(/^\w+:/)&&(j="../"+j),_=Fe("text:a",_,{"xlink:href":j.replace(/&/g,"&amp;")})}o.push("          "+Fe("table:table-cell",Fe("text:p",_,{}),b)+`
`)}o.push(`        </table:table-row>
`)}return o.push(`      </table:table>
`),o.join("")},s=function(i,l){i.push(` <office:automatic-styles>
`),i.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),i.push(`   <number:month number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:day number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:year/>
`),i.push(`  </number:date-style>
`);var c=0;l.SheetNames.map(function(u){return l.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var d=0;d<u["!cols"].length;++d)if(u["!cols"][d]){var f=u["!cols"][d];if(f.width==null&&f.wpx==null&&f.wch==null)continue;qa(f),f.ods=c;var x=u["!cols"][d].wpx+"px";i.push('  <style:style style:name="co'+c+`" style:family="table-column">
`),i.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+x+`"/>
`),i.push(`  </style:style>
`),++c}}});var o=0;l.SheetNames.map(function(u){return l.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var d=0;d<u["!rows"].length;++d)if(u["!rows"][d]){u["!rows"][d].ods=o;var f=u["!rows"][d].hpx+"px";i.push('  <style:style style:name="ro'+o+`" style:family="table-row">
`),i.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+f+`"/>
`),i.push(`  </style:style>
`),++o}}}),i.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),i.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),i.push(`  </style:style>
`),i.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),i.push(` </office:automatic-styles>
`)};return function(l,c){var o=[er],u=Dl({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),d=Dl({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});c.bookType=="fods"?(o.push("<office:document"+u+d+`>
`),o.push(ug().replace(/office:document-meta/g,"office:meta"))):o.push("<office:document-content"+u+`>
`),s(o,l),o.push(`  <office:body>
`),o.push(`    <office:spreadsheet>
`);for(var f=0;f!=l.SheetNames.length;++f)o.push(a(l.Sheets[l.SheetNames[f]],l,f));return o.push(`    </office:spreadsheet>
`),o.push(`  </office:body>
`),c.bookType=="fods"?o.push("</office:document>"):o.push("</office:document-content>"),o.join("")}}();function jv(e,t){if(t.bookType=="fods")return eh(e,t);var r=ef(),a="",s=[],i=[];return a="mimetype",tt(r,a,"application/vnd.oasis.opendocument.spreadsheet"),a="content.xml",tt(r,a,eh(e,t)),s.push([a,"text/xml"]),i.push([a,"ContentFile"]),a="styles.xml",tt(r,a,G6(e,t)),s.push([a,"text/xml"]),i.push([a,"StylesFile"]),a="meta.xml",tt(r,a,er+ug()),s.push([a,"text/xml"]),i.push([a,"MetadataFile"]),a="manifest.rdf",tt(r,a,wN(i)),s.push([a,"application/rdf+xml"]),a="META-INF/manifest.xml",tt(r,a,yN(s)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Ts(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Kd(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):jt(rs(e))}function X6(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):fn(ta(e))}function K6(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var a=0;a<t.length;++a)if(e[r+a]!=t[a])continue e;return!0}return!1}function Qa(e){var t=e.reduce(function(s,i){return s+i.length},0),r=new Uint8Array(t),a=0;return e.forEach(function(s){r.set(s,a),a+=s.length}),r}function th(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function Y6(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,a=e[t+14]&1,s=t+13;s>=t;--s)a=a*256+e[s];return(e[t+15]&128?-a:a)*Math.pow(10,r-6176)}function q6(e,t,r){var a=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,s=r/Math.pow(10,a-6176);e[t+15]|=a>>7,e[t+14]|=(a&127)<<1;for(var i=0;s>=1;++i,s/=256)e[t+i]=s&255;e[t+15]|=r>=0?0:128}function zl(e,t){var r=t?t[0]:0,a=e[r]&127;e:if(e[r++]>=128&&(a|=(e[r]&127)<<7,e[r++]<128||(a|=(e[r]&127)<<14,e[r++]<128)||(a|=(e[r]&127)<<21,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),a}function yt(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function Kt(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function ht(e){for(var t=[],r=[0];r[0]<e.length;){var a=r[0],s=zl(e,r),i=s&7;s=Math.floor(s/8);var l=0,c;if(s==0)break;switch(i){case 0:{for(var o=r[0];e[r[0]++]>=128;);c=e.slice(o,r[0])}break;case 5:l=4,c=e.slice(r[0],r[0]+l),r[0]+=l;break;case 1:l=8,c=e.slice(r[0],r[0]+l),r[0]+=l;break;case 2:l=zl(e,r),c=e.slice(r[0],r[0]+l),r[0]+=l;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(s," at offset ").concat(a))}var u={data:c,type:i};t[s]==null?t[s]=[u]:t[s].push(u)}return t}function vr(e){var t=[];return e.forEach(function(r,a){r.forEach(function(s){s.data&&(t.push(yt(a*8+s.type)),s.type==2&&t.push(yt(s.data.length)),t.push(s.data))})}),Qa(t)}function Ef(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function Nn(e){for(var t,r=[],a=[0];a[0]<e.length;){var s=zl(e,a),i=ht(e.slice(a[0],a[0]+s));a[0]+=s;var l={id:Kt(i[1][0].data),messages:[]};i[2].forEach(function(c){var o=ht(c.data),u=Kt(o[3][0].data);l.messages.push({meta:o,data:e.slice(a[0],a[0]+u)}),a[0]+=u}),(t=i[3])!=null&&t[0]&&(l.merge=Kt(i[3][0].data)>>>0>0),r.push(l)}return r}function Us(e){var t=[];return e.forEach(function(r){var a=[];a[1]=[{data:yt(r.id),type:0}],a[2]=[],r.merge!=null&&(a[3]=[{data:yt(+!!r.merge),type:0}]);var s=[];r.messages.forEach(function(l){s.push(l.data),l.meta[3]=[{type:0,data:yt(l.data.length)}],a[2].push({data:vr(l.meta),type:2})});var i=vr(a);t.push(yt(i.length)),t.push(i),s.forEach(function(l){return t.push(l)})}),Qa(t)}function J6(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],a=zl(t,r),s=[];r[0]<t.length;){var i=t[r[0]]&3;if(i==0){var l=t[r[0]++]>>2;if(l<60)++l;else{var c=l-59;l=t[r[0]],c>1&&(l|=t[r[0]+1]<<8),c>2&&(l|=t[r[0]+2]<<16),c>3&&(l|=t[r[0]+3]<<24),l>>>=0,l++,r[0]+=c}s.push(t.slice(r[0],r[0]+l)),r[0]+=l;continue}else{var o=0,u=0;if(i==1?(u=(t[r[0]]>>2&7)+4,o=(t[r[0]++]&224)<<3,o|=t[r[0]++]):(u=(t[r[0]++]>>2)+1,i==2?(o=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(o=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),s=[Qa(s)],o==0)throw new Error("Invalid offset 0");if(o>s[0].length)throw new Error("Invalid offset beyond length");if(u>=o)for(s.push(s[0].slice(-o)),u-=o;u>=s[s.length-1].length;)s.push(s[s.length-1]),u-=s[s.length-1].length;s.push(s[0].slice(-o,-o+u))}}var d=Qa(s);if(d.length!=a)throw new Error("Unexpected length: ".concat(d.length," != ").concat(a));return d}function jn(e){for(var t=[],r=0;r<e.length;){var a=e[r++],s=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(J6(a,e.slice(r,r+s))),r+=s}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Qa(t)}function zs(e){for(var t=[],r=0;r<e.length;){var a=Math.min(e.length-r,268435455),s=new Uint8Array(4);t.push(s);var i=yt(a),l=i.length;t.push(i),a<=60?(l++,t.push(new Uint8Array([a-1<<2]))):a<=256?(l+=2,t.push(new Uint8Array([240,a-1&255]))):a<=65536?(l+=3,t.push(new Uint8Array([244,a-1&255,a-1>>8&255]))):a<=16777216?(l+=4,t.push(new Uint8Array([248,a-1&255,a-1>>8&255,a-1>>16&255]))):a<=4294967296&&(l+=5,t.push(new Uint8Array([252,a-1&255,a-1>>8&255,a-1>>16&255,a-1>>>24&255]))),t.push(e.slice(r,r+a)),l+=a,s[0]=0,s[1]=l&255,s[2]=l>>8&255,s[3]=l>>16&255,r+=a}return Qa(t)}function Q6(e,t,r,a){var s=Ts(e),i=s.getUint32(4,!0),l=(a>1?12:8)+th(i&(a>1?3470:398))*4,c=-1,o=-1,u=NaN,d=new Date(2001,0,1);i&512&&(c=s.getUint32(l,!0),l+=4),l+=th(i&(a>1?12288:4096))*4,i&16&&(o=s.getUint32(l,!0),l+=4),i&32&&(u=s.getFloat64(l,!0),l+=8),i&64&&(d.setTime(d.getTime()+s.getFloat64(l,!0)*1e3),l+=8);var f;switch(e[2]){case 0:break;case 2:f={t:"n",v:u};break;case 3:f={t:"s",v:t[o]};break;case 5:f={t:"d",v:d};break;case 6:f={t:"b",v:u>0};break;case 7:f={t:"n",v:u/86400};break;case 8:f={t:"e",v:0};break;case 9:if(c>-1)f={t:"s",v:r[c]};else if(o>-1)f={t:"s",v:t[o]};else if(!isNaN(u))f={t:"n",v:u};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return f}function Z6(e,t,r){var a=Ts(e),s=a.getUint32(8,!0),i=12,l=-1,c=-1,o=NaN,u=NaN,d=new Date(2001,0,1);s&1&&(o=Y6(e,i),i+=16),s&2&&(u=a.getFloat64(i,!0),i+=8),s&4&&(d.setTime(d.getTime()+a.getFloat64(i,!0)*1e3),i+=8),s&8&&(c=a.getUint32(i,!0),i+=4),s&16&&(l=a.getUint32(i,!0),i+=4);var f;switch(e[1]){case 0:break;case 2:f={t:"n",v:o};break;case 3:f={t:"s",v:t[c]};break;case 5:f={t:"d",v:d};break;case 6:f={t:"b",v:u>0};break;case 7:f={t:"n",v:u/86400};break;case 8:f={t:"e",v:0};break;case 9:if(l>-1)f={t:"s",v:r[l]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)));break;case 10:f={t:"n",v:o};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)))}return f}function B0(e,t){var r=new Uint8Array(32),a=Ts(r),s=12,i=0;switch(r[0]=5,e.t){case"n":r[1]=2,q6(r,s,e.v),i|=1,s+=16;break;case"b":r[1]=6,a.setFloat64(s,e.v?1:0,!0),i|=2,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,a.setUint32(s,t.indexOf(e.v),!0),i|=8,s+=4;break;default:throw"unsupported cell type "+e.t}return a.setUint32(8,i,!0),r.slice(0,s)}function U0(e,t){var r=new Uint8Array(32),a=Ts(r),s=12,i=0;switch(r[0]=3,e.t){case"n":r[2]=2,a.setFloat64(s,e.v,!0),i|=32,s+=8;break;case"b":r[2]=6,a.setFloat64(s,e.v?1:0,!0),i|=32,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,a.setUint32(s,t.indexOf(e.v),!0),i|=16,s+=4;break;default:throw"unsupported cell type "+e.t}return a.setUint32(4,i,!0),r.slice(0,s)}function eE(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return Q6(e,t,r,e[0]);case 5:return Z6(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Fr(e){var t=ht(e);return zl(t[1][0].data)}function rh(e,t){var r=ht(t.data),a=Kt(r[1][0].data),s=r[3],i=[];return(s||[]).forEach(function(l){var c=ht(l.data),o=Kt(c[1][0].data)>>>0;switch(a){case 1:i[o]=Kd(c[3][0].data);break;case 8:{var u=e[Fr(c[9][0].data)][0],d=ht(u.data),f=e[Fr(d[1][0].data)][0],x=Kt(f.meta[1][0].data);if(x!=2001)throw new Error("2000 unexpected reference to ".concat(x));var h=ht(f.data);i[o]=h[3].map(function(p){return Kd(p.data)}).join("")}break}}),i}function tE(e,t){var r,a,s,i,l,c,o,u,d,f,x,h,p,m,w=ht(e),v=Kt(w[1][0].data)>>>0,b=Kt(w[2][0].data)>>>0,y=((a=(r=w[8])==null?void 0:r[0])==null?void 0:a.data)&&Kt(w[8][0].data)>0||!1,N,A;if((i=(s=w[7])==null?void 0:s[0])!=null&&i.data&&t!=0)N=(c=(l=w[7])==null?void 0:l[0])==null?void 0:c.data,A=(u=(o=w[6])==null?void 0:o[0])==null?void 0:u.data;else if((f=(d=w[4])==null?void 0:d[0])!=null&&f.data&&t!=1)N=(h=(x=w[4])==null?void 0:x[0])==null?void 0:h.data,A=(m=(p=w[3])==null?void 0:p[0])==null?void 0:m.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var k=y?4:1,_=Ts(N),j=[],P=0;P<N.length/2;++P){var D=_.getUint16(P*2,!0);D<65535&&j.push([P,D])}if(j.length!=b)throw"Expected ".concat(b," cells, found ").concat(j.length);var K=[];for(P=0;P<j.length-1;++P)K[j[P][0]]=A.subarray(j[P][1]*k,j[P+1][1]*k);return j.length>=1&&(K[j[j.length-1][0]]=A.subarray(j[j.length-1][1]*k)),{R:v,cells:K}}function rE(e,t){var r,a=ht(t.data),s=(r=a==null?void 0:a[7])!=null&&r[0]?Kt(a[7][0].data)>>>0>0?1:0:-1,i=Ef(a[5],function(l){return tE(l,s)});return{nrows:Kt(a[4][0].data)>>>0,data:i.reduce(function(l,c){return l[c.R]||(l[c.R]=[]),c.cells.forEach(function(o,u){if(l[c.R][u])throw new Error("Duplicate cell r=".concat(c.R," c=").concat(u));l[c.R][u]=o}),l},[])}}function nE(e,t,r){var a,s=ht(t.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(Kt(s[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(i.e.c=(Kt(s[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));r["!ref"]=et(i);var l=ht(s[4][0].data),c=rh(e,e[Fr(l[4][0].data)][0]),o=(a=l[17])!=null&&a[0]?rh(e,e[Fr(l[17][0].data)][0]):[],u=ht(l[3][0].data),d=0;u[1].forEach(function(f){var x=ht(f.data),h=e[Fr(x[2][0].data)][0],p=Kt(h.meta[1][0].data);if(p!=6002)throw new Error("6001 unexpected reference to ".concat(p));var m=rE(e,h);m.data.forEach(function(w,v){w.forEach(function(b,y){var N=Ke({r:d+v,c:y}),A=eE(b,c,o);A&&(r[N]=A)})}),d+=m.nrows})}function aE(e,t){var r=ht(t.data),a={"!ref":"A1"},s=e[Fr(r[2][0].data)],i=Kt(s[0].meta[1][0].data);if(i!=6001)throw new Error("6000 unexpected reference to ".concat(i));return nE(e,s[0],a),a}function sE(e,t){var r,a=ht(t.data),s={name:(r=a[1])!=null&&r[0]?Kd(a[1][0].data):"",sheets:[]},i=Ef(a[2],Fr);return i.forEach(function(l){e[l].forEach(function(c){var o=Kt(c.meta[1][0].data);o==6e3&&s.sheets.push(aE(e,c))})}),s}function iE(e,t){var r=Df(),a=ht(t.data),s=Ef(a[1],Fr);if(s.forEach(function(i){e[i].forEach(function(l){var c=Kt(l.meta[1][0].data);if(c==2){var o=sE(e,l);o.sheets.forEach(function(u,d){If(r,u,d==0?o.name:o.name+"_"+d,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function z0(e){var t,r,a,s,i={},l=[];if(e.FullPaths.forEach(function(o){if(o.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(o){if(o.name.match(/\.iwa$/)){var u;try{u=jn(o.content)}catch(f){return console.log("?? "+o.content.length+" "+(f.message||f))}var d;try{d=Nn(u)}catch(f){return console.log("## "+(f.message||f))}d.forEach(function(f){i[f.id]=f.messages,l.push(f.id)})}}),!l.length)throw new Error("File has no messages");var c=((s=(a=(r=(t=i==null?void 0:i[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:a[1])==null?void 0:s[0].data)&&Kt(i[1][0].meta[1][0].data)==1&&i[1][0];if(c||l.forEach(function(o){i[o].forEach(function(u){var d=Kt(u.meta[1][0].data)>>>0;if(d==1)if(!c)c=u;else throw new Error("Document has multiple roots")})}),!c)throw new Error("Cannot find Document root");return iE(i,c)}function lE(e,t,r){var a,s,i,l;if(!((a=e[6])!=null&&a[0])||!((s=e[7])!=null&&s[0]))throw"Mutation only works on post-BNC storages!";var c=((l=(i=e[8])==null?void 0:i[0])==null?void 0:l.data)&&Kt(e[8][0].data)>0||!1;if(c)throw"Math only works with normal offsets";for(var o=0,u=Ts(e[7][0].data),d=0,f=[],x=Ts(e[4][0].data),h=0,p=[],m=0;m<t.length;++m){if(t[m]==null){u.setUint16(m*2,65535,!0),x.setUint16(m*2,65535);continue}u.setUint16(m*2,d,!0),x.setUint16(m*2,h,!0);var w,v;switch(typeof t[m]){case"string":w=B0({t:"s",v:t[m]},r),v=U0({t:"s",v:t[m]},r);break;case"number":w=B0({t:"n",v:t[m]},r),v=U0({t:"n",v:t[m]},r);break;case"boolean":w=B0({t:"b",v:t[m]},r),v=U0({t:"b",v:t[m]},r);break;default:throw new Error("Unsupported value "+t[m])}f.push(w),d+=w.length,p.push(v),h+=v.length,++o}for(e[2][0].data=yt(o);m<e[7][0].data.length/2;++m)u.setUint16(m*2,65535,!0),x.setUint16(m*2,65535,!0);return e[6][0].data=Qa(f),e[3][0].data=Qa(p),o}function cE(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var a=nn(r["!ref"]);a.s.r=a.s.c=0;var s=!1;a.e.c>9&&(s=!0,a.e.c=9),a.e.r>49&&(s=!0,a.e.r=49),s&&console.error("The Numbers writer is currently limited to ".concat(et(a)));var i=Fo(r,{range:a,header:1}),l=["~Sh33tJ5~"];i.forEach(function(R){return R.forEach(function(g){typeof g=="string"&&l.push(g)})});var c={},o=[],u=$e.read(t.numbers,{type:"base64"});u.FileIndex.map(function(R,g){return[R,u.FullPaths[g]]}).forEach(function(R){var g=R[0],S=R[1];if(g.type==2&&g.name.match(/\.iwa/)){var F=g.content,ae=jn(F),ue=Nn(ae);ue.forEach(function(ve){o.push(ve.id),c[ve.id]={deps:[],location:S,type:Kt(ve.messages[0].meta[1][0].data)}})}}),o.sort(function(R,g){return R-g});var d=o.filter(function(R){return R>1}).map(function(R){return[R,yt(R)]});u.FileIndex.map(function(R,g){return[R,u.FullPaths[g]]}).forEach(function(R){var g=R[0];if(R[1],!!g.name.match(/\.iwa/)){var S=Nn(jn(g.content));S.forEach(function(F){F.messages.forEach(function(ae){d.forEach(function(ue){F.messages.some(function(ve){return Kt(ve.meta[1][0].data)!=11006&&K6(ve.data,ue[1])})&&c[ue[0]].deps.push(F.id)})})})}});for(var f=$e.find(u,c[1].location),x=Nn(jn(f.content)),h,p=0;p<x.length;++p){var m=x[p];m.id==1&&(h=m)}var w=Fr(ht(h.messages[0].data)[1][0].data);for(f=$e.find(u,c[w].location),x=Nn(jn(f.content)),p=0;p<x.length;++p)m=x[p],m.id==w&&(h=m);for(w=Fr(ht(h.messages[0].data)[2][0].data),f=$e.find(u,c[w].location),x=Nn(jn(f.content)),p=0;p<x.length;++p)m=x[p],m.id==w&&(h=m);for(w=Fr(ht(h.messages[0].data)[2][0].data),f=$e.find(u,c[w].location),x=Nn(jn(f.content)),p=0;p<x.length;++p)m=x[p],m.id==w&&(h=m);var v=ht(h.messages[0].data);{v[6][0].data=yt(a.e.r+1),v[7][0].data=yt(a.e.c+1);var b=Fr(v[46][0].data),y=$e.find(u,c[b].location),N=Nn(jn(y.content));{for(var A=0;A<N.length&&N[A].id!=b;++A);if(N[A].id!=b)throw"Bad ColumnRowUIDMapArchive";var k=ht(N[A].messages[0].data);k[1]=[],k[2]=[],k[3]=[];for(var _=0;_<=a.e.c;++_){var j=[];j[1]=j[2]=[{type:0,data:yt(_+420690)}],k[1].push({type:2,data:vr(j)}),k[2].push({type:0,data:yt(_)}),k[3].push({type:0,data:yt(_)})}k[4]=[],k[5]=[],k[6]=[];for(var P=0;P<=a.e.r;++P)j=[],j[1]=j[2]=[{type:0,data:yt(P+726270)}],k[4].push({type:2,data:vr(j)}),k[5].push({type:0,data:yt(P)}),k[6].push({type:0,data:yt(P)});N[A].messages[0].data=vr(k)}y.content=zs(Us(N)),y.size=y.content.length,delete v[46];var D=ht(v[4][0].data);{D[7][0].data=yt(a.e.r+1);var K=ht(D[1][0].data),E=Fr(K[2][0].data);y=$e.find(u,c[E].location),N=Nn(jn(y.content));{if(N[0].id!=E)throw"Bad HeaderStorageBucket";var Y=ht(N[0].messages[0].data);for(P=0;P<i.length;++P){var B=ht(Y[2][0].data);B[1][0].data=yt(P),B[4][0].data=yt(i[P].length),Y[2][P]={type:Y[2][0].type,data:vr(B)}}N[0].messages[0].data=vr(Y)}y.content=zs(Us(N)),y.size=y.content.length;var te=Fr(D[2][0].data);y=$e.find(u,c[te].location),N=Nn(jn(y.content));{if(N[0].id!=te)throw"Bad HeaderStorageBucket";for(Y=ht(N[0].messages[0].data),_=0;_<=a.e.c;++_)B=ht(Y[2][0].data),B[1][0].data=yt(_),B[4][0].data=yt(a.e.r+1),Y[2][_]={type:Y[2][0].type,data:vr(B)};N[0].messages[0].data=vr(Y)}y.content=zs(Us(N)),y.size=y.content.length;var re=Fr(D[4][0].data);(function(){for(var R=$e.find(u,c[re].location),g=Nn(jn(R.content)),S,F=0;F<g.length;++F){var ae=g[F];ae.id==re&&(S=ae)}var ue=ht(S.messages[0].data);{ue[3]=[];var ve=[];l.forEach(function(T,je){ve[1]=[{type:0,data:yt(je)}],ve[2]=[{type:0,data:yt(1)}],ve[3]=[{type:2,data:X6(T)}],ue[3].push({type:2,data:vr(ve)})})}S.messages[0].data=vr(ue);var me=Us(g),H=zs(me);R.content=H,R.size=R.content.length})();var Q=ht(D[3][0].data);{var Z=Q[1][0];delete Q[2];var z=ht(Z.data);{var ne=Fr(z[2][0].data);(function(){for(var R=$e.find(u,c[ne].location),g=Nn(jn(R.content)),S,F=0;F<g.length;++F){var ae=g[F];ae.id==ne&&(S=ae)}var ue=ht(S.messages[0].data);{delete ue[6],delete Q[7];var ve=new Uint8Array(ue[5][0].data);ue[5]=[];for(var me=0,H=0;H<=a.e.r;++H){var T=ht(ve);me+=lE(T,i[H],l),T[1][0].data=yt(H),ue[5].push({data:vr(T),type:2})}ue[1]=[{type:0,data:yt(a.e.c+1)}],ue[2]=[{type:0,data:yt(a.e.r+1)}],ue[3]=[{type:0,data:yt(me)}],ue[4]=[{type:0,data:yt(a.e.r+1)}]}S.messages[0].data=vr(ue);var je=Us(g),pe=zs(je);R.content=pe,R.size=R.content.length})()}Z.data=vr(z)}D[3][0].data=vr(Q)}v[4][0].data=vr(D)}h.messages[0].data=vr(v);var xe=Us(x),O=zs(xe);return f.content=O,f.size=f.content.length,u}function kv(e){return function(r){for(var a=0;a!=e.length;++a){var s=e[a];r[s[0]]===void 0&&(r[s[0]]=s[1]),s[2]==="n"&&(r[s[0]]=Number(r[s[0]]))}}}function Tf(e){kv([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function Ff(e){kv([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function oE(e){return st.WS.indexOf(e)>-1?"sheet":e==st.CS?"chart":e==st.DS?"dialog":e==st.MS?"macro":e&&e.length?e:"sheet"}function dE(e,t){if(!e)return 0;try{e=t.map(function(a){return a.id||(a.id=a.strRelID),[a.name,e["!id"][a.id].Target,oE(e["!id"][a.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function uE(e,t,r,a,s,i,l,c,o,u,d,f){try{i[a]=sl(xn(e,r,!0),t);var x=nr(e,t),h;switch(c){case"sheet":h=DC(x,t,s,o,i[a],u,d,f);break;case"chart":if(h=IC(x,t,s,o,i[a],u,d,f),!h||!h["!drawel"])break;var p=Gi(h["!drawel"].Target,t),m=Ml(p),w=b5(xn(e,p,!0),sl(xn(e,m,!0),p)),v=Gi(w,p),b=Ml(v);h=lC(xn(e,v,!0),v,o,sl(xn(e,b,!0),v),u,h);break;case"macro":h=MC(x,t,s,o,i[a],u,d,f);break;case"dialog":h=RC(x,t,s,o,i[a],u,d,f);break;default:throw new Error("Unrecognized sheet type "+c)}l[a]=h;var y=[];i&&i[a]&&Yt(i[a]).forEach(function(N){var A="";if(i[a][N].Type==st.CMNT){A=Gi(i[a][N].Target,t);var k=UC(nr(e,A,!0),A,o);if(!k||!k.length)return;zm(h,k,!1)}i[a][N].Type==st.TCMNT&&(A=Gi(i[a][N].Target,t),y=y.concat(N5(nr(e,A,!0),o)))}),y&&y.length&&zm(h,y,!0,o.people||[])}catch(N){if(o.WTF)throw N}}function bn(e){return e.charAt(0)=="/"?e.slice(1):e}function fE(e,t){if(Ci(),t=t||{},Tf(t),kn(e,"META-INF/manifest.xml")||kn(e,"objectdata.xml"))return Qm(e,t);if(kn(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof z0<"u"){if(e.FileIndex)return z0(e);var r=$e.utils.cfb_new();return cm(e).forEach(function(B){tt(r,B,jw(e,B))}),z0(r)}throw new Error("Unsupported NUMBERS file")}if(!kn(e,"[Content_Types].xml"))throw kn(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):kn(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var a=cm(e),s=pN(xn(e,"[Content_Types].xml")),i=!1,l,c;if(s.workbooks.length===0&&(c="xl/workbook.xml",nr(e,c,!0)&&s.workbooks.push(c)),s.workbooks.length===0){if(c="xl/workbook.bin",!nr(e,c,!0))throw new Error("Could not find workbook");s.workbooks.push(c),i=!0}s.workbooks[0].slice(-3)=="bin"&&(i=!0);var o={},u={};if(!t.bookSheets&&!t.bookProps){if(il=[],s.sst)try{il=BC(nr(e,bn(s.sst)),s.sst,t)}catch(B){if(t.WTF)throw B}t.cellStyles&&s.themes.length&&(o=LC(xn(e,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],t)),s.style&&(u=OC(nr(e,bn(s.style)),s.style,o,t))}s.links.map(function(B){try{var te=sl(xn(e,Ml(bn(B))),B);return WC(nr(e,bn(B)),te,B,t)}catch{}});var d=PC(nr(e,bn(s.workbooks[0])),s.workbooks[0],t),f={},x="";s.coreprops.length&&(x=nr(e,bn(s.coreprops[0]),!0),x&&(f=fg(x)),s.extprops.length!==0&&(x=nr(e,bn(s.extprops[0]),!0),x&&jN(x,f,t)));var h={};(!t.bookSheets||t.bookProps)&&s.custprops.length!==0&&(x=xn(e,bn(s.custprops[0]),!0),x&&(h=_N(x,t)));var p={};if((t.bookSheets||t.bookProps)&&(d.Sheets?l=d.Sheets.map(function(te){return te.name}):f.Worksheets&&f.SheetNames.length>0&&(l=f.SheetNames),t.bookProps&&(p.Props=f,p.Custprops=h),t.bookSheets&&typeof l<"u"&&(p.SheetNames=l),t.bookSheets?p.SheetNames:t.bookProps))return p;l={};var m={};t.bookDeps&&s.calcchain&&(m=zC(nr(e,bn(s.calcchain)),s.calcchain));var w=0,v={},b,y;{var N=d.Sheets;f.Worksheets=N.length,f.SheetNames=[];for(var A=0;A!=N.length;++A)f.SheetNames[A]=N[A].name}var k=i?"bin":"xml",_=s.workbooks[0].lastIndexOf("/"),j=(s.workbooks[0].slice(0,_+1)+"_rels/"+s.workbooks[0].slice(_+1)+".rels").replace(/^\//,"");kn(e,j)||(j="xl/_rels/workbook."+k+".rels");var P=sl(xn(e,j,!0),j.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(t.xlmeta=HC(nr(e,bn(s.metadata[0])),s.metadata[0],t)),(s.people||[]).length>=1&&(t.people=k5(nr(e,bn(s.people[0])),t)),P&&(P=dE(P,d.Sheets));var D=nr(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(w=0;w!=f.Worksheets;++w){var K="sheet";if(P&&P[w]?(b="xl/"+P[w][1].replace(/[\/]?xl\//,""),kn(e,b)||(b=P[w][1]),kn(e,b)||(b=j.replace(/_rels\/.*$/,"")+P[w][1]),K=P[w][2]):(b="xl/worksheets/sheet"+(w+1-D)+"."+k,b=b.replace(/sheet0\./,"sheet.")),y=b.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(w!=t.sheets)continue e;break;case"string":if(f.SheetNames[w].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var E=!1,Y=0;Y!=t.sheets.length;++Y)typeof t.sheets[Y]=="number"&&t.sheets[Y]==w&&(E=1),typeof t.sheets[Y]=="string"&&t.sheets[Y].toLowerCase()==f.SheetNames[w].toLowerCase()&&(E=1);if(!E)continue e}}uE(e,b,y,f.SheetNames[w],w,v,l,K,t,d,o,u)}return p={Directory:s,Workbook:d,Props:f,Custprops:h,Deps:m,Sheets:l,SheetNames:f.SheetNames,Strings:il,Styles:u,Themes:o,SSF:Mt(Xe)},t&&t.bookFiles&&(e.files?(p.keys=a,p.files=e.files):(p.keys=[],p.files={},e.FullPaths.forEach(function(B,te){B=B.replace(/^Root Entry[\/]/,""),p.keys.push(B),p.files[B]=e.FileIndex[te]}))),t&&t.bookVBA&&(s.vba.length>0?p.vbaraw=nr(e,bn(s.vba[0]),!0):s.defaults&&s.defaults.bin===P5&&(p.vbaraw=nr(e,"xl/vbaProject.bin",!0))),p}function xE(e,t){var r=t||{},a="Workbook",s=$e.find(e,a);try{if(a="/!DataSpaces/Version",s=$e.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(H4(s.content),a="/!DataSpaces/DataSpaceMap",s=$e.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);var i=V4(s.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!=="StrongEncryptionDataSpace"||i[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=$e.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);var l=G4(s.content);if(l.length!=1||l[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=$e.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);K4(s.content)}catch{}if(a="/EncryptionInfo",s=$e.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);var c=Y4(s.content);if(a="/EncryptedPackage",s=$e.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(c[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(c[1],s.content,r.password||"",r);if(c[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(c[1],s.content,r.password||"",r);throw new Error("File is password-protected")}function mE(e,t){return t.bookType=="ods"?jv(e,t):t.bookType=="numbers"?cE(e,t):t.bookType=="xlsb"?hE(e,t):pE(e,t)}function hE(e,t){ti=1024,e&&!e.SSF&&(e.SSF=Mt(Xe)),e&&e.SSF&&(Ci(),Ko(e.SSF),t.revssf=qo(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,ll?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",a=Jg.indexOf(t.bookType)>-1,s=hf();Ff(t=t||{});var i=ef(),l="",c=0;if(t.cellXfs=[],as(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),l="docProps/core.xml",tt(i,l,xg(e.Props,t)),s.coreprops.push(l),bt(t.rels,2,l,st.CORE_PROPS),l="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var o=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&o.push(e.SheetNames[u]);e.Props.SheetNames=o}for(e.Props.Worksheets=e.Props.SheetNames.length,tt(i,l,pg(e.Props)),s.extprops.push(l),bt(t.rels,3,l,st.EXT_PROPS),e.Custprops!==e.Props&&Yt(e.Custprops||{}).length>0&&(l="docProps/custom.xml",tt(i,l,gg(e.Custprops)),s.custprops.push(l),bt(t.rels,4,l,st.CUST_PROPS)),c=1;c<=e.SheetNames.length;++c){var d={"!id":{}},f=e.Sheets[e.SheetNames[c-1]],x=(f||{})["!type"]||"sheet";switch(x){case"chart":default:l="xl/worksheets/sheet"+c+"."+r,tt(i,l,VC(c-1,l,t,e,d)),s.sheets.push(l),bt(t.wbrels,-1,"worksheets/sheet"+c+"."+r,st.WS[0])}if(f){var h=f["!comments"],p=!1,m="";h&&h.length>0&&(m="xl/comments"+c+"."+r,tt(i,m,KC(h,m)),s.comments.push(m),bt(d,-1,"../comments"+c+"."+r,st.CMNT),p=!0),f["!legacy"]&&p&&tt(i,"xl/drawings/vmlDrawing"+c+".vml",Yg(c,f["!comments"])),delete f["!comments"],delete f["!legacy"]}d["!id"].rId1&&tt(i,Ml(l),oi(d))}return t.Strings!=null&&t.Strings.length>0&&(l="xl/sharedStrings."+r,tt(i,l,XC(t.Strings,l,t)),s.strs.push(l),bt(t.wbrels,-1,"sharedStrings."+r,st.SST)),l="xl/workbook."+r,tt(i,l,$C(e,l)),s.workbooks.push(l),bt(t.rels,1,l,st.WB),l="xl/theme/theme1.xml",tt(i,l,wf(e.Themes,t)),s.themes.push(l),bt(t.wbrels,-1,"theme/theme1.xml",st.THEME),l="xl/styles."+r,tt(i,l,GC(e,l,t)),s.styles.push(l),bt(t.wbrels,-1,"styles."+r,st.STY),e.vbaraw&&a&&(l="xl/vbaProject.bin",tt(i,l,e.vbaraw),s.vba.push(l),bt(t.wbrels,-1,"vbaProject.bin",st.VBA)),l="xl/metadata."+r,tt(i,l,YC(l)),s.metadata.push(l),bt(t.wbrels,-1,"metadata."+r,st.XLMETA),tt(i,"[Content_Types].xml",dg(s,t)),tt(i,"_rels/.rels",oi(t.rels)),tt(i,"xl/_rels/workbook."+r+".rels",oi(t.wbrels)),delete t.revssf,delete t.ssf,i}function pE(e,t){ti=1024,e&&!e.SSF&&(e.SSF=Mt(Xe)),e&&e.SSF&&(Ci(),Ko(e.SSF),t.revssf=qo(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,ll?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",a=Jg.indexOf(t.bookType)>-1,s=hf();Ff(t=t||{});var i=ef(),l="",c=0;if(t.cellXfs=[],as(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),l="docProps/core.xml",tt(i,l,xg(e.Props,t)),s.coreprops.push(l),bt(t.rels,2,l,st.CORE_PROPS),l="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var o=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&o.push(e.SheetNames[u]);e.Props.SheetNames=o}e.Props.Worksheets=e.Props.SheetNames.length,tt(i,l,pg(e.Props)),s.extprops.push(l),bt(t.rels,3,l,st.EXT_PROPS),e.Custprops!==e.Props&&Yt(e.Custprops||{}).length>0&&(l="docProps/custom.xml",tt(i,l,gg(e.Custprops)),s.custprops.push(l),bt(t.rels,4,l,st.CUST_PROPS));var d=["SheetJ5"];for(t.tcid=0,c=1;c<=e.SheetNames.length;++c){var f={"!id":{}},x=e.Sheets[e.SheetNames[c-1]],h=(x||{})["!type"]||"sheet";switch(h){case"chart":default:l="xl/worksheets/sheet"+c+"."+r,tt(i,l,cv(c-1,t,e,f)),s.sheets.push(l),bt(t.wbrels,-1,"worksheets/sheet"+c+"."+r,st.WS[0])}if(x){var p=x["!comments"],m=!1,w="";if(p&&p.length>0){var v=!1;p.forEach(function(b){b[1].forEach(function(y){y.T==!0&&(v=!0)})}),v&&(w="xl/threadedComments/threadedComment"+c+"."+r,tt(i,w,j5(p,d,t)),s.threadedcomments.push(w),bt(f,-1,"../threadedComments/threadedComment"+c+"."+r,st.TCMNT)),w="xl/comments"+c+"."+r,tt(i,w,qg(p)),s.comments.push(w),bt(f,-1,"../comments"+c+"."+r,st.CMNT),m=!0}x["!legacy"]&&m&&tt(i,"xl/drawings/vmlDrawing"+c+".vml",Yg(c,x["!comments"])),delete x["!comments"],delete x["!legacy"]}f["!id"].rId1&&tt(i,Ml(l),oi(f))}return t.Strings!=null&&t.Strings.length>0&&(l="xl/sharedStrings."+r,tt(i,l,Og(t.Strings,t)),s.strs.push(l),bt(t.wbrels,-1,"sharedStrings."+r,st.SST)),l="xl/workbook."+r,tt(i,l,xv(e)),s.workbooks.push(l),bt(t.rels,1,l,st.WB),l="xl/theme/theme1.xml",tt(i,l,wf(e.Themes,t)),s.themes.push(l),bt(t.wbrels,-1,"theme/theme1.xml",st.THEME),l="xl/styles."+r,tt(i,l,Vg(e,t)),s.styles.push(l),bt(t.wbrels,-1,"styles."+r,st.STY),e.vbaraw&&a&&(l="xl/vbaProject.bin",tt(i,l,e.vbaraw),s.vba.push(l),bt(t.wbrels,-1,"vbaProject.bin",st.VBA)),l="xl/metadata."+r,tt(i,l,Kg()),s.metadata.push(l),bt(t.wbrels,-1,"metadata."+r,st.XLMETA),d.length>1&&(l="xl/persons/person.xml",tt(i,l,_5(d)),s.people.push(l),bt(t.wbrels,-1,"persons/person.xml",st.PEOPLE)),tt(i,"[Content_Types].xml",dg(s,t)),tt(i,"_rels/.rels",oi(t.rels)),tt(i,"xl/_rels/workbook."+r+".rels",oi(t.wbrels)),delete t.revssf,delete t.ssf,i}function Af(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=gn(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function gE(e,t){return $e.find(e,"EncryptedPackage")?xE(e,t):gv(e,t)}function vE(e,t){var r,a=e,s=t||{};return s.type||(s.type=at&&Buffer.isBuffer(e)?"buffer":"base64"),r=B1(a,s),fE(r,s)}function _v(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Gd(e.slice(r),t);default:break e}return wi.to_workbook(e,t)}function yE(e,t){var r="",a=Af(e,t);switch(t.type){case"base64":r=gn(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=_s(e);break;default:throw new Error("Unrecognized type "+t.type)}return a[0]==239&&a[1]==187&&a[2]==191&&(r=jt(r)),t.type="binary",_v(r,t)}function bE(e,t){var r=e;return t.type=="base64"&&(r=gn(r)),r=Ia.utils.decode(1200,r.slice(2),"str"),t.type="binary",_v(r,t)}function wE(e){return e.match(/[^\x00-\x7F]/)?ta(e):e}function W0(e,t,r,a){return a?(r.type="string",wi.to_workbook(e,r)):wi.to_workbook(t,r)}function Yd(e,t){Yu();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Yd(new Uint8Array(e),(r=Mt(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var a=e,s=[0,0,0,0],i=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),ui={},r.dateNF&&(ui.dateNF=r.dateNF),r.type||(r.type=at&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=at?"buffer":"binary",a=hw(e),typeof Uint8Array<"u"&&!at&&(r.type="array")),r.type=="string"&&(i=!0,r.type="binary",r.codepage=65001,a=wE(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var l=new ArrayBuffer(3),c=new Uint8Array(l);if(c.foo="bar",!c.foo)return r=Mt(r),r.type="array",Yd(qu(a),r)}switch((s=Af(a,r))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return gE($e.read(a,r),r);break;case 9:if(s[1]<=8)return gv(a,r);break;case 60:return Gd(a,r);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return S4(a,r);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return Mg.to_workbook(a,r);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?vE(a,r):W0(e,a,r,i);case 239:return s[3]===60?Gd(a,r):W0(e,a,r,i);case 255:if(s[1]===254)return bE(a,r);if(s[1]===0&&s[2]===2&&s[3]===0)return ps.to_workbook(a,r);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return ps.to_workbook(a,r);break;case 3:case 131:case 139:case 140:return Vd.to_workbook(a,r);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return Wg.to_workbook(a,r);break;case 10:case 13:case 32:return yE(a,r);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return _4.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?Vd.to_workbook(a,r):W0(e,a,r,i)}function Sv(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return Yl(t.file,$e.write(e,{type:at?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return $e.write(e,t)}function NE(e,t){var r=Mt(t||{}),a=mE(e,r);return jE(a,r)}function jE(e,t){var r={},a=at?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=a;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=a;break;default:throw new Error("Unrecognized type "+t.type)}var s=e.FullPaths?$e.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof s=="string"){if(t.type=="binary"||t.type=="base64")return s;s=new Uint8Array(Xo(s))}return t.password&&typeof encrypt_agile<"u"?Sv(encrypt_agile(s,t.password),t):t.type==="file"?Yl(t.file,s):t.type=="string"?jt(s):s}function kE(e,t){var r=t||{},a=w6(e,r);return Sv(a,r)}function Qn(e,t,r){r||(r="");var a=r+e;switch(t.type){case"base64":return Fl(ta(a));case"binary":return ta(a);case"string":return e;case"file":return Yl(t.file,a,"utf8");case"buffer":return at?ja(a,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(a):Qn(a,{type:"binary"}).split("").map(function(s){return s.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function _E(e,t){switch(t.type){case"base64":return Fl(e);case"binary":return e;case"string":return e;case"file":return Yl(t.file,e,"binary");case"buffer":return at?ja(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Fc(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",a=0;a<e.length;++a)r+=String.fromCharCode(e[a]);return t.type=="base64"?Fl(r):t.type=="string"?jt(r):r;case"file":return Yl(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function Cv(e,t){Yu(),gC(e);var r=Mt(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var a=Cv(e,r);return r.type="array",Xo(a)}var s=0;if(r.sheet&&(typeof r.sheet=="number"?s=r.sheet:s=e.SheetNames.indexOf(r.sheet),!e.SheetNames[s]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Qn(m6(e,r),r);case"slk":case"sylk":return Qn(Ig.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"htm":case"html":return Qn(yv(e.Sheets[e.SheetNames[s]],r),r);case"txt":return _E(Ev(e.Sheets[e.SheetNames[s]],r),r);case"csv":return Qn(Pf(e.Sheets[e.SheetNames[s]],r),r,"\uFEFF");case"dif":return Qn(Mg.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"dbf":return Fc(Vd.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"prn":return Qn(wi.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"rtf":return Qn(Wg.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"eth":return Qn(Rg.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"fods":return Qn(jv(e,r),r);case"wk1":return Fc(ps.sheet_to_wk1(e.Sheets[e.SheetNames[s]],r),r);case"wk3":return Fc(ps.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),Fc(vv(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),kE(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return NE(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function SE(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function CE(e,t,r){var a={};return a.type="file",a.file=t,SE(a),Cv(e,a)}function EE(e,t,r,a,s,i,l,c){var o=Zt(r),u=c.defval,d=c.raw||!Object.prototype.hasOwnProperty.call(c,"raw"),f=!0,x=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(x,"__rowNum__",{value:r,enumerable:!1})}catch{x.__rowNum__=r}else x.__rowNum__=r;if(!l||e[r])for(var h=t.s.c;h<=t.e.c;++h){var p=l?e[r][h]:e[a[h]+o];if(p===void 0||p.t===void 0){if(u===void 0)continue;i[h]!=null&&(x[i[h]]=u);continue}var m=p.v;switch(p.t){case"z":if(m==null)break;continue;case"e":m=m==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+p.t)}if(i[h]!=null){if(m==null)if(p.t=="e"&&m===null)x[i[h]]=null;else if(u!==void 0)x[i[h]]=u;else if(d&&m===null)x[i[h]]=null;else continue;else x[i[h]]=d&&(p.t!=="n"||p.t==="n"&&c.rawNumbers!==!1)?m:wa(p,m,c);m!=null&&(f=!1)}}return{row:x,isempty:f}}function Fo(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},a=0,s=1,i=[],l=0,c="",o={s:{r:0,c:0},e:{r:0,c:0}},u=t||{},d=u.range!=null?u.range:e["!ref"];switch(u.header===1?a=1:u.header==="A"?a=2:Array.isArray(u.header)?a=3:u.header==null&&(a=0),typeof d){case"string":o=mt(d);break;case"number":o=mt(e["!ref"]),o.s.r=d;break;default:o=d}a>0&&(s=0);var f=Zt(o.s.r),x=[],h=[],p=0,m=0,w=Array.isArray(e),v=o.s.r,b=0,y={};w&&!e[v]&&(e[v]=[]);var N=u.skipHidden&&e["!cols"]||[],A=u.skipHidden&&e["!rows"]||[];for(b=o.s.c;b<=o.e.c;++b)if(!(N[b]||{}).hidden)switch(x[b]=Wt(b),r=w?e[v][b]:e[x[b]+f],a){case 1:i[b]=b-o.s.c;break;case 2:i[b]=x[b];break;case 3:i[b]=u.header[b-o.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),c=l=wa(r,null,u),m=y[l]||0,!m)y[l]=1;else{do c=l+"_"+m++;while(y[c]);y[l]=m,y[c]=1}i[b]=c}for(v=o.s.r+s;v<=o.e.r;++v)if(!(A[v]||{}).hidden){var k=EE(e,o,v,x,a,i,w,u);(k.isempty===!1||(a===1?u.blankrows!==!1:u.blankrows))&&(h[p++]=k.row)}return h.length=p,h}var nh=/"/g;function TE(e,t,r,a,s,i,l,c){for(var o=!0,u=[],d="",f=Zt(r),x=t.s.c;x<=t.e.c;++x)if(a[x]){var h=c.dense?(e[r]||[])[x]:e[a[x]+f];if(h==null)d="";else if(h.v!=null){o=!1,d=""+(c.rawNumbers&&h.t=="n"?h.v:wa(h,null,c));for(var p=0,m=0;p!==d.length;++p)if((m=d.charCodeAt(p))===s||m===i||m===34||c.forceQuotes){d='"'+d.replace(nh,'""')+'"';break}d=="ID"&&(d='"ID"')}else h.f!=null&&!h.F?(o=!1,d="="+h.f,d.indexOf(",")>=0&&(d='"'+d.replace(nh,'""')+'"')):d="";u.push(d)}return c.blankrows===!1&&o?null:u.join(l)}function Pf(e,t){var r=[],a=t??{};if(e==null||e["!ref"]==null)return"";var s=mt(e["!ref"]),i=a.FS!==void 0?a.FS:",",l=i.charCodeAt(0),c=a.RS!==void 0?a.RS:`
`,o=c.charCodeAt(0),u=new RegExp((i=="|"?"\\|":i)+"+$"),d="",f=[];a.dense=Array.isArray(e);for(var x=a.skipHidden&&e["!cols"]||[],h=a.skipHidden&&e["!rows"]||[],p=s.s.c;p<=s.e.c;++p)(x[p]||{}).hidden||(f[p]=Wt(p));for(var m=0,w=s.s.r;w<=s.e.r;++w)(h[w]||{}).hidden||(d=TE(e,s,w,f,l,o,i,a),d!=null&&(a.strip&&(d=d.replace(u,"")),(d||a.blankrows!==!1)&&r.push((m++?c:"")+d)));return delete a.dense,r.join("")}function Ev(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=Pf(e,t);return r}function FE(e){var t="",r,a="";if(e==null||e["!ref"]==null)return[];var s=mt(e["!ref"]),i="",l=[],c,o=[],u=Array.isArray(e);for(c=s.s.c;c<=s.e.c;++c)l[c]=Wt(c);for(var d=s.s.r;d<=s.e.r;++d)for(i=Zt(d),c=s.s.c;c<=s.e.c;++c)if(t=l[c]+i,r=u?(e[d]||[])[c]:e[t],a="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;a=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)a=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)a=""+r.v;else if(r.t=="b")a=r.v?"TRUE":"FALSE";else if(r.w!==void 0)a="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?a="'"+r.v:a=""+r.v}}o[o.length]=t+"="+a}return o}function Tv(e,t,r){var a=r||{},s=+!a.skipHeader,i=e||{},l=0,c=0;if(i&&a.origin!=null)if(typeof a.origin=="number")l=a.origin;else{var o=typeof a.origin=="string"?Ht(a.origin):a.origin;l=o.r,c=o.c}var u,d={s:{c:0,r:0},e:{c,r:l+t.length-1+s}};if(i["!ref"]){var f=mt(i["!ref"]);d.e.c=Math.max(d.e.c,f.e.c),d.e.r=Math.max(d.e.r,f.e.r),l==-1&&(l=f.e.r+1,d.e.r=l+t.length-1+s)}else l==-1&&(l=0,d.e.r=t.length-1+s);var x=a.header||[],h=0;t.forEach(function(m,w){Yt(m).forEach(function(v){(h=x.indexOf(v))==-1&&(x[h=x.length]=v);var b=m[v],y="z",N="",A=Ke({c:c+h,r:l+w+s});u=Wl(i,A),b&&typeof b=="object"&&!(b instanceof Date)?i[A]=b:(typeof b=="number"?y="n":typeof b=="boolean"?y="b":typeof b=="string"?y="s":b instanceof Date?(y="d",a.cellDates||(y="n",b=dr(b)),N=a.dateNF||Xe[14]):b===null&&a.nullError&&(y="e",b=0),u?(u.t=y,u.v=b,delete u.w,delete u.R,N&&(u.z=N)):i[A]=u={t:y,v:b},N&&(u.z=N))})}),d.e.c=Math.max(d.e.c,c+x.length-1);var p=Zt(l);if(s)for(h=0;h<x.length;++h)i[Wt(h+c)+p]={t:"s",v:x[h]};return i["!ref"]=et(d),i}function AE(e,t){return Tv(null,e,t)}function Wl(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var a=Ht(t);return e[a.r]||(e[a.r]=[]),e[a.r][a.c]||(e[a.r][a.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?Wl(e,Ke(t)):Wl(e,Ke({r:t,c:r||0}))}function PE(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function Df(){return{SheetNames:[],Sheets:{}}}function If(e,t,r,a){var s=1;if(!r)for(;s<=65535&&e.SheetNames.indexOf(r="Sheet"+s)!=-1;++s,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(a&&e.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);s=i&&+i[2]||0;var l=i&&i[1]||r;for(++s;s<=65535&&e.SheetNames.indexOf(r=l+s)!=-1;++s);}if(fv(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function DE(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var a=PE(e,t);switch(e.Workbook.Sheets[a]||(e.Workbook.Sheets[a]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[a].Hidden=r}function IE(e,t){return e.z=t,e}function Fv(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function ME(e,t,r){return Fv(e,"#"+t,r)}function RE(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function OE(e,t,r,a){for(var s=typeof t!="string"?t:mt(t),i=typeof t=="string"?t:et(t),l=s.s.r;l<=s.e.r;++l)for(var c=s.s.c;c<=s.e.c;++c){var o=Wl(e,l,c);o.t="n",o.F=i,delete o.v,l==s.s.r&&c==s.s.c&&(o.f=r,a&&(o.D=!0))}return e}var Ac={encode_col:Wt,encode_row:Zt,encode_cell:Ke,encode_range:et,decode_col:of,decode_row:cf,split_cell:Xw,decode_cell:Ht,decode_range:nn,format_cell:wa,sheet_add_aoa:ng,sheet_add_json:Tv,sheet_add_dom:bv,aoa_to_sheet:Ei,json_to_sheet:AE,table_to_sheet:wv,table_to_book:H6,sheet_to_csv:Pf,sheet_to_txt:Ev,sheet_to_json:Fo,sheet_to_html:yv,sheet_to_formulae:FE,sheet_to_row_object_array:Fo,sheet_get_cell:Wl,book_new:Df,book_append_sheet:If,book_set_sheet_visibility:DE,cell_set_number_format:IE,cell_set_hyperlink:Fv,cell_set_internal_link:ME,cell_add_comment:RE,sheet_set_array_formula:OE,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const LE=({companyId:e,readOnly:t=!1})=>{const[r,a]=M.useState(()=>{const G=localStorage.getItem(`performance_${e}`);return G?JSON.parse(G):[]});M.useEffect(()=>{localStorage.setItem(`performance_${e}`,JSON.stringify(r))},[r,e]);const[s,i]=M.useState(""),[l,c]=M.useState(""),[o,u]=M.useState(""),[d,f]=M.useState(""),[x,h]=M.useState(""),[p,m]=M.useState(""),[w,v]=M.useState(1),[b,y]=M.useState(10),[N,A]=M.useState(""),[k,_]=M.useState(!1),[j,P]=M.useState(!1),[D,K]=M.useState(!1),[E,Y]=M.useState(null),[B,te]=M.useState(null),[re,Q]=M.useState(!1),[Z,z]=M.useState(null),[ne,xe]=M.useState(!0),[O,R]=M.useState(!0),[g,S]=M.useState(!1),[F,ae]=M.useState(null),[ue,ve]=M.useState(1),[me,H]=M.useState(5),[T,je]=M.useState(""),[pe,Le]=M.useState(1),[Se,he]=M.useState(5),[oe,De]=M.useState(""),[Me,Ie]=M.useState(1),[Oe,He]=M.useState(!1),[Ze,pt]=M.useState(!1),[Bt,nt]=M.useState(""),gt=()=>{i(""),c(""),u(""),f(""),h(""),m(""),v(1)},Ut=()=>{console.log("Searching:",s,l,o)},Ge=()=>{te({id:"",contractNumber:"",contractType:"total",projectName:"",clientName:"",contractEffectiveDate:"",projectAmount:"",contractDescription:"",partyAContact:"",partyAContactInfo:"",partyBContact:"",partyBContactInfo:"",attachments:{wholeContract:[],contractFirstPage:[],contractMainTerms:[],contractSealPage:[],acceptanceCertificate:[],clientProof:[]},products:[],invoices:[]}),ve(1),Ie(1),He(!1),_(!0)},dt=G=>{te({...G}),ve(1),Ie(1),He(!0),P(!0)},rt=G=>{Y(G),K(!0)},ot=()=>{if(B){const G={...B,id:String(Date.now()),createdAt:new Date().toISOString()};a([...r,G]),_(!1),Ie(1)}},ir=()=>{B&&(a(r.map(G=>G.id===B.id?B:G)),P(!1),Ie(1))},se=()=>{E&&(a(r.filter(G=>G.id!==E.id)),K(!1))},ze=()=>{z({id:String(Date.now()),invoiceNumber:"",invoiceAmount:"",invoiceFile:void 0,verificationFile:void 0}),Q(!0)},Be=G=>{z({...G}),Q(!0)},kt=G=>{B&&te({...B,invoices:B.invoices.filter(Ne=>Ne.id!==G)})},_r=()=>{if(B&&Z){const G=B.invoices.findIndex(Ne=>Ne.id===Z.id);if(G>=0){const Ne=[...B.invoices];Ne[G]=Z,te({...B,invoices:Ne})}else te({...B,invoices:[...B.invoices,Z]});Q(!1),z(null)}},an=()=>{ae({id:String(Date.now()),productName:"",productSpec:"",quantity:"",unitPrice:"",totalPrice:"",remarks:""}),S(!0)},sn=G=>{ae({...G}),S(!0)},gr=G=>{if(B){const Ne=B.products.filter(Te=>Te.id!==G);te({...B,products:Ne})}},Br=()=>{if(B&&F){const G=B.products.findIndex(Ne=>Ne.id===F.id);if(G>=0){const Ne=[...B.products];Ne[G]=F,te({...B,products:Ne})}else te({...B,products:[...B.products,F]});S(!1),ae(null)}},ln=G=>{var we;const Ne=(we=G.target.files)==null?void 0:we[0];if(!Ne)return;nt("");const Te=new FileReader;Te.onload=ut=>{var vt;try{const _t=(vt=ut.target)==null?void 0:vt.result,Kr=Yd(_t,{type:"binary"}),Sa=Kr.SheetNames[0],la=Kr.Sheets[Sa],Ca=Ac.sheet_to_json(la);if(Ca.length===0){nt("Excel");return}const Ae=Ca.map((ct,Ur)=>{const Yr=String(ct.||ct.quantity||""),Mn=String(ct.||ct.unitPrice||""),Mf=parseFloat(Yr)||0,Av=parseFloat(Mn)||0,Pv=(Mf*Av).toFixed(2);return{id:String(Date.now()+Ur),productName:String(ct.||ct.productName||""),productSpec:String(ct.||ct.productSpec||""),quantity:Yr,unitPrice:Mn,totalPrice:Pv,remarks:String(ct.||ct.remarks||"")}}).filter(ct=>ct.productName);if(Ae.length===0){nt("Excel");return}B&&te({...B,products:[...B.products,...Ae]}),pt(!1),alert(` ${Ae.length} `)}catch(_t){console.error("Excel:",_t),nt("Excel")}},Te.readAsBinaryString(Ne),G.target.value=""},cn=()=>{const G=[{:"A",:"V1.0",:"10",:"5000",:""},{:"B",:"V2.0",:"5",:"8000",:""}],Ne=Ac.json_to_sheet(G),Te=Ac.book_new();Ac.book_append_sheet(Te,Ne,"");const we=[{wch:20},{wch:20},{wch:10},{wch:10},{wch:20}];Ne["!cols"]=we,CE(Te,".xlsx")},ee=(G,Ne)=>{if(B){const Te=new FileReader;Te.onloadend=()=>{const we={url:Te.result,name:Ne.name};te({...B,attachments:{...B.attachments,[G]:[...B.attachments[G],we]}})},Te.readAsDataURL(Ne)}},We=(G,Ne)=>{if(B){const Te=B.attachments[G].filter((we,ut)=>ut!==Ne);te({...B,attachments:{...B.attachments,[G]:Te}})}},Je=(G,Ne)=>{if(Z){const Te=new FileReader;Te.onloadend=()=>{z({...Z,[G]:{url:Te.result,name:Ne.name}})},Te.readAsDataURL(Ne)}},qt=G=>{Z&&z({...Z,[G]:void 0})},tr=r.filter(G=>{const Ne=!s||G.contractNumber.toLowerCase().includes(s.toLowerCase()),Te=!l||G.projectName.toLowerCase().includes(l.toLowerCase()),we=!o||G.clientName.toLowerCase().includes(o.toLowerCase()),ut=!d||parseFloat(G.projectAmount.replace(/[^\d.]/g,""))>=parseFloat(d);let vt=!0;if(x||p){const _t=G.contractEffectiveDate?new Date(G.contractEffectiveDate):null;if(_t){if(x&&p){const Kr=new Date(x),Sa=new Date(p);vt=_t>=Kr&&_t<=Sa}else if(x){const Kr=new Date(x);vt=_t>=Kr}else if(p){const Kr=new Date(p);vt=_t<=Kr}}else vt=!1}return Ne&&Te&&we&&ut&&vt}).sort((G,Ne)=>{const Te=G.createdAt?new Date(G.createdAt).getTime():0;return(Ne.createdAt?new Date(Ne.createdAt).getTime():0)-Te}),Sr=()=>{const G=(w-1)*b,Ne=G+b;return tr.slice(G,Ne)},Et=Math.ceil(tr.length/b),Rt=G=>{y(G),v(1)},ur=()=>{const G=parseInt(N);G>=1&&G<=Et&&(v(G),A(""))},lt=()=>{if(!B)return[];const G=(ue-1)*me,Ne=G+me;return B.products.slice(G,Ne)},C=B?Math.ceil(B.products.length/me):0,U=G=>{H(G),ve(1)},I=()=>{const G=parseInt(T);G>=1&&G<=C&&(ve(G),je(""))},L=B?Math.ceil(B.invoices.length/Se):1,V=()=>{if(!B)return[];const G=(pe-1)*Se;return B.invoices.slice(G,G+Se)},X=G=>{he(G),Le(1)},le=()=>{const G=parseInt(oe);G>=1&&G<=L&&(Le(G),De(""))},ge=()=>4,ie=G=>G===1?"":G===2?"":G===3?"":G===4?"":"",ce=()=>{if(!B)return!1;if(Me===1){const G=B.contractNumber&&B.projectName&&B.clientName&&B.contractEffectiveDate;return B.contractType==="total"?G&&!!B.projectAmount:G}return!0},de=()=>{const G=ge();Me<G&&ce()&&Ie(Me+1)},_e=()=>{Me>1&&Ie(Me-1)},Ce=()=>{Oe?ir():ot()},W=()=>{const G=ge(),Ne=[];for(let Te=1;Te<=G;Te++)Ne.push(n.jsxs("div",{className:"flex items-center",children:[n.jsxs("div",{className:"flex items-center",children:[n.jsx("div",{className:`flex items-center justify-center w-8 h-8 rounded-full border-2 transition-colors ${Te<Me?"bg-green-500 border-green-500 text-white":Te===Me?"bg-blue-600 border-blue-600 text-white":"bg-white border-neutral-300 text-neutral-500"}`,children:Te<Me?n.jsx($u,{className:"w-4 h-4"}):Te}),n.jsx("div",{className:"ml-2",children:n.jsx("div",{className:`text-sm font-medium ${Te===Me?"text-blue-900":"text-neutral-600"}`,children:ie(Te)})})]}),Te<G&&n.jsx(Kl,{className:"w-5 h-5 mx-4 text-neutral-400"})]},Te));return n.jsx("div",{className:"bg-neutral-50 px-6 py-4 border-b border-neutral-200",children:n.jsx("div",{className:"flex items-center justify-between",children:Ne})})},q=()=>n.jsxs("div",{className:"p-6 space-y-6",children:[n.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:n.jsx("p",{className:"text-sm text-blue-800",children:""})}),n.jsxs("div",{className:"border-b border-neutral-200 pb-4",children:[n.jsx("h4",{className:"text-sm font-semibold text-neutral-900 mb-3",children:""}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:(B==null?void 0:B.contractNumber)||"",onChange:G=>te(B?{...B,contractNumber:G.target.value}:null),placeholder:"",className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsxs("select",{value:(B==null?void 0:B.contractType)||"total",onChange:G=>te(B?{...B,contractType:G.target.value}:null),className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[n.jsx("option",{value:"total",children:""}),n.jsx("option",{value:"unit",children:""})]})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:(B==null?void 0:B.projectName)||"",onChange:G=>te(B?{...B,projectName:G.target.value}:null),placeholder:"",className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:(B==null?void 0:B.clientName)||"",onChange:G=>te(B?{...B,clientName:G.target.value}:null),placeholder:"",className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"date",value:(B==null?void 0:B.contractEffectiveDate)||"",onChange:G=>te(B?{...B,contractEffectiveDate:G.target.value}:null),className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:[" ",(B==null?void 0:B.contractType)==="total"&&n.jsx("span",{className:"text-red-500",children:"*"}),(B==null?void 0:B.contractType)==="unit"&&n.jsx("span",{className:"text-xs text-neutral-500"})]}),n.jsx("input",{type:"text",value:(B==null?void 0:B.projectAmount)||"",onChange:G=>te(B?{...B,projectAmount:G.target.value}:null),placeholder:"100",className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]})]}),n.jsxs("div",{className:"mt-4",children:[n.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:""}),n.jsx("textarea",{value:(B==null?void 0:B.contractDescription)||"",onChange:G=>te(B?{...B,contractDescription:G.target.value}:null),placeholder:"",rows:3,className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]})]}),n.jsxs("div",{children:[n.jsx("h4",{className:"text-sm font-semibold text-neutral-900 mb-3",children:""}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:""}),n.jsx("input",{type:"text",value:(B==null?void 0:B.partyAContact)||"",onChange:G=>te(B?{...B,partyAContact:G.target.value}:null),placeholder:"",className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:""}),n.jsx("input",{type:"text",value:(B==null?void 0:B.partyAContactInfo)||"",onChange:G=>te(B?{...B,partyAContactInfo:G.target.value}:null),placeholder:"",className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:""}),n.jsx("input",{type:"text",value:(B==null?void 0:B.partyBContact)||"",onChange:G=>te(B?{...B,partyBContact:G.target.value}:null),placeholder:"",className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:""}),n.jsx("input",{type:"text",value:(B==null?void 0:B.partyBContactInfo)||"",onChange:G=>te(B?{...B,partyBContactInfo:G.target.value}:null),placeholder:"",className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]})]})]})]}),J=()=>n.jsxs("div",{className:"p-6 space-y-4",children:[n.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:n.jsx("p",{className:"text-sm text-blue-800",children:""})}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("h4",{className:"text-sm font-semibold text-neutral-900",children:""}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("button",{onClick:()=>pt(!0),className:"px-3 py-1.5 text-sm bg-green-600 text-white rounded hover:bg-green-700 transition-colors flex items-center",children:[n.jsx(Gx,{className:"w-4 h-4 mr-1"}),""]}),n.jsxs("button",{onClick:an,className:"px-3 py-1.5 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors flex items-center",children:[n.jsx(Pt,{className:"w-4 h-4 mr-1"}),""]})]})]}),n.jsx("div",{className:"border border-neutral-200 rounded-lg overflow-hidden",children:n.jsxs("table",{className:"w-full",children:[n.jsx("thead",{className:"bg-neutral-50 border-b border-neutral-200",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""})]})}),n.jsx("tbody",{className:"divide-y divide-neutral-200",children:B&&lt().length===0?n.jsx("tr",{children:n.jsx("td",{colSpan:7,className:"px-4 py-8 text-center text-neutral-500",children:'""'})}):lt().map((G,Ne)=>n.jsxs("tr",{className:"hover:bg-neutral-50",children:[n.jsx("td",{className:"px-4 py-3 text-sm text-neutral-900",children:(ue-1)*me+Ne+1}),n.jsx("td",{className:"px-4 py-3 text-sm text-neutral-900",children:G.productName}),n.jsx("td",{className:"px-4 py-3 text-sm text-neutral-600",children:G.productSpec||"-"}),n.jsx("td",{className:"px-4 py-3 text-sm text-neutral-600",children:G.quantity}),n.jsx("td",{className:"px-4 py-3 text-sm text-neutral-600",children:G.unitPrice}),n.jsx("td",{className:"px-4 py-3 text-sm text-neutral-600",children:G.totalPrice}),n.jsx("td",{className:"px-4 py-3 text-sm",children:n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("button",{onClick:()=>sn(G),className:"text-primary-600 hover:text-primary-800",title:"",children:n.jsx(Dt,{className:"w-4 h-4"})}),n.jsx("button",{onClick:()=>gr(G.id),className:"text-red-600 hover:text-red-800",title:"",children:n.jsx(qe,{className:"w-4 h-4"})})]})})]},G.id))})]})}),B&&B.products.length>0&&n.jsxs("div",{className:"flex items-center justify-center gap-6 pt-3 border-t border-neutral-200",children:[n.jsxs("div",{className:"text-sm text-neutral-700",children:[" ",B.products.length," "]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("button",{onClick:()=>ve(Math.max(1,ue-1)),disabled:ue===1,className:`px-2 py-1 text-sm rounded transition-colors ${ue===1?"bg-neutral-100 text-neutral-400 cursor-not-allowed":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:"<"}),Array.from({length:Math.min(5,C)},(G,Ne)=>{let Te;return C<=5||ue<=3?Te=Ne+1:ue>=C-2?Te=C-4+Ne:Te=ue-2+Ne,n.jsx("button",{onClick:()=>ve(Te),className:`px-2.5 py-1 text-sm rounded transition-colors ${ue===Te?"bg-primary-600 text-white":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:Te},Te)}),n.jsx("button",{onClick:()=>ve(Math.min(C,ue+1)),disabled:ue===C,className:`px-2 py-1 text-sm rounded transition-colors ${ue===C?"bg-neutral-100 text-neutral-400 cursor-not-allowed":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:">"})]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsxs("select",{value:me,onChange:G=>U(Number(G.target.value)),className:"px-2 py-1 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500",children:[n.jsx("option",{value:5,children:"5/"}),n.jsx("option",{value:10,children:"10/"}),n.jsx("option",{value:20,children:"20/"})]}),n.jsx("span",{className:"text-sm text-neutral-700",children:""}),n.jsx("input",{type:"number",value:T,onChange:G=>je(G.target.value),placeholder:"",className:"w-12 px-2 py-1 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500",min:1,max:C}),n.jsx("button",{onClick:I,className:"px-3 py-1 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-50 transition-colors",children:""})]})]})]}),fe=()=>n.jsxs("div",{className:"p-6 space-y-6",children:[n.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:n.jsx("p",{className:"text-sm text-blue-800",children:""})}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-3",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"}),n.jsx("span",{className:"text-xs text-neutral-500 ml-2",children:"()"})]}),n.jsxs("div",{className:"flex items-center space-x-4",children:[n.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[n.jsx("input",{type:"checkbox",checked:ne,onChange:G=>xe(G.target.checked),className:"w-4 h-4 text-primary-600 rounded"}),n.jsx("span",{className:"text-sm font-medium text-neutral-700",children:""})]}),n.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[n.jsx("input",{type:"checkbox",checked:O,onChange:G=>R(G.target.checked),className:"w-4 h-4 text-primary-600 rounded"}),n.jsx("span",{className:"text-sm font-medium text-neutral-700",children:""})]})]})]}),ne&&n.jsxs("div",{className:"border border-neutral-200 rounded-lg p-4",children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:[" ",n.jsx("span",{className:"text-neutral-500 text-xs",children:"()"})]}),n.jsxs("div",{className:"border-2 border-dashed border-neutral-300 rounded-lg p-6 text-center hover:border-primary-500 transition-colors cursor-pointer",onClick:()=>{var G;return(G=document.getElementById("whole-contract-upload"))==null?void 0:G.click()},children:[n.jsx(St,{className:"w-8 h-8 mx-auto text-neutral-400 mb-2"}),n.jsx("p",{className:"text-sm text-neutral-600",children:""}),n.jsx("p",{className:"text-xs text-neutral-500 mt-1",children:" PDFWord "}),n.jsx("input",{id:"whole-contract-upload",type:"file",className:"hidden",accept:".pdf,.doc,.docx",multiple:!0,onChange:G=>{G.target.files&&Array.from(G.target.files).forEach(Ne=>ee("wholeContract",Ne))}})]}),B&&B.attachments.wholeContract.length>0&&n.jsxs("div",{className:"mt-3 space-y-2",children:[n.jsx("p",{className:"text-sm font-medium text-neutral-700",children:""}),B.attachments.wholeContract.map((G,Ne)=>n.jsxs("div",{className:"flex items-center justify-between bg-neutral-50 px-3 py-2 rounded",children:[n.jsxs("div",{className:"flex items-center space-x-2 flex-1 min-w-0",children:[n.jsx(Lt,{className:"w-4 h-4 text-neutral-400 flex-shrink-0"}),n.jsx("span",{className:"text-sm text-neutral-900 truncate",children:G.name})]}),n.jsx("button",{onClick:()=>We("wholeContract",Ne),className:"text-red-600 hover:text-red-800 ml-2 flex-shrink-0",children:n.jsx(qe,{className:"w-4 h-4"})})]},Ne))]})]}),O&&n.jsx("div",{className:"space-y-4",children:[{key:"contractFirstPage",label:""},{key:"contractMainTerms",label:""},{key:"contractSealPage",label:""}].map(({key:G,label:Ne})=>n.jsxs("div",{className:"border border-neutral-200 rounded-lg p-4",children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:[Ne," ",n.jsx("span",{className:"text-neutral-500 text-xs",children:"()"})]}),n.jsxs("div",{className:"border-2 border-dashed border-neutral-300 rounded-lg p-6 text-center hover:border-primary-500 transition-colors cursor-pointer",onClick:()=>{var Te;return(Te=document.getElementById(`${G}-upload`))==null?void 0:Te.click()},children:[n.jsx(St,{className:"w-8 h-8 mx-auto text-neutral-400 mb-2"}),n.jsx("p",{className:"text-sm text-neutral-600",children:""}),n.jsx("p",{className:"text-xs text-neutral-500 mt-1",children:" PDFWord "}),n.jsx("input",{id:`${G}-upload`,type:"file",className:"hidden",accept:".pdf,.doc,.docx,image/*",multiple:!0,onChange:Te=>{Te.target.files&&Array.from(Te.target.files).forEach(we=>ee(G,we))}})]}),B&&B.attachments[G].length>0&&n.jsxs("div",{className:"mt-3 space-y-2",children:[n.jsx("p",{className:"text-sm font-medium text-neutral-700",children:""}),B.attachments[G].map((Te,we)=>n.jsxs("div",{className:"flex items-center justify-between bg-neutral-50 px-3 py-2 rounded",children:[n.jsxs("div",{className:"flex items-center space-x-2 flex-1 min-w-0",children:[n.jsx(Lt,{className:"w-4 h-4 text-neutral-400 flex-shrink-0"}),n.jsx("span",{className:"text-sm text-neutral-900 truncate",children:Te.name})]}),n.jsx("button",{onClick:()=>We(G,we),className:"text-red-600 hover:text-red-800 ml-2 flex-shrink-0",children:n.jsx(qe,{className:"w-4 h-4"})})]},we))]})]},G))}),n.jsxs("div",{className:"border border-neutral-200 rounded-lg p-4",children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:[" ",n.jsx("span",{className:"text-neutral-500 text-xs",children:"()"})]}),n.jsxs("div",{className:"border-2 border-dashed border-neutral-300 rounded-lg p-6 text-center hover:border-primary-500 transition-colors cursor-pointer",onClick:()=>{var G;return(G=document.getElementById("acceptance-upload"))==null?void 0:G.click()},children:[n.jsx(St,{className:"w-8 h-8 mx-auto text-neutral-400 mb-2"}),n.jsx("p",{className:"text-sm text-neutral-600",children:""}),n.jsx("p",{className:"text-xs text-neutral-500 mt-1",children:" PDFWord "}),n.jsx("input",{id:"acceptance-upload",type:"file",className:"hidden",accept:".pdf,.doc,.docx,image/*",multiple:!0,onChange:G=>{G.target.files&&Array.from(G.target.files).forEach(Ne=>ee("acceptanceCertificate",Ne))}})]}),B&&B.attachments.acceptanceCertificate.length>0&&n.jsxs("div",{className:"mt-3 space-y-2",children:[n.jsx("p",{className:"text-sm font-medium text-neutral-700",children:""}),B.attachments.acceptanceCertificate.map((G,Ne)=>n.jsxs("div",{className:"flex items-center justify-between bg-neutral-50 px-3 py-2 rounded",children:[n.jsxs("div",{className:"flex items-center space-x-2 flex-1 min-w-0",children:[n.jsx(Lt,{className:"w-4 h-4 text-neutral-400 flex-shrink-0"}),n.jsx("span",{className:"text-sm text-neutral-900 truncate",children:G.name})]}),n.jsx("button",{onClick:()=>We("acceptanceCertificate",Ne),className:"text-red-600 hover:text-red-800 ml-2 flex-shrink-0",children:n.jsx(qe,{className:"w-4 h-4"})})]},Ne))]})]}),n.jsxs("div",{className:"border border-neutral-200 rounded-lg p-4",children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:[" ",n.jsx("span",{className:"text-neutral-500 text-xs",children:"()"})]}),n.jsxs("div",{className:"border-2 border-dashed border-neutral-300 rounded-lg p-6 text-center hover:border-primary-500 transition-colors cursor-pointer",onClick:()=>{var G;return(G=document.getElementById("client-proof-upload"))==null?void 0:G.click()},children:[n.jsx(St,{className:"w-8 h-8 mx-auto text-neutral-400 mb-2"}),n.jsx("p",{className:"text-sm text-neutral-600",children:""}),n.jsx("p",{className:"text-xs text-neutral-500 mt-1",children:" PDFWord "}),n.jsx("input",{id:"client-proof-upload",type:"file",className:"hidden",accept:".pdf,.doc,.docx,image/*",multiple:!0,onChange:G=>{G.target.files&&Array.from(G.target.files).forEach(Ne=>ee("clientProof",Ne))}})]}),B&&B.attachments.clientProof.length>0&&n.jsxs("div",{className:"mt-3 space-y-2",children:[n.jsx("p",{className:"text-sm font-medium text-neutral-700",children:""}),B.attachments.clientProof.map((G,Ne)=>n.jsxs("div",{className:"flex items-center justify-between bg-neutral-50 px-3 py-2 rounded",children:[n.jsxs("div",{className:"flex items-center space-x-2 flex-1 min-w-0",children:[n.jsx(Lt,{className:"w-4 h-4 text-neutral-400 flex-shrink-0"}),n.jsx("span",{className:"text-sm text-neutral-900 truncate",children:G.name})]}),n.jsx("button",{onClick:()=>We("clientProof",Ne),className:"text-red-600 hover:text-red-800 ml-2 flex-shrink-0",children:n.jsx(qe,{className:"w-4 h-4"})})]},Ne))]})]})]})]}),be=()=>n.jsxs("div",{className:"p-6 space-y-4",children:[n.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:n.jsx("p",{className:"text-sm text-blue-800",children:""})}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("h4",{className:"text-sm font-semibold text-neutral-900",children:""}),n.jsxs("button",{onClick:ze,className:"px-3 py-1.5 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors flex items-center",children:[n.jsx(Pt,{className:"w-4 h-4 mr-1"}),""]})]}),n.jsx("div",{className:"border border-neutral-200 rounded-lg overflow-hidden",children:n.jsxs("table",{className:"w-full",children:[n.jsx("thead",{className:"bg-neutral-50 border-b border-neutral-200",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""})]})}),n.jsx("tbody",{className:"divide-y divide-neutral-200",children:B&&B.invoices.length===0?n.jsx("tr",{children:n.jsx("td",{colSpan:5,className:"px-4 py-8 text-center text-neutral-500",children:'""'})}):V().map((G,Ne)=>n.jsxs("tr",{className:"hover:bg-neutral-50",children:[n.jsx("td",{className:"px-4 py-3 text-sm text-neutral-900",children:(pe-1)*Se+Ne+1}),n.jsx("td",{className:"px-4 py-3 text-sm text-neutral-900",children:G.invoiceNumber}),n.jsx("td",{className:"px-4 py-3 text-sm text-neutral-600",children:G.invoiceAmount}),n.jsx("td",{className:"px-4 py-3 text-sm text-neutral-600",children:G.invoiceFile?"":""}),n.jsx("td",{className:"px-4 py-3 text-sm",children:n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("button",{onClick:()=>Be(G),className:"text-primary-600 hover:text-primary-800",title:"",children:n.jsx(Dt,{className:"w-4 h-4"})}),n.jsx("button",{onClick:()=>kt(G.id),className:"text-red-600 hover:text-red-800",title:"",children:n.jsx(qe,{className:"w-4 h-4"})})]})})]},G.id))})]})}),B&&B.invoices.length>0&&n.jsxs("div",{className:"flex items-center justify-center gap-6 pt-3 border-t border-neutral-200",children:[n.jsxs("div",{className:"text-sm text-neutral-700",children:[" ",B.invoices.length," "]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("button",{onClick:()=>Le(Math.max(1,pe-1)),disabled:pe===1,className:`px-2 py-1 text-sm rounded transition-colors ${pe===1?"bg-neutral-100 text-neutral-400 cursor-not-allowed":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:"<"}),n.jsx("div",{className:"flex items-center space-x-1",children:Array.from({length:Math.min(10,L)},(G,Ne)=>{let Te;return L<=10||pe<=5?Te=Ne+1:pe>=L-4?Te=L-9+Ne:Te=pe-4+Ne,n.jsx("button",{onClick:()=>Le(Te),className:`px-2.5 py-1 text-sm rounded transition-colors ${pe===Te?"bg-primary-600 text-white":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:Te},Te)})}),n.jsx("button",{onClick:()=>Le(Math.min(L,pe+1)),disabled:pe===L,className:`px-2 py-1 text-sm rounded transition-colors ${pe===L?"bg-neutral-100 text-neutral-400 cursor-not-allowed":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:">"})]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsxs("select",{value:Se,onChange:G=>X(Number(G.target.value)),className:"px-2 py-1 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500",children:[n.jsx("option",{value:5,children:"5/"}),n.jsx("option",{value:10,children:"10/"}),n.jsx("option",{value:20,children:"20/"})]}),n.jsx("span",{className:"text-sm text-neutral-700",children:""}),n.jsx("input",{type:"number",value:oe,onChange:G=>De(G.target.value),placeholder:"",className:"w-12 px-2 py-1 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500",min:1,max:L}),n.jsx("button",{onClick:le,className:"px-3 py-1 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-50 transition-colors",children:""})]})]})]}),Re=()=>B?Me===1?q():Me===2?J():Me===3?fe():Me===4?be():null:null;return n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"bg-white rounded-lg border border-neutral-200",children:[n.jsxs("div",{className:"px-6 py-4 border-b border-neutral-200",children:[n.jsx("div",{className:"flex items-center justify-between mb-4",children:n.jsx("h2",{className:"text-lg font-medium text-neutral-900",children:""})}),n.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4",children:n.jsx("p",{className:"text-sm text-blue-700",children:""})}),n.jsxs("div",{className:"flex flex-col gap-3",children:[n.jsxs("div",{className:"flex items-center gap-3 flex-wrap",children:[n.jsx("span",{className:"text-sm text-neutral-700",children:""}),n.jsx("input",{type:"date",value:x,onChange:G=>h(G.target.value),className:"px-3 py-1.5 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500"}),n.jsx("span",{className:"text-sm text-neutral-500",children:""}),n.jsx("input",{type:"date",value:p,onChange:G=>m(G.target.value),className:"px-3 py-1.5 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500"}),n.jsx("span",{className:"text-sm text-neutral-700",children:""}),n.jsx("input",{type:"text",placeholder:"",value:s,onChange:G=>i(G.target.value),className:"w-40 px-3 py-1.5 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500"}),n.jsx("span",{className:"text-sm text-neutral-700",children:""}),n.jsx("input",{type:"text",placeholder:"",value:l,onChange:G=>c(G.target.value),className:"w-40 px-3 py-1.5 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500"}),n.jsx("span",{className:"text-sm text-neutral-700",children:""}),n.jsx("input",{type:"text",placeholder:"",value:o,onChange:G=>u(G.target.value),className:"w-40 px-3 py-1.5 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500"}),n.jsx("span",{className:"text-sm text-neutral-700",children:""}),n.jsx("input",{type:"text",placeholder:"100",value:d,onChange:G=>f(G.target.value),className:"w-32 px-3 py-1.5 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{className:"flex items-center justify-end gap-2",children:[n.jsx("button",{onClick:gt,className:"px-4 py-1.5 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-50 transition-colors",children:""}),n.jsx("button",{onClick:Ut,className:"px-4 py-1.5 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors",children:""})]})]})]}),!t&&n.jsx("div",{className:"px-6 py-3 border-b border-neutral-200",children:n.jsxs("button",{onClick:Ge,className:"px-4 py-1.5 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors flex items-center",children:[n.jsx(Pt,{className:"w-4 h-4 mr-1"}),""]})}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"w-full",children:[n.jsx("thead",{className:"bg-neutral-50 border-b border-neutral-200",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""})]})}),n.jsx("tbody",{className:"divide-y divide-neutral-200",children:Sr().length===0?n.jsx("tr",{children:n.jsx("td",{colSpan:8,className:"px-4 py-8 text-center text-neutral-500",children:""})}):Sr().map((G,Ne)=>n.jsxs("tr",{className:"hover:bg-neutral-50",children:[n.jsx("td",{className:"px-4 py-3 text-sm text-neutral-900",children:(w-1)*b+Ne+1}),n.jsx("td",{className:"px-4 py-3 text-sm text-neutral-900",children:G.contractNumber}),n.jsx("td",{className:"px-4 py-3 text-sm text-neutral-600",children:n.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded text-xs font-medium ${G.contractType==="total"?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"}`,children:G.contractType==="total"?"":""})}),n.jsx("td",{className:"px-4 py-3 text-sm text-neutral-900",children:G.projectName}),n.jsx("td",{className:"px-4 py-3 text-sm text-neutral-600",children:G.clientName}),n.jsx("td",{className:"px-4 py-3 text-sm text-neutral-600",children:G.contractEffectiveDate||"-"}),n.jsx("td",{className:"px-4 py-3 text-sm text-neutral-600",children:G.projectAmount}),n.jsx("td",{className:"px-4 py-3 text-sm",children:n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("button",{onClick:()=>dt(G),className:"text-primary-600 hover:text-primary-800",title:"",children:n.jsx(Dt,{className:"w-4 h-4"})}),!t&&n.jsx("button",{onClick:()=>rt(G),className:"text-red-600 hover:text-red-800",title:"",children:n.jsx(qe,{className:"w-4 h-4"})})]})})]},G.id))})]})}),n.jsxs("div",{className:"bg-white border-t border-neutral-200 px-6 py-3 flex items-center justify-center gap-6",children:[n.jsxs("div",{className:"text-sm text-neutral-700",children:[" ",tr.length," "]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("button",{onClick:()=>v(Math.max(1,w-1)),disabled:w===1,className:`px-2 py-1 text-sm rounded transition-colors ${w===1?"bg-neutral-100 text-neutral-400 cursor-not-allowed":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:"<"}),n.jsx("div",{className:"flex items-center space-x-1",children:Array.from({length:Math.min(10,Et)},(G,Ne)=>{let Te;return Et<=10||w<=5?Te=Ne+1:w>=Et-4?Te=Et-9+Ne:Te=w-4+Ne,n.jsx("button",{onClick:()=>v(Te),className:`px-2.5 py-1 text-sm rounded transition-colors ${w===Te?"bg-primary-600 text-white":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:Te},Te)})}),n.jsx("button",{onClick:()=>v(Math.min(Et,w+1)),disabled:w===Et,className:`px-2 py-1 text-sm rounded transition-colors ${w===Et?"bg-neutral-100 text-neutral-400 cursor-not-allowed":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:">"})]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsxs("select",{value:b,onChange:G=>Rt(Number(G.target.value)),className:"px-2 py-1 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500",children:[n.jsx("option",{value:10,children:"10/"}),n.jsx("option",{value:20,children:"20/"}),n.jsx("option",{value:50,children:"50/"})]}),n.jsx("span",{className:"text-sm text-neutral-700",children:""}),n.jsx("input",{type:"number",value:N,onChange:G=>A(G.target.value),placeholder:"",className:"w-12 px-2 py-1 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500",min:1,max:Et}),n.jsx("button",{onClick:ur,className:"px-3 py-1 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-50 transition-colors",children:""})]})]})]}),(k||j)&&B&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-5xl max-h-[90vh] flex flex-col",children:[n.jsxs("div",{className:"px-6 py-4 border-b border-neutral-200 flex items-center justify-between flex-shrink-0",children:[n.jsx("h3",{className:"text-lg font-semibold text-neutral-900",children:Oe?"":""}),n.jsx("button",{onClick:()=>{_(!1),P(!1),Ie(1)},className:"text-neutral-400 hover:text-neutral-600",children:n.jsx(Qe,{className:"w-6 h-6"})})]}),W(),n.jsx("div",{className:"flex-1 overflow-y-auto",children:Re()}),n.jsxs("div",{className:"px-6 py-4 border-t border-neutral-200 flex justify-between flex-shrink-0",children:[n.jsx("button",{onClick:_e,disabled:Me===1,className:`px-4 py-2 border border-neutral-300 text-neutral-700 rounded-lg transition-colors ${Me===1?"opacity-50 cursor-not-allowed":"hover:bg-neutral-50"}`,children:""}),n.jsxs("div",{className:"flex space-x-3",children:[n.jsx("button",{onClick:()=>{_(!1),P(!1),Ie(1)},className:"px-4 py-2 border border-neutral-300 text-neutral-700 rounded-lg hover:bg-neutral-100 transition-colors",children:""}),Me<ge()?n.jsx("button",{onClick:de,disabled:!ce(),className:`px-4 py-2 bg-primary-600 text-white rounded-lg transition-colors ${ce()?"hover:bg-primary-700":"opacity-50 cursor-not-allowed"}`,children:""}):n.jsx("button",{onClick:Ce,className:"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors",children:""})]})]})]})}),g&&F&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[60] p-4",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[n.jsxs("div",{className:"px-6 py-4 border-b border-neutral-200 flex items-center justify-between sticky top-0 bg-white",children:[n.jsx("h3",{className:"text-lg font-medium text-neutral-900",children:F.id&&(B!=null&&B.products.some(G=>G.id===F.id))?"":""}),n.jsx("button",{onClick:()=>{S(!1),ae(null)},className:"text-neutral-400 hover:text-neutral-600",children:n.jsx(Qe,{className:"w-5 h-5"})})]}),n.jsx("div",{className:"p-6 space-y-4",children:n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:F.productName,onChange:G=>ae({...F,productName:G.target.value}),placeholder:"",className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:""}),n.jsx("input",{type:"text",value:F.productSpec,onChange:G=>ae({...F,productSpec:G.target.value}),placeholder:"",className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:""}),n.jsx("input",{type:"text",value:F.quantity,onChange:G=>{const Ne=G.target.value;ae({...F,quantity:Ne});const Te=parseFloat(Ne.replace(/[^0-9.]/g,"")),we=parseFloat(F.unitPrice.replace(/[^0-9.]/g,""));if(!isNaN(Te)&&!isNaN(we)){const ut=Te*we;ae(vt=>({...vt,quantity:Ne,totalPrice:ut.toFixed(2)+""}))}},placeholder:"100",className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:""}),n.jsx("input",{type:"text",value:F.unitPrice,onChange:G=>{const Ne=G.target.value;ae({...F,unitPrice:Ne});const Te=parseFloat(F.quantity.replace(/[^0-9.]/g,"")),we=parseFloat(Ne.replace(/[^0-9.]/g,""));if(!isNaN(Te)&&!isNaN(we)){const ut=Te*we;ae(vt=>({...vt,unitPrice:Ne,totalPrice:ut.toFixed(2)+""}))}},placeholder:"5000/",className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:["",n.jsx("span",{className:"text-xs text-neutral-500 ml-2",children:"()"})]}),n.jsx("input",{type:"text",value:F.totalPrice,onChange:G=>ae({...F,totalPrice:G.target.value}),placeholder:"50",className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 bg-neutral-50"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:""}),n.jsx("input",{type:"text",value:F.remarks,onChange:G=>ae({...F,remarks:G.target.value}),placeholder:"",className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]})]})}),n.jsxs("div",{className:"px-6 py-4 bg-neutral-50 flex justify-end gap-2 rounded-b-lg sticky bottom-0",children:[n.jsx("button",{onClick:()=>{S(!1),ae(null)},className:"px-4 py-2 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-100 transition-colors",children:""}),n.jsx("button",{onClick:Br,disabled:!F.productName||!F.quantity||!F.unitPrice||!F.totalPrice,className:"px-4 py-2 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:""})]})]})}),Ze&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[60] p-4",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-lg w-full",children:[n.jsxs("div",{className:"px-6 py-4 border-b border-neutral-200 flex items-center justify-between",children:[n.jsx("h3",{className:"text-lg font-medium text-neutral-900",children:""}),n.jsx("button",{onClick:()=>{pt(!1),nt("")},className:"text-neutral-400 hover:text-neutral-600",children:n.jsx(Qe,{className:"w-5 h-5"})})]}),n.jsxs("div",{className:"p-6 space-y-4",children:[n.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[n.jsx("h4",{className:"text-sm font-semibold text-blue-900 mb-2",children:""}),n.jsxs("ul",{className:"text-sm text-blue-800 space-y-1 list-disc list-inside",children:[n.jsx("li",{children:""}),n.jsx("li",{children:""}),n.jsx("li",{children:".xlsx, .xls"}),n.jsx("li",{children:""})]})]}),n.jsx("div",{className:"flex items-center justify-center gap-3",children:n.jsxs("button",{onClick:cn,className:"flex items-center gap-2 px-4 py-2 text-sm bg-neutral-100 text-neutral-700 rounded-lg hover:bg-neutral-200 transition-colors",children:[n.jsx(js,{className:"w-4 h-4"}),""]})}),n.jsx("div",{className:"border-2 border-dashed border-neutral-300 rounded-lg p-8",children:n.jsxs("label",{className:"flex flex-col items-center cursor-pointer hover:border-primary-500 transition-colors",children:[n.jsx(Gx,{className:"w-12 h-12 text-neutral-400 mb-3"}),n.jsx("span",{className:"text-sm font-medium text-neutral-700 mb-1",children:"Excel"}),n.jsx("span",{className:"text-xs text-neutral-500",children:" .xlsx, .xls "}),n.jsx("input",{type:"file",accept:".xlsx,.xls",onChange:ln,className:"hidden"})]})}),Bt&&n.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:n.jsx("p",{className:"text-sm text-red-800",children:Bt})}),n.jsxs("div",{className:"bg-neutral-50 border border-neutral-200 rounded-lg p-3",children:[n.jsx("h5",{className:"text-xs font-semibold text-neutral-700 mb-2",children:"Excel"}),n.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs text-neutral-600",children:[n.jsx("div",{children:"  ()"}),n.jsx("div",{children:" "}),n.jsx("div",{children:"  ()"}),n.jsx("div",{children:"  ()"}),n.jsx("div",{children:" "})]})]})]}),n.jsx("div",{className:"px-6 py-4 bg-neutral-50 flex justify-end gap-2 rounded-b-lg",children:n.jsx("button",{onClick:()=>{pt(!1),nt("")},className:"px-4 py-2 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-100 transition-colors",children:""})})]})}),re&&Z&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[60] p-4",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[n.jsxs("div",{className:"px-6 py-4 border-b border-neutral-200 flex items-center justify-between sticky top-0 bg-white",children:[n.jsx("h3",{className:"text-lg font-medium text-neutral-900",children:Z.id&&(B!=null&&B.invoices.some(G=>G.id===Z.id))?"":""}),n.jsx("button",{onClick:()=>{Q(!1),z(null)},className:"text-neutral-400 hover:text-neutral-600",children:n.jsx(Qe,{className:"w-5 h-5"})})]}),n.jsxs("div",{className:"p-6 space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:Z.invoiceNumber,onChange:G=>z({...Z,invoiceNumber:G.target.value}),placeholder:"",className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:Z.invoiceAmount,onChange:G=>z({...Z,invoiceAmount:G.target.value}),placeholder:"10",className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:""}),n.jsxs("div",{className:"border-2 border-dashed border-neutral-300 rounded-lg p-6 text-center hover:border-primary-500 transition-colors cursor-pointer",onClick:()=>{var G;return(G=document.getElementById("invoice-file-upload"))==null?void 0:G.click()},children:[n.jsx(St,{className:"w-8 h-8 mx-auto text-neutral-400 mb-2"}),n.jsx("p",{className:"text-sm text-neutral-600",children:""}),n.jsx("p",{className:"text-xs text-neutral-500 mt-1",children:" PDF "}),n.jsx("input",{id:"invoice-file-upload",type:"file",className:"hidden",accept:".pdf,image/*",onChange:G=>{var Ne;return((Ne=G.target.files)==null?void 0:Ne[0])&&Je("invoiceFile",G.target.files[0])}})]}),Z.invoiceFile&&n.jsxs("div",{className:"mt-3",children:[n.jsx("p",{className:"text-sm font-medium text-neutral-700 mb-2",children:""}),n.jsxs("div",{className:"flex items-center justify-between bg-neutral-50 px-3 py-2 rounded",children:[n.jsxs("div",{className:"flex items-center space-x-2 flex-1 min-w-0",children:[n.jsx(Lt,{className:"w-4 h-4 text-neutral-400 flex-shrink-0"}),n.jsx("span",{className:"text-sm text-neutral-900 truncate",children:Z.invoiceFile.name})]}),n.jsx("button",{onClick:()=>qt("invoiceFile"),className:"text-red-600 hover:text-red-800 ml-2 flex-shrink-0",children:n.jsx(qe,{className:"w-4 h-4"})})]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:""}),n.jsxs("div",{className:"border-2 border-dashed border-neutral-300 rounded-lg p-6 text-center hover:border-primary-500 transition-colors cursor-pointer",onClick:()=>{var G;return(G=document.getElementById("verification-file-upload"))==null?void 0:G.click()},children:[n.jsx(St,{className:"w-8 h-8 mx-auto text-neutral-400 mb-2"}),n.jsx("p",{className:"text-sm text-neutral-600",children:""}),n.jsx("p",{className:"text-xs text-neutral-500 mt-1",children:" PDF "}),n.jsx("input",{id:"verification-file-upload",type:"file",className:"hidden",accept:".pdf,image/*",onChange:G=>{var Ne;return((Ne=G.target.files)==null?void 0:Ne[0])&&Je("verificationFile",G.target.files[0])}})]}),Z.verificationFile&&n.jsxs("div",{className:"mt-3",children:[n.jsx("p",{className:"text-sm font-medium text-neutral-700 mb-2",children:""}),n.jsxs("div",{className:"flex items-center justify-between bg-neutral-50 px-3 py-2 rounded",children:[n.jsxs("div",{className:"flex items-center space-x-2 flex-1 min-w-0",children:[n.jsx(Lt,{className:"w-4 h-4 text-neutral-400 flex-shrink-0"}),n.jsx("span",{className:"text-sm text-neutral-900 truncate",children:Z.verificationFile.name})]}),n.jsx("button",{onClick:()=>qt("verificationFile"),className:"text-red-600 hover:text-red-800 ml-2 flex-shrink-0",children:n.jsx(qe,{className:"w-4 h-4"})})]})]})]})]}),n.jsxs("div",{className:"px-6 py-4 bg-neutral-50 flex justify-end gap-2 rounded-b-lg sticky bottom-0",children:[n.jsx("button",{onClick:()=>{Q(!1),z(null)},className:"px-4 py-2 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-100 transition-colors",children:""}),n.jsx("button",{onClick:_r,disabled:!Z.invoiceNumber||!Z.invoiceAmount,className:"px-4 py-2 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:""})]})]})}),D&&E&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full",children:[n.jsx("div",{className:"px-6 py-4 border-b border-neutral-200",children:n.jsx("h3",{className:"text-lg font-medium text-neutral-900",children:""})}),n.jsx("div",{className:"p-6",children:n.jsxs("div",{className:"flex items-start space-x-3",children:[n.jsx(Kn,{className:"w-6 h-6 text-red-600 flex-shrink-0 mt-0.5"}),n.jsxs("div",{children:[n.jsxs("p",{className:"text-sm text-neutral-700",children:[" ",n.jsx("strong",{children:E.projectName})," "]}),n.jsx("p",{className:"text-sm text-neutral-500 mt-1",children:""})]})]})}),n.jsxs("div",{className:"px-6 py-4 bg-neutral-50 flex justify-end gap-2 rounded-b-lg",children:[n.jsx("button",{onClick:()=>K(!1),className:"px-4 py-2 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-100 transition-colors",children:""}),n.jsx("button",{onClick:se,className:"px-4 py-2 text-sm bg-red-600 text-white rounded hover:bg-red-700 transition-colors",children:""})]})]})})]})},BE=({companyId:e,readOnly:t=!1})=>{const[r,a]=M.useState(()=>{const ee=localStorage.getItem(`personnel_${e}`);return ee?JSON.parse(ee):[{id:"1",name:"",gender:"",idNumber:"110101199001011234",idValidUntil:"2030-01-01",isLegalPerson:!0,isAuthorizedRepresentative:!0,phone:"13800138000",position:"",status:"active",projectExperience:"",idCardFront:null,idCardBack:null,certificates:[{id:"1",name:"",certNumber:"20150001234",issuingOrganization:"",issueDate:"2015-07-01",attachments:[{url:"",name:".pdf",size:1024e3}]}],qualifications:[{id:"1",name:"",certNumber:"JZS2020001234",issuingOrganization:"",issueDate:"2020-05-15",validUntil:"2026-05-15",attachments:[{url:"",name:".pdf",size:2048e3}]}],createdAt:new Date().toISOString()}]});M.useEffect(()=>{localStorage.setItem(`personnel_${e}`,JSON.stringify(r))},[r,e]);const[s,i]=M.useState(""),[l,c]=M.useState("all"),[o,u]=M.useState("all"),[d,f]=M.useState(1),[x,h]=M.useState(10),[p,m]=M.useState(""),[w,v]=M.useState(!1),[b,y]=M.useState(!1),[N,A]=M.useState(!1),[k,_]=M.useState(null),[j,P]=M.useState(null),[D,K]=M.useState(!1),[E,Y]=M.useState(null),[B,te]=M.useState(!1),[re,Q]=M.useState(null),[Z,z]=M.useState(1),[ne,xe]=M.useState(!1),O=50*1024*1024,R=ee=>({active:"",resigned:""})[ee]||ee,g=ee=>({active:"text-green-600 bg-green-50",resigned:"text-neutral-600 bg-neutral-50",suspended:"text-red-600 bg-red-50"})[ee]||"text-neutral-600 bg-neutral-50",S=ee=>({status:"",color:"text-green-600"}),F=()=>{i(""),c("all"),u("all"),f(1)},ae=()=>{console.log("Searching:",s,l,o)},ue=()=>{P({id:"",name:"",gender:"",idNumber:"",idValidUntil:"",isLegalPerson:!1,isAuthorizedRepresentative:!1,phone:"",position:"",status:"active",projectExperience:"",idCardFront:null,idCardBack:null,certificates:[],qualifications:[]}),z(1),xe(!1),v(!0)},ve=ee=>{P({...ee}),z(1),xe(!0),y(!0)},me=ee=>{_(ee),A(!0)},H=()=>{if(j){const ee={...j,id:String(Date.now()),createdAt:new Date().toISOString()};a([...r,ee]),v(!1),z(1)}},T=()=>{j&&(a(r.map(ee=>ee.id===j.id?j:ee)),y(!1),z(1))},je=()=>{k&&(a(r.filter(ee=>ee.id!==k.id)),A(!1))},pe=ee=>{const We=document.createElement("input");We.type="file",We.accept="image/jpeg,image/png,image/jpg",We.onchange=async Je=>{var Sr;const tr=(Sr=Je.target.files)==null?void 0:Sr[0];if(tr&&j){if(tr.size>O){alert(` "${tr.name}" 50MB`);return}const Et=new FileReader;Et.onload=Rt=>{var C;const lt={url:(C=Rt.target)==null?void 0:C.result,name:tr.name,size:tr.size};if(ee==="front"){const U=!j.idCardFront;P({...j,idCardFront:lt}),U&&setTimeout(()=>{P(I=>I&&{...I,name:"",gender:"",idNumber:"110101199001011234"})},800)}else{const U=!j.idCardBack;P({...j,idCardBack:lt}),U&&setTimeout(()=>{P(I=>I&&{...I,idValidUntil:"2030-12-31"})},800)}},Et.readAsDataURL(tr)}},We.click()},Le=ee=>{j&&P(ee==="front"?{...j,idCardFront:null}:{...j,idCardBack:null})},Se=()=>{Y({id:"",name:"",certNumber:"",issuingOrganization:"",issueDate:"",attachments:[]}),K(!0)},he=ee=>{Y({...ee}),K(!0)},oe=ee=>{j&&P({...j,certificates:j.certificates.filter(We=>We.id!==ee)})},De=()=>{if(j&&E){if(E.id)P({...j,certificates:j.certificates.map(ee=>ee.id===E.id?E:ee)});else{const ee={...E,id:String(Date.now())};P({...j,certificates:[...j.certificates,ee]})}K(!1),Y(null)}},Me=(ee,We)=>{E&&Y({...E,[ee]:We})},Ie=()=>{const ee=document.createElement("input");ee.type="file",ee.accept="image/jpeg,image/png,image/jpg,application/pdf",ee.multiple=!0,ee.onchange=async We=>{const qt=We.target.files;if(qt&&E){const Sr=Array.from(qt).filter(Rt=>Rt.size>O?(alert(` "${Rt.name}" 50MB`),!1):!0).map(Rt=>new Promise(ur=>{const lt=new FileReader;lt.onload=C=>{var U;ur({url:(U=C.target)==null?void 0:U.result,name:Rt.name,size:Rt.size})},lt.readAsDataURL(Rt)})),Et=await Promise.all(Sr);Y({...E,attachments:[...E.attachments,...Et]})}},ee.click()},Oe=ee=>{E&&Y({...E,attachments:E.attachments.filter((We,Je)=>Je!==ee)})},He=()=>{Q({id:"",name:"",certNumber:"",issuingOrganization:"",issueDate:"",validUntil:"",attachments:[]}),te(!0)},Ze=ee=>{Q({...ee}),te(!0)},pt=ee=>{j&&P({...j,qualifications:j.qualifications.filter(We=>We.id!==ee)})},Bt=()=>{if(j&&re){if(re.id)P({...j,qualifications:j.qualifications.map(ee=>ee.id===re.id?re:ee)});else{const ee={...re,id:String(Date.now())};P({...j,qualifications:[...j.qualifications,ee]})}te(!1),Q(null)}},nt=(ee,We)=>{re&&Q({...re,[ee]:We})},gt=()=>{const ee=document.createElement("input");ee.type="file",ee.accept="image/jpeg,image/png,image/jpg,application/pdf",ee.multiple=!0,ee.onchange=async We=>{const qt=We.target.files;if(qt&&re){const Sr=Array.from(qt).filter(Rt=>Rt.size>O?(alert(` "${Rt.name}" 50MB`),!1):!0).map(Rt=>new Promise(ur=>{const lt=new FileReader;lt.onload=C=>{var U;ur({url:(U=C.target)==null?void 0:U.result,name:Rt.name,size:Rt.size})},lt.readAsDataURL(Rt)})),Et=await Promise.all(Sr);Q({...re,attachments:[...re.attachments,...Et]})}},ee.click()},Ut=ee=>{re&&Q({...re,attachments:re.attachments.filter((We,Je)=>Je!==ee)})},Ge=r.filter(ee=>{const We=!s||ee.name.toLowerCase().includes(s.toLowerCase()),Je=l==="all"||ee.status===l,qt=o==="all"||o==="yes"&&ee.isLegalPerson||o==="no"&&!ee.isLegalPerson;return We&&Je&&qt}).sort((ee,We)=>{const Je=ee.createdAt?new Date(ee.createdAt).getTime():0;return(We.createdAt?new Date(We.createdAt).getTime():0)-Je}),dt=()=>{const ee=(d-1)*x,We=ee+x;return Ge.slice(ee,We)},rt=Math.ceil(Ge.length/x),ot=ee=>{h(ee),f(1)},ir=()=>{const ee=parseInt(p);ee>=1&&ee<=rt&&(f(ee),m(""))},se=()=>3,ze=ee=>ee===1?"":ee===2?"":ee===3?"":"",Be=()=>j?Z===1?!!(j.name&&j.idNumber&&j.idValidUntil&&j.phone&&j.idCardFront&&j.idCardBack):!0:!1,kt=()=>{const ee=se();Z<ee&&Be()&&z(Z+1)},_r=()=>{Z>1&&z(Z-1)},an=()=>{ne?T():H()},sn=()=>{const ee=se(),We=[];for(let Je=1;Je<=ee;Je++)We.push(n.jsxs("div",{className:"flex items-center",children:[n.jsxs("div",{className:"flex items-center",children:[n.jsx("div",{className:`flex items-center justify-center w-8 h-8 rounded-full border-2 transition-colors ${Je<Z?"bg-green-500 border-green-500 text-white":Je===Z?"bg-blue-600 border-blue-600 text-white":"bg-white border-neutral-300 text-neutral-500"}`,children:Je<Z?n.jsx($u,{className:"w-4 h-4"}):Je}),n.jsx("div",{className:"ml-2",children:n.jsx("div",{className:`text-sm font-medium ${Je===Z?"text-blue-900":"text-neutral-600"}`,children:ze(Je)})})]}),Je<ee&&n.jsx(Kl,{className:"w-5 h-5 mx-4 text-neutral-400"})]},Je));return n.jsx("div",{className:"bg-neutral-50 px-6 py-4 border-b border-neutral-200",children:n.jsx("div",{className:"flex items-center justify-between",children:We})})},gr=()=>n.jsxs("div",{className:"p-6 space-y-6",children:[n.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:n.jsx("p",{className:"text-sm text-blue-800",children:":"})}),n.jsxs("div",{className:"border-b border-neutral-200 pb-4",children:[n.jsx("h4",{className:"text-sm font-semibold text-neutral-900 mb-3",children:""}),n.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:(j==null?void 0:j.name)||"",onChange:ee=>P(j?{...j,name:ee.target.value}:null),placeholder:"",className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsxs("select",{value:(j==null?void 0:j.gender)||"",onChange:ee=>P(j?{...j,gender:ee.target.value}:null),className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[n.jsx("option",{value:"",children:""}),n.jsx("option",{value:"",children:""})]})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:(j==null?void 0:j.idNumber)||"",onChange:ee=>P(j?{...j,idNumber:ee.target.value}:null),placeholder:"",maxLength:18,className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"date",value:(j==null?void 0:j.idValidUntil)||"",onChange:ee=>P(j?{...j,idValidUntil:ee.target.value}:null),className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"tel",value:(j==null?void 0:j.phone)||"",onChange:ee=>P(j?{...j,phone:ee.target.value}:null),placeholder:"",className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsxs("select",{value:(j==null?void 0:j.status)||"active",onChange:ee=>P(j?{...j,status:ee.target.value}:null),className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[n.jsx("option",{value:"active",children:""}),n.jsx("option",{value:"resigned",children:""})]})]}),n.jsx("div",{className:"col-span-3 flex gap-6",children:n.jsxs("label",{className:"flex items-center space-x-2",children:[n.jsx("input",{type:"checkbox",checked:(j==null?void 0:j.isLegalPerson)||!1,onChange:ee=>P(j?{...j,isLegalPerson:ee.target.checked}:null),className:"w-4 h-4 text-primary-600 border-neutral-300 rounded focus:ring-primary-500"}),n.jsx("span",{className:"text-sm font-medium text-neutral-700",children:""})]})})]})]}),n.jsxs("div",{children:[n.jsx("h4",{className:"text-sm font-semibold text-neutral-900 mb-3",children:""}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),j!=null&&j.idCardFront?n.jsxs("div",{className:"relative",children:[n.jsx("img",{src:j.idCardFront.url,alt:"",className:"w-full h-48 object-cover rounded-lg border border-neutral-200"}),n.jsx("button",{onClick:()=>Le("front"),className:"absolute top-2 right-2 bg-red-600 text-white p-1.5 rounded-full hover:bg-red-700 transition-colors shadow-lg",children:n.jsx(qe,{className:"w-4 h-4"})}),n.jsx("div",{className:"mt-2 text-xs text-neutral-600 truncate",children:j.idCardFront.name})]}):n.jsxs("div",{className:"border-2 border-dashed border-neutral-300 rounded-lg p-4 text-center hover:border-primary-500 transition-colors cursor-pointer",onClick:()=>pe("front"),children:[n.jsx(St,{className:"w-6 h-6 mx-auto text-neutral-400 mb-1"}),n.jsx("p",{className:"text-xs text-neutral-600",children:""}),n.jsx("p",{className:"text-xs text-neutral-500 mt-0.5",children:"JPGPNGJPEG"})]})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),j!=null&&j.idCardBack?n.jsxs("div",{className:"relative",children:[n.jsx("img",{src:j.idCardBack.url,alt:"",className:"w-full h-48 object-cover rounded-lg border border-neutral-200"}),n.jsx("button",{onClick:()=>Le("back"),className:"absolute top-2 right-2 bg-red-600 text-white p-1.5 rounded-full hover:bg-red-700 transition-colors shadow-lg",children:n.jsx(qe,{className:"w-4 h-4"})}),n.jsx("div",{className:"mt-2 text-xs text-neutral-600 truncate",children:j.idCardBack.name})]}):n.jsxs("div",{className:"border-2 border-dashed border-neutral-300 rounded-lg p-4 text-center hover:border-primary-500 transition-colors cursor-pointer",onClick:()=>pe("back"),children:[n.jsx(St,{className:"w-6 h-6 mx-auto text-neutral-400 mb-1"}),n.jsx("p",{className:"text-xs text-neutral-600",children:""}),n.jsx("p",{className:"text-xs text-neutral-500 mt-0.5",children:"JPGPNGJPEG"})]})]})]})]})]}),Br=()=>n.jsxs("div",{className:"p-6 space-y-6",children:[n.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:n.jsx("p",{className:"text-sm text-blue-800",children:","})}),n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center justify-between mb-3",children:[n.jsx("h4",{className:"text-sm font-semibold text-neutral-900",children:""}),n.jsxs("button",{onClick:Se,className:"px-3 py-1.5 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors flex items-center",children:[n.jsx(Pt,{className:"w-4 h-4 mr-1"}),""]})]}),j&&j.certificates.length>0?n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"w-full border border-neutral-200 rounded-lg",children:[n.jsx("thead",{className:"bg-neutral-50",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600 border-b",children:""}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600 border-b",children:""}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600 border-b",children:""}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600 border-b",children:""}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600 border-b",children:""})]})}),n.jsx("tbody",{children:j.certificates.map((ee,We)=>n.jsxs("tr",{className:"hover:bg-neutral-50",children:[n.jsx("td",{className:"px-4 py-2.5 text-sm text-neutral-900",children:We+1}),n.jsx("td",{className:"px-4 py-2.5 text-sm text-neutral-900",children:ee.name}),n.jsx("td",{className:"px-4 py-2.5 text-sm text-neutral-900",children:ee.certNumber}),n.jsx("td",{className:"px-4 py-2.5 text-sm text-neutral-900",children:ee.issuingOrganization}),n.jsx("td",{className:"px-4 py-2.5 text-sm",children:n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("button",{onClick:()=>he(ee),className:"text-primary-600 hover:text-primary-800",children:n.jsx(Dt,{className:"w-4 h-4"})}),n.jsx("button",{onClick:()=>oe(ee.id),className:"text-red-600 hover:text-red-800",children:n.jsx(qe,{className:"w-4 h-4"})})]})})]},ee.id))})]})}):n.jsx("div",{className:"text-center py-8 text-neutral-500 border border-dashed border-neutral-300 rounded-lg",children:""})]})]}),ln=()=>n.jsxs("div",{className:"p-6 space-y-6",children:[n.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:n.jsx("p",{className:"text-sm text-blue-800",children:","})}),n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center justify-between mb-3",children:[n.jsx("h4",{className:"text-sm font-semibold text-neutral-900",children:""}),n.jsxs("button",{onClick:He,className:"px-3 py-1.5 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors flex items-center",children:[n.jsx(Pt,{className:"w-4 h-4 mr-1"}),""]})]}),j&&j.qualifications.length>0?n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"w-full border border-neutral-200 rounded-lg",children:[n.jsx("thead",{className:"bg-neutral-50",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600 border-b",children:""}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600 border-b",children:""}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600 border-b",children:""}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600 border-b",children:""}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600 border-b",children:""})]})}),n.jsx("tbody",{children:j.qualifications.map((ee,We)=>n.jsxs("tr",{className:"hover:bg-neutral-50",children:[n.jsx("td",{className:"px-4 py-2.5 text-sm text-neutral-900",children:We+1}),n.jsx("td",{className:"px-4 py-2.5 text-sm text-neutral-900",children:ee.name}),n.jsx("td",{className:"px-4 py-2.5 text-sm text-neutral-900",children:ee.certNumber}),n.jsx("td",{className:"px-4 py-2.5 text-sm text-neutral-900",children:ee.issuingOrganization}),n.jsx("td",{className:"px-4 py-2.5 text-sm",children:n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("button",{onClick:()=>Ze(ee),className:"text-primary-600 hover:text-primary-800",children:n.jsx(Dt,{className:"w-4 h-4"})}),n.jsx("button",{onClick:()=>pt(ee.id),className:"text-red-600 hover:text-red-800",children:n.jsx(qe,{className:"w-4 h-4"})})]})})]},ee.id))})]})}):n.jsx("div",{className:"text-center py-8 text-neutral-500 border border-dashed border-neutral-300 rounded-lg",children:""})]})]}),cn=ee=>j?n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-6xl w-full max-h-[90vh] overflow-y-auto",children:[n.jsxs("div",{className:"px-6 py-4 border-b border-neutral-200 flex items-center justify-between sticky top-0 bg-white z-10",children:[n.jsx("h3",{className:"text-lg font-medium text-neutral-900",children:ee?"":""}),n.jsx("button",{onClick:()=>{ee?y(!1):v(!1),z(1)},className:"text-neutral-400 hover:text-neutral-600 transition-colors",children:n.jsx(Qe,{className:"w-5 h-5"})})]}),sn(),n.jsxs("div",{className:"overflow-y-auto",style:{maxHeight:"calc(90vh - 200px)"},children:[Z===1&&gr(),Z===2&&Br(),Z===3&&ln()]}),n.jsxs("div",{className:"px-6 py-4 bg-neutral-50 flex justify-between gap-2 rounded-b-lg sticky bottom-0 border-t border-neutral-200",children:[n.jsx("div",{children:Z>1&&n.jsx("button",{onClick:_r,className:"px-4 py-2 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-100 transition-colors",children:""})}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx("button",{onClick:()=>{ee?y(!1):v(!1),z(1)},className:"px-4 py-2 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-100 transition-colors",children:""}),Z<se()?n.jsx("button",{onClick:kt,disabled:!Be(),className:`px-4 py-2 text-sm rounded transition-colors ${Be()?"bg-primary-600 text-white hover:bg-primary-700":"bg-neutral-300 text-neutral-500 cursor-not-allowed"}`,children:""}):n.jsx("button",{onClick:an,className:"px-4 py-2 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors",children:""})]})]})]})}):null;return n.jsxs("div",{className:"flex flex-col h-full",children:[t&&n.jsx("div",{className:"px-6 py-3 bg-yellow-50 border-b border-yellow-200",children:n.jsxs("p",{className:"text-sm text-yellow-800",children:[n.jsx(Kn,{className:"w-4 h-4 inline mr-2"})," - "]})}),n.jsx("div",{className:"flex-1 overflow-auto",children:n.jsxs("div",{className:"bg-white rounded-lg border border-neutral-200",children:[n.jsxs("div",{className:"px-6 py-4 border-b border-neutral-200",children:[n.jsx("div",{className:"flex items-center justify-between mb-4",children:n.jsx("h2",{className:"text-lg font-medium text-neutral-900",children:""})}),n.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4",children:n.jsx("p",{className:"text-sm text-blue-700",children:""})}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex items-center gap-3 flex-wrap",children:["",n.jsx("input",{type:"text",placeholder:"",value:s,onChange:ee=>i(ee.target.value),className:"w-40 px-3 py-1.5 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500"}),"",n.jsxs("select",{value:l,onChange:ee=>c(ee.target.value),className:"px-3 py-1.5 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500",children:[n.jsx("option",{value:"all",children:""}),n.jsx("option",{value:"active",children:""}),n.jsx("option",{value:"resigned",children:""})]}),"",n.jsxs("select",{value:o,onChange:ee=>u(ee.target.value),className:"px-3 py-1.5 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500",children:[n.jsx("option",{value:"all",children:""}),n.jsx("option",{value:"yes",children:""}),n.jsx("option",{value:"no",children:""})]})]}),n.jsxs("div",{className:"flex justify-end gap-2",children:[n.jsx("button",{onClick:F,className:"px-4 py-1.5 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-50 transition-colors",children:""}),n.jsx("button",{onClick:ae,className:"px-4 py-1.5 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors",children:""})]})]})]}),!t&&n.jsx("div",{className:"px-6 py-3 border-b border-neutral-200",children:n.jsxs("button",{onClick:ue,className:"px-4 py-1.5 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors flex items-center",children:[n.jsx(Pt,{className:"w-4 h-4 mr-1"}),""]})}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"w-full",children:[n.jsx("thead",{className:"bg-neutral-50 border-b border-neutral-200",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""})]})}),n.jsx("tbody",{className:"divide-y divide-neutral-200",children:dt().length===0?n.jsx("tr",{children:n.jsx("td",{colSpan:9,className:"px-4 py-8 text-center text-neutral-500",children:""})}):dt().map((ee,We)=>{const Je=S();return n.jsxs("tr",{className:"hover:bg-neutral-50 transition-colors",children:[n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm text-neutral-900",children:(d-1)*x+We+1}),n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm text-neutral-900",children:ee.name}),n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm text-neutral-900",children:ee.gender}),n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm text-neutral-900",children:ee.phone}),n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm text-neutral-900",children:ee.isLegalPerson?"":""}),n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm",children:n.jsx("span",{className:`inline-flex px-2 py-0.5 rounded-full text-xs font-medium ${g(ee.status)}`,children:R(ee.status)})}),n.jsxs("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm text-neutral-900",children:[ee.certificates.length+ee.qualifications.length," "]}),n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm",children:n.jsx("span",{className:Je.color,children:Je.status})}),n.jsxs("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm",children:[!t&&n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsxs("button",{onClick:()=>ve(ee),className:"px-2 py-1 text-xs text-primary-600 hover:text-primary-800 hover:bg-primary-50 rounded transition-colors flex items-center gap-1",children:[n.jsx(Dt,{className:"w-3.5 h-3.5"}),""]}),n.jsxs("button",{onClick:()=>me(ee),className:"px-2 py-1 text-xs text-red-600 hover:text-red-800 hover:bg-red-50 rounded transition-colors flex items-center gap-1",children:[n.jsx(qe,{className:"w-3.5 h-3.5"}),""]})]}),t&&n.jsx("span",{className:"text-xs text-neutral-400",children:""})]})]},ee.id)})})]})}),n.jsxs("div",{className:"bg-white border-t border-neutral-200 px-6 py-3 flex items-center justify-center gap-6",children:[n.jsxs("div",{className:"text-sm text-neutral-700",children:[" ",Ge.length," "]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("button",{onClick:()=>f(Math.max(1,d-1)),disabled:d===1,className:`px-2 py-1 text-sm rounded transition-colors ${d===1?"bg-neutral-100 text-neutral-400 cursor-not-allowed":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:"<"}),n.jsx("div",{className:"flex items-center space-x-1",children:Array.from({length:Math.min(10,rt)},(ee,We)=>{let Je;return rt<=10||d<=5?Je=We+1:d>=rt-4?Je=rt-9+We:Je=d-4+We,n.jsx("button",{onClick:()=>f(Je),className:`px-2.5 py-1 text-sm rounded transition-colors ${d===Je?"bg-primary-600 text-white":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:Je},Je)})}),rt>10&&n.jsxs(n.Fragment,{children:[n.jsx("span",{className:"text-neutral-500",children:"..."}),n.jsx("button",{onClick:()=>f(rt),className:`px-2.5 py-1 text-sm rounded transition-colors ${d===rt?"bg-primary-600 text-white":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:rt})]}),n.jsx("button",{onClick:()=>f(Math.min(rt,d+1)),disabled:d===rt,className:`px-2 py-1 text-sm rounded transition-colors ${d===rt?"bg-neutral-100 text-neutral-400 cursor-not-allowed":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:">"})]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsxs("select",{value:x,onChange:ee=>ot(Number(ee.target.value)),className:"px-2 py-1 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500",children:[n.jsx("option",{value:10,children:"10/"}),n.jsx("option",{value:20,children:"20/"}),n.jsx("option",{value:50,children:"50/"})]}),n.jsx("span",{className:"text-sm text-neutral-700",children:""}),n.jsx("input",{type:"number",value:p,onChange:ee=>m(ee.target.value),placeholder:"",className:"w-12 px-2 py-1 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500",min:1,max:rt}),n.jsx("button",{onClick:ir,className:"px-3 py-1 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-50 transition-colors",children:""})]})]})]})}),w&&cn(!1),b&&cn(!0),N&&k&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4",children:[n.jsx("div",{className:"px-6 py-4 border-b border-neutral-200",children:n.jsx("h3",{className:"text-lg font-medium text-neutral-900",children:""})}),n.jsx("div",{className:"p-6",children:n.jsxs("p",{className:"text-neutral-600",children:[" ",n.jsxs("span",{className:"font-medium",children:['"',k.name,'"']})," "]})}),n.jsxs("div",{className:"px-6 py-4 bg-neutral-50 flex justify-end gap-2 rounded-b-lg",children:[n.jsx("button",{onClick:()=>A(!1),className:"px-4 py-2 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-100 transition-colors",children:""}),n.jsx("button",{onClick:je,className:"px-4 py-2 text-sm bg-red-600 text-white rounded hover:bg-red-700 transition-colors",children:""})]})]})}),D&&E&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[n.jsxs("div",{className:"px-6 py-4 border-b border-neutral-200 flex items-center justify-between sticky top-0 bg-white z-10",children:[n.jsx("h3",{className:"text-lg font-medium text-neutral-900",children:E.id?"":""}),n.jsx("button",{onClick:()=>{K(!1),Y(null)},className:"text-neutral-400 hover:text-neutral-600 transition-colors",children:n.jsx(Qe,{className:"w-5 h-5"})})]}),n.jsxs("div",{className:"p-6 space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:E.name,onChange:ee=>Me("name",ee.target.value),placeholder:"",className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:E.certNumber,onChange:ee=>Me("certNumber",ee.target.value),placeholder:"",className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:E.issuingOrganization,onChange:ee=>Me("issuingOrganization",ee.target.value),placeholder:"",className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"date",value:E.issueDate,onChange:ee=>Me("issueDate",ee.target.value),className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:""}),n.jsxs("div",{className:"border-2 border-dashed border-neutral-300 rounded-lg p-4 text-center hover:border-primary-500 transition-colors cursor-pointer mb-3",onClick:Ie,children:[n.jsx(St,{className:"w-6 h-6 mx-auto text-neutral-400 mb-1"}),n.jsx("p",{className:"text-sm text-neutral-600",children:""}),n.jsx("p",{className:"text-xs text-neutral-500 mt-1",children:"JPGPNGJPEG"})]}),E.attachments.length>0&&n.jsx("div",{className:"grid grid-cols-2 gap-3",children:E.attachments.map((ee,We)=>n.jsxs("div",{className:"relative",children:[n.jsx("img",{src:ee.url,alt:ee.name,className:"w-full h-32 object-cover rounded-lg border border-neutral-200"}),n.jsx("button",{onClick:()=>Oe(We),className:"absolute top-2 right-2 bg-red-600 text-white p-1 rounded-full hover:bg-red-700 transition-colors shadow-lg",children:n.jsx(qe,{className:"w-3.5 h-3.5"})}),n.jsx("div",{className:"mt-1 text-xs text-neutral-600 truncate px-1",children:ee.name})]},We))})]})]}),n.jsxs("div",{className:"px-6 py-4 bg-neutral-50 flex justify-end gap-2 rounded-b-lg sticky bottom-0",children:[n.jsx("button",{onClick:()=>{K(!1),Y(null)},className:"px-4 py-2 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-100 transition-colors",children:""}),n.jsx("button",{onClick:De,className:"px-4 py-2 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors",children:""})]})]})}),B&&re&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[n.jsxs("div",{className:"px-6 py-4 border-b border-neutral-200 flex items-center justify-between sticky top-0 bg-white z-10",children:[n.jsx("h3",{className:"text-lg font-medium text-neutral-900",children:re.id?"":""}),n.jsx("button",{onClick:()=>{te(!1),Q(null)},className:"text-neutral-400 hover:text-neutral-600 transition-colors",children:n.jsx(Qe,{className:"w-5 h-5"})})]}),n.jsxs("div",{className:"p-6 space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:re.name,onChange:ee=>nt("name",ee.target.value),placeholder:"",className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:re.certNumber,onChange:ee=>nt("certNumber",ee.target.value),placeholder:"",className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:re.issuingOrganization,onChange:ee=>nt("issuingOrganization",ee.target.value),placeholder:"",className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"date",value:re.issueDate,onChange:ee=>nt("issueDate",ee.target.value),className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"date",value:re.validUntil,onChange:ee=>nt("validUntil",ee.target.value),className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:""}),n.jsxs("div",{className:"border-2 border-dashed border-neutral-300 rounded-lg p-4 text-center hover:border-primary-500 transition-colors cursor-pointer mb-3",onClick:gt,children:[n.jsx(St,{className:"w-6 h-6 mx-auto text-neutral-400 mb-1"}),n.jsx("p",{className:"text-sm text-neutral-600",children:""}),n.jsx("p",{className:"text-xs text-neutral-500 mt-1",children:"JPGPNGJPEG"})]}),re.attachments.length>0&&n.jsx("div",{className:"grid grid-cols-2 gap-3",children:re.attachments.map((ee,We)=>n.jsxs("div",{className:"relative",children:[n.jsx("img",{src:ee.url,alt:ee.name,className:"w-full h-32 object-cover rounded-lg border border-neutral-200"}),n.jsx("button",{onClick:()=>Ut(We),className:"absolute top-2 right-2 bg-red-600 text-white p-1 rounded-full hover:bg-red-700 transition-colors shadow-lg",children:n.jsx(qe,{className:"w-3.5 h-3.5"})}),n.jsx("div",{className:"mt-1 text-xs text-neutral-600 truncate px-1",children:ee.name})]},We))})]})]}),n.jsxs("div",{className:"px-6 py-4 bg-neutral-50 flex justify-end gap-2 rounded-b-lg sticky bottom-0",children:[n.jsx("button",{onClick:()=>{te(!1),Q(null)},className:"px-4 py-2 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-100 transition-colors",children:""}),n.jsx("button",{onClick:Bt,className:"px-4 py-2 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors",children:""})]})]})})]})},UE=50*1024*1024,zE=({companyId:e,readOnly:t=!1})=>{var ir;const[r,a]=M.useState("productionEquipment"),[s,i]=M.useState(()=>{const se=localStorage.getItem(`product_info_${e}`);return se?JSON.parse(se):{productionEquipment:[],testingEquipment:[],companyProducts:[]}}),[l,c]=M.useState(()=>{const se=localStorage.getItem(`product_categories_${e}`);return se?JSON.parse(se):{productionEquipment:[],testingEquipment:[],companyProducts:[]}}),[o,u]=M.useState(""),[d,f]=M.useState(""),[x,h]=M.useState(""),[p,m]=M.useState("all"),[w,v]=M.useState(1),[b,y]=M.useState(10),[N,A]=M.useState(""),[k,_]=M.useState(!1),[j,P]=M.useState(null),[D,K]=M.useState(!1),[E,Y]=M.useState(null),[B,te]=M.useState(!1),[re,Q]=M.useState(null),[Z,z]=M.useState(!1),[ne,xe]=M.useState(1),[O,R]=M.useState(!1);M.useEffect(()=>{localStorage.setItem(`product_info_${e}`,JSON.stringify(s))},[s,e]),M.useEffect(()=>{localStorage.setItem(`product_categories_${e}`,JSON.stringify(l))},[l,e]);const g=()=>{P({id:"",categoryId:"",name:"",brand:"",specification:"",model:"",description:"",source:"own",attachments:[]}),xe(1),R(!1),_(!0)},S=se=>{P({...se}),xe(1),R(!0),_(!0)},F=()=>j?ne===1?j.name.trim()!==""&&j.categoryId!=="":!0:!1,ae=()=>{ne<2&&F()&&xe(ne+1)},ue=()=>{ne>1&&xe(ne-1)},ve=()=>{if(!j)return;if(!j.name.trim()){alert("");return}if(!j.categoryId){alert("");return}const se=[...s[r]];if(j.id){const ze=se.findIndex(Be=>Be.id===j.id);ze!==-1&&(se[ze]=j)}else se.push({...j,id:Date.now().toString(),createdAt:new Date().toISOString()});i({...s,[r]:se}),_(!1),P(null)},me=()=>{const se=[],ze=["",""];for(let Be=1;Be<=2;Be++)se.push(n.jsxs("div",{className:"flex items-center",children:[n.jsxs("div",{className:"flex items-center",children:[n.jsx("div",{className:`flex items-center justify-center w-8 h-8 rounded-full border-2 transition-colors ${Be<ne?"bg-green-500 border-green-500 text-white":Be===ne?"bg-blue-600 border-blue-600 text-white":"bg-white border-neutral-300 text-neutral-500"}`,children:Be<ne?n.jsx($u,{className:"w-4 h-4"}):Be}),n.jsx("div",{className:"ml-2",children:n.jsx("div",{className:`text-sm font-medium ${Be===ne?"text-blue-900":"text-neutral-600"}`,children:ze[Be-1]})})]}),Be<2&&n.jsx(Kl,{className:"w-5 h-5 mx-4 text-neutral-400"})]},Be));return n.jsx("div",{className:"bg-neutral-50 px-6 py-4 border-b border-neutral-200",children:n.jsx("div",{className:"flex items-center justify-between",children:se})})},H=()=>n.jsxs("div",{className:"p-6 space-y-6",children:[n.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:n.jsx("p",{className:"text-sm text-blue-800",children:""})}),n.jsxs("div",{className:"border-b border-neutral-200 pb-4",children:[n.jsx("h4",{className:"text-sm font-semibold text-neutral-900 mb-3",children:""}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsxs("select",{value:(j==null?void 0:j.categoryId)||"",onChange:se=>j&&P({...j,categoryId:se.target.value}),className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[n.jsx("option",{value:"",children:""}),l[r].filter(se=>!se.parentId).map(se=>{const ze=l[r].filter(Be=>Be.parentId===se.id);return n.jsxs(br.Fragment,{children:[n.jsx("option",{value:se.id,children:se.name}),ze.map(Be=>n.jsxs("option",{value:Be.id,children:[" ",Be.name," (: ",se.name,")"]},Be.id))]},se.id)})]})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:(j==null?void 0:j.name)||"",onChange:se=>j&&P({...j,name:se.target.value}),placeholder:"",className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:""}),n.jsx("input",{type:"text",value:(j==null?void 0:j.brand)||"",onChange:se=>j&&P({...j,brand:se.target.value}),placeholder:"",className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:""}),n.jsx("input",{type:"text",value:(j==null?void 0:j.model)||"",onChange:se=>j&&P({...j,model:se.target.value}),placeholder:"",className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),r==="companyProducts"&&n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsxs("select",{value:(j==null?void 0:j.source)||"own",onChange:se=>j&&P({...j,source:se.target.value}),className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[n.jsx("option",{value:"own",children:""}),n.jsx("option",{value:"agency",children:""})]})]})]}),n.jsxs("div",{className:"mt-4",children:[n.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:""}),n.jsx("textarea",{value:(j==null?void 0:j.description)||"",onChange:se=>j&&P({...j,description:se.target.value}),placeholder:"",rows:4,className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]})]})]}),T=()=>n.jsxs("div",{className:"p-6 space-y-4",children:[n.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:n.jsx("p",{className:"text-sm text-blue-800",children:""})}),n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center justify-between mb-3",children:[n.jsx("h4",{className:"text-sm font-semibold text-neutral-900",children:""}),n.jsxs("button",{onClick:De,className:"px-3 py-1.5 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors flex items-center",children:[n.jsx(Pt,{className:"w-4 h-4 mr-1"}),""]})]}),(j==null?void 0:j.attachments.length)===0?n.jsx("div",{className:"text-center py-8 text-neutral-500 bg-neutral-50 rounded-lg border border-neutral-200",children:""}):n.jsx("div",{className:"overflow-x-auto border border-neutral-200 rounded-lg",children:n.jsxs("table",{className:"w-full",children:[n.jsx("thead",{className:"bg-neutral-50 border-b border-neutral-200",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""})]})}),n.jsx("tbody",{className:"divide-y divide-neutral-200",children:j==null?void 0:j.attachments.map((se,ze)=>n.jsxs("tr",{className:"hover:bg-neutral-50",children:[n.jsx("td",{className:"px-4 py-3 text-sm text-neutral-900",children:ze+1}),n.jsx("td",{className:"px-4 py-3 text-sm text-neutral-900",children:se.name}),n.jsx("td",{className:"px-4 py-3 text-sm text-neutral-600",children:se.description||"-"}),n.jsx("td",{className:"px-4 py-3 text-sm",children:n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("button",{onClick:()=>Me(se),className:"text-primary-600 hover:text-primary-800",children:n.jsx(Dt,{className:"w-4 h-4"})}),n.jsx("button",{onClick:()=>Oe(se.id),className:"text-red-600 hover:text-red-800",children:n.jsx(qe,{className:"w-4 h-4"})})]})})]},se.id))})]})})]})]}),je=()=>j?ne===1?H():ne===2?T():null:null,pe=se=>{confirm("")&&i({...s,[r]:s[r].filter(ze=>ze.id!==se)})},Le=se=>{Q({id:"",name:"",description:"",parentId:se}),te(!0)},Se=se=>{Q({...se}),te(!0)},he=()=>{if(!re)return;if(!re.name.trim()){alert("");return}const se=[...l[r]];if(re.id){const ze=se.findIndex(Be=>Be.id===re.id);ze!==-1&&(se[ze]=re)}else se.push({...re,id:Date.now().toString()});c({...l,[r]:se}),te(!1),Q(null)},oe=se=>{if(s[r].some(Be=>Be.categoryId===se)){alert("");return}confirm("")&&c({...l,[r]:l[r].filter(Be=>Be.id!==se)})},De=()=>{Y({id:"",name:"",description:"",files:[]}),K(!0)},Me=se=>{Y({...se}),K(!0)},Ie=()=>{if(!E||!j)return;if(!E.name.trim()){alert("");return}const se=[...j.attachments];if(E.id){const ze=se.findIndex(Be=>Be.id===E.id);ze!==-1&&(se[ze]=E)}else se.push({...E,id:Date.now().toString()});P({...j,attachments:se}),K(!1),Y(null)},Oe=se=>{j&&confirm("")&&P({...j,attachments:j.attachments.filter(ze=>ze.id!==se)})},He=async()=>{const se=document.createElement("input");se.type="file",se.accept="image/jpeg,image/png,image/jpg,application/pdf",se.multiple=!0,se.onchange=async ze=>{const kt=ze.target.files;if(kt&&E){const an=Array.from(kt).filter(gr=>gr.size>UE?(alert(` "${gr.name}" 50MB`),!1):!0).map(gr=>new Promise(Br=>{const ln=new FileReader;ln.onload=cn=>{var ee;Br({url:(ee=cn.target)==null?void 0:ee.result,name:gr.name,size:gr.size})},ln.readAsDataURL(gr)})),sn=await Promise.all(an);Y({...E,files:[...E.files,...sn]})}},se.click()},Ze=se=>{E&&Y({...E,files:E.files.filter((ze,Be)=>Be!==se)})},pt=()=>s[r].filter(se=>{const ze=!o||se.name.toLowerCase().includes(o.toLowerCase()),Be=!d||se.brand.toLowerCase().includes(d.toLowerCase()),kt=!x||se.model.toLowerCase().includes(x.toLowerCase()),_r=p==="all"||se.categoryId===p;return ze&&Be&&kt&&_r}).sort((se,ze)=>{const Be=se.createdAt?new Date(se.createdAt).getTime():0;return(ze.createdAt?new Date(ze.createdAt).getTime():0)-Be}),Bt=()=>{const se=pt(),ze=(w-1)*b,Be=ze+b;return se.slice(ze,Be)},nt=Math.ceil(pt().length/b),gt=()=>{u(""),f(""),h(""),m("all"),v(1)},Ut=()=>{v(1)},Ge=se=>{y(se),v(1)},dt=()=>{const se=parseInt(N);se>=1&&se<=nt&&(v(se),A(""))},rt=se=>{const ze=l[r].find(Be=>Be.id===se);if(!ze)return"-";if(ze.parentId){const Be=l[r].find(kt=>kt.id===ze.parentId);return Be?`${ze.name} (${Be.name})`:ze.name}return ze.name},ot={productionEquipment:"",testingEquipment:"",companyProducts:""};return n.jsxs("div",{className:"flex h-full",children:[n.jsxs("div",{className:"flex-1 flex flex-col min-w-0",children:[t&&n.jsx("div",{className:"px-6 py-3 bg-yellow-50 border-b border-yellow-200 rounded-lg mb-4",children:n.jsxs("p",{className:"text-sm text-yellow-800",children:[n.jsx(Kn,{className:"w-4 h-4 inline mr-2"})," - "]})}),n.jsx("div",{className:"flex-1 overflow-auto",children:n.jsxs("div",{className:"bg-white rounded-lg border border-neutral-200",children:[n.jsxs("div",{className:"px-6 py-4 border-b border-neutral-200",children:[n.jsx("div",{className:"flex items-center justify-between mb-4",children:n.jsx("h2",{className:"text-lg font-medium text-neutral-900",children:""})}),n.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4",children:n.jsx("p",{className:"text-sm text-blue-700",children:""})}),n.jsx("div",{className:"flex space-x-2 mb-4",children:Object.keys(ot).map(se=>n.jsx("button",{onClick:()=>{a(se),v(1),gt()},className:`px-4 py-2 text-sm font-medium transition-colors rounded ${r===se?"bg-primary-600 text-white":"bg-neutral-100 text-neutral-600 hover:bg-neutral-200"}`,children:ot[se]},se))}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex items-center gap-3 flex-wrap",children:["",n.jsx("input",{type:"text",placeholder:"",value:o,onChange:se=>u(se.target.value),className:"w-40 px-3 py-1.5 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500"}),"",n.jsx("input",{type:"text",placeholder:"",value:d,onChange:se=>f(se.target.value),className:"w-40 px-3 py-1.5 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500"}),"",n.jsx("input",{type:"text",placeholder:"",value:x,onChange:se=>h(se.target.value),className:"w-40 px-3 py-1.5 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500"}),"",n.jsxs("select",{value:p,onChange:se=>m(se.target.value),className:"px-3 py-1.5 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500",children:[n.jsx("option",{value:"all",children:""}),l[r].filter(se=>!se.parentId).map(se=>{const ze=l[r].filter(Be=>Be.parentId===se.id);return n.jsxs(br.Fragment,{children:[n.jsx("option",{value:se.id,children:se.name}),ze.map(Be=>n.jsxs("option",{value:Be.id,children:[" ",Be.name," (: ",se.name,")"]},Be.id))]},se.id)})]})]}),n.jsxs("div",{className:"flex justify-end gap-2",children:[n.jsx("button",{onClick:gt,className:"px-4 py-1.5 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-50 transition-colors",children:""}),n.jsx("button",{onClick:Ut,className:"px-4 py-1.5 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors",children:""})]})]})]}),!t&&n.jsxs("div",{className:"px-6 py-3 border-b border-neutral-200 flex items-center gap-2",children:[n.jsxs("button",{onClick:g,className:"px-4 py-1.5 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors flex items-center",children:[n.jsx(Pt,{className:"w-4 h-4 mr-1"}),"",ot[r]]}),n.jsxs("button",{onClick:()=>z(!0),className:"px-4 py-1.5 text-sm bg-green-600 text-white rounded hover:bg-green-700 transition-colors flex items-center",children:[n.jsx(Gu,{className:"w-4 h-4 mr-1"}),""]})]}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"w-full",children:[n.jsx("thead",{className:"bg-neutral-50 border-b border-neutral-200",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""}),r==="companyProducts"&&n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""})]})}),n.jsx("tbody",{className:"divide-y divide-neutral-200",children:Bt().length===0?n.jsx("tr",{children:n.jsx("td",{colSpan:r==="companyProducts"?8:7,className:"px-4 py-8 text-center text-neutral-500",children:""})}):Bt().map((se,ze)=>n.jsxs("tr",{className:"hover:bg-neutral-50",children:[n.jsx("td",{className:"px-4 py-3 text-sm text-neutral-900",children:(w-1)*b+ze+1}),n.jsx("td",{className:"px-4 py-3 text-sm text-neutral-600",children:rt(se.categoryId)}),n.jsx("td",{className:"px-4 py-3 text-sm text-neutral-900",children:se.name}),n.jsx("td",{className:"px-4 py-3 text-sm text-neutral-600",children:se.brand||"-"}),n.jsx("td",{className:"px-4 py-3 text-sm text-neutral-600",children:se.model||"-"}),r==="companyProducts"&&n.jsx("td",{className:"px-4 py-3 text-sm text-neutral-600",children:n.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded text-xs font-medium ${se.source==="own"?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"}`,children:se.source==="own"?"":""})}),n.jsxs("td",{className:"px-4 py-3 text-sm text-neutral-600",children:[se.attachments.length,""]}),n.jsx("td",{className:"px-4 py-3 text-sm",children:n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("button",{onClick:()=>S(se),className:"text-primary-600 hover:text-primary-800",title:"",children:n.jsx(Dt,{className:"w-4 h-4"})}),!t&&n.jsx("button",{onClick:()=>pe(se.id),className:"text-red-600 hover:text-red-800",title:"",children:n.jsx(qe,{className:"w-4 h-4"})})]})})]},se.id))})]})}),n.jsxs("div",{className:"bg-white border-t border-neutral-200 px-6 py-3 flex items-center justify-center gap-6",children:[n.jsxs("div",{className:"text-sm text-neutral-700",children:[" ",pt().length," "]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("button",{onClick:()=>v(Math.max(1,w-1)),disabled:w===1,className:`px-2 py-1 text-sm rounded transition-colors ${w===1?"bg-neutral-100 text-neutral-400 cursor-not-allowed":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:"<"}),n.jsx("div",{className:"flex items-center space-x-1",children:Array.from({length:Math.min(10,nt)},(se,ze)=>{let Be;return nt<=10||w<=5?Be=ze+1:w>=nt-4?Be=nt-9+ze:Be=w-4+ze,n.jsx("button",{onClick:()=>v(Be),className:`px-2.5 py-1 text-sm rounded transition-colors ${w===Be?"bg-primary-600 text-white":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:Be},Be)})}),nt>10&&n.jsxs(n.Fragment,{children:[n.jsx("span",{className:"text-neutral-500",children:"..."}),n.jsx("button",{onClick:()=>v(nt),className:`px-2.5 py-1 text-sm rounded transition-colors ${w===nt?"bg-primary-600 text-white":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:nt})]}),n.jsx("button",{onClick:()=>v(Math.min(nt,w+1)),disabled:w===nt,className:`px-2 py-1 text-sm rounded transition-colors ${w===nt?"bg-neutral-100 text-neutral-400 cursor-not-allowed":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:">"})]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsxs("select",{value:b,onChange:se=>Ge(Number(se.target.value)),className:"px-2 py-1 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500",children:[n.jsx("option",{value:5,children:"5/"}),n.jsx("option",{value:10,children:"10/"}),n.jsx("option",{value:20,children:"20/"}),n.jsx("option",{value:50,children:"50/"})]}),n.jsx("span",{className:"text-sm text-neutral-700",children:""}),n.jsx("input",{type:"number",value:N,onChange:se=>A(se.target.value),placeholder:"",className:"w-12 px-2 py-1 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500",min:1,max:nt}),n.jsx("button",{onClick:dt,className:"px-3 py-1 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-50 transition-colors",children:""})]})]})]})})]}),Z&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[n.jsxs("div",{className:"sticky top-0 bg-white border-b border-neutral-200 px-6 py-4 flex items-center justify-between z-10",children:[n.jsx("h3",{className:"text-lg font-semibold text-neutral-900",children:""}),n.jsx("button",{onClick:()=>z(!1),className:"text-neutral-400 hover:text-neutral-600",children:n.jsx(Qe,{className:"w-6 h-6"})})]}),n.jsxs("div",{className:"p-6",children:[n.jsx("div",{className:"mb-4",children:n.jsxs("button",{onClick:()=>Le(),className:"px-4 py-2 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors flex items-center",children:[n.jsx(Pt,{className:"w-4 h-4 mr-1"}),""]})}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"w-full",children:[n.jsx("thead",{className:"bg-neutral-50 border-b border-neutral-200",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""})]})}),n.jsx("tbody",{className:"divide-y divide-neutral-200",children:l[r].length===0?n.jsx("tr",{children:n.jsx("td",{colSpan:4,className:"px-4 py-8 text-center text-neutral-500",children:""})}):l[r].filter(se=>!se.parentId).map((se,ze)=>{const Be=l[r].filter(kt=>kt.parentId===se.id);return n.jsxs(br.Fragment,{children:[n.jsxs("tr",{className:"hover:bg-neutral-50",children:[n.jsx("td",{className:"px-4 py-3 text-sm text-neutral-900",children:ze+1}),n.jsx("td",{className:"px-4 py-3 text-sm text-neutral-900 font-medium",children:se.name}),n.jsx("td",{className:"px-4 py-3 text-sm text-neutral-600",children:se.description||"-"}),n.jsx("td",{className:"px-4 py-3 text-sm",children:n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("button",{onClick:()=>Le(se.id),className:"text-green-600 hover:text-green-800",title:"",children:n.jsx(Pt,{className:"w-4 h-4"})}),n.jsx("button",{onClick:()=>Se(se),className:"text-primary-600 hover:text-primary-800",title:"",children:n.jsx(Dt,{className:"w-4 h-4"})}),n.jsx("button",{onClick:()=>oe(se.id),className:"text-red-600 hover:text-red-800",title:"",children:n.jsx(qe,{className:"w-4 h-4"})})]})})]}),Be.map((kt,_r)=>n.jsxs("tr",{className:"hover:bg-neutral-50 bg-neutral-25",children:[n.jsxs("td",{className:"px-4 py-3 text-sm text-neutral-900 pl-8",children:[ze+1,".",_r+1]}),n.jsxs("td",{className:"px-4 py-3 text-sm text-neutral-700 pl-8",children:[" ",kt.name]}),n.jsx("td",{className:"px-4 py-3 text-sm text-neutral-600",children:kt.description||"-"}),n.jsx("td",{className:"px-4 py-3 text-sm",children:n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("button",{onClick:()=>Se(kt),className:"text-primary-600 hover:text-primary-800",title:"",children:n.jsx(Dt,{className:"w-4 h-4"})}),n.jsx("button",{onClick:()=>oe(kt.id),className:"text-red-600 hover:text-red-800",title:"",children:n.jsx(qe,{className:"w-4 h-4"})})]})})]},kt.id))]},se.id)})})]})})]}),n.jsx("div",{className:"sticky bottom-0 bg-neutral-50 px-6 py-4 border-t border-neutral-200 flex justify-end",children:n.jsx("button",{onClick:()=>z(!1),className:"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors",children:""})})]})}),k&&j&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] flex flex-col",children:[n.jsxs("div",{className:"px-6 py-4 border-b border-neutral-200 flex items-center justify-between flex-shrink-0",children:[n.jsxs("h3",{className:"text-lg font-semibold text-neutral-900",children:[O?"":"",ot[r]]}),n.jsx("button",{onClick:()=>{_(!1),P(null)},className:"text-neutral-400 hover:text-neutral-600",children:n.jsx(Qe,{className:"w-6 h-6"})})]}),me(),n.jsx("div",{className:"flex-1 overflow-y-auto",children:je()}),n.jsxs("div",{className:"px-6 py-4 border-t border-neutral-200 flex justify-between flex-shrink-0",children:[n.jsx("button",{onClick:ue,disabled:ne===1,className:`px-4 py-2 border border-neutral-300 text-neutral-700 rounded-lg transition-colors ${ne===1?"opacity-50 cursor-not-allowed":"hover:bg-neutral-50"}`,children:""}),n.jsxs("div",{className:"flex space-x-3",children:[n.jsx("button",{onClick:()=>{_(!1),P(null)},className:"px-4 py-2 border border-neutral-300 text-neutral-700 rounded-lg hover:bg-neutral-100 transition-colors",children:""}),ne<2?n.jsx("button",{onClick:ae,disabled:!F(),className:`px-4 py-2 bg-primary-600 text-white rounded-lg transition-colors ${F()?"hover:bg-primary-700":"opacity-50 cursor-not-allowed"}`,children:""}):n.jsx("button",{onClick:ve,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:""})]})]})]})}),B&&re&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full",children:[n.jsxs("div",{className:"px-6 py-4 border-b border-neutral-200 flex items-center justify-between",children:[n.jsx("h3",{className:"text-lg font-medium text-neutral-900",children:re.id?"":""}),n.jsx("button",{onClick:()=>{te(!1),Q(null)},className:"text-neutral-400 hover:text-neutral-600",children:n.jsx(Qe,{className:"w-5 h-5"})})]}),n.jsxs("div",{className:"p-6 space-y-4",children:[re.parentId&&n.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3 text-sm text-blue-800",children:["",(ir=l[r].find(se=>se.id===re.parentId))==null?void 0:ir.name]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:re.name,onChange:se=>Q({...re,name:se.target.value}),placeholder:"",className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:""}),n.jsx("textarea",{value:re.description,onChange:se=>Q({...re,description:se.target.value}),placeholder:"",rows:3,className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]})]}),n.jsxs("div",{className:"px-6 py-4 bg-neutral-50 flex justify-end gap-2 rounded-b-lg",children:[n.jsx("button",{onClick:()=>{te(!1),Q(null)},className:"px-4 py-2 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-100 transition-colors",children:""}),n.jsx("button",{onClick:he,className:"px-4 py-2 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors",children:""})]})]})}),D&&E&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[60] p-4",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[n.jsxs("div",{className:"px-6 py-4 border-b border-neutral-200 flex items-center justify-between sticky top-0 bg-white z-10",children:[n.jsx("h3",{className:"text-lg font-medium text-neutral-900",children:E.id?"":""}),n.jsx("button",{onClick:()=>{K(!1),Y(null)},className:"text-neutral-400 hover:text-neutral-600",children:n.jsx(Qe,{className:"w-5 h-5"})})]}),n.jsxs("div",{className:"p-6 space-y-4",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:E.name,onChange:se=>Y({...E,name:se.target.value}),placeholder:"",className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:""}),n.jsx("textarea",{value:E.description,onChange:se=>Y({...E,description:se.target.value}),placeholder:"",rows:3,className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:""}),n.jsxs("div",{className:"border-2 border-dashed border-neutral-300 rounded-lg p-4 text-center hover:border-primary-500 transition-colors cursor-pointer mb-3",onClick:He,children:[n.jsx(St,{className:"w-6 h-6 mx-auto text-neutral-400 mb-1"}),n.jsx("p",{className:"text-sm text-neutral-600",children:""}),n.jsx("p",{className:"text-xs text-neutral-500 mt-1",children:"JPGPNGJPEGPDFWORD"})]}),E.files.length>0&&n.jsx("div",{className:"grid grid-cols-2 gap-3",children:E.files.map((se,ze)=>n.jsxs("div",{className:"relative",children:[n.jsx("img",{src:se.url,alt:se.name,className:"w-full h-32 object-cover rounded-lg border border-neutral-200"}),n.jsx("button",{onClick:()=>Ze(ze),className:"absolute top-2 right-2 bg-red-600 text-white p-1 rounded-full hover:bg-red-700 transition-colors shadow-lg",children:n.jsx(qe,{className:"w-3.5 h-3.5"})}),n.jsx("div",{className:"mt-1 text-xs text-neutral-600 truncate px-1",children:se.name})]},ze))})]})]}),n.jsxs("div",{className:"px-6 py-4 bg-neutral-50 flex justify-end gap-2 rounded-b-lg sticky bottom-0",children:[n.jsx("button",{onClick:()=>{K(!1),Y(null)},className:"px-4 py-2 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-100 transition-colors",children:""}),n.jsx("button",{onClick:Ie,className:"px-4 py-2 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors",children:""})]})]})})]})},WE=({companyId:e,readOnly:t=!1})=>{const[r,a]=M.useState(()=>{const g=localStorage.getItem(`historical_${e}`);return g?JSON.parse(g):[]});M.useEffect(()=>{localStorage.setItem(`historical_${e}`,JSON.stringify(r))},[r,e]);const[s,i]=M.useState(""),[l,c]=M.useState(1),[o,u]=M.useState(10),[d,f]=M.useState(""),[x,h]=M.useState(!1),[p,m]=M.useState(!1),[w,v]=M.useState(!1),[b,y]=M.useState(null),[N,A]=M.useState(null),k=50*1024*1024,_=g=>{if(g===0)return"0 B";const S=1024,F=["B","KB","MB","GB"],ae=Math.floor(Math.log(g)/Math.log(S));return Math.round(g/Math.pow(S,ae)*100)/100+" "+F[ae]},j=()=>{i(""),c(1)},P=()=>{console.log("Searching:",s)},D=()=>{A({id:"",fileName:"",fileType:"",fileDescription:"",attachments:[]}),h(!0)},K=g=>{A({...g}),m(!0)},E=g=>{y(g),v(!0)},Y=()=>{if(N){const g={...N,id:String(Date.now()),createdAt:new Date().toISOString()};a([...r,g]),h(!1)}},B=()=>{N&&(a(r.map(g=>g.id===N.id?N:g)),m(!1))},te=()=>{b&&(a(r.filter(g=>g.id!==b.id)),v(!1))},re=g=>{if(N){if(g.size>k){alert(` "${g.name}" 50MB`);return}const S={url:"",name:g.name,size:g.size};A({...N,attachments:[...N.attachments,S]})}},Q=g=>{N&&A({...N,attachments:N.attachments.filter((S,F)=>F!==g)})},Z=r.filter(g=>!s||g.fileName.toLowerCase().includes(s.toLowerCase())||g.fileType.toLowerCase().includes(s.toLowerCase())).sort((g,S)=>{const F=g.createdAt?new Date(g.createdAt).getTime():0;return(S.createdAt?new Date(S.createdAt).getTime():0)-F}),z=()=>{const g=(l-1)*o,S=g+o;return Z.slice(g,S)},ne=Math.ceil(Z.length/o),xe=g=>{u(g),c(1)},O=()=>{const g=parseInt(d);g>=1&&g<=ne&&(c(g),f(""))},R=g=>N?n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-3xl w-full max-h-[90vh] overflow-y-auto",children:[n.jsxs("div",{className:"px-6 py-4 border-b border-neutral-200 flex items-center justify-between sticky top-0 bg-white z-10",children:[n.jsx("h3",{className:"text-lg font-medium text-neutral-900",children:g?"":""}),n.jsx("button",{onClick:()=>g?m(!1):h(!1),className:"text-neutral-400 hover:text-neutral-600 transition-colors",children:n.jsx(Qe,{className:"w-5 h-5"})})]}),n.jsxs("div",{className:"p-6 space-y-4",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:N.fileName,onChange:S=>A({...N,fileName:S.target.value}),placeholder:"",className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:N.fileType,onChange:S=>A({...N,fileType:S.target.value}),placeholder:"",className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:""}),n.jsx("textarea",{value:N.fileDescription,onChange:S=>A({...N,fileDescription:S.target.value}),placeholder:"",rows:4,className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsxs("div",{className:"border-2 border-dashed border-neutral-300 rounded-lg p-6 text-center hover:border-primary-500 transition-colors cursor-pointer",onClick:()=>re({name:`${N.fileName||""}.pdf`,size:2048e3}),children:[n.jsx(St,{className:"w-8 h-8 mx-auto text-neutral-400 mb-2"}),n.jsx("p",{className:"text-sm text-neutral-600 mb-1",children:""}),n.jsx("p",{className:"text-xs text-neutral-500",children:" WORDPDF "})]}),N.attachments.length>0&&n.jsx("div",{className:"mt-3 space-y-2",children:N.attachments.map((S,F)=>n.jsxs("div",{className:"flex items-center justify-between bg-neutral-50 px-3 py-2 rounded-lg",children:[n.jsxs("div",{className:"flex items-center space-x-2 flex-1 min-w-0",children:[n.jsx(Lt,{className:"w-4 h-4 text-neutral-400 flex-shrink-0"}),n.jsx("span",{className:"text-sm text-neutral-900 truncate",children:S.name}),n.jsxs("span",{className:"text-xs text-neutral-500 flex-shrink-0",children:["(",_(S.size),")"]})]}),n.jsx("button",{onClick:()=>Q(F),className:"text-red-600 hover:text-red-800 ml-2 flex-shrink-0",children:n.jsx(qe,{className:"w-4 h-4"})})]},F))})]})]}),n.jsxs("div",{className:"px-6 py-4 bg-neutral-50 flex justify-end gap-2 rounded-b-lg sticky bottom-0",children:[n.jsx("button",{onClick:()=>g?m(!1):h(!1),className:"px-4 py-2 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-100 transition-colors",children:""}),n.jsx("button",{onClick:g?B:Y,className:"px-4 py-2 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors",children:g?"":""})]})]})}):null;return n.jsxs("div",{className:"flex flex-col h-full",children:[t&&n.jsx("div",{className:"px-6 py-3 bg-yellow-50 border-b border-yellow-200",children:n.jsxs("p",{className:"text-sm text-yellow-800",children:[n.jsx(Kn,{className:"w-4 h-4 inline mr-2"})," - "]})}),n.jsx("div",{className:"flex-1 overflow-auto",children:n.jsxs("div",{className:"bg-white rounded-lg border border-neutral-200",children:[n.jsxs("div",{className:"px-6 py-4 border-b border-neutral-200",children:[n.jsx("div",{className:"flex items-center justify-between mb-4",children:n.jsx("h2",{className:"text-lg font-medium text-neutral-900",children:""})}),n.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4",children:n.jsx("p",{className:"text-sm text-blue-700",children:""})}),n.jsxs("div",{className:"flex items-center justify-between gap-3",children:[n.jsxs("div",{className:"flex items-center gap-3",children:["",n.jsx("input",{type:"text",placeholder:"",value:s,onChange:g=>i(g.target.value),className:"w-48 px-3 py-1.5 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{onClick:j,className:"px-4 py-1.5 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-50 transition-colors",children:""}),n.jsx("button",{onClick:P,className:"px-4 py-1.5 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors",children:""})]})]})]}),!t&&n.jsx("div",{className:"px-6 py-3 border-b border-neutral-200",children:n.jsxs("button",{onClick:D,className:"px-4 py-1.5 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors flex items-center",children:[n.jsx(Pt,{className:"w-4 h-4 mr-1"}),""]})}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"w-full",children:[n.jsx("thead",{className:"bg-neutral-50 border-b border-neutral-200",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""})]})}),n.jsx("tbody",{className:"divide-y divide-neutral-200",children:z().length===0?n.jsx("tr",{children:n.jsx("td",{colSpan:6,className:"px-4 py-8 text-center text-neutral-500",children:""})}):z().map((g,S)=>n.jsxs("tr",{className:"hover:bg-neutral-50 transition-colors",children:[n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm text-neutral-900",children:(l-1)*o+S+1}),n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm text-neutral-900",children:n.jsx("div",{className:"max-w-xs truncate",title:g.fileName,children:g.fileName})}),n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm text-neutral-900",children:g.fileType}),n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm text-neutral-900",children:n.jsx("div",{className:"max-w-xs truncate",title:g.fileDescription,children:g.fileDescription||"-"})}),n.jsxs("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm",children:[!t&&n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsxs("button",{onClick:()=>K(g),className:"px-2 py-1 text-xs text-primary-600 hover:text-primary-800 hover:bg-primary-50 rounded transition-colors flex items-center gap-1",children:[n.jsx(Dt,{className:"w-3.5 h-3.5"}),""]}),n.jsxs("button",{onClick:()=>E(g),className:"px-2 py-1 text-xs text-red-600 hover:text-red-800 hover:bg-red-50 rounded transition-colors flex items-center gap-1",children:[n.jsx(qe,{className:"w-3.5 h-3.5"}),""]})]}),t&&n.jsx("span",{className:"text-xs text-neutral-400",children:""})]})]},g.id))})]})}),n.jsxs("div",{className:"bg-white border-t border-neutral-200 px-6 py-3 flex items-center justify-center gap-6",children:[n.jsxs("div",{className:"text-sm text-neutral-700",children:[" ",Z.length," "]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("button",{onClick:()=>c(Math.max(1,l-1)),disabled:l===1,className:`px-2 py-1 text-sm rounded transition-colors ${l===1?"bg-neutral-100 text-neutral-400 cursor-not-allowed":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:"<"}),n.jsx("div",{className:"flex items-center space-x-1",children:Array.from({length:Math.min(10,ne)},(g,S)=>{let F;return ne<=10||l<=5?F=S+1:l>=ne-4?F=ne-9+S:F=l-4+S,n.jsx("button",{onClick:()=>c(F),className:`px-2.5 py-1 text-sm rounded transition-colors ${l===F?"bg-primary-600 text-white":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:F},F)})}),ne>10&&n.jsxs(n.Fragment,{children:[n.jsx("span",{className:"text-neutral-500",children:"..."}),n.jsx("button",{onClick:()=>c(ne),className:`px-2.5 py-1 text-sm rounded transition-colors ${l===ne?"bg-primary-600 text-white":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:ne})]}),n.jsx("button",{onClick:()=>c(Math.min(ne,l+1)),disabled:l===ne,className:`px-2 py-1 text-sm rounded transition-colors ${l===ne?"bg-neutral-100 text-neutral-400 cursor-not-allowed":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:">"})]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsxs("select",{value:o,onChange:g=>xe(Number(g.target.value)),className:"px-2 py-1 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500",children:[n.jsx("option",{value:10,children:"10/"}),n.jsx("option",{value:20,children:"20/"}),n.jsx("option",{value:50,children:"50/"})]}),n.jsx("span",{className:"text-sm text-neutral-700",children:""}),n.jsx("input",{type:"number",value:d,onChange:g=>f(g.target.value),placeholder:"",className:"w-12 px-2 py-1 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500",min:1,max:ne}),n.jsx("button",{onClick:O,className:"px-3 py-1 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-50 transition-colors",children:""})]})]})]})}),x&&R(!1),p&&R(!0),w&&b&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4",children:[n.jsx("div",{className:"px-6 py-4 border-b border-neutral-200",children:n.jsx("h3",{className:"text-lg font-medium text-neutral-900",children:""})}),n.jsx("div",{className:"p-6",children:n.jsxs("p",{className:"text-neutral-600",children:[" ",n.jsxs("span",{className:"font-medium",children:['"',b.fileName,'"']})," "]})}),n.jsxs("div",{className:"px-6 py-4 bg-neutral-50 flex justify-end gap-2 rounded-b-lg",children:[n.jsx("button",{onClick:()=>v(!1),className:"px-4 py-2 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-100 transition-colors",children:""}),n.jsx("button",{onClick:te,className:"px-4 py-2 text-sm bg-red-600 text-white rounded hover:bg-red-700 transition-colors",children:""})]})]})})]})},HE=({companyId:e,readOnly:t=!1})=>{const[r,a]=M.useState(()=>{const g=localStorage.getItem(`reference_files_${e}`);return g?JSON.parse(g):[]});M.useEffect(()=>{localStorage.setItem(`reference_files_${e}`,JSON.stringify(r))},[r,e]);const[s,i]=M.useState(""),[l,c]=M.useState(1),[o,u]=M.useState(10),[d,f]=M.useState(""),[x,h]=M.useState(!1),[p,m]=M.useState(!1),[w,v]=M.useState(!1),[b,y]=M.useState(null),[N,A]=M.useState(null),k=50*1024*1024,_=g=>{if(g===0)return"0 B";const S=1024,F=["B","KB","MB","GB"],ae=Math.floor(Math.log(g)/Math.log(S));return Math.round(g/Math.pow(S,ae)*100)/100+" "+F[ae]},j=()=>{i(""),c(1)},P=()=>{console.log("Searching:",s)},D=()=>{A({id:"",fileName:"",fileType:"",fileDescription:"",attachments:[]}),h(!0)},K=g=>{A({...g}),m(!0)},E=g=>{y(g),v(!0)},Y=()=>{if(N){const g={...N,id:String(Date.now()),createdAt:new Date().toISOString()};a([...r,g]),h(!1)}},B=()=>{N&&(a(r.map(g=>g.id===N.id?N:g)),m(!1))},te=()=>{b&&(a(r.filter(g=>g.id!==b.id)),v(!1))},re=g=>{if(N){if(g.size>k){alert(` "${g.name}" 50MB`);return}const S={url:"",name:g.name,size:g.size};A({...N,attachments:[...N.attachments,S]})}},Q=g=>{N&&A({...N,attachments:N.attachments.filter((S,F)=>F!==g)})},Z=r.filter(g=>!s||g.fileName.toLowerCase().includes(s.toLowerCase())||g.fileType.toLowerCase().includes(s.toLowerCase())).sort((g,S)=>{const F=g.createdAt?new Date(g.createdAt).getTime():0;return(S.createdAt?new Date(S.createdAt).getTime():0)-F}),z=()=>{const g=(l-1)*o,S=g+o;return Z.slice(g,S)},ne=Math.ceil(Z.length/o),xe=g=>{u(g),c(1)},O=()=>{const g=parseInt(d);g>=1&&g<=ne&&(c(g),f(""))},R=g=>N?n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-3xl w-full max-h-[90vh] overflow-y-auto",children:[n.jsxs("div",{className:"px-6 py-4 border-b border-neutral-200 flex items-center justify-between sticky top-0 bg-white z-10",children:[n.jsx("h3",{className:"text-lg font-medium text-neutral-900",children:g?"":""}),n.jsx("button",{onClick:()=>g?m(!1):h(!1),className:"text-neutral-400 hover:text-neutral-600 transition-colors",children:n.jsx(Qe,{className:"w-5 h-5"})})]}),n.jsxs("div",{className:"p-6 space-y-4",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:N.fileName,onChange:S=>A({...N,fileName:S.target.value}),placeholder:"",className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:N.fileType,onChange:S=>A({...N,fileType:S.target.value}),placeholder:"",className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:""}),n.jsx("textarea",{value:N.fileDescription,onChange:S=>A({...N,fileDescription:S.target.value}),placeholder:"",rows:4,className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsxs("div",{className:"border-2 border-dashed border-neutral-300 rounded-lg p-6 text-center hover:border-primary-500 transition-colors cursor-pointer",onClick:()=>re({name:`${N.fileName||""}.pdf`,size:2048e3}),children:[n.jsx(St,{className:"w-8 h-8 mx-auto text-neutral-400 mb-2"}),n.jsx("p",{className:"text-sm text-neutral-600 mb-1",children:""}),n.jsx("p",{className:"text-xs text-neutral-500",children:" WORDPDF "})]}),N.attachments.length>0&&n.jsx("div",{className:"mt-3 space-y-2",children:N.attachments.map((S,F)=>n.jsxs("div",{className:"flex items-center justify-between bg-neutral-50 px-3 py-2 rounded-lg",children:[n.jsxs("div",{className:"flex items-center space-x-2 flex-1 min-w-0",children:[n.jsx(Lt,{className:"w-4 h-4 text-neutral-400 flex-shrink-0"}),n.jsx("span",{className:"text-sm text-neutral-900 truncate",children:S.name}),n.jsxs("span",{className:"text-xs text-neutral-500 flex-shrink-0",children:["(",_(S.size),")"]})]}),n.jsx("button",{onClick:()=>Q(F),className:"text-red-600 hover:text-red-800 ml-2 flex-shrink-0",children:n.jsx(qe,{className:"w-4 h-4"})})]},F))})]})]}),n.jsxs("div",{className:"px-6 py-4 bg-neutral-50 flex justify-end gap-2 rounded-b-lg sticky bottom-0",children:[n.jsx("button",{onClick:()=>g?m(!1):h(!1),className:"px-4 py-2 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-100 transition-colors",children:""}),n.jsx("button",{onClick:g?B:Y,className:"px-4 py-2 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors",children:g?"":""})]})]})}):null;return n.jsxs("div",{className:"flex flex-col h-full",children:[t&&n.jsx("div",{className:"px-6 py-3 bg-yellow-50 border-b border-yellow-200",children:n.jsxs("p",{className:"text-sm text-yellow-800",children:[n.jsx(Kn,{className:"w-4 h-4 inline mr-2"})," - "]})}),n.jsx("div",{className:"flex-1 overflow-auto",children:n.jsxs("div",{className:"bg-white rounded-lg border border-neutral-200",children:[n.jsxs("div",{className:"px-6 py-4 border-b border-neutral-200",children:[n.jsx("div",{className:"flex items-center justify-between mb-4",children:n.jsx("h2",{className:"text-lg font-medium text-neutral-900",children:""})}),n.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4",children:n.jsx("p",{className:"text-sm text-blue-700",children:""})}),n.jsxs("div",{className:"flex items-center justify-between gap-3",children:[n.jsxs("div",{className:"flex items-center gap-3",children:["",n.jsx("input",{type:"text",placeholder:"",value:s,onChange:g=>i(g.target.value),className:"w-48 px-3 py-1.5 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{onClick:j,className:"px-4 py-1.5 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-50 transition-colors",children:""}),n.jsx("button",{onClick:P,className:"px-4 py-1.5 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors",children:""})]})]})]}),!t&&n.jsx("div",{className:"px-6 py-3 border-b border-neutral-200",children:n.jsxs("button",{onClick:D,className:"px-4 py-1.5 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors flex items-center",children:[n.jsx(Pt,{className:"w-4 h-4 mr-1"}),""]})}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"w-full",children:[n.jsx("thead",{className:"bg-neutral-50 border-b border-neutral-200",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""})]})}),n.jsx("tbody",{className:"divide-y divide-neutral-200",children:z().length===0?n.jsx("tr",{children:n.jsx("td",{colSpan:6,className:"px-4 py-8 text-center text-neutral-500",children:""})}):z().map((g,S)=>n.jsxs("tr",{className:"hover:bg-neutral-50 transition-colors",children:[n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm text-neutral-900",children:(l-1)*o+S+1}),n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm text-neutral-900",children:n.jsx("div",{className:"max-w-xs truncate",title:g.fileName,children:g.fileName})}),n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm text-neutral-900",children:g.fileType}),n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm text-neutral-900",children:n.jsx("div",{className:"max-w-xs truncate",title:g.fileDescription,children:g.fileDescription||"-"})}),n.jsxs("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm",children:[!t&&n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsxs("button",{onClick:()=>K(g),className:"px-2 py-1 text-xs text-primary-600 hover:text-primary-800 hover:bg-primary-50 rounded transition-colors flex items-center gap-1",children:[n.jsx(Dt,{className:"w-3.5 h-3.5"}),""]}),n.jsxs("button",{onClick:()=>E(g),className:"px-2 py-1 text-xs text-red-600 hover:text-red-800 hover:bg-red-50 rounded transition-colors flex items-center gap-1",children:[n.jsx(qe,{className:"w-3.5 h-3.5"}),""]})]}),t&&n.jsx("span",{className:"text-xs text-neutral-400",children:""})]})]},g.id))})]})}),n.jsxs("div",{className:"bg-white border-t border-neutral-200 px-6 py-3 flex items-center justify-center gap-6",children:[n.jsxs("div",{className:"text-sm text-neutral-700",children:[" ",Z.length," "]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("button",{onClick:()=>c(Math.max(1,l-1)),disabled:l===1,className:`px-2 py-1 text-sm rounded transition-colors ${l===1?"bg-neutral-100 text-neutral-400 cursor-not-allowed":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:"<"}),n.jsx("div",{className:"flex items-center space-x-1",children:Array.from({length:Math.min(10,ne)},(g,S)=>{let F;return ne<=10||l<=5?F=S+1:l>=ne-4?F=ne-9+S:F=l-4+S,n.jsx("button",{onClick:()=>c(F),className:`px-2.5 py-1 text-sm rounded transition-colors ${l===F?"bg-primary-600 text-white":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:F},F)})}),ne>10&&n.jsxs(n.Fragment,{children:[n.jsx("span",{className:"text-neutral-500",children:"..."}),n.jsx("button",{onClick:()=>c(ne),className:`px-2.5 py-1 text-sm rounded transition-colors ${l===ne?"bg-primary-600 text-white":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:ne})]}),n.jsx("button",{onClick:()=>c(Math.min(ne,l+1)),disabled:l===ne,className:`px-2 py-1 text-sm rounded transition-colors ${l===ne?"bg-neutral-100 text-neutral-400 cursor-not-allowed":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:">"})]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsxs("select",{value:o,onChange:g=>xe(Number(g.target.value)),className:"px-2 py-1 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500",children:[n.jsx("option",{value:10,children:"10/"}),n.jsx("option",{value:20,children:"20/"}),n.jsx("option",{value:50,children:"50/"})]}),n.jsx("span",{className:"text-sm text-neutral-700",children:""}),n.jsx("input",{type:"number",value:d,onChange:g=>f(g.target.value),placeholder:"",className:"w-12 px-2 py-1 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500",min:1,max:ne}),n.jsx("button",{onClick:O,className:"px-3 py-1 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-50 transition-colors",children:""})]})]})]})}),x&&R(!1),p&&R(!0),w&&b&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4",children:[n.jsx("div",{className:"px-6 py-4 border-b border-neutral-200",children:n.jsx("h3",{className:"text-lg font-medium text-neutral-900",children:""})}),n.jsx("div",{className:"p-6",children:n.jsxs("p",{className:"text-neutral-600",children:[" ",n.jsxs("span",{className:"font-medium",children:['"',b.fileName,'"']})," "]})}),n.jsxs("div",{className:"px-6 py-4 bg-neutral-50 flex justify-end gap-2 rounded-b-lg",children:[n.jsx("button",{onClick:()=>v(!1),className:"px-4 py-2 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-100 transition-colors",children:""}),n.jsx("button",{onClick:te,className:"px-4 py-2 text-sm bg-red-600 text-white rounded hover:bg-red-700 transition-colors",children:""})]})]})})]})},$E=[{id:"1",name:"",created_at:"2024-01-15"},{id:"2",name:"XX",created_at:"2024-01-10"},{id:"3",name:"YY",created_at:"2024-01-08"},{id:"4",name:"ZZ",created_at:"2024-01-05"}],VE=({canEdit:e=!1,canDelete:t=!1,dataScope:r,readOnly:a=!1,currentUser:s})=>{const[i]=M.useState($E),[l,c]=M.useState(null),[o,u]=M.useState(""),[d,f]=M.useState("company");M.useState(!1),M.useState(!1),M.useState(!1),M.useState(!1),M.useState(null),M.useState(null),M.useState(null),M.useState("");const[x,h]=M.useState(""),[p,m]=M.useState(1),[w]=M.useState(10),[v,b]=M.useState([{id:"company",label:"",icon:El,count:25},{id:"qualification",label:"",icon:v1,count:18},{id:"financial",label:"",icon:vb,count:15},{id:"performance",label:"",icon:Lt,count:35},{id:"personnel",label:"",icon:w1,count:28},{id:"product",label:"",icon:Sb,count:0},{id:"templates",label:"",icon:St,count:22},{id:"referenceFiles",label:"",icon:go,count:0}]),y=Y=>{c(Y)},N=()=>{c(null),f("company"),h("")},A=()=>o?i.filter(Y=>Y.name.toLowerCase().includes(o.toLowerCase())):i,k=()=>{u("")},_={company:[{id:1,name:"",type:"PDF",date:"2024-01-15",status:""},{id:2,name:"",type:"DOCX",date:"2024-01-10",status:""},{id:3,name:"",type:"PDF",date:"2024-01-08",status:""},{id:4,name:"",type:"PDF",date:"2024-01-12",status:""},{id:5,name:"",type:"DOCX",date:"2024-01-05",status:""}],qualification:[{id:1,name:"",type:"PDF",date:"2024-01-20",status:""},{id:2,name:"ISO9001",type:"PDF",date:"2024-01-18",status:""},{id:3,name:"",type:"PDF",date:"2024-01-16",status:""}],financial:[{id:1,name:"2023",type:"PDF",date:"2024-01-25",status:""},{id:2,name:"2022",type:"PDF",date:"2023-12-20",status:""},{id:3,name:"",type:"PDF",date:"2024-01-20",status:""}],performance:[{id:1,name:"HIS",type:"PDF",date:"2024-01-20",status:""},{id:2,name:"",type:"PDF",date:"2024-01-18",status:""},{id:3,name:"",type:"PDF",date:"2024-01-16",status:""}],personnel:[{id:1,name:"-",type:"PDF",date:"2024-01-20",status:""},{id:2,name:"-",type:"PDF",date:"2024-01-18",status:""},{id:3,name:"-",type:"PDF",date:"2024-01-16",status:""}],templates:[{id:1,name:"",type:"DOCX",date:"2024-01-20",status:""},{id:2,name:"",type:"DOCX",date:"2024-01-18",status:""},{id:3,name:"",type:"DOCX",date:"2024-01-16",status:""}]},[j,P]=M.useState(_);Math.ceil((()=>{const Y=j[d]||[];return x?Y.filter(B=>B.name.toLowerCase().includes(x.toLowerCase())||B.type.toLowerCase().includes(x.toLowerCase())||B.status.toLowerCase().includes(x.toLowerCase())):Y})().length/w);const K=Y=>{f(Y),m(1),h("")};if(!l)return n.jsx("div",{className:"flex flex-col h-full",children:n.jsx("div",{className:"flex-1 flex flex-col overflow-hidden",children:n.jsxs("div",{className:"bg-white rounded-lg border border-neutral-200 flex flex-col h-full",children:[n.jsxs("div",{className:"px-6 py-4 border-b border-neutral-200 flex-shrink-0",children:[n.jsx("div",{className:"flex items-center justify-between mb-4",children:n.jsx("h2",{className:"text-lg font-medium text-neutral-900",children:""})}),n.jsxs("div",{className:"flex items-center justify-between gap-3",children:[n.jsxs("div",{className:"flex items-center gap-3",children:["",n.jsx("input",{type:"text",placeholder:"",value:o,onChange:Y=>u(Y.target.value),className:"w-48 px-3 py-1.5 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{onClick:k,className:"px-4 py-1.5 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-50 transition-colors",children:""}),n.jsx("button",{onClick:k,className:"px-4 py-1.5 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors",children:""})]})]})]}),n.jsx("div",{className:"px-6 py-3 border-b border-neutral-200 flex-shrink-0",children:n.jsx("div",{className:"text-sm text-neutral-500 italic",children:""})}),n.jsx("div",{className:"p-6 flex-1 overflow-auto",children:n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:A().map(Y=>n.jsx("div",{className:"p-6 rounded-lg border-2 border-gray-200 hover:border-primary-500 hover:shadow-md transition-all duration-200 group relative",children:n.jsxs("div",{onClick:()=>y(Y),className:"cursor-pointer",children:[n.jsx("div",{className:"flex items-start justify-between mb-3",children:n.jsx("div",{className:"w-12 h-12 bg-primary-100 rounded-lg flex items-center justify-center group-hover:bg-primary-200 transition-colors",children:n.jsx(El,{className:"w-6 h-6 text-primary-600"})})}),n.jsx("h3",{className:"font-semibold text-gray-900 mb-2 line-clamp-2 min-h-[3rem]",children:Y.name}),n.jsxs("p",{className:"text-sm text-gray-500",children:["",Y.created_at]})]})},Y.id))})})]})})});const E=()=>{if(!l)return null;switch(d){case"company":return n.jsx(Kx,{companyId:l.id,readOnly:a});case"qualification":return n.jsx(Mb,{companyId:l.id,readOnly:a});case"financial":return n.jsx(Rb,{companyId:l.id,readOnly:a});case"performance":return n.jsx(LE,{companyId:l.id,readOnly:a});case"personnel":return n.jsx(BE,{companyId:l.id,readOnly:a});case"product":return n.jsx(zE,{companyId:l.id,readOnly:a});case"templates":return n.jsx(WE,{companyId:l.id,readOnly:a});case"referenceFiles":return n.jsx(HE,{companyId:l.id,readOnly:a});default:return n.jsx(Kx,{companyId:l.id,readOnly:a})}};return n.jsxs("div",{className:"flex flex-col h-full",children:[n.jsx("div",{className:"bg-white border-b border-neutral-200 px-6 py-4",children:n.jsxs("div",{className:"flex items-center space-x-4",children:[n.jsx("button",{onClick:N,className:"text-neutral-600 hover:text-neutral-900 transition-colors",children:n.jsx(yi,{className:"w-6 h-6"})}),n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsx("h2",{className:"text-lg font-medium text-neutral-900",children:l.name}),n.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-primary-100 text-primary-800",children:""})]}),n.jsx("p",{className:"text-sm text-neutral-500",children:""})]})]})}),n.jsx("div",{className:"bg-white border-b border-neutral-200",children:n.jsx("div",{className:"flex overflow-x-auto",children:v.map(Y=>{const B=Y.icon;return n.jsxs("button",{onClick:()=>K(Y.id),className:`flex items-center space-x-2 px-6 py-3 border-b-2 transition-colors whitespace-nowrap ${d===Y.id?"border-primary-600 text-primary-600":"border-transparent text-neutral-600 hover:text-neutral-900 hover:border-neutral-300"}`,children:[n.jsx(B,{className:"w-4 h-4"}),n.jsx("span",{className:"text-sm font-medium",children:Y.label})]},Y.id)})})}),n.jsx("div",{className:"flex-1 overflow-auto",children:E()})]})},GE=({projects:e,onUploadClick:t,onViewProject:r,onDeleteProject:a,onReparse:s,onGenerateDocument:i,onDownloadProject:l})=>{const[c,o]=M.useState(""),[u,d]=M.useState("all"),[f,x]=M.useState(!1),[h,p]=M.useState(null),[m,w]=M.useState(null),[v,b]=M.useState(1),[y,N]=M.useState(10),[A,k]=M.useState(""),[_,j]=M.useState(!1),[P,D]=M.useState(null),K=()=>{o(""),d("all")},E=()=>{console.log("Searching:",c,u)},Y=R=>{p(R),x(!0)},B=()=>{h&&(a(h.id),x(!1),p(null))},te=R=>{R.status==="completed"?(D(R),j(!0)):r(R)},re=()=>{P&&(r(P),j(!1),D(null))},Q=e.filter(R=>{const g=!c||R.projectName.toLowerCase().includes(c.toLowerCase()),S=u==="all"||R.status===u;return g&&S}).sort((R,g)=>new Date(g.uploadTime).getTime()-new Date(R.uploadTime).getTime()),Z=()=>{const R=(v-1)*y,g=R+y;return Q.slice(R,g)},z=Math.ceil(Q.length/y),ne=R=>{N(R),b(1)},xe=()=>{const R=parseInt(A);R>=1&&R<=z&&(b(R),k(""))},O=R=>{const S={pending:{label:"",className:"bg-gray-100 text-gray-800"},parsing:{label:"",className:"bg-blue-100 text-blue-800"},parsed:{label:"",className:"bg-green-100 text-green-800"},failed:{label:"",className:"bg-red-100 text-red-800"},completed:{label:"",className:"bg-primary-100 text-primary-800"}}[R];return n.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${S.className}`,children:S.label})};return n.jsxs("div",{className:"flex flex-col h-full",children:[n.jsx("div",{className:"flex-1 flex flex-col overflow-hidden",children:n.jsxs("div",{className:"bg-white rounded-lg border border-neutral-200 flex flex-col h-full",children:[n.jsxs("div",{className:"px-6 py-4 border-b border-neutral-200 flex-shrink-0",children:[n.jsx("div",{className:"flex items-center justify-between mb-4",children:n.jsx("h2",{className:"text-lg font-medium text-neutral-900",children:""})}),n.jsxs("div",{className:"flex items-center justify-between gap-3",children:[n.jsxs("div",{className:"flex items-center gap-3 flex-wrap",children:["",n.jsx("input",{type:"text",placeholder:"",value:c,onChange:R=>o(R.target.value),className:"w-48 px-3 py-1.5 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500"}),"",n.jsxs("select",{value:u,onChange:R=>d(R.target.value),className:"px-3 py-1.5 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500",children:[n.jsx("option",{value:"all",children:""}),n.jsx("option",{value:"pending",children:""}),n.jsx("option",{value:"parsing",children:""}),n.jsx("option",{value:"parsed",children:""}),n.jsx("option",{value:"failed",children:""}),n.jsx("option",{value:"completed",children:""})]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{onClick:K,className:"px-4 py-1.5 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-50 transition-colors",children:""}),n.jsx("button",{onClick:E,className:"px-4 py-1.5 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors",children:""})]})]})]}),n.jsx("div",{className:"px-6 py-3 border-b border-neutral-200 flex-shrink-0",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("button",{onClick:t,className:"px-4 py-1.5 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors flex items-center",children:[n.jsx(Pt,{className:"w-4 h-4 mr-1"}),""]}),n.jsxs("button",{onClick:()=>m?i(m):null,disabled:!m||m.status!=="completed",className:"px-4 py-1.5 text-sm bg-green-600 text-white rounded hover:bg-green-700 transition-colors flex items-center disabled:opacity-50 disabled:cursor-not-allowed",title:m?m.status!=="completed"?"":"":"",children:[n.jsx(Lt,{className:"w-4 h-4 mr-1"}),""]})]})}),n.jsx("div",{className:"overflow-x-auto flex-1 overflow-y-auto",children:n.jsxs("table",{className:"w-full",children:[n.jsx("thead",{className:"bg-neutral-50 border-b border-neutral-200",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""})]})}),n.jsx("tbody",{className:"divide-y divide-neutral-200",children:Q.length===0?n.jsx("tr",{children:n.jsx("td",{colSpan:6,className:"px-4 py-8 text-center text-neutral-500",children:""})}):Z().map((R,g)=>n.jsxs("tr",{className:"hover:bg-neutral-50 transition-colors",children:[n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm text-neutral-900",children:n.jsx("input",{type:"radio",name:"selectedProject",checked:(m==null?void 0:m.id)===R.id,onChange:()=>w(R),disabled:R.status!=="completed",className:"w-4 h-4 text-primary-600 focus:ring-primary-500 disabled:opacity-30 disabled:cursor-not-allowed",title:R.status!=="completed"?"":""})}),n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm text-neutral-900",children:(v-1)*y+g+1}),n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm text-neutral-900",children:n.jsx("div",{className:"max-w-md truncate",title:R.projectName,children:R.projectName})}),n.jsxs("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm",children:[O(R.status),R.status==="parsing"&&R.parseProgress!==void 0&&n.jsxs("span",{className:"ml-2 text-xs text-neutral-500",children:[R.parseProgress,"%"]})]}),n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm text-neutral-900",children:R.uploadTime}),n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm",children:n.jsx("div",{className:"flex items-center space-x-3",children:R.status==="failed"?n.jsxs(n.Fragment,{children:[n.jsxs("button",{onClick:()=>s(R),className:"px-2 py-1 text-xs text-orange-600 hover:text-orange-800 hover:bg-orange-50 rounded transition-colors flex items-center gap-1",children:[n.jsx(Tl,{className:"w-3.5 h-3.5"}),""]}),n.jsxs("button",{onClick:()=>Y(R),className:"px-2 py-1 text-xs text-red-600 hover:text-red-800 hover:bg-red-50 rounded transition-colors flex items-center gap-1",children:[n.jsx(qe,{className:"w-3.5 h-3.5"}),""]})]}):R.status==="parsing"?n.jsxs(n.Fragment,{children:[n.jsxs("button",{disabled:!0,className:"px-2 py-1 text-xs text-neutral-400 cursor-not-allowed rounded flex items-center gap-1",children:[n.jsx(Dt,{className:"w-3.5 h-3.5"}),""]}),n.jsxs("button",{disabled:!0,className:"px-2 py-1 text-xs text-neutral-400 cursor-not-allowed rounded flex items-center gap-1",children:[n.jsx(qe,{className:"w-3.5 h-3.5"}),""]})]}):n.jsxs(n.Fragment,{children:[n.jsxs("button",{onClick:()=>te(R),className:"px-2 py-1 text-xs text-primary-600 hover:text-primary-800 hover:bg-primary-50 rounded transition-colors flex items-center gap-1",children:[n.jsx(Dt,{className:"w-3.5 h-3.5"}),""]}),n.jsxs("button",{onClick:()=>Y(R),className:"px-2 py-1 text-xs text-red-600 hover:text-red-800 hover:bg-red-50 rounded transition-colors flex items-center gap-1",children:[n.jsx(qe,{className:"w-3.5 h-3.5"}),""]})]})})})]},R.id))})]})}),n.jsxs("div",{className:"bg-white border-t border-neutral-200 px-6 py-3 flex items-center justify-center gap-6 flex-shrink-0",children:[n.jsxs("div",{className:"text-sm text-neutral-700",children:[" ",Q.length," "]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("button",{onClick:()=>b(Math.max(1,v-1)),disabled:v===1,className:`px-2 py-1 text-sm rounded transition-colors ${v===1?"bg-neutral-100 text-neutral-400 cursor-not-allowed":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:"<"}),n.jsx("div",{className:"flex items-center space-x-1",children:Array.from({length:Math.min(10,z)},(R,g)=>{let S;return z<=10||v<=5?S=g+1:v>=z-4?S=z-9+g:S=v-4+g,n.jsx("button",{onClick:()=>b(S),className:`px-2.5 py-1 text-sm rounded transition-colors ${v===S?"bg-primary-600 text-white":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:S},S)})}),z>10&&n.jsxs(n.Fragment,{children:[n.jsx("span",{className:"text-neutral-500",children:"..."}),n.jsx("button",{onClick:()=>b(z),className:`px-2.5 py-1 text-sm rounded transition-colors ${v===z?"bg-primary-600 text-white":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:z})]}),n.jsx("button",{onClick:()=>b(Math.min(z,v+1)),disabled:v===z,className:`px-2 py-1 text-sm rounded transition-colors ${v===z?"bg-neutral-100 text-neutral-400 cursor-not-allowed":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:">"})]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsxs("select",{value:y,onChange:R=>ne(Number(R.target.value)),className:"px-2 py-1 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500",children:[n.jsx("option",{value:10,children:"10/"}),n.jsx("option",{value:20,children:"20/"}),n.jsx("option",{value:50,children:"50/"})]}),n.jsx("span",{className:"text-sm text-neutral-700",children:""}),n.jsx("input",{type:"number",value:A,onChange:R=>k(R.target.value),onKeyDown:R=>R.key==="Enter"&&xe(),placeholder:"",className:"w-12 px-2 py-1 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500",min:1,max:z}),n.jsx("button",{onClick:xe,className:"px-3 py-1 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors",children:""})]})]})]})}),f&&h&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4",children:[n.jsx("div",{className:"px-6 py-4 border-b border-neutral-200",children:n.jsx("h3",{className:"text-lg font-medium text-neutral-900",children:""})}),n.jsx("div",{className:"p-6",children:n.jsxs("p",{className:"text-neutral-600",children:[" ",n.jsxs("span",{className:"font-medium",children:['"',h.projectName,'"']})," "]})}),n.jsxs("div",{className:"px-6 py-4 bg-neutral-50 flex justify-end gap-2 rounded-b-lg",children:[n.jsx("button",{onClick:()=>x(!1),className:"px-4 py-2 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-100 transition-colors",children:""}),n.jsx("button",{onClick:B,className:"px-4 py-2 text-sm bg-red-600 text-white rounded hover:bg-red-700 transition-colors",children:""})]})]})}),_&&P&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4",children:[n.jsx("div",{className:"px-6 py-4 border-b border-neutral-200",children:n.jsx("h3",{className:"text-lg font-medium text-neutral-900",children:""})}),n.jsx("div",{className:"p-6",children:n.jsx("p",{className:"text-neutral-600",children:""})}),n.jsxs("div",{className:"px-6 py-4 bg-neutral-50 flex justify-end gap-2 rounded-b-lg",children:[n.jsx("button",{onClick:()=>{j(!1),D(null)},className:"px-4 py-2 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-100 transition-colors",children:""}),n.jsx("button",{onClick:re,className:"px-4 py-2 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors",children:""})]})]})})]})},XE=({onBack:e,onStartParsing:t,initialProjectName:r="",initialFileName:a=""})=>{const[s,i]=M.useState(r),[l,c]=M.useState(a?[{name:a,size:0,category:"tender"}]:[]),[o,u]=M.useState(null),d=50*1024*1024,f=[{id:"tender",label:"",required:!0,description:""},{id:"specification",label:"",required:!1,description:""},{id:"other",label:"",required:!1,description:""}],x=P=>{if(P===0)return"0 B";const D=1024,K=["B","KB","MB","GB"],E=Math.floor(Math.log(P)/Math.log(D));return Math.round(P/Math.pow(D,E)*100)/100+" "+K[E]},h=(P,D)=>{const K=[],E=[".doc",".docx"];Array.from(P).forEach(Y=>{const B=Y.name.substring(Y.name.lastIndexOf(".")).toLowerCase();if(!E.includes(B)){alert(` "${Y.name}"  DOCDOCX `);return}if(Y.size>d){alert(` "${Y.name}" 50MB`);return}K.push({name:Y.name,size:Y.size,category:D})}),K.length>0&&(c([...l,...K]),!s&&K.length>0&&i(K[0].name.replace(/\.[^/.]+$/,"")))},p=(P,D)=>{P.preventDefault(),u(null),P.dataTransfer.files.length>0&&h(P.dataTransfer.files,D)},m=(P,D)=>{P.preventDefault(),u(D)},w=()=>{u(null)},v=(P,D)=>{P.target.files&&P.target.files.length>0&&h(P.target.files,D),P.target.value=""},b=()=>{if(!s.trim()){alert("");return}const P=l.filter(K=>K.category==="tender"),D=l.filter(K=>K.category==="specification");if(P.length===0){alert("");return}if(D.length===0){alert("");return}t(s.trim(),l)},y=P=>{c(l.filter((D,K)=>K!==P))},N=P=>l.filter(D=>D.category===P),A=P=>{const D=N(P.id),K=o===P.id;return n.jsxs("div",{className:"h-full flex flex-col border border-neutral-200 rounded-lg bg-neutral-50/50 p-4",children:[n.jsxs("div",{className:"mb-3",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsxs("label",{className:"text-sm font-semibold text-neutral-900",children:[P.label,P.required&&n.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),n.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-neutral-200 text-neutral-700",children:D.length})]}),n.jsx("p",{className:"text-xs text-neutral-500 leading-relaxed",children:P.description})]}),n.jsxs("div",{className:`border-2 border-dashed rounded-lg p-6 text-center transition-all cursor-pointer mb-3 ${K?"border-primary-500 bg-primary-50 scale-105":P.required&&D.length===0?"border-red-300 hover:border-red-400 bg-red-50/50":"border-neutral-300 hover:border-primary-400 hover:bg-white"}`,onDrop:E=>p(E,P.id),onDragOver:E=>m(E,P.id),onDragLeave:w,onClick:()=>{var E;return(E=document.getElementById(`file-upload-${P.id}`))==null?void 0:E.click()},children:[n.jsx(St,{className:`w-8 h-8 mx-auto mb-2 ${P.required&&D.length===0?"text-red-400":"text-neutral-400"}`}),n.jsx("p",{className:"text-sm text-neutral-700 font-medium mb-1",children:""}),n.jsx("p",{className:"text-xs text-neutral-500",children:""}),n.jsx("input",{id:`file-upload-${P.id}`,type:"file",className:"hidden",accept:".doc,.docx",multiple:!0,onChange:E=>v(E,P.id)})]}),D.length>0&&n.jsx("div",{className:"flex-1 overflow-auto space-y-2",children:D.map((E,Y)=>{const B=l.findIndex(te=>te.name===E.name&&te.category===E.category);return n.jsx("div",{className:"group bg-white px-2.5 py-2 rounded border border-neutral-200 hover:border-primary-300 hover:shadow-sm transition-all",children:n.jsxs("div",{className:"flex items-start justify-between gap-2",children:[n.jsxs("div",{className:"flex items-start space-x-2 flex-1 min-w-0",children:[n.jsx(Lt,{className:"w-4 h-4 text-primary-500 flex-shrink-0 mt-0.5"}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("p",{className:"text-xs text-neutral-900 truncate font-medium",title:E.name,children:E.name}),n.jsx("p",{className:"text-xs text-neutral-500 mt-0.5",children:x(E.size)})]})]}),n.jsx("button",{onClick:te=>{te.stopPropagation(),y(B)},className:"opacity-0 group-hover:opacity-100 text-red-500 hover:text-red-700 flex-shrink-0 transition-opacity",children:n.jsx(Qe,{className:"w-4 h-4"})})]})},Y)})})]})},k=l.filter(P=>P.category==="tender"),_=l.filter(P=>P.category==="specification"),j=s.trim()&&k.length>0&&_.length>0;return n.jsx("div",{className:"flex flex-col h-full",children:n.jsx("div",{className:"flex-1 overflow-auto",children:n.jsxs("div",{className:"bg-white rounded-lg border border-neutral-200",children:[n.jsx("div",{className:"px-6 py-4 border-b border-neutral-200",children:n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsx("button",{onClick:e,className:"text-neutral-600 hover:text-neutral-900 transition-colors",children:n.jsx(yi,{className:"w-5 h-5"})}),n.jsx("h2",{className:"text-lg font-medium text-neutral-900",children:""})]})}),n.jsxs("div",{className:"p-6",children:[n.jsxs("div",{className:"mb-6",children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:s,onChange:P=>i(P.target.value),placeholder:"",className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsx("div",{className:"grid grid-cols-3 gap-6",children:f.map(P=>n.jsx("div",{children:A(P)},P.id))}),(k.length===0||_.length===0)&&n.jsxs("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-4 flex items-start mt-6",children:[n.jsx(Cl,{className:"w-5 h-5 text-amber-600 mr-3 flex-shrink-0 mt-0.5"}),n.jsxs("div",{children:[n.jsx("h4",{className:"text-sm font-medium text-amber-900 mb-1",children:""}),n.jsxs("p",{className:"text-sm text-amber-700",children:[k.length===0&&_.length===0&&"",k.length===0&&_.length>0&&"",k.length>0&&_.length===0&&""]})]})]}),n.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mt-6",children:[n.jsx("h4",{className:"text-sm font-medium text-blue-900 mb-2",children:""}),n.jsxs("ul",{className:"text-sm text-blue-700 space-y-1",children:[n.jsx("li",{children:" "}),n.jsx("li",{children:" "}),n.jsx("li",{children:" "}),n.jsx("li",{children:" "}),n.jsx("li",{children:" "})]})]})]}),n.jsxs("div",{className:"px-6 py-4 bg-neutral-50 flex justify-between items-center gap-2 border-t border-neutral-200",children:[n.jsxs("div",{className:"text-sm text-neutral-600",children:[" ",n.jsx("span",{className:"font-medium text-neutral-900",children:l.length})," "]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx("button",{onClick:e,className:"px-4 py-2 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-100 transition-colors",children:""}),n.jsx("button",{onClick:b,disabled:!j,className:"px-6 py-2 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors disabled:bg-neutral-300 disabled:cursor-not-allowed",children:""})]})]})]})})})},KE=({projectId:e,projectName:t,onBack:r,onParsingComplete:a})=>{const[s,i]=M.useState(0),[l,c]=M.useState(0),[o,u]=M.useState(!1),d=[{id:0,name:"",description:"..."},{id:1,name:"",description:"..."},{id:2,name:"",description:"..."},{id:3,name:"",description:"..."},{id:4,name:"",description:"..."},{id:5,name:"",description:"..."},{id:6,name:"",description:"..."},{id:7,name:"",description:"..."},{id:8,name:"",description:""}];return M.useEffect(()=>{const f=setInterval(()=>{c(x=>x>=100?(clearInterval(f),100):x+1)},100);return()=>clearInterval(f)},[]),M.useEffect(()=>{const f=Math.floor(l/(100/d.length));f<d.length&&i(f),l===100&&setTimeout(()=>{a({basicInfo:{projectInfo:{projectName:"",projectNumber:"ZFCG-2024-001",packageName:"",packageNumber:"FB-01",lotName:"",lotNumber:"BD-01",projectOverview:"12",budgetAmount:" 5000 ",allowConsortium:"3"},tenderer:{name:"",contact:" / 010-12345678",email:"zhangsan@bjcy.gov.cn",address:"123",zipCode:"100020"},agent:{name:"",contact:" / 010-87654321",email:"lisi@zcbidding.com",address:"45610",zipCode:"100080"},keyTimeline:{bidDeadline:"20241215 09:00:00",submissionMethod:"",openingTime:"20241215 09:30:00",openingLocation:"123301"},bidBond:{submissionMethod:"",amount:" 50 500,000.00",refundPolicy:`1. 5
2. 5
3. 
   
   
   0200 1234 5678 9012 3456
   +`}},qualificationRequirements:`1. 
2. 2023
3. 
4. 
5. 
6. 21000
7. `,evaluationCriteria:{commercial:`1. 3030=/30
2. 1515105
3. 2013000520
4. 105000103000-500081000-30005
5. 52023155000-1350001`,technical:`1. 25
2. 15
3. 10PMP55
4. 10
5. 20`},documentRequirements:`1. 
2. A4
3. 1515
4. U2PDF
5. 
6. 
7. 
8. `,risks:`1. 
2. 
3. 
4. 
   - 
   - 
   - 
   - 
   - 
5. `,documentDirectory:{commercial:`
  1.1 
  1.2 

  2.1 
  2.2 

  3.1 
  3.2 
`,technical:""}})},1e3)},[l,a,d.length]),n.jsx("div",{className:"flex flex-col h-full",children:n.jsx("div",{className:"flex-1 overflow-auto",children:n.jsxs("div",{className:"bg-white rounded-lg border border-neutral-200",children:[n.jsx("div",{className:"px-6 py-4 border-b border-neutral-200",children:n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsx("button",{onClick:r,className:"text-neutral-600 hover:text-neutral-900 transition-colors",children:n.jsx(yi,{className:"w-5 h-5"})}),n.jsxs("div",{children:[n.jsx("h2",{className:"text-lg font-medium text-neutral-900",children:""}),n.jsx("p",{className:"text-sm text-neutral-500",children:t})]})]})}),n.jsxs("div",{className:"p-6",children:[n.jsxs("div",{className:"mb-8",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("span",{className:"text-sm font-medium text-neutral-700",children:""}),n.jsxs("span",{className:"text-sm font-medium text-primary-600",children:[l,"%"]})]}),n.jsx("div",{className:"w-full bg-neutral-200 rounded-full h-2",children:n.jsx("div",{className:"bg-primary-600 h-2 rounded-full transition-all duration-300",style:{width:`${l}%`}})})]}),n.jsx("div",{className:"space-y-4",children:d.map((f,x)=>{const h=x<s,p=x===s,m=x>s;return n.jsxs("div",{className:`flex items-start space-x-3 p-4 rounded-lg transition-colors ${p?"bg-blue-50 border border-blue-200":"bg-neutral-50"}`,children:[n.jsxs("div",{className:"flex-shrink-0 mt-0.5",children:[h&&n.jsx(aa,{className:"w-5 h-5 text-green-600"}),p&&n.jsx(Vu,{className:"w-5 h-5 text-blue-600 animate-spin"}),m&&n.jsx("div",{className:"w-5 h-5 rounded-full border-2 border-neutral-300"})]}),n.jsxs("div",{className:"flex-1",children:[n.jsx("h4",{className:`text-sm font-medium ${p?"text-blue-900":h?"text-neutral-900":"text-neutral-500"}`,children:f.name}),(p||h)&&n.jsx("p",{className:`text-xs mt-1 ${p?"text-blue-700":"text-neutral-500"}`,children:f.description})]})]},f.id)})}),o&&n.jsx("div",{className:"mt-6 p-4 bg-red-50 border border-red-200 rounded-lg",children:n.jsxs("div",{className:"flex items-start space-x-3",children:[n.jsx(Cl,{className:"w-5 h-5 text-red-600 flex-shrink-0 mt-0.5"}),n.jsxs("div",{children:[n.jsx("h4",{className:"text-sm font-medium text-red-900",children:""}),n.jsx("p",{className:"text-sm text-red-700 mt-1",children:""})]})]})})]}),n.jsx("div",{className:"px-6 py-4 bg-neutral-50 flex justify-between gap-2 border-t border-neutral-200",children:n.jsx("button",{onClick:r,className:"px-4 py-2 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-100 transition-colors",children:""})})]})})})},YE=({value:e,onChange:t,placeholder:r})=>{const a=M.useRef(null);M.useEffect(()=>{a.current&&a.current.innerHTML!==e&&(a.current.innerHTML=e||"")},[e]);const s=()=>{a.current&&t(a.current.innerHTML)},i=(c,o)=>{var u;document.execCommand(c,!1,o),(u=a.current)==null||u.focus(),s()},l=c=>{c.preventDefault();const o=c.clipboardData.getData("text/plain");document.execCommand("insertText",!1,o)};return n.jsxs("div",{className:"border-2 border-neutral-300 rounded-lg bg-white shadow-sm hover:border-primary-400 focus-within:border-primary-500 transition-colors",children:[n.jsxs("div",{className:"flex items-center gap-1 p-2 border-b border-neutral-200 bg-gradient-to-r from-neutral-50 to-neutral-100 flex-wrap rounded-t-lg",children:[n.jsx("button",{type:"button",onClick:()=>i("bold"),className:"p-1.5 hover:bg-primary-100 hover:text-primary-700 rounded transition-all active:scale-95",title:" (Ctrl+B)",children:n.jsx(fb,{className:"w-4 h-4"})}),n.jsx("button",{type:"button",onClick:()=>i("italic"),className:"p-1.5 hover:bg-primary-100 hover:text-primary-700 rounded transition-all active:scale-95",title:" (Ctrl+I)",children:n.jsx(bb,{className:"w-4 h-4"})}),n.jsx("button",{type:"button",onClick:()=>i("underline"),className:"p-1.5 hover:bg-primary-100 hover:text-primary-700 rounded transition-all active:scale-95",title:" (Ctrl+U)",children:n.jsx(Ab,{className:"w-4 h-4"})}),n.jsx("div",{className:"w-px h-6 bg-neutral-300 mx-1"}),n.jsx("button",{type:"button",onClick:()=>i("insertUnorderedList"),className:"p-1.5 hover:bg-primary-100 hover:text-primary-700 rounded transition-all active:scale-95",title:"",children:n.jsx(jb,{className:"w-4 h-4"})}),n.jsx("button",{type:"button",onClick:()=>i("insertOrderedList"),className:"p-1.5 hover:bg-primary-100 hover:text-primary-700 rounded transition-all active:scale-95",title:"",children:n.jsx(Nb,{className:"w-4 h-4"})}),n.jsx("div",{className:"w-px h-6 bg-neutral-300 mx-1"}),n.jsx("button",{type:"button",onClick:()=>i("justifyLeft"),className:"p-1.5 hover:bg-primary-100 hover:text-primary-700 rounded transition-all active:scale-95",title:"",children:n.jsx(ob,{className:"w-4 h-4"})}),n.jsx("button",{type:"button",onClick:()=>i("justifyCenter"),className:"p-1.5 hover:bg-primary-100 hover:text-primary-700 rounded transition-all active:scale-95",title:"",children:n.jsx(cb,{className:"w-4 h-4"})}),n.jsx("button",{type:"button",onClick:()=>i("justifyRight"),className:"p-1.5 hover:bg-primary-100 hover:text-primary-700 rounded transition-all active:scale-95",title:"",children:n.jsx(db,{className:"w-4 h-4"})}),n.jsx("div",{className:"w-px h-6 bg-neutral-300 mx-1"}),n.jsxs("select",{onChange:c=>i("formatBlock",c.target.value),className:"px-3 py-1.5 text-xs border border-neutral-300 rounded hover:bg-white hover:border-primary-400 transition-colors cursor-pointer",defaultValue:"",children:[n.jsx("option",{value:"",children:""}),n.jsx("option",{value:"h1",children:" 1"}),n.jsx("option",{value:"h2",children:" 2"}),n.jsx("option",{value:"h3",children:" 3"})]})]}),n.jsx("div",{ref:a,contentEditable:!0,onInput:s,onPaste:l,className:"min-h-[200px] max-h-[500px] overflow-y-auto p-4 text-sm focus:outline-none","data-placeholder":r,style:{whiteSpace:"pre-wrap"}})]})},qE=({projectId:e,projectName:t,initialData:r,projectStatus:a="parsed",onBack:s,onSave:i,onConfirm:l})=>{const c=H=>{const T=H.toLowerCase().replace(/\s+/g,"");return T.includes("")||T.includes("")?`<p><strong></strong></p>
<p><br></p>
<p>[]</p>
<p><br></p>
<p><strong>[]</strong><strong>[]</strong></p>
<p><br></p>
<p><strong></strong></p>
<p><br></p>
<p><strong></strong></p>
<p><br></p>
<p><strong></strong>[XX]</p>
<p><br></p>
<p><strong></strong></p>
<ol>
<li></li>
<li></li>
<li></li>
</ol>
<p><br></p>
<p><strong></strong></p>
<p><br></p>
<p>[]</p>
<p>_________</p>
<p>____________</p>`:T.includes("")||T.includes("")?`<p><strong></strong></p>
<p><br></p>
<p><strong>[]</strong><strong>[]</strong>""<strong>[]</strong><strong>[]</strong><strong>[]</strong><strong>[]</strong></p>
<p><br></p>
<p><strong></strong></p>
<ol>
<li></li>
<li></li>
<li></li>
<li></li>
</ol>
<p><br></p>
<p></p>
<p><br></p>
<p></p>
<p><br></p>
<p><strong></strong></p>
<ul>
<li></li>
<li></li>
</ul>
<p><br></p>
<p>[]</p>
<p>_________</p>
<p>_________</p>
<p><br></p>
<p>__________________</p>
<p>__________________</p>
<p><br></p>
<p>____________</p>`:""},u=(H=>{var Se,he,oe,De,Me,Ie,Oe,He,Ze,pt,Bt,nt,gt,Ut,Ge,dt,rt,ot,ir,se,ze,Be,kt,_r,an,sn,gr,Br,ln,cn,ee,We,Je,qt,tr,Sr,Et,Rt,ur,lt,C,U,I,L,V,X,le,ge,ie,ce,de,_e;const T={projectInfo:{projectName:((he=(Se=H==null?void 0:H.basicInfo)==null?void 0:Se.projectInfo)==null?void 0:he.projectName)||"",projectNumber:((De=(oe=H==null?void 0:H.basicInfo)==null?void 0:oe.projectInfo)==null?void 0:De.projectNumber)||"",packageName:((Ie=(Me=H==null?void 0:H.basicInfo)==null?void 0:Me.projectInfo)==null?void 0:Ie.packageName)||"",packageNumber:((He=(Oe=H==null?void 0:H.basicInfo)==null?void 0:Oe.projectInfo)==null?void 0:He.packageNumber)||"",lotName:((pt=(Ze=H==null?void 0:H.basicInfo)==null?void 0:Ze.projectInfo)==null?void 0:pt.lotName)||"",lotNumber:((nt=(Bt=H==null?void 0:H.basicInfo)==null?void 0:Bt.projectInfo)==null?void 0:nt.lotNumber)||"",projectOverview:((Ut=(gt=H==null?void 0:H.basicInfo)==null?void 0:gt.projectInfo)==null?void 0:Ut.projectOverview)||"",budgetAmount:((dt=(Ge=H==null?void 0:H.basicInfo)==null?void 0:Ge.projectInfo)==null?void 0:dt.budgetAmount)||"",allowConsortium:((ot=(rt=H==null?void 0:H.basicInfo)==null?void 0:rt.projectInfo)==null?void 0:ot.allowConsortium)||""},tenderer:{name:((se=(ir=H==null?void 0:H.basicInfo)==null?void 0:ir.tenderer)==null?void 0:se.name)||"",contact:((Be=(ze=H==null?void 0:H.basicInfo)==null?void 0:ze.tenderer)==null?void 0:Be.contact)||"",email:((_r=(kt=H==null?void 0:H.basicInfo)==null?void 0:kt.tenderer)==null?void 0:_r.email)||"",address:((sn=(an=H==null?void 0:H.basicInfo)==null?void 0:an.tenderer)==null?void 0:sn.address)||"",zipCode:((Br=(gr=H==null?void 0:H.basicInfo)==null?void 0:gr.tenderer)==null?void 0:Br.zipCode)||""},agent:{name:((cn=(ln=H==null?void 0:H.basicInfo)==null?void 0:ln.agent)==null?void 0:cn.name)||"",contact:((We=(ee=H==null?void 0:H.basicInfo)==null?void 0:ee.agent)==null?void 0:We.contact)||"",email:((qt=(Je=H==null?void 0:H.basicInfo)==null?void 0:Je.agent)==null?void 0:qt.email)||"",address:((Sr=(tr=H==null?void 0:H.basicInfo)==null?void 0:tr.agent)==null?void 0:Sr.address)||"",zipCode:((Rt=(Et=H==null?void 0:H.basicInfo)==null?void 0:Et.agent)==null?void 0:Rt.zipCode)||""},keyTimeline:{bidDeadline:((lt=(ur=H==null?void 0:H.basicInfo)==null?void 0:ur.keyTimeline)==null?void 0:lt.bidDeadline)||"",submissionMethod:((U=(C=H==null?void 0:H.basicInfo)==null?void 0:C.keyTimeline)==null?void 0:U.submissionMethod)||"",openingTime:((L=(I=H==null?void 0:H.basicInfo)==null?void 0:I.keyTimeline)==null?void 0:L.openingTime)||"",openingLocation:((X=(V=H==null?void 0:H.basicInfo)==null?void 0:V.keyTimeline)==null?void 0:X.openingLocation)||""},bidBond:{submissionMethod:((ge=(le=H==null?void 0:H.basicInfo)==null?void 0:le.bidBond)==null?void 0:ge.submissionMethod)||"",amount:((ce=(ie=H==null?void 0:H.basicInfo)==null?void 0:ie.bidBond)==null?void 0:ce.amount)||"",refundPolicy:((_e=(de=H==null?void 0:H.basicInfo)==null?void 0:de.bidBond)==null?void 0:_e.refundPolicy)||""}};if(!H.documentDirectory)return{...H,basicInfo:T,documentDirectory:{summary:`${a==="parsed"?"":""}`,files:[{name:"",items:[{title:"",description:""}]}]}};if(H.documentDirectory.files){const Ce=q=>{const J=c(q.title),fe=q.contentFormat&&q.contentFormat.trim()||J,be={...q,contentFormat:fe};return q.children&&q.children.length>0&&(be.children=q.children.map(Ce)),be},W=H.documentDirectory.files.map(q=>({...q,items:q.items.map(Ce)}));return{...H,basicInfo:T,documentDirectory:{...H.documentDirectory,files:W}}}const je=H.documentDirectory.commercial||"",pe=H.documentDirectory.technical||"",Le=[];return je.trim()&&Le.push({name:"",items:je.split(`
`).filter(Ce=>Ce.trim()).map(Ce=>{const W=Ce.trim();return{title:W,description:"",contentFormat:c(W)}})}),pe.trim()&&Le.push({name:"",items:pe.split(`
`).filter(Ce=>Ce.trim()).map(Ce=>{const W=Ce.trim();return{title:W,description:"",contentFormat:c(W)}})}),Le.length===0&&Le.push({name:"",items:[{title:"",description:""}]}),{...H,basicInfo:T,documentDirectory:{summary:"",files:Le}}})(r),[d,f]=M.useState(u),[x,h]=M.useState(null),[p,m]=M.useState(!1),[w,v]=M.useState("basicInfo"),[b,y]=M.useState(!1),[N,A]=M.useState(new Set),[k,_]=M.useState({projectInfo:[],tenderer:[],agent:[],keyTimeline:[],bidBond:[]});console.log("BiddingProjectReview - initialData:",r),console.log("BiddingProjectReview - normalizedInitialData:",u),console.log("BiddingProjectReview - data.basicInfo.projectInfo:",d.basicInfo.projectInfo);const j=[{id:"basicInfo",label:"",icon:Lt},{id:"qualificationRequirements",label:"",icon:aa},{id:"evaluationCriteria",label:"",icon:aa},{id:"documentRequirements",label:"",icon:Lt},{id:"risks",label:"/",icon:Kn},{id:"documentDirectory",label:a==="parsed"?"":"",icon:Od}],P=H=>{h(H)},D=()=>{h(null)},K=()=>{h(null),m(!0)},E=H=>{const T={id:`field_${Date.now()}`,label:"",value:""};_({...k,[H]:[...k[H],T]}),m(!0)},Y=(H,T,je,pe)=>{_({...k,[H]:k[H].map(Le=>Le.id===T?{...Le,[je]:pe}:Le)}),m(!0)},B=(H,T)=>{_({...k,[H]:k[H].filter(je=>je.id!==T)}),m(!0)},te=()=>j.findIndex(H=>H.id===w),re=()=>te()===j.length-1,Q=()=>{const H=te(),T=new Set(N);T.add(w),A(T),re()?y(!0):v(j[H+1].id)},Z=()=>{y(!1),l(d)},z=()=>{y(!1)},ne=(H,T)=>{const je=x===H;return n.jsx("div",{className:"px-4 py-3 flex items-start gap-2",children:je?n.jsxs(n.Fragment,{children:[n.jsx("input",{type:"text",value:T.label,onChange:pe=>Y(H,T.id,"label",pe.target.value),placeholder:"",className:"w-32 flex-shrink-0 px-3 py-1.5 text-sm border border-neutral-300 rounded focus:ring-2 focus:ring-primary-500 focus:border-primary-500"}),n.jsx("input",{type:"text",value:T.value,onChange:pe=>Y(H,T.id,"value",pe.target.value),placeholder:"",className:"flex-1 px-3 py-1.5 text-sm border border-neutral-300 rounded focus:ring-2 focus:ring-primary-500 focus:border-primary-500"}),n.jsx("button",{onClick:()=>B(H,T.id),className:"flex-shrink-0 p-2 text-red-600 hover:text-red-800 hover:bg-red-50 rounded transition-colors",title:"",children:n.jsx(qe,{className:"w-4 h-4"})})]}):n.jsxs(n.Fragment,{children:[n.jsx("label",{className:"w-32 text-sm font-medium text-neutral-600 flex-shrink-0",children:T.label}),n.jsx("div",{className:"flex-1 text-sm text-neutral-900 whitespace-pre-wrap",children:T.value||n.jsx("span",{className:"text-neutral-400 italic",children:""})})]})},T.id)},xe=(H,T,je,pe,Le="input",Se=!1,he,oe=!1)=>{const De=x===pe,Me=Ie=>{const Oe=Ie.split(`
`).length,He=Math.ceil(Ie.length/80);return Math.max(3,Math.min(15,Math.max(Oe,He)))};return n.jsxs("div",{className:"px-4 py-3 flex items-start gap-2",children:[!oe&&n.jsx("label",{className:"w-32 text-sm font-medium text-neutral-600 flex-shrink-0",children:H}),De?n.jsxs(n.Fragment,{children:[Le==="textarea"?n.jsx("textarea",{value:T,onChange:Ie=>je(Ie.target.value),rows:Me(T),className:`${oe?"w-full":"flex-1"} px-3 py-1.5 text-sm border border-neutral-300 rounded focus:ring-2 focus:ring-primary-500 focus:border-primary-500 font-mono`}):n.jsx("input",{type:"text",value:T,onChange:Ie=>je(Ie.target.value),className:`${oe?"w-full":"flex-1"} px-3 py-1.5 text-sm border border-neutral-300 rounded focus:ring-2 focus:ring-primary-500 focus:border-primary-500`}),Se&&he&&n.jsx("button",{onClick:he,className:"flex-shrink-0 p-2 text-red-600 hover:text-red-800 hover:bg-red-50 rounded transition-colors",title:"",children:n.jsx(qe,{className:"w-4 h-4"})})]}):n.jsx("div",{className:`${oe?"w-full":"flex-1"} text-sm text-neutral-900 whitespace-pre-wrap`,children:T})]})},O=(H,T,je,pe=!1,Le)=>{const Se=x===T,he=a==="completed";return n.jsxs("div",{className:"border border-neutral-200 rounded-lg overflow-hidden",children:[n.jsxs("div",{className:"bg-neutral-50 px-4 py-3 border-b border-neutral-200 flex items-center justify-between",children:[n.jsx("h4",{className:"text-sm font-semibold text-neutral-900",children:H}),!he&&(Se?n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsxs("button",{onClick:K,className:"text-green-600 hover:text-green-800 transition-colors flex items-center text-sm",children:[n.jsx(Xx,{className:"w-4 h-4 mr-1"}),""]}),n.jsxs("button",{onClick:D,className:"text-neutral-600 hover:text-neutral-800 transition-colors flex items-center text-sm",children:[n.jsx(Qe,{className:"w-4 h-4 mr-1"}),""]})]}):n.jsxs("button",{onClick:()=>P(T),className:"text-primary-600 hover:text-primary-800 transition-colors flex items-center text-sm",children:[n.jsx(Rd,{className:"w-4 h-4 mr-1"}),""]}))]}),n.jsx("div",{className:"divide-y divide-neutral-200",children:je}),Se&&pe&&Le&&n.jsx("div",{className:"px-4 py-3 border-t border-neutral-200 bg-neutral-50",children:n.jsxs("button",{onClick:Le,className:"w-full px-4 py-2 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors flex items-center justify-center",children:[n.jsx(Pt,{className:"w-4 h-4 mr-1"}),""]})})]})},R=()=>n.jsxs("div",{className:"p-6 space-y-6",children:[a!=="completed"&&n.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[n.jsx("h4",{className:"text-sm font-medium text-blue-900 mb-1",children:""}),n.jsx("p",{className:"text-sm text-blue-700",children:'""'})]}),O("1. ","projectInfo",n.jsxs(n.Fragment,{children:[xe("",d.basicInfo.projectInfo.projectName,H=>f({...d,basicInfo:{...d.basicInfo,projectInfo:{...d.basicInfo.projectInfo,projectName:H}}}),"projectInfo"),xe("",d.basicInfo.projectInfo.projectNumber,H=>f({...d,basicInfo:{...d.basicInfo,projectInfo:{...d.basicInfo.projectInfo,projectNumber:H}}}),"projectInfo"),xe("",d.basicInfo.projectInfo.packageName,H=>f({...d,basicInfo:{...d.basicInfo,projectInfo:{...d.basicInfo.projectInfo,packageName:H}}}),"projectInfo"),xe("",d.basicInfo.projectInfo.packageNumber,H=>f({...d,basicInfo:{...d.basicInfo,projectInfo:{...d.basicInfo.projectInfo,packageNumber:H}}}),"projectInfo"),xe("",d.basicInfo.projectInfo.lotName,H=>f({...d,basicInfo:{...d.basicInfo,projectInfo:{...d.basicInfo.projectInfo,lotName:H}}}),"projectInfo"),xe("",d.basicInfo.projectInfo.lotNumber,H=>f({...d,basicInfo:{...d.basicInfo,projectInfo:{...d.basicInfo.projectInfo,lotNumber:H}}}),"projectInfo"),xe("",d.basicInfo.projectInfo.budgetAmount,H=>f({...d,basicInfo:{...d.basicInfo,projectInfo:{...d.basicInfo.projectInfo,budgetAmount:H}}}),"projectInfo"),xe("",d.basicInfo.projectInfo.allowConsortium,H=>f({...d,basicInfo:{...d.basicInfo,projectInfo:{...d.basicInfo.projectInfo,allowConsortium:H}}}),"projectInfo"),xe("",d.basicInfo.projectInfo.projectOverview,H=>f({...d,basicInfo:{...d.basicInfo,projectInfo:{...d.basicInfo.projectInfo,projectOverview:H}}}),"projectInfo","textarea"),k.projectInfo.map(H=>ne("projectInfo",H))]}),!0,()=>E("projectInfo")),O("2. ","tenderer",n.jsxs(n.Fragment,{children:[xe("",d.basicInfo.tenderer.name,H=>f({...d,basicInfo:{...d.basicInfo,tenderer:{...d.basicInfo.tenderer,name:H}}}),"tenderer"),xe("",d.basicInfo.tenderer.contact,H=>f({...d,basicInfo:{...d.basicInfo,tenderer:{...d.basicInfo.tenderer,contact:H}}}),"tenderer"),xe("",d.basicInfo.tenderer.email,H=>f({...d,basicInfo:{...d.basicInfo,tenderer:{...d.basicInfo.tenderer,email:H}}}),"tenderer"),xe("",d.basicInfo.tenderer.address,H=>f({...d,basicInfo:{...d.basicInfo,tenderer:{...d.basicInfo.tenderer,address:H}}}),"tenderer"),xe("",d.basicInfo.tenderer.zipCode,H=>f({...d,basicInfo:{...d.basicInfo,tenderer:{...d.basicInfo.tenderer,zipCode:H}}}),"tenderer"),k.tenderer.map(H=>ne("tenderer",H))]}),!0,()=>E("tenderer")),O("3. ","agent",n.jsxs(n.Fragment,{children:[xe("",d.basicInfo.agent.name,H=>f({...d,basicInfo:{...d.basicInfo,agent:{...d.basicInfo.agent,name:H}}}),"agent"),xe("",d.basicInfo.agent.contact,H=>f({...d,basicInfo:{...d.basicInfo,agent:{...d.basicInfo.agent,contact:H}}}),"agent"),xe("",d.basicInfo.agent.email,H=>f({...d,basicInfo:{...d.basicInfo,agent:{...d.basicInfo.agent,email:H}}}),"agent"),xe("",d.basicInfo.agent.address,H=>f({...d,basicInfo:{...d.basicInfo,agent:{...d.basicInfo.agent,address:H}}}),"agent"),xe("",d.basicInfo.agent.zipCode,H=>f({...d,basicInfo:{...d.basicInfo,agent:{...d.basicInfo.agent,zipCode:H}}}),"agent"),k.agent.map(H=>ne("agent",H))]}),!0,()=>E("agent")),O("4. ","keyTimeline",n.jsxs(n.Fragment,{children:[xe("",d.basicInfo.keyTimeline.bidDeadline,H=>f({...d,basicInfo:{...d.basicInfo,keyTimeline:{...d.basicInfo.keyTimeline,bidDeadline:H}}}),"keyTimeline"),xe("",d.basicInfo.keyTimeline.submissionMethod,H=>f({...d,basicInfo:{...d.basicInfo,keyTimeline:{...d.basicInfo.keyTimeline,submissionMethod:H}}}),"keyTimeline"),xe("",d.basicInfo.keyTimeline.openingTime,H=>f({...d,basicInfo:{...d.basicInfo,keyTimeline:{...d.basicInfo.keyTimeline,openingTime:H}}}),"keyTimeline"),xe("",d.basicInfo.keyTimeline.openingLocation,H=>f({...d,basicInfo:{...d.basicInfo,keyTimeline:{...d.basicInfo.keyTimeline,openingLocation:H}}}),"keyTimeline"),k.keyTimeline.map(H=>ne("keyTimeline",H))]}),!0,()=>E("keyTimeline")),O("5. ","bidBond",n.jsxs(n.Fragment,{children:[xe("",d.basicInfo.bidBond.submissionMethod,H=>f({...d,basicInfo:{...d.basicInfo,bidBond:{...d.basicInfo.bidBond,submissionMethod:H}}}),"bidBond"),xe("",d.basicInfo.bidBond.amount,H=>f({...d,basicInfo:{...d.basicInfo,bidBond:{...d.basicInfo.bidBond,amount:H}}}),"bidBond"),xe("",d.basicInfo.bidBond.refundPolicy,H=>f({...d,basicInfo:{...d.basicInfo,bidBond:{...d.basicInfo.bidBond,refundPolicy:H}}}),"bidBond","textarea"),k.bidBond.map(H=>ne("bidBond",H))]}),!0,()=>E("bidBond"))]}),g=()=>{const H=d.qualificationRequirements.split(`
`),T=H.length===1&&H[0].trim()===""?[]:H,je=(Se,he)=>{const oe=[...T];oe[Se]=he,f({...d,qualificationRequirements:oe.join(`
`)})},pe=Se=>{const he=T.filter((oe,De)=>De!==Se);f({...d,qualificationRequirements:he.length>0?he.join(`
`):""})},Le=()=>{const Se=[...T,""];f({...d,qualificationRequirements:Se.join(`
`)})};return n.jsxs("div",{className:"p-6 space-y-4",children:[a!=="completed"&&n.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[n.jsx("h4",{className:"text-sm font-medium text-blue-900 mb-1",children:""}),n.jsx("p",{className:"text-sm text-blue-700",children:'""'})]}),O("","qualificationRequirements",n.jsx(n.Fragment,{children:T.length===0?n.jsx("div",{className:"px-4 py-8 text-center text-neutral-500",children:'""'}):T.map((Se,he)=>xe("",Se,oe=>je(he,oe),"qualificationRequirements","textarea",!0,()=>pe(he),!0))}),!0,Le)]})},S=()=>{const H=d.evaluationCriteria.commercial.split(`
`),T=H.length===1&&H[0].trim()===""?[]:H,je=d.evaluationCriteria.technical.split(`
`),pe=je.length===1&&je[0].trim()===""?[]:je,Le=(Ie,Oe)=>{const He=[...T];He[Ie]=Oe,f({...d,evaluationCriteria:{...d.evaluationCriteria,commercial:He.join(`
`)}})},Se=Ie=>{const Oe=T.filter((He,Ze)=>Ze!==Ie);f({...d,evaluationCriteria:{...d.evaluationCriteria,commercial:Oe.length>0?Oe.join(`
`):""}})},he=()=>{const Ie=[...T,""];f({...d,evaluationCriteria:{...d.evaluationCriteria,commercial:Ie.join(`
`)}})},oe=(Ie,Oe)=>{const He=[...pe];He[Ie]=Oe,f({...d,evaluationCriteria:{...d.evaluationCriteria,technical:He.join(`
`)}})},De=Ie=>{const Oe=pe.filter((He,Ze)=>Ze!==Ie);f({...d,evaluationCriteria:{...d.evaluationCriteria,technical:Oe.length>0?Oe.join(`
`):""}})},Me=()=>{const Ie=[...pe,""];f({...d,evaluationCriteria:{...d.evaluationCriteria,technical:Ie.join(`
`)}})};return n.jsxs("div",{className:"p-6 space-y-4",children:[a!=="completed"&&n.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[n.jsx("h4",{className:"text-sm font-medium text-blue-900 mb-1",children:""}),n.jsx("p",{className:"text-sm text-blue-700",children:'""'})]}),O("","evaluationCommercial",n.jsx(n.Fragment,{children:T.length===0?n.jsx("div",{className:"px-4 py-8 text-center text-neutral-500",children:'""'}):T.map((Ie,Oe)=>xe("",Ie,He=>Le(Oe,He),"evaluationCommercial","textarea",!0,()=>Se(Oe),!0))}),!0,he),O("","evaluationTechnical",n.jsx(n.Fragment,{children:pe.length===0?n.jsx("div",{className:"px-4 py-8 text-center text-neutral-500",children:'""'}):pe.map((Ie,Oe)=>xe("",Ie,He=>oe(Oe,He),"evaluationTechnical","textarea",!0,()=>De(Oe),!0))}),!0,Me)]})},F=()=>{const H=d.documentRequirements.split(`
`),T=H.length===1&&H[0].trim()===""?[]:H,je=(Se,he)=>{const oe=[...T];oe[Se]=he,f({...d,documentRequirements:oe.join(`
`)})},pe=Se=>{const he=T.filter((oe,De)=>De!==Se);f({...d,documentRequirements:he.length>0?he.join(`
`):""})},Le=()=>{const Se=[...T,""];f({...d,documentRequirements:Se.join(`
`)})};return n.jsxs("div",{className:"p-6 space-y-4",children:[a!=="completed"&&n.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[n.jsx("h4",{className:"text-sm font-medium text-blue-900 mb-1",children:""}),n.jsx("p",{className:"text-sm text-blue-700",children:'""'})]}),O("","documentRequirements",n.jsx(n.Fragment,{children:T.length===0?n.jsx("div",{className:"px-4 py-8 text-center text-neutral-500",children:'""'}):T.map((Se,he)=>xe("",Se,oe=>je(he,oe),"documentRequirements","textarea",!0,()=>pe(he),!0))}),!0,Le)]})},ae=()=>{const T=d.risks.split(`
`).filter(Ie=>Ie.trim()!==""),je=[],pe=[];T.forEach(Ie=>{const Oe=Ie.trim();Oe.includes("")||Oe.includes("")?pe.push(Oe):je.push(Oe)});const Le=(Ie,Oe)=>{const He=[...je];He[Ie]=Oe;const Ze=[...He,...pe];f({...d,risks:Ze.join(`
`)})},Se=Ie=>{const He=[...je.filter((Ze,pt)=>pt!==Ie),...pe];f({...d,risks:He.length>0?He.join(`
`):""})},he=()=>{const Oe=[...[...je,""],...pe];f({...d,risks:Oe.join(`
`)})},oe=(Ie,Oe)=>{const He=[...pe];He[Ie]=Oe;const Ze=[...je,...He];f({...d,risks:Ze.join(`
`)})},De=Ie=>{const Oe=pe.filter((Ze,pt)=>pt!==Ie),He=[...je,...Oe];f({...d,risks:He.length>0?He.join(`
`):""})},Me=()=>{const Ie=[...pe,""],Oe=[...je,...Ie];f({...d,risks:Oe.join(`
`)})};return n.jsxs("div",{className:"p-6 space-y-4",children:[a!=="completed"&&n.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[n.jsx("h4",{className:"text-sm font-medium text-blue-900 mb-1",children:""}),n.jsx("p",{className:"text-sm text-blue-700",children:'""'})]}),O("","riskItems",n.jsx(n.Fragment,{children:je.length===0?n.jsx("div",{className:"px-4 py-8 text-center text-neutral-500",children:'""'}):je.map((Ie,Oe)=>xe("",Ie,He=>Le(Oe,He),"riskItems","textarea",!0,()=>Se(Oe),!0))}),!0,he),O("","invalidItems",n.jsx(n.Fragment,{children:pe.length===0?n.jsx("div",{className:"px-4 py-8 text-center text-neutral-500",children:'""'}):pe.map((Ie,Oe)=>xe("",Ie,He=>oe(Oe,He),"invalidItems","textarea",!0,()=>De(Oe),!0))}),!0,Me)]})},ue=(H,T=0,je,pe)=>{const Le=x==="documentDirectory",Se=T*24,he=(Me,Ie)=>{const Oe=[...d.documentDirectory.files];let He=Oe[je].items;for(let Ze=0;Ze<pe.length-1;Ze++)He=He[pe[Ze]].children;He[pe[pe.length-1]][Me]=Ie,f({...d,documentDirectory:{...d.documentDirectory,files:Oe}})},oe=()=>{const Me=[...d.documentDirectory.files];let Ie=Me[je].items;for(let Oe=0;Oe<pe.length;Oe++)Oe===pe.length-1?(Ie[pe[Oe]].children||(Ie[pe[Oe]].children=[]),Ie[pe[Oe]].children.push({title:"",description:""})):Ie=Ie[pe[Oe]].children;f({...d,documentDirectory:{...d.documentDirectory,files:Me}})},De=()=>{const Me=[...d.documentDirectory.files];let Ie=Me[je].items;if(pe.length===1)Me[je].items.splice(pe[0],1);else{for(let Oe=0;Oe<pe.length-1;Oe++)Ie=Ie[pe[Oe]].children;Ie.splice(pe[pe.length-1],1)}f({...d,documentDirectory:{...d.documentDirectory,files:Me}})};return n.jsxs("div",{className:"mb-2",children:[n.jsx("div",{style:{paddingLeft:`${Se}px`},className:"border-l-2 border-neutral-200 pl-3",children:Le?n.jsxs("div",{className:"space-y-2 bg-neutral-50 p-3 rounded border border-neutral-200",children:[n.jsxs("div",{className:"flex items-start gap-2",children:[n.jsx("input",{type:"text",value:H.title,onChange:Me=>he("title",Me.target.value),className:"flex-1 px-2 py-1 text-sm border border-neutral-300 rounded focus:ring-2 focus:ring-primary-500 focus:border-primary-500 font-medium",placeholder:""}),n.jsx("button",{onClick:oe,className:"p-1 text-green-600 hover:bg-green-50 rounded",title:"",children:n.jsx(Pt,{className:"w-4 h-4"})}),T>0&&n.jsx("button",{onClick:De,className:"p-1 text-red-600 hover:bg-red-50 rounded",title:"",children:n.jsx(qe,{className:"w-4 h-4"})})]}),n.jsx("textarea",{value:H.description,onChange:Me=>he("description",Me.target.value),rows:2,className:"w-full px-2 py-1 text-xs text-neutral-600 border border-neutral-300 rounded focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:""}),a==="parsed"&&n.jsxs("div",{className:"space-y-2",children:[n.jsx("label",{className:"text-xs font-medium text-neutral-700",children:""}),n.jsx(YE,{value:H.contentFormat||"",onChange:Me=>he("contentFormat",Me),placeholder:"..."})]})]}):n.jsxs("div",{children:[n.jsx("div",{className:"font-medium text-sm text-neutral-900",children:H.title}),H.description&&n.jsxs("div",{className:"text-xs text-neutral-600 mt-0.5",children:["",H.description]}),a==="parsed"&&n.jsxs("div",{className:"mt-2 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("div",{className:"text-xs font-medium text-blue-900",children:""}),H.contentFormat&&H.contentFormat.replace(/<[^>]*>/g,"").trim()&&n.jsx("span",{className:"text-xs text-blue-600 bg-blue-100 px-2 py-0.5 rounded",children:""})]}),H.contentFormat&&H.contentFormat.replace(/<[^>]*>/g,"").trim()?n.jsx("div",{className:"text-xs text-neutral-800 prose prose-sm max-w-none bg-white p-3 rounded border border-blue-100",style:{lineHeight:"1.6"},dangerouslySetInnerHTML:{__html:H.contentFormat}}):n.jsx("div",{className:"text-xs text-blue-600 italic bg-blue-100 p-2 rounded text-center",children:""})]})]})}),H.children&&H.children.length>0&&n.jsx("div",{className:"mt-2",children:H.children.map((Me,Ie)=>ue(Me,T+1,je,[...pe,Ie]))})]},pe.join("-"))},ve=()=>{const H=x==="documentDirectory";if(!d.documentDirectory||!d.documentDirectory.files)return n.jsx("div",{className:"p-6",children:n.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:n.jsxs("p",{className:"text-sm text-red-700",children:[a==="parsed"?"":"",""]})})});const T=()=>{const Se=[...d.documentDirectory.files,{name:"",items:[{title:"",description:""}]}];f({...d,documentDirectory:{...d.documentDirectory,files:Se}})},je=Se=>{const he=d.documentDirectory.files.filter((oe,De)=>De!==Se);f({...d,documentDirectory:{...d.documentDirectory,files:he}})},pe=(Se,he)=>{const oe=[...d.documentDirectory.files];oe[Se].name=he,f({...d,documentDirectory:{...d.documentDirectory,files:oe}})},Le=Se=>{const he=[...d.documentDirectory.files];he[Se].items.push({title:"",description:""}),f({...d,documentDirectory:{...d.documentDirectory,files:he}})};return n.jsxs("div",{className:"p-6 space-y-4",children:[a!=="completed"&&n.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[n.jsx("h4",{className:"text-sm font-medium text-blue-900 mb-1",children:""}),n.jsxs("p",{className:"text-sm text-blue-700",children:['""',a==="parsed"?"":"",""]})]}),n.jsxs("div",{className:"border border-neutral-200 rounded-lg overflow-hidden",children:[n.jsxs("div",{className:"bg-neutral-50 px-4 py-3 border-b border-neutral-200 flex items-center justify-between",children:[n.jsx("h4",{className:"text-sm font-semibold text-neutral-900",children:a==="parsed"?"":""}),!a||a!=="completed"?H?n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsxs("button",{onClick:K,className:"text-green-600 hover:text-green-800 transition-colors flex items-center text-sm",children:[n.jsx(Xx,{className:"w-4 h-4 mr-1"}),""]}),n.jsxs("button",{onClick:D,className:"text-neutral-600 hover:text-neutral-800 transition-colors flex items-center text-sm",children:[n.jsx(Qe,{className:"w-4 h-4 mr-1"}),""]})]}):n.jsxs("button",{onClick:()=>P("documentDirectory"),className:"text-primary-600 hover:text-primary-800 transition-colors flex items-center text-sm",children:[n.jsx(Rd,{className:"w-4 h-4 mr-1"}),""]}):null]}),n.jsxs("div",{className:"p-4 space-y-4",children:[n.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded p-3",children:n.jsx("div",{className:"text-sm text-amber-900 whitespace-pre-wrap",children:d.documentDirectory.summary})}),d.documentDirectory.files.map((Se,he)=>n.jsxs("div",{className:"border border-neutral-300 rounded-lg overflow-hidden",children:[n.jsxs("div",{className:"bg-neutral-100 px-3 py-2 flex items-center justify-between",children:[H?n.jsx("input",{type:"text",value:Se.name,onChange:oe=>pe(he,oe.target.value),className:"flex-1 px-2 py-1 text-sm font-semibold border border-neutral-300 rounded focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:""}):n.jsx("h5",{className:"text-sm font-semibold text-neutral-900",children:Se.name}),H&&n.jsxs("div",{className:"flex items-center gap-2 ml-2",children:[n.jsx("button",{onClick:()=>Le(he),className:"p-1 text-green-600 hover:bg-green-50 rounded text-xs",title:"",children:n.jsx(Pt,{className:"w-4 h-4"})}),d.documentDirectory.files.length>1&&n.jsx("button",{onClick:()=>je(he),className:"p-1 text-red-600 hover:bg-red-50 rounded text-xs",title:"",children:n.jsx(qe,{className:"w-4 h-4"})})]})]}),n.jsx("div",{className:"p-3 space-y-2",children:Se.items.map((oe,De)=>ue(oe,0,he,[De]))})]},he)),H&&n.jsxs("button",{onClick:T,className:"w-full py-2 border-2 border-dashed border-neutral-300 rounded-lg text-neutral-600 hover:border-primary-500 hover:text-primary-600 transition-colors flex items-center justify-center gap-2",children:[n.jsx(Pt,{className:"w-4 h-4"}),""]})]})]})]})},me=()=>{switch(w){case"basicInfo":return R();case"qualificationRequirements":return g();case"evaluationCriteria":return S();case"documentRequirements":return F();case"risks":return ae();case"documentDirectory":return ve();default:return R()}};return n.jsxs("div",{className:"flex flex-col h-full",children:[n.jsx("div",{className:"bg-white border-b border-neutral-200 px-6 py-4",children:n.jsxs("div",{className:"flex items-center space-x-4",children:[n.jsx("button",{onClick:s,className:"text-neutral-600 hover:text-neutral-900 transition-colors",children:n.jsx(yi,{className:"w-6 h-6"})}),n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsx("h2",{className:"text-lg font-medium text-neutral-900",children:t}),n.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:""})]}),n.jsx("p",{className:"text-sm text-neutral-500",children:""})]})]})}),n.jsx("div",{className:"bg-white border-b border-neutral-200",children:n.jsx("div",{className:"flex overflow-x-auto",children:j.map(H=>{const T=H.icon,je=N.has(H.id);return n.jsxs("button",{onClick:()=>v(H.id),className:`flex items-center space-x-2 px-6 py-3 border-b-2 transition-colors whitespace-nowrap relative ${w===H.id?"border-primary-600 text-primary-600":"border-transparent text-neutral-600 hover:text-neutral-900 hover:border-neutral-300"}`,children:[n.jsx(T,{className:"w-4 h-4"}),n.jsx("span",{className:"text-sm font-medium",children:H.label}),je&&a!=="completed"&&n.jsx(aa,{className:"w-4 h-4 text-green-600"})]},H.id)})})}),n.jsx("div",{className:"flex-1 overflow-auto",children:me()}),n.jsxs("div",{className:"bg-white border-t border-neutral-200 px-6 py-4 flex justify-between gap-2",children:[n.jsx("button",{onClick:s,className:"px-4 py-2 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-100 transition-colors",children:""}),a!=="completed"&&n.jsx("button",{onClick:Q,className:"px-6 py-2 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors",children:re()?"":""})]}),b&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4",children:[n.jsx("div",{className:"px-6 py-4 border-b border-neutral-200",children:n.jsx("h3",{className:"text-lg font-semibold text-neutral-900",children:""})}),n.jsxs("div",{className:"px-6 py-4",children:[n.jsx("p",{className:"text-neutral-700 mb-4",children:""}),n.jsxs("p",{className:"text-sm text-amber-600 flex items-start",children:[n.jsx(Kn,{className:"w-4 h-4 mr-2 mt-0.5 flex-shrink-0"}),n.jsx("span",{children:""})]})]}),n.jsxs("div",{className:"px-6 py-4 border-t border-neutral-200 flex justify-end gap-3",children:[n.jsx("button",{onClick:z,className:"px-4 py-2 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-50 transition-colors",children:""}),n.jsx("button",{onClick:Z,className:"px-4 py-2 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors",children:""})]})]})})]})},ah=({canEdit:e=!0,canDelete:t=!0})=>{const r="bidding_projects_v8",[a,s]=M.useState(()=>(["bidding_projects_v7","bidding_projects_v6","bidding_projects_v5","bidding_projects_v4","bidding_projects_v3","bidding_projects_v2","bidding_projects_v1","bidding_projects"].forEach(b=>{localStorage.removeItem(b)}),[{id:"5",projectName:"",status:"parsing",uploadTime:"2025-10-13 10:15:00",fileName:".pdf",parseProgress:65},{id:"4",projectName:"",status:"failed",uploadTime:"2025-10-12 11:00:00",fileName:".pdf",parseProgress:0,errorMessage:""},{id:"2",projectName:"",status:"parsed",uploadTime:"2025-10-11 14:20:00",fileName:".pdf",parseProgress:100,parsedData:{basicInfo:{projectInfo:{projectName:"",projectNumber:"ZFCG-2025-088",packageName:"",packageNumber:"FB-01",lotName:"",lotNumber:"BD-01",projectOverview:"3",budgetAmount:" 800 ",allowConsortium:""},tenderer:{name:"",contact:" / 0755-12345678",email:"wangzr@techpark.gov.cn",address:"100",zipCode:"518057"},agent:{name:"",contact:" / 0755-87654321",email:"lijl@jxbidding.com",address:"100020",zipCode:"518040"},keyTimeline:{bidDeadline:"20251028 09:30:00",submissionMethod:"U",openingTime:"20251028 10:00:00",openingLocation:"5503"},bidBond:{submissionMethod:"",amount:" 80 800,000.00",refundPolicy:`1. 5
2. 5
3. 
   
   
   7559 1234 5678 9012
   -ZFCG-2025-088+`}},qualificationRequirements:`1. 
2. 2024
3. 
4. 2000
5. ISO9001
6. 
7. 2500
8. `,evaluationCriteria:{commercial:`17-27
1. 1-54-52-3.51-1.5
2. 1-54-52-3.51-1.5
3. 15-171715
36-65
1. 3-5543
2. 3-5451-343
3. 3-5ESG///2/35143
4. 3-443
5. 3-525143
6. 5-737365
7. 4-6X30615X305X154
8. 3-5332%53433
9. 0-220
10. 3-5:543
11. 6-8""""876
12. 0-3""""""3322110
13. 0-220
14. 0-1""10
15. 0-222110
4-8
1. 4-8864
-65-0
1. -30-032351012102011530
2. -10-0113053010
3. -20-020
4. -5-05`,technical:`30-50
1. 5-1515105
2. 25-35:31~3526~3025
12-20
1. 6-1080%80%:9~105080%50%7~850%6
2. 6-10:9~107~86
6-10
1. 5M1E6-8:876
2. 0-2
6-10
1. 6-10:1086
6-10
1. 6-10:9~107~86`},documentRequirements:`1. 
2. A4
3. 1313
4. U2PDF
5. 
6. /
7. 
8. 
9. `,risks:`1. 
2. 
3. 
   - 
   - 
   - 
   - 
   - 
   - IP
4. 3
5. 
6. 
7. 
8. `,documentDirectory:{summary:"3",files:[{name:"",items:[{title:"",description:"",children:[{title:"1.1 ",description:""},{title:"1.2 ",description:""}]},{title:"",description:"",children:[{title:"2.1 ",description:""},{title:"2.2 ",description:""},{title:"2.3 ",description:""}]},{title:"",description:"",children:[{title:"3.1 ",description:""},{title:"3.2 ",description:""}]}]},{name:"",items:[{title:"",description:"",children:[{title:"1.1 ",description:""},{title:"1.2 ",description:""},{title:"1.3 ",description:""}]},{title:"",description:"",children:[{title:"2.1 ",description:""},{title:"2.2 ",description:""},{title:"2.3 ",description:""}]},{title:"",description:"",children:[{title:"3.1 ",description:""},{title:"3.2 ",description:""}]}]},{name:"",items:[{title:"",description:""}]}]}}},{id:"1",projectName:"",status:"pending",uploadTime:"2025-10-10 09:30:00",fileName:".pdf"},{id:"3",projectName:"",status:"parsed",uploadTime:"2025-10-09 16:45:00",fileName:".pdf",parseProgress:100,parsedData:{basicInfo:{tenderer:"",agent:"",projectInfo:"",keyTimeline:"2025-10-25 09:00",bidBond:"50"},qualificationRequirements:"500",evaluationCriteria:{commercial:"4020",technical:"3010"},documentRequirements:"",risks:"",documentDirectory:{summary:"2",files:[{name:"",items:[{title:" ",description:""},{title:" ",description:""},{title:" ",description:""}]},{name:"",items:[{title:" ",description:""},{title:" ",description:""},{title:" ",description:""}]}]}}},{id:"5",projectName:"",status:"completed",uploadTime:"2025-10-08 10:15:00",fileName:".pdf",parseProgress:100,parsedData:{basicInfo:{tenderer:"",agent:"",projectInfo:"",keyTimeline:"2025-10-20 14:00",bidBond:"30"},qualificationRequirements:"2",evaluationCriteria:{commercial:"5010",technical:"3010"},documentRequirements:"",risks:"",documentDirectory:{summary:"2",files:[{name:"",items:[{title:" ",description:""},{title:" ",description:""},{title:" ",description:""}]},{name:"",items:[{title:" ",description:""},{title:" ",description:""},{title:" ",description:""}]}]}}}])),[i,l]=M.useState("list"),[c,o]=M.useState(null);M.useEffect(()=>{localStorage.setItem(r,JSON.stringify(a))},[a]);const u=(b,y)=>{const N=y.map(k=>k.name).join(", "),A={id:String(Date.now()),projectName:b,status:"parsing",uploadTime:new Date().toISOString().slice(0,19).replace("T"," "),fileName:N,parseProgress:0};s([...a,A]),o(A),l("parsing")},d=b=>{if(c){const y={...c,status:"parsed",parseProgress:100,parsedData:b};s(a.map(N=>N.id===c.id?y:N)),o(y),l("review")}},f=b=>{if(c){const y={...c,parsedData:b};s(a.map(N=>N.id===c.id?y:N)),o(y)}},x=b=>{if(c){const y={...c,status:"completed",parsedData:b};s(a.map(N=>N.id===c.id?y:N)),l("list"),o(null)}},h=()=>{l("list"),o(null)},p=b=>{o(b),b.status==="pending"||b.status==="failed"?l("upload"):b.status==="parsing"?l("parsing"):(b.status==="parsed"||b.status==="completed")&&l("review")},m=b=>{s(a.filter(y=>y.id!==b))},w=b=>{const y={...b,status:"parsing",parseProgress:0,errorMessage:void 0};s(a.map(N=>N.id===b.id?y:N)),o(y),l("parsing")},v=b=>{const y={projectName:b.projectName,uploadTime:b.uploadTime,parsedData:b.parsedData},N=JSON.stringify(y,null,2),A=new Blob([N],{type:"application/json"}),k=URL.createObjectURL(A),_=document.createElement("a");_.href=k,_.download=`${b.projectName}_.json`,document.body.appendChild(_),_.click(),document.body.removeChild(_),URL.revokeObjectURL(k)};return i==="upload"?n.jsx(XE,{onBack:h,onStartParsing:u,initialProjectName:c==null?void 0:c.projectName,initialFileName:c==null?void 0:c.fileName}):i==="parsing"&&c?n.jsx(KE,{projectId:c.id,projectName:c.projectName,onBack:h,onParsingComplete:d}):i==="review"&&c&&c.parsedData?n.jsx(qE,{projectId:c.id,projectName:c.projectName,initialData:c.parsedData,projectStatus:c.status,onBack:h,onSave:f,onConfirm:x}):n.jsx(GE,{projects:a,onUploadClick:()=>l("upload"),onViewProject:p,onDeleteProject:m,onReparse:w,onDownloadProject:v,onGenerateDocument:b=>{b&&(localStorage.setItem("preselected_bidding_project",JSON.stringify(b)),window.dispatchEvent(new CustomEvent("navigate-to-generate")))}})},JE=({documents:e,onCreateClick:t,onViewDocument:r,onEditDocument:a,onDeleteDocument:s,onDownloadDocument:i})=>{const[l,c]=M.useState(""),[o,u]=M.useState(""),[d,f]=M.useState("all"),[x,h]=M.useState(1),[p,m]=M.useState(10),[w,v]=M.useState(""),[b,y]=M.useState(!1),[N,A]=M.useState(null),k=()=>{c(""),u(""),f("all"),h(1)},_=()=>{},j=e.filter(Q=>{const Z=l===""||Q.projectName.toLowerCase().includes(l.toLowerCase()),z=o===""||Q.companyName.toLowerCase().includes(o.toLowerCase()),ne=d==="all"||Q.status===d;return Z&&z&&ne}).sort((Q,Z)=>new Date(Z.createdAt).getTime()-new Date(Q.createdAt).getTime()),P=()=>{const Q=(x-1)*p,Z=Q+p;return j.slice(Q,Z)},D=Math.ceil(j.length/p),K=Q=>{m(Q),h(1)},E=()=>{const Q=parseInt(w);Q>=1&&Q<=D&&(h(Q),v(""))},Y=Q=>{A(Q),y(!0)},B=()=>{N&&(s(N.id),y(!1),A(null))},te=Q=>Q.includes(":")?Q:`${Q} 00:00:00`,re=Q=>{const Z={draft:{label:"",className:"bg-neutral-100 text-neutral-700"},generating:{label:"",className:"bg-blue-100 text-blue-700"},completed:{label:"",className:"bg-green-100 text-green-700"}},z=Z[Q]||Z.draft;return n.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${z.className}`,children:z.label})};return n.jsxs("div",{className:"flex flex-col h-full",children:[n.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[n.jsxs("div",{className:"bg-white rounded-lg border border-neutral-200 flex flex-col h-full",children:[n.jsxs("div",{className:"px-6 py-4 border-b border-neutral-200 flex-shrink-0",children:[n.jsx("div",{className:"flex items-center justify-between mb-4",children:n.jsx("h2",{className:"text-lg font-medium text-neutral-900",children:""})}),n.jsxs("div",{className:"flex items-center justify-between gap-3",children:[n.jsxs("div",{className:"flex items-center gap-3 flex-wrap",children:["",n.jsx("input",{type:"text",placeholder:"",value:l,onChange:Q=>c(Q.target.value),className:"w-48 px-3 py-1.5 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500"}),"",n.jsx("input",{type:"text",placeholder:"",value:o,onChange:Q=>u(Q.target.value),className:"w-48 px-3 py-1.5 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500"}),"",n.jsxs("select",{value:d,onChange:Q=>f(Q.target.value),className:"px-3 py-1.5 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500",children:[n.jsx("option",{value:"all",children:""}),n.jsx("option",{value:"draft",children:""}),n.jsx("option",{value:"generating",children:""}),n.jsx("option",{value:"completed",children:""})]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{onClick:k,className:"px-4 py-1.5 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-50 transition-colors",children:""}),n.jsx("button",{onClick:_,className:"px-4 py-1.5 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors",children:""})]})]})]}),n.jsx("div",{className:"px-6 py-3 border-b border-neutral-200 flex-shrink-0",children:n.jsx("div",{className:"flex items-center gap-3",children:n.jsxs("button",{onClick:t,className:"px-4 py-1.5 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors flex items-center",children:[n.jsx(Pt,{className:"w-4 h-4 mr-1"}),""]})})}),n.jsx("div",{className:"overflow-x-auto flex-1 overflow-y-auto",children:n.jsxs("table",{className:"w-full",children:[n.jsx("thead",{className:"bg-neutral-50 border-b border-neutral-200",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""})]})}),n.jsx("tbody",{className:"divide-y divide-neutral-200",children:P().length===0?n.jsx("tr",{children:n.jsx("td",{colSpan:8,className:"px-4 py-8 text-center text-neutral-500",children:""})}):P().map((Q,Z)=>n.jsxs("tr",{className:"hover:bg-neutral-50 transition-colors",children:[n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm text-neutral-900",children:(x-1)*p+Z+1}),n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm text-neutral-900",children:n.jsx("div",{className:"max-w-xs truncate",title:Q.name,children:Q.name})}),n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm text-neutral-900",children:Q.fileTypes.map(z=>z==="commercial"?"":"").join("")}),n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm text-neutral-900",children:n.jsx("div",{className:"max-w-xs truncate",title:Q.projectName,children:Q.projectName})}),n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm text-neutral-900",children:n.jsx("div",{className:"max-w-xs truncate",title:Q.companyName,children:Q.companyName})}),n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm",children:n.jsxs("div",{className:"flex items-center gap-2",children:[re(Q.status),Q.status==="generating"&&Q.generationProgress!==void 0&&n.jsxs("span",{className:"text-xs text-blue-600 font-medium",children:[Q.generationProgress,"%"]})]})}),n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm text-neutral-900",children:te(Q.createdAt)}),n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm",children:n.jsx("div",{className:"flex items-center space-x-2",children:Q.status==="generating"?n.jsxs(n.Fragment,{children:[n.jsxs("button",{disabled:!0,className:"px-2 py-1 text-xs text-neutral-400 cursor-not-allowed rounded flex items-center gap-1",children:[n.jsx(Dt,{className:"w-3.5 h-3.5"}),""]}),n.jsxs("button",{disabled:!0,className:"px-2 py-1 text-xs text-neutral-400 cursor-not-allowed rounded flex items-center gap-1",children:[n.jsx(qe,{className:"w-3.5 h-3.5"}),""]})]}):n.jsxs(n.Fragment,{children:[Q.status==="completed"&&n.jsxs("button",{onClick:()=>r(Q),className:"px-2 py-1 text-xs text-primary-600 hover:text-primary-800 hover:bg-primary-50 rounded transition-colors flex items-center gap-1",children:[n.jsx(y1,{className:"w-3.5 h-3.5"}),""]}),Q.status==="draft"&&n.jsxs("button",{onClick:()=>a(Q),className:"px-2 py-1 text-xs text-blue-600 hover:text-blue-800 hover:bg-blue-50 rounded transition-colors flex items-center gap-1",children:[n.jsx(Dt,{className:"w-3.5 h-3.5"}),""]}),Q.status==="completed"&&n.jsxs("button",{onClick:()=>i(Q),className:"px-2 py-1 text-xs text-green-600 hover:text-green-800 hover:bg-green-50 rounded transition-colors flex items-center gap-1",children:[n.jsx(js,{className:"w-3.5 h-3.5"}),""]}),n.jsxs("button",{onClick:()=>Y(Q),className:"px-2 py-1 text-xs text-red-600 hover:text-red-800 hover:bg-red-50 rounded transition-colors flex items-center gap-1",children:[n.jsx(qe,{className:"w-3.5 h-3.5"}),""]})]})})})]},Q.id))})]})})]}),n.jsxs("div",{className:"bg-white border-t border-neutral-200 px-6 py-3 flex items-center justify-center gap-6",children:[n.jsxs("div",{className:"text-sm text-neutral-700",children:[" ",j.length," "]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("button",{onClick:()=>h(Math.max(1,x-1)),disabled:x===1,className:`px-2 py-1 text-sm rounded transition-colors ${x===1?"bg-neutral-100 text-neutral-400 cursor-not-allowed":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:"<"}),n.jsx("div",{className:"flex items-center space-x-1",children:Array.from({length:Math.min(10,D)},(Q,Z)=>{let z;return D<=10||x<=5?z=Z+1:x>=D-4?z=D-9+Z:z=x-4+Z,n.jsx("button",{onClick:()=>h(z),className:`px-2.5 py-1 text-sm rounded transition-colors ${x===z?"bg-primary-600 text-white":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:z},z)})}),D>10&&n.jsxs(n.Fragment,{children:[n.jsx("span",{className:"text-neutral-500",children:"..."}),n.jsx("button",{onClick:()=>h(D),className:`px-2.5 py-1 text-sm rounded transition-colors ${x===D?"bg-primary-600 text-white":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:D})]}),n.jsx("button",{onClick:()=>h(Math.min(D,x+1)),disabled:x===D,className:`px-2 py-1 text-sm rounded transition-colors ${x===D?"bg-neutral-100 text-neutral-400 cursor-not-allowed":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:">"})]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsxs("select",{value:p,onChange:Q=>K(Number(Q.target.value)),className:"px-2 py-1 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500",children:[n.jsx("option",{value:10,children:"10/"}),n.jsx("option",{value:20,children:"20/"}),n.jsx("option",{value:50,children:"50/"})]}),n.jsx("span",{className:"text-sm text-neutral-700",children:""}),n.jsx("input",{type:"number",value:w,onChange:Q=>v(Q.target.value),placeholder:"",className:"w-12 px-2 py-1 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500",min:1,max:D}),n.jsx("button",{onClick:E,className:"px-3 py-1 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-50 transition-colors",children:""})]})]})]}),b&&N&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[n.jsx("h3",{className:"text-lg font-semibold text-neutral-900 mb-4",children:""}),n.jsxs("p",{className:"text-neutral-700 mb-6",children:[' "',n.jsx("strong",{children:N.name}),'" ']}),n.jsxs("div",{className:"flex justify-end space-x-3",children:[n.jsx("button",{onClick:()=>{y(!1),A(null)},className:"px-4 py-2 border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-50 transition-colors",children:""}),n.jsx("button",{onClick:B,className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 transition-colors",children:""})]})]})})]})},H0=({onClose:e,preSelectedProject:t,mode:r="create",existingDocument:a})=>{const s=r==="view",i=r==="edit",[l,c]=M.useState(1),[o,u]=M.useState((a==null?void 0:a.name)||""),[d,f]=M.useState((a==null?void 0:a.fileTypes)||[]),[x,h]=M.useState(t||null),[p,m]=M.useState([]),[w,v]=M.useState([]),[b,y]=M.useState(null),[N,A]=M.useState(null),[k,_]=M.useState([]),[j,P]=M.useState([]),[D,K]=M.useState({}),[E,Y]=M.useState({}),[B,te]=M.useState("company"),[re,Q]=M.useState("productionEquipment"),[Z,z]=M.useState("legalPerson"),[ne,xe]=M.useState(!1),[O,R]=M.useState(0),[g,S]=M.useState(!1),[F,ae]=M.useState(""),[ue,ve]=M.useState("");M.useState(1),M.useState(1);const[me,H]=M.useState(!1),[T,je]=M.useState(!1),[pe,Le]=M.useState(!1),[Se,he]=M.useState(!1),[oe,De]=M.useState(null),[Me,Ie]=M.useState("commercial"),[Oe,He]=M.useState([]),[Ze,pt]=M.useState([]),Bt=br.useRef(null),nt=br.useRef(null);br.useEffect(()=>{var W,q;t&&((W=t.documentDirectory)!=null&&W.commercial&&m(rt(t.documentDirectory.commercial)),(q=t.documentDirectory)!=null&&q.technical&&v(rt(t.documentDirectory.technical)))},[t]),br.useEffect(()=>{var W,q;if((i||s)&&(a!=null&&a.projectId)&&gt.length>0){const J=gt.find(fe=>fe.id===a.projectId);J&&(!x||x.id!==J.id)&&(h(J),je(!1),(W=J.documentDirectory)!=null&&W.commercial&&m(rt(J.documentDirectory.commercial)),(q=J.documentDirectory)!=null&&q.technical&&v(rt(J.documentDirectory.technical)))}},[i,s,a,x]),br.useEffect(()=>{if((i||s)&&!b&&Ut.length>0){const W=Ut.filter(q=>q.name.toLowerCase().includes(ue.toLowerCase()));W.length>0&&ze(W[0])}},[i,s]),br.useEffect(()=>{const W=q=>{Bt.current&&!Bt.current.contains(q.target)&&H(!1),nt.current&&!nt.current.contains(q.target)&&je(!1)};return document.addEventListener("mousedown",W),()=>{document.removeEventListener("mousedown",W)}},[]);const gt=[{id:"1",projectName:"",status:"parsed",uploadTime:"2024-01-15",documentDirectory:{commercial:`
  1.1 
  1.2 

  2.1 
  2.2 

  3.1 
  3.2 `,technical:`
  1.1 
  1.2 

  2.1 
  2.2 `}},{id:"2",projectName:"",status:"parsed",uploadTime:"2024-01-12",documentDirectory:{commercial:`
  1.1 
  1.2 

  2.1 
  2.2 `,technical:`
  1.1 
  1.2 

  2.1 
  2.2 `}}],Ut=[{id:"1",name:""},{id:"2",name:"XX"},{id:"3",name:"YY"}],Ge=[{id:"fmt_1",company_id:"1",name:"A",header:"",footer:" {page}   {total} ",margin_top:25,margin_bottom:25,margin_left:30,margin_right:30,heading_styles:{heading1:{numberingStyle:"",fontFamily:"",fontSize:18,indent:0,lineSpacing:1.5,alignment:"center",bold:!0},heading2:{numberingStyle:"",fontFamily:"",fontSize:16,indent:0,lineSpacing:1.5,alignment:"left",bold:!0},heading3:{numberingStyle:"1.",fontFamily:"",fontSize:15,indent:0,lineSpacing:1.5,alignment:"left",bold:!0}},body_text_style:{numberingStyle:"1.",fontFamily:"",fontSize:14,indent:2,lineSpacing:1.5,alignment:"left",bold:!1},is_default:!0,created_at:"2024-10-20",updated_at:"2024-10-20"},{id:"fmt_2",company_id:"1",name:"B",header:"",footer:" {page} ",margin_top:20,margin_bottom:20,margin_left:25,margin_right:25,heading_styles:{heading1:{numberingStyle:"1.",fontFamily:"",fontSize:16,indent:0,lineSpacing:1.3,alignment:"left",bold:!0},heading2:{numberingStyle:"1.1",fontFamily:"",fontSize:14,indent:0,lineSpacing:1.3,alignment:"left",bold:!0},heading3:{numberingStyle:"1.1.1",fontFamily:"",fontSize:13,indent:0,lineSpacing:1.3,alignment:"left",bold:!1}},body_text_style:{numberingStyle:"",fontFamily:"",fontSize:12,indent:2,lineSpacing:1.3,alignment:"left",bold:!1},is_default:!1,created_at:"2024-10-18",updated_at:"2024-10-18"},{id:"fmt_3",company_id:"2",name:"",header:"XX",footer:" {page}   {total} ",margin_top:30,margin_bottom:30,margin_left:35,margin_right:35,heading_styles:{heading1:{numberingStyle:" ",fontFamily:"",fontSize:20,indent:0,lineSpacing:2,alignment:"center",bold:!0},heading2:{numberingStyle:"",fontFamily:"",fontSize:16,indent:0,lineSpacing:1.8,alignment:"left",bold:!0},heading3:{numberingStyle:"",fontFamily:"",fontSize:15,indent:0,lineSpacing:1.5,alignment:"left",bold:!0}},body_text_style:{numberingStyle:"",fontFamily:"",fontSize:14,indent:2,lineSpacing:1.5,alignment:"justify",bold:!1},is_default:!0,created_at:"2024-10-15",updated_at:"2024-10-15"}],dt=[{id:"company",name:"",items:[{id:"company_1",name:"",selected:!0},{id:"company_2",name:"",selected:!0},{id:"company_3",name:"",selected:!1},{id:"company_4",name:"",selected:!1},{id:"company_5",name:"",selected:!1}]},{id:"qualification",name:"",items:[{id:"qual_1",name:"",certNumber:"CERT-2024-001",rating:"",status:"valid",uploadTime:"2024-10-20",selected:!0},{id:"qual_2",name:"ISO9001",certNumber:"ISO-2024-002",rating:"",status:"valid",uploadTime:"2024-10-18",selected:!0},{id:"qual_3",name:"",certNumber:"SEC-2024-003",rating:"",status:"valid",uploadTime:"2024-10-15",selected:!1},{id:"qual_4",name:"CMMI",certNumber:"CMMI-2023-004",rating:"",status:"expired",uploadTime:"2024-09-10",selected:!1},{id:"qual_5",name:"",certNumber:"HIGH-2024-005",rating:"",status:"valid",uploadTime:"2024-08-25",selected:!0},{id:"qual_6",name:"",certNumber:"BUILD-2024-006",rating:"",status:"valid",uploadTime:"2024-07-12",selected:!1}],filters:{rating:["","","","","","","","","","","AAA","AAAA","AAAAA","CS1","CS2","CS3","CS4","CS5","","","","","","","","","","","",""],status:["valid","expired"]}},{id:"financial",name:"",items:[{id:"fin_4",name:"2024",year:"2024",selected:!0},{id:"fin_5",name:"2024",year:"2024",selected:!1},{id:"fin_6",name:"",year:"2024",selected:!0},{id:"fin_1",name:"2024",year:"2024",selected:!0},{id:"fin_2",name:"2023",year:"2023",selected:!1},{id:"fin_3",name:"2022",year:"2022",selected:!1}],filters:{year:["2024","2023","2022","2021"]}},{id:"performance",name:"",items:[{id:"perf_1",name:"",projectName:"",clientName:"",contractNumber:"CT-2024-001",signYear:"2024",selected:!0},{id:"perf_2",name:"",projectName:"",clientName:"",contractNumber:"CT-2024-002",signYear:"2024",selected:!0},{id:"perf_3",name:"",projectName:"",clientName:"",contractNumber:"CT-2023-003",signYear:"2023",selected:!1},{id:"perf_4",name:"",projectName:"",clientName:"",contractNumber:"CT-2023-004",signYear:"2023",selected:!1},{id:"perf_5",name:"ERP",projectName:"ERP",clientName:"",contractNumber:"CT-2022-005",signYear:"2022",selected:!1}]},{id:"legalPerson",name:" - ",items:[{id:"legal_1",name:"",position:"",status:"active",uploadTime:"2024-10-20",isLegalPerson:!0,selected:!0}],filters:{status:["active","resigned"]}},{id:"authorizedDelegate",name:" - ",items:[{id:"per_1",name:"",position:"",status:"active",uploadTime:"2024-10-22",selected:!0},{id:"per_2",name:"",position:"",status:"active",uploadTime:"2024-10-20",selected:!0},{id:"per_3",name:"",position:"",status:"active",uploadTime:"2024-10-15",selected:!1},{id:"per_4",name:"",position:"",status:"active",uploadTime:"2024-09-28",selected:!1},{id:"per_5",name:"",position:"",status:"resigned",uploadTime:"2024-08-10",selected:!1},{id:"per_6",name:"",position:"",status:"active",uploadTime:"2024-09-15",selected:!1},{id:"per_7",name:"",position:"",status:"active",uploadTime:"2024-09-01",selected:!1}]},{id:"otherPersonnel",name:" - ",items:[{id:"per_1",name:"",position:"",projectPosition:"",status:"active",uploadTime:"2024-10-22",selected:!0},{id:"per_2",name:"",position:"",projectPosition:"",status:"active",uploadTime:"2024-10-20",selected:!0},{id:"per_3",name:"",position:"",projectPosition:"",status:"active",uploadTime:"2024-10-15",selected:!1},{id:"per_4",name:"",position:"",projectPosition:"",status:"active",uploadTime:"2024-09-28",selected:!1},{id:"per_5",name:"",position:"",projectPosition:"",status:"resigned",uploadTime:"2024-08-10",selected:!1},{id:"per_6",name:"",position:"",projectPosition:"",status:"active",uploadTime:"2024-09-15",selected:!1},{id:"per_7",name:"",position:"",projectPosition:"",status:"active",uploadTime:"2024-09-01",selected:!1}]},{id:"productionEquipment",name:" - ",items:[{id:"prod_1",name:" CNC-5000",productCategory:"",productBrand:"",productSpec:"",productModel:"CNC-5000",selected:!0},{id:"prod_2",name:" INJ-800T",productCategory:"",productBrand:"",productSpec:"800",productModel:"INJ-800T",selected:!1},{id:"prod_3",name:" LC-3015",productCategory:"",productBrand:"",productSpec:"3000W",productModel:"LC-3015",selected:!0}],filters:{productCategory:["","","",""]}},{id:"testingEquipment",name:" - ",items:[{id:"test_1",name:" CMM-7106",productCategory:"",productBrand:"",productSpec:"700x1000x600mm",productModel:"CMM-7106",selected:!0},{id:"test_2",name:" HR-150A",productCategory:"",productBrand:"",productSpec:"",productModel:"HR-150A",selected:!1},{id:"test_3",name:" OES-2000",productCategory:"",productBrand:"",productSpec:"",productModel:"OES-2000",selected:!0}],filters:{productCategory:["","","",""]}},{id:"companyProducts",name:" - ",items:[{id:"cprod_1",name:" ER8300G",productCategory:"",productBrand:"",productSpec:"",productModel:"ER8300G",selected:!0},{id:"cprod_2",name:" S5720-SI",productCategory:"",productBrand:"",productSpec:"24",productModel:"S5720-28P-SI",selected:!0},{id:"cprod_3",name:"Dell PowerEdge R740 ",productCategory:"",productBrand:"Dell",productSpec:"2U",productModel:"R740",selected:!0}],filters:{productCategory:["","","",""]}},{id:"templates",name:"",items:[{id:"temp_1",name:"",uploadTime:"2024-10-21",selected:!0},{id:"temp_2",name:"",uploadTime:"2024-10-18",selected:!0},{id:"temp_3",name:"",uploadTime:"2024-10-12",selected:!1},{id:"temp_4",name:"",uploadTime:"2024-09-25",selected:!1},{id:"temp_5",name:"",uploadTime:"2024-09-10",selected:!1}]},{id:"otherFiles",name:"",items:[{id:"other_1",name:"",uploadTime:"2024-10-20",selected:!1},{id:"other_2",name:"",uploadTime:"2024-10-15",selected:!1},{id:"other_3",name:"",uploadTime:"2024-10-10",selected:!1},{id:"other_4",name:"",uploadTime:"2024-09-30",selected:!1},{id:"other_5",name:"",uploadTime:"2024-09-20",selected:!1}]}],rt=W=>{const q=W.split(`
`).filter(be=>be.trim()),J=[],fe=[];return q.forEach((be,Re)=>{var ut;const G=((ut=be.match(/^\s*/))==null?void 0:ut[0].length)||0,Ne=Math.floor(G/2),Te=be.trim(),we={id:`item-${Re}`,title:Te,level:Ne,generationMode:"detailed",children:[]};if(Ne===0)J.push(we),fe.length=0,fe.push(we);else{for(;fe.length>Ne;)fe.pop();fe.length>0&&fe[fe.length-1].children.push(we),fe.push(we)}}),J},ot=W=>{f(q=>q.includes(W)?q.length===1?q:q.filter(J=>J!==W):[...q,W])},ir=M.useCallback(W=>{var q,J;h(W),je(!1),(q=W.documentDirectory)!=null&&q.commercial&&m(rt(W.documentDirectory.commercial)),(J=W.documentDirectory)!=null&&J.technical&&v(rt(W.documentDirectory.technical))},[]),se=()=>{h(null),ae(""),je(!1)},ze=W=>{y(W),P(dt);const q=Ge.filter(fe=>fe.company_id===W.id);_(q);const J=q.find(fe=>fe.is_default);A(J||q[0]||null)},Be=(W,q,J)=>J.map(fe=>fe.id===W?{...fe,generationMode:q}:fe.children.length>0?{...fe,children:Be(W,q,fe.children)}:fe),kt=(W,q)=>{m(J=>Be(W,q,J))},_r=(W,q)=>{v(J=>Be(W,q,J))},an=(W,q)=>{P(J=>J.map(fe=>fe.id===W?{...fe,items:fe.items.map(be=>be.id===q?(W==="legalPerson"||W==="authorizedDelegate"||W==="otherPersonnel")&&be.status==="resigned"&&!be.selected?be:{...be,selected:!be.selected}:be)}:fe))},sn=(W,q)=>{P(J=>J.map(fe=>fe.id===W?{...fe,items:fe.items.map(be=>({...be,selected:q}))}:fe))},gr=()=>{xe(!0),R(0);const W=setInterval(()=>{R(q=>q>=100?(clearInterval(W),xe(!1),S(!0),100):q+10)},300)},Br=()=>{alert(" Word ")},ln=W=>{ze(W),H(!1),ve("")},cn=()=>{y(null),ve(""),H(!0)},ee=()=>{c(W=>Math.min(W+1,6))},We=()=>{c(W=>Math.max(W-1,1))},Je=()=>{switch(l){case 1:return o.trim()!=="";case 2:return x!==null&&d.length>0;case 3:return b!==null;case 4:return!0;case 5:return N!==null;default:return!0}},qt=(W,q=0,J,fe="commercial")=>W.map(be=>{var G;const Re=((G=be.selectedKnowledgeItems)==null?void 0:G.length)||0;return n.jsxs("div",{style:{paddingLeft:`${q*24}px`},children:[n.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-neutral-100 gap-3",children:[n.jsx("div",{className:"flex-1 min-w-0",children:n.jsx("span",{className:`text-sm ${q===0?"font-semibold text-neutral-900":"text-neutral-700"}`,children:be.title})}),n.jsxs("div",{className:"flex items-center space-x-2 flex-shrink-0",children:[n.jsxs("button",{onClick:()=>{De(be),Ie(fe),He(be.selectedKnowledgeItems||[]),Le(!0)},disabled:s,className:`flex items-center gap-1 px-2 py-1 text-xs rounded transition-colors ${Re>0?"bg-primary-100 text-primary-700 hover:bg-primary-200":"bg-neutral-100 text-neutral-600 hover:bg-neutral-200"} disabled:opacity-50 disabled:cursor-not-allowed`,title:"",children:[n.jsx(xb,{className:"w-3.5 h-3.5"}),n.jsx("span",{children:Re>0?`${Re}`:""})]}),n.jsxs("select",{value:be.generationMode,onChange:Ne=>{J(be.id,Ne.target.value)},disabled:s,className:"px-2 py-1 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500 disabled:bg-neutral-50 disabled:cursor-not-allowed",children:[n.jsx("option",{value:"copy",children:""}),n.jsx("option",{value:"brief",children:""}),n.jsx("option",{value:"detailed",children:""})]})]})]}),be.children.length>0&&qt(be.children,q+1,J,fe)]},be.id)}),tr=[{number:1,name:""},{number:2,name:""},{number:3,name:""},{number:4,name:""},{number:5,name:""},{number:6,name:""}],Sr=()=>n.jsx("div",{className:"flex items-center justify-between mb-8",children:tr.map((W,q)=>{const J=l===W.number,fe=l>W.number;return n.jsxs(br.Fragment,{children:[n.jsxs("div",{className:"flex flex-col items-center",children:[n.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center font-medium transition-colors ${J||fe?"bg-primary-600 text-white":"bg-neutral-200 text-neutral-600"}`,children:W.number}),n.jsx("span",{className:`text-xs mt-2 text-center ${J||fe?"text-primary-600 font-medium":"text-neutral-600"}`,children:W.name})]}),q<tr.length-1&&n.jsx("div",{className:`flex-1 h-0.5 mx-2 transition-colors ${fe?"bg-primary-600":"bg-neutral-200"}`})]},W.number)})}),Et=()=>n.jsxs("div",{className:"max-w-2xl mx-auto space-y-6",children:[n.jsx("div",{className:"mb-4 bg-blue-50 border border-blue-200 rounded-lg p-4",children:n.jsx("p",{className:"text-sm text-blue-800",children:""})}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:o,onChange:W=>u(W.target.value),placeholder:"",disabled:s,className:"w-full px-4 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 disabled:bg-neutral-50 disabled:cursor-not-allowed"})]})]}),Rt=()=>n.jsxs("div",{className:"max-w-4xl mx-auto",children:[n.jsx("div",{className:"mb-6 bg-blue-50 border border-blue-200 rounded-lg p-4",children:n.jsx("p",{className:"text-sm text-blue-800",children:""})}),d.length===0?n.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-6 text-center",children:n.jsx("p",{className:"text-amber-800",children:""})}):n.jsxs("div",{className:"space-y-6",children:[n.jsx("h3",{className:"text-lg font-medium text-neutral-900",children:""}),d.includes("commercial")&&n.jsxs("div",{className:"border border-neutral-200 rounded-lg overflow-hidden",children:[n.jsx("div",{className:"bg-green-50 px-4 py-3 border-b border-green-200",children:n.jsx("span",{className:"text-sm font-semibold text-green-900",children:""})}),n.jsx("div",{className:"max-h-96 overflow-y-auto p-4",children:p.length>0?qt(p,0,kt,"commercial"):n.jsx("p",{className:"text-center text-neutral-500 py-8",children:""})})]}),d.includes("technical")&&n.jsxs("div",{className:"border border-neutral-200 rounded-lg overflow-hidden",children:[n.jsx("div",{className:"bg-blue-50 px-4 py-3 border-b border-blue-200",children:n.jsx("span",{className:"text-sm font-semibold text-blue-900",children:""})}),n.jsx("div",{className:"max-h-96 overflow-y-auto p-4",children:w.length>0?qt(w,0,_r,"technical"):n.jsx("p",{className:"text-center text-neutral-500 py-8",children:""})})]})]})]}),ur=(W,q,J)=>{K(fe=>({...fe,[W]:{...fe[W],[q]:J}}))},lt=(W,q,J)=>{Y(fe=>({...fe,[W]:{...fe[W],[q]:J}}))},C=W=>{const q=D[W.id]||{},J=E[W.id]||{};let fe=W.items.filter(be=>{var Re,G,Ne,Te,we,ut,vt,_t,Kr,Sa,la,Ca,Fi,Ae,ct,Ur,Yr;if(q.year&&be.year&&be.year!==q.year||q.rating&&be.rating&&be.rating!==q.rating||q.status&&be.status&&be.status!==q.status||q.position&&be.position&&be.position!==q.position||q.productCategory&&be.productCategory&&be.productCategory!==q.productCategory||W.id==="company"&&J.name&&!((Re=be.name)!=null&&Re.toLowerCase().includes(J.name.toLowerCase()))||W.id==="qualification"&&(J.name&&!((G=be.name)!=null&&G.toLowerCase().includes(J.name.toLowerCase()))||J.certNumber&&!((Ne=be.certNumber)!=null&&Ne.toLowerCase().includes(J.certNumber.toLowerCase()))||J.rating&&!((Te=be.rating)!=null&&Te.toLowerCase().includes(J.rating.toLowerCase())))||W.id==="financial"&&J.name&&!((we=be.name)!=null&&we.toLowerCase().includes(J.name.toLowerCase())))return!1;if(W.id==="performance"){if(J.projectName&&!((ut=be.projectName)!=null&&ut.toLowerCase().includes(J.projectName.toLowerCase()))||J.contractNumber&&!((vt=be.contractNumber)!=null&&vt.toLowerCase().includes(J.contractNumber.toLowerCase())))return!1;if(J.contractAmountMin){const Mn=parseFloat(J.contractAmountMin);if(parseFloat(((_t=be.contractAmount)==null?void 0:_t.replace(/[^\d.]/g,""))||"0")<=Mn)return!1}if(J.productName&&!((Kr=be.productName)!=null&&Kr.toLowerCase().includes(J.productName.toLowerCase()))||J.productBrand&&!((Sa=be.productBrand)!=null&&Sa.toLowerCase().includes(J.productBrand.toLowerCase()))||J.productModel&&!((la=be.productModel)!=null&&la.toLowerCase().includes(J.productModel.toLowerCase()))||J.productQuantity&&!((Ca=be.productQuantity)!=null&&Ca.toLowerCase().includes(J.productQuantity.toLowerCase())))return!1}return!((W.id==="legalPerson"||W.id==="authorizedDelegate"||W.id==="otherPersonnel")&&J.name&&!((Fi=be.name)!=null&&Fi.toLowerCase().includes(J.name.toLowerCase()))||(W.id==="productionEquipment"||W.id==="testingEquipment"||W.id==="companyProducts")&&(J.name&&!((Ae=be.name)!=null&&Ae.toLowerCase().includes(J.name.toLowerCase()))||J.productBrand&&!((ct=be.productBrand)!=null&&ct.toLowerCase().includes(J.productBrand.toLowerCase()))||J.productModel&&!((Ur=be.productModel)!=null&&Ur.toLowerCase().includes(J.productModel.toLowerCase())))||W.id==="templates"&&J.name&&!((Yr=be.name)!=null&&Yr.toLowerCase().includes(J.name.toLowerCase())))});return W.id==="qualification"&&fe.length>0&&(fe=fe.sort((be,Re)=>!be.uploadTime||!Re.uploadTime?0:new Date(Re.uploadTime).getTime()-new Date(be.uploadTime).getTime())),W.id==="financial"&&fe.length>0&&(fe=fe.sort((be,Re)=>!be.year||!Re.year?0:parseInt(Re.year)-parseInt(be.year))),W.id==="performance"&&fe.length>0&&(fe=fe.sort((be,Re)=>!be.signYear||!Re.signYear?0:parseInt(Re.signYear)-parseInt(be.signYear))),(W.id==="legalPerson"||W.id==="authorizedDelegate"||W.id==="otherPersonnel")&&fe.length>0&&(fe=fe.sort((be,Re)=>!be.uploadTime||!Re.uploadTime?0:new Date(Re.uploadTime).getTime()-new Date(be.uploadTime).getTime())),W.id==="templates"&&fe.length>0&&(fe=fe.sort((be,Re)=>!be.uploadTime||!Re.uploadTime?0:new Date(Re.uploadTime).getTime()-new Date(be.uploadTime).getTime())),W.id==="otherFiles"&&fe.length>0&&(fe=fe.sort((be,Re)=>!be.uploadTime||!Re.uploadTime?0:new Date(Re.uploadTime).getTime()-new Date(be.uploadTime).getTime())),fe},U=W=>{var fe,be,Re,G,Ne,Te;const q=E[W.id]||{},J=D[W.id]||{};return W.id==="company"?n.jsx("div",{className:"flex items-center gap-2 flex-wrap",children:n.jsx("input",{type:"text",placeholder:"",value:q.name||"",onChange:we=>lt(W.id,"name",we.target.value),className:"text-xs px-2 py-1 border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 w-40"})}):W.id==="qualification"?n.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[n.jsx("input",{type:"text",placeholder:"",value:q.name||"",onChange:we=>lt(W.id,"name",we.target.value),className:"text-xs px-2 py-1 border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 w-32"}),n.jsx("input",{type:"text",placeholder:"",value:q.certNumber||"",onChange:we=>lt(W.id,"certNumber",we.target.value),className:"text-xs px-2 py-1 border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 w-32"}),n.jsx("input",{type:"text",placeholder:"",value:q.rating||"",onChange:we=>lt(W.id,"rating",we.target.value),className:"text-xs px-2 py-1 border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 w-24"}),((fe=W.filters)==null?void 0:fe.rating)&&n.jsxs("select",{value:J.rating||"",onChange:we=>ur(W.id,"rating",we.target.value),className:"text-xs px-2 py-1 border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500",children:[n.jsx("option",{value:"",children:""}),W.filters.rating.map(we=>n.jsx("option",{value:we,children:we},we))]}),((be=W.filters)==null?void 0:be.status)&&n.jsxs("select",{value:J.status||"",onChange:we=>ur(W.id,"status",we.target.value),className:"text-xs px-2 py-1 border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500",children:[n.jsx("option",{value:"",children:""}),W.filters.status.map(we=>n.jsx("option",{value:we,children:we==="valid"?"":we==="expired"?"":we==="active"?"":""},we))]})]}):W.id==="financial"?n.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[n.jsx("input",{type:"text",placeholder:"",value:q.name||"",onChange:we=>lt(W.id,"name",we.target.value),className:"text-xs px-2 py-1 border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 w-40"}),((Re=W.filters)==null?void 0:Re.year)&&n.jsxs("select",{value:J.year||"",onChange:we=>ur(W.id,"year",we.target.value),className:"text-xs px-2 py-1 border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500",children:[n.jsx("option",{value:"",children:""}),W.filters.year.map(we=>n.jsxs("option",{value:we,children:[we,""]},we))]})]}):W.id==="performance"?n.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[n.jsx("input",{type:"text",placeholder:"",value:q.projectName||"",onChange:we=>lt(W.id,"projectName",we.target.value),className:"text-xs px-2 py-1 border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 w-28"}),n.jsx("input",{type:"text",placeholder:"",value:q.contractNumber||"",onChange:we=>lt(W.id,"contractNumber",we.target.value),className:"text-xs px-2 py-1 border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 w-28"}),n.jsx("input",{type:"number",placeholder:"",value:q.contractAmountMin||"",onChange:we=>lt(W.id,"contractAmountMin",we.target.value),className:"text-xs px-2 py-1 border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 w-24"}),n.jsx("input",{type:"text",placeholder:"",value:q.productName||"",onChange:we=>lt(W.id,"productName",we.target.value),className:"text-xs px-2 py-1 border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 w-24"}),n.jsx("input",{type:"text",placeholder:"",value:q.productBrand||"",onChange:we=>lt(W.id,"productBrand",we.target.value),className:"text-xs px-2 py-1 border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 w-24"}),n.jsx("input",{type:"text",placeholder:"",value:q.productModel||"",onChange:we=>lt(W.id,"productModel",we.target.value),className:"text-xs px-2 py-1 border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 w-24"}),n.jsx("input",{type:"text",placeholder:"",value:q.productQuantity||"",onChange:we=>lt(W.id,"productQuantity",we.target.value),className:"text-xs px-2 py-1 border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 w-24"})]}):W.id==="legalPerson"||W.id==="authorizedDelegate"||W.id==="otherPersonnel"?n.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[n.jsx("input",{type:"text",placeholder:"",value:q.name||"",onChange:we=>lt(W.id,"name",we.target.value),className:"text-xs px-2 py-1 border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 w-32"}),((G=W.filters)==null?void 0:G.status)&&n.jsxs("select",{value:J.status||"",onChange:we=>ur(W.id,"status",we.target.value),className:"text-xs px-2 py-1 border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500",children:[n.jsx("option",{value:"",children:""}),W.filters.status.map(we=>n.jsx("option",{value:we,children:we==="valid"?"":we==="expired"?"":we==="active"?"":""},we))]}),((Ne=W.filters)==null?void 0:Ne.position)&&n.jsxs("select",{value:J.position||"",onChange:we=>ur(W.id,"position",we.target.value),className:"text-xs px-2 py-1 border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500",children:[n.jsx("option",{value:"",children:""}),W.filters.position.map(we=>n.jsx("option",{value:we,children:we},we))]})]}):W.id==="productionEquipment"||W.id==="testingEquipment"||W.id==="companyProducts"?n.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[n.jsx("input",{type:"text",placeholder:"",value:q.name||"",onChange:we=>lt(W.id,"name",we.target.value),className:"text-xs px-2 py-1 border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 w-28"}),n.jsx("input",{type:"text",placeholder:"",value:q.productBrand||"",onChange:we=>lt(W.id,"productBrand",we.target.value),className:"text-xs px-2 py-1 border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 w-24"}),n.jsx("input",{type:"text",placeholder:"",value:q.productModel||"",onChange:we=>lt(W.id,"productModel",we.target.value),className:"text-xs px-2 py-1 border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 w-24"}),((Te=W.filters)==null?void 0:Te.productCategory)&&n.jsxs("select",{value:J.productCategory||"",onChange:we=>ur(W.id,"productCategory",we.target.value),className:"text-xs px-2 py-1 border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500",children:[n.jsx("option",{value:"",children:""}),W.filters.productCategory.map(we=>n.jsx("option",{value:we,children:we},we))]})]}):W.id==="templates"?n.jsx("div",{className:"flex items-center gap-2 flex-wrap",children:n.jsx("input",{type:"text",placeholder:"",value:q.name||"",onChange:we=>lt(W.id,"name",we.target.value),className:"text-xs px-2 py-1 border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 w-40"})}):W.id==="otherFiles"?n.jsx("div",{className:"flex items-center gap-2 flex-wrap",children:n.jsx("input",{type:"text",placeholder:"",value:q.name||"",onChange:we=>lt(W.id,"name",we.target.value),className:"text-xs px-2 py-1 border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 w-40"})}):null},I=(W,q)=>q.id==="qualification"?n.jsx("div",{className:"ml-3 flex-1",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"text-sm text-neutral-900",children:W.name}),n.jsxs("div",{className:"flex items-center space-x-3 text-xs text-neutral-600",children:[n.jsxs("span",{children:["",W.certNumber]}),n.jsx("span",{className:`px-2 py-0.5 rounded ${W.status==="valid"?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:W.status==="valid"?"":""}),W.rating!==""&&n.jsx("span",{className:"px-2 py-0.5 bg-blue-100 text-blue-700 rounded",children:W.rating})]})]})}):q.id==="financial"?n.jsx("div",{className:"ml-3 flex-1",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"text-sm text-neutral-900",children:W.name}),W.year&&n.jsxs("span",{className:"text-xs px-2 py-0.5 bg-neutral-100 text-neutral-700 rounded",children:[W.year,""]})]})}):q.id==="performance"?n.jsx("div",{className:"ml-3 flex-1",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"text-sm text-neutral-900",children:W.projectName}),n.jsxs("div",{className:"flex items-center space-x-3 text-xs text-neutral-600",children:[n.jsxs("span",{children:["",W.clientName]}),n.jsxs("span",{children:["",W.contractNumber]})]})]})}):q.id==="legalPerson"||q.id==="authorizedDelegate"?n.jsx("div",{className:"ml-3 flex-1",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"text-sm text-neutral-900",children:W.name}),n.jsxs("div",{className:"flex items-center space-x-3 text-xs text-neutral-600",children:[n.jsx("span",{children:W.position}),n.jsx("span",{className:`px-2 py-0.5 rounded ${W.status==="active"?"bg-green-100 text-green-700":"bg-neutral-100 text-neutral-700"}`,children:W.status==="active"?"":""})]})]})}):q.id==="otherPersonnel"?n.jsx("div",{className:"ml-3 flex-1",children:n.jsxs("div",{className:"flex flex-col gap-2",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"text-sm text-neutral-900",children:W.name}),n.jsxs("div",{className:"flex items-center space-x-3 text-xs text-neutral-600",children:[n.jsxs("span",{children:["",W.position]}),n.jsx("span",{className:`px-2 py-0.5 rounded ${W.status==="active"?"bg-green-100 text-green-700":"bg-neutral-100 text-neutral-700"}`,children:W.status==="active"?"":""})]})]}),W.selected&&n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"text-xs text-neutral-600 flex-shrink-0",children:""}),n.jsx("input",{type:"text",value:W.projectPosition||"",onChange:J=>{P(fe=>fe.map(be=>be.id===q.id?{...be,items:be.items.map(Re=>Re.id===W.id?{...Re,projectPosition:J.target.value}:Re)}:be))},placeholder:"",disabled:s,className:"flex-1 px-2 py-1 text-xs border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500 disabled:bg-neutral-50 disabled:cursor-not-allowed"})]})]})}):q.id==="productionEquipment"||q.id==="testingEquipment"||q.id==="companyProducts"?n.jsx("div",{className:"ml-3 flex-1",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"text-sm text-neutral-900",children:W.name}),n.jsxs("div",{className:"flex items-center space-x-3 text-xs text-neutral-600",children:[n.jsx("span",{className:"px-2 py-0.5 bg-purple-100 text-purple-700 rounded",children:W.productCategory}),n.jsxs("span",{children:["",W.productBrand]}),n.jsxs("span",{children:["",W.productModel]})]})]})}):n.jsx("span",{className:"ml-3 text-sm text-neutral-900",children:W.name}),L=()=>n.jsxs("div",{className:"max-w-2xl mx-auto",children:[n.jsx("div",{className:"mb-4 bg-blue-50 border border-blue-200 rounded-lg p-4",children:n.jsx("p",{className:"text-sm text-blue-800",children:""})}),n.jsxs("h3",{className:"text-lg font-medium text-neutral-900 mb-4",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),k.length===0?n.jsxs("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-6 text-center",children:[n.jsx("p",{className:"text-amber-800",children:""}),n.jsx("p",{className:"text-sm text-amber-600 mt-2",children:""})]}):n.jsx("div",{className:"space-y-3",children:k.map(W=>n.jsx("div",{onClick:()=>!s&&A(W),className:`p-4 border-2 rounded-lg transition-all ${s?"cursor-not-allowed":"cursor-pointer hover:border-primary-300"} ${(N==null?void 0:N.id)===W.id?"border-primary-600 bg-primary-50":"border-neutral-300 bg-white"}`,children:n.jsxs("div",{className:"flex items-start justify-between",children:[n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center",children:[n.jsx("h4",{className:"font-medium text-neutral-900",children:W.name}),W.is_default&&n.jsx("span",{className:"ml-2 px-2 py-0.5 text-xs bg-primary-100 text-primary-700 rounded",children:""})]}),n.jsx("div",{className:"mt-2 space-y-1 text-sm text-neutral-600"})]}),(N==null?void 0:N.id)===W.id&&n.jsx(aa,{className:"w-6 h-6 text-primary-600 flex-shrink-0 ml-3"})]})},W.id))})]}),V=()=>{const W=Ut.filter(Ae=>Ae.name.toLowerCase().includes(ue.toLowerCase())),q=["productionEquipment","testingEquipment","companyProducts"],J=["legalPerson","authorizedDelegate","otherPersonnel"],fe=B==="product",be=B==="personnel",Re=fe?j.find(Ae=>Ae.id===re):be?j.find(Ae=>Ae.id===Z):j.find(Ae=>Ae.id===B),G=Re?C(Re):[],Ne=G.filter(Ae=>Ae.selected).length,Te=j.filter(Ae=>!q.includes(Ae.id)&&!J.includes(Ae.id)),we=Te.filter(Ae=>Ae.id!=="templates"&&Ae.id!=="otherFiles"),ut=Te.find(Ae=>Ae.id==="templates"),vt=Te.find(Ae=>Ae.id==="otherFiles"),_t=j.filter(Ae=>q.includes(Ae.id)),Kr=_t.reduce((Ae,ct)=>Ae+ct.items.filter(Ur=>Ur.selected).length,0),Sa=_t.reduce((Ae,ct)=>Ae+ct.items.length,0),la=j.filter(Ae=>J.includes(Ae.id)),Ca=la.reduce((Ae,ct)=>Ae+ct.items.filter(Ur=>Ur.selected).length,0),Fi=la.reduce((Ae,ct)=>Ae+ct.items.length,0);return n.jsxs("div",{className:"max-w-4xl mx-auto space-y-6 pb-32",children:[n.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:n.jsx("p",{className:"text-sm text-blue-800",children:""})}),n.jsxs("div",{className:"bg-white rounded-lg border border-neutral-200 p-6",children:[n.jsxs("h3",{className:"text-lg font-medium text-neutral-900 mb-4",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),b?n.jsxs("div",{className:"px-4 py-3 bg-primary-50 border border-primary-300 rounded-lg flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsx("div",{className:"p-2 bg-white rounded shadow-sm",children:n.jsx(El,{className:"w-5 h-5 text-primary-600"})}),n.jsxs("div",{children:[n.jsx("div",{className:"text-xs text-neutral-500",children:""}),n.jsx("div",{className:"font-medium text-neutral-900",children:b.name})]})]}),!s&&n.jsx("button",{onClick:cn,className:"px-3 py-1.5 text-sm font-medium text-primary-600 hover:text-primary-700 bg-white hover:bg-primary-50 border border-primary-300 rounded transition-colors",children:""})]}):n.jsxs("div",{className:"relative mb-4",ref:Bt,children:[n.jsx("input",{type:"text",placeholder:"...",value:ue,onChange:Ae=>ve(Ae.target.value),onFocus:()=>H(!0),disabled:s,className:"w-full px-4 py-2.5 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 disabled:bg-neutral-50 disabled:cursor-not-allowed text-base"}),me&&!s&&n.jsx("div",{className:"absolute z-[100] w-full mt-2 bg-white border border-neutral-300 rounded-lg shadow-xl overflow-hidden max-h-[400px]",children:W.length===0?n.jsx("div",{className:"p-4 text-center text-neutral-500",children:""}):n.jsx("div",{className:"overflow-y-auto",children:W.map(Ae=>n.jsx("div",{onClick:()=>ln(Ae),className:"px-4 py-3 hover:bg-primary-50 cursor-pointer transition-colors border-b border-neutral-100 last:border-b-0",children:n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsx(El,{className:"w-5 h-5 text-primary-600 flex-shrink-0"}),n.jsx("span",{className:"text-sm text-neutral-900",children:Ae.name})]})},Ae.id))})})]})]}),b&&n.jsxs("div",{className:"bg-white rounded-lg border border-neutral-200 p-6 animate-fadeIn",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("h3",{className:"text-lg font-medium text-neutral-900",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsxs("span",{className:"text-xs text-neutral-500 bg-neutral-100 px-3 py-1 rounded-full",children:[" ",b.name," "]})]}),n.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-3 mb-4",children:n.jsx("p",{className:"text-sm text-amber-800",children:""})}),n.jsx("div",{className:"border-b border-neutral-200 mb-4",children:n.jsxs("div",{className:"flex space-x-1 overflow-x-auto",children:[we.map(Ae=>{const ct=Ae.items.filter(Yr=>Yr.selected).length,Ur=Ae.items.length;return n.jsxs("button",{onClick:()=>te(Ae.id),className:`px-4 py-2.5 text-sm font-medium whitespace-nowrap border-b-2 transition-colors ${B===Ae.id?"border-primary-600 text-primary-600":"border-transparent text-neutral-600 hover:text-neutral-900 hover:border-neutral-300"}`,children:[Ae.name,ct>0&&n.jsxs("span",{className:`ml-2 px-1.5 py-0.5 text-xs rounded ${B===Ae.id?"bg-primary-100 text-primary-700":"bg-neutral-100 text-neutral-600"}`,children:[ct,"/",Ur]})]},Ae.id)}),la.length>0&&n.jsxs("button",{onClick:()=>{te("personnel")},className:`px-4 py-2.5 text-sm font-medium whitespace-nowrap border-b-2 transition-colors ${be?"border-primary-600 text-primary-600":"border-transparent text-neutral-600 hover:text-neutral-900 hover:border-neutral-300"}`,children:["",Ca>0&&n.jsxs("span",{className:`ml-2 px-1.5 py-0.5 text-xs rounded ${be?"bg-primary-100 text-primary-700":"bg-neutral-100 text-neutral-600"}`,children:[Ca,"/",Fi]})]}),_t.length>0&&n.jsxs("button",{onClick:()=>{te("product")},className:`px-4 py-2.5 text-sm font-medium whitespace-nowrap border-b-2 transition-colors ${fe?"border-primary-600 text-primary-600":"border-transparent text-neutral-600 hover:text-neutral-900 hover:border-neutral-300"}`,children:["",Kr>0&&n.jsxs("span",{className:`ml-2 px-1.5 py-0.5 text-xs rounded ${fe?"bg-primary-100 text-primary-700":"bg-neutral-100 text-neutral-600"}`,children:[Kr,"/",Sa]})]}),ut&&n.jsxs("button",{onClick:()=>te(ut.id),className:`px-4 py-2.5 text-sm font-medium whitespace-nowrap border-b-2 transition-colors ${B===ut.id?"border-primary-600 text-primary-600":"border-transparent text-neutral-600 hover:text-neutral-900 hover:border-neutral-300"}`,children:[ut.name,ut.items.filter(Ae=>Ae.selected).length>0&&n.jsxs("span",{className:`ml-2 px-1.5 py-0.5 text-xs rounded ${B===ut.id?"bg-primary-100 text-primary-700":"bg-neutral-100 text-neutral-600"}`,children:[ut.items.filter(Ae=>Ae.selected).length,"/",ut.items.length]})]},ut.id),vt&&n.jsxs("button",{onClick:()=>te(vt.id),className:`px-4 py-2.5 text-sm font-medium whitespace-nowrap border-b-2 transition-colors ${B===vt.id?"border-primary-600 text-primary-600":"border-transparent text-neutral-600 hover:text-neutral-900 hover:border-neutral-300"}`,children:[vt.name,vt.items.filter(Ae=>Ae.selected).length>0&&n.jsxs("span",{className:`ml-2 px-1.5 py-0.5 text-xs rounded ${B===vt.id?"bg-primary-100 text-primary-700":"bg-neutral-100 text-neutral-600"}`,children:[vt.items.filter(Ae=>Ae.selected).length,"/",vt.items.length]})]},vt.id)]})}),be&&n.jsxs("div",{className:"mb-4",children:[n.jsx("div",{className:"border-b border-neutral-200",children:n.jsx("div",{className:"flex space-x-2",children:la.map(Ae=>{const ct=Ae.items.filter(Mn=>Mn.selected).length,Ur=Ae.items.length,Yr={legalPerson:"",authorizedDelegate:"",otherPersonnel:""};return n.jsxs("button",{onClick:()=>z(Ae.id),className:`px-4 py-2 text-sm font-medium transition-colors rounded-t ${Z===Ae.id?"bg-primary-600 text-white":"bg-neutral-100 text-neutral-600 hover:bg-neutral-200"}`,children:[Yr[Ae.id],ct>0&&n.jsxs("span",{className:`ml-2 px-1.5 py-0.5 text-xs rounded ${Z===Ae.id?"bg-primary-700 text-white":"bg-neutral-200 text-neutral-700"}`,children:[ct,"/",Ur]})]},Ae.id)})})}),Z==="authorizedDelegate"&&n.jsx("div",{className:"mt-2 bg-blue-50 border border-blue-200 rounded p-3",children:n.jsxs("p",{className:"text-xs text-blue-800",children:[n.jsx("span",{className:"font-medium",children:""}),""]})})]}),fe&&n.jsx("div",{className:"mb-4 border-b border-neutral-200",children:n.jsx("div",{className:"flex space-x-2",children:_t.map(Ae=>{const ct=Ae.items.filter(Mn=>Mn.selected).length,Ur=Ae.items.length,Yr={productionEquipment:"",testingEquipment:"",companyProducts:""};return n.jsxs("button",{onClick:()=>Q(Ae.id),className:`px-4 py-2 text-sm font-medium transition-colors rounded-t ${re===Ae.id?"bg-primary-600 text-white":"bg-neutral-100 text-neutral-600 hover:bg-neutral-200"}`,children:[Yr[Ae.id],ct>0&&n.jsxs("span",{className:`ml-2 px-1.5 py-0.5 text-xs rounded ${re===Ae.id?"bg-primary-700 text-white":"bg-neutral-200 text-neutral-700"}`,children:[ct,"/",Ur]})]},Ae.id)})})}),Re&&n.jsxs("div",{className:"border border-neutral-200 rounded-lg overflow-hidden",children:[n.jsxs("div",{className:"bg-neutral-50 px-4 py-3 border-b border-neutral-200",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("span",{className:"text-sm font-semibold text-neutral-900",children:Re.name}),n.jsxs("span",{className:"text-xs text-neutral-600",children:["(",Ne,"/",G.length,")"]})]}),!s&&n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("button",{onClick:()=>sn(Re.id,!0),className:"text-xs text-primary-600 hover:text-primary-800",children:""}),n.jsx("span",{className:"text-neutral-300",children:"|"}),n.jsx("button",{onClick:()=>sn(Re.id,!1),className:"text-xs text-neutral-600 hover:text-neutral-800",children:""})]})]}),n.jsx("div",{className:"mt-3",children:U(Re)})]}),n.jsx("div",{className:"p-4 space-y-2 max-h-96 overflow-y-auto",children:G.length===0?n.jsx("p",{className:"text-center text-neutral-500 py-4",children:""}):G.map(Ae=>{const ct=Re.id==="qualification"&&Ae.status==="expired",Yr=(Re.id==="legalPerson"||Re.id==="authorizedDelegate"||Re.id==="otherPersonnel")&&Ae.status==="resigned",Mn=s||ct||Yr;return n.jsxs("label",{className:`flex items-center p-3 rounded border border-transparent ${Mn?"cursor-not-allowed bg-neutral-50 opacity-60":"hover:bg-neutral-50 hover:border-neutral-200 cursor-pointer"} ${Ae.selected?"bg-primary-50 border-primary-200":""}`,title:ct?"":Yr?"":"",children:[n.jsx("input",{type:"checkbox",checked:Ae.selected,onChange:()=>an(Re.id,Ae.id),disabled:Mn,className:"w-4 h-4 text-primary-600 rounded focus:ring-primary-500 disabled:cursor-not-allowed flex-shrink-0"}),I(Ae,Re)]},Ae.id)})})]})]})]})},X=()=>{var q;const W=gt.filter(J=>J.projectName.toLowerCase().includes(F.toLowerCase())).sort((J,fe)=>new Date(fe.uploadTime).getTime()-new Date(J.uploadTime).getTime());return n.jsxs("div",{className:"max-w-4xl mx-auto space-y-6 pb-32",children:[n.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:n.jsx("p",{className:"text-sm text-blue-800",children:""})}),n.jsxs("div",{className:"bg-white rounded-lg border border-neutral-200 p-6",children:[n.jsxs("h3",{className:"text-lg font-medium text-neutral-900 mb-4",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),!x&&!t?n.jsxs("div",{className:"relative mb-4",ref:nt,children:[n.jsx("input",{type:"text",placeholder:"...",value:F,onChange:J=>ae(J.target.value),onFocus:()=>je(!0),disabled:s,className:"w-full px-4 py-2.5 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 disabled:bg-neutral-50 disabled:cursor-not-allowed text-base"}),T&&!s&&n.jsx("div",{className:"absolute z-[100] w-full mt-2 bg-white border border-neutral-300 rounded-lg shadow-xl overflow-hidden max-h-[400px]",children:W.length===0?n.jsx("div",{className:"p-4 text-center text-neutral-500",children:""}):n.jsx("div",{className:"overflow-y-auto",children:W.map(J=>n.jsx("div",{onClick:()=>ir(J),className:"px-4 py-3 hover:bg-primary-50 cursor-pointer transition-colors border-b border-neutral-100 last:border-b-0",children:n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsx(Od,{className:"w-5 h-5 text-primary-600 flex-shrink-0"}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("div",{className:"text-sm text-neutral-900 font-medium",children:J.projectName}),n.jsxs("div",{className:"text-xs text-neutral-500 mt-0.5",children:["",J.uploadTime]})]})]})},J.id))})})]}):n.jsxs("div",{className:"px-4 py-3 bg-primary-50 border border-primary-300 rounded-lg flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsx("div",{className:"p-2 bg-white rounded shadow-sm",children:n.jsx(Od,{className:"w-5 h-5 text-primary-600"})}),n.jsxs("div",{children:[n.jsx("div",{className:"text-xs text-neutral-500",children:""}),n.jsx("div",{className:"font-medium text-neutral-900",children:(q=x||t)==null?void 0:q.projectName})]})]}),!s&&!t&&n.jsx("button",{onClick:se,className:"px-3 py-1.5 text-sm font-medium text-primary-600 hover:text-primary-700 bg-white hover:bg-primary-50 border border-primary-300 rounded transition-colors",children:""})]})]}),(x||t)&&n.jsxs("div",{className:"bg-white rounded-lg border border-neutral-200 p-6",children:[n.jsxs("h3",{className:"text-lg font-medium text-neutral-900 mb-4",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("label",{className:`flex items-center p-4 border-2 rounded-lg ${s?"cursor-not-allowed bg-neutral-50":"cursor-pointer hover:bg-neutral-50"} transition-colors ${d.includes("commercial")?"border-primary-600 bg-primary-50":"border-neutral-300"}`,children:[n.jsx("input",{type:"checkbox",checked:d.includes("commercial"),onChange:()=>ot("commercial"),disabled:s,className:"w-5 h-5 text-primary-600 rounded focus:ring-primary-500 disabled:cursor-not-allowed"}),n.jsx("span",{className:"ml-3 font-medium text-neutral-900",children:""})]}),n.jsxs("label",{className:`flex items-center p-4 border-2 rounded-lg ${s?"cursor-not-allowed bg-neutral-50":"cursor-pointer hover:bg-neutral-50"} transition-colors ${d.includes("technical")?"border-primary-600 bg-primary-50":"border-neutral-300"}`,children:[n.jsx("input",{type:"checkbox",checked:d.includes("technical"),onChange:()=>ot("technical"),disabled:s,className:"w-5 h-5 text-primary-600 rounded focus:ring-primary-500 disabled:cursor-not-allowed"}),n.jsx("span",{className:"ml-3 font-medium text-neutral-900",children:""})]})]})]})]})},le=()=>Rt(),ge=()=>g||s?n.jsxs("div",{className:"max-w-2xl mx-auto text-center",children:[n.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 bg-green-100 rounded-full mb-6",children:n.jsx(aa,{className:"w-12 h-12 text-green-600"})}),n.jsx("h3",{className:"text-2xl font-semibold text-neutral-900 mb-2",children:s?"":""}),n.jsx("p",{className:"text-neutral-600 mb-8",children:""}),n.jsxs("div",{className:"flex justify-center space-x-4",children:[n.jsxs("button",{onClick:Br,className:"px-6 py-3 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors flex items-center",children:[n.jsx(js,{className:"w-5 h-5 mr-2"})," Word"]}),n.jsx("button",{onClick:e,className:"px-6 py-3 border border-neutral-300 text-neutral-700 rounded-lg hover:bg-neutral-50 transition-colors",children:""})]})]}):n.jsxs("div",{className:"max-w-2xl mx-auto",children:[n.jsx("div",{className:"mb-4 bg-blue-50 border border-blue-200 rounded-lg p-4",children:n.jsx("p",{className:"text-sm text-blue-800",children:""})}),n.jsxs("div",{className:"text-center mb-8",children:[n.jsx("h3",{className:"text-xl font-semibold text-neutral-900 mb-2",children:""}),n.jsx("p",{className:"text-neutral-600",children:""})]}),n.jsxs("div",{className:"bg-neutral-50 rounded-lg p-6 space-y-4 mb-6",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-sm text-neutral-600",children:""}),n.jsx("span",{className:"text-sm font-medium text-neutral-900",children:o})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-sm text-neutral-600",children:""}),n.jsxs("span",{className:"text-sm font-medium text-neutral-900",children:[d.includes("commercial")&&"",d.includes("commercial")&&d.includes("technical")&&"",d.includes("technical")&&""]})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-sm text-neutral-600",children:""}),n.jsx("span",{className:"text-sm font-medium text-neutral-900",children:x==null?void 0:x.projectName})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-sm text-neutral-600",children:""}),n.jsx("span",{className:"text-sm font-medium text-neutral-900",children:b==null?void 0:b.name})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-sm text-neutral-600",children:""}),n.jsx("span",{className:"text-sm font-medium text-neutral-900",children:N==null?void 0:N.name})]})]}),n.jsxs("div",{className:"bg-white border border-neutral-200 rounded-lg p-6 mb-8",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4 pb-3 border-b border-neutral-200",children:[n.jsx("h4",{className:"text-sm font-semibold text-neutral-900",children:""}),n.jsxs("span",{className:"text-sm font-semibold text-primary-600",children:[" ",j.reduce((W,q)=>W+q.items.filter(J=>J.selected).length,0)," "]})]}),(()=>{const W=J=>({company:"",qualification:"",financial:"",performance:"",legalPerson:"",authorizedDelegate:"",otherPersonnel:"",productionEquipment:"",testingEquipment:"",companyProducts:"",templates:""})[J]||J,q=j.map(J=>({id:J.id,name:W(J.id),count:J.items.filter(fe=>fe.selected).length})).filter(J=>J.count>0);return q.length===0?n.jsx("div",{className:"text-center py-4 text-neutral-500 text-sm",children:""}):n.jsx("div",{className:"space-y-2",children:q.map(J=>n.jsxs("div",{className:"flex justify-between items-center py-2 px-3 bg-neutral-50 rounded",children:[n.jsx("span",{className:"text-sm text-neutral-700",children:J.name}),n.jsxs("span",{className:"text-sm font-medium text-primary-600",children:[J.count," "]})]},J.id))})})()]}),ne?n.jsxs("div",{children:[n.jsx("div",{className:"flex items-center justify-center mb-4",children:n.jsx(Vu,{className:"w-8 h-8 text-primary-600 animate-spin"})}),n.jsxs("div",{className:"mb-2",children:[n.jsxs("div",{className:"flex justify-between text-sm text-neutral-600 mb-1",children:[n.jsx("span",{children:"..."}),n.jsxs("span",{children:[O,"%"]})]}),n.jsx("div",{className:"w-full bg-neutral-200 rounded-full h-2",children:n.jsx("div",{className:"bg-primary-600 h-2 rounded-full transition-all duration-300",style:{width:`${O}%`}})})]})]}):n.jsxs("div",{className:"flex justify-center items-center gap-4",children:[n.jsxs("button",{onClick:We,className:"px-6 py-3 border border-neutral-300 text-neutral-700 rounded-lg hover:bg-neutral-50 transition-colors font-medium flex items-center",children:[n.jsx(yi,{className:"w-4 h-4 mr-2"}),""]}),n.jsx("button",{onClick:gr,className:"px-8 py-3 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors font-medium",children:""})]})]}),ie=W=>{if(!oe)return;const q=J=>J.map(fe=>fe.id===oe.id?{...fe,selectedKnowledgeItems:W}:fe.children.length>0?{...fe,children:q(fe.children)}:fe);Me==="commercial"?m(q(p)):v(q(w)),Le(!1)},ce=()=>!pe||!oe?null:n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] flex flex-col",children:[n.jsxs("div",{className:"px-6 py-4 border-b border-neutral-200 flex items-center justify-between",children:[n.jsxs("h3",{className:"text-lg font-semibold text-neutral-900",children:['"',oe.title,'"']}),n.jsx("button",{onClick:()=>Le(!1),className:"text-neutral-500 hover:text-neutral-700 transition-colors",children:n.jsx(Qe,{className:"w-5 h-5"})})]}),n.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:j.length===0?n.jsx("div",{className:"text-center py-8 text-neutral-500",children:"3"}):n.jsx("div",{className:"space-y-4",children:j.map(W=>{const q=C(W);return q.length===0?null:n.jsxs("div",{className:"border border-neutral-200 rounded-lg overflow-hidden",children:[n.jsxs("div",{className:"bg-neutral-50 px-4 py-3 border-b border-neutral-200",children:[n.jsx("div",{className:"flex items-center justify-between mb-2",children:n.jsx("h4",{className:"text-sm font-semibold text-neutral-900",children:W.name})}),n.jsx("div",{className:"mt-2",children:U(W)})]}),n.jsx("div",{className:"p-4 space-y-2 max-h-60 overflow-y-auto",children:q.map(J=>n.jsxs("label",{className:"flex items-start gap-3 p-3 border border-neutral-200 rounded hover:bg-neutral-50 cursor-pointer transition-colors",children:[n.jsx("input",{type:"checkbox",checked:Oe.includes(J.id),onChange:fe=>{const be=fe.target.checked?[...Oe,J.id]:Oe.filter(Re=>Re!==J.id);He(be)},className:"mt-0.5 w-4 h-4 text-primary-600 rounded focus:ring-primary-500"}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("div",{className:"text-sm font-medium text-neutral-900",children:J.name}),(J.certNumber||J.projectName||J.year)&&n.jsxs("div",{className:"text-xs text-neutral-500 mt-1 space-x-2",children:[J.certNumber&&n.jsxs("span",{children:[": ",J.certNumber]}),J.projectName&&n.jsxs("span",{children:[": ",J.projectName]}),J.year&&n.jsxs("span",{children:[": ",J.year]})]})]})]},J.id))})]},W.id)})})}),n.jsxs("div",{className:"px-6 py-4 border-t border-neutral-200 flex justify-between items-center",children:[n.jsxs("div",{className:"text-sm text-neutral-600",children:[" ",n.jsx("span",{className:"font-semibold text-primary-600",children:Oe.length})," "]}),n.jsxs("div",{className:"flex gap-3",children:[n.jsx("button",{onClick:()=>Le(!1),className:"px-4 py-2 border border-neutral-300 text-neutral-700 rounded-lg hover:bg-neutral-50 transition-colors",children:""}),n.jsx("button",{onClick:()=>ie(Oe),className:"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors",children:""})]})]})]})}),de=W=>{if(!oe)return;const q=J=>J.map(fe=>fe.id===oe.id?{...fe,selectedReferenceItems:W}:fe.children.length>0?{...fe,children:q(fe.children)}:fe);Me==="commercial"?m(q(p)):v(q(w)),he(!1)},_e=()=>{if(!Se||!oe)return null;const W=j.find(J=>J.id==="templates"),q=(W==null?void 0:W.items)||[];return n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] flex flex-col",children:[n.jsxs("div",{className:"px-6 py-4 border-b border-neutral-200 flex items-center justify-between",children:[n.jsxs("h3",{className:"text-lg font-semibold text-neutral-900",children:['"',oe.title,'"']}),n.jsx("button",{onClick:()=>he(!1),className:"text-neutral-500 hover:text-neutral-700 transition-colors",children:n.jsx(Qe,{className:"w-5 h-5"})})]}),n.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:q.length===0?n.jsx("div",{className:"text-center py-8 text-neutral-500",children:""}):n.jsx("div",{className:"space-y-2",children:q.map(J=>n.jsxs("label",{className:"flex items-start gap-3 p-3 border border-neutral-200 rounded hover:bg-neutral-50 cursor-pointer transition-colors",children:[n.jsx("input",{type:"checkbox",checked:Ze.includes(J.id),onChange:fe=>{const be=fe.target.checked?[...Ze,J.id]:Ze.filter(Re=>Re!==J.id);pt(be)},className:"mt-0.5 w-4 h-4 text-blue-600 rounded focus:ring-blue-500"}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("div",{className:"text-sm font-medium text-neutral-900",children:J.name}),J.uploadTime&&n.jsxs("div",{className:"text-xs text-neutral-500 mt-1",children:[": ",J.uploadTime]})]})]},J.id))})}),n.jsxs("div",{className:"px-6 py-4 border-t border-neutral-200 flex justify-between items-center",children:[n.jsxs("div",{className:"text-sm text-neutral-600",children:[" ",n.jsx("span",{className:"font-semibold text-blue-600",children:Ze.length})," "]}),n.jsxs("div",{className:"flex gap-3",children:[n.jsx("button",{onClick:()=>he(!1),className:"px-4 py-2 border border-neutral-300 text-neutral-700 rounded-lg hover:bg-neutral-50 transition-colors",children:""}),n.jsx("button",{onClick:()=>de(Ze),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:""})]})]})]})})},Ce=()=>{switch(l){case 1:return Et();case 2:return X();case 3:return V();case 4:return le();case 5:return L();case 6:return ge();default:return null}};return n.jsxs("div",{className:"flex flex-col h-full bg-white",children:[n.jsx("div",{className:"border-b border-neutral-200 px-6 py-4 flex-shrink-0",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("h2",{className:"text-xl font-semibold text-neutral-900",children:s?"":i?"":""}),n.jsx("button",{onClick:e,className:"text-neutral-600 hover:text-neutral-900 transition-colors",children:n.jsx(Qe,{className:"w-6 h-6"})})]})}),n.jsx("div",{className:"flex-1 overflow-auto",children:n.jsxs("div",{className:"p-8",children:[Sr(),Ce()]})}),l<6&&n.jsxs("div",{className:"relative z-10 border-t border-neutral-200 bg-white px-6 py-4 flex justify-between flex-shrink-0 shadow-lg",children:[n.jsxs("button",{onClick:We,disabled:l===1,className:"px-6 py-2.5 border border-neutral-300 text-neutral-700 rounded-lg hover:bg-neutral-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center font-medium",children:[n.jsx(yi,{className:"w-4 h-4 mr-2"}),""]}),n.jsxs("button",{onClick:s?()=>c(Math.min(l+1,6)):ee,disabled:s?l>=6:!Je(),className:"px-6 py-2.5 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center font-medium",children:["",n.jsx(ub,{className:"w-4 h-4 ml-2"})]})]}),ce(),_e()]})},QE=({preSelectedProject:e,canEdit:t=!0,canDelete:r=!0})=>{const[a,s]=M.useState(()=>{const v=localStorage.getItem("generated_documents"),b=localStorage.getItem("generated_documents_version"),y="1.4";return v&&b===y?JSON.parse(v):(localStorage.setItem("generated_documents_version",y),[{id:"1",name:"",fileTypes:["commercial","technical"],projectId:"5",projectName:"",companyName:"",status:"generating",createdAt:"2025-10-13 11:30:00",generationProgress:72},{id:"2",name:"",fileTypes:["commercial","technical"],projectId:"2",projectName:"",companyName:"",status:"completed",createdAt:"2025-10-11 16:45:00"},{id:"3",name:"",fileTypes:["commercial"],projectId:"1",projectName:"",companyName:"XX",status:"draft",createdAt:"2025-10-10 14:20:00"}])}),[i,l]=M.useState(()=>{if(e)return e;const v=localStorage.getItem("preselected_bidding_project");return v?(localStorage.removeItem("preselected_bidding_project"),JSON.parse(v)):null}),[c,o]=M.useState(()=>i?"create":"list"),[u,d]=M.useState(null);M.useEffect(()=>{localStorage.setItem("generated_documents",JSON.stringify(a))},[a]);const f=()=>{o("create")},x=v=>{d(v),o("view")},h=v=>{d(v),o("edit")},p=v=>{s(a.filter(b=>b.id!==v))},m=v=>{alert(`: ${v.name}`)},w=()=>{o("list"),d(null)};return c==="create"?n.jsx(H0,{onClose:w,preSelectedProject:i,mode:"create"}):c==="edit"?n.jsx(H0,{onClose:w,preSelectedProject:null,mode:"edit",existingDocument:u}):c==="view"?n.jsx(H0,{onClose:w,preSelectedProject:null,mode:"view",existingDocument:u}):n.jsx(JE,{documents:a,onCreateClick:f,onViewDocument:x,onEditDocument:h,onDeleteDocument:p,onDownloadDocument:m})},ZE=[{id:"default-stamp",name:"",description:"",isPublic:!0,isDefault:!0}],eT=({onClose:e})=>{const[t,r]=M.useState(ZE),[a,s]=M.useState(""),[i,l]=M.useState(!1),[c,o]=M.useState(!1),[u,d]=M.useState(!1),[f,x]=M.useState(null),[h,p]=M.useState({name:"",description:""}),m=t.filter(k=>k.name.toLowerCase().includes(a.toLowerCase())||k.description.toLowerCase().includes(a.toLowerCase())),w=()=>{p({name:"",description:""}),l(!0)},v=k=>{k.isDefault||(x(k),p({name:k.name,description:k.description}),o(!0))},b=k=>{k.isDefault||(x(k),d(!0))},y=()=>{const k={id:String(Date.now()),name:h.name,description:h.description,isPublic:!0};r([...t,k]),l(!1)},N=()=>{f&&r(t.map(k=>k.id===f.id?{...k,name:h.name,description:h.description}:k)),o(!1),x(null)},A=()=>{f&&r(t.filter(k=>k.id!==f.id)),d(!1),x(null)};return n.jsxs("div",{className:"flex flex-col h-full",children:[n.jsx("div",{className:"flex-1 overflow-auto",children:n.jsxs("div",{className:"bg-white rounded-lg border border-neutral-200",children:[n.jsxs("div",{className:"px-6 py-4 border-b border-neutral-200",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h3",{className:"text-lg font-semibold text-neutral-900",children:""}),n.jsx("button",{onClick:e,className:"text-neutral-400 hover:text-neutral-600 transition-colors",children:n.jsx(Qe,{className:"w-5 h-5"})})]}),n.jsxs("div",{className:"flex items-center justify-between gap-4",children:[n.jsxs("div",{className:"flex-1 relative",children:[n.jsx(Tb,{className:"w-4 h-4 text-neutral-400 absolute left-3 top-2.5"}),n.jsx("input",{type:"text",placeholder:"...",value:a,onChange:k=>s(k.target.value),className:"w-full pl-10 pr-4 py-2 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("button",{onClick:w,className:"px-4 py-2 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors flex items-center",children:[n.jsx(Pt,{className:"w-4 h-4 mr-1"}),""]})]})]}),n.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[n.jsx("div",{className:"space-y-3",children:m.map(k=>n.jsx("div",{className:"bg-neutral-50 rounded-lg p-4 hover:bg-neutral-100 transition-colors",children:n.jsxs("div",{className:"flex items-start justify-between",children:[n.jsxs("div",{className:"flex-1",children:[n.jsx("h4",{className:"font-medium text-neutral-900 mb-2",children:k.name}),n.jsx("p",{className:"text-sm text-neutral-600",children:k.description})]}),n.jsx("div",{className:"flex items-center space-x-2 ml-4",children:k.isDefault?n.jsx("span",{className:"px-3 py-1 text-xs bg-blue-100 text-blue-700 rounded-full font-medium",children:""}):n.jsxs(n.Fragment,{children:[n.jsxs("button",{onClick:()=>v(k),className:"px-2 py-1 text-xs text-primary-600 hover:text-primary-800 hover:bg-primary-50 rounded transition-colors flex items-center gap-1",children:[n.jsx(Dt,{className:"w-3.5 h-3.5"}),""]}),n.jsxs("button",{onClick:()=>b(k),className:"px-2 py-1 text-xs text-red-600 hover:text-red-800 hover:bg-red-50 rounded transition-colors flex items-center gap-1",children:[n.jsx(qe,{className:"w-3.5 h-3.5"}),""]})]})})]})},k.id))}),m.length===0&&n.jsx("div",{className:"text-center py-12 text-neutral-500",children:n.jsx("p",{children:""})})]}),n.jsx("div",{className:"p-6 border-t border-neutral-200",children:n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsxs("p",{className:"text-sm text-neutral-600",children:[" ",m.length," "]}),n.jsx("button",{onClick:e,className:"px-6 py-2 bg-neutral-100 hover:bg-neutral-200 text-neutral-700 rounded-lg transition-colors",children:""})]})})]})}),i&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[60]",children:n.jsx("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full mx-4",children:n.jsxs("div",{className:"p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h3",{className:"text-lg font-semibold text-neutral-900",children:""}),n.jsx("button",{onClick:()=>l(!1),className:"text-neutral-400 hover:text-neutral-600 transition-colors",children:n.jsx(Qe,{className:"w-5 h-5"})})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:h.name,onChange:k=>p({...h,name:k.target.value}),placeholder:"",className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("textarea",{value:h.description,onChange:k=>p({...h,description:k.target.value}),placeholder:"",rows:3,className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{className:"flex space-x-3 pt-4",children:[n.jsx("button",{onClick:()=>l(!1),className:"flex-1 bg-neutral-100 hover:bg-neutral-200 text-neutral-700 py-2 rounded-lg transition-colors",children:""}),n.jsx("button",{onClick:y,disabled:!h.name||!h.description,className:"flex-1 bg-primary-600 hover:bg-primary-700 text-white py-2 rounded-lg transition-colors disabled:bg-neutral-300 disabled:cursor-not-allowed",children:""})]})]})]})})}),c&&f&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[60]",children:n.jsx("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full mx-4",children:n.jsxs("div",{className:"p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h3",{className:"text-lg font-semibold text-neutral-900",children:""}),n.jsx("button",{onClick:()=>o(!1),className:"text-neutral-400 hover:text-neutral-600 transition-colors",children:n.jsx(Qe,{className:"w-5 h-5"})})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:h.name,onChange:k=>p({...h,name:k.target.value}),className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("textarea",{value:h.description,onChange:k=>p({...h,description:k.target.value}),rows:3,className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{className:"flex space-x-3 pt-4",children:[n.jsx("button",{onClick:()=>o(!1),className:"flex-1 bg-neutral-100 hover:bg-neutral-200 text-neutral-700 py-2 rounded-lg transition-colors",children:""}),n.jsx("button",{onClick:N,disabled:!h.name||!h.description,className:"flex-1 bg-primary-600 hover:bg-primary-700 text-white py-2 rounded-lg transition-colors disabled:bg-neutral-300 disabled:cursor-not-allowed",children:""})]})]})]})})}),u&&f&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[60]",children:n.jsx("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full mx-4",children:n.jsxs("div",{className:"p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h3",{className:"text-lg font-semibold text-neutral-900",children:""}),n.jsx("button",{onClick:()=>d(!1),className:"text-neutral-400 hover:text-neutral-600 transition-colors",children:n.jsx(Qe,{className:"w-5 h-5"})})]}),n.jsxs("div",{className:"mb-6",children:[n.jsxs("p",{className:"text-neutral-700",children:[" ",n.jsxs("span",{className:"font-semibold",children:['"',f.name,'"']})," "]}),n.jsx("p",{className:"text-sm text-neutral-500 mt-2",children:""})]}),n.jsxs("div",{className:"flex space-x-3",children:[n.jsx("button",{onClick:()=>d(!1),className:"flex-1 bg-neutral-100 hover:bg-neutral-200 text-neutral-700 py-2 rounded-lg transition-colors",children:""}),n.jsx("button",{onClick:A,className:"flex-1 bg-red-600 hover:bg-red-700 text-white py-2 rounded-lg transition-colors",children:""})]})]})})})]})},tT=({checkName:e,totalCheckPoints:t,onComplete:r,onClose:a})=>{const[s,i]=M.useState(0),[l,c]=M.useState(0),[o,u]=M.useState(!1),[d,f]=M.useState(null),x=[{id:0,name:"",description:"..."},{id:1,name:"",description:"..."},{id:2,name:"",description:"..."},{id:3,name:"",description:"..."},{id:4,name:"",description:"..."},{id:5,name:"",description:"..."},{id:6,name:"",description:"..."},{id:7,name:"",description:"..."},{id:8,name:"",description:"..."},{id:9,name:"",description:"..."},{id:10,name:"",description:""}];M.useEffect(()=>{const p=setInterval(()=>{c(m=>m>=100?(clearInterval(p),100):m+1)},80);return()=>clearInterval(p)},[]),M.useEffect(()=>{const p=Math.floor(l/(100/x.length));p<x.length&&i(p),l===100&&setTimeout(()=>{const m=Math.floor(Math.random()*5)+(t-5),w=t-m,v=Array.from({length:t},(y,N)=>({id:`cp-${N+1}`,name:` ${N+1}`,status:N<m?"passed":"failed",message:N<m?"":""})),b={passed:m,failed:w,details:v};f(b),u(!0),r(b)},500)},[l,x.length,t,r]);const h=()=>{alert("...")};return o&&d?n.jsxs("div",{className:"flex flex-col h-full bg-white",children:[n.jsxs("div",{className:"px-6 py-4 border-b border-neutral-200 flex items-center justify-between",children:[n.jsx("h3",{className:"text-lg font-semibold text-neutral-900",children:""}),n.jsx("button",{onClick:a,className:"text-neutral-400 hover:text-neutral-600 transition-colors",children:n.jsx(Qe,{className:"w-5 h-5"})})]}),n.jsx("div",{className:"flex-1 overflow-auto p-6",children:n.jsxs("div",{className:"max-w-2xl mx-auto",children:[n.jsxs("div",{className:"text-center mb-8",children:[n.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 rounded-full bg-green-100 mb-6",children:n.jsx(aa,{className:"w-12 h-12 text-green-600"})}),n.jsx("h3",{className:"text-2xl font-semibold text-neutral-900 mb-2",children:""}),n.jsx("p",{className:"text-neutral-600 mb-8",children:""}),n.jsxs("div",{className:"flex justify-center space-x-4",children:[n.jsxs("button",{onClick:h,className:"px-6 py-3 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors flex items-center",children:[n.jsx(js,{className:"w-5 h-5 mr-2"}),""]}),n.jsx("button",{onClick:a,className:"px-6 py-3 border border-neutral-300 text-neutral-700 rounded-lg hover:bg-neutral-50 transition-colors",children:""})]})]}),n.jsxs("div",{className:"bg-neutral-50 rounded-lg p-6 space-y-4 mb-8",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-sm text-neutral-600",children:""}),n.jsx("span",{className:"text-sm font-medium text-neutral-900",children:e})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-sm text-neutral-600",children:""}),n.jsxs("span",{className:"text-sm font-medium text-neutral-900",children:[t," "]})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-sm text-neutral-600",children:""}),n.jsxs("span",{className:"text-sm font-medium text-green-600",children:[d.passed," "]})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-sm text-neutral-600",children:""}),n.jsxs("span",{className:"text-sm font-medium text-red-600",children:[d.failed," "]})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-sm text-neutral-600",children:""}),n.jsxs("span",{className:"text-sm font-medium text-neutral-900",children:[Math.round(d.passed/t*100),"%"]})]})]}),n.jsxs("div",{className:"bg-neutral-50 rounded-lg p-6",children:[n.jsx("h4",{className:"font-medium text-neutral-900 mb-4",children:""}),n.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:d.details.map(p=>n.jsxs("div",{className:`flex items-start p-3 rounded-lg ${p.status==="passed"?"bg-white border border-green-200":"bg-white border border-red-200"}`,children:[n.jsx("div",{className:`flex-shrink-0 w-5 h-5 rounded-full flex items-center justify-center mr-3 mt-0.5 ${p.status==="passed"?"bg-green-100":"bg-red-100"}`,children:p.status==="passed"?n.jsx(aa,{className:"w-3 h-3 text-green-600"}):n.jsx(Qe,{className:"w-3 h-3 text-red-600"})}),n.jsxs("div",{className:"flex-1",children:[n.jsx("div",{className:"font-medium text-neutral-900 text-sm",children:p.name}),n.jsx("div",{className:`text-xs mt-1 ${p.status==="passed"?"text-green-700":"text-red-700"}`,children:p.message})]})]},p.id))})]})]})})]}):n.jsxs("div",{className:"flex flex-col h-full bg-white",children:[n.jsxs("div",{className:"px-6 py-4 border-b border-neutral-200",children:[n.jsx("h3",{className:"text-lg font-semibold text-neutral-900",children:""}),n.jsx("p",{className:"text-sm text-neutral-600 mt-1",children:e})]}),n.jsx("div",{className:"flex-1 overflow-auto p-6",children:n.jsxs("div",{className:"max-w-2xl mx-auto",children:[n.jsxs("div",{className:"mb-8",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("span",{className:"text-sm font-medium text-neutral-700",children:""}),n.jsxs("span",{className:"text-sm font-medium text-primary-600",children:[l,"%"]})]}),n.jsx("div",{className:"w-full bg-neutral-200 rounded-full h-3 overflow-hidden",children:n.jsx("div",{className:"bg-primary-600 h-full rounded-full transition-all duration-300 ease-out",style:{width:`${l}%`}})})]}),n.jsx("div",{className:"space-y-4",children:x.map((p,m)=>{const w=m<s,v=m===s;return n.jsxs("div",{className:`flex items-start p-4 rounded-lg transition-all ${v?"bg-primary-50 border-2 border-primary-200":w?"bg-green-50 border border-green-200":"bg-neutral-50 border border-neutral-200"}`,children:[n.jsx("div",{className:`flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center mr-4 ${v?"bg-primary-600":w?"bg-green-600":"bg-neutral-300"}`,children:w?n.jsx(aa,{className:"w-5 h-5 text-white"}):v?n.jsx(Vu,{className:"w-5 h-5 text-white animate-spin"}):n.jsx("span",{className:"text-sm font-medium text-white",children:m+1})}),n.jsxs("div",{className:"flex-1",children:[n.jsx("div",{className:`font-medium mb-1 ${v?"text-primary-900":w?"text-green-900":"text-neutral-600"}`,children:p.name}),n.jsx("div",{className:`text-sm ${v?"text-primary-700":w?"text-green-700":"text-neutral-500"}`,children:v?p.description:w?"":""})]})]},p.id)})})]})})]})},rT=[{id:"1",name:"",status:"",createdAt:"2024-01-20"},{id:"2",name:"",status:"",createdAt:"2024-01-18"},{id:"3",name:"",status:"",createdAt:"2024-01-15"},{id:"4",name:"",status:"",createdAt:"2024-01-12"}],nT=[{id:"p1",name:"",selected:!0},{id:"p2",name:"",selected:!0},{id:"p3",name:"",selected:!0},{id:"p4",name:"",selected:!0},{id:"p5",name:"/",selected:!0},{id:"p6",name:"",selected:!0}],aT=[{id:"pub1",name:"",description:"",selected:!1}],sT=({onClose:e,onComplete:t})=>{const[r,a]=M.useState(1),[s,i]=M.useState(""),[l,c]=M.useState(null),[o,u]=M.useState(null),[d,f]=M.useState(nT),[x,h]=M.useState(aT),[p,m]=M.useState([]),[w,v]=M.useState({name:"",description:""}),[b,y]=M.useState(""),[N,A]=M.useState(!1),[k,_]=M.useState(0),P=rT.filter(g=>g.status==="").filter(g=>g.name.toLowerCase().includes(b.toLowerCase())),D=g=>{var F;const S=(F=g.target.files)==null?void 0:F[0];if(S){if(S.type!=="application/pdf"){alert("PDF");return}if(S.size>50*1024*1024){alert("50MB");return}u(S)}},K=()=>{if(r===1){if(!s.trim()){alert("");return}if(!o){alert("");return}}if(r===2){if(!l){alert("");return}if(d.filter(S=>S.selected).length===0){alert("");return}}if(r<4)a(r+1);else{const g=[...d.filter(S=>S.selected),...x.filter(S=>S.selected),...p].length;_(g),A(!0)}},E=()=>{r>1&&a(r-1)},Y=g=>{t({name:s,documentName:o==null?void 0:o.name,documentType:"uploaded",totalCheckPoints:g.passed+g.failed,passedCheckPoints:g.passed,failedCheckPoints:g.failed})},B=()=>{e()},te=g=>{f(d.map(S=>S.id===g?{...S,selected:!S.selected}:S))},re=g=>{h(x.map(S=>S.id===g?{...S,selected:!S.selected}:S))},Q=()=>{if(!w.name.trim()||!w.description.trim()){alert("");return}const g={id:`project-${Date.now()}`,name:w.name,description:w.description};m([...p,g]),v({name:"",description:""})},Z=g=>{m(p.filter(S=>S.id!==g))},z=()=>n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:s,onChange:g=>i(g.target.value),placeholder:"",className:"w-full px-4 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsxs("div",{className:"border-2 border-dashed border-neutral-300 rounded-lg p-8 text-center hover:border-primary-500 transition-colors cursor-pointer",onClick:()=>{var g;return(g=document.getElementById("file-upload"))==null?void 0:g.click()},children:[n.jsx(St,{className:"w-12 h-12 mx-auto text-neutral-400 mb-3"}),n.jsx("p",{className:"text-sm text-neutral-600 mb-1 font-medium",children:""}),n.jsx("p",{className:"text-xs text-neutral-500",children:"pdf"}),n.jsx("input",{type:"file",accept:".pdf",onChange:D,className:"hidden",id:"file-upload"})]}),o&&n.jsx("div",{className:"mt-4",children:n.jsxs("div",{className:"flex items-center justify-between bg-primary-50 border border-primary-200 px-4 py-3 rounded-lg",children:[n.jsxs("div",{className:"flex items-center space-x-3 flex-1 min-w-0",children:[n.jsx(Lt,{className:"w-5 h-5 text-primary-600 flex-shrink-0"}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("p",{className:"text-sm font-medium text-neutral-900 truncate",children:o.name}),n.jsxs("p",{className:"text-xs text-neutral-600 mt-0.5",children:[(o.size/1024/1024).toFixed(2)," MB"]})]})]}),n.jsx("button",{onClick:g=>{g.stopPropagation(),u(null)},className:"text-red-600 hover:text-red-800 transition-colors ml-3 flex-shrink-0",children:n.jsx(Qe,{className:"w-5 h-5"})})]})})]})]}),ne=()=>n.jsxs("div",{className:"space-y-6",children:[n.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:n.jsx("p",{className:"text-sm text-blue-800",children:'""'})}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("div",{className:"mb-3",children:n.jsx("input",{type:"text",placeholder:"...",value:b,onChange:g=>y(g.target.value),className:"w-full px-4 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})}),n.jsx("div",{className:"max-h-[280px] overflow-y-auto border border-neutral-200 rounded-lg",children:P.length===0?n.jsxs("div",{className:"p-8 text-center text-neutral-500",children:[n.jsx(go,{className:"w-12 h-12 mx-auto mb-3 text-neutral-400"}),n.jsx("p",{children:""})]}):P.map(g=>n.jsx("div",{onClick:()=>c(g),className:`p-4 border-b border-neutral-100 last:border-b-0 cursor-pointer transition-colors ${(l==null?void 0:l.id)===g.id?"bg-primary-50 border-l-4 border-l-primary-500":"hover:bg-neutral-50"}`,children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center flex-1",children:[n.jsx(go,{className:"w-5 h-5 mr-3 text-primary-600"}),n.jsxs("div",{className:"flex-1",children:[n.jsx("div",{className:"font-medium text-neutral-900",children:g.name}),n.jsxs("div",{className:"text-sm text-neutral-600 mt-1",children:[": ",g.createdAt]})]})]}),n.jsx("span",{className:"text-xs px-2 py-1 rounded bg-green-100 text-green-800",children:g.status})]})},g.id))})]}),l&&n.jsxs("div",{children:[n.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4",children:n.jsx("p",{className:"text-sm text-blue-800",children:""})}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex items-center justify-between mb-3",children:[n.jsx("h4",{className:"font-medium text-neutral-900",children:""}),n.jsxs("span",{className:"text-sm text-neutral-600",children:[" ",d.filter(g=>g.selected).length," / ",d.length]})]}),n.jsx("div",{className:"border border-neutral-200 rounded-lg p-4 max-h-80 overflow-y-auto",children:n.jsx("div",{className:"grid grid-cols-2 gap-2",children:d.map(g=>n.jsxs("label",{className:"flex items-center p-2 bg-neutral-50 rounded hover:bg-neutral-100 cursor-pointer transition-colors",children:[n.jsx("input",{type:"checkbox",checked:g.selected,onChange:()=>te(g.id),className:"w-4 h-4 text-primary-600 rounded mr-2 flex-shrink-0"}),n.jsx("span",{className:"text-sm text-neutral-900",children:g.name})]},g.id))})})]})]})]}),xe=()=>n.jsxs("div",{className:"space-y-6",children:[n.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:n.jsx("p",{className:"text-sm text-green-800",children:""})}),n.jsxs("div",{children:[n.jsx("h4",{className:"font-medium text-neutral-900 mb-3",children:""}),n.jsx("div",{className:"border border-neutral-200 rounded-lg p-4 max-h-80 overflow-y-auto",children:x.length===0?n.jsxs("div",{className:"text-center text-neutral-500 py-8",children:[n.jsx(Vx,{className:"w-12 h-12 mx-auto mb-3 text-neutral-400"}),n.jsx("p",{children:""}),n.jsx("p",{className:"text-sm mt-1",children:'""'})]}):n.jsx("div",{className:"space-y-2",children:x.map(g=>n.jsxs("label",{className:"flex items-start p-3 bg-neutral-50 rounded hover:bg-neutral-100 cursor-pointer transition-colors",children:[n.jsx("input",{type:"checkbox",checked:g.selected,onChange:()=>re(g.id),className:"w-4 h-4 text-primary-600 rounded mt-0.5 mr-3 flex-shrink-0"}),n.jsxs("div",{className:"flex-1",children:[n.jsx("div",{className:"font-medium text-neutral-900",children:g.name}),n.jsx("div",{className:"text-sm text-neutral-600 mt-1",children:g.description})]})]},g.id))})})]}),n.jsxs("div",{children:[n.jsx("h4",{className:"font-medium text-neutral-900 mb-3",children:""}),n.jsxs("div",{className:"space-y-3 bg-neutral-50 rounded-lg p-4",children:[n.jsx("div",{children:n.jsx("input",{type:"text",placeholder:"",value:w.name,onChange:g=>v({...w,name:g.target.value}),className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})}),n.jsx("div",{children:n.jsx("textarea",{placeholder:"",value:w.description,onChange:g=>v({...w,description:g.target.value}),rows:2,className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})}),n.jsxs("button",{onClick:Q,className:"w-full px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center justify-center",children:[n.jsx(Pt,{className:"w-4 h-4 mr-1"}),""]})]}),p.length>0&&n.jsxs("div",{className:"mt-4 space-y-2",children:[n.jsxs("h5",{className:"text-sm font-medium text-neutral-700",children:[" (",p.length,")"]}),p.map(g=>n.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:n.jsxs("div",{className:"flex items-start justify-between",children:[n.jsxs("div",{className:"flex-1",children:[n.jsx("div",{className:"font-medium text-neutral-900",children:g.name}),n.jsx("div",{className:"text-sm text-neutral-600 mt-1",children:g.description})]}),n.jsx("button",{onClick:()=>Z(g.id),className:"text-red-600 hover:text-red-800 ml-2",children:n.jsx(qe,{className:"w-4 h-4"})})]})},g.id))]})]})]}),O=()=>{const g=d.filter(ae=>ae.selected).length,S=x.filter(ae=>ae.selected).length,F=g+S+p.length;return n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"text-center",children:[n.jsx(Vx,{className:"w-16 h-16 text-primary-600 mx-auto mb-4"}),n.jsx("h3",{className:"text-xl font-semibold text-neutral-900 mb-2",children:""}),n.jsx("p",{className:"text-neutral-600",children:""})]}),n.jsxs("div",{className:"bg-neutral-50 rounded-lg p-6 space-y-4",children:[n.jsxs("div",{children:[n.jsx("span",{className:"text-sm text-neutral-600",children:""}),n.jsx("p",{className:"font-medium text-neutral-900 mt-1",children:s})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-sm text-neutral-600",children:""}),n.jsx("p",{className:"font-medium text-neutral-900 mt-1",children:o==null?void 0:o.name})]}),l&&n.jsxs("div",{children:[n.jsx("span",{className:"text-sm text-neutral-600",children:""}),n.jsx("p",{className:"font-medium text-neutral-900 mt-1",children:l.name})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-sm text-neutral-600",children:""}),n.jsx("p",{className:"font-medium text-neutral-900 mt-1",children:F})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-sm text-neutral-600",children:""}),n.jsxs("div",{className:"mt-2 space-y-1 text-sm",children:[n.jsxs("p",{className:"text-neutral-700",children:[" : ",g," "]}),n.jsxs("p",{className:"text-neutral-700",children:[" : ",S," "]}),n.jsxs("p",{className:"text-neutral-700",children:[" : ",p.length," "]})]})]})]})]})},R=[{number:1,title:""},{number:2,title:""},{number:3,title:""},{number:4,title:""}];return N?n.jsx(tT,{checkName:s,totalCheckPoints:k,onComplete:Y,onClose:B}):n.jsx("div",{className:"flex flex-col h-full",children:n.jsx("div",{className:"flex-1 overflow-auto",children:n.jsxs("div",{className:"bg-white rounded-lg border border-neutral-200",children:[n.jsxs("div",{className:"px-6 py-4 border-b border-neutral-200",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsx("h3",{className:"text-lg font-semibold text-neutral-900",children:""}),n.jsx("button",{onClick:e,className:"text-neutral-400 hover:text-neutral-600 transition-colors",children:n.jsx(Qe,{className:"w-5 h-5"})})]}),n.jsx("div",{className:"flex items-center justify-between",children:R.map((g,S)=>n.jsxs(br.Fragment,{children:[n.jsxs("div",{className:"flex flex-col items-center",children:[n.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center font-medium transition-colors ${r>=g.number?"bg-primary-600 text-white":"bg-neutral-200 text-neutral-600"}`,children:g.number}),n.jsx("span",{className:`text-xs mt-2 text-center ${r>=g.number?"text-primary-600 font-medium":"text-neutral-600"}`,children:g.title})]}),S<R.length-1&&n.jsx("div",{className:`flex-1 h-0.5 mx-2 transition-colors ${r>g.number?"bg-primary-600":"bg-neutral-200"}`})]},g.number))})]}),n.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[r===1&&z(),r===2&&ne(),r===3&&xe(),r===4&&O()]}),n.jsx("div",{className:"p-6 border-t border-neutral-200",children:n.jsxs("div",{className:"flex justify-between",children:[n.jsxs("button",{onClick:E,disabled:r===1,className:`px-6 py-2 rounded-lg transition-colors flex items-center ${r===1?"bg-neutral-100 text-neutral-400 cursor-not-allowed":"bg-neutral-100 hover:bg-neutral-200 text-neutral-700"}`,children:[n.jsx(pb,{className:"w-4 h-4 mr-1"}),""]}),n.jsxs("button",{onClick:K,className:"px-6 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors flex items-center",children:[r===4?"":"",r<4&&n.jsx(Kl,{className:"w-4 h-4 ml-1"})]})]})})]})})})},iT=[{id:"1",name:"",documentName:".pdf",documentType:"generated",status:"not_passed",totalCheckPoints:25,passedCheckPoints:22,failedCheckPoints:3,checkPointDetails:[{name:"",category:"",status:"passed",description:""},{name:"",category:"",status:"passed",description:""},{name:"",category:"",status:"passed",description:""},{name:"",category:"",status:"passed",description:""},{name:"",category:"",status:"passed",description:""},{name:"",category:"",status:"passed",description:""},{name:"ISO",category:"",status:"passed",description:""},{name:"",category:"",status:"passed",description:"2023"},{name:"",category:"",status:"passed",description:"3"},{name:"",category:"",status:"failed",description:""},{name:"",category:"",status:"passed",description:""},{name:"",category:"",status:"passed",description:""},{name:"",category:"",status:"passed",description:""},{name:"",category:"",status:"passed",description:""},{name:"",category:"",status:"passed",description:""},{name:"",category:"",status:"passed",description:""},{name:"",category:"",status:"passed",description:""},{name:"",category:"",status:"failed",description:"1"},{name:"",category:"",status:"passed",description:""},{name:"",category:"",status:"passed",description:""},{name:"",category:"",status:"passed",description:""},{name:"",category:"",status:"passed",description:""},{name:"",category:"",status:"passed",description:""},{name:"",category:"",status:"failed",description:""},{name:"",category:"",status:"passed",description:""}],createdAt:"2024-01-20 14:30:00",completedAt:"2024-01-20 14:35:00"},{id:"2",name:"",documentName:".pdf",documentType:"uploaded",status:"checking",totalCheckPoints:30,passedCheckPoints:0,failedCheckPoints:0,createdAt:"2024-01-18 10:15:00",completedAt:null},{id:"3",name:"",documentName:".pdf",documentType:"generated",status:"pending",totalCheckPoints:28,passedCheckPoints:0,failedCheckPoints:0,createdAt:"2024-01-15 09:00:00",completedAt:null},{id:"4",name:"",documentName:".pdf",documentType:"uploaded",status:"failed",totalCheckPoints:32,passedCheckPoints:0,failedCheckPoints:0,createdAt:"2024-01-12 16:20:00",completedAt:null},{id:"5",name:"",documentName:".pdf",documentType:"generated",status:"passed",totalCheckPoints:20,passedCheckPoints:20,failedCheckPoints:0,checkPointDetails:[{name:"",category:"",status:"passed",description:""},{name:"",category:"",status:"passed",description:""},{name:"",category:"",status:"passed",description:""},{name:"",category:"",status:"passed",description:""},{name:"",category:"",status:"passed",description:""},{name:"",category:"",status:"passed",description:""},{name:"",category:"",status:"passed",description:"2023"},{name:"",category:"",status:"passed",description:"2"},{name:"",category:"",status:"passed",description:""},{name:"",category:"",status:"passed",description:""},{name:"",category:"",status:"passed",description:""},{name:"",category:"",status:"passed",description:""},{name:"",category:"",status:"passed",description:""},{name:"",category:"",status:"passed",description:""},{name:"",category:"",status:"passed",description:"PMP"},{name:"",category:"",status:"passed",description:""},{name:"",category:"",status:"passed",description:""},{name:"",category:"",status:"passed",description:""},{name:"",category:"",status:"passed",description:""},{name:"",category:"",status:"passed",description:""}],createdAt:"2024-01-22 11:00:00",completedAt:"2024-01-22 11:05:00"}],lT=({canEdit:e=!0,canDelete:t=!0})=>{const[r,a]=M.useState(iT),[s,i]=M.useState(!1),[l,c]=M.useState(""),[o,u]=M.useState("all"),[d,f]=M.useState(1),[x,h]=M.useState(10),[p,m]=M.useState(""),[w,v]=M.useState("list"),[b,y]=M.useState(!1),[N,A]=M.useState(null),[k,_]=M.useState(!1),j=()=>{c(""),u("all"),f(1)},P=()=>{f(1)},D=()=>r.filter(g=>{const S=!l||g.name.toLowerCase().includes(l.toLowerCase()),F=o==="all"||g.status===o;return S&&F}).sort((g,S)=>new Date(S.createdAt).getTime()-new Date(g.createdAt).getTime()),K=()=>{const g=D(),S=(d-1)*x,F=S+x;return g.slice(S,F)},E=Math.ceil(D().length/x),Y=g=>({pending:{text:"",color:"bg-yellow-100 text-yellow-800"},checking:{text:"",color:"bg-blue-100 text-blue-800"},passed:{text:"",color:"bg-green-100 text-green-800"},not_passed:{text:"",color:"bg-orange-100 text-orange-800"},failed:{text:"",color:"bg-red-100 text-red-800"}})[g]||{text:g,color:"bg-gray-100 text-gray-800"},B=(g,S)=>{const ae=[{name:"",category:"",description:""},{name:"",category:"",description:""},{name:"",category:"",description:""},{name:"",category:"",description:""},{name:"",category:"",description:""},{name:"",category:"",description:""},{name:"ISO",category:"",description:""},{name:"",category:"",description:"2023"},{name:"",category:"",description:""},{name:"",category:"",description:""},{name:"",category:"",description:""},{name:"",category:"",description:""},{name:"",category:"",description:""},{name:"",category:"",description:""},{name:"",category:"",description:""},{name:"",category:"",description:""},{name:"",category:"",description:""},{name:"",category:"",description:""},{name:"",category:"",description:""},{name:"",category:"",description:""},{name:"",category:"",description:""},{name:"",category:"",description:""},{name:"",category:"",description:""},{name:"",category:"",description:""},{name:"",category:"",description:""}].slice(0,g),ue=new Set;for(;ue.size<S;){const ve=Math.floor(Math.random()*g);ue.add(ve)}return ae.map((ve,me)=>({...ve,status:ue.has(me)?"failed":"passed",description:ue.has(me)?ve.description.replace("","").replace("","").replace("","").replace("",""):ve.description}))},te=g=>{A(g),y(!0)},re=()=>{N&&a(r.filter(g=>g.id!==N.id)),y(!1),A(null)},Q=g=>{A(g),_(!0)},Z=g=>{v("create")},z=g=>{a(r.map(S=>S.id===g.id?{...S,status:"checking"}:S)),setTimeout(()=>{const S=Math.floor(Math.random()*5)+(g.totalCheckPoints-5),F=g.totalCheckPoints-S,ae=B(g.totalCheckPoints,F);a(r.map(ue=>ue.id===g.id?{...ue,status:F>0?"not_passed":"passed",passedCheckPoints:S,failedCheckPoints:F,checkPointDetails:ae,completedAt:new Date().toLocaleString("zh-CN")}:ue))},3e3)},ne=g=>{h(g),f(1)},xe=()=>{const g=parseInt(p);g>=1&&g<=E&&(f(g),m(""))},O=g=>{const S=g.failedCheckPoints||0,F=B(g.totalCheckPoints,S),ae={id:String(Date.now()),name:g.name,documentName:g.documentName,documentType:g.documentType,status:S>0?"not_passed":"passed",totalCheckPoints:g.totalCheckPoints,passedCheckPoints:g.passedCheckPoints||0,failedCheckPoints:S,checkPointDetails:F,createdAt:new Date().toLocaleString("zh-CN"),completedAt:new Date().toLocaleString("zh-CN")};a([ae,...r]),v("list")},R=g=>{const S=`

${g.name}
${g.documentName}
${g.documentType==="generated"?"":""}
${g.createdAt}
${g.completedAt}


${g.totalCheckPoints}
${g.passedCheckPoints}
${g.failedCheckPoints}
${(g.passedCheckPoints/g.totalCheckPoints*100).toFixed(2)}%


1.  [] - 
2.  [] - 
3.  [] - 
4.  [] - 
5.  [] - 

${new Date().toLocaleString("zh-CN")}
`,F=new Blob([S],{type:"text/plain;charset=utf-8"}),ae=URL.createObjectURL(F),ue=document.createElement("a");ue.href=ae,ue.download=`${g.name}_.txt`,document.body.appendChild(ue),ue.click(),document.body.removeChild(ue),URL.revokeObjectURL(ae)};return w==="create"?n.jsx(sT,{onClose:()=>v("list"),onComplete:O}):w==="checkpointManager"?n.jsx(eT,{onClose:()=>v("list")}):n.jsxs("div",{className:"flex flex-col h-full",children:[n.jsx("div",{className:"flex-1 overflow-auto",children:n.jsxs("div",{className:"bg-white rounded-lg border border-neutral-200",children:[n.jsxs("div",{className:"px-6 py-4 border-b border-neutral-200",children:[n.jsx("div",{className:"flex items-center justify-between mb-4",children:n.jsxs("div",{children:[n.jsxs("h2",{className:"text-lg font-medium text-neutral-900 flex items-center",children:[n.jsx(yb,{className:"w-5 h-5 mr-2 text-primary-600"}),""]}),n.jsx("p",{className:"text-sm text-neutral-500 mt-1",children:""})]})}),n.jsxs("div",{className:"flex items-center justify-between gap-3",children:[n.jsxs("div",{className:"flex items-center gap-3",children:["",n.jsx("input",{type:"text",placeholder:"",value:l,onChange:g=>c(g.target.value),className:"w-64 px-3 py-1.5 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500"}),"",n.jsxs("select",{value:o,onChange:g=>u(g.target.value),className:"w-32 px-3 py-1.5 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500",children:[n.jsx("option",{value:"all",children:""}),n.jsx("option",{value:"pending",children:""}),n.jsx("option",{value:"checking",children:""}),n.jsx("option",{value:"passed",children:""}),n.jsx("option",{value:"not_passed",children:""}),n.jsx("option",{value:"failed",children:""})]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{onClick:j,className:"px-4 py-1.5 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-50 transition-colors",children:""}),n.jsx("button",{onClick:P,className:"px-4 py-1.5 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors",children:""})]})]})]}),n.jsx("div",{className:"px-6 py-3 border-b border-neutral-200 flex items-center justify-between",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("button",{onClick:()=>v("create"),className:"px-4 py-1.5 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors flex items-center",children:[n.jsx(Pt,{className:"w-4 h-4 mr-1"}),""]}),n.jsxs("button",{onClick:()=>v("checkpointManager"),className:"px-4 py-1.5 text-sm bg-green-600 text-white rounded hover:bg-green-700 transition-colors flex items-center",children:[n.jsx(Dt,{className:"w-4 h-4 mr-1"}),""]})]})}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"w-full",children:[n.jsx("thead",{className:"bg-neutral-50 border-b border-neutral-200",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:"/"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""})]})}),n.jsx("tbody",{className:"divide-y divide-neutral-200",children:s?n.jsx("tr",{children:n.jsx("td",{colSpan:7,className:"px-4 py-8 text-center text-neutral-500",children:n.jsxs("div",{className:"flex items-center justify-center",children:[n.jsx(Tl,{className:"w-5 h-5 animate-spin mr-2"}),"..."]})})}):K().length===0?n.jsx("tr",{children:n.jsx("td",{colSpan:7,className:"px-4 py-8 text-center text-neutral-500",children:""})}):K().map((g,S)=>n.jsxs("tr",{className:"hover:bg-neutral-50 transition-colors",children:[n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm text-neutral-900",children:(d-1)*x+S+1}),n.jsx("td",{className:"px-4 py-2.5 text-sm text-neutral-900",children:n.jsx("div",{className:"max-w-xs truncate",title:g.name,children:g.name})}),n.jsx("td",{className:"px-4 py-2.5 text-sm text-neutral-900",children:n.jsx("div",{className:"max-w-xs truncate",title:g.documentName,children:g.documentName})}),n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm",children:g.status==="passed"||g.status==="not_passed"?n.jsxs("span",{children:[n.jsx("span",{className:"text-green-600 font-medium",children:g.passedCheckPoints}),n.jsx("span",{className:"text-neutral-400 mx-1",children:"/"}),n.jsx("span",{className:"text-red-600 font-medium",children:g.failedCheckPoints})]}):n.jsx("span",{className:"text-neutral-400",children:"-"})}),n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded text-xs font-medium ${Y(g.status).color}`,children:Y(g.status).text}),g.status==="checking"&&g.progress!==void 0&&n.jsxs("span",{className:"text-xs text-blue-600 font-medium",children:[g.progress,"%"]})]})}),n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm text-neutral-900",children:g.createdAt}),n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm",children:n.jsxs("div",{className:"flex items-center space-x-2",children:[g.status==="pending"&&n.jsxs("button",{onClick:()=>Z(),className:"px-2 py-1 text-xs text-primary-600 hover:text-primary-800 hover:bg-primary-50 rounded transition-colors flex items-center gap-1",children:[n.jsx(Dt,{className:"w-3.5 h-3.5"}),""]}),(g.status==="passed"||g.status==="not_passed")&&n.jsxs(n.Fragment,{children:[n.jsxs("button",{onClick:()=>Q(g),className:"px-2 py-1 text-xs text-blue-600 hover:text-blue-800 hover:bg-blue-50 rounded transition-colors flex items-center gap-1",children:[n.jsx(y1,{className:"w-3.5 h-3.5"}),""]}),n.jsxs("button",{onClick:()=>R(g),className:"px-2 py-1 text-xs text-green-600 hover:text-green-800 hover:bg-green-50 rounded transition-colors flex items-center gap-1",children:[n.jsx(js,{className:"w-3.5 h-3.5"}),""]})]}),g.status==="failed"&&n.jsxs("button",{onClick:()=>z(g),className:"px-2 py-1 text-xs text-orange-600 hover:text-orange-800 hover:bg-orange-50 rounded transition-colors flex items-center gap-1",children:[n.jsx(Tl,{className:"w-3.5 h-3.5"}),""]}),n.jsxs("button",{onClick:()=>te(g),className:"px-2 py-1 text-xs text-red-600 hover:text-red-800 hover:bg-red-50 rounded transition-colors flex items-center gap-1",children:[n.jsx(qe,{className:"w-3.5 h-3.5"}),""]})]})})]},g.id))})]})})]})}),n.jsxs("div",{className:"bg-white border-t border-neutral-200 px-6 py-3 flex items-center justify-center gap-6",children:[n.jsxs("div",{className:"text-sm text-neutral-700",children:[" ",D().length," "]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("button",{onClick:()=>f(Math.max(1,d-1)),disabled:d===1,className:`px-2 py-1 text-sm rounded transition-colors ${d===1?"bg-neutral-100 text-neutral-400 cursor-not-allowed":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:"<"}),n.jsx("div",{className:"flex items-center space-x-1",children:Array.from({length:Math.min(10,E)},(g,S)=>{let F;return E<=10||d<=5?F=S+1:d>=E-4?F=E-9+S:F=d-4+S,n.jsx("button",{onClick:()=>f(F),className:`px-2.5 py-1 text-sm rounded transition-colors ${d===F?"bg-primary-600 text-white":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:F},F)})}),n.jsx("button",{onClick:()=>f(Math.min(E,d+1)),disabled:d===E,className:`px-2 py-1 text-sm rounded transition-colors ${d===E?"bg-neutral-100 text-neutral-400 cursor-not-allowed":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:">"})]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsxs("select",{value:x,onChange:g=>ne(Number(g.target.value)),className:"px-2 py-1 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500",children:[n.jsx("option",{value:10,children:"10/"}),n.jsx("option",{value:20,children:"20/"}),n.jsx("option",{value:50,children:"50/"})]}),n.jsx("span",{className:"text-sm text-neutral-700",children:""}),n.jsx("input",{type:"number",value:p,onChange:g=>m(g.target.value),placeholder:"",className:"w-12 px-2 py-1 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500",min:1,max:E}),n.jsx("button",{onClick:xe,className:"px-3 py-1 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-50 transition-colors",children:""})]})]}),b&&N&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:n.jsx("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full mx-4",children:n.jsxs("div",{className:"p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h3",{className:"text-lg font-semibold text-neutral-900",children:""}),n.jsx("button",{onClick:()=>y(!1),className:"text-neutral-400 hover:text-neutral-600 transition-colors",children:n.jsx(Qe,{className:"w-5 h-5"})})]}),n.jsxs("div",{className:"mb-6",children:[n.jsxs("p",{className:"text-neutral-700",children:[" ",n.jsxs("span",{className:"font-semibold",children:['"',N.name,'"']})," "]}),n.jsx("p",{className:"text-sm text-neutral-500 mt-2",children:""})]}),n.jsxs("div",{className:"flex space-x-3",children:[n.jsx("button",{onClick:()=>y(!1),className:"flex-1 bg-neutral-100 hover:bg-neutral-200 text-neutral-700 py-2 rounded-lg transition-colors",children:""}),n.jsx("button",{onClick:re,className:"flex-1 bg-red-600 hover:bg-red-700 text-white py-2 rounded-lg transition-colors",children:""})]})]})})}),k&&N&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:n.jsx("div",{className:"bg-white rounded-xl shadow-xl max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:n.jsxs("div",{className:"p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h3",{className:"text-lg font-semibold text-neutral-900",children:""}),n.jsx("button",{onClick:()=>_(!1),className:"text-neutral-400 hover:text-neutral-600 transition-colors",children:n.jsx(Qe,{className:"w-5 h-5"})})]}),n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"bg-neutral-50 rounded-lg p-4",children:[n.jsx("h4",{className:"font-medium text-neutral-900 mb-3",children:""}),n.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[n.jsxs("div",{children:[n.jsx("span",{className:"text-neutral-600",children:""}),n.jsx("p",{className:"font-medium text-neutral-900 mt-1",children:N.name})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-neutral-600",children:""}),n.jsx("p",{className:"font-medium text-neutral-900 mt-1",children:N.documentName})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-neutral-600",children:""}),n.jsx("p",{className:"font-medium text-neutral-900 mt-1",children:N.documentType==="generated"?"":""})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-neutral-600",children:""}),n.jsx("p",{className:"font-medium text-neutral-900 mt-1",children:N.createdAt})]})]})]}),n.jsxs("div",{className:"bg-green-50 rounded-lg p-4",children:[n.jsx("h4",{className:"font-medium text-green-900 mb-3",children:""}),n.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-2xl font-bold text-green-600",children:N.totalCheckPoints}),n.jsx("p",{className:"text-xs text-neutral-600 mt-1",children:""})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-2xl font-bold text-green-600",children:N.passedCheckPoints}),n.jsx("p",{className:"text-xs text-neutral-600 mt-1",children:""})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-2xl font-bold text-red-600",children:N.failedCheckPoints}),n.jsx("p",{className:"text-xs text-neutral-600 mt-1",children:""})]})]})]}),n.jsxs("div",{children:[n.jsx("h4",{className:"font-medium text-neutral-900 mb-3",children:""}),!N.checkPointDetails||N.checkPointDetails.length===0?n.jsxs("div",{className:"text-center py-8 text-neutral-500",children:[n.jsx(Cl,{className:"w-12 h-12 mx-auto mb-2 text-neutral-400"}),n.jsx("p",{children:""})]}):n.jsx("div",{className:"space-y-2",children:N.checkPointDetails.map((g,S)=>n.jsx("div",{className:`p-3 rounded-lg border-l-4 ${g.status==="passed"?"bg-green-50 border-green-500":"bg-red-50 border-red-500"}`,children:n.jsxs("div",{className:"flex items-start justify-between",children:[n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[g.status==="passed"?n.jsx(aa,{className:"w-4 h-4 text-green-600"}):n.jsx(Cl,{className:"w-4 h-4 text-red-600"}),n.jsx("span",{className:"font-medium text-neutral-900",children:g.name}),n.jsx("span",{className:"text-xs px-2 py-0.5 rounded bg-neutral-200 text-neutral-700",children:g.category})]}),n.jsx("p",{className:"text-sm text-neutral-600 ml-6",children:g.description})]}),n.jsx("span",{className:`text-xs font-medium px-2 py-1 rounded ${g.status==="passed"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:g.status==="passed"?"":""})]})},S))})]})]}),n.jsxs("div",{className:"flex justify-between mt-6 pt-4 border-t border-neutral-200",children:[n.jsxs("button",{onClick:()=>R(N),className:"px-6 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg transition-colors flex items-center gap-2",children:[n.jsx(js,{className:"w-4 h-4"}),""]}),n.jsx("button",{onClick:()=>_(!1),className:"px-6 py-2 bg-neutral-100 hover:bg-neutral-200 text-neutral-700 rounded-lg transition-colors",children:""})]})]})})})]})},cT=({format:e,onUpdate:t})=>{const[r,a]=br.useState(!1),[s,i]=br.useState(null),[l,c]=br.useState(null),[o,u]=br.useState(null),[d,f]=br.useState([{id:1,name:"",type:"",size:"2.1KB",date:"2024-01-15"},{id:2,name:"",type:"",size:"1.8KB",date:"2024-01-10"},{id:3,name:"",type:"",size:"2.3KB",date:"2024-01-08"}]),x=(A,k)=>{t({...e,[A]:k})},h=A=>{const k=d.find(_=>_.id===A);k&&c(k)},p=()=>{if(l){let A;switch(l.type){case"":A={fontSize:16,fontFamily:"SimSun",lineHeight:1.5,margin:25,alignment:"left"};break;case"":A={fontSize:14,fontFamily:"SimHei",lineHeight:1.4,margin:20,alignment:"justify"};break;case"":A={fontSize:15,fontFamily:"Microsoft YaHei",lineHeight:1.6,margin:30,alignment:"left"};break;default:A={fontSize:14,fontFamily:"SimSun",lineHeight:1.5,margin:25,alignment:"left"}}t(A),c(null)}},m=A=>{const k=d.find(_=>_.id===A);k&&i(k)},w=A=>{const k=d.find(_=>_.id===A);k&&u(k)},v=()=>{o&&(f(d.filter(A=>A.id!==o.id)),u(null))},b=A=>{var _;const k=(_=A.target.files)==null?void 0:_[0];if(k){const j={id:Date.now(),name:k.name.replace(".json",""),type:"",size:`${(k.size/1024).toFixed(1)}KB`,date:new Date().toISOString().split("T")[0]};f([...d,j]),a(!1)}},y=()=>{const A=JSON.stringify(e,null,2),k=new Blob([A],{type:"application/json"}),_=URL.createObjectURL(k),j=document.createElement("a");j.href=_,j.download=`format-template-${Date.now()}.json`,document.body.appendChild(j),j.click(),document.body.removeChild(j),URL.revokeObjectURL(_)},N=[{label:" (SimSun)",value:"SimSun"},{label:" (SimHei)",value:"SimHei"},{label:" (Microsoft YaHei)",value:"Microsoft YaHei"},{label:" (FangSong)",value:"FangSong"},{label:" (KaiTi)",value:"KaiTi"}];return n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[n.jsxs("div",{className:"mb-6",children:[n.jsxs("h2",{className:"text-2xl font-bold text-gray-900 flex items-center",children:[n.jsx(Gu,{className:"w-7 h-7 mr-3 text-purple-600"}),""]}),n.jsx("p",{className:"text-gray-600 mt-1",children:""})]}),n.jsxs("div",{className:"bg-gradient-to-r from-indigo-50 to-purple-50 rounded-lg p-6 mb-8",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[n.jsx(go,{className:"w-5 h-5 mr-2 text-indigo-600"}),""]}),n.jsxs("div",{className:"flex space-x-2",children:[n.jsxs("button",{onClick:()=>a(!0),className:"bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-lg flex items-center space-x-2 transition-colors",children:[n.jsx(St,{className:"w-4 h-4"}),n.jsx("span",{children:""})]}),n.jsxs("button",{onClick:y,className:"bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-lg flex items-center space-x-2 transition-colors",children:[n.jsx(js,{className:"w-4 h-4"}),n.jsx("span",{children:""})]})]})]}),n.jsx("div",{className:"bg-white rounded-lg overflow-hidden",children:n.jsxs("table",{className:"w-full",children:[n.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""})]})}),n.jsx("tbody",{className:"divide-y divide-gray-200",children:d.map(A=>n.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm font-medium text-gray-900",children:A.name}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-500",children:n.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:A.type})}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-500",children:A.size}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-500",children:A.date}),n.jsxs("td",{className:"px-4 py-3 whitespace-nowrap text-sm font-medium space-x-2",children:[n.jsx("button",{onClick:()=>h(A.id),className:"text-indigo-600 hover:text-indigo-900 transition-colors",children:""}),n.jsx("button",{onClick:()=>m(A.id),className:"text-green-600 hover:text-green-900 transition-colors",children:""}),n.jsx("button",{onClick:()=>w(A.id),className:"text-red-600 hover:text-red-900 transition-colors",children:""})]})]},A.id))})]})})]}),n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 rounded-lg p-6",children:[n.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[n.jsx(Fb,{className:"w-5 h-5 mr-2 text-blue-600"}),""]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),n.jsx("select",{value:e.fontFamily,onChange:A=>x("fontFamily",A.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:N.map(A=>n.jsx("option",{value:A.value,children:A.label},A.value))})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[": ",e.fontSize,"px"]}),n.jsx("input",{type:"range",min:"12",max:"24",value:e.fontSize,onChange:A=>x("fontSize",parseInt(A.target.value)),className:"w-full"}),n.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[n.jsx("span",{children:"12px"}),n.jsx("span",{children:"24px"})]})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[": ",e.lineHeight]}),n.jsx("input",{type:"range",min:"1",max:"3",step:"0.1",value:e.lineHeight,onChange:A=>x("lineHeight",parseFloat(A.target.value)),className:"w-full"}),n.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[n.jsx("span",{children:"1.0"}),n.jsx("span",{children:"3.0"})]})]})]})]}),n.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-emerald-50 rounded-lg p-6",children:[n.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[n.jsx(Eb,{className:"w-5 h-5 mr-2 text-green-600"}),""]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),n.jsxs("select",{value:e.alignment,onChange:A=>x("alignment",A.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-500 focus:border-green-500",children:[n.jsx("option",{value:"left",children:""}),n.jsx("option",{value:"center",children:""}),n.jsx("option",{value:"right",children:""}),n.jsx("option",{value:"justify",children:""})]})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[": ",e.margin,"mm"]}),n.jsx("input",{type:"range",min:"15",max:"40",value:e.margin,onChange:A=>x("margin",parseInt(A.target.value)),className:"w-full"}),n.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[n.jsx("span",{children:"15mm"}),n.jsx("span",{children:"40mm"})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),n.jsxs("select",{className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-500 focus:border-green-500",children:[n.jsx("option",{children:"A4"}),n.jsx("option",{children:"A3"}),n.jsx("option",{children:"B4"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),n.jsxs("select",{className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-500 focus:border-green-500",children:[n.jsx("option",{children:""}),n.jsx("option",{children:""})]})]})]})]})]})]}),n.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-pink-50 rounded-lg p-6",children:[n.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[n.jsx(Lt,{className:"w-5 h-5 mr-2 text-purple-600"}),""]}),n.jsx("div",{className:"bg-white rounded-lg p-6 shadow-inner border-2 border-dashed border-gray-300 min-h-80",children:n.jsxs("div",{style:{fontSize:`${e.fontSize}px`,fontFamily:e.fontFamily,lineHeight:e.lineHeight,textAlign:e.alignment,margin:`${e.margin}px`},className:"space-y-4",children:[n.jsx("h1",{className:"text-xl font-bold text-gray-900",children:""}),n.jsx("p",{className:"text-gray-700",children:" "}),n.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:""}),n.jsx("p",{className:"text-gray-700",children:" "}),n.jsxs("ul",{className:"list-disc ml-6 space-y-1",children:[n.jsx("li",{children:""}),n.jsx("li",{children:""}),n.jsx("li",{children:""})]})]})}),n.jsxs("div",{className:"mt-6 space-y-3",children:[n.jsx("button",{onClick:()=>{alert("")},className:"w-full bg-purple-600 hover:bg-purple-700 text-white py-2 rounded-lg transition-colors",children:""}),n.jsx("button",{onClick:y,className:"w-full bg-gray-100 hover:bg-gray-200 text-gray-700 py-2 rounded-lg transition-colors",children:""}),n.jsx("button",{onClick:()=>a(!0),className:"w-full bg-orange-100 hover:bg-orange-200 text-orange-700 py-2 rounded-lg transition-colors",children:""})]})]})]}),n.jsxs("div",{className:"mt-8 bg-gray-50 rounded-lg p-6",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:""}),n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[{name:"",desc:"",format:{fontSize:16,fontFamily:"SimSun",lineHeight:1.5,margin:25,alignment:"left"}},{name:"",desc:"",format:{fontSize:14,fontFamily:"Microsoft YaHei",lineHeight:1.4,margin:20,alignment:"left"}},{name:"",desc:"",format:{fontSize:15,fontFamily:"SimHei",lineHeight:1.6,margin:30,alignment:"justify"}}].map((A,k)=>n.jsxs("div",{className:"bg-white rounded-lg p-4 border border-gray-200 hover:border-blue-300 transition-colors cursor-pointer",children:[n.jsx("h4",{className:"font-medium text-gray-900 mb-1",children:A.name}),n.jsx("p",{className:"text-sm text-gray-600 mb-3",children:A.desc}),n.jsx("button",{onClick:()=>t(A.format),className:"text-sm bg-blue-100 text-blue-700 px-3 py-1 rounded-full hover:bg-blue-200 transition-colors",children:""})]},k))})]})]}),r&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:n.jsx("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full mx-4",children:n.jsxs("div",{className:"p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:""}),n.jsx("button",{onClick:()=>a(!1),className:"text-gray-400 hover:text-gray-600 transition-colors",children:n.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),n.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center",children:[n.jsx(St,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),n.jsx("p",{className:"text-gray-600 mb-4",children:""}),n.jsx("p",{className:"text-sm text-gray-500 mb-4",children:" JSON "}),n.jsx("input",{type:"file",accept:".json",onChange:b,className:"hidden",id:"template-upload"}),n.jsx("label",{htmlFor:"template-upload",className:"bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-lg cursor-pointer transition-colors inline-block",children:""})]}),n.jsxs("div",{className:"mt-4 text-xs text-gray-500",children:[n.jsx("p",{children:" "}),n.jsx("p",{children:" "}),n.jsx("p",{children:" "})]})]})})}),s&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:n.jsx("div",{className:"bg-white rounded-xl shadow-xl max-w-lg w-full mx-4",children:n.jsxs("div",{className:"p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:""}),n.jsx("button",{onClick:()=>i(null),className:"text-gray-400 hover:text-gray-600 transition-colors",children:n.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[n.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:s.name}),n.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[n.jsxs("div",{children:[n.jsx("span",{className:"text-gray-600",children:":"}),n.jsx("span",{className:"ml-2 font-medium",children:s.type})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-gray-600",children:":"}),n.jsx("span",{className:"ml-2 font-medium",children:s.size})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-gray-600",children:":"}),n.jsx("span",{className:"ml-2 font-medium",children:s.date})]})]})]}),n.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[n.jsx("h5",{className:"font-medium text-blue-900 mb-2",children:""}),n.jsxs("div",{className:"text-sm text-blue-800 space-y-1",children:[s.type===""&&n.jsxs(n.Fragment,{children:[n.jsx("p",{children:" :  16px"}),n.jsx("p",{children:" : 1.5"}),n.jsx("p",{children:" : 25mm"}),n.jsx("p",{children:" : "})]}),s.type===""&&n.jsxs(n.Fragment,{children:[n.jsx("p",{children:" :  14px"}),n.jsx("p",{children:" : 1.4"}),n.jsx("p",{children:" : 20mm"}),n.jsx("p",{children:" : "})]}),s.type===""&&n.jsxs(n.Fragment,{children:[n.jsx("p",{children:" :  15px"}),n.jsx("p",{children:" : 1.6"}),n.jsx("p",{children:" : 30mm"}),n.jsx("p",{children:" : "})]})]})]}),n.jsxs("div",{className:"flex space-x-3",children:[n.jsx("button",{onClick:()=>{h(s.id),i(null)},className:"flex-1 bg-blue-600 hover:bg-blue-700 text-white py-2 rounded-lg transition-colors",children:""}),n.jsx("button",{onClick:()=>i(null),className:"flex-1 bg-gray-100 hover:bg-gray-200 text-gray-700 py-2 rounded-lg transition-colors",children:""})]})]})]})})}),l&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:n.jsx("div",{className:"bg-white rounded-xl shadow-xl max-w-lg w-full mx-4",children:n.jsxs("div",{className:"p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:""}),n.jsx("button",{onClick:()=>c(null),className:"text-gray-400 hover:text-gray-600 transition-colors",children:n.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[n.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:l.name}),n.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[n.jsxs("div",{children:[n.jsx("span",{className:"text-gray-600",children:":"}),n.jsx("span",{className:"ml-2 font-medium",children:l.type})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-gray-600",children:":"}),n.jsx("span",{className:"ml-2 font-medium",children:l.size})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-gray-600",children:":"}),n.jsx("span",{className:"ml-2 font-medium",children:l.date})]})]})]}),n.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[n.jsx("h5",{className:"font-medium text-blue-900 mb-2",children:""}),n.jsxs("div",{className:"text-sm text-blue-800 space-y-1",children:[l.type===""&&n.jsxs(n.Fragment,{children:[n.jsx("p",{children:" :  16px"}),n.jsx("p",{children:" : 1.5"}),n.jsx("p",{children:" : 25mm"}),n.jsx("p",{children:" : "})]}),l.type===""&&n.jsxs(n.Fragment,{children:[n.jsx("p",{children:" :  14px"}),n.jsx("p",{children:" : 1.4"}),n.jsx("p",{children:" : 20mm"}),n.jsx("p",{children:" : "})]}),l.type===""&&n.jsxs(n.Fragment,{children:[n.jsx("p",{children:" :  15px"}),n.jsx("p",{children:" : 1.6"}),n.jsx("p",{children:" : 30mm"}),n.jsx("p",{children:" : "})]})]})]}),n.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-4",children:n.jsxs("div",{className:"flex items-start space-x-3",children:[n.jsx("svg",{className:"w-5 h-5 text-amber-600 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})}),n.jsxs("div",{className:"text-sm text-amber-800",children:[n.jsx("p",{className:"font-medium mb-1",children:""}),n.jsx("p",{children:""})]})]})}),n.jsxs("div",{className:"flex space-x-3",children:[n.jsx("button",{onClick:p,className:"flex-1 bg-blue-600 hover:bg-blue-700 text-white py-2 rounded-lg transition-colors",children:""}),n.jsx("button",{onClick:()=>c(null),className:"flex-1 bg-gray-100 hover:bg-gray-200 text-gray-700 py-2 rounded-lg transition-colors",children:""})]})]})]})})}),o&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:n.jsx("div",{className:"bg-white rounded-xl shadow-xl max-w-lg w-full mx-4",children:n.jsxs("div",{className:"p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:""}),n.jsx("button",{onClick:()=>u(null),className:"text-gray-400 hover:text-gray-600 transition-colors",children:n.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[n.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:o.name}),n.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[n.jsxs("div",{children:[n.jsx("span",{className:"text-gray-600",children:":"}),n.jsx("span",{className:"ml-2 font-medium",children:o.type})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-gray-600",children:":"}),n.jsx("span",{className:"ml-2 font-medium",children:o.size})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-gray-600",children:":"}),n.jsx("span",{className:"ml-2 font-medium",children:o.date})]})]})]}),n.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:n.jsxs("div",{className:"flex items-start space-x-3",children:[n.jsx("svg",{className:"w-5 h-5 text-red-600 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})}),n.jsxs("div",{className:"text-sm text-red-800",children:[n.jsx("p",{className:"font-medium mb-1",children:""}),n.jsx("p",{children:""})]})]})}),n.jsxs("div",{className:"flex space-x-3",children:[n.jsx("button",{onClick:v,className:"flex-1 bg-red-600 hover:bg-red-700 text-white py-2 rounded-lg transition-colors",children:""}),n.jsx("button",{onClick:()=>u(null),className:"flex-1 bg-gray-100 hover:bg-gray-200 text-gray-700 py-2 rounded-lg transition-colors",children:""})]})]})]})})})]})},oT=[{id:"1",username:"",phone:"13800138000",role:"",enabled:!0,created_at:"2024-01-01 00:00:00"},{id:"2",username:"",phone:"13800138001",role:"",enabled:!0,created_at:"2024-01-01 00:00:00"},{id:"3",username:"",phone:"13800138002",role:"",enabled:!0,created_at:"2024-01-01 00:00:00"},{id:"4",username:"",phone:"13800138003",role:"",enabled:!0,created_at:"2024-01-01 00:00:00"},{id:"5",username:"",phone:"13800138004",role:"",enabled:!0,created_at:"2024-01-01 00:00:00"}],dT=({canEdit:e=!0,canDelete:t=!0,viewOwnOnly:r=!1,currentUser:a,dataScope:s})=>{const[i,l]=M.useState(oT),[c,o]=M.useState(!1),[u,d]=M.useState(""),[f,x]=M.useState(""),[h,p]=M.useState("all"),[m,w]=M.useState(1),[v,b]=M.useState(10),[y,N]=M.useState(""),[A,k]=M.useState("list"),[_,j]=M.useState(!1),[P,D]=M.useState(!1),[K,E]=M.useState(null),[Y,B]=M.useState({username:"",phone:"",role:"",password:"toubiao@123",enabled:!0}),te=()=>{d(""),x(""),p("all"),w(1)},re=()=>{w(1)},Q=()=>{let T=i;return r&&a&&(T=i.filter(je=>je.username===a.username)),T.filter(je=>{var he;const pe=!u||je.username.toLowerCase().includes(u.toLowerCase()),Le=!f||((he=je.phone)==null?void 0:he.includes(f)),Se=h==="all"||h==="enabled"&&je.enabled||h==="disabled"&&!je.enabled;return pe&&Le&&Se}).sort((je,pe)=>new Date(pe.created_at).getTime()-new Date(je.created_at).getTime())},Z=()=>{const T=Q(),je=(m-1)*v,pe=je+v;return T.slice(je,pe)},z=Math.ceil(Q().length/v),ne=()=>{B({username:"",phone:"",role:"",password:"toubiao@123",enabled:!0}),k("add")},xe=T=>{E(T),B({username:T.username,phone:T.phone,role:T.role,password:"toubiao@123",enabled:T.enabled}),k("edit")},O=T=>{E(T),j(!0)},R=T=>{E(T),D(!0)},g=T=>/^1[3-9]\d{9}$/.test(T),S=async()=>{if(!g(Y.phone)){alert("111");return}const T={id:String(i.length+1),username:Y.username,phone:Y.phone,role:Y.role,enabled:Y.enabled,created_at:new Date().toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}).replace(/\//g,"-")};l([...i,T]),k("list")},F=async()=>{K&&l(i.map(T=>T.id===K.id?{...T,username:Y.username,role:Y.role,enabled:Y.enabled}:T)),k("list")},ae=async()=>{K&&l(i.filter(T=>T.id!==K.id)),j(!1)},ue=T=>{l(i.map(je=>je.id===T.id?{...je,enabled:!je.enabled}:je))},ve=T=>{b(T),w(1)},me=()=>{const T=parseInt(y);T>=1&&T<=z&&(w(T),N(""))},H=()=>{const T=A==="edit",je=T?"":"";return n.jsx("div",{className:"flex flex-col h-full",children:n.jsx("div",{className:"flex-1 overflow-auto",children:n.jsxs("div",{className:"bg-white rounded-lg border border-neutral-200",children:[n.jsxs("div",{className:"px-6 py-4 border-b border-neutral-200 flex items-center justify-between",children:[n.jsx("h3",{className:"text-lg font-semibold text-neutral-900",children:je}),n.jsx("button",{onClick:()=>k("list"),className:"text-neutral-400 hover:text-neutral-600 transition-colors",children:n.jsx(Qe,{className:"w-5 h-5"})})]}),n.jsxs("div",{className:"p-6 space-y-6 max-w-2xl mx-auto",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:Y.username,onChange:pe=>B({...Y,username:pe.target.value}),placeholder:"",className:"w-full px-4 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"tel",value:Y.phone,onChange:pe=>B({...Y,phone:pe.target.value}),placeholder:"11",disabled:T,className:"w-full px-4 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 disabled:bg-neutral-50 disabled:cursor-not-allowed"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsxs("select",{value:Y.role,onChange:pe=>B({...Y,role:pe.target.value}),className:"w-full px-4 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[n.jsx("option",{value:"",children:" - "}),n.jsx("option",{value:"",children:" - "}),n.jsx("option",{value:"",children:" - "})]})]}),!T&&n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:""}),n.jsx("input",{type:"text",value:Y.password,disabled:!0,className:"w-full px-4 py-2 border border-neutral-300 rounded-lg bg-neutral-50 cursor-not-allowed text-neutral-500"}),n.jsx("p",{className:"text-xs text-neutral-500 mt-1",children:" toubiao@123"})]}),n.jsxs("div",{className:"flex items-center",children:[n.jsx("input",{type:"checkbox",id:"enabled",checked:Y.enabled,onChange:pe=>B({...Y,enabled:pe.target.checked}),className:"w-4 h-4 text-primary-600 rounded focus:ring-primary-500"}),n.jsx("label",{htmlFor:"enabled",className:"ml-2 text-sm text-neutral-700",children:""})]})]}),n.jsxs("div",{className:"px-6 py-4 border-t border-neutral-200 flex items-center justify-end gap-3",children:[n.jsx("button",{onClick:()=>k("list"),className:"px-6 py-2 border border-neutral-300 text-neutral-700 rounded-lg hover:bg-neutral-50 transition-colors",children:""}),n.jsx("button",{onClick:T?F:S,className:"px-6 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors",children:T?"":""})]})]})})})};return A==="add"||A==="edit"?H():n.jsxs("div",{className:"flex flex-col h-full",children:[n.jsx("div",{className:"flex-1 overflow-auto",children:n.jsxs("div",{className:"bg-white rounded-lg border border-neutral-200",children:[n.jsxs("div",{className:"px-6 py-4 border-b border-neutral-200",children:[n.jsx("div",{className:"flex items-center justify-between mb-4",children:n.jsx("h2",{className:"text-lg font-medium text-neutral-900",children:""})}),n.jsxs("div",{className:"flex items-center justify-between gap-3",children:[n.jsxs("div",{className:"flex items-center gap-3",children:["",n.jsx("input",{type:"text",placeholder:"",value:u,onChange:T=>d(T.target.value),className:"w-48 px-3 py-1.5 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500"}),"",n.jsx("input",{type:"text",placeholder:"",value:f,onChange:T=>x(T.target.value),className:"w-48 px-3 py-1.5 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500"}),"",n.jsxs("select",{value:h,onChange:T=>p(T.target.value),className:"w-32 px-3 py-1.5 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500",children:[n.jsx("option",{value:"all",children:""}),n.jsx("option",{value:"enabled",children:""}),n.jsx("option",{value:"disabled",children:""})]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{onClick:te,className:"px-4 py-1.5 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-50 transition-colors",children:""}),n.jsx("button",{onClick:re,className:"px-4 py-1.5 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors",children:""})]})]})]}),n.jsx("div",{className:"px-6 py-3 border-b border-neutral-200",children:n.jsxs("button",{onClick:ne,className:"px-4 py-1.5 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors flex items-center",children:[n.jsx(Pt,{className:"w-4 h-4 mr-1"}),""]})}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"w-full",children:[n.jsx("thead",{className:"bg-neutral-50 border-b border-neutral-200",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""})]})}),n.jsx("tbody",{className:"divide-y divide-neutral-200",children:c?n.jsx("tr",{children:n.jsx("td",{colSpan:7,className:"px-4 py-8 text-center text-neutral-500",children:n.jsxs("div",{className:"flex items-center justify-center",children:[n.jsx(Tl,{className:"w-5 h-5 animate-spin mr-2"}),"..."]})})}):Z().length===0?n.jsx("tr",{children:n.jsx("td",{colSpan:7,className:"px-4 py-8 text-center text-neutral-500",children:""})}):Z().map((T,je)=>n.jsxs("tr",{className:"hover:bg-neutral-50 transition-colors",children:[n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm text-neutral-900",children:(m-1)*v+je+1}),n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap",children:n.jsx("div",{className:"text-sm font-medium text-neutral-900",children:T.username})}),n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm text-neutral-900",children:T.phone}),n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm text-neutral-900",children:T.role}),n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap",children:n.jsxs("button",{onClick:()=>ue(T),className:`inline-flex items-center px-3 py-1 rounded-full text-xs font-medium transition-all duration-200 ${T.enabled?"bg-green-100 text-green-800 hover:bg-green-200":"bg-red-100 text-red-800 hover:bg-red-200"}`,children:[n.jsx("span",{className:`w-1.5 h-1.5 rounded-full mr-1.5 ${T.enabled?"bg-green-500":"bg-red-500"}`}),T.enabled?"":""]})}),n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm text-neutral-900",children:T.created_at}),n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm",children:n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsxs("button",{onClick:()=>xe(T),className:"px-2 py-1 text-xs text-primary-600 hover:text-primary-800 hover:bg-primary-50 rounded transition-colors flex items-center gap-1",children:[n.jsx(Dt,{className:"w-3.5 h-3.5"}),""]}),n.jsxs("button",{onClick:()=>R(T),className:"px-2 py-1 text-xs text-orange-600 hover:text-orange-800 hover:bg-orange-50 rounded transition-colors flex items-center gap-1",children:[n.jsx(Cb,{className:"w-3.5 h-3.5"}),""]}),n.jsxs("button",{onClick:()=>O(T),className:"px-2 py-1 text-xs text-red-600 hover:text-red-800 hover:bg-red-50 rounded transition-colors flex items-center gap-1",children:[n.jsx(qe,{className:"w-3.5 h-3.5"}),""]})]})})]},T.id))})]})})]})}),n.jsxs("div",{className:"bg-white border-t border-neutral-200 px-6 py-3 flex items-center justify-center gap-6",children:[n.jsxs("div",{className:"text-sm text-neutral-700",children:[" ",Q().length," "]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("button",{onClick:()=>w(Math.max(1,m-1)),disabled:m===1,className:`px-2 py-1 text-sm rounded transition-colors ${m===1?"bg-neutral-100 text-neutral-400 cursor-not-allowed":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:"<"}),n.jsx("div",{className:"flex items-center space-x-1",children:Array.from({length:Math.min(10,z)},(T,je)=>{let pe;return z<=10||m<=5?pe=je+1:m>=z-4?pe=z-9+je:pe=m-4+je,n.jsx("button",{onClick:()=>w(pe),className:`px-2.5 py-1 text-sm rounded transition-colors ${m===pe?"bg-primary-600 text-white":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:pe},pe)})}),z>10&&n.jsxs(n.Fragment,{children:[n.jsx("span",{className:"text-neutral-500",children:"..."}),n.jsx("button",{onClick:()=>w(z),className:`px-2.5 py-1 text-sm rounded transition-colors ${m===z?"bg-primary-600 text-white":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:z})]}),n.jsx("button",{onClick:()=>w(Math.min(z,m+1)),disabled:m===z,className:`px-2 py-1 text-sm rounded transition-colors ${m===z?"bg-neutral-100 text-neutral-400 cursor-not-allowed":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:">"})]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsxs("select",{value:v,onChange:T=>ve(Number(T.target.value)),className:"px-2 py-1 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500",children:[n.jsx("option",{value:10,children:"10/"}),n.jsx("option",{value:20,children:"20/"}),n.jsx("option",{value:50,children:"50/"})]}),n.jsx("span",{className:"text-sm text-neutral-700",children:""}),n.jsx("input",{type:"number",value:y,onChange:T=>N(T.target.value),placeholder:"",className:"w-12 px-2 py-1 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500",min:1,max:z}),n.jsx("button",{onClick:me,className:"px-3 py-1 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-50 transition-colors",children:""})]})]}),_&&K&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:n.jsx("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full mx-4",children:n.jsxs("div",{className:"p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h3",{className:"text-lg font-semibold text-neutral-900",children:""}),n.jsx("button",{onClick:()=>j(!1),className:"text-neutral-400 hover:text-neutral-600 transition-colors",children:n.jsx(Qe,{className:"w-5 h-5"})})]}),n.jsxs("div",{className:"mb-6",children:[n.jsxs("p",{className:"text-neutral-700",children:[" ",n.jsx("span",{className:"font-semibold",children:K.username})," "]}),n.jsx("p",{className:"text-sm text-neutral-500 mt-2",children:""})]}),n.jsxs("div",{className:"flex space-x-3",children:[n.jsx("button",{onClick:()=>j(!1),className:"flex-1 bg-neutral-100 hover:bg-neutral-200 text-neutral-700 py-2 rounded-lg transition-colors",children:""}),n.jsx("button",{onClick:ae,className:"flex-1 bg-red-600 hover:bg-red-700 text-white py-2 rounded-lg transition-colors",children:""})]})]})})})]})},uT=[{id:"1",name:"A",code:"company_a",contact_person:"",contact_phone:"13800001111",address:"",enabled:!0,created_at:"2024-01-01 00:00:00"},{id:"2",name:"A1",code:"company_a1",contact_person:"",contact_phone:"13800003333",address:"",enabled:!0,created_at:"2024-01-02 00:00:00"},{id:"3",name:"A2",code:"company_a2",contact_person:"",contact_phone:"13800004444",address:"",enabled:!1,created_at:"2024-01-03 00:00:00"},{id:"4",name:"B",code:"company_b",contact_person:"",contact_phone:"13800002222",address:"",enabled:!0,created_at:"2024-01-04 00:00:00"}],Pc=[{id:"1",username:"admin",phone:"13800138000",role:""},{id:"2",username:"company_admin_a",phone:"13800138001",role:""},{id:"3",username:"1",phone:"13800138002",role:""},{id:"4",username:"2",phone:"13800138003",role:""},{id:"5",username:"3",phone:"13800138004",role:""},{id:"6",username:"",phone:"13800138005",role:""},{id:"7",username:"",phone:"13800138006",role:""},{id:"8",username:"",phone:"13800138007",role:""}],fT=({canEdit:e=!0,canDelete:t=!0})=>{const[r,a]=M.useState(uT),[s,i]=M.useState(!1),[l,c]=M.useState(""),[o,u]=M.useState(1),[d,f]=M.useState(10),[x,h]=M.useState(""),[p,m]=M.useState("list"),[w,v]=M.useState(!1),[b,y]=M.useState(null),[N,A]=M.useState(null),[k,_]=M.useState([]),[j,P]=M.useState({}),[D,K]=M.useState({name:"",code:"",contact_person:"",contact_phone:"",address:""}),E=()=>{c(""),u(1)},Y=()=>{u(1)},B=()=>r.filter(oe=>!l||oe.name.toLowerCase().includes(l.toLowerCase())).sort((oe,De)=>new Date(oe.created_at).getTime()-new Date(De.created_at).getTime()),te=()=>{const oe=B(),De=(o-1)*d,Me=De+d;return oe.slice(De,Me)},re=Math.ceil(B().length/d),Q=()=>{K({name:"",code:"",contact_person:"",contact_phone:"",address:""}),m("add")},Z=oe=>{y(oe),K({name:oe.name,code:oe.code,contact_person:oe.contact_person,contact_phone:oe.contact_phone,address:oe.address}),m("edit")},z=oe=>{y(oe),v(!0)},ne=oe=>{y(oe);const De=j[oe.id]||[];_(De),m("manageUsers")},xe=oe=>{const De=Date.now().toString().slice(-6),Me=Math.random().toString(36).substring(2,6);return`company_${De}_${Me}`},O=oe=>/^1[3-9]\d{9}$/.test(oe),R=async()=>{if(!D.name){alert("");return}const oe=xe(D.name),De={id:String(r.length+1),name:D.name,code:oe,contact_person:D.contact_person,contact_phone:D.contact_phone,address:D.address,created_by:"",enabled:!0,created_at:new Date().toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}).replace(/\//g,"-")};a([...r,De]),A(De),_([]),m("addUsers")},g=async()=>{if(b){if(D.contact_phone&&!O(D.contact_phone)){alert("");return}a(r.map(oe=>oe.id===b.id?{...oe,name:D.name,contact_person:D.contact_person,contact_phone:D.contact_phone,address:D.address}:oe))}m("list")},S=async()=>{b&&a(r.filter(oe=>oe.id!==b.id)),v(!1)},F=oe=>{a(r.map(De=>De.id===oe.id?{...De,enabled:!De.enabled}:De))},ae=oe=>{_(De=>De.includes(oe)?De.filter(Me=>Me!==oe):[...De,oe])},ue=()=>{m("list"),A(null),_([])},ve=()=>{m("list"),A(null),_([])},me=()=>{b&&P({...j,[b.id]:k}),m("list"),y(null),_([])},H=()=>{m("list"),y(null),_([])},T=()=>Pc.filter(oe=>oe.role!==""),je=oe=>{f(oe),u(1)},pe=()=>{const oe=parseInt(x);oe>=1&&oe<=re&&(u(oe),h(""))},Le=()=>N?n.jsx("div",{className:"flex flex-col h-full",children:n.jsx("div",{className:"flex-1 overflow-auto",children:n.jsxs("div",{className:"bg-white rounded-lg border border-neutral-200",children:[n.jsxs("div",{className:"px-6 py-4 border-b border-neutral-200",children:[n.jsx("h3",{className:"text-lg font-semibold text-neutral-900",children:""}),n.jsxs("p",{className:"text-sm text-neutral-500 mt-1",children:["",n.jsx("span",{className:"font-medium text-neutral-900",children:N.name})]})]}),n.jsxs("div",{className:"p-6",children:[n.jsx("div",{className:"mb-4",children:n.jsx("p",{className:"text-sm text-neutral-700 mb-3",children:""})}),n.jsx("div",{className:"border border-neutral-200 rounded-lg overflow-hidden",children:n.jsxs("table",{className:"w-full",children:[n.jsx("thead",{className:"bg-neutral-50 border-b border-neutral-200",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600 w-12",children:n.jsx("input",{type:"checkbox",checked:k.length===Pc.length,onChange:oe=>{oe.target.checked?_(Pc.map(De=>De.id)):_([])},className:"w-4 h-4 text-primary-600 rounded focus:ring-primary-500"})}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""})]})}),n.jsx("tbody",{className:"divide-y divide-neutral-200",children:Pc.map(oe=>n.jsxs("tr",{className:"hover:bg-neutral-50 transition-colors",children:[n.jsx("td",{className:"px-4 py-2.5",children:n.jsx("input",{type:"checkbox",checked:k.includes(oe.id),onChange:()=>ae(oe.id),className:"w-4 h-4 text-primary-600 rounded focus:ring-primary-500"})}),n.jsx("td",{className:"px-4 py-2.5 text-sm text-neutral-900",children:oe.username}),n.jsx("td",{className:"px-4 py-2.5 text-sm text-neutral-900",children:oe.phone}),n.jsx("td",{className:"px-4 py-2.5 text-sm text-neutral-900",children:oe.role})]},oe.id))})]})}),k.length>0&&n.jsx("div",{className:"mt-4 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:n.jsxs("p",{className:"text-sm text-blue-800",children:[" ",n.jsx("span",{className:"font-semibold",children:k.length})," "]})})]}),n.jsxs("div",{className:"px-6 py-4 border-t border-neutral-200 flex items-center justify-between",children:[n.jsx("button",{onClick:ve,className:"px-6 py-2 border border-neutral-300 text-neutral-700 rounded-lg hover:bg-neutral-50 transition-colors",children:""}),n.jsxs("button",{onClick:ue,disabled:k.length===0,className:"px-6 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors disabled:bg-neutral-300 disabled:cursor-not-allowed",children:[" ",k.length>0&&`(${k.length})`]})]})]})})}):null,Se=()=>{if(!b)return null;const oe=T();return n.jsx("div",{className:"flex flex-col h-full",children:n.jsx("div",{className:"flex-1 overflow-auto",children:n.jsxs("div",{className:"bg-white rounded-lg border border-neutral-200",children:[n.jsxs("div",{className:"px-6 py-4 border-b border-neutral-200",children:[n.jsx("h3",{className:"text-lg font-semibold text-neutral-900",children:""}),n.jsxs("p",{className:"text-sm text-neutral-500 mt-1",children:["",n.jsx("span",{className:"font-medium text-neutral-900",children:b.name})]})]}),n.jsxs("div",{className:"p-6",children:[n.jsxs("div",{className:"mb-4",children:[n.jsx("p",{className:"text-sm text-neutral-700 mb-2",children:""}),n.jsx("p",{className:"text-xs text-neutral-500",children:""})]}),n.jsx("div",{className:"border border-neutral-200 rounded-lg overflow-hidden",children:n.jsxs("table",{className:"w-full",children:[n.jsx("thead",{className:"bg-neutral-50 border-b border-neutral-200",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600 w-12",children:n.jsx("input",{type:"checkbox",checked:k.length===oe.length&&oe.length>0,onChange:De=>{De.target.checked?_(oe.map(Me=>Me.id)):_([])},className:"w-4 h-4 text-primary-600 rounded focus:ring-primary-500"})}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""})]})}),n.jsx("tbody",{className:"divide-y divide-neutral-200",children:oe.length===0?n.jsx("tr",{children:n.jsx("td",{colSpan:4,className:"px-4 py-8 text-center text-neutral-500",children:""})}):oe.map(De=>n.jsxs("tr",{className:"hover:bg-neutral-50 transition-colors",children:[n.jsx("td",{className:"px-4 py-2.5",children:n.jsx("input",{type:"checkbox",checked:k.includes(De.id),onChange:()=>ae(De.id),className:"w-4 h-4 text-primary-600 rounded focus:ring-primary-500"})}),n.jsx("td",{className:"px-4 py-2.5 text-sm text-neutral-900",children:De.username}),n.jsx("td",{className:"px-4 py-2.5 text-sm text-neutral-900",children:De.phone}),n.jsx("td",{className:"px-4 py-2.5 text-sm text-neutral-900",children:De.role})]},De.id))})]})}),k.length>0&&n.jsx("div",{className:"mt-4 p-3 bg-green-50 border border-green-200 rounded-lg",children:n.jsxs("p",{className:"text-sm text-green-800",children:[" ",n.jsx("span",{className:"font-semibold",children:k.length})," "]})})]}),n.jsxs("div",{className:"px-6 py-4 border-t border-neutral-200 flex items-center justify-end gap-3",children:[n.jsx("button",{onClick:H,className:"px-6 py-2 border border-neutral-300 text-neutral-700 rounded-lg hover:bg-neutral-50 transition-colors",children:""}),n.jsx("button",{onClick:me,className:"px-6 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors",children:""})]})]})})})},he=()=>{const oe=p==="edit",De=oe?"":"";return n.jsx("div",{className:"flex flex-col h-full",children:n.jsx("div",{className:"flex-1 overflow-auto",children:n.jsxs("div",{className:"bg-white rounded-lg border border-neutral-200",children:[n.jsxs("div",{className:"px-6 py-4 border-b border-neutral-200 flex items-center justify-between",children:[n.jsx("h3",{className:"text-lg font-semibold text-neutral-900",children:De}),n.jsx("button",{onClick:()=>m("list"),className:"text-neutral-400 hover:text-neutral-600 transition-colors",children:n.jsx(Qe,{className:"w-5 h-5"})})]}),n.jsx("div",{className:"p-6 space-y-6 max-w-2xl mx-auto",children:n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:D.name,onChange:Me=>K({...D,name:Me.target.value}),placeholder:"",className:"w-full px-4 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]})}),n.jsxs("div",{className:"px-6 py-4 border-t border-neutral-200 flex items-center justify-end gap-3",children:[n.jsx("button",{onClick:()=>m("list"),className:"px-6 py-2 border border-neutral-300 text-neutral-700 rounded-lg hover:bg-neutral-50 transition-colors",children:""}),n.jsx("button",{onClick:oe?g:R,className:"px-6 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors",children:oe?"":""})]})]})})})};return p==="add"||p==="edit"?he():p==="addUsers"?Le():p==="manageUsers"?Se():n.jsxs("div",{className:"flex flex-col h-full",children:[n.jsx("div",{className:"flex-1 overflow-auto",children:n.jsxs("div",{className:"bg-white rounded-lg border border-neutral-200",children:[n.jsxs("div",{className:"px-6 py-4 border-b border-neutral-200",children:[n.jsx("div",{className:"flex items-center justify-between mb-4",children:n.jsx("h2",{className:"text-lg font-medium text-neutral-900",children:""})}),n.jsxs("div",{className:"flex items-center justify-between gap-3",children:[n.jsxs("div",{className:"flex items-center gap-3",children:["",n.jsx("input",{type:"text",placeholder:"",value:l,onChange:oe=>c(oe.target.value),className:"w-48 px-3 py-1.5 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{onClick:E,className:"px-4 py-1.5 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-50 transition-colors",children:""}),n.jsx("button",{onClick:Y,className:"px-4 py-1.5 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors",children:""})]})]})]}),n.jsx("div",{className:"px-6 py-3 border-b border-neutral-200",children:n.jsxs("button",{onClick:Q,className:"px-4 py-1.5 text-sm bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors flex items-center",children:[n.jsx(Pt,{className:"w-4 h-4 mr-1"}),""]})}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"w-full",children:[n.jsx("thead",{className:"bg-neutral-50 border-b border-neutral-200",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-medium text-neutral-600",children:""})]})}),n.jsx("tbody",{className:"divide-y divide-neutral-200",children:s?n.jsx("tr",{children:n.jsx("td",{colSpan:6,className:"px-4 py-8 text-center text-neutral-500",children:n.jsxs("div",{className:"flex items-center justify-center",children:[n.jsx(Tl,{className:"w-5 h-5 animate-spin mr-2"}),"..."]})})}):te().length===0?n.jsx("tr",{children:n.jsx("td",{colSpan:6,className:"px-4 py-8 text-center text-neutral-500",children:""})}):te().map((oe,De)=>n.jsxs("tr",{className:"hover:bg-neutral-50 transition-colors",children:[n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm text-neutral-900",children:(o-1)*d+De+1}),n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap",children:n.jsx("span",{className:"text-sm font-medium text-neutral-900",children:oe.name})}),n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm text-neutral-900",children:oe.created_by}),n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap",children:n.jsxs("button",{onClick:()=>F(oe),className:`inline-flex items-center px-3 py-1 rounded-full text-xs font-medium transition-all duration-200 ${oe.enabled?"bg-green-100 text-green-800 hover:bg-green-200":"bg-red-100 text-red-800 hover:bg-red-200"}`,children:[n.jsx("span",{className:`w-1.5 h-1.5 rounded-full mr-1.5 ${oe.enabled?"bg-green-500":"bg-red-500"}`}),oe.enabled?"":""]})}),n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm text-neutral-900",children:oe.created_at}),n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-sm",children:n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsxs("button",{onClick:()=>ne(oe),className:"px-2 py-1 text-xs text-green-600 hover:text-green-800 hover:bg-green-50 rounded transition-colors flex items-center gap-1",children:[n.jsx(Pb,{className:"w-3.5 h-3.5"}),""]}),n.jsxs("button",{onClick:()=>Z(oe),className:"px-2 py-1 text-xs text-primary-600 hover:text-primary-800 hover:bg-primary-50 rounded transition-colors flex items-center gap-1",children:[n.jsx(Dt,{className:"w-3.5 h-3.5"}),""]}),n.jsxs("button",{onClick:()=>z(oe),className:"px-2 py-1 text-xs text-red-600 hover:text-red-800 hover:bg-red-50 rounded transition-colors flex items-center gap-1",children:[n.jsx(qe,{className:"w-3.5 h-3.5"}),""]})]})})]},oe.id))})]})})]})}),n.jsxs("div",{className:"bg-white border-t border-neutral-200 px-6 py-3 flex items-center justify-center gap-6",children:[n.jsxs("div",{className:"text-sm text-neutral-700",children:[" ",B().length," "]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("button",{onClick:()=>u(Math.max(1,o-1)),disabled:o===1,className:`px-2 py-1 text-sm rounded transition-colors ${o===1?"bg-neutral-100 text-neutral-400 cursor-not-allowed":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:"<"}),n.jsx("div",{className:"flex items-center space-x-1",children:Array.from({length:Math.min(10,re)},(oe,De)=>{let Me;return re<=10||o<=5?Me=De+1:o>=re-4?Me=re-9+De:Me=o-4+De,n.jsx("button",{onClick:()=>u(Me),className:`px-2.5 py-1 text-sm rounded transition-colors ${o===Me?"bg-primary-600 text-white":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:Me},Me)})}),re>10&&n.jsxs(n.Fragment,{children:[n.jsx("span",{className:"text-neutral-500",children:"..."}),n.jsx("button",{onClick:()=>u(re),className:`px-2.5 py-1 text-sm rounded transition-colors ${o===re?"bg-primary-600 text-white":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:re})]}),n.jsx("button",{onClick:()=>u(Math.min(re,o+1)),disabled:o===re,className:`px-2 py-1 text-sm rounded transition-colors ${o===re?"bg-neutral-100 text-neutral-400 cursor-not-allowed":"bg-white border border-neutral-300 text-neutral-700 hover:bg-neutral-50"}`,children:">"})]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsxs("select",{value:d,onChange:oe=>je(Number(oe.target.value)),className:"px-2 py-1 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500",children:[n.jsx("option",{value:10,children:"10/"}),n.jsx("option",{value:20,children:"20/"}),n.jsx("option",{value:50,children:"50/"})]}),n.jsx("span",{className:"text-sm text-neutral-700",children:""}),n.jsx("input",{type:"number",value:x,onChange:oe=>h(oe.target.value),placeholder:"",className:"w-12 px-2 py-1 text-sm border border-neutral-300 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500",min:1,max:re}),n.jsx("button",{onClick:pe,className:"px-3 py-1 text-sm border border-neutral-300 text-neutral-700 rounded hover:bg-neutral-50 transition-colors",children:""})]})]}),w&&b&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:n.jsx("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full mx-4",children:n.jsxs("div",{className:"p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h3",{className:"text-lg font-semibold text-neutral-900",children:""}),n.jsx("button",{onClick:()=>v(!1),className:"text-neutral-400 hover:text-neutral-600 transition-colors",children:n.jsx(Qe,{className:"w-5 h-5"})})]}),n.jsxs("div",{className:"mb-6",children:[n.jsxs("p",{className:"text-neutral-700",children:[" ",n.jsx("span",{className:"font-semibold",children:b.name})," "]}),n.jsx("p",{className:"text-sm text-neutral-500 mt-2",children:""})]}),n.jsxs("div",{className:"flex space-x-3",children:[n.jsx("button",{onClick:()=>v(!1),className:"flex-1 bg-neutral-100 hover:bg-neutral-200 text-neutral-700 py-2 rounded-lg transition-colors",children:""}),n.jsx("button",{onClick:S,className:"flex-1 bg-red-600 hover:bg-red-700 text-white py-2 rounded-lg transition-colors",children:""})]})]})})})]})},Dc={:{view:["database","upload","generate","check","settings","users","companies"],edit:["database","upload","generate","check","settings","users","companies"],delete:["upload","generate","check","companies","database"],canDeleteSelf:!1},:{view:["database","upload","generate","check","settings","users","companies"],edit:["database","upload","generate","check","users"],delete:["upload","generate","check","database","users"],dataScope:"company",canDeleteSelf:!1},:{view:["database","upload","generate","check"],edit:["upload","generate","check"],delete:["upload","generate","check"],viewOwnProfileOnly:!0,canDeleteSelf:!1,readOnlyDatabase:!0}};function xT(){const[e,t]=M.useState(!1),[r,a]=M.useState({username:"",role:""}),[s,i]=M.useState("database"),[l,c]=M.useState([]),[o,u]=M.useState({fontSize:14,fontFamily:"SimSun",lineHeight:1.5,margin:25,alignment:"left"});M.useEffect(()=>{const k=localStorage.getItem("currentUser");if(k){const _=JSON.parse(k);a(_),t(!0)}},[]);const d=(k,_)=>{const j={username:k,role:_};a(j),t(!0),localStorage.setItem("currentUser",JSON.stringify(j))},f=()=>{t(!1),a({username:"",role:""}),localStorage.removeItem("currentUser")};br.useEffect(()=>{const k=()=>{i("generate")};return window.addEventListener("navigate-to-generate",k),()=>{window.removeEventListener("navigate-to-generate",k)}},[]);const x=[{id:"database",label:"",icon:gb,roles:["","",""]},{id:"upload",label:"",icon:St,roles:["","",""]},{id:"generate",label:"",icon:mb,roles:["","",""]},{id:"check",label:"",icon:v1,roles:["","",""]},{id:"settings",label:"",icon:Gu,roles:["",""],children:[{id:"users",label:"",icon:w1,roles:["",""]},{id:"companies",label:"",icon:El,roles:["",""]}]}],h=(k,_="view")=>{var P;const j=Dc[r.role];return j&&((P=j[_])==null?void 0:P.includes(k))||!1},p=()=>{const k=Dc[r.role];return k==null?void 0:k.dataScope},m=()=>{const k=Dc[r.role];return(k==null?void 0:k.viewOwnProfileOnly)===!0},w=()=>{const k=Dc[r.role];return(k==null?void 0:k.readOnlyDatabase)===!0},v=k=>k.filter(_=>{if(!_.roles||_.roles.includes(r.role)){if(_.children){const j=v(_.children);return j.length>0?{..._,children:j}:!1}return!0}return!1}).map(_=>_.children?{..._,children:v(_.children)}:_),b=v(x);M.useEffect(()=>{var k;if(e&&!h(s,"view")){const _=((k=b[0])==null?void 0:k.id)||"database";i(_)}},[r.role,e]);const y=k=>{c(_=>_.includes(k)?_.filter(j=>j!==k):[..._,k])},N=()=>{if(!h(s,"view"))return n.jsx("div",{className:"flex items-center justify-center h-full",children:n.jsxs("div",{className:"text-center",children:[n.jsx(Shield,{className:"w-16 h-16 mx-auto mb-4 text-neutral-400"}),n.jsx("h3",{className:"text-lg font-semibold text-neutral-900 mb-2",children:""}),n.jsx("p",{className:"text-neutral-600",children:""})]})});const k=h(s,"edit"),_=h(s,"delete"),j=p(),P=m(),D=w();switch(s){case"database":return n.jsx(VE,{canEdit:k,canDelete:_,dataScope:j,readOnly:D,currentUser:r});case"upload":return n.jsx(ah,{canEdit:k,canDelete:_,dataScope:j});case"generate":return n.jsx(QE,{canEdit:k,canDelete:_,dataScope:j});case"check":return n.jsx(lT,{canEdit:k,canDelete:_,dataScope:j});case"settings":return n.jsx(cT,{format:o,onUpdate:u});case"users":return n.jsx(dT,{canEdit:k,canDelete:_,viewOwnOnly:P,currentUser:r,dataScope:j});case"companies":return n.jsx(fT,{canEdit:k,canDelete:_,dataScope:j});default:return n.jsx(ah,{canEdit:k,canDelete:_,dataScope:j})}},A=(k,_=0)=>{const j=k.icon,P=k.children&&k.children.length>0,D=l.includes(k.id),K=s===k.id,E=_>0;return n.jsxs("div",{children:[n.jsxs("button",{onClick:()=>{P?y(k.id):i(k.id)},className:`w-full flex items-center justify-between px-3 py-2.5 text-sm text-left rounded-lg transition-all duration-150 ${E?"pl-9":""} ${K&&!P?"bg-primary-50 text-primary-700 font-medium":"text-neutral-600 hover:bg-neutral-50 hover:text-neutral-900"}`,children:[n.jsxs("div",{className:"flex items-center",children:[!E&&n.jsx(j,{className:`w-4.5 h-4.5 mr-2.5 ${K&&!P?"text-primary-600":"text-neutral-400"}`}),k.label]}),P&&(D?n.jsx(hb,{className:"w-4 h-4 text-neutral-400"}):n.jsx(Kl,{className:"w-4 h-4 text-neutral-400"}))]}),P&&D&&n.jsx("div",{className:"mt-1 space-y-1",children:k.children.map(Y=>A(Y,_+1))})]},k.id)};return e?n.jsxs("div",{className:"h-screen w-screen overflow-hidden bg-neutral-50 flex flex-col",children:[n.jsx(Ib,{username:r.username,role:r.role,onLogout:f}),n.jsxs("div",{className:"flex flex-1 overflow-hidden",children:[n.jsx("div",{className:"w-64 bg-white border-r border-neutral-200 overflow-y-auto flex-shrink-0",children:n.jsx("div",{className:"py-6 px-3",children:n.jsx("nav",{className:"space-y-1",children:b.map(k=>A(k))})})}),n.jsx("div",{className:"flex-1 overflow-hidden",children:n.jsx("div",{className:"h-full overflow-y-auto",children:n.jsx("div",{className:"p-6 max-w-full",children:N()})})})]})]}):n.jsx(Db,{onLogin:d})}g1(document.getElementById("root")).render(n.jsx(M.StrictMode,{children:n.jsx(xT,{})}));
